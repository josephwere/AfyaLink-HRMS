function J0(e,t){for(var n=0;n<t.length;n++){const r=t[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in e)){const a=Object.getOwnPropertyDescriptor(r,i);a&&Object.defineProperty(e,i,a.get?a:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(i){if(i.ep)return;i.ep=!0;const a=n(i);fetch(i.href,a)}})();var Ka=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function uf(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var zy={exports:{}},Kc={},Wy={exports:{}},Re={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Qo=Symbol.for("react.element"),Q0=Symbol.for("react.portal"),Z0=Symbol.for("react.fragment"),X0=Symbol.for("react.strict_mode"),ew=Symbol.for("react.profiler"),tw=Symbol.for("react.provider"),nw=Symbol.for("react.context"),rw=Symbol.for("react.forward_ref"),sw=Symbol.for("react.suspense"),iw=Symbol.for("react.memo"),aw=Symbol.for("react.lazy"),Xp=Symbol.iterator;function ow(e){return e===null||typeof e!="object"?null:(e=Xp&&e[Xp]||e["@@iterator"],typeof e=="function"?e:null)}var Gy={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Yy=Object.assign,Ky={};function ya(e,t,n){this.props=e,this.context=t,this.refs=Ky,this.updater=n||Gy}ya.prototype.isReactComponent={};ya.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};ya.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Jy(){}Jy.prototype=ya.prototype;function df(e,t,n){this.props=e,this.context=t,this.refs=Ky,this.updater=n||Gy}var hf=df.prototype=new Jy;hf.constructor=df;Yy(hf,ya.prototype);hf.isPureReactComponent=!0;var em=Array.isArray,Qy=Object.prototype.hasOwnProperty,ff={current:null},Zy={key:!0,ref:!0,__self:!0,__source:!0};function Xy(e,t,n){var r,i={},a=null,o=null;if(t!=null)for(r in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(a=""+t.key),t)Qy.call(t,r)&&!Zy.hasOwnProperty(r)&&(i[r]=t[r]);var l=arguments.length-2;if(l===1)i.children=n;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];i.children=c}if(e&&e.defaultProps)for(r in l=e.defaultProps,l)i[r]===void 0&&(i[r]=l[r]);return{$$typeof:Qo,type:e,key:a,ref:o,props:i,_owner:ff.current}}function lw(e,t){return{$$typeof:Qo,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function pf(e){return typeof e=="object"&&e!==null&&e.$$typeof===Qo}function cw(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var tm=/\/+/g;function Nu(e,t){return typeof e=="object"&&e!==null&&e.key!=null?cw(""+e.key):t.toString(36)}function Hl(e,t,n,r,i){var a=typeof e;(a==="undefined"||a==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(a){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case Qo:case Q0:o=!0}}if(o)return o=e,i=i(o),e=r===""?"."+Nu(o,0):r,em(i)?(n="",e!=null&&(n=e.replace(tm,"$&/")+"/"),Hl(i,t,n,"",function(u){return u})):i!=null&&(pf(i)&&(i=lw(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(tm,"$&/")+"/")+e)),t.push(i)),1;if(o=0,r=r===""?".":r+":",em(e))for(var l=0;l<e.length;l++){a=e[l];var c=r+Nu(a,l);o+=Hl(a,t,n,c,i)}else if(c=ow(e),typeof c=="function")for(e=c.call(e),l=0;!(a=e.next()).done;)a=a.value,c=r+Nu(a,l++),o+=Hl(a,t,n,c,i);else if(a==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function ul(e,t,n){if(e==null)return e;var r=[],i=0;return Hl(e,r,"","",function(a){return t.call(n,a,i++)}),r}function uw(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var zt={current:null},ql={transition:null},dw={ReactCurrentDispatcher:zt,ReactCurrentBatchConfig:ql,ReactCurrentOwner:ff};function ev(){throw Error("act(...) is not supported in production builds of React.")}Re.Children={map:ul,forEach:function(e,t,n){ul(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return ul(e,function(){t++}),t},toArray:function(e){return ul(e,function(t){return t})||[]},only:function(e){if(!pf(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Re.Component=ya;Re.Fragment=Z0;Re.Profiler=ew;Re.PureComponent=df;Re.StrictMode=X0;Re.Suspense=sw;Re.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=dw;Re.act=ev;Re.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=Yy({},e.props),i=e.key,a=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(a=t.ref,o=ff.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)Qy.call(t,c)&&!Zy.hasOwnProperty(c)&&(r[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:Qo,type:e.type,key:i,ref:a,props:r,_owner:o}};Re.createContext=function(e){return e={$$typeof:nw,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:tw,_context:e},e.Consumer=e};Re.createElement=Xy;Re.createFactory=function(e){var t=Xy.bind(null,e);return t.type=e,t};Re.createRef=function(){return{current:null}};Re.forwardRef=function(e){return{$$typeof:rw,render:e}};Re.isValidElement=pf;Re.lazy=function(e){return{$$typeof:aw,_payload:{_status:-1,_result:e},_init:uw}};Re.memo=function(e,t){return{$$typeof:iw,type:e,compare:t===void 0?null:t}};Re.startTransition=function(e){var t=ql.transition;ql.transition={};try{e()}finally{ql.transition=t}};Re.unstable_act=ev;Re.useCallback=function(e,t){return zt.current.useCallback(e,t)};Re.useContext=function(e){return zt.current.useContext(e)};Re.useDebugValue=function(){};Re.useDeferredValue=function(e){return zt.current.useDeferredValue(e)};Re.useEffect=function(e,t){return zt.current.useEffect(e,t)};Re.useId=function(){return zt.current.useId()};Re.useImperativeHandle=function(e,t,n){return zt.current.useImperativeHandle(e,t,n)};Re.useInsertionEffect=function(e,t){return zt.current.useInsertionEffect(e,t)};Re.useLayoutEffect=function(e,t){return zt.current.useLayoutEffect(e,t)};Re.useMemo=function(e,t){return zt.current.useMemo(e,t)};Re.useReducer=function(e,t,n){return zt.current.useReducer(e,t,n)};Re.useRef=function(e){return zt.current.useRef(e)};Re.useState=function(e){return zt.current.useState(e)};Re.useSyncExternalStore=function(e,t,n){return zt.current.useSyncExternalStore(e,t,n)};Re.useTransition=function(){return zt.current.useTransition()};Re.version="18.3.1";Wy.exports=Re;var m=Wy.exports;const Zo=uf(m),hw=J0({__proto__:null,default:Zo},[m]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fw=m,pw=Symbol.for("react.element"),mw=Symbol.for("react.fragment"),gw=Object.prototype.hasOwnProperty,yw=fw.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,vw={key:!0,ref:!0,__self:!0,__source:!0};function tv(e,t,n){var r,i={},a=null,o=null;n!==void 0&&(a=""+n),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(o=t.ref);for(r in t)gw.call(t,r)&&!vw.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)i[r]===void 0&&(i[r]=t[r]);return{$$typeof:pw,type:e,key:a,ref:o,props:i,_owner:yw.current}}Kc.Fragment=mw;Kc.jsx=tv;Kc.jsxs=tv;zy.exports=Kc;var s=zy.exports,kd={},nv={exports:{}},dn={},rv={exports:{}},sv={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(U,Z){var le=U.length;U.push(Z);e:for(;0<le;){var ye=le-1>>>1,je=U[ye];if(0<i(je,Z))U[ye]=Z,U[le]=je,le=ye;else break e}}function n(U){return U.length===0?null:U[0]}function r(U){if(U.length===0)return null;var Z=U[0],le=U.pop();if(le!==Z){U[0]=le;e:for(var ye=0,je=U.length,Ae=je>>>1;ye<Ae;){var H=2*(ye+1)-1,F=U[H],se=H+1,xe=U[se];if(0>i(F,le))se<je&&0>i(xe,F)?(U[ye]=xe,U[se]=le,ye=se):(U[ye]=F,U[H]=le,ye=H);else if(se<je&&0>i(xe,le))U[ye]=xe,U[se]=le,ye=se;else break e}}return Z}function i(U,Z){var le=U.sortIndex-Z.sortIndex;return le!==0?le:U.id-Z.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var c=[],u=[],d=1,p=null,h=3,f=!1,y=!1,b=!1,E=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(U){for(var Z=n(u);Z!==null;){if(Z.callback===null)r(u);else if(Z.startTime<=U)r(u),Z.sortIndex=Z.expirationTime,t(c,Z);else break;Z=n(u)}}function _(U){if(b=!1,w(U),!y)if(n(c)!==null)y=!0,Q(S);else{var Z=n(u);Z!==null&&ae(_,Z.startTime-U)}}function S(U,Z){y=!1,b&&(b=!1,g(C),C=-1),f=!0;var le=h;try{for(w(Z),p=n(c);p!==null&&(!(p.expirationTime>Z)||U&&!B());){var ye=p.callback;if(typeof ye=="function"){p.callback=null,h=p.priorityLevel;var je=ye(p.expirationTime<=Z);Z=e.unstable_now(),typeof je=="function"?p.callback=je:p===n(c)&&r(c),w(Z)}else r(c);p=n(c)}if(p!==null)var Ae=!0;else{var H=n(u);H!==null&&ae(_,H.startTime-Z),Ae=!1}return Ae}finally{p=null,h=le,f=!1}}var k=!1,I=null,C=-1,L=5,V=-1;function B(){return!(e.unstable_now()-V<L)}function Y(){if(I!==null){var U=e.unstable_now();V=U;var Z=!0;try{Z=I(!0,U)}finally{Z?W():(k=!1,I=null)}}else k=!1}var W;if(typeof x=="function")W=function(){x(Y)};else if(typeof MessageChannel<"u"){var O=new MessageChannel,D=O.port2;O.port1.onmessage=Y,W=function(){D.postMessage(null)}}else W=function(){E(Y,0)};function Q(U){I=U,k||(k=!0,W())}function ae(U,Z){C=E(function(){U(e.unstable_now())},Z)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(U){U.callback=null},e.unstable_continueExecution=function(){y||f||(y=!0,Q(S))},e.unstable_forceFrameRate=function(U){0>U||125<U?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):L=0<U?Math.floor(1e3/U):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return n(c)},e.unstable_next=function(U){switch(h){case 1:case 2:case 3:var Z=3;break;default:Z=h}var le=h;h=Z;try{return U()}finally{h=le}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(U,Z){switch(U){case 1:case 2:case 3:case 4:case 5:break;default:U=3}var le=h;h=U;try{return Z()}finally{h=le}},e.unstable_scheduleCallback=function(U,Z,le){var ye=e.unstable_now();switch(typeof le=="object"&&le!==null?(le=le.delay,le=typeof le=="number"&&0<le?ye+le:ye):le=ye,U){case 1:var je=-1;break;case 2:je=250;break;case 5:je=1073741823;break;case 4:je=1e4;break;default:je=5e3}return je=le+je,U={id:d++,callback:Z,priorityLevel:U,startTime:le,expirationTime:je,sortIndex:-1},le>ye?(U.sortIndex=le,t(u,U),n(c)===null&&U===n(u)&&(b?(g(C),C=-1):b=!0,ae(_,le-ye))):(U.sortIndex=je,t(c,U),y||f||(y=!0,Q(S))),U},e.unstable_shouldYield=B,e.unstable_wrapCallback=function(U){var Z=h;return function(){var le=h;h=Z;try{return U.apply(this,arguments)}finally{h=le}}}})(sv);rv.exports=sv;var xw=rv.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jw=m,un=xw;function ee(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var iv=new Set,bo={};function di(e,t){ia(e,t),ia(e+"Capture",t)}function ia(e,t){for(bo[e]=t,e=0;e<t.length;e++)iv.add(t[e])}var Dr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Id=Object.prototype.hasOwnProperty,bw=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,nm={},rm={};function ww(e){return Id.call(rm,e)?!0:Id.call(nm,e)?!1:bw.test(e)?rm[e]=!0:(nm[e]=!0,!1)}function Sw(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Ew(e,t,n,r){if(t===null||typeof t>"u"||Sw(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Wt(e,t,n,r,i,a,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=o}var Ot={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Ot[e]=new Wt(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Ot[t]=new Wt(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Ot[e]=new Wt(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Ot[e]=new Wt(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Ot[e]=new Wt(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Ot[e]=new Wt(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Ot[e]=new Wt(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Ot[e]=new Wt(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Ot[e]=new Wt(e,5,!1,e.toLowerCase(),null,!1,!1)});var mf=/[\-:]([a-z])/g;function gf(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(mf,gf);Ot[t]=new Wt(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(mf,gf);Ot[t]=new Wt(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(mf,gf);Ot[t]=new Wt(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Ot[e]=new Wt(e,1,!1,e.toLowerCase(),null,!1,!1)});Ot.xlinkHref=new Wt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Ot[e]=new Wt(e,1,!1,e.toLowerCase(),null,!0,!0)});function yf(e,t,n,r){var i=Ot.hasOwnProperty(t)?Ot[t]:null;(i!==null?i.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Ew(t,n,i,r)&&(n=null),r||i===null?ww(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=n===null?i.type===3?!1:"":n:(t=i.attributeName,r=i.attributeNamespace,n===null?e.removeAttribute(t):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var Vr=jw.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,dl=Symbol.for("react.element"),Oi=Symbol.for("react.portal"),Pi=Symbol.for("react.fragment"),vf=Symbol.for("react.strict_mode"),Rd=Symbol.for("react.profiler"),av=Symbol.for("react.provider"),ov=Symbol.for("react.context"),xf=Symbol.for("react.forward_ref"),Td=Symbol.for("react.suspense"),Od=Symbol.for("react.suspense_list"),jf=Symbol.for("react.memo"),Jr=Symbol.for("react.lazy"),lv=Symbol.for("react.offscreen"),sm=Symbol.iterator;function La(e){return e===null||typeof e!="object"?null:(e=sm&&e[sm]||e["@@iterator"],typeof e=="function"?e:null)}var ot=Object.assign,_u;function Ja(e){if(_u===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);_u=t&&t[1]||""}return`
`+_u+e}var Au=!1;function Cu(e,t){if(!e||Au)return"";Au=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var r=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){r=u}e.call(t.prototype)}else{try{throw Error()}catch(u){r=u}e()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),a=r.stack.split(`
`),o=i.length-1,l=a.length-1;1<=o&&0<=l&&i[o]!==a[l];)l--;for(;1<=o&&0<=l;o--,l--)if(i[o]!==a[l]){if(o!==1||l!==1)do if(o--,l--,0>l||i[o]!==a[l]){var c=`
`+i[o].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=o&&0<=l);break}}}finally{Au=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?Ja(e):""}function Nw(e){switch(e.tag){case 5:return Ja(e.type);case 16:return Ja("Lazy");case 13:return Ja("Suspense");case 19:return Ja("SuspenseList");case 0:case 2:case 15:return e=Cu(e.type,!1),e;case 11:return e=Cu(e.type.render,!1),e;case 1:return e=Cu(e.type,!0),e;default:return""}}function Pd(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Pi:return"Fragment";case Oi:return"Portal";case Rd:return"Profiler";case vf:return"StrictMode";case Td:return"Suspense";case Od:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case ov:return(e.displayName||"Context")+".Consumer";case av:return(e._context.displayName||"Context")+".Provider";case xf:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case jf:return t=e.displayName||null,t!==null?t:Pd(e.type)||"Memo";case Jr:t=e._payload,e=e._init;try{return Pd(e(t))}catch{}}return null}function _w(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Pd(t);case 8:return t===vf?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function bs(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function cv(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Aw(e){var t=cv(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,a=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,a.call(this,o)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function hl(e){e._valueTracker||(e._valueTracker=Aw(e))}function uv(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=cv(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function fc(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Ld(e,t){var n=t.checked;return ot({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function im(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=bs(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function dv(e,t){t=t.checked,t!=null&&yf(e,"checked",t,!1)}function Dd(e,t){dv(e,t);var n=bs(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Md(e,t.type,n):t.hasOwnProperty("defaultValue")&&Md(e,t.type,bs(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function am(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function Md(e,t,n){(t!=="number"||fc(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var Qa=Array.isArray;function Yi(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+bs(n),t=null,i=0;i<e.length;i++){if(e[i].value===n){e[i].selected=!0,r&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function Ud(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(ee(91));return ot({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function om(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(ee(92));if(Qa(n)){if(1<n.length)throw Error(ee(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:bs(n)}}function hv(e,t){var n=bs(t.value),r=bs(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function lm(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function fv(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Bd(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?fv(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var fl,pv=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,i){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(fl=fl||document.createElement("div"),fl.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=fl.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function wo(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var ao={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Cw=["Webkit","ms","Moz","O"];Object.keys(ao).forEach(function(e){Cw.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),ao[t]=ao[e]})});function mv(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||ao.hasOwnProperty(e)&&ao[e]?(""+t).trim():t+"px"}function gv(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=mv(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}var kw=ot({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Vd(e,t){if(t){if(kw[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(ee(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(ee(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(ee(61))}if(t.style!=null&&typeof t.style!="object")throw Error(ee(62))}}function $d(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Fd=null;function bf(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Hd=null,Ki=null,Ji=null;function cm(e){if(e=tl(e)){if(typeof Hd!="function")throw Error(ee(280));var t=e.stateNode;t&&(t=eu(t),Hd(e.stateNode,e.type,t))}}function yv(e){Ki?Ji?Ji.push(e):Ji=[e]:Ki=e}function vv(){if(Ki){var e=Ki,t=Ji;if(Ji=Ki=null,cm(e),t)for(e=0;e<t.length;e++)cm(t[e])}}function xv(e,t){return e(t)}function jv(){}var ku=!1;function bv(e,t,n){if(ku)return e(t,n);ku=!0;try{return xv(e,t,n)}finally{ku=!1,(Ki!==null||Ji!==null)&&(jv(),vv())}}function So(e,t){var n=e.stateNode;if(n===null)return null;var r=eu(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(ee(231,t,typeof n));return n}var qd=!1;if(Dr)try{var Da={};Object.defineProperty(Da,"passive",{get:function(){qd=!0}}),window.addEventListener("test",Da,Da),window.removeEventListener("test",Da,Da)}catch{qd=!1}function Iw(e,t,n,r,i,a,o,l,c){var u=Array.prototype.slice.call(arguments,3);try{t.apply(n,u)}catch(d){this.onError(d)}}var oo=!1,pc=null,mc=!1,zd=null,Rw={onError:function(e){oo=!0,pc=e}};function Tw(e,t,n,r,i,a,o,l,c){oo=!1,pc=null,Iw.apply(Rw,arguments)}function Ow(e,t,n,r,i,a,o,l,c){if(Tw.apply(this,arguments),oo){if(oo){var u=pc;oo=!1,pc=null}else throw Error(ee(198));mc||(mc=!0,zd=u)}}function hi(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function wv(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function um(e){if(hi(e)!==e)throw Error(ee(188))}function Pw(e){var t=e.alternate;if(!t){if(t=hi(e),t===null)throw Error(ee(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(i===null)break;var a=i.alternate;if(a===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===n)return um(i),e;if(a===r)return um(i),t;a=a.sibling}throw Error(ee(188))}if(n.return!==r.return)n=i,r=a;else{for(var o=!1,l=i.child;l;){if(l===n){o=!0,n=i,r=a;break}if(l===r){o=!0,r=i,n=a;break}l=l.sibling}if(!o){for(l=a.child;l;){if(l===n){o=!0,n=a,r=i;break}if(l===r){o=!0,r=a,n=i;break}l=l.sibling}if(!o)throw Error(ee(189))}}if(n.alternate!==r)throw Error(ee(190))}if(n.tag!==3)throw Error(ee(188));return n.stateNode.current===n?e:t}function Sv(e){return e=Pw(e),e!==null?Ev(e):null}function Ev(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Ev(e);if(t!==null)return t;e=e.sibling}return null}var Nv=un.unstable_scheduleCallback,dm=un.unstable_cancelCallback,Lw=un.unstable_shouldYield,Dw=un.unstable_requestPaint,ht=un.unstable_now,Mw=un.unstable_getCurrentPriorityLevel,wf=un.unstable_ImmediatePriority,_v=un.unstable_UserBlockingPriority,gc=un.unstable_NormalPriority,Uw=un.unstable_LowPriority,Av=un.unstable_IdlePriority,Jc=null,ir=null;function Bw(e){if(ir&&typeof ir.onCommitFiberRoot=="function")try{ir.onCommitFiberRoot(Jc,e,void 0,(e.current.flags&128)===128)}catch{}}var qn=Math.clz32?Math.clz32:Fw,Vw=Math.log,$w=Math.LN2;function Fw(e){return e>>>=0,e===0?32:31-(Vw(e)/$w|0)|0}var pl=64,ml=4194304;function Za(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function yc(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,i=e.suspendedLanes,a=e.pingedLanes,o=n&268435455;if(o!==0){var l=o&~i;l!==0?r=Za(l):(a&=o,a!==0&&(r=Za(a)))}else o=n&~i,o!==0?r=Za(o):a!==0&&(r=Za(a));if(r===0)return 0;if(t!==0&&t!==r&&!(t&i)&&(i=r&-r,a=t&-t,i>=a||i===16&&(a&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-qn(t),i=1<<n,r|=e[n],t&=~i;return r}function Hw(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function qw(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,a=e.pendingLanes;0<a;){var o=31-qn(a),l=1<<o,c=i[o];c===-1?(!(l&n)||l&r)&&(i[o]=Hw(l,t)):c<=t&&(e.expiredLanes|=l),a&=~l}}function Wd(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Cv(){var e=pl;return pl<<=1,!(pl&4194240)&&(pl=64),e}function Iu(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Xo(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-qn(t),e[t]=n}function zw(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-qn(n),a=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~a}}function Sf(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-qn(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var ze=0;function kv(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Iv,Ef,Rv,Tv,Ov,Gd=!1,gl=[],ls=null,cs=null,us=null,Eo=new Map,No=new Map,Zr=[],Ww="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function hm(e,t){switch(e){case"focusin":case"focusout":ls=null;break;case"dragenter":case"dragleave":cs=null;break;case"mouseover":case"mouseout":us=null;break;case"pointerover":case"pointerout":Eo.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":No.delete(t.pointerId)}}function Ma(e,t,n,r,i,a){return e===null||e.nativeEvent!==a?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:a,targetContainers:[i]},t!==null&&(t=tl(t),t!==null&&Ef(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function Gw(e,t,n,r,i){switch(t){case"focusin":return ls=Ma(ls,e,t,n,r,i),!0;case"dragenter":return cs=Ma(cs,e,t,n,r,i),!0;case"mouseover":return us=Ma(us,e,t,n,r,i),!0;case"pointerover":var a=i.pointerId;return Eo.set(a,Ma(Eo.get(a)||null,e,t,n,r,i)),!0;case"gotpointercapture":return a=i.pointerId,No.set(a,Ma(No.get(a)||null,e,t,n,r,i)),!0}return!1}function Pv(e){var t=qs(e.target);if(t!==null){var n=hi(t);if(n!==null){if(t=n.tag,t===13){if(t=wv(n),t!==null){e.blockedOn=t,Ov(e.priority,function(){Rv(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function zl(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Yd(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);Fd=r,n.target.dispatchEvent(r),Fd=null}else return t=tl(n),t!==null&&Ef(t),e.blockedOn=n,!1;t.shift()}return!0}function fm(e,t,n){zl(e)&&n.delete(t)}function Yw(){Gd=!1,ls!==null&&zl(ls)&&(ls=null),cs!==null&&zl(cs)&&(cs=null),us!==null&&zl(us)&&(us=null),Eo.forEach(fm),No.forEach(fm)}function Ua(e,t){e.blockedOn===t&&(e.blockedOn=null,Gd||(Gd=!0,un.unstable_scheduleCallback(un.unstable_NormalPriority,Yw)))}function _o(e){function t(i){return Ua(i,e)}if(0<gl.length){Ua(gl[0],e);for(var n=1;n<gl.length;n++){var r=gl[n];r.blockedOn===e&&(r.blockedOn=null)}}for(ls!==null&&Ua(ls,e),cs!==null&&Ua(cs,e),us!==null&&Ua(us,e),Eo.forEach(t),No.forEach(t),n=0;n<Zr.length;n++)r=Zr[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<Zr.length&&(n=Zr[0],n.blockedOn===null);)Pv(n),n.blockedOn===null&&Zr.shift()}var Qi=Vr.ReactCurrentBatchConfig,vc=!0;function Kw(e,t,n,r){var i=ze,a=Qi.transition;Qi.transition=null;try{ze=1,Nf(e,t,n,r)}finally{ze=i,Qi.transition=a}}function Jw(e,t,n,r){var i=ze,a=Qi.transition;Qi.transition=null;try{ze=4,Nf(e,t,n,r)}finally{ze=i,Qi.transition=a}}function Nf(e,t,n,r){if(vc){var i=Yd(e,t,n,r);if(i===null)Vu(e,t,r,xc,n),hm(e,r);else if(Gw(i,e,t,n,r))r.stopPropagation();else if(hm(e,r),t&4&&-1<Ww.indexOf(e)){for(;i!==null;){var a=tl(i);if(a!==null&&Iv(a),a=Yd(e,t,n,r),a===null&&Vu(e,t,r,xc,n),a===i)break;i=a}i!==null&&r.stopPropagation()}else Vu(e,t,r,null,n)}}var xc=null;function Yd(e,t,n,r){if(xc=null,e=bf(r),e=qs(e),e!==null)if(t=hi(e),t===null)e=null;else if(n=t.tag,n===13){if(e=wv(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return xc=e,null}function Lv(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Mw()){case wf:return 1;case _v:return 4;case gc:case Uw:return 16;case Av:return 536870912;default:return 16}default:return 16}}var rs=null,_f=null,Wl=null;function Dv(){if(Wl)return Wl;var e,t=_f,n=t.length,r,i="value"in rs?rs.value:rs.textContent,a=i.length;for(e=0;e<n&&t[e]===i[e];e++);var o=n-e;for(r=1;r<=o&&t[n-r]===i[a-r];r++);return Wl=i.slice(e,1<r?1-r:void 0)}function Gl(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function yl(){return!0}function pm(){return!1}function hn(e){function t(n,r,i,a,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=a,this.target=o,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(n=e[l],this[l]=n?n(a):a[l]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?yl:pm,this.isPropagationStopped=pm,this}return ot(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=yl)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=yl)},persist:function(){},isPersistent:yl}),t}var va={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Af=hn(va),el=ot({},va,{view:0,detail:0}),Qw=hn(el),Ru,Tu,Ba,Qc=ot({},el,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Cf,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Ba&&(Ba&&e.type==="mousemove"?(Ru=e.screenX-Ba.screenX,Tu=e.screenY-Ba.screenY):Tu=Ru=0,Ba=e),Ru)},movementY:function(e){return"movementY"in e?e.movementY:Tu}}),mm=hn(Qc),Zw=ot({},Qc,{dataTransfer:0}),Xw=hn(Zw),eS=ot({},el,{relatedTarget:0}),Ou=hn(eS),tS=ot({},va,{animationName:0,elapsedTime:0,pseudoElement:0}),nS=hn(tS),rS=ot({},va,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),sS=hn(rS),iS=ot({},va,{data:0}),gm=hn(iS),aS={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},oS={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},lS={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function cS(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=lS[e])?!!t[e]:!1}function Cf(){return cS}var uS=ot({},el,{key:function(e){if(e.key){var t=aS[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Gl(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?oS[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Cf,charCode:function(e){return e.type==="keypress"?Gl(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Gl(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),dS=hn(uS),hS=ot({},Qc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ym=hn(hS),fS=ot({},el,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Cf}),pS=hn(fS),mS=ot({},va,{propertyName:0,elapsedTime:0,pseudoElement:0}),gS=hn(mS),yS=ot({},Qc,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),vS=hn(yS),xS=[9,13,27,32],kf=Dr&&"CompositionEvent"in window,lo=null;Dr&&"documentMode"in document&&(lo=document.documentMode);var jS=Dr&&"TextEvent"in window&&!lo,Mv=Dr&&(!kf||lo&&8<lo&&11>=lo),vm=" ",xm=!1;function Uv(e,t){switch(e){case"keyup":return xS.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Bv(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Li=!1;function bS(e,t){switch(e){case"compositionend":return Bv(t);case"keypress":return t.which!==32?null:(xm=!0,vm);case"textInput":return e=t.data,e===vm&&xm?null:e;default:return null}}function wS(e,t){if(Li)return e==="compositionend"||!kf&&Uv(e,t)?(e=Dv(),Wl=_f=rs=null,Li=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Mv&&t.locale!=="ko"?null:t.data;default:return null}}var SS={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function jm(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!SS[e.type]:t==="textarea"}function Vv(e,t,n,r){yv(r),t=jc(t,"onChange"),0<t.length&&(n=new Af("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var co=null,Ao=null;function ES(e){Qv(e,0)}function Zc(e){var t=Ui(e);if(uv(t))return e}function NS(e,t){if(e==="change")return t}var $v=!1;if(Dr){var Pu;if(Dr){var Lu="oninput"in document;if(!Lu){var bm=document.createElement("div");bm.setAttribute("oninput","return;"),Lu=typeof bm.oninput=="function"}Pu=Lu}else Pu=!1;$v=Pu&&(!document.documentMode||9<document.documentMode)}function wm(){co&&(co.detachEvent("onpropertychange",Fv),Ao=co=null)}function Fv(e){if(e.propertyName==="value"&&Zc(Ao)){var t=[];Vv(t,Ao,e,bf(e)),bv(ES,t)}}function _S(e,t,n){e==="focusin"?(wm(),co=t,Ao=n,co.attachEvent("onpropertychange",Fv)):e==="focusout"&&wm()}function AS(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Zc(Ao)}function CS(e,t){if(e==="click")return Zc(t)}function kS(e,t){if(e==="input"||e==="change")return Zc(t)}function IS(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Wn=typeof Object.is=="function"?Object.is:IS;function Co(e,t){if(Wn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!Id.call(t,i)||!Wn(e[i],t[i]))return!1}return!0}function Sm(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Em(e,t){var n=Sm(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Sm(n)}}function Hv(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Hv(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function qv(){for(var e=window,t=fc();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=fc(e.document)}return t}function If(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function RS(e){var t=qv(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&Hv(n.ownerDocument.documentElement,n)){if(r!==null&&If(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=n.textContent.length,a=Math.min(r.start,i);r=r.end===void 0?a:Math.min(r.end,i),!e.extend&&a>r&&(i=r,r=a,a=i),i=Em(n,a);var o=Em(n,r);i&&o&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),a>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var TS=Dr&&"documentMode"in document&&11>=document.documentMode,Di=null,Kd=null,uo=null,Jd=!1;function Nm(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Jd||Di==null||Di!==fc(r)||(r=Di,"selectionStart"in r&&If(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),uo&&Co(uo,r)||(uo=r,r=jc(Kd,"onSelect"),0<r.length&&(t=new Af("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=Di)))}function vl(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Mi={animationend:vl("Animation","AnimationEnd"),animationiteration:vl("Animation","AnimationIteration"),animationstart:vl("Animation","AnimationStart"),transitionend:vl("Transition","TransitionEnd")},Du={},zv={};Dr&&(zv=document.createElement("div").style,"AnimationEvent"in window||(delete Mi.animationend.animation,delete Mi.animationiteration.animation,delete Mi.animationstart.animation),"TransitionEvent"in window||delete Mi.transitionend.transition);function Xc(e){if(Du[e])return Du[e];if(!Mi[e])return e;var t=Mi[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in zv)return Du[e]=t[n];return e}var Wv=Xc("animationend"),Gv=Xc("animationiteration"),Yv=Xc("animationstart"),Kv=Xc("transitionend"),Jv=new Map,_m="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Es(e,t){Jv.set(e,t),di(t,[e])}for(var Mu=0;Mu<_m.length;Mu++){var Uu=_m[Mu],OS=Uu.toLowerCase(),PS=Uu[0].toUpperCase()+Uu.slice(1);Es(OS,"on"+PS)}Es(Wv,"onAnimationEnd");Es(Gv,"onAnimationIteration");Es(Yv,"onAnimationStart");Es("dblclick","onDoubleClick");Es("focusin","onFocus");Es("focusout","onBlur");Es(Kv,"onTransitionEnd");ia("onMouseEnter",["mouseout","mouseover"]);ia("onMouseLeave",["mouseout","mouseover"]);ia("onPointerEnter",["pointerout","pointerover"]);ia("onPointerLeave",["pointerout","pointerover"]);di("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));di("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));di("onBeforeInput",["compositionend","keypress","textInput","paste"]);di("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));di("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));di("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Xa="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),LS=new Set("cancel close invalid load scroll toggle".split(" ").concat(Xa));function Am(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,Ow(r,t,void 0,e),e.currentTarget=null}function Qv(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var a=void 0;if(t)for(var o=r.length-1;0<=o;o--){var l=r[o],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==a&&i.isPropagationStopped())break e;Am(i,l,u),a=c}else for(o=0;o<r.length;o++){if(l=r[o],c=l.instance,u=l.currentTarget,l=l.listener,c!==a&&i.isPropagationStopped())break e;Am(i,l,u),a=c}}}if(mc)throw e=zd,mc=!1,zd=null,e}function Ke(e,t){var n=t[th];n===void 0&&(n=t[th]=new Set);var r=e+"__bubble";n.has(r)||(Zv(t,e,2,!1),n.add(r))}function Bu(e,t,n){var r=0;t&&(r|=4),Zv(n,e,r,t)}var xl="_reactListening"+Math.random().toString(36).slice(2);function ko(e){if(!e[xl]){e[xl]=!0,iv.forEach(function(n){n!=="selectionchange"&&(LS.has(n)||Bu(n,!1,e),Bu(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[xl]||(t[xl]=!0,Bu("selectionchange",!1,t))}}function Zv(e,t,n,r){switch(Lv(t)){case 1:var i=Kw;break;case 4:i=Jw;break;default:i=Nf}n=i.bind(null,t,n,e),i=void 0,!qd||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),r?i!==void 0?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):i!==void 0?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function Vu(e,t,n,r,i){var a=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===i||l.nodeType===8&&l.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;o=o.return}for(;l!==null;){if(o=qs(l),o===null)return;if(c=o.tag,c===5||c===6){r=a=o;continue e}l=l.parentNode}}r=r.return}bv(function(){var u=a,d=bf(n),p=[];e:{var h=Jv.get(e);if(h!==void 0){var f=Af,y=e;switch(e){case"keypress":if(Gl(n)===0)break e;case"keydown":case"keyup":f=dS;break;case"focusin":y="focus",f=Ou;break;case"focusout":y="blur",f=Ou;break;case"beforeblur":case"afterblur":f=Ou;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=mm;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=Xw;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=pS;break;case Wv:case Gv:case Yv:f=nS;break;case Kv:f=gS;break;case"scroll":f=Qw;break;case"wheel":f=vS;break;case"copy":case"cut":case"paste":f=sS;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=ym}var b=(t&4)!==0,E=!b&&e==="scroll",g=b?h!==null?h+"Capture":null:h;b=[];for(var x=u,w;x!==null;){w=x;var _=w.stateNode;if(w.tag===5&&_!==null&&(w=_,g!==null&&(_=So(x,g),_!=null&&b.push(Io(x,_,w)))),E)break;x=x.return}0<b.length&&(h=new f(h,y,null,n,d),p.push({event:h,listeners:b}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",f=e==="mouseout"||e==="pointerout",h&&n!==Fd&&(y=n.relatedTarget||n.fromElement)&&(qs(y)||y[Mr]))break e;if((f||h)&&(h=d.window===d?d:(h=d.ownerDocument)?h.defaultView||h.parentWindow:window,f?(y=n.relatedTarget||n.toElement,f=u,y=y?qs(y):null,y!==null&&(E=hi(y),y!==E||y.tag!==5&&y.tag!==6)&&(y=null)):(f=null,y=u),f!==y)){if(b=mm,_="onMouseLeave",g="onMouseEnter",x="mouse",(e==="pointerout"||e==="pointerover")&&(b=ym,_="onPointerLeave",g="onPointerEnter",x="pointer"),E=f==null?h:Ui(f),w=y==null?h:Ui(y),h=new b(_,x+"leave",f,n,d),h.target=E,h.relatedTarget=w,_=null,qs(d)===u&&(b=new b(g,x+"enter",y,n,d),b.target=w,b.relatedTarget=E,_=b),E=_,f&&y)t:{for(b=f,g=y,x=0,w=b;w;w=Ci(w))x++;for(w=0,_=g;_;_=Ci(_))w++;for(;0<x-w;)b=Ci(b),x--;for(;0<w-x;)g=Ci(g),w--;for(;x--;){if(b===g||g!==null&&b===g.alternate)break t;b=Ci(b),g=Ci(g)}b=null}else b=null;f!==null&&Cm(p,h,f,b,!1),y!==null&&E!==null&&Cm(p,E,y,b,!0)}}e:{if(h=u?Ui(u):window,f=h.nodeName&&h.nodeName.toLowerCase(),f==="select"||f==="input"&&h.type==="file")var S=NS;else if(jm(h))if($v)S=kS;else{S=AS;var k=_S}else(f=h.nodeName)&&f.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(S=CS);if(S&&(S=S(e,u))){Vv(p,S,n,d);break e}k&&k(e,h,u),e==="focusout"&&(k=h._wrapperState)&&k.controlled&&h.type==="number"&&Md(h,"number",h.value)}switch(k=u?Ui(u):window,e){case"focusin":(jm(k)||k.contentEditable==="true")&&(Di=k,Kd=u,uo=null);break;case"focusout":uo=Kd=Di=null;break;case"mousedown":Jd=!0;break;case"contextmenu":case"mouseup":case"dragend":Jd=!1,Nm(p,n,d);break;case"selectionchange":if(TS)break;case"keydown":case"keyup":Nm(p,n,d)}var I;if(kf)e:{switch(e){case"compositionstart":var C="onCompositionStart";break e;case"compositionend":C="onCompositionEnd";break e;case"compositionupdate":C="onCompositionUpdate";break e}C=void 0}else Li?Uv(e,n)&&(C="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(C="onCompositionStart");C&&(Mv&&n.locale!=="ko"&&(Li||C!=="onCompositionStart"?C==="onCompositionEnd"&&Li&&(I=Dv()):(rs=d,_f="value"in rs?rs.value:rs.textContent,Li=!0)),k=jc(u,C),0<k.length&&(C=new gm(C,e,null,n,d),p.push({event:C,listeners:k}),I?C.data=I:(I=Bv(n),I!==null&&(C.data=I)))),(I=jS?bS(e,n):wS(e,n))&&(u=jc(u,"onBeforeInput"),0<u.length&&(d=new gm("onBeforeInput","beforeinput",null,n,d),p.push({event:d,listeners:u}),d.data=I))}Qv(p,t)})}function Io(e,t,n){return{instance:e,listener:t,currentTarget:n}}function jc(e,t){for(var n=t+"Capture",r=[];e!==null;){var i=e,a=i.stateNode;i.tag===5&&a!==null&&(i=a,a=So(e,n),a!=null&&r.unshift(Io(e,a,i)),a=So(e,t),a!=null&&r.push(Io(e,a,i))),e=e.return}return r}function Ci(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Cm(e,t,n,r,i){for(var a=t._reactName,o=[];n!==null&&n!==r;){var l=n,c=l.alternate,u=l.stateNode;if(c!==null&&c===r)break;l.tag===5&&u!==null&&(l=u,i?(c=So(n,a),c!=null&&o.unshift(Io(n,c,l))):i||(c=So(n,a),c!=null&&o.push(Io(n,c,l)))),n=n.return}o.length!==0&&e.push({event:t,listeners:o})}var DS=/\r\n?/g,MS=/\u0000|\uFFFD/g;function km(e){return(typeof e=="string"?e:""+e).replace(DS,`
`).replace(MS,"")}function jl(e,t,n){if(t=km(t),km(e)!==t&&n)throw Error(ee(425))}function bc(){}var Qd=null,Zd=null;function Xd(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var eh=typeof setTimeout=="function"?setTimeout:void 0,US=typeof clearTimeout=="function"?clearTimeout:void 0,Im=typeof Promise=="function"?Promise:void 0,BS=typeof queueMicrotask=="function"?queueMicrotask:typeof Im<"u"?function(e){return Im.resolve(null).then(e).catch(VS)}:eh;function VS(e){setTimeout(function(){throw e})}function $u(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){e.removeChild(i),_o(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);_o(t)}function ds(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Rm(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var xa=Math.random().toString(36).slice(2),tr="__reactFiber$"+xa,Ro="__reactProps$"+xa,Mr="__reactContainer$"+xa,th="__reactEvents$"+xa,$S="__reactListeners$"+xa,FS="__reactHandles$"+xa;function qs(e){var t=e[tr];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Mr]||n[tr]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=Rm(e);e!==null;){if(n=e[tr])return n;e=Rm(e)}return t}e=n,n=e.parentNode}return null}function tl(e){return e=e[tr]||e[Mr],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Ui(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(ee(33))}function eu(e){return e[Ro]||null}var nh=[],Bi=-1;function Ns(e){return{current:e}}function Ze(e){0>Bi||(e.current=nh[Bi],nh[Bi]=null,Bi--)}function Ye(e,t){Bi++,nh[Bi]=e.current,e.current=t}var ws={},Vt=Ns(ws),Zt=Ns(!1),ri=ws;function aa(e,t){var n=e.type.contextTypes;if(!n)return ws;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i={},a;for(a in n)i[a]=t[a];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Xt(e){return e=e.childContextTypes,e!=null}function wc(){Ze(Zt),Ze(Vt)}function Tm(e,t,n){if(Vt.current!==ws)throw Error(ee(168));Ye(Vt,t),Ye(Zt,n)}function Xv(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in t))throw Error(ee(108,_w(e)||"Unknown",i));return ot({},n,r)}function Sc(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ws,ri=Vt.current,Ye(Vt,e),Ye(Zt,Zt.current),!0}function Om(e,t,n){var r=e.stateNode;if(!r)throw Error(ee(169));n?(e=Xv(e,t,ri),r.__reactInternalMemoizedMergedChildContext=e,Ze(Zt),Ze(Vt),Ye(Vt,e)):Ze(Zt),Ye(Zt,n)}var Ar=null,tu=!1,Fu=!1;function ex(e){Ar===null?Ar=[e]:Ar.push(e)}function HS(e){tu=!0,ex(e)}function _s(){if(!Fu&&Ar!==null){Fu=!0;var e=0,t=ze;try{var n=Ar;for(ze=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}Ar=null,tu=!1}catch(i){throw Ar!==null&&(Ar=Ar.slice(e+1)),Nv(wf,_s),i}finally{ze=t,Fu=!1}}return null}var Vi=[],$i=0,Ec=null,Nc=0,xn=[],jn=0,si=null,Rr=1,Tr="";function Bs(e,t){Vi[$i++]=Nc,Vi[$i++]=Ec,Ec=e,Nc=t}function tx(e,t,n){xn[jn++]=Rr,xn[jn++]=Tr,xn[jn++]=si,si=e;var r=Rr;e=Tr;var i=32-qn(r)-1;r&=~(1<<i),n+=1;var a=32-qn(t)+i;if(30<a){var o=i-i%5;a=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Rr=1<<32-qn(t)+i|n<<i|r,Tr=a+e}else Rr=1<<a|n<<i|r,Tr=e}function Rf(e){e.return!==null&&(Bs(e,1),tx(e,1,0))}function Tf(e){for(;e===Ec;)Ec=Vi[--$i],Vi[$i]=null,Nc=Vi[--$i],Vi[$i]=null;for(;e===si;)si=xn[--jn],xn[jn]=null,Tr=xn[--jn],xn[jn]=null,Rr=xn[--jn],xn[jn]=null}var cn=null,on=null,tt=!1,$n=null;function nx(e,t){var n=Sn(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function Pm(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,cn=e,on=ds(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,cn=e,on=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=si!==null?{id:Rr,overflow:Tr}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=Sn(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,cn=e,on=null,!0):!1;default:return!1}}function rh(e){return(e.mode&1)!==0&&(e.flags&128)===0}function sh(e){if(tt){var t=on;if(t){var n=t;if(!Pm(e,t)){if(rh(e))throw Error(ee(418));t=ds(n.nextSibling);var r=cn;t&&Pm(e,t)?nx(r,n):(e.flags=e.flags&-4097|2,tt=!1,cn=e)}}else{if(rh(e))throw Error(ee(418));e.flags=e.flags&-4097|2,tt=!1,cn=e}}}function Lm(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;cn=e}function bl(e){if(e!==cn)return!1;if(!tt)return Lm(e),tt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Xd(e.type,e.memoizedProps)),t&&(t=on)){if(rh(e))throw rx(),Error(ee(418));for(;t;)nx(e,t),t=ds(t.nextSibling)}if(Lm(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(ee(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){on=ds(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}on=null}}else on=cn?ds(e.stateNode.nextSibling):null;return!0}function rx(){for(var e=on;e;)e=ds(e.nextSibling)}function oa(){on=cn=null,tt=!1}function Of(e){$n===null?$n=[e]:$n.push(e)}var qS=Vr.ReactCurrentBatchConfig;function Va(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ee(309));var r=n.stateNode}if(!r)throw Error(ee(147,e));var i=r,a=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===a?t.ref:(t=function(o){var l=i.refs;o===null?delete l[a]:l[a]=o},t._stringRef=a,t)}if(typeof e!="string")throw Error(ee(284));if(!n._owner)throw Error(ee(290,e))}return e}function wl(e,t){throw e=Object.prototype.toString.call(t),Error(ee(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Dm(e){var t=e._init;return t(e._payload)}function sx(e){function t(g,x){if(e){var w=g.deletions;w===null?(g.deletions=[x],g.flags|=16):w.push(x)}}function n(g,x){if(!e)return null;for(;x!==null;)t(g,x),x=x.sibling;return null}function r(g,x){for(g=new Map;x!==null;)x.key!==null?g.set(x.key,x):g.set(x.index,x),x=x.sibling;return g}function i(g,x){return g=ms(g,x),g.index=0,g.sibling=null,g}function a(g,x,w){return g.index=w,e?(w=g.alternate,w!==null?(w=w.index,w<x?(g.flags|=2,x):w):(g.flags|=2,x)):(g.flags|=1048576,x)}function o(g){return e&&g.alternate===null&&(g.flags|=2),g}function l(g,x,w,_){return x===null||x.tag!==6?(x=Ku(w,g.mode,_),x.return=g,x):(x=i(x,w),x.return=g,x)}function c(g,x,w,_){var S=w.type;return S===Pi?d(g,x,w.props.children,_,w.key):x!==null&&(x.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===Jr&&Dm(S)===x.type)?(_=i(x,w.props),_.ref=Va(g,x,w),_.return=g,_):(_=ec(w.type,w.key,w.props,null,g.mode,_),_.ref=Va(g,x,w),_.return=g,_)}function u(g,x,w,_){return x===null||x.tag!==4||x.stateNode.containerInfo!==w.containerInfo||x.stateNode.implementation!==w.implementation?(x=Ju(w,g.mode,_),x.return=g,x):(x=i(x,w.children||[]),x.return=g,x)}function d(g,x,w,_,S){return x===null||x.tag!==7?(x=Xs(w,g.mode,_,S),x.return=g,x):(x=i(x,w),x.return=g,x)}function p(g,x,w){if(typeof x=="string"&&x!==""||typeof x=="number")return x=Ku(""+x,g.mode,w),x.return=g,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case dl:return w=ec(x.type,x.key,x.props,null,g.mode,w),w.ref=Va(g,null,x),w.return=g,w;case Oi:return x=Ju(x,g.mode,w),x.return=g,x;case Jr:var _=x._init;return p(g,_(x._payload),w)}if(Qa(x)||La(x))return x=Xs(x,g.mode,w,null),x.return=g,x;wl(g,x)}return null}function h(g,x,w,_){var S=x!==null?x.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return S!==null?null:l(g,x,""+w,_);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case dl:return w.key===S?c(g,x,w,_):null;case Oi:return w.key===S?u(g,x,w,_):null;case Jr:return S=w._init,h(g,x,S(w._payload),_)}if(Qa(w)||La(w))return S!==null?null:d(g,x,w,_,null);wl(g,w)}return null}function f(g,x,w,_,S){if(typeof _=="string"&&_!==""||typeof _=="number")return g=g.get(w)||null,l(x,g,""+_,S);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case dl:return g=g.get(_.key===null?w:_.key)||null,c(x,g,_,S);case Oi:return g=g.get(_.key===null?w:_.key)||null,u(x,g,_,S);case Jr:var k=_._init;return f(g,x,w,k(_._payload),S)}if(Qa(_)||La(_))return g=g.get(w)||null,d(x,g,_,S,null);wl(x,_)}return null}function y(g,x,w,_){for(var S=null,k=null,I=x,C=x=0,L=null;I!==null&&C<w.length;C++){I.index>C?(L=I,I=null):L=I.sibling;var V=h(g,I,w[C],_);if(V===null){I===null&&(I=L);break}e&&I&&V.alternate===null&&t(g,I),x=a(V,x,C),k===null?S=V:k.sibling=V,k=V,I=L}if(C===w.length)return n(g,I),tt&&Bs(g,C),S;if(I===null){for(;C<w.length;C++)I=p(g,w[C],_),I!==null&&(x=a(I,x,C),k===null?S=I:k.sibling=I,k=I);return tt&&Bs(g,C),S}for(I=r(g,I);C<w.length;C++)L=f(I,g,C,w[C],_),L!==null&&(e&&L.alternate!==null&&I.delete(L.key===null?C:L.key),x=a(L,x,C),k===null?S=L:k.sibling=L,k=L);return e&&I.forEach(function(B){return t(g,B)}),tt&&Bs(g,C),S}function b(g,x,w,_){var S=La(w);if(typeof S!="function")throw Error(ee(150));if(w=S.call(w),w==null)throw Error(ee(151));for(var k=S=null,I=x,C=x=0,L=null,V=w.next();I!==null&&!V.done;C++,V=w.next()){I.index>C?(L=I,I=null):L=I.sibling;var B=h(g,I,V.value,_);if(B===null){I===null&&(I=L);break}e&&I&&B.alternate===null&&t(g,I),x=a(B,x,C),k===null?S=B:k.sibling=B,k=B,I=L}if(V.done)return n(g,I),tt&&Bs(g,C),S;if(I===null){for(;!V.done;C++,V=w.next())V=p(g,V.value,_),V!==null&&(x=a(V,x,C),k===null?S=V:k.sibling=V,k=V);return tt&&Bs(g,C),S}for(I=r(g,I);!V.done;C++,V=w.next())V=f(I,g,C,V.value,_),V!==null&&(e&&V.alternate!==null&&I.delete(V.key===null?C:V.key),x=a(V,x,C),k===null?S=V:k.sibling=V,k=V);return e&&I.forEach(function(Y){return t(g,Y)}),tt&&Bs(g,C),S}function E(g,x,w,_){if(typeof w=="object"&&w!==null&&w.type===Pi&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case dl:e:{for(var S=w.key,k=x;k!==null;){if(k.key===S){if(S=w.type,S===Pi){if(k.tag===7){n(g,k.sibling),x=i(k,w.props.children),x.return=g,g=x;break e}}else if(k.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===Jr&&Dm(S)===k.type){n(g,k.sibling),x=i(k,w.props),x.ref=Va(g,k,w),x.return=g,g=x;break e}n(g,k);break}else t(g,k);k=k.sibling}w.type===Pi?(x=Xs(w.props.children,g.mode,_,w.key),x.return=g,g=x):(_=ec(w.type,w.key,w.props,null,g.mode,_),_.ref=Va(g,x,w),_.return=g,g=_)}return o(g);case Oi:e:{for(k=w.key;x!==null;){if(x.key===k)if(x.tag===4&&x.stateNode.containerInfo===w.containerInfo&&x.stateNode.implementation===w.implementation){n(g,x.sibling),x=i(x,w.children||[]),x.return=g,g=x;break e}else{n(g,x);break}else t(g,x);x=x.sibling}x=Ju(w,g.mode,_),x.return=g,g=x}return o(g);case Jr:return k=w._init,E(g,x,k(w._payload),_)}if(Qa(w))return y(g,x,w,_);if(La(w))return b(g,x,w,_);wl(g,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,x!==null&&x.tag===6?(n(g,x.sibling),x=i(x,w),x.return=g,g=x):(n(g,x),x=Ku(w,g.mode,_),x.return=g,g=x),o(g)):n(g,x)}return E}var la=sx(!0),ix=sx(!1),_c=Ns(null),Ac=null,Fi=null,Pf=null;function Lf(){Pf=Fi=Ac=null}function Df(e){var t=_c.current;Ze(_c),e._currentValue=t}function ih(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Zi(e,t){Ac=e,Pf=Fi=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Kt=!0),e.firstContext=null)}function Nn(e){var t=e._currentValue;if(Pf!==e)if(e={context:e,memoizedValue:t,next:null},Fi===null){if(Ac===null)throw Error(ee(308));Fi=e,Ac.dependencies={lanes:0,firstContext:e}}else Fi=Fi.next=e;return t}var zs=null;function Mf(e){zs===null?zs=[e]:zs.push(e)}function ax(e,t,n,r){var i=t.interleaved;return i===null?(n.next=n,Mf(t)):(n.next=i.next,i.next=n),t.interleaved=n,Ur(e,r)}function Ur(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var Qr=!1;function Uf(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function ox(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Pr(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function hs(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,Be&2){var i=r.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),r.pending=t,Ur(e,n)}return i=r.interleaved,i===null?(t.next=t,Mf(r)):(t.next=i.next,i.next=t),r.interleaved=t,Ur(e,n)}function Yl(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Sf(e,n)}}function Mm(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,a=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};a===null?i=a=o:a=a.next=o,n=n.next}while(n!==null);a===null?i=a=t:a=a.next=t}else i=a=t;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Cc(e,t,n,r){var i=e.updateQueue;Qr=!1;var a=i.firstBaseUpdate,o=i.lastBaseUpdate,l=i.shared.pending;if(l!==null){i.shared.pending=null;var c=l,u=c.next;c.next=null,o===null?a=u:o.next=u,o=c;var d=e.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==o&&(l===null?d.firstBaseUpdate=u:l.next=u,d.lastBaseUpdate=c))}if(a!==null){var p=i.baseState;o=0,d=u=c=null,l=a;do{var h=l.lane,f=l.eventTime;if((r&h)===h){d!==null&&(d=d.next={eventTime:f,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var y=e,b=l;switch(h=t,f=n,b.tag){case 1:if(y=b.payload,typeof y=="function"){p=y.call(f,p,h);break e}p=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=b.payload,h=typeof y=="function"?y.call(f,p,h):y,h==null)break e;p=ot({},p,h);break e;case 2:Qr=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,h=i.effects,h===null?i.effects=[l]:h.push(l))}else f={eventTime:f,lane:h,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(u=d=f,c=p):d=d.next=f,o|=h;if(l=l.next,l===null){if(l=i.shared.pending,l===null)break;h=l,l=h.next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}while(!0);if(d===null&&(c=p),i.baseState=c,i.firstBaseUpdate=u,i.lastBaseUpdate=d,t=i.shared.interleaved,t!==null){i=t;do o|=i.lane,i=i.next;while(i!==t)}else a===null&&(i.shared.lanes=0);ai|=o,e.lanes=o,e.memoizedState=p}}function Um(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(ee(191,i));i.call(r)}}}var nl={},ar=Ns(nl),To=Ns(nl),Oo=Ns(nl);function Ws(e){if(e===nl)throw Error(ee(174));return e}function Bf(e,t){switch(Ye(Oo,t),Ye(To,e),Ye(ar,nl),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Bd(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Bd(t,e)}Ze(ar),Ye(ar,t)}function ca(){Ze(ar),Ze(To),Ze(Oo)}function lx(e){Ws(Oo.current);var t=Ws(ar.current),n=Bd(t,e.type);t!==n&&(Ye(To,e),Ye(ar,n))}function Vf(e){To.current===e&&(Ze(ar),Ze(To))}var st=Ns(0);function kc(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Hu=[];function $f(){for(var e=0;e<Hu.length;e++)Hu[e]._workInProgressVersionPrimary=null;Hu.length=0}var Kl=Vr.ReactCurrentDispatcher,qu=Vr.ReactCurrentBatchConfig,ii=0,at=null,jt=null,St=null,Ic=!1,ho=!1,Po=0,zS=0;function Lt(){throw Error(ee(321))}function Ff(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Wn(e[n],t[n]))return!1;return!0}function Hf(e,t,n,r,i,a){if(ii=a,at=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Kl.current=e===null||e.memoizedState===null?KS:JS,e=n(r,i),ho){a=0;do{if(ho=!1,Po=0,25<=a)throw Error(ee(301));a+=1,St=jt=null,t.updateQueue=null,Kl.current=QS,e=n(r,i)}while(ho)}if(Kl.current=Rc,t=jt!==null&&jt.next!==null,ii=0,St=jt=at=null,Ic=!1,t)throw Error(ee(300));return e}function qf(){var e=Po!==0;return Po=0,e}function er(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return St===null?at.memoizedState=St=e:St=St.next=e,St}function _n(){if(jt===null){var e=at.alternate;e=e!==null?e.memoizedState:null}else e=jt.next;var t=St===null?at.memoizedState:St.next;if(t!==null)St=t,jt=e;else{if(e===null)throw Error(ee(310));jt=e,e={memoizedState:jt.memoizedState,baseState:jt.baseState,baseQueue:jt.baseQueue,queue:jt.queue,next:null},St===null?at.memoizedState=St=e:St=St.next=e}return St}function Lo(e,t){return typeof t=="function"?t(e):t}function zu(e){var t=_n(),n=t.queue;if(n===null)throw Error(ee(311));n.lastRenderedReducer=e;var r=jt,i=r.baseQueue,a=n.pending;if(a!==null){if(i!==null){var o=i.next;i.next=a.next,a.next=o}r.baseQueue=i=a,n.pending=null}if(i!==null){a=i.next,r=r.baseState;var l=o=null,c=null,u=a;do{var d=u.lane;if((ii&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var p={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=p,o=r):c=c.next=p,at.lanes|=d,ai|=d}u=u.next}while(u!==null&&u!==a);c===null?o=r:c.next=l,Wn(r,t.memoizedState)||(Kt=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=c,n.lastRenderedState=r}if(e=n.interleaved,e!==null){i=e;do a=i.lane,at.lanes|=a,ai|=a,i=i.next;while(i!==e)}else i===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Wu(e){var t=_n(),n=t.queue;if(n===null)throw Error(ee(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,a=t.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do a=e(a,o.action),o=o.next;while(o!==i);Wn(a,t.memoizedState)||(Kt=!0),t.memoizedState=a,t.baseQueue===null&&(t.baseState=a),n.lastRenderedState=a}return[a,r]}function cx(){}function ux(e,t){var n=at,r=_n(),i=t(),a=!Wn(r.memoizedState,i);if(a&&(r.memoizedState=i,Kt=!0),r=r.queue,zf(fx.bind(null,n,r,e),[e]),r.getSnapshot!==t||a||St!==null&&St.memoizedState.tag&1){if(n.flags|=2048,Do(9,hx.bind(null,n,r,i,t),void 0,null),Et===null)throw Error(ee(349));ii&30||dx(n,t,i)}return i}function dx(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=at.updateQueue,t===null?(t={lastEffect:null,stores:null},at.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function hx(e,t,n,r){t.value=n,t.getSnapshot=r,px(t)&&mx(e)}function fx(e,t,n){return n(function(){px(t)&&mx(e)})}function px(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Wn(e,n)}catch{return!0}}function mx(e){var t=Ur(e,1);t!==null&&zn(t,e,1,-1)}function Bm(e){var t=er();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Lo,lastRenderedState:e},t.queue=e,e=e.dispatch=YS.bind(null,at,e),[t.memoizedState,e]}function Do(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=at.updateQueue,t===null?(t={lastEffect:null,stores:null},at.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function gx(){return _n().memoizedState}function Jl(e,t,n,r){var i=er();at.flags|=e,i.memoizedState=Do(1|t,n,void 0,r===void 0?null:r)}function nu(e,t,n,r){var i=_n();r=r===void 0?null:r;var a=void 0;if(jt!==null){var o=jt.memoizedState;if(a=o.destroy,r!==null&&Ff(r,o.deps)){i.memoizedState=Do(t,n,a,r);return}}at.flags|=e,i.memoizedState=Do(1|t,n,a,r)}function Vm(e,t){return Jl(8390656,8,e,t)}function zf(e,t){return nu(2048,8,e,t)}function yx(e,t){return nu(4,2,e,t)}function vx(e,t){return nu(4,4,e,t)}function xx(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function jx(e,t,n){return n=n!=null?n.concat([e]):null,nu(4,4,xx.bind(null,t,e),n)}function Wf(){}function bx(e,t){var n=_n();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Ff(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function wx(e,t){var n=_n();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Ff(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Sx(e,t,n){return ii&21?(Wn(n,t)||(n=Cv(),at.lanes|=n,ai|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Kt=!0),e.memoizedState=n)}function WS(e,t){var n=ze;ze=n!==0&&4>n?n:4,e(!0);var r=qu.transition;qu.transition={};try{e(!1),t()}finally{ze=n,qu.transition=r}}function Ex(){return _n().memoizedState}function GS(e,t,n){var r=ps(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Nx(e))_x(t,n);else if(n=ax(e,t,n,r),n!==null){var i=qt();zn(n,e,r,i),Ax(n,t,r)}}function YS(e,t,n){var r=ps(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Nx(e))_x(t,i);else{var a=e.alternate;if(e.lanes===0&&(a===null||a.lanes===0)&&(a=t.lastRenderedReducer,a!==null))try{var o=t.lastRenderedState,l=a(o,n);if(i.hasEagerState=!0,i.eagerState=l,Wn(l,o)){var c=t.interleaved;c===null?(i.next=i,Mf(t)):(i.next=c.next,c.next=i),t.interleaved=i;return}}catch{}finally{}n=ax(e,t,i,r),n!==null&&(i=qt(),zn(n,e,r,i),Ax(n,t,r))}}function Nx(e){var t=e.alternate;return e===at||t!==null&&t===at}function _x(e,t){ho=Ic=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Ax(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Sf(e,n)}}var Rc={readContext:Nn,useCallback:Lt,useContext:Lt,useEffect:Lt,useImperativeHandle:Lt,useInsertionEffect:Lt,useLayoutEffect:Lt,useMemo:Lt,useReducer:Lt,useRef:Lt,useState:Lt,useDebugValue:Lt,useDeferredValue:Lt,useTransition:Lt,useMutableSource:Lt,useSyncExternalStore:Lt,useId:Lt,unstable_isNewReconciler:!1},KS={readContext:Nn,useCallback:function(e,t){return er().memoizedState=[e,t===void 0?null:t],e},useContext:Nn,useEffect:Vm,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,Jl(4194308,4,xx.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Jl(4194308,4,e,t)},useInsertionEffect:function(e,t){return Jl(4,2,e,t)},useMemo:function(e,t){var n=er();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=er();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=GS.bind(null,at,e),[r.memoizedState,e]},useRef:function(e){var t=er();return e={current:e},t.memoizedState=e},useState:Bm,useDebugValue:Wf,useDeferredValue:function(e){return er().memoizedState=e},useTransition:function(){var e=Bm(!1),t=e[0];return e=WS.bind(null,e[1]),er().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=at,i=er();if(tt){if(n===void 0)throw Error(ee(407));n=n()}else{if(n=t(),Et===null)throw Error(ee(349));ii&30||dx(r,t,n)}i.memoizedState=n;var a={value:n,getSnapshot:t};return i.queue=a,Vm(fx.bind(null,r,a,e),[e]),r.flags|=2048,Do(9,hx.bind(null,r,a,n,t),void 0,null),n},useId:function(){var e=er(),t=Et.identifierPrefix;if(tt){var n=Tr,r=Rr;n=(r&~(1<<32-qn(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=Po++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=zS++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},JS={readContext:Nn,useCallback:bx,useContext:Nn,useEffect:zf,useImperativeHandle:jx,useInsertionEffect:yx,useLayoutEffect:vx,useMemo:wx,useReducer:zu,useRef:gx,useState:function(){return zu(Lo)},useDebugValue:Wf,useDeferredValue:function(e){var t=_n();return Sx(t,jt.memoizedState,e)},useTransition:function(){var e=zu(Lo)[0],t=_n().memoizedState;return[e,t]},useMutableSource:cx,useSyncExternalStore:ux,useId:Ex,unstable_isNewReconciler:!1},QS={readContext:Nn,useCallback:bx,useContext:Nn,useEffect:zf,useImperativeHandle:jx,useInsertionEffect:yx,useLayoutEffect:vx,useMemo:wx,useReducer:Wu,useRef:gx,useState:function(){return Wu(Lo)},useDebugValue:Wf,useDeferredValue:function(e){var t=_n();return jt===null?t.memoizedState=e:Sx(t,jt.memoizedState,e)},useTransition:function(){var e=Wu(Lo)[0],t=_n().memoizedState;return[e,t]},useMutableSource:cx,useSyncExternalStore:ux,useId:Ex,unstable_isNewReconciler:!1};function Un(e,t){if(e&&e.defaultProps){t=ot({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function ah(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:ot({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var ru={isMounted:function(e){return(e=e._reactInternals)?hi(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=qt(),i=ps(e),a=Pr(r,i);a.payload=t,n!=null&&(a.callback=n),t=hs(e,a,i),t!==null&&(zn(t,e,i,r),Yl(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=qt(),i=ps(e),a=Pr(r,i);a.tag=1,a.payload=t,n!=null&&(a.callback=n),t=hs(e,a,i),t!==null&&(zn(t,e,i,r),Yl(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=qt(),r=ps(e),i=Pr(n,r);i.tag=2,t!=null&&(i.callback=t),t=hs(e,i,r),t!==null&&(zn(t,e,r,n),Yl(t,e,r))}};function $m(e,t,n,r,i,a,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,a,o):t.prototype&&t.prototype.isPureReactComponent?!Co(n,r)||!Co(i,a):!0}function Cx(e,t,n){var r=!1,i=ws,a=t.contextType;return typeof a=="object"&&a!==null?a=Nn(a):(i=Xt(t)?ri:Vt.current,r=t.contextTypes,a=(r=r!=null)?aa(e,i):ws),t=new t(n,a),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=ru,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=a),t}function Fm(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&ru.enqueueReplaceState(t,t.state,null)}function oh(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs={},Uf(e);var a=t.contextType;typeof a=="object"&&a!==null?i.context=Nn(a):(a=Xt(t)?ri:Vt.current,i.context=aa(e,a)),i.state=e.memoizedState,a=t.getDerivedStateFromProps,typeof a=="function"&&(ah(e,t,a,n),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&ru.enqueueReplaceState(i,i.state,null),Cc(e,n,i,r),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function ua(e,t){try{var n="",r=t;do n+=Nw(r),r=r.return;while(r);var i=n}catch(a){i=`
Error generating stack: `+a.message+`
`+a.stack}return{value:e,source:t,stack:i,digest:null}}function Gu(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function lh(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var ZS=typeof WeakMap=="function"?WeakMap:Map;function kx(e,t,n){n=Pr(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Oc||(Oc=!0,vh=r),lh(e,t)},n}function Ix(e,t,n){n=Pr(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){lh(e,t)}}var a=e.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(n.callback=function(){lh(e,t),typeof r!="function"&&(fs===null?fs=new Set([this]):fs.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),n}function Hm(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new ZS;var i=new Set;r.set(t,i)}else i=r.get(t),i===void 0&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=hE.bind(null,e,t,n),t.then(e,e))}function qm(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function zm(e,t,n,r,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=Pr(-1,1),t.tag=2,hs(n,t,1))),n.lanes|=1),e)}var XS=Vr.ReactCurrentOwner,Kt=!1;function Ft(e,t,n,r){t.child=e===null?ix(t,null,n,r):la(t,e.child,n,r)}function Wm(e,t,n,r,i){n=n.render;var a=t.ref;return Zi(t,i),r=Hf(e,t,n,r,a,i),n=qf(),e!==null&&!Kt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Br(e,t,i)):(tt&&n&&Rf(t),t.flags|=1,Ft(e,t,r,i),t.child)}function Gm(e,t,n,r,i){if(e===null){var a=n.type;return typeof a=="function"&&!ep(a)&&a.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=a,Rx(e,t,a,r,i)):(e=ec(n.type,null,r,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(a=e.child,!(e.lanes&i)){var o=a.memoizedProps;if(n=n.compare,n=n!==null?n:Co,n(o,r)&&e.ref===t.ref)return Br(e,t,i)}return t.flags|=1,e=ms(a,r),e.ref=t.ref,e.return=t,t.child=e}function Rx(e,t,n,r,i){if(e!==null){var a=e.memoizedProps;if(Co(a,r)&&e.ref===t.ref)if(Kt=!1,t.pendingProps=r=a,(e.lanes&i)!==0)e.flags&131072&&(Kt=!0);else return t.lanes=e.lanes,Br(e,t,i)}return ch(e,t,n,r,i)}function Tx(e,t,n){var r=t.pendingProps,i=r.children,a=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ye(qi,an),an|=n;else{if(!(n&1073741824))return e=a!==null?a.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ye(qi,an),an|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=a!==null?a.baseLanes:n,Ye(qi,an),an|=r}else a!==null?(r=a.baseLanes|n,t.memoizedState=null):r=n,Ye(qi,an),an|=r;return Ft(e,t,i,n),t.child}function Ox(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function ch(e,t,n,r,i){var a=Xt(n)?ri:Vt.current;return a=aa(t,a),Zi(t,i),n=Hf(e,t,n,r,a,i),r=qf(),e!==null&&!Kt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Br(e,t,i)):(tt&&r&&Rf(t),t.flags|=1,Ft(e,t,n,i),t.child)}function Ym(e,t,n,r,i){if(Xt(n)){var a=!0;Sc(t)}else a=!1;if(Zi(t,i),t.stateNode===null)Ql(e,t),Cx(t,n,r),oh(t,n,r,i),r=!0;else if(e===null){var o=t.stateNode,l=t.memoizedProps;o.props=l;var c=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=Nn(u):(u=Xt(n)?ri:Vt.current,u=aa(t,u));var d=n.getDerivedStateFromProps,p=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";p||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||c!==u)&&Fm(t,o,r,u),Qr=!1;var h=t.memoizedState;o.state=h,Cc(t,r,o,i),c=t.memoizedState,l!==r||h!==c||Zt.current||Qr?(typeof d=="function"&&(ah(t,n,d,r),c=t.memoizedState),(l=Qr||$m(t,n,l,r,h,c,u))?(p||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),o.props=r,o.state=c,o.context=u,r=l):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,ox(e,t),l=t.memoizedProps,u=t.type===t.elementType?l:Un(t.type,l),o.props=u,p=t.pendingProps,h=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=Nn(c):(c=Xt(n)?ri:Vt.current,c=aa(t,c));var f=n.getDerivedStateFromProps;(d=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==p||h!==c)&&Fm(t,o,r,c),Qr=!1,h=t.memoizedState,o.state=h,Cc(t,r,o,i);var y=t.memoizedState;l!==p||h!==y||Zt.current||Qr?(typeof f=="function"&&(ah(t,n,f,r),y=t.memoizedState),(u=Qr||$m(t,n,u,r,h,y,c)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,y,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,y,c)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=y),o.props=r,o.state=y,o.context=c,r=u):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return uh(e,t,n,r,a,i)}function uh(e,t,n,r,i,a){Ox(e,t);var o=(t.flags&128)!==0;if(!r&&!o)return i&&Om(t,n,!1),Br(e,t,a);r=t.stateNode,XS.current=t;var l=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&o?(t.child=la(t,e.child,null,a),t.child=la(t,null,l,a)):Ft(e,t,l,a),t.memoizedState=r.state,i&&Om(t,n,!0),t.child}function Px(e){var t=e.stateNode;t.pendingContext?Tm(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Tm(e,t.context,!1),Bf(e,t.containerInfo)}function Km(e,t,n,r,i){return oa(),Of(i),t.flags|=256,Ft(e,t,n,r),t.child}var dh={dehydrated:null,treeContext:null,retryLane:0};function hh(e){return{baseLanes:e,cachePool:null,transitions:null}}function Lx(e,t,n){var r=t.pendingProps,i=st.current,a=!1,o=(t.flags&128)!==0,l;if((l=o)||(l=e!==null&&e.memoizedState===null?!1:(i&2)!==0),l?(a=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),Ye(st,i&1),e===null)return sh(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=r.children,e=r.fallback,a?(r=t.mode,a=t.child,o={mode:"hidden",children:o},!(r&1)&&a!==null?(a.childLanes=0,a.pendingProps=o):a=au(o,r,0,null),e=Xs(e,r,n,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=hh(n),t.memoizedState=dh,e):Gf(t,o));if(i=e.memoizedState,i!==null&&(l=i.dehydrated,l!==null))return eE(e,t,o,r,l,i,n);if(a){a=r.fallback,o=t.mode,i=e.child,l=i.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&t.child!==i?(r=t.child,r.childLanes=0,r.pendingProps=c,t.deletions=null):(r=ms(i,c),r.subtreeFlags=i.subtreeFlags&14680064),l!==null?a=ms(l,a):(a=Xs(a,o,n,null),a.flags|=2),a.return=t,r.return=t,r.sibling=a,t.child=r,r=a,a=t.child,o=e.child.memoizedState,o=o===null?hh(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},a.memoizedState=o,a.childLanes=e.childLanes&~n,t.memoizedState=dh,r}return a=e.child,e=a.sibling,r=ms(a,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function Gf(e,t){return t=au({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Sl(e,t,n,r){return r!==null&&Of(r),la(t,e.child,null,n),e=Gf(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function eE(e,t,n,r,i,a,o){if(n)return t.flags&256?(t.flags&=-257,r=Gu(Error(ee(422))),Sl(e,t,o,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(a=r.fallback,i=t.mode,r=au({mode:"visible",children:r.children},i,0,null),a=Xs(a,i,o,null),a.flags|=2,r.return=t,a.return=t,r.sibling=a,t.child=r,t.mode&1&&la(t,e.child,null,o),t.child.memoizedState=hh(o),t.memoizedState=dh,a);if(!(t.mode&1))return Sl(e,t,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var l=r.dgst;return r=l,a=Error(ee(419)),r=Gu(a,r,void 0),Sl(e,t,o,r)}if(l=(o&e.childLanes)!==0,Kt||l){if(r=Et,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==a.retryLane&&(a.retryLane=i,Ur(e,i),zn(r,e,i,-1))}return Xf(),r=Gu(Error(ee(421))),Sl(e,t,o,r)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=fE.bind(null,e),i._reactRetry=t,null):(e=a.treeContext,on=ds(i.nextSibling),cn=t,tt=!0,$n=null,e!==null&&(xn[jn++]=Rr,xn[jn++]=Tr,xn[jn++]=si,Rr=e.id,Tr=e.overflow,si=t),t=Gf(t,r.children),t.flags|=4096,t)}function Jm(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),ih(e.return,t,n)}function Yu(e,t,n,r,i){var a=e.memoizedState;a===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailMode=i)}function Dx(e,t,n){var r=t.pendingProps,i=r.revealOrder,a=r.tail;if(Ft(e,t,r.children,n),r=st.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Jm(e,n,t);else if(e.tag===19)Jm(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Ye(st,r),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;n!==null;)e=n.alternate,e!==null&&kc(e)===null&&(i=n),n=n.sibling;n=i,n===null?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),Yu(t,!1,i,n,a);break;case"backwards":for(n=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&kc(e)===null){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}Yu(t,!0,n,null,a);break;case"together":Yu(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ql(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Br(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),ai|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(ee(153));if(t.child!==null){for(e=t.child,n=ms(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=ms(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function tE(e,t,n){switch(t.tag){case 3:Px(t),oa();break;case 5:lx(t);break;case 1:Xt(t.type)&&Sc(t);break;case 4:Bf(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;Ye(_c,r._currentValue),r._currentValue=i;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(Ye(st,st.current&1),t.flags|=128,null):n&t.child.childLanes?Lx(e,t,n):(Ye(st,st.current&1),e=Br(e,t,n),e!==null?e.sibling:null);Ye(st,st.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return Dx(e,t,n);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ye(st,st.current),r)break;return null;case 22:case 23:return t.lanes=0,Tx(e,t,n)}return Br(e,t,n)}var Mx,fh,Ux,Bx;Mx=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};fh=function(){};Ux=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,Ws(ar.current);var a=null;switch(n){case"input":i=Ld(e,i),r=Ld(e,r),a=[];break;case"select":i=ot({},i,{value:void 0}),r=ot({},r,{value:void 0}),a=[];break;case"textarea":i=Ud(e,i),r=Ud(e,r),a=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=bc)}Vd(n,r);var o;n=null;for(u in i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var l=i[u];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(bo.hasOwnProperty(u)?a||(a=[]):(a=a||[]).push(u,null));for(u in r){var c=r[u];if(l=i!=null?i[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(a||(a=[]),a.push(u,n)),n=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(a=a||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(a=a||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(bo.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&Ke("scroll",e),a||l===c||(a=[])):(a=a||[]).push(u,c))}n&&(a=a||[]).push("style",n);var u=a;(t.updateQueue=u)&&(t.flags|=4)}};Bx=function(e,t,n,r){n!==r&&(t.flags|=4)};function $a(e,t){if(!tt)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Dt(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function nE(e,t,n){var r=t.pendingProps;switch(Tf(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Dt(t),null;case 1:return Xt(t.type)&&wc(),Dt(t),null;case 3:return r=t.stateNode,ca(),Ze(Zt),Ze(Vt),$f(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(bl(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,$n!==null&&(bh($n),$n=null))),fh(e,t),Dt(t),null;case 5:Vf(t);var i=Ws(Oo.current);if(n=t.type,e!==null&&t.stateNode!=null)Ux(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(ee(166));return Dt(t),null}if(e=Ws(ar.current),bl(t)){r=t.stateNode,n=t.type;var a=t.memoizedProps;switch(r[tr]=t,r[Ro]=a,e=(t.mode&1)!==0,n){case"dialog":Ke("cancel",r),Ke("close",r);break;case"iframe":case"object":case"embed":Ke("load",r);break;case"video":case"audio":for(i=0;i<Xa.length;i++)Ke(Xa[i],r);break;case"source":Ke("error",r);break;case"img":case"image":case"link":Ke("error",r),Ke("load",r);break;case"details":Ke("toggle",r);break;case"input":im(r,a),Ke("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!a.multiple},Ke("invalid",r);break;case"textarea":om(r,a),Ke("invalid",r)}Vd(n,a),i=null;for(var o in a)if(a.hasOwnProperty(o)){var l=a[o];o==="children"?typeof l=="string"?r.textContent!==l&&(a.suppressHydrationWarning!==!0&&jl(r.textContent,l,e),i=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(a.suppressHydrationWarning!==!0&&jl(r.textContent,l,e),i=["children",""+l]):bo.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Ke("scroll",r)}switch(n){case"input":hl(r),am(r,a,!0);break;case"textarea":hl(r),lm(r);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(r.onclick=bc)}r=i,t.updateQueue=r,r!==null&&(t.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=fv(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=o.createElement(n,{is:r.is}):(e=o.createElement(n),n==="select"&&(o=e,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):e=o.createElementNS(e,n),e[tr]=t,e[Ro]=r,Mx(e,t,!1,!1),t.stateNode=e;e:{switch(o=$d(n,r),n){case"dialog":Ke("cancel",e),Ke("close",e),i=r;break;case"iframe":case"object":case"embed":Ke("load",e),i=r;break;case"video":case"audio":for(i=0;i<Xa.length;i++)Ke(Xa[i],e);i=r;break;case"source":Ke("error",e),i=r;break;case"img":case"image":case"link":Ke("error",e),Ke("load",e),i=r;break;case"details":Ke("toggle",e),i=r;break;case"input":im(e,r),i=Ld(e,r),Ke("invalid",e);break;case"option":i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=ot({},r,{value:void 0}),Ke("invalid",e);break;case"textarea":om(e,r),i=Ud(e,r),Ke("invalid",e);break;default:i=r}Vd(n,i),l=i;for(a in l)if(l.hasOwnProperty(a)){var c=l[a];a==="style"?gv(e,c):a==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&pv(e,c)):a==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&wo(e,c):typeof c=="number"&&wo(e,""+c):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(bo.hasOwnProperty(a)?c!=null&&a==="onScroll"&&Ke("scroll",e):c!=null&&yf(e,a,c,o))}switch(n){case"input":hl(e),am(e,r,!1);break;case"textarea":hl(e),lm(e);break;case"option":r.value!=null&&e.setAttribute("value",""+bs(r.value));break;case"select":e.multiple=!!r.multiple,a=r.value,a!=null?Yi(e,!!r.multiple,a,!1):r.defaultValue!=null&&Yi(e,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=bc)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Dt(t),null;case 6:if(e&&t.stateNode!=null)Bx(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(ee(166));if(n=Ws(Oo.current),Ws(ar.current),bl(t)){if(r=t.stateNode,n=t.memoizedProps,r[tr]=t,(a=r.nodeValue!==n)&&(e=cn,e!==null))switch(e.tag){case 3:jl(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&jl(r.nodeValue,n,(e.mode&1)!==0)}a&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[tr]=t,t.stateNode=r}return Dt(t),null;case 13:if(Ze(st),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(tt&&on!==null&&t.mode&1&&!(t.flags&128))rx(),oa(),t.flags|=98560,a=!1;else if(a=bl(t),r!==null&&r.dehydrated!==null){if(e===null){if(!a)throw Error(ee(318));if(a=t.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(ee(317));a[tr]=t}else oa(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Dt(t),a=!1}else $n!==null&&(bh($n),$n=null),a=!0;if(!a)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||st.current&1?bt===0&&(bt=3):Xf())),t.updateQueue!==null&&(t.flags|=4),Dt(t),null);case 4:return ca(),fh(e,t),e===null&&ko(t.stateNode.containerInfo),Dt(t),null;case 10:return Df(t.type._context),Dt(t),null;case 17:return Xt(t.type)&&wc(),Dt(t),null;case 19:if(Ze(st),a=t.memoizedState,a===null)return Dt(t),null;if(r=(t.flags&128)!==0,o=a.rendering,o===null)if(r)$a(a,!1);else{if(bt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=kc(e),o!==null){for(t.flags|=128,$a(a,!1),r=o.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)a=n,e=r,a.flags&=14680066,o=a.alternate,o===null?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=o.childLanes,a.lanes=o.lanes,a.child=o.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=o.memoizedProps,a.memoizedState=o.memoizedState,a.updateQueue=o.updateQueue,a.type=o.type,e=o.dependencies,a.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ye(st,st.current&1|2),t.child}e=e.sibling}a.tail!==null&&ht()>da&&(t.flags|=128,r=!0,$a(a,!1),t.lanes=4194304)}else{if(!r)if(e=kc(o),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),$a(a,!0),a.tail===null&&a.tailMode==="hidden"&&!o.alternate&&!tt)return Dt(t),null}else 2*ht()-a.renderingStartTime>da&&n!==1073741824&&(t.flags|=128,r=!0,$a(a,!1),t.lanes=4194304);a.isBackwards?(o.sibling=t.child,t.child=o):(n=a.last,n!==null?n.sibling=o:t.child=o,a.last=o)}return a.tail!==null?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=ht(),t.sibling=null,n=st.current,Ye(st,r?n&1|2:n&1),t):(Dt(t),null);case 22:case 23:return Zf(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?an&1073741824&&(Dt(t),t.subtreeFlags&6&&(t.flags|=8192)):Dt(t),null;case 24:return null;case 25:return null}throw Error(ee(156,t.tag))}function rE(e,t){switch(Tf(t),t.tag){case 1:return Xt(t.type)&&wc(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return ca(),Ze(Zt),Ze(Vt),$f(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Vf(t),null;case 13:if(Ze(st),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(ee(340));oa()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Ze(st),null;case 4:return ca(),null;case 10:return Df(t.type._context),null;case 22:case 23:return Zf(),null;case 24:return null;default:return null}}var El=!1,Bt=!1,sE=typeof WeakSet=="function"?WeakSet:Set,de=null;function Hi(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){ct(e,t,r)}else n.current=null}function ph(e,t,n){try{n()}catch(r){ct(e,t,r)}}var Qm=!1;function iE(e,t){if(Qd=vc,e=qv(),If(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,a=r.focusNode;r=r.focusOffset;try{n.nodeType,a.nodeType}catch{n=null;break e}var o=0,l=-1,c=-1,u=0,d=0,p=e,h=null;t:for(;;){for(var f;p!==n||i!==0&&p.nodeType!==3||(l=o+i),p!==a||r!==0&&p.nodeType!==3||(c=o+r),p.nodeType===3&&(o+=p.nodeValue.length),(f=p.firstChild)!==null;)h=p,p=f;for(;;){if(p===e)break t;if(h===n&&++u===i&&(l=o),h===a&&++d===r&&(c=o),(f=p.nextSibling)!==null)break;p=h,h=p.parentNode}p=f}n=l===-1||c===-1?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(Zd={focusedElem:e,selectionRange:n},vc=!1,de=t;de!==null;)if(t=de,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,de=e;else for(;de!==null;){t=de;try{var y=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var b=y.memoizedProps,E=y.memoizedState,g=t.stateNode,x=g.getSnapshotBeforeUpdate(t.elementType===t.type?b:Un(t.type,b),E);g.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var w=t.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ee(163))}}catch(_){ct(t,t.return,_)}if(e=t.sibling,e!==null){e.return=t.return,de=e;break}de=t.return}return y=Qm,Qm=!1,y}function fo(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&e)===e){var a=i.destroy;i.destroy=void 0,a!==void 0&&ph(t,n,a)}i=i.next}while(i!==r)}}function su(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function mh(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function Vx(e){var t=e.alternate;t!==null&&(e.alternate=null,Vx(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[tr],delete t[Ro],delete t[th],delete t[$S],delete t[FS])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function $x(e){return e.tag===5||e.tag===3||e.tag===4}function Zm(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||$x(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function gh(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=bc));else if(r!==4&&(e=e.child,e!==null))for(gh(e,t,n),e=e.sibling;e!==null;)gh(e,t,n),e=e.sibling}function yh(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(yh(e,t,n),e=e.sibling;e!==null;)yh(e,t,n),e=e.sibling}var At=null,Bn=!1;function Gr(e,t,n){for(n=n.child;n!==null;)Fx(e,t,n),n=n.sibling}function Fx(e,t,n){if(ir&&typeof ir.onCommitFiberUnmount=="function")try{ir.onCommitFiberUnmount(Jc,n)}catch{}switch(n.tag){case 5:Bt||Hi(n,t);case 6:var r=At,i=Bn;At=null,Gr(e,t,n),At=r,Bn=i,At!==null&&(Bn?(e=At,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):At.removeChild(n.stateNode));break;case 18:At!==null&&(Bn?(e=At,n=n.stateNode,e.nodeType===8?$u(e.parentNode,n):e.nodeType===1&&$u(e,n),_o(e)):$u(At,n.stateNode));break;case 4:r=At,i=Bn,At=n.stateNode.containerInfo,Bn=!0,Gr(e,t,n),At=r,Bn=i;break;case 0:case 11:case 14:case 15:if(!Bt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var a=i,o=a.destroy;a=a.tag,o!==void 0&&(a&2||a&4)&&ph(n,t,o),i=i.next}while(i!==r)}Gr(e,t,n);break;case 1:if(!Bt&&(Hi(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){ct(n,t,l)}Gr(e,t,n);break;case 21:Gr(e,t,n);break;case 22:n.mode&1?(Bt=(r=Bt)||n.memoizedState!==null,Gr(e,t,n),Bt=r):Gr(e,t,n);break;default:Gr(e,t,n)}}function Xm(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new sE),t.forEach(function(r){var i=pE.bind(null,e,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Ln(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var a=e,o=t,l=o;e:for(;l!==null;){switch(l.tag){case 5:At=l.stateNode,Bn=!1;break e;case 3:At=l.stateNode.containerInfo,Bn=!0;break e;case 4:At=l.stateNode.containerInfo,Bn=!0;break e}l=l.return}if(At===null)throw Error(ee(160));Fx(a,o,i),At=null,Bn=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(u){ct(i,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Hx(t,e),t=t.sibling}function Hx(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Ln(t,e),Qn(e),r&4){try{fo(3,e,e.return),su(3,e)}catch(b){ct(e,e.return,b)}try{fo(5,e,e.return)}catch(b){ct(e,e.return,b)}}break;case 1:Ln(t,e),Qn(e),r&512&&n!==null&&Hi(n,n.return);break;case 5:if(Ln(t,e),Qn(e),r&512&&n!==null&&Hi(n,n.return),e.flags&32){var i=e.stateNode;try{wo(i,"")}catch(b){ct(e,e.return,b)}}if(r&4&&(i=e.stateNode,i!=null)){var a=e.memoizedProps,o=n!==null?n.memoizedProps:a,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&a.type==="radio"&&a.name!=null&&dv(i,a),$d(l,o);var u=$d(l,a);for(o=0;o<c.length;o+=2){var d=c[o],p=c[o+1];d==="style"?gv(i,p):d==="dangerouslySetInnerHTML"?pv(i,p):d==="children"?wo(i,p):yf(i,d,p,u)}switch(l){case"input":Dd(i,a);break;case"textarea":hv(i,a);break;case"select":var h=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!a.multiple;var f=a.value;f!=null?Yi(i,!!a.multiple,f,!1):h!==!!a.multiple&&(a.defaultValue!=null?Yi(i,!!a.multiple,a.defaultValue,!0):Yi(i,!!a.multiple,a.multiple?[]:"",!1))}i[Ro]=a}catch(b){ct(e,e.return,b)}}break;case 6:if(Ln(t,e),Qn(e),r&4){if(e.stateNode===null)throw Error(ee(162));i=e.stateNode,a=e.memoizedProps;try{i.nodeValue=a}catch(b){ct(e,e.return,b)}}break;case 3:if(Ln(t,e),Qn(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{_o(t.containerInfo)}catch(b){ct(e,e.return,b)}break;case 4:Ln(t,e),Qn(e);break;case 13:Ln(t,e),Qn(e),i=e.child,i.flags&8192&&(a=i.memoizedState!==null,i.stateNode.isHidden=a,!a||i.alternate!==null&&i.alternate.memoizedState!==null||(Jf=ht())),r&4&&Xm(e);break;case 22:if(d=n!==null&&n.memoizedState!==null,e.mode&1?(Bt=(u=Bt)||d,Ln(t,e),Bt=u):Ln(t,e),Qn(e),r&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!d&&e.mode&1)for(de=e,d=e.child;d!==null;){for(p=de=d;de!==null;){switch(h=de,f=h.child,h.tag){case 0:case 11:case 14:case 15:fo(4,h,h.return);break;case 1:Hi(h,h.return);var y=h.stateNode;if(typeof y.componentWillUnmount=="function"){r=h,n=h.return;try{t=r,y.props=t.memoizedProps,y.state=t.memoizedState,y.componentWillUnmount()}catch(b){ct(r,n,b)}}break;case 5:Hi(h,h.return);break;case 22:if(h.memoizedState!==null){tg(p);continue}}f!==null?(f.return=h,de=f):tg(p)}d=d.sibling}e:for(d=null,p=e;;){if(p.tag===5){if(d===null){d=p;try{i=p.stateNode,u?(a=i.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(l=p.stateNode,c=p.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=mv("display",o))}catch(b){ct(e,e.return,b)}}}else if(p.tag===6){if(d===null)try{p.stateNode.nodeValue=u?"":p.memoizedProps}catch(b){ct(e,e.return,b)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===e)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===e)break e;for(;p.sibling===null;){if(p.return===null||p.return===e)break e;d===p&&(d=null),p=p.return}d===p&&(d=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:Ln(t,e),Qn(e),r&4&&Xm(e);break;case 21:break;default:Ln(t,e),Qn(e)}}function Qn(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if($x(n)){var r=n;break e}n=n.return}throw Error(ee(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(wo(i,""),r.flags&=-33);var a=Zm(e);yh(e,a,i);break;case 3:case 4:var o=r.stateNode.containerInfo,l=Zm(e);gh(e,l,o);break;default:throw Error(ee(161))}}catch(c){ct(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function aE(e,t,n){de=e,qx(e)}function qx(e,t,n){for(var r=(e.mode&1)!==0;de!==null;){var i=de,a=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||El;if(!o){var l=i.alternate,c=l!==null&&l.memoizedState!==null||Bt;l=El;var u=Bt;if(El=o,(Bt=c)&&!u)for(de=i;de!==null;)o=de,c=o.child,o.tag===22&&o.memoizedState!==null?ng(i):c!==null?(c.return=o,de=c):ng(i);for(;a!==null;)de=a,qx(a),a=a.sibling;de=i,El=l,Bt=u}eg(e)}else i.subtreeFlags&8772&&a!==null?(a.return=i,de=a):eg(e)}}function eg(e){for(;de!==null;){var t=de;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Bt||su(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!Bt)if(n===null)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:Un(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;a!==null&&Um(t,a,r);break;case 3:var o=t.updateQueue;if(o!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}Um(t,o,n)}break;case 5:var l=t.stateNode;if(n===null&&t.flags&4){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var p=d.dehydrated;p!==null&&_o(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ee(163))}Bt||t.flags&512&&mh(t)}catch(h){ct(t,t.return,h)}}if(t===e){de=null;break}if(n=t.sibling,n!==null){n.return=t.return,de=n;break}de=t.return}}function tg(e){for(;de!==null;){var t=de;if(t===e){de=null;break}var n=t.sibling;if(n!==null){n.return=t.return,de=n;break}de=t.return}}function ng(e){for(;de!==null;){var t=de;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{su(4,t)}catch(c){ct(t,n,c)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var i=t.return;try{r.componentDidMount()}catch(c){ct(t,i,c)}}var a=t.return;try{mh(t)}catch(c){ct(t,a,c)}break;case 5:var o=t.return;try{mh(t)}catch(c){ct(t,o,c)}}}catch(c){ct(t,t.return,c)}if(t===e){de=null;break}var l=t.sibling;if(l!==null){l.return=t.return,de=l;break}de=t.return}}var oE=Math.ceil,Tc=Vr.ReactCurrentDispatcher,Yf=Vr.ReactCurrentOwner,En=Vr.ReactCurrentBatchConfig,Be=0,Et=null,gt=null,Tt=0,an=0,qi=Ns(0),bt=0,Mo=null,ai=0,iu=0,Kf=0,po=null,Yt=null,Jf=0,da=1/0,_r=null,Oc=!1,vh=null,fs=null,Nl=!1,ss=null,Pc=0,mo=0,xh=null,Zl=-1,Xl=0;function qt(){return Be&6?ht():Zl!==-1?Zl:Zl=ht()}function ps(e){return e.mode&1?Be&2&&Tt!==0?Tt&-Tt:qS.transition!==null?(Xl===0&&(Xl=Cv()),Xl):(e=ze,e!==0||(e=window.event,e=e===void 0?16:Lv(e.type)),e):1}function zn(e,t,n,r){if(50<mo)throw mo=0,xh=null,Error(ee(185));Xo(e,n,r),(!(Be&2)||e!==Et)&&(e===Et&&(!(Be&2)&&(iu|=n),bt===4&&Xr(e,Tt)),en(e,r),n===1&&Be===0&&!(t.mode&1)&&(da=ht()+500,tu&&_s()))}function en(e,t){var n=e.callbackNode;qw(e,t);var r=yc(e,e===Et?Tt:0);if(r===0)n!==null&&dm(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&dm(n),t===1)e.tag===0?HS(rg.bind(null,e)):ex(rg.bind(null,e)),BS(function(){!(Be&6)&&_s()}),n=null;else{switch(kv(r)){case 1:n=wf;break;case 4:n=_v;break;case 16:n=gc;break;case 536870912:n=Av;break;default:n=gc}n=Zx(n,zx.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function zx(e,t){if(Zl=-1,Xl=0,Be&6)throw Error(ee(327));var n=e.callbackNode;if(Xi()&&e.callbackNode!==n)return null;var r=yc(e,e===Et?Tt:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=Lc(e,r);else{t=r;var i=Be;Be|=2;var a=Gx();(Et!==e||Tt!==t)&&(_r=null,da=ht()+500,Zs(e,t));do try{uE();break}catch(l){Wx(e,l)}while(!0);Lf(),Tc.current=a,Be=i,gt!==null?t=0:(Et=null,Tt=0,t=bt)}if(t!==0){if(t===2&&(i=Wd(e),i!==0&&(r=i,t=jh(e,i))),t===1)throw n=Mo,Zs(e,0),Xr(e,r),en(e,ht()),n;if(t===6)Xr(e,r);else{if(i=e.current.alternate,!(r&30)&&!lE(i)&&(t=Lc(e,r),t===2&&(a=Wd(e),a!==0&&(r=a,t=jh(e,a))),t===1))throw n=Mo,Zs(e,0),Xr(e,r),en(e,ht()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(ee(345));case 2:Vs(e,Yt,_r);break;case 3:if(Xr(e,r),(r&130023424)===r&&(t=Jf+500-ht(),10<t)){if(yc(e,0)!==0)break;if(i=e.suspendedLanes,(i&r)!==r){qt(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=eh(Vs.bind(null,e,Yt,_r),t);break}Vs(e,Yt,_r);break;case 4:if(Xr(e,r),(r&4194240)===r)break;for(t=e.eventTimes,i=-1;0<r;){var o=31-qn(r);a=1<<o,o=t[o],o>i&&(i=o),r&=~a}if(r=i,r=ht()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*oE(r/1960))-r,10<r){e.timeoutHandle=eh(Vs.bind(null,e,Yt,_r),r);break}Vs(e,Yt,_r);break;case 5:Vs(e,Yt,_r);break;default:throw Error(ee(329))}}}return en(e,ht()),e.callbackNode===n?zx.bind(null,e):null}function jh(e,t){var n=po;return e.current.memoizedState.isDehydrated&&(Zs(e,t).flags|=256),e=Lc(e,t),e!==2&&(t=Yt,Yt=n,t!==null&&bh(t)),e}function bh(e){Yt===null?Yt=e:Yt.push.apply(Yt,e)}function lE(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],a=i.getSnapshot;i=i.value;try{if(!Wn(a(),i))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Xr(e,t){for(t&=~Kf,t&=~iu,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-qn(t),r=1<<n;e[n]=-1,t&=~r}}function rg(e){if(Be&6)throw Error(ee(327));Xi();var t=yc(e,0);if(!(t&1))return en(e,ht()),null;var n=Lc(e,t);if(e.tag!==0&&n===2){var r=Wd(e);r!==0&&(t=r,n=jh(e,r))}if(n===1)throw n=Mo,Zs(e,0),Xr(e,t),en(e,ht()),n;if(n===6)throw Error(ee(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Vs(e,Yt,_r),en(e,ht()),null}function Qf(e,t){var n=Be;Be|=1;try{return e(t)}finally{Be=n,Be===0&&(da=ht()+500,tu&&_s())}}function oi(e){ss!==null&&ss.tag===0&&!(Be&6)&&Xi();var t=Be;Be|=1;var n=En.transition,r=ze;try{if(En.transition=null,ze=1,e)return e()}finally{ze=r,En.transition=n,Be=t,!(Be&6)&&_s()}}function Zf(){an=qi.current,Ze(qi)}function Zs(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,US(n)),gt!==null)for(n=gt.return;n!==null;){var r=n;switch(Tf(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&wc();break;case 3:ca(),Ze(Zt),Ze(Vt),$f();break;case 5:Vf(r);break;case 4:ca();break;case 13:Ze(st);break;case 19:Ze(st);break;case 10:Df(r.type._context);break;case 22:case 23:Zf()}n=n.return}if(Et=e,gt=e=ms(e.current,null),Tt=an=t,bt=0,Mo=null,Kf=iu=ai=0,Yt=po=null,zs!==null){for(t=0;t<zs.length;t++)if(n=zs[t],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,a=n.pending;if(a!==null){var o=a.next;a.next=i,r.next=o}n.pending=r}zs=null}return e}function Wx(e,t){do{var n=gt;try{if(Lf(),Kl.current=Rc,Ic){for(var r=at.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Ic=!1}if(ii=0,St=jt=at=null,ho=!1,Po=0,Yf.current=null,n===null||n.return===null){bt=1,Mo=t,gt=null;break}e:{var a=e,o=n.return,l=n,c=t;if(t=Tt,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=l,p=d.tag;if(!(d.mode&1)&&(p===0||p===11||p===15)){var h=d.alternate;h?(d.updateQueue=h.updateQueue,d.memoizedState=h.memoizedState,d.lanes=h.lanes):(d.updateQueue=null,d.memoizedState=null)}var f=qm(o);if(f!==null){f.flags&=-257,zm(f,o,l,a,t),f.mode&1&&Hm(a,u,t),t=f,c=u;var y=t.updateQueue;if(y===null){var b=new Set;b.add(c),t.updateQueue=b}else y.add(c);break e}else{if(!(t&1)){Hm(a,u,t),Xf();break e}c=Error(ee(426))}}else if(tt&&l.mode&1){var E=qm(o);if(E!==null){!(E.flags&65536)&&(E.flags|=256),zm(E,o,l,a,t),Of(ua(c,l));break e}}a=c=ua(c,l),bt!==4&&(bt=2),po===null?po=[a]:po.push(a),a=o;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t;var g=kx(a,c,t);Mm(a,g);break e;case 1:l=c;var x=a.type,w=a.stateNode;if(!(a.flags&128)&&(typeof x.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(fs===null||!fs.has(w)))){a.flags|=65536,t&=-t,a.lanes|=t;var _=Ix(a,l,t);Mm(a,_);break e}}a=a.return}while(a!==null)}Kx(n)}catch(S){t=S,gt===n&&n!==null&&(gt=n=n.return);continue}break}while(!0)}function Gx(){var e=Tc.current;return Tc.current=Rc,e===null?Rc:e}function Xf(){(bt===0||bt===3||bt===2)&&(bt=4),Et===null||!(ai&268435455)&&!(iu&268435455)||Xr(Et,Tt)}function Lc(e,t){var n=Be;Be|=2;var r=Gx();(Et!==e||Tt!==t)&&(_r=null,Zs(e,t));do try{cE();break}catch(i){Wx(e,i)}while(!0);if(Lf(),Be=n,Tc.current=r,gt!==null)throw Error(ee(261));return Et=null,Tt=0,bt}function cE(){for(;gt!==null;)Yx(gt)}function uE(){for(;gt!==null&&!Lw();)Yx(gt)}function Yx(e){var t=Qx(e.alternate,e,an);e.memoizedProps=e.pendingProps,t===null?Kx(e):gt=t,Yf.current=null}function Kx(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=rE(n,t),n!==null){n.flags&=32767,gt=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{bt=6,gt=null;return}}else if(n=nE(n,t,an),n!==null){gt=n;return}if(t=t.sibling,t!==null){gt=t;return}gt=t=e}while(t!==null);bt===0&&(bt=5)}function Vs(e,t,n){var r=ze,i=En.transition;try{En.transition=null,ze=1,dE(e,t,n,r)}finally{En.transition=i,ze=r}return null}function dE(e,t,n,r){do Xi();while(ss!==null);if(Be&6)throw Error(ee(327));n=e.finishedWork;var i=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(ee(177));e.callbackNode=null,e.callbackPriority=0;var a=n.lanes|n.childLanes;if(zw(e,a),e===Et&&(gt=Et=null,Tt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Nl||(Nl=!0,Zx(gc,function(){return Xi(),null})),a=(n.flags&15990)!==0,n.subtreeFlags&15990||a){a=En.transition,En.transition=null;var o=ze;ze=1;var l=Be;Be|=4,Yf.current=null,iE(e,n),Hx(n,e),RS(Zd),vc=!!Qd,Zd=Qd=null,e.current=n,aE(n),Dw(),Be=l,ze=o,En.transition=a}else e.current=n;if(Nl&&(Nl=!1,ss=e,Pc=i),a=e.pendingLanes,a===0&&(fs=null),Bw(n.stateNode),en(e,ht()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Oc)throw Oc=!1,e=vh,vh=null,e;return Pc&1&&e.tag!==0&&Xi(),a=e.pendingLanes,a&1?e===xh?mo++:(mo=0,xh=e):mo=0,_s(),null}function Xi(){if(ss!==null){var e=kv(Pc),t=En.transition,n=ze;try{if(En.transition=null,ze=16>e?16:e,ss===null)var r=!1;else{if(e=ss,ss=null,Pc=0,Be&6)throw Error(ee(331));var i=Be;for(Be|=4,de=e.current;de!==null;){var a=de,o=a.child;if(de.flags&16){var l=a.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(de=u;de!==null;){var d=de;switch(d.tag){case 0:case 11:case 15:fo(8,d,a)}var p=d.child;if(p!==null)p.return=d,de=p;else for(;de!==null;){d=de;var h=d.sibling,f=d.return;if(Vx(d),d===u){de=null;break}if(h!==null){h.return=f,de=h;break}de=f}}}var y=a.alternate;if(y!==null){var b=y.child;if(b!==null){y.child=null;do{var E=b.sibling;b.sibling=null,b=E}while(b!==null)}}de=a}}if(a.subtreeFlags&2064&&o!==null)o.return=a,de=o;else e:for(;de!==null;){if(a=de,a.flags&2048)switch(a.tag){case 0:case 11:case 15:fo(9,a,a.return)}var g=a.sibling;if(g!==null){g.return=a.return,de=g;break e}de=a.return}}var x=e.current;for(de=x;de!==null;){o=de;var w=o.child;if(o.subtreeFlags&2064&&w!==null)w.return=o,de=w;else e:for(o=x;de!==null;){if(l=de,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:su(9,l)}}catch(S){ct(l,l.return,S)}if(l===o){de=null;break e}var _=l.sibling;if(_!==null){_.return=l.return,de=_;break e}de=l.return}}if(Be=i,_s(),ir&&typeof ir.onPostCommitFiberRoot=="function")try{ir.onPostCommitFiberRoot(Jc,e)}catch{}r=!0}return r}finally{ze=n,En.transition=t}}return!1}function sg(e,t,n){t=ua(n,t),t=kx(e,t,1),e=hs(e,t,1),t=qt(),e!==null&&(Xo(e,1,t),en(e,t))}function ct(e,t,n){if(e.tag===3)sg(e,e,n);else for(;t!==null;){if(t.tag===3){sg(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(fs===null||!fs.has(r))){e=ua(n,e),e=Ix(t,e,1),t=hs(t,e,1),e=qt(),t!==null&&(Xo(t,1,e),en(t,e));break}}t=t.return}}function hE(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=qt(),e.pingedLanes|=e.suspendedLanes&n,Et===e&&(Tt&n)===n&&(bt===4||bt===3&&(Tt&130023424)===Tt&&500>ht()-Jf?Zs(e,0):Kf|=n),en(e,t)}function Jx(e,t){t===0&&(e.mode&1?(t=ml,ml<<=1,!(ml&130023424)&&(ml=4194304)):t=1);var n=qt();e=Ur(e,t),e!==null&&(Xo(e,t,n),en(e,n))}function fE(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Jx(e,n)}function pE(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(ee(314))}r!==null&&r.delete(t),Jx(e,n)}var Qx;Qx=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||Zt.current)Kt=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return Kt=!1,tE(e,t,n);Kt=!!(e.flags&131072)}else Kt=!1,tt&&t.flags&1048576&&tx(t,Nc,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Ql(e,t),e=t.pendingProps;var i=aa(t,Vt.current);Zi(t,n),i=Hf(null,t,r,e,i,n);var a=qf();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Xt(r)?(a=!0,Sc(t)):a=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Uf(t),i.updater=ru,t.stateNode=i,i._reactInternals=t,oh(t,r,e,n),t=uh(null,t,r,!0,a,n)):(t.tag=0,tt&&a&&Rf(t),Ft(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Ql(e,t),e=t.pendingProps,i=r._init,r=i(r._payload),t.type=r,i=t.tag=gE(r),e=Un(r,e),i){case 0:t=ch(null,t,r,e,n);break e;case 1:t=Ym(null,t,r,e,n);break e;case 11:t=Wm(null,t,r,e,n);break e;case 14:t=Gm(null,t,r,Un(r.type,e),n);break e}throw Error(ee(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:Un(r,i),ch(e,t,r,i,n);case 1:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:Un(r,i),Ym(e,t,r,i,n);case 3:e:{if(Px(t),e===null)throw Error(ee(387));r=t.pendingProps,a=t.memoizedState,i=a.element,ox(e,t),Cc(t,r,null,n);var o=t.memoizedState;if(r=o.element,a.isDehydrated)if(a={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=a,t.memoizedState=a,t.flags&256){i=ua(Error(ee(423)),t),t=Km(e,t,r,n,i);break e}else if(r!==i){i=ua(Error(ee(424)),t),t=Km(e,t,r,n,i);break e}else for(on=ds(t.stateNode.containerInfo.firstChild),cn=t,tt=!0,$n=null,n=ix(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(oa(),r===i){t=Br(e,t,n);break e}Ft(e,t,r,n)}t=t.child}return t;case 5:return lx(t),e===null&&sh(t),r=t.type,i=t.pendingProps,a=e!==null?e.memoizedProps:null,o=i.children,Xd(r,i)?o=null:a!==null&&Xd(r,a)&&(t.flags|=32),Ox(e,t),Ft(e,t,o,n),t.child;case 6:return e===null&&sh(t),null;case 13:return Lx(e,t,n);case 4:return Bf(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=la(t,null,r,n):Ft(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:Un(r,i),Wm(e,t,r,i,n);case 7:return Ft(e,t,t.pendingProps,n),t.child;case 8:return Ft(e,t,t.pendingProps.children,n),t.child;case 12:return Ft(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,a=t.memoizedProps,o=i.value,Ye(_c,r._currentValue),r._currentValue=o,a!==null)if(Wn(a.value,o)){if(a.children===i.children&&!Zt.current){t=Br(e,t,n);break e}}else for(a=t.child,a!==null&&(a.return=t);a!==null;){var l=a.dependencies;if(l!==null){o=a.child;for(var c=l.firstContext;c!==null;){if(c.context===r){if(a.tag===1){c=Pr(-1,n&-n),c.tag=2;var u=a.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}a.lanes|=n,c=a.alternate,c!==null&&(c.lanes|=n),ih(a.return,n,t),l.lanes|=n;break}c=c.next}}else if(a.tag===10)o=a.type===t.type?null:a.child;else if(a.tag===18){if(o=a.return,o===null)throw Error(ee(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),ih(o,n,t),o=a.sibling}else o=a.child;if(o!==null)o.return=a;else for(o=a;o!==null;){if(o===t){o=null;break}if(a=o.sibling,a!==null){a.return=o.return,o=a;break}o=o.return}a=o}Ft(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,Zi(t,n),i=Nn(i),r=r(i),t.flags|=1,Ft(e,t,r,n),t.child;case 14:return r=t.type,i=Un(r,t.pendingProps),i=Un(r.type,i),Gm(e,t,r,i,n);case 15:return Rx(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:Un(r,i),Ql(e,t),t.tag=1,Xt(r)?(e=!0,Sc(t)):e=!1,Zi(t,n),Cx(t,r,i),oh(t,r,i,n),uh(null,t,r,!0,e,n);case 19:return Dx(e,t,n);case 22:return Tx(e,t,n)}throw Error(ee(156,t.tag))};function Zx(e,t){return Nv(e,t)}function mE(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Sn(e,t,n,r){return new mE(e,t,n,r)}function ep(e){return e=e.prototype,!(!e||!e.isReactComponent)}function gE(e){if(typeof e=="function")return ep(e)?1:0;if(e!=null){if(e=e.$$typeof,e===xf)return 11;if(e===jf)return 14}return 2}function ms(e,t){var n=e.alternate;return n===null?(n=Sn(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function ec(e,t,n,r,i,a){var o=2;if(r=e,typeof e=="function")ep(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case Pi:return Xs(n.children,i,a,t);case vf:o=8,i|=8;break;case Rd:return e=Sn(12,n,t,i|2),e.elementType=Rd,e.lanes=a,e;case Td:return e=Sn(13,n,t,i),e.elementType=Td,e.lanes=a,e;case Od:return e=Sn(19,n,t,i),e.elementType=Od,e.lanes=a,e;case lv:return au(n,i,a,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case av:o=10;break e;case ov:o=9;break e;case xf:o=11;break e;case jf:o=14;break e;case Jr:o=16,r=null;break e}throw Error(ee(130,e==null?e:typeof e,""))}return t=Sn(o,n,t,i),t.elementType=e,t.type=r,t.lanes=a,t}function Xs(e,t,n,r){return e=Sn(7,e,r,t),e.lanes=n,e}function au(e,t,n,r){return e=Sn(22,e,r,t),e.elementType=lv,e.lanes=n,e.stateNode={isHidden:!1},e}function Ku(e,t,n){return e=Sn(6,e,null,t),e.lanes=n,e}function Ju(e,t,n){return t=Sn(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function yE(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Iu(0),this.expirationTimes=Iu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Iu(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function tp(e,t,n,r,i,a,o,l,c){return e=new yE(e,t,n,l,c),t===1?(t=1,a===!0&&(t|=8)):t=0,a=Sn(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Uf(a),e}function vE(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Oi,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function Xx(e){if(!e)return ws;e=e._reactInternals;e:{if(hi(e)!==e||e.tag!==1)throw Error(ee(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Xt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(ee(171))}if(e.tag===1){var n=e.type;if(Xt(n))return Xv(e,n,t)}return t}function ej(e,t,n,r,i,a,o,l,c){return e=tp(n,r,!0,e,i,a,o,l,c),e.context=Xx(null),n=e.current,r=qt(),i=ps(n),a=Pr(r,i),a.callback=t??null,hs(n,a,i),e.current.lanes=i,Xo(e,i,r),en(e,r),e}function ou(e,t,n,r){var i=t.current,a=qt(),o=ps(i);return n=Xx(n),t.context===null?t.context=n:t.pendingContext=n,t=Pr(a,o),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=hs(i,t,o),e!==null&&(zn(e,i,o,a),Yl(e,i,o)),o}function Dc(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function ig(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function np(e,t){ig(e,t),(e=e.alternate)&&ig(e,t)}function xE(){return null}var tj=typeof reportError=="function"?reportError:function(e){console.error(e)};function rp(e){this._internalRoot=e}lu.prototype.render=rp.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(ee(409));ou(e,t,null,null)};lu.prototype.unmount=rp.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;oi(function(){ou(null,e,null,null)}),t[Mr]=null}};function lu(e){this._internalRoot=e}lu.prototype.unstable_scheduleHydration=function(e){if(e){var t=Tv();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Zr.length&&t!==0&&t<Zr[n].priority;n++);Zr.splice(n,0,e),n===0&&Pv(e)}};function sp(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function cu(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function ag(){}function jE(e,t,n,r,i){if(i){if(typeof r=="function"){var a=r;r=function(){var u=Dc(o);a.call(u)}}var o=ej(t,r,e,0,null,!1,!1,"",ag);return e._reactRootContainer=o,e[Mr]=o.current,ko(e.nodeType===8?e.parentNode:e),oi(),o}for(;i=e.lastChild;)e.removeChild(i);if(typeof r=="function"){var l=r;r=function(){var u=Dc(c);l.call(u)}}var c=tp(e,0,!1,null,null,!1,!1,"",ag);return e._reactRootContainer=c,e[Mr]=c.current,ko(e.nodeType===8?e.parentNode:e),oi(function(){ou(t,c,n,r)}),c}function uu(e,t,n,r,i){var a=n._reactRootContainer;if(a){var o=a;if(typeof i=="function"){var l=i;i=function(){var c=Dc(o);l.call(c)}}ou(t,o,e,i)}else o=jE(n,t,e,i,r);return Dc(o)}Iv=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Za(t.pendingLanes);n!==0&&(Sf(t,n|1),en(t,ht()),!(Be&6)&&(da=ht()+500,_s()))}break;case 13:oi(function(){var r=Ur(e,1);if(r!==null){var i=qt();zn(r,e,1,i)}}),np(e,1)}};Ef=function(e){if(e.tag===13){var t=Ur(e,134217728);if(t!==null){var n=qt();zn(t,e,134217728,n)}np(e,134217728)}};Rv=function(e){if(e.tag===13){var t=ps(e),n=Ur(e,t);if(n!==null){var r=qt();zn(n,e,t,r)}np(e,t)}};Tv=function(){return ze};Ov=function(e,t){var n=ze;try{return ze=e,t()}finally{ze=n}};Hd=function(e,t,n){switch(t){case"input":if(Dd(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=eu(r);if(!i)throw Error(ee(90));uv(r),Dd(r,i)}}}break;case"textarea":hv(e,n);break;case"select":t=n.value,t!=null&&Yi(e,!!n.multiple,t,!1)}};xv=Qf;jv=oi;var bE={usingClientEntryPoint:!1,Events:[tl,Ui,eu,yv,vv,Qf]},Fa={findFiberByHostInstance:qs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},wE={bundleType:Fa.bundleType,version:Fa.version,rendererPackageName:Fa.rendererPackageName,rendererConfig:Fa.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Vr.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Sv(e),e===null?null:e.stateNode},findFiberByHostInstance:Fa.findFiberByHostInstance||xE,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var _l=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!_l.isDisabled&&_l.supportsFiber)try{Jc=_l.inject(wE),ir=_l}catch{}}dn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=bE;dn.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!sp(t))throw Error(ee(200));return vE(e,t,null,n)};dn.createRoot=function(e,t){if(!sp(e))throw Error(ee(299));var n=!1,r="",i=tj;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=tp(e,1,!1,null,null,n,!1,r,i),e[Mr]=t.current,ko(e.nodeType===8?e.parentNode:e),new rp(t)};dn.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(ee(188)):(e=Object.keys(e).join(","),Error(ee(268,e)));return e=Sv(t),e=e===null?null:e.stateNode,e};dn.flushSync=function(e){return oi(e)};dn.hydrate=function(e,t,n){if(!cu(t))throw Error(ee(200));return uu(null,e,t,!0,n)};dn.hydrateRoot=function(e,t,n){if(!sp(e))throw Error(ee(405));var r=n!=null&&n.hydratedSources||null,i=!1,a="",o=tj;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(a=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),t=ej(t,null,e,1,n??null,i,!1,a,o),e[Mr]=t.current,ko(e),r)for(e=0;e<r.length;e++)n=r[e],i=n._getVersion,i=i(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new lu(t)};dn.render=function(e,t,n){if(!cu(t))throw Error(ee(200));return uu(null,e,t,!1,n)};dn.unmountComponentAtNode=function(e){if(!cu(e))throw Error(ee(40));return e._reactRootContainer?(oi(function(){uu(null,null,e,!1,function(){e._reactRootContainer=null,e[Mr]=null})}),!0):!1};dn.unstable_batchedUpdates=Qf;dn.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!cu(n))throw Error(ee(200));if(e==null||e._reactInternals===void 0)throw Error(ee(38));return uu(e,t,n,!1,r)};dn.version="18.3.1-next-f1338f8080-20240426";function nj(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(nj)}catch(e){console.error(e)}}nj(),nv.exports=dn;var SE=nv.exports,og=SE;kd.createRoot=og.createRoot,kd.hydrateRoot=og.hydrateRoot;/**
 * @remix-run/router v1.23.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Uo(){return Uo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Uo.apply(this,arguments)}var is;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(is||(is={}));const lg="popstate";function EE(e){e===void 0&&(e={});function t(r,i){let{pathname:a,search:o,hash:l}=r.location;return wh("",{pathname:a,search:o,hash:l},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(r,i){return typeof i=="string"?i:Mc(i)}return _E(t,n,null,e)}function ft(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function ip(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function NE(){return Math.random().toString(36).substr(2,8)}function cg(e,t){return{usr:e.state,key:e.key,idx:t}}function wh(e,t,n,r){return n===void 0&&(n=null),Uo({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?ja(t):t,{state:n,key:t&&t.key||r||NE()})}function Mc(e){let{pathname:t="/",search:n="",hash:r=""}=e;return n&&n!=="?"&&(t+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(t+=r.charAt(0)==="#"?r:"#"+r),t}function ja(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}function _E(e,t,n,r){r===void 0&&(r={});let{window:i=document.defaultView,v5Compat:a=!1}=r,o=i.history,l=is.Pop,c=null,u=d();u==null&&(u=0,o.replaceState(Uo({},o.state,{idx:u}),""));function d(){return(o.state||{idx:null}).idx}function p(){l=is.Pop;let E=d(),g=E==null?null:E-u;u=E,c&&c({action:l,location:b.location,delta:g})}function h(E,g){l=is.Push;let x=wh(b.location,E,g);u=d()+1;let w=cg(x,u),_=b.createHref(x);try{o.pushState(w,"",_)}catch(S){if(S instanceof DOMException&&S.name==="DataCloneError")throw S;i.location.assign(_)}a&&c&&c({action:l,location:b.location,delta:1})}function f(E,g){l=is.Replace;let x=wh(b.location,E,g);u=d();let w=cg(x,u),_=b.createHref(x);o.replaceState(w,"",_),a&&c&&c({action:l,location:b.location,delta:0})}function y(E){let g=i.location.origin!=="null"?i.location.origin:i.location.href,x=typeof E=="string"?E:Mc(E);return x=x.replace(/ $/,"%20"),ft(g,"No window.location.(origin|href) available to create URL for href: "+x),new URL(x,g)}let b={get action(){return l},get location(){return e(i,o)},listen(E){if(c)throw new Error("A history only accepts one active listener");return i.addEventListener(lg,p),c=E,()=>{i.removeEventListener(lg,p),c=null}},createHref(E){return t(i,E)},createURL:y,encodeLocation(E){let g=y(E);return{pathname:g.pathname,search:g.search,hash:g.hash}},push:h,replace:f,go(E){return o.go(E)}};return b}var ug;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(ug||(ug={}));function AE(e,t,n){return n===void 0&&(n="/"),CE(e,t,n)}function CE(e,t,n,r){let i=typeof t=="string"?ja(t):t,a=ap(i.pathname||"/",n);if(a==null)return null;let o=rj(e);kE(o);let l=null;for(let c=0;l==null&&c<o.length;++c){let u=$E(a);l=UE(o[c],u)}return l}function rj(e,t,n,r){t===void 0&&(t=[]),n===void 0&&(n=[]),r===void 0&&(r="");let i=(a,o,l)=>{let c={relativePath:l===void 0?a.path||"":l,caseSensitive:a.caseSensitive===!0,childrenIndex:o,route:a};c.relativePath.startsWith("/")&&(ft(c.relativePath.startsWith(r),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(r.length));let u=gs([r,c.relativePath]),d=n.concat(c);a.children&&a.children.length>0&&(ft(a.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),rj(a.children,t,d,u)),!(a.path==null&&!a.index)&&t.push({path:u,score:DE(u,a.index),routesMeta:d})};return e.forEach((a,o)=>{var l;if(a.path===""||!((l=a.path)!=null&&l.includes("?")))i(a,o);else for(let c of sj(a.path))i(a,o,c)}),t}function sj(e){let t=e.split("/");if(t.length===0)return[];let[n,...r]=t,i=n.endsWith("?"),a=n.replace(/\?$/,"");if(r.length===0)return i?[a,""]:[a];let o=sj(r.join("/")),l=[];return l.push(...o.map(c=>c===""?a:[a,c].join("/"))),i&&l.push(...o),l.map(c=>e.startsWith("/")&&c===""?"/":c)}function kE(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:ME(t.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const IE=/^:[\w-]+$/,RE=3,TE=2,OE=1,PE=10,LE=-2,dg=e=>e==="*";function DE(e,t){let n=e.split("/"),r=n.length;return n.some(dg)&&(r+=LE),t&&(r+=TE),n.filter(i=>!dg(i)).reduce((i,a)=>i+(IE.test(a)?RE:a===""?OE:PE),r)}function ME(e,t){return e.length===t.length&&e.slice(0,-1).every((r,i)=>r===t[i])?e[e.length-1]-t[t.length-1]:0}function UE(e,t,n){let{routesMeta:r}=e,i={},a="/",o=[];for(let l=0;l<r.length;++l){let c=r[l],u=l===r.length-1,d=a==="/"?t:t.slice(a.length)||"/",p=BE({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},d),h=c.route;if(!p)return null;Object.assign(i,p.params),o.push({params:i,pathname:gs([a,p.pathname]),pathnameBase:WE(gs([a,p.pathnameBase])),route:h}),p.pathnameBase!=="/"&&(a=gs([a,p.pathnameBase]))}return o}function BE(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=VE(e.path,e.caseSensitive,e.end),i=t.match(n);if(!i)return null;let a=i[0],o=a.replace(/(.)\/+$/,"$1"),l=i.slice(1);return{params:r.reduce((u,d,p)=>{let{paramName:h,isOptional:f}=d;if(h==="*"){let b=l[p]||"";o=a.slice(0,a.length-b.length).replace(/(.)\/+$/,"$1")}const y=l[p];return f&&!y?u[h]=void 0:u[h]=(y||"").replace(/%2F/g,"/"),u},{}),pathname:a,pathnameBase:o,pattern:e}}function VE(e,t,n){t===void 0&&(t=!1),n===void 0&&(n=!0),ip(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let r=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,c)=>(r.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(r.push({paramName:"*"}),i+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":e!==""&&e!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,t?void 0:"i"),r]}function $E(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return ip(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function ap(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&r!=="/"?null:e.slice(n)||"/"}const FE=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,HE=e=>FE.test(e);function qE(e,t){t===void 0&&(t="/");let{pathname:n,search:r="",hash:i=""}=typeof e=="string"?ja(e):e,a;if(n)if(HE(n))a=n;else{if(n.includes("//")){let o=n;n=n.replace(/\/\/+/g,"/"),ip(!1,"Pathnames cannot have embedded double slashes - normalizing "+(o+" -> "+n))}n.startsWith("/")?a=hg(n.substring(1),"/"):a=hg(n,t)}else a=t;return{pathname:a,search:GE(r),hash:YE(i)}}function hg(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function Qu(e,t,n,r){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function zE(e){return e.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function op(e,t){let n=zE(e);return t?n.map((r,i)=>i===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function lp(e,t,n,r){r===void 0&&(r=!1);let i;typeof e=="string"?i=ja(e):(i=Uo({},e),ft(!i.pathname||!i.pathname.includes("?"),Qu("?","pathname","search",i)),ft(!i.pathname||!i.pathname.includes("#"),Qu("#","pathname","hash",i)),ft(!i.search||!i.search.includes("#"),Qu("#","search","hash",i)));let a=e===""||i.pathname==="",o=a?"/":i.pathname,l;if(o==null)l=n;else{let p=t.length-1;if(!r&&o.startsWith("..")){let h=o.split("/");for(;h[0]==="..";)h.shift(),p-=1;i.pathname=h.join("/")}l=p>=0?t[p]:"/"}let c=qE(i,l),u=o&&o!=="/"&&o.endsWith("/"),d=(a||o===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(u||d)&&(c.pathname+="/"),c}const gs=e=>e.join("/").replace(/\/\/+/g,"/"),WE=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),GE=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,YE=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function KE(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const ij=["post","put","patch","delete"];new Set(ij);const JE=["get",...ij];new Set(JE);/**
 * React Router v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Bo(){return Bo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Bo.apply(this,arguments)}const cp=m.createContext(null),QE=m.createContext(null),As=m.createContext(null),du=m.createContext(null),$r=m.createContext({outlet:null,matches:[],isDataRoute:!1}),aj=m.createContext(null);function ZE(e,t){let{relative:n}=t===void 0?{}:t;ba()||ft(!1);let{basename:r,navigator:i}=m.useContext(As),{hash:a,pathname:o,search:l}=lj(e,{relative:n}),c=o;return r!=="/"&&(c=o==="/"?r:gs([r,o])),i.createHref({pathname:c,search:l,hash:a})}function ba(){return m.useContext(du)!=null}function Cn(){return ba()||ft(!1),m.useContext(du).location}function oj(e){m.useContext(As).static||m.useLayoutEffect(e)}function Oe(){let{isDataRoute:e}=m.useContext($r);return e?fN():XE()}function XE(){ba()||ft(!1);let e=m.useContext(cp),{basename:t,future:n,navigator:r}=m.useContext(As),{matches:i}=m.useContext($r),{pathname:a}=Cn(),o=JSON.stringify(op(i,n.v7_relativeSplatPath)),l=m.useRef(!1);return oj(()=>{l.current=!0}),m.useCallback(function(u,d){if(d===void 0&&(d={}),!l.current)return;if(typeof u=="number"){r.go(u);return}let p=lp(u,JSON.parse(o),a,d.relative==="path");e==null&&t!=="/"&&(p.pathname=p.pathname==="/"?t:gs([t,p.pathname])),(d.replace?r.replace:r.push)(p,d.state,d)},[t,r,o,a,e])}const eN=m.createContext(null);function tN(e){let t=m.useContext($r).outlet;return t&&m.createElement(eN.Provider,{value:e},t)}function lj(e,t){let{relative:n}=t===void 0?{}:t,{future:r}=m.useContext(As),{matches:i}=m.useContext($r),{pathname:a}=Cn(),o=JSON.stringify(op(i,r.v7_relativeSplatPath));return m.useMemo(()=>lp(e,JSON.parse(o),a,n==="path"),[e,o,a,n])}function nN(e,t){return rN(e,t)}function rN(e,t,n,r){ba()||ft(!1);let{navigator:i}=m.useContext(As),{matches:a}=m.useContext($r),o=a[a.length-1],l=o?o.params:{};o&&o.pathname;let c=o?o.pathnameBase:"/";o&&o.route;let u=Cn(),d;if(t){var p;let E=typeof t=="string"?ja(t):t;c==="/"||(p=E.pathname)!=null&&p.startsWith(c)||ft(!1),d=E}else d=u;let h=d.pathname||"/",f=h;if(c!=="/"){let E=c.replace(/^\//,"").split("/");f="/"+h.replace(/^\//,"").split("/").slice(E.length).join("/")}let y=AE(e,{pathname:f}),b=lN(y&&y.map(E=>Object.assign({},E,{params:Object.assign({},l,E.params),pathname:gs([c,i.encodeLocation?i.encodeLocation(E.pathname).pathname:E.pathname]),pathnameBase:E.pathnameBase==="/"?c:gs([c,i.encodeLocation?i.encodeLocation(E.pathnameBase).pathname:E.pathnameBase])})),a,n,r);return t&&b?m.createElement(du.Provider,{value:{location:Bo({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:is.Pop}},b):b}function sN(){let e=hN(),t=KE(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return m.createElement(m.Fragment,null,m.createElement("h2",null,"Unexpected Application Error!"),m.createElement("h3",{style:{fontStyle:"italic"}},t),n?m.createElement("pre",{style:i},n):null,null)}const iN=m.createElement(sN,null);class aN extends m.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,n){return n.location!==t.location||n.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:n.error,location:n.location,revalidation:t.revalidation||n.revalidation}}componentDidCatch(t,n){console.error("React Router caught the following error during render",t,n)}render(){return this.state.error!==void 0?m.createElement($r.Provider,{value:this.props.routeContext},m.createElement(aj.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function oN(e){let{routeContext:t,match:n,children:r}=e,i=m.useContext(cp);return i&&i.static&&i.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=n.route.id),m.createElement($r.Provider,{value:t},r)}function lN(e,t,n,r){var i;if(t===void 0&&(t=[]),n===void 0&&(n=null),r===void 0&&(r=null),e==null){var a;if(!n)return null;if(n.errors)e=n.matches;else if((a=r)!=null&&a.v7_partialHydration&&t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let o=e,l=(i=n)==null?void 0:i.errors;if(l!=null){let d=o.findIndex(p=>p.route.id&&(l==null?void 0:l[p.route.id])!==void 0);d>=0||ft(!1),o=o.slice(0,Math.min(o.length,d+1))}let c=!1,u=-1;if(n&&r&&r.v7_partialHydration)for(let d=0;d<o.length;d++){let p=o[d];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(u=d),p.route.id){let{loaderData:h,errors:f}=n,y=p.route.loader&&h[p.route.id]===void 0&&(!f||f[p.route.id]===void 0);if(p.route.lazy||y){c=!0,u>=0?o=o.slice(0,u+1):o=[o[0]];break}}}return o.reduceRight((d,p,h)=>{let f,y=!1,b=null,E=null;n&&(f=l&&p.route.id?l[p.route.id]:void 0,b=p.route.errorElement||iN,c&&(u<0&&h===0?(pN("route-fallback"),y=!0,E=null):u===h&&(y=!0,E=p.route.hydrateFallbackElement||null)));let g=t.concat(o.slice(0,h+1)),x=()=>{let w;return f?w=b:y?w=E:p.route.Component?w=m.createElement(p.route.Component,null):p.route.element?w=p.route.element:w=d,m.createElement(oN,{match:p,routeContext:{outlet:d,matches:g,isDataRoute:n!=null},children:w})};return n&&(p.route.ErrorBoundary||p.route.errorElement||h===0)?m.createElement(aN,{location:n.location,revalidation:n.revalidation,component:b,error:f,children:x(),routeContext:{outlet:null,matches:g,isDataRoute:!0}}):x()},null)}var cj=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(cj||{}),uj=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(uj||{});function cN(e){let t=m.useContext(cp);return t||ft(!1),t}function uN(e){let t=m.useContext(QE);return t||ft(!1),t}function dN(e){let t=m.useContext($r);return t||ft(!1),t}function dj(e){let t=dN(),n=t.matches[t.matches.length-1];return n.route.id||ft(!1),n.route.id}function hN(){var e;let t=m.useContext(aj),n=uN(),r=dj();return t!==void 0?t:(e=n.errors)==null?void 0:e[r]}function fN(){let{router:e}=cN(cj.UseNavigateStable),t=dj(uj.UseNavigateStable),n=m.useRef(!1);return oj(()=>{n.current=!0}),m.useCallback(function(i,a){a===void 0&&(a={}),n.current&&(typeof i=="number"?e.navigate(i):e.navigate(i,Bo({fromRouteId:t},a)))},[e,t])}const fg={};function pN(e,t,n){fg[e]||(fg[e]=!0)}function mN(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function go(e){let{to:t,replace:n,state:r,relative:i}=e;ba()||ft(!1);let{future:a,static:o}=m.useContext(As),{matches:l}=m.useContext($r),{pathname:c}=Cn(),u=Oe(),d=lp(t,op(l,a.v7_relativeSplatPath),c,i==="path"),p=JSON.stringify(d);return m.useEffect(()=>u(JSON.parse(p),{replace:n,state:r,relative:i}),[u,p,i,n,r]),null}function hj(e){return tN(e.context)}function K(e){ft(!1)}function gN(e){let{basename:t="/",children:n=null,location:r,navigationType:i=is.Pop,navigator:a,static:o=!1,future:l}=e;ba()&&ft(!1);let c=t.replace(/^\/*/,"/"),u=m.useMemo(()=>({basename:c,navigator:a,static:o,future:Bo({v7_relativeSplatPath:!1},l)}),[c,l,a,o]);typeof r=="string"&&(r=ja(r));let{pathname:d="/",search:p="",hash:h="",state:f=null,key:y="default"}=r,b=m.useMemo(()=>{let E=ap(d,c);return E==null?null:{location:{pathname:E,search:p,hash:h,state:f,key:y},navigationType:i}},[c,d,p,h,f,y,i]);return b==null?null:m.createElement(As.Provider,{value:u},m.createElement(du.Provider,{children:n,value:b}))}function yN(e){let{children:t,location:n}=e;return nN(Sh(t),n)}new Promise(()=>{});function Sh(e,t){t===void 0&&(t=[]);let n=[];return m.Children.forEach(e,(r,i)=>{if(!m.isValidElement(r))return;let a=[...t,i];if(r.type===m.Fragment){n.push.apply(n,Sh(r.props.children,a));return}r.type!==K&&ft(!1),!r.props.index||!r.props.children||ft(!1);let o={id:r.props.id||a.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=Sh(r.props.children,a)),n.push(o)}),n}/**
 * React Router DOM v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Eh(){return Eh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Eh.apply(this,arguments)}function vN(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}function xN(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function jN(e,t){return e.button===0&&(!t||t==="_self")&&!xN(e)}function Nh(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,n)=>{let r=e[n];return t.concat(Array.isArray(r)?r.map(i=>[n,i]):[[n,r]])},[]))}function bN(e,t){let n=Nh(e);return t&&t.forEach((r,i)=>{n.has(i)||t.getAll(i).forEach(a=>{n.append(i,a)})}),n}const wN=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],SN="6";try{window.__reactRouterVersion=SN}catch{}const EN="startTransition",pg=hw[EN];function NN(e){let{basename:t,children:n,future:r,window:i}=e,a=m.useRef();a.current==null&&(a.current=EE({window:i,v5Compat:!0}));let o=a.current,[l,c]=m.useState({action:o.action,location:o.location}),{v7_startTransition:u}=r||{},d=m.useCallback(p=>{u&&pg?pg(()=>c(p)):c(p)},[c,u]);return m.useLayoutEffect(()=>o.listen(d),[o,d]),m.useEffect(()=>mN(r),[r]),m.createElement(gN,{basename:t,children:n,location:l.location,navigationType:l.action,navigator:o,future:r})}const _N=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",AN=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,li=m.forwardRef(function(t,n){let{onClick:r,relative:i,reloadDocument:a,replace:o,state:l,target:c,to:u,preventScrollReset:d,viewTransition:p}=t,h=vN(t,wN),{basename:f}=m.useContext(As),y,b=!1;if(typeof u=="string"&&AN.test(u)&&(y=u,_N))try{let w=new URL(window.location.href),_=u.startsWith("//")?new URL(w.protocol+u):new URL(u),S=ap(_.pathname,f);_.origin===w.origin&&S!=null?u=S+_.search+_.hash:b=!0}catch{}let E=ZE(u,{relative:i}),g=CN(u,{replace:o,state:l,target:c,preventScrollReset:d,relative:i,viewTransition:p});function x(w){r&&r(w),w.defaultPrevented||g(w)}return m.createElement("a",Eh({},h,{href:y||E,onClick:b||a?r:x,ref:n,target:c}))});var mg;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(mg||(mg={}));var gg;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(gg||(gg={}));function CN(e,t){let{target:n,replace:r,state:i,preventScrollReset:a,relative:o,viewTransition:l}=t===void 0?{}:t,c=Oe(),u=Cn(),d=lj(e,{relative:o});return m.useCallback(p=>{if(jN(p,n)){p.preventDefault();let h=r!==void 0?r:Mc(u)===Mc(d);c(e,{replace:h,state:i,preventScrollReset:a,relative:o,viewTransition:l})}},[u,c,d,r,i,n,e,a,o,l])}function fj(e){let t=m.useRef(Nh(e)),n=m.useRef(!1),r=Cn(),i=m.useMemo(()=>bN(r.search,n.current?null:t.current),[r.search]),a=Oe(),o=m.useCallback((l,c)=>{const u=Nh(typeof l=="function"?l(i):l);n.current=!0,a("?"+u,c)},[a,i]);return[i,o]}function kN(e={}){const{nonce:t,onScriptLoadSuccess:n,onScriptLoadError:r}=e,[i,a]=m.useState(!1),o=m.useRef(n);o.current=n;const l=m.useRef(r);return l.current=r,m.useEffect(()=>{const c=document.createElement("script");return c.src="https://accounts.google.com/gsi/client",c.async=!0,c.defer=!0,c.nonce=t,c.onload=()=>{var u;a(!0),(u=o.current)===null||u===void 0||u.call(o)},c.onerror=()=>{var u;a(!1),(u=l.current)===null||u===void 0||u.call(l)},document.body.appendChild(c),()=>{document.body.removeChild(c)}},[t]),i}const pj=m.createContext(null);function IN({clientId:e,nonce:t,onScriptLoadSuccess:n,onScriptLoadError:r,children:i}){const a=kN({nonce:t,onScriptLoadSuccess:n,onScriptLoadError:r}),o=m.useMemo(()=>({clientId:e,scriptLoadedSuccessfully:a}),[e,a]);return Zo.createElement(pj.Provider,{value:o},i)}function RN(){const e=m.useContext(pj);if(!e)throw new Error("Google OAuth components must be used within GoogleOAuthProvider");return e}function TN(e){var t;return(t=e==null?void 0:e.clientId)!==null&&t!==void 0?t:e==null?void 0:e.client_id}const ON={large:40,medium:32,small:20};function PN({onSuccess:e,onError:t,useOneTap:n,promptMomentNotification:r,type:i="standard",theme:a="outline",size:o="large",text:l,shape:c,logo_alignment:u,width:d,locale:p,click_listener:h,containerProps:f,...y}){const b=m.useRef(null),{clientId:E,scriptLoadedSuccessfully:g}=RN(),x=m.useRef(e);x.current=e;const w=m.useRef(t);w.current=t;const _=m.useRef(r);return _.current=r,m.useEffect(()=>{var S,k,I,C,L,V,B,Y,W;if(g)return(I=(k=(S=window==null?void 0:window.google)===null||S===void 0?void 0:S.accounts)===null||k===void 0?void 0:k.id)===null||I===void 0||I.initialize({client_id:E,callback:O=>{var D;if(!(O!=null&&O.credential))return(D=w.current)===null||D===void 0?void 0:D.call(w);const{credential:Q,select_by:ae}=O;x.current({credential:Q,clientId:TN(O),select_by:ae})},...y}),(V=(L=(C=window==null?void 0:window.google)===null||C===void 0?void 0:C.accounts)===null||L===void 0?void 0:L.id)===null||V===void 0||V.renderButton(b.current,{type:i,theme:a,size:o,text:l,shape:c,logo_alignment:u,width:d,locale:p,click_listener:h}),n&&((W=(Y=(B=window==null?void 0:window.google)===null||B===void 0?void 0:B.accounts)===null||Y===void 0?void 0:Y.id)===null||W===void 0||W.prompt(_.current)),()=>{var O,D,Q;n&&((Q=(D=(O=window==null?void 0:window.google)===null||O===void 0?void 0:O.accounts)===null||D===void 0?void 0:D.id)===null||Q===void 0||Q.cancel())}},[E,g,n,i,a,o,l,c,u,d,p]),Zo.createElement("div",{...f,ref:b,style:{height:ON[o],...f==null?void 0:f.style}})}const mj="http://localhost:5000";class gj extends Error{constructor(t,n,r){super(t),this.name="ApiError",this.status=n,this.data=r||{},this.code=(r==null?void 0:r.code)||null}}async function yj(e){try{return await e.json()}catch{return{}}}async function oe(e,t={},n=!1){const r=localStorage.getItem("token"),i={Accept:"application/json",...t.headers||{}},a=e.includes("/auth/login")||e.includes("/auth/register")||e.includes("/auth/google");if(r&&!a){i.Authorization=`Bearer ${r}`;const c=localStorage.getItem("role_override");c&&(i["X-Afya-View-Role"]=c)}t.body&&typeof t.body=="object"&&(t.body=JSON.stringify(t.body),i["Content-Type"]="application/json");let o;try{o=await fetch(`${mj}${e}`,{...t,credentials:"include",headers:i})}catch{throw new Error("Network error. Please check your connection.")}if(o.status===401&&!n&&!a){if(await LN())return oe(e,t,!0);throw vj(),new Error("Session expired. Please sign in again.")}const l=await yj(o);if(!o.ok){const c=new gj(l.msg||l.message||"Request failed",o.status,l);throw(c.code==="STEP_UP_REQUIRED"||c.code==="SESSION_RESTRICTED")&&window.dispatchEvent(new CustomEvent("afyalink:session-security",{detail:{code:c.code,message:c.message,restriction:(l==null?void 0:l.restriction)||null}})),c}return l}async function LN(){try{const e=localStorage.getItem("refreshToken");if(!e)return!1;const t=await fetch(`${mj}/api/auth/refresh`,{method:"POST",credentials:"include",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({refreshToken:e})});if(!t.ok)return!1;const n=await yj(t);return n!=null&&n.accessToken?(localStorage.setItem("token",n.accessToken),n.refreshToken&&localStorage.setItem("refreshToken",n.refreshToken),!0):!1}catch{return!1}}function vj(){localStorage.removeItem("token"),localStorage.removeItem("refreshToken"),window.location.href="/login"}const yg=Object.freeze({SUPERADMIN:"SUPER_ADMIN",SUPER_ADMIN:"SUPER_ADMIN",SYSTEMADMIN:"SYSTEM_ADMIN",SYSTEM_ADMIN:"SYSTEM_ADMIN",DEVELOPER:"DEVELOPER",HOSPITALADMIN:"HOSPITAL_ADMIN",HOSPITAL_ADMIN:"HOSPITAL_ADMIN",DOCTOR:"DOCTOR",NURSE:"NURSE",LABTECH:"LAB_TECH",LAB_TECH:"LAB_TECH",PHARMACIST:"PHARMACIST",SECURITYOFFICER:"SECURITY_OFFICER",SECURITY_OFFICER:"SECURITY_OFFICER",SECURITYADMIN:"SECURITY_ADMIN",SECURITY_ADMIN:"SECURITY_ADMIN",HRMANAGER:"HR_MANAGER",HR_MANAGER:"HR_MANAGER",PAYROLLOFFICER:"PAYROLL_OFFICER",PAYROLL_OFFICER:"PAYROLL_OFFICER",RADIOLOGIST:"RADIOLOGIST",THERAPIST:"THERAPIST",RECEPTIONIST:"RECEPTIONIST",PATIENT:"PATIENT",GUEST:"GUEST"});function Qe(e){if(typeof e!="string")return"";const t=e.trim().replace(/[\s-]+/g,"_").toUpperCase(),n=t.replaceAll("_","");return yg[t]||yg[n]||t}function Al(e){try{const n=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),r=decodeURIComponent(atob(n).split("").map(i=>"%"+("00"+i.charCodeAt(0).toString(16)).slice(-2)).join(""));return JSON.parse(r)}catch{return null}}const xj=m.createContext(null),ki="role_override";function DN({children:e}){const[t,n]=m.useState(null),[r,i]=m.useState(()=>localStorage.getItem(ki)||""),[a,o]=m.useState(!0),l=Qe(t==null?void 0:t.role)==="SUPER_ADMIN"||Qe(t==null?void 0:t.role)==="DEVELOPER",c=Qe(l&&r?r:t==null?void 0:t.role),u=t?{...t,actualRole:Qe(t.role),role:c}:null;m.useEffect(()=>{let y=!0;return(async()=>{try{const E=localStorage.getItem("user"),g=localStorage.getItem("token"),x=localStorage.getItem("refreshToken");if(!g||!E){y&&n(null);return}const w=Al(g),_=Qe(w==null?void 0:w.role),S=(w==null?void 0:w.exp)&&w.exp*1e3<Date.now();if(!_||S){if(!x)throw new Error("Token expired");const k=await fetch("http://localhost:5000/api/auth/refresh",{method:"POST",credentials:"include",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({refreshToken:x})});if(!k.ok)throw new Error("Refresh failed");const I=await k.json();if(!(I!=null&&I.accessToken)||!(I!=null&&I.user))throw new Error("Refresh failed");localStorage.setItem("token",I.accessToken),I.refreshToken&&localStorage.setItem("refreshToken",I.refreshToken),localStorage.setItem("user",JSON.stringify(I.user)),y&&n({...I.user,role:Qe(I.user.role),twoFactorVerified:!0});return}y&&n({...JSON.parse(E),role:_,twoFactorVerified:(w==null?void 0:w.twoFactor)!==!1})}catch{localStorage.removeItem("token"),localStorage.removeItem("refreshToken"),localStorage.removeItem("user"),localStorage.removeItem("2fa_pending"),localStorage.removeItem("2fa_user"),localStorage.removeItem(ki),y&&n(null)}})().finally(()=>{y&&o(!1)}),()=>{y=!1}},[]);const d=async(y,b)=>{var _;if(typeof b=="object"&&(b==null?void 0:b.directToken)===!0){const S=(b==null?void 0:b.token)||y;if(!S)throw new Error("Missing access token");const k=Al(S),I=Qe(k==null?void 0:k.role);if(!I)throw new Error("Invalid Google token");const C={id:k.id,name:k.name,email:k.email,phone:k.phone,role:I};return localStorage.setItem("token",S),b!=null&&b.refreshToken&&localStorage.setItem("refreshToken",b.refreshToken),localStorage.setItem("user",JSON.stringify(C)),n({...C,twoFactorVerified:!0}),{user:C}}const E=await oe("/api/auth/login",{method:"POST",body:{identifier:y,password:b}});if(E.requires2FA)return localStorage.setItem("2fa_pending","true"),localStorage.setItem("2fa_user",E.userId),{requires2FA:!0,userId:E.userId};const g=Qe((_=E.user)==null?void 0:_.role);if(!g)throw new Error("User role missing");const x={id:E.user.id,name:E.user.name,email:E.user.email,phone:E.user.phone,phoneVerified:E.user.phoneVerified,emailVerified:E.user.emailVerified,role:g};localStorage.setItem("token",E.accessToken),E.refreshToken&&localStorage.setItem("refreshToken",E.refreshToken),localStorage.setItem("user",JSON.stringify(x));const w=Al(E.accessToken);return n({...x,twoFactorVerified:(w==null?void 0:w.twoFactor)!==!1}),{user:x}},p=(y,b)=>{const E=Al(y);if(!(E!=null&&E.role))return;const g=Qe(E.role);localStorage.setItem("token",y),b&&localStorage.setItem("refreshToken",b),localStorage.removeItem("2fa_pending"),localStorage.removeItem("2fa_user");const x=JSON.parse(localStorage.getItem("user"));n({...x,role:g,twoFactorVerified:!0})},h=async()=>{try{const y=localStorage.getItem("refreshToken");await oe("/api/auth/logout",{method:"POST",body:y?{refreshToken:y}:{}})}catch{}finally{localStorage.removeItem("token"),localStorage.removeItem("refreshToken"),localStorage.removeItem("user"),localStorage.removeItem("2fa_pending"),localStorage.removeItem("2fa_user"),localStorage.removeItem(ki),n(null),vj()}},f=y=>{const b=Qe(y);return l?b?(localStorage.setItem(ki,b),i(b),!0):(localStorage.removeItem(ki),i(""),!0):!1};return m.useEffect(()=>{!l&&r&&(localStorage.removeItem(ki),i(""))},[l,r]),s.jsx(xj.Provider,{value:{user:u,loading:a,isAuthenticated:!!u,role:u==null?void 0:u.role,actualRole:u==null?void 0:u.actualRole,roleOverride:r,canRoleOverride:l,setRoleOverride:f,login:d,complete2FA:p,logout:h,hasRole:(...y)=>y.includes(u==null?void 0:u.role),isAdmin:["SUPER_ADMIN","HOSPITAL_ADMIN"].includes(u==null?void 0:u.role),is2FAVerified:!!(u!=null&&u.twoFactorVerified)},children:a?s.jsx("div",{}):e})}function Me(){const e=m.useContext(xj);if(!e)throw new Error("useAuth must be used inside AuthProvider");return e}const dr=Object.create(null);dr.open="0";dr.close="1";dr.ping="2";dr.pong="3";dr.message="4";dr.upgrade="5";dr.noop="6";const tc=Object.create(null);Object.keys(dr).forEach(e=>{tc[dr[e]]=e});const _h={type:"error",data:"parser error"},jj=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",bj=typeof ArrayBuffer=="function",wj=e=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer,up=({type:e,data:t},n,r)=>jj&&t instanceof Blob?n?r(t):vg(t,r):bj&&(t instanceof ArrayBuffer||wj(t))?n?r(t):vg(new Blob([t]),r):r(dr[e]+(t||"")),vg=(e,t)=>{const n=new FileReader;return n.onload=function(){const r=n.result.split(",")[1];t("b"+(r||""))},n.readAsDataURL(e)};function xg(e){return e instanceof Uint8Array?e:e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}let Zu;function MN(e,t){if(jj&&e.data instanceof Blob)return e.data.arrayBuffer().then(xg).then(t);if(bj&&(e.data instanceof ArrayBuffer||wj(e.data)))return t(xg(e.data));up(e,!1,n=>{Zu||(Zu=new TextEncoder),t(Zu.encode(n))})}const jg="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",eo=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let e=0;e<jg.length;e++)eo[jg.charCodeAt(e)]=e;const UN=e=>{let t=e.length*.75,n=e.length,r,i=0,a,o,l,c;e[e.length-1]==="="&&(t--,e[e.length-2]==="="&&t--);const u=new ArrayBuffer(t),d=new Uint8Array(u);for(r=0;r<n;r+=4)a=eo[e.charCodeAt(r)],o=eo[e.charCodeAt(r+1)],l=eo[e.charCodeAt(r+2)],c=eo[e.charCodeAt(r+3)],d[i++]=a<<2|o>>4,d[i++]=(o&15)<<4|l>>2,d[i++]=(l&3)<<6|c&63;return u},BN=typeof ArrayBuffer=="function",dp=(e,t)=>{if(typeof e!="string")return{type:"message",data:Sj(e,t)};const n=e.charAt(0);return n==="b"?{type:"message",data:VN(e.substring(1),t)}:tc[n]?e.length>1?{type:tc[n],data:e.substring(1)}:{type:tc[n]}:_h},VN=(e,t)=>{if(BN){const n=UN(e);return Sj(n,t)}else return{base64:!0,data:e}},Sj=(e,t)=>{switch(t){case"blob":return e instanceof Blob?e:new Blob([e]);case"arraybuffer":default:return e instanceof ArrayBuffer?e:e.buffer}},Ej="",$N=(e,t)=>{const n=e.length,r=new Array(n);let i=0;e.forEach((a,o)=>{up(a,!1,l=>{r[o]=l,++i===n&&t(r.join(Ej))})})},FN=(e,t)=>{const n=e.split(Ej),r=[];for(let i=0;i<n.length;i++){const a=dp(n[i],t);if(r.push(a),a.type==="error")break}return r};function HN(){return new TransformStream({transform(e,t){MN(e,n=>{const r=n.length;let i;if(r<126)i=new Uint8Array(1),new DataView(i.buffer).setUint8(0,r);else if(r<65536){i=new Uint8Array(3);const a=new DataView(i.buffer);a.setUint8(0,126),a.setUint16(1,r)}else{i=new Uint8Array(9);const a=new DataView(i.buffer);a.setUint8(0,127),a.setBigUint64(1,BigInt(r))}e.data&&typeof e.data!="string"&&(i[0]|=128),t.enqueue(i),t.enqueue(n)})}})}let Xu;function Cl(e){return e.reduce((t,n)=>t+n.length,0)}function kl(e,t){if(e[0].length===t)return e.shift();const n=new Uint8Array(t);let r=0;for(let i=0;i<t;i++)n[i]=e[0][r++],r===e[0].length&&(e.shift(),r=0);return e.length&&r<e[0].length&&(e[0]=e[0].slice(r)),n}function qN(e,t){Xu||(Xu=new TextDecoder);const n=[];let r=0,i=-1,a=!1;return new TransformStream({transform(o,l){for(n.push(o);;){if(r===0){if(Cl(n)<1)break;const c=kl(n,1);a=(c[0]&128)===128,i=c[0]&127,i<126?r=3:i===126?r=1:r=2}else if(r===1){if(Cl(n)<2)break;const c=kl(n,2);i=new DataView(c.buffer,c.byteOffset,c.length).getUint16(0),r=3}else if(r===2){if(Cl(n)<8)break;const c=kl(n,8),u=new DataView(c.buffer,c.byteOffset,c.length),d=u.getUint32(0);if(d>Math.pow(2,21)-1){l.enqueue(_h);break}i=d*Math.pow(2,32)+u.getUint32(4),r=3}else{if(Cl(n)<i)break;const c=kl(n,i);l.enqueue(dp(a?c:Xu.decode(c),t)),r=0}if(i===0||i>e){l.enqueue(_h);break}}}})}const Nj=4;function yt(e){if(e)return zN(e)}function zN(e){for(var t in yt.prototype)e[t]=yt.prototype[t];return e}yt.prototype.on=yt.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this};yt.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this};yt.prototype.off=yt.prototype.removeListener=yt.prototype.removeAllListeners=yt.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var n=this._callbacks["$"+e];if(!n)return this;if(arguments.length==1)return delete this._callbacks["$"+e],this;for(var r,i=0;i<n.length;i++)if(r=n[i],r===t||r.fn===t){n.splice(i,1);break}return n.length===0&&delete this._callbacks["$"+e],this};yt.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks["$"+e],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(n){n=n.slice(0);for(var r=0,i=n.length;r<i;++r)n[r].apply(this,t)}return this};yt.prototype.emitReserved=yt.prototype.emit;yt.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]};yt.prototype.hasListeners=function(e){return!!this.listeners(e).length};const hu=typeof Promise=="function"&&typeof Promise.resolve=="function"?t=>Promise.resolve().then(t):(t,n)=>n(t,0),bn=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),WN="arraybuffer";function _j(e,...t){return t.reduce((n,r)=>(e.hasOwnProperty(r)&&(n[r]=e[r]),n),{})}const GN=bn.setTimeout,YN=bn.clearTimeout;function fu(e,t){t.useNativeTimers?(e.setTimeoutFn=GN.bind(bn),e.clearTimeoutFn=YN.bind(bn)):(e.setTimeoutFn=bn.setTimeout.bind(bn),e.clearTimeoutFn=bn.clearTimeout.bind(bn))}const KN=1.33;function JN(e){return typeof e=="string"?QN(e):Math.ceil((e.byteLength||e.size)*KN)}function QN(e){let t=0,n=0;for(let r=0,i=e.length;r<i;r++)t=e.charCodeAt(r),t<128?n+=1:t<2048?n+=2:t<55296||t>=57344?n+=3:(r++,n+=4);return n}function Aj(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function ZN(e){let t="";for(let n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t}function XN(e){let t={},n=e.split("&");for(let r=0,i=n.length;r<i;r++){let a=n[r].split("=");t[decodeURIComponent(a[0])]=decodeURIComponent(a[1])}return t}class e_ extends Error{constructor(t,n,r){super(t),this.description=n,this.context=r,this.type="TransportError"}}class hp extends yt{constructor(t){super(),this.writable=!1,fu(this,t),this.opts=t,this.query=t.query,this.socket=t.socket,this.supportsBinary=!t.forceBase64}onError(t,n,r){return super.emitReserved("error",new e_(t,n,r)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(t){this.readyState==="open"&&this.write(t)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(t){const n=dp(t,this.socket.binaryType);this.onPacket(n)}onPacket(t){super.emitReserved("packet",t)}onClose(t){this.readyState="closed",super.emitReserved("close",t)}pause(t){}createUri(t,n={}){return t+"://"+this._hostname()+this._port()+this.opts.path+this._query(n)}_hostname(){const t=this.opts.hostname;return t.indexOf(":")===-1?t:"["+t+"]"}_port(){return this.opts.port&&(this.opts.secure&&Number(this.opts.port)!==443||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(t){const n=ZN(t);return n.length?"?"+n:""}}class t_ extends hp{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(t){this.readyState="pausing";const n=()=>{this.readyState="paused",t()};if(this._polling||!this.writable){let r=0;this._polling&&(r++,this.once("pollComplete",function(){--r||n()})),this.writable||(r++,this.once("drain",function(){--r||n()}))}else n()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(t){const n=r=>{if(this.readyState==="opening"&&r.type==="open"&&this.onOpen(),r.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(r)};FN(t,this.socket.binaryType).forEach(n),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const t=()=>{this.write([{type:"close"}])};this.readyState==="open"?t():this.once("open",t)}write(t){this.writable=!1,$N(t,n=>{this.doWrite(n,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const t=this.opts.secure?"https":"http",n=this.query||{};return this.opts.timestampRequests!==!1&&(n[this.opts.timestampParam]=Aj()),!this.supportsBinary&&!n.sid&&(n.b64=1),this.createUri(t,n)}}let Cj=!1;try{Cj=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const n_=Cj;function r_(){}class s_ extends t_{constructor(t){if(super(t),typeof location<"u"){const n=location.protocol==="https:";let r=location.port;r||(r=n?"443":"80"),this.xd=typeof location<"u"&&t.hostname!==location.hostname||r!==t.port}}doWrite(t,n){const r=this.request({method:"POST",data:t});r.on("success",n),r.on("error",(i,a)=>{this.onError("xhr post error",i,a)})}doPoll(){const t=this.request();t.on("data",this.onData.bind(this)),t.on("error",(n,r)=>{this.onError("xhr poll error",n,r)}),this.pollXhr=t}}class or extends yt{constructor(t,n,r){super(),this.createRequest=t,fu(this,r),this._opts=r,this._method=r.method||"GET",this._uri=n,this._data=r.data!==void 0?r.data:null,this._create()}_create(){var t;const n=_j(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");n.xdomain=!!this._opts.xd;const r=this._xhr=this.createRequest(n);try{r.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){r.setDisableHeaderCheck&&r.setDisableHeaderCheck(!0);for(let i in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(i)&&r.setRequestHeader(i,this._opts.extraHeaders[i])}}catch{}if(this._method==="POST")try{r.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{r.setRequestHeader("Accept","*/*")}catch{}(t=this._opts.cookieJar)===null||t===void 0||t.addCookies(r),"withCredentials"in r&&(r.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(r.timeout=this._opts.requestTimeout),r.onreadystatechange=()=>{var i;r.readyState===3&&((i=this._opts.cookieJar)===null||i===void 0||i.parseCookies(r.getResponseHeader("set-cookie"))),r.readyState===4&&(r.status===200||r.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof r.status=="number"?r.status:0)},0))},r.send(this._data)}catch(i){this.setTimeoutFn(()=>{this._onError(i)},0);return}typeof document<"u"&&(this._index=or.requestsCount++,or.requests[this._index]=this)}_onError(t){this.emitReserved("error",t,this._xhr),this._cleanup(!0)}_cleanup(t){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=r_,t)try{this._xhr.abort()}catch{}typeof document<"u"&&delete or.requests[this._index],this._xhr=null}}_onLoad(){const t=this._xhr.responseText;t!==null&&(this.emitReserved("data",t),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}or.requestsCount=0;or.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",bg);else if(typeof addEventListener=="function"){const e="onpagehide"in bn?"pagehide":"unload";addEventListener(e,bg,!1)}}function bg(){for(let e in or.requests)or.requests.hasOwnProperty(e)&&or.requests[e].abort()}const i_=function(){const e=kj({xdomain:!1});return e&&e.responseType!==null}();class a_ extends s_{constructor(t){super(t);const n=t&&t.forceBase64;this.supportsBinary=i_&&!n}request(t={}){return Object.assign(t,{xd:this.xd},this.opts),new or(kj,this.uri(),t)}}function kj(e){const t=e.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!t||n_))return new XMLHttpRequest}catch{}if(!t)try{return new bn[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const Ij=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class o_ extends hp{get name(){return"websocket"}doOpen(){const t=this.uri(),n=this.opts.protocols,r=Ij?{}:_j(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(r.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(t,n,r)}catch(i){return this.emitReserved("error",i)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=t=>this.onClose({description:"websocket connection closed",context:t}),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=!1;for(let n=0;n<t.length;n++){const r=t[n],i=n===t.length-1;up(r,this.supportsBinary,a=>{try{this.doWrite(r,a)}catch{}i&&hu(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const t=this.opts.secure?"wss":"ws",n=this.query||{};return this.opts.timestampRequests&&(n[this.opts.timestampParam]=Aj()),this.supportsBinary||(n.b64=1),this.createUri(t,n)}}const ed=bn.WebSocket||bn.MozWebSocket;class l_ extends o_{createSocket(t,n,r){return Ij?new ed(t,n,r):n?new ed(t,n):new ed(t)}doWrite(t,n){this.ws.send(n)}}class c_ extends hp{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(t){return this.emitReserved("error",t)}this._transport.closed.then(()=>{this.onClose()}).catch(t=>{this.onError("webtransport error",t)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(t=>{const n=qN(Number.MAX_SAFE_INTEGER,this.socket.binaryType),r=t.readable.pipeThrough(n).getReader(),i=HN();i.readable.pipeTo(t.writable),this._writer=i.writable.getWriter();const a=()=>{r.read().then(({done:l,value:c})=>{l||(this.onPacket(c),a())}).catch(l=>{})};a();const o={type:"open"};this.query.sid&&(o.data=`{"sid":"${this.query.sid}"}`),this._writer.write(o).then(()=>this.onOpen())})})}write(t){this.writable=!1;for(let n=0;n<t.length;n++){const r=t[n],i=n===t.length-1;this._writer.write(r).then(()=>{i&&hu(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var t;(t=this._transport)===null||t===void 0||t.close()}}const u_={websocket:l_,webtransport:c_,polling:a_},d_=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,h_=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function Ah(e){if(e.length>8e3)throw"URI too long";const t=e,n=e.indexOf("["),r=e.indexOf("]");n!=-1&&r!=-1&&(e=e.substring(0,n)+e.substring(n,r).replace(/:/g,";")+e.substring(r,e.length));let i=d_.exec(e||""),a={},o=14;for(;o--;)a[h_[o]]=i[o]||"";return n!=-1&&r!=-1&&(a.source=t,a.host=a.host.substring(1,a.host.length-1).replace(/;/g,":"),a.authority=a.authority.replace("[","").replace("]","").replace(/;/g,":"),a.ipv6uri=!0),a.pathNames=f_(a,a.path),a.queryKey=p_(a,a.query),a}function f_(e,t){const n=/\/{2,9}/g,r=t.replace(n,"/").split("/");return(t.slice(0,1)=="/"||t.length===0)&&r.splice(0,1),t.slice(-1)=="/"&&r.splice(r.length-1,1),r}function p_(e,t){const n={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(r,i,a){i&&(n[i]=a)}),n}const Ch=typeof addEventListener=="function"&&typeof removeEventListener=="function",nc=[];Ch&&addEventListener("offline",()=>{nc.forEach(e=>e())},!1);class ys extends yt{constructor(t,n){if(super(),this.binaryType=WN,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,t&&typeof t=="object"&&(n=t,t=null),t){const r=Ah(t);n.hostname=r.host,n.secure=r.protocol==="https"||r.protocol==="wss",n.port=r.port,r.query&&(n.query=r.query)}else n.host&&(n.hostname=Ah(n.host).host);fu(this,n),this.secure=n.secure!=null?n.secure:typeof location<"u"&&location.protocol==="https:",n.hostname&&!n.port&&(n.port=this.secure?"443":"80"),this.hostname=n.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=n.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},n.transports.forEach(r=>{const i=r.prototype.name;this.transports.push(i),this._transportsByName[i]=r}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},n),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=XN(this.opts.query)),Ch&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},nc.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(t){const n=Object.assign({},this.opts.query);n.EIO=Nj,n.transport=t,this.id&&(n.sid=this.id);const r=Object.assign({},this.opts,{query:n,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[t]);return new this._transportsByName[t](r)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const t=this.opts.rememberUpgrade&&ys.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const n=this.createTransport(t);n.open(),this.setTransport(n)}setTransport(t){this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",n=>this._onClose("transport close",n))}onOpen(){this.readyState="open",ys.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",t),this.emitReserved("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const n=new Error("server error");n.code=t.data,this._onError(n);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data);break}}onHandshake(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this._pingInterval=t.pingInterval,this._pingTimeout=t.pingTimeout,this._maxPayload=t.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const t=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+t,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},t),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const t=this._getWritablePackets();this.transport.send(t),this._prevBufferLen=t.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let n=1;for(let r=0;r<this.writeBuffer.length;r++){const i=this.writeBuffer[r].data;if(i&&(n+=JN(i)),r>0&&n>this._maxPayload)return this.writeBuffer.slice(0,r);n+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const t=Date.now()>this._pingTimeoutTime;return t&&(this._pingTimeoutTime=0,hu(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),t}write(t,n,r){return this._sendPacket("message",t,n,r),this}send(t,n,r){return this._sendPacket("message",t,n,r),this}_sendPacket(t,n,r,i){if(typeof n=="function"&&(i=n,n=void 0),typeof r=="function"&&(i=r,r=null),this.readyState==="closing"||this.readyState==="closed")return;r=r||{},r.compress=r.compress!==!1;const a={type:t,data:n,options:r};this.emitReserved("packetCreate",a),this.writeBuffer.push(a),i&&this.once("flush",i),this.flush()}close(){const t=()=>{this._onClose("forced close"),this.transport.close()},n=()=>{this.off("upgrade",n),this.off("upgradeError",n),t()},r=()=>{this.once("upgrade",n),this.once("upgradeError",n)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?r():t()}):this.upgrading?r():t()),this}_onError(t){if(ys.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",t),this._onClose("transport error",t)}_onClose(t,n){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),Ch&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const r=nc.indexOf(this._offlineEventListener);r!==-1&&nc.splice(r,1)}this.readyState="closed",this.id=null,this.emitReserved("close",t,n),this.writeBuffer=[],this._prevBufferLen=0}}}ys.protocol=Nj;class m_ extends ys{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let t=0;t<this._upgrades.length;t++)this._probe(this._upgrades[t])}_probe(t){let n=this.createTransport(t),r=!1;ys.priorWebsocketSuccess=!1;const i=()=>{r||(n.send([{type:"ping",data:"probe"}]),n.once("packet",p=>{if(!r)if(p.type==="pong"&&p.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",n),!n)return;ys.priorWebsocketSuccess=n.name==="websocket",this.transport.pause(()=>{r||this.readyState!=="closed"&&(d(),this.setTransport(n),n.send([{type:"upgrade"}]),this.emitReserved("upgrade",n),n=null,this.upgrading=!1,this.flush())})}else{const h=new Error("probe error");h.transport=n.name,this.emitReserved("upgradeError",h)}}))};function a(){r||(r=!0,d(),n.close(),n=null)}const o=p=>{const h=new Error("probe error: "+p);h.transport=n.name,a(),this.emitReserved("upgradeError",h)};function l(){o("transport closed")}function c(){o("socket closed")}function u(p){n&&p.name!==n.name&&a()}const d=()=>{n.removeListener("open",i),n.removeListener("error",o),n.removeListener("close",l),this.off("close",c),this.off("upgrading",u)};n.once("open",i),n.once("error",o),n.once("close",l),this.once("close",c),this.once("upgrading",u),this._upgrades.indexOf("webtransport")!==-1&&t!=="webtransport"?this.setTimeoutFn(()=>{r||n.open()},200):n.open()}onHandshake(t){this._upgrades=this._filterUpgrades(t.upgrades),super.onHandshake(t)}_filterUpgrades(t){const n=[];for(let r=0;r<t.length;r++)~this.transports.indexOf(t[r])&&n.push(t[r]);return n}}let g_=class extends m_{constructor(t,n={}){const r=typeof t=="object"?t:n;(!r.transports||r.transports&&typeof r.transports[0]=="string")&&(r.transports=(r.transports||["polling","websocket","webtransport"]).map(i=>u_[i]).filter(i=>!!i)),super(t,r)}};function y_(e,t="",n){let r=e;n=n||typeof location<"u"&&location,e==null&&(e=n.protocol+"//"+n.host),typeof e=="string"&&(e.charAt(0)==="/"&&(e.charAt(1)==="/"?e=n.protocol+e:e=n.host+e),/^(https?|wss?):\/\//.test(e)||(typeof n<"u"?e=n.protocol+"//"+e:e="https://"+e),r=Ah(e)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";const a=r.host.indexOf(":")!==-1?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+a+":"+r.port+t,r.href=r.protocol+"://"+a+(n&&n.port===r.port?"":":"+r.port),r}const v_=typeof ArrayBuffer=="function",x_=e=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer,Rj=Object.prototype.toString,j_=typeof Blob=="function"||typeof Blob<"u"&&Rj.call(Blob)==="[object BlobConstructor]",b_=typeof File=="function"||typeof File<"u"&&Rj.call(File)==="[object FileConstructor]";function fp(e){return v_&&(e instanceof ArrayBuffer||x_(e))||j_&&e instanceof Blob||b_&&e instanceof File}function rc(e,t){if(!e||typeof e!="object")return!1;if(Array.isArray(e)){for(let n=0,r=e.length;n<r;n++)if(rc(e[n]))return!0;return!1}if(fp(e))return!0;if(e.toJSON&&typeof e.toJSON=="function"&&arguments.length===1)return rc(e.toJSON(),!0);for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&rc(e[n]))return!0;return!1}function w_(e){const t=[],n=e.data,r=e;return r.data=kh(n,t),r.attachments=t.length,{packet:r,buffers:t}}function kh(e,t){if(!e)return e;if(fp(e)){const n={_placeholder:!0,num:t.length};return t.push(e),n}else if(Array.isArray(e)){const n=new Array(e.length);for(let r=0;r<e.length;r++)n[r]=kh(e[r],t);return n}else if(typeof e=="object"&&!(e instanceof Date)){const n={};for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=kh(e[r],t));return n}return e}function S_(e,t){return e.data=Ih(e.data,t),delete e.attachments,e}function Ih(e,t){if(!e)return e;if(e&&e._placeholder===!0){if(typeof e.num=="number"&&e.num>=0&&e.num<t.length)return t[e.num];throw new Error("illegal attachments")}else if(Array.isArray(e))for(let n=0;n<e.length;n++)e[n]=Ih(e[n],t);else if(typeof e=="object")for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(e[n]=Ih(e[n],t));return e}const E_=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"];var Le;(function(e){e[e.CONNECT=0]="CONNECT",e[e.DISCONNECT=1]="DISCONNECT",e[e.EVENT=2]="EVENT",e[e.ACK=3]="ACK",e[e.CONNECT_ERROR=4]="CONNECT_ERROR",e[e.BINARY_EVENT=5]="BINARY_EVENT",e[e.BINARY_ACK=6]="BINARY_ACK"})(Le||(Le={}));let N_=class{constructor(t){this.replacer=t}encode(t){return(t.type===Le.EVENT||t.type===Le.ACK)&&rc(t)?this.encodeAsBinary({type:t.type===Le.EVENT?Le.BINARY_EVENT:Le.BINARY_ACK,nsp:t.nsp,data:t.data,id:t.id}):[this.encodeAsString(t)]}encodeAsString(t){let n=""+t.type;return(t.type===Le.BINARY_EVENT||t.type===Le.BINARY_ACK)&&(n+=t.attachments+"-"),t.nsp&&t.nsp!=="/"&&(n+=t.nsp+","),t.id!=null&&(n+=t.id),t.data!=null&&(n+=JSON.stringify(t.data,this.replacer)),n}encodeAsBinary(t){const n=w_(t),r=this.encodeAsString(n.packet),i=n.buffers;return i.unshift(r),i}},__=class Tj extends yt{constructor(t){super(),this.reviver=t}add(t){let n;if(typeof t=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");n=this.decodeString(t);const r=n.type===Le.BINARY_EVENT;r||n.type===Le.BINARY_ACK?(n.type=r?Le.EVENT:Le.ACK,this.reconstructor=new A_(n),n.attachments===0&&super.emitReserved("decoded",n)):super.emitReserved("decoded",n)}else if(fp(t)||t.base64)if(this.reconstructor)n=this.reconstructor.takeBinaryData(t),n&&(this.reconstructor=null,super.emitReserved("decoded",n));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+t)}decodeString(t){let n=0;const r={type:Number(t.charAt(0))};if(Le[r.type]===void 0)throw new Error("unknown packet type "+r.type);if(r.type===Le.BINARY_EVENT||r.type===Le.BINARY_ACK){const a=n+1;for(;t.charAt(++n)!=="-"&&n!=t.length;);const o=t.substring(a,n);if(o!=Number(o)||t.charAt(n)!=="-")throw new Error("Illegal attachments");r.attachments=Number(o)}if(t.charAt(n+1)==="/"){const a=n+1;for(;++n&&!(t.charAt(n)===","||n===t.length););r.nsp=t.substring(a,n)}else r.nsp="/";const i=t.charAt(n+1);if(i!==""&&Number(i)==i){const a=n+1;for(;++n;){const o=t.charAt(n);if(o==null||Number(o)!=o){--n;break}if(n===t.length)break}r.id=Number(t.substring(a,n+1))}if(t.charAt(++n)){const a=this.tryParse(t.substr(n));if(Tj.isPayloadValid(r.type,a))r.data=a;else throw new Error("invalid payload")}return r}tryParse(t){try{return JSON.parse(t,this.reviver)}catch{return!1}}static isPayloadValid(t,n){switch(t){case Le.CONNECT:return wg(n);case Le.DISCONNECT:return n===void 0;case Le.CONNECT_ERROR:return typeof n=="string"||wg(n);case Le.EVENT:case Le.BINARY_EVENT:return Array.isArray(n)&&(typeof n[0]=="number"||typeof n[0]=="string"&&E_.indexOf(n[0])===-1);case Le.ACK:case Le.BINARY_ACK:return Array.isArray(n)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}};class A_{constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){const n=S_(this.reconPack,this.buffers);return this.finishedReconstruction(),n}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}function wg(e){return Object.prototype.toString.call(e)==="[object Object]"}const C_=Object.freeze(Object.defineProperty({__proto__:null,Decoder:__,Encoder:N_,get PacketType(){return Le}},Symbol.toStringTag,{value:"Module"}));function Vn(e,t,n){return e.on(t,n),function(){e.off(t,n)}}const k_=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class Oj extends yt{constructor(t,n,r){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=n,r&&r.auth&&(this.auth=r.auth),this._opts=Object.assign({},r),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const t=this.io;this.subs=[Vn(t,"open",this.onopen.bind(this)),Vn(t,"packet",this.onpacket.bind(this)),Vn(t,"error",this.onerror.bind(this)),Vn(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...n){var r,i,a;if(k_.hasOwnProperty(t))throw new Error('"'+t.toString()+'" is a reserved event name');if(n.unshift(t),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(n),this;const o={type:Le.EVENT,data:n};if(o.options={},o.options.compress=this.flags.compress!==!1,typeof n[n.length-1]=="function"){const d=this.ids++,p=n.pop();this._registerAckCallback(d,p),o.id=d}const l=(i=(r=this.io.engine)===null||r===void 0?void 0:r.transport)===null||i===void 0?void 0:i.writable,c=this.connected&&!(!((a=this.io.engine)===null||a===void 0)&&a._hasPingExpired());return this.flags.volatile&&!l||(c?(this.notifyOutgoingListeners(o),this.packet(o)):this.sendBuffer.push(o)),this.flags={},this}_registerAckCallback(t,n){var r;const i=(r=this.flags.timeout)!==null&&r!==void 0?r:this._opts.ackTimeout;if(i===void 0){this.acks[t]=n;return}const a=this.io.setTimeoutFn(()=>{delete this.acks[t];for(let l=0;l<this.sendBuffer.length;l++)this.sendBuffer[l].id===t&&this.sendBuffer.splice(l,1);n.call(this,new Error("operation has timed out"))},i),o=(...l)=>{this.io.clearTimeoutFn(a),n.apply(this,l)};o.withError=!0,this.acks[t]=o}emitWithAck(t,...n){return new Promise((r,i)=>{const a=(o,l)=>o?i(o):r(l);a.withError=!0,n.push(a),this.emit(t,...n)})}_addToQueue(t){let n;typeof t[t.length-1]=="function"&&(n=t.pop());const r={id:this._queueSeq++,tryCount:0,pending:!1,args:t,flags:Object.assign({fromQueue:!0},this.flags)};t.push((i,...a)=>(this._queue[0],i!==null?r.tryCount>this._opts.retries&&(this._queue.shift(),n&&n(i)):(this._queue.shift(),n&&n(null,...a)),r.pending=!1,this._drainQueue())),this._queue.push(r),this._drainQueue()}_drainQueue(t=!1){if(!this.connected||this._queue.length===0)return;const n=this._queue[0];n.pending&&!t||(n.pending=!0,n.tryCount++,this.flags=n.flags,this.emit.apply(this,n.args))}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){typeof this.auth=="function"?this.auth(t=>{this._sendConnectPacket(t)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(t){this.packet({type:Le.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},t):t})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t,n){this.connected=!1,delete this.id,this.emitReserved("disconnect",t,n),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(t=>{if(!this.sendBuffer.some(r=>String(r.id)===t)){const r=this.acks[t];delete this.acks[t],r.withError&&r.call(this,new Error("socket has been disconnected"))}})}onpacket(t){if(t.nsp===this.nsp)switch(t.type){case Le.CONNECT:t.data&&t.data.sid?this.onconnect(t.data.sid,t.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case Le.EVENT:case Le.BINARY_EVENT:this.onevent(t);break;case Le.ACK:case Le.BINARY_ACK:this.onack(t);break;case Le.DISCONNECT:this.ondisconnect();break;case Le.CONNECT_ERROR:this.destroy();const r=new Error(t.data.message);r.data=t.data.data,this.emitReserved("connect_error",r);break}}onevent(t){const n=t.data||[];t.id!=null&&n.push(this.ack(t.id)),this.connected?this.emitEvent(n):this.receiveBuffer.push(Object.freeze(n))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){const n=this._anyListeners.slice();for(const r of n)r.apply(this,t)}super.emit.apply(this,t),this._pid&&t.length&&typeof t[t.length-1]=="string"&&(this._lastOffset=t[t.length-1])}ack(t){const n=this;let r=!1;return function(...i){r||(r=!0,n.packet({type:Le.ACK,id:t,data:i}))}}onack(t){const n=this.acks[t.id];typeof n=="function"&&(delete this.acks[t.id],n.withError&&t.data.unshift(null),n.apply(this,t.data))}onconnect(t,n){this.id=t,this.recovered=n&&this._pid===n,this._pid=n,this.connected=!0,this.emitBuffered(),this._drainQueue(!0),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach(t=>this.emitEvent(t)),this.receiveBuffer=[],this.sendBuffer.forEach(t=>{this.notifyOutgoingListeners(t),this.packet(t)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(t=>t()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:Le.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}timeout(t){return this.flags.timeout=t,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){const n=this._anyListeners;for(let r=0;r<n.length;r++)if(t===n[r])return n.splice(r,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(t),this}prependAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(t),this}offAnyOutgoing(t){if(!this._anyOutgoingListeners)return this;if(t){const n=this._anyOutgoingListeners;for(let r=0;r<n.length;r++)if(t===n[r])return n.splice(r,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(t){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const n=this._anyOutgoingListeners.slice();for(const r of n)r.apply(this,t.data)}}}function wa(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}wa.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=Math.floor(t*10)&1?e+n:e-n}return Math.min(e,this.max)|0};wa.prototype.reset=function(){this.attempts=0};wa.prototype.setMin=function(e){this.ms=e};wa.prototype.setMax=function(e){this.max=e};wa.prototype.setJitter=function(e){this.jitter=e};class Rh extends yt{constructor(t,n){var r;super(),this.nsps={},this.subs=[],t&&typeof t=="object"&&(n=t,t=void 0),n=n||{},n.path=n.path||"/socket.io",this.opts=n,fu(this,n),this.reconnection(n.reconnection!==!1),this.reconnectionAttempts(n.reconnectionAttempts||1/0),this.reconnectionDelay(n.reconnectionDelay||1e3),this.reconnectionDelayMax(n.reconnectionDelayMax||5e3),this.randomizationFactor((r=n.randomizationFactor)!==null&&r!==void 0?r:.5),this.backoff=new wa({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(n.timeout==null?2e4:n.timeout),this._readyState="closed",this.uri=t;const i=n.parser||C_;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this._autoConnect=n.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(t){return arguments.length?(this._reconnection=!!t,t||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(t){return t===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var n;return t===void 0?this._reconnectionDelay:(this._reconnectionDelay=t,(n=this.backoff)===null||n===void 0||n.setMin(t),this)}randomizationFactor(t){var n;return t===void 0?this._randomizationFactor:(this._randomizationFactor=t,(n=this.backoff)===null||n===void 0||n.setJitter(t),this)}reconnectionDelayMax(t){var n;return t===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,(n=this.backoff)===null||n===void 0||n.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(t){if(~this._readyState.indexOf("open"))return this;this.engine=new g_(this.uri,this.opts);const n=this.engine,r=this;this._readyState="opening",this.skipReconnect=!1;const i=Vn(n,"open",function(){r.onopen(),t&&t()}),a=l=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",l),t?t(l):this.maybeReconnectOnOpen()},o=Vn(n,"error",a);if(this._timeout!==!1){const l=this._timeout,c=this.setTimeoutFn(()=>{i(),a(new Error("timeout")),n.close()},l);this.opts.autoUnref&&c.unref(),this.subs.push(()=>{this.clearTimeoutFn(c)})}return this.subs.push(i),this.subs.push(o),this}connect(t){return this.open(t)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const t=this.engine;this.subs.push(Vn(t,"ping",this.onping.bind(this)),Vn(t,"data",this.ondata.bind(this)),Vn(t,"error",this.onerror.bind(this)),Vn(t,"close",this.onclose.bind(this)),Vn(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){try{this.decoder.add(t)}catch(n){this.onclose("parse error",n)}}ondecoded(t){hu(()=>{this.emitReserved("packet",t)},this.setTimeoutFn)}onerror(t){this.emitReserved("error",t)}socket(t,n){let r=this.nsps[t];return r?this._autoConnect&&!r.active&&r.connect():(r=new Oj(this,t,n),this.nsps[t]=r),r}_destroy(t){const n=Object.keys(this.nsps);for(const r of n)if(this.nsps[r].active)return;this._close()}_packet(t){const n=this.encoder.encode(t);for(let r=0;r<n.length;r++)this.engine.write(n[r],t.options)}cleanup(){this.subs.forEach(t=>t()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(t,n){var r;this.cleanup(),(r=this.engine)===null||r===void 0||r.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t,n),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const n=this.backoff.duration();this._reconnecting=!0;const r=this.setTimeoutFn(()=>{t.skipReconnect||(this.emitReserved("reconnect_attempt",t.backoff.attempts),!t.skipReconnect&&t.open(i=>{i?(t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",i)):t.onreconnect()}))},n);this.opts.autoUnref&&r.unref(),this.subs.push(()=>{this.clearTimeoutFn(r)})}}onreconnect(){const t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}}const Ha={};function sc(e,t){typeof e=="object"&&(t=e,e=void 0),t=t||{};const n=y_(e,t.path||"/socket.io"),r=n.source,i=n.id,a=n.path,o=Ha[i]&&a in Ha[i].nsps,l=t.forceNew||t["force new connection"]||t.multiplex===!1||o;let c;return l?c=new Rh(r,t):(Ha[i]||(Ha[i]=new Rh(r,t)),c=Ha[i]),n.query&&!t.query&&(t.query=n.queryKey),c.socket(n.path,t)}Object.assign(sc,{Manager:Rh,Socket:Oj,io:sc,connect:sc});const Pj=m.createContext(void 0);function I_({children:e}){const[t,n]=m.useState(null);return m.useEffect(()=>{const r=localStorage.getItem("token");if(!r)return;const a=sc("http://localhost:5000",{transports:["websocket"],auth:{token:r}});return n(a),a.on("connect",()=>{console.log(" Socket connected:",a.id)}),a.on("disconnect",()=>{console.log(" Socket disconnected")}),()=>{a.disconnect(),n(null)}},[]),s.jsx(Pj.Provider,{value:t,children:e})}const R_=()=>{const e=m.useContext(Pj);return e===void 0&&console.warn("useSocket used outside SocketProvider"),e},T_=Object.freeze({SUPER_ADMIN:"/super-admin",SYSTEM_ADMIN:"/system-admin",HOSPITAL_ADMIN:"/hospital-admin",SECURITY_ADMIN:"/security-admin",SECURITY_OFFICER:"/security-officer",HR_MANAGER:"/hr-manager",PAYROLL_OFFICER:"/payroll-officer",DEVELOPER:"/developer",DOCTOR:"/doctor",NURSE:"/nurse",LAB_TECH:"/lab-tech",PHARMACIST:"/pharmacy",PATIENT:"/patient",GUEST:"/guest",RADIOLOGIST:"/staff",THERAPIST:"/staff",RECEPTIONIST:"/staff"}),Ss=e=>{if(!(e!=null&&e.role))return"/login";const t=Qe(e.role);return T_[t]||"/unauthorized"},O_=[{label:"Dashboard Overview",path:"/"},{label:"Profile",path:"/profile"},{label:"Analytics",path:"/analytics"},{label:"Reports",path:"/reports"},{label:"Inventory",path:"/inventory"},{label:"Payments",path:"/payments"},{label:"Payment Operations",path:"/payments/full"},{label:"Payment Settings",path:"/admin/payment-settings"},{label:"AI Assistant",path:"/ai/medical"},{label:"AI Triage",path:"/ai/triage"},{label:"AI Voice Dictation",path:"/ai/voice"},{label:"AI Document Extract",path:"/ai/extract"},{label:"AI Chatbot",path:"/ai/chatbot"}],P_={SUPER_ADMIN:[{label:"Super Admin Dashboard",path:"/super-admin"},{label:"Manage Hospitals",path:"/super-admin/hospitals"},{label:"System Settings",path:"/super-admin/settings"},{label:"Admin Controls",path:"/admin"},{label:"Audit Logs",path:"/admin/audit-logs"},{label:"Integrations",path:"/admin/realtime"},{label:"System Admin Dashboard",path:"/system-admin"},{label:"Developer Console",path:"/developer"}],SYSTEM_ADMIN:[{label:"System Admin Dashboard",path:"/system-admin"},{label:"ABAC Policies",path:"/system-admin/abac"},{label:"Mapping Studio",path:"/system-admin/mapping-studio"},{label:"NLP Analytics",path:"/system-admin/nlp-analytics"},{label:"Regulatory Reports",path:"/system-admin/regulatory-reports"},{label:"Clinical Intelligence",path:"/system-admin/clinical-intelligence"},{label:"Manage Hospitals",path:"/super-admin/hospitals"},{label:"Admin Controls",path:"/admin"},{label:"Audit Logs",path:"/admin/audit-logs"},{label:"Integrations",path:"/admin/realtime"}],HOSPITAL_ADMIN:[{label:"Hospital Admin",path:"/hospital-admin"},{label:"Register Staff",path:"/hospital-admin/register-staff"},{label:"Approvals",path:"/hospital-admin/approvals"},{label:"Staff Management",path:"/hospital-admin/staff"},{label:"My Requests",path:"/workforce/requests"},{label:"Notifications",path:"/admin/notifications"},{label:"Offline Sync",path:"/admin/crdt-patients"},{label:"Clinical Intelligence",path:"/system-admin/clinical-intelligence"}],DOCTOR:[{label:"Doctor Dashboard",path:"/doctor"},{label:"My Schedule",path:"/doctor/schedule"},{label:"My Patients",path:"/doctor/patients"},{label:"OPD Clinic",path:"/doctor/opd"},{label:"Inpatient Ward",path:"/doctor/ward"},{label:"Surgery / Procedures",path:"/doctor/surgery"},{label:"Lab Results",path:"/doctor/lab-results"},{label:"Prescriptions",path:"/doctor/prescriptions"},{label:"Medical Records",path:"/doctor/medical-records"},{label:"Referrals",path:"/doctor/referrals"},{label:"Performance",path:"/doctor/performance"},{label:"CME & Certifications",path:"/doctor/cme"},{label:"Leave Requests",path:"/doctor/leave"},{label:"Reports & Notes",path:"/doctor/reports-notes"},{label:"Doctor Settings",path:"/doctor/settings"},{label:"Appointments",path:"/doctor/appointments"},{label:"My Requests",path:"/workforce/requests"},{label:"Clinical Intelligence",path:"/system-admin/clinical-intelligence"}],NURSE:[{label:"Nurse Dashboard",path:"/nurse"},{label:"My Shift",path:"/nurse/shift"},{label:"Assigned Patients",path:"/nurse/patients"},{label:"Medication Administration",path:"/nurse/medication"},{label:"Incident Reports",path:"/nurse/incidents"},{label:"Vitals Entry",path:"/nurse/vitals"},{label:"Leave Requests",path:"/nurse/leave"},{label:"Performance",path:"/nurse/performance"},{label:"My Requests",path:"/workforce/requests"},{label:"Clinical Intelligence",path:"/system-admin/clinical-intelligence"}],LAB_TECH:[{label:"Lab Dashboard",path:"/lab-tech"},{label:"Test Queue",path:"/lab-tech/test-queue"},{label:"Equipment Logs",path:"/lab-tech/equipment"},{label:"Sample Tracking",path:"/lab-tech/samples"},{label:"Quality Control",path:"/lab-tech/qc"},{label:"Safety Checklist",path:"/lab-tech/safety"},{label:"Reports Archive",path:"/lab-tech/archive"},{label:"Lab Tests",path:"/labtech/labs"},{label:"My Requests",path:"/workforce/requests"}],PHARMACIST:[{label:"Pharmacy",path:"/pharmacy"},{label:"Prescription Queue",path:"/pharmacy/queue"},{label:"Inventory",path:"/pharmacy/inventory"},{label:"Controlled Drugs",path:"/pharmacy/controlled"},{label:"Expiry Alerts",path:"/pharmacy/expiry"},{label:"Supplier Orders",path:"/pharmacy/suppliers"},{label:"Pharmacy Reports",path:"/pharmacy/reports"},{label:"My Requests",path:"/workforce/requests"}],HR_MANAGER:[{label:"HR Manager",path:"/hr-manager"},{label:"My Requests",path:"/workforce/requests"},{label:"Clinical Intelligence",path:"/system-admin/clinical-intelligence"}],PAYROLL_OFFICER:[{label:"Payroll Officer",path:"/payroll-officer"},{label:"My Requests",path:"/workforce/requests"}],DEVELOPER:[{label:"Developer Console",path:"/developer"},{label:"Queue Replay",path:"/developer/queue-replay"},{label:"Webhook Retry",path:"/developer/webhook-retry"},{label:"Decision Cockpit",path:"/developer/decision-cockpit"},{label:"Provenance Verify",path:"/developer/provenance-verify"},{label:"AI Extraction History",path:"/developer/ai-extraction-history"},{label:"ABAC Policies",path:"/system-admin/abac"},{label:"Mapping Studio",path:"/system-admin/mapping-studio"},{label:"NLP Analytics",path:"/system-admin/nlp-analytics"},{label:"Regulatory Reports",path:"/system-admin/regulatory-reports"},{label:"Clinical Intelligence",path:"/system-admin/clinical-intelligence"},{label:"System Admin Dashboard",path:"/system-admin"},{label:"Super Admin Dashboard",path:"/super-admin"}],SECURITY_ADMIN:[{label:"Security Admin",path:"/security-admin"},{label:"My Requests",path:"/workforce/requests"}],SECURITY_OFFICER:[{label:"Security Officer",path:"/security-officer"},{label:"My Requests",path:"/workforce/requests"}],RADIOLOGIST:[{label:"My Requests",path:"/workforce/requests"}],THERAPIST:[{label:"My Requests",path:"/workforce/requests"}],RECEPTIONIST:[{label:"My Requests",path:"/workforce/requests"}],PATIENT:[{label:"Patient Dashboard",path:"/patient"},{label:"My Appointments",path:"/patient/appointments"},{label:"Medical Records",path:"/patient/medical-records"},{label:"Prescriptions",path:"/patient/prescriptions"},{label:"Lab Results",path:"/patient/lab-results"},{label:"Billing",path:"/patient/billing"},{label:"Insurance",path:"/patient/insurance"},{label:"Feedback",path:"/patient/feedback"}],GUEST:[{label:"Guest Home",path:"/guest"}]};function L_(e){const t=Qe((e==null?void 0:e.role)||""),r=[...P_[t]||[],...O_],i=new Set;return r.filter(a=>i.has(a.path)?!1:(i.add(a.path),!0))}const Lj=m.createContext(null),td=["system","light","dark"];function D_(){return typeof window>"u"?"light":window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function Sg(e){const t=e==="system"?D_():e;document.documentElement.setAttribute("data-theme",t),document.documentElement.setAttribute("data-theme-mode",e)}function M_({children:e}){const[t,n]=m.useState(()=>localStorage.getItem("theme")||"system");m.useEffect(()=>{if(Sg(t),localStorage.setItem("theme",t),t!=="system")return;const i=window.matchMedia("(prefers-color-scheme: dark)"),a=()=>Sg("system");return i.addEventListener?(i.addEventListener("change",a),()=>i.removeEventListener("change",a)):(i.addListener(a),()=>i.removeListener(a))},[t]);const r=m.useMemo(()=>({theme:t,setTheme:n,cycleTheme:()=>{const i=td.indexOf(t),a=td[(i+1)%td.length];n(a)}}),[t]);return s.jsx(Lj.Provider,{value:r,children:e})}function Dj(){const e=m.useContext(Lj);if(!e)throw new Error("useTheme must be used inside ThemeProvider");return e}const nd="http://localhost:5000";async function Ir(e,t={}){const r={...{credentials:"include",headers:{"Content-Type":"application/json"}},...t},i=localStorage.getItem("token"),a=localStorage.getItem("refreshToken"),o=e.includes("/api/auth/login")||e.includes("/api/auth/register")||e.includes("/api/auth/google");if(r.body&&typeof r.body=="object"&&!(r.body instanceof FormData)&&(r.body=JSON.stringify(r.body)),i&&!o){const c=localStorage.getItem("role_override");r.headers={...r.headers,Authorization:`Bearer ${i}`,...c?{"X-Afya-View-Role":c}:{}}}let l=await fetch(nd+e,r);if(l.status===401&&a){const c=await fetch(nd+"/api/auth/refresh",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:a})});if(c.ok){const u=await c.json();u!=null&&u.accessToken&&(localStorage.setItem("token",u.accessToken),r.headers={...r.headers,Authorization:`Bearer ${u.accessToken}`}),u!=null&&u.refreshToken&&localStorage.setItem("refreshToken",u.refreshToken),l=await fetch(nd+e,r)}}return l}const ue={get:async e=>({data:await(await Ir(e)).json()}),post:async(e,t)=>({data:await(await Ir(e,{method:"POST",body:t})).json()}),put:async(e,t)=>({data:await(await Ir(e,{method:"PUT",body:t})).json()}),delete:async e=>({data:await(await Ir(e,{method:"DELETE"})).json()})},$s=async(e,t={})=>(await ue.post("/api/actions/trigger",{action:e,meta:t})).data,Mj=m.createContext(null);function U_(e){if(!e)return;let t=document.querySelector("link[rel='icon']");t||(t=document.createElement("link"),t.rel="icon",document.head.appendChild(t)),t.href=e}function B_({children:e}){const[t,n]=m.useState(null),r="http://localhost:5000";m.useEffect(()=>{fetch(`${r}/api/system-settings`).then(a=>a.json()).then(a=>{n(a)}).catch(()=>n({}))},[]),m.useEffect(()=>{if(!t)return;const a=t.branding||{};a.favicon&&U_(a.favicon);const o=document.documentElement;a.logo&&o.style.setProperty("--brand-logo",`url(${a.logo})`),a.appIcon&&o.style.setProperty("--brand-icon",`url(${a.appIcon})`),a.loginBackground&&o.style.setProperty("--login-bg",`url(${a.loginBackground})`),a.homeBackground&&o.style.setProperty("--home-bg",`url(${a.homeBackground})`)},[t]);const i=m.useMemo(()=>({settings:t,setSettings:n}),[t]);return s.jsx(Mj.Provider,{value:i,children:e})}function fi(){const e=m.useContext(Mj);if(!e)throw new Error("useSystemSettings must be used inside SystemSettingsProvider");return e}const Vo=async()=>(await ue.get("/api/developer/overview")).data,Th=async()=>(await ue.get("/api/developer/trust-status")).data,pp=async()=>(await ue.post("/api/developer/workflow-sla/run")).data,V_=async()=>(await ue.get("/api/developer/decision-cockpit")).data,$_=async({query:e}={})=>(await ue.get(`/api/notifications/list${e?`?${e}`:""}`)).data,Uj=async e=>(await ue.put(`/api/notifications/${e}/read`)).data,Bj=async e=>(await ue.put(`/api/notifications/${e}/unread`)).data,Vj=async()=>(await ue.put("/api/notifications/read-all")).data,F_=async({category:e,read:t}={})=>{const n=new URLSearchParams;e&&e!=="ALL"&&n.set("category",e),(t==="true"||t==="false")&&n.set("read",t);const r=n.toString();return(await ue.get(`/api/notifications/list${r?`?${r}`:""}`)).data};function wr({name:e}){const t={menu:"",home:s.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",children:s.jsx("path",{d:"M4 11.5 12 5l8 6.5v7a1 1 0 0 1-1 1h-5v-5H10v5H5a1 1 0 0 1-1-1z",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinejoin:"round"})}),bell:s.jsxs("svg",{viewBox:"0 0 24 24","aria-hidden":"true",children:[s.jsx("path",{d:"M18 16H6l1.5-2V10a4.5 4.5 0 0 1 9 0v4z",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinejoin:"round"}),s.jsx("path",{d:"M10 18a2 2 0 0 0 4 0",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round"})]}),chat:s.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",children:s.jsx("path",{d:"M6 6h12a2 2 0 0 1 2 2v6a2 2 0 0 1-2 2H9l-4 3v-3H6a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2z",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinejoin:"round"})}),help:s.jsxs("svg",{viewBox:"0 0 24 24","aria-hidden":"true",children:[s.jsx("path",{d:"M9 9a3 3 0 1 1 3 3v2",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("circle",{cx:"12",cy:"17",r:"1",fill:"currentColor"}),s.jsx("circle",{cx:"12",cy:"12",r:"9",fill:"none",stroke:"currentColor",strokeWidth:"1.8"})]}),settings:s.jsxs("svg",{viewBox:"0 0 24 24","aria-hidden":"true",children:[s.jsx("path",{d:"M12 8.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 0 1 0-7z",fill:"none",stroke:"currentColor",strokeWidth:"1.8"}),s.jsx("path",{d:"M19 12a7 7 0 0 0-.1-1.2l2-1.5-2-3.5-2.4.8a7.4 7.4 0 0 0-2-1.2l-.4-2.5H10l-.4 2.5a7.4 7.4 0 0 0-2 1.2l-2.4-.8-2 3.5 2 1.5A7 7 0 0 0 5 12c0 .4 0 .8.1 1.2l-2 1.5 2 3.5 2.4-.8a7.4 7.4 0 0 0 2 1.2l.4 2.5h4l.4-2.5a7.4 7.4 0 0 0 2-1.2l2.4.8 2-3.5-2-1.5c.1-.4.1-.8.1-1.2z",fill:"none",stroke:"currentColor",strokeWidth:"1.3",strokeLinejoin:"round"})]}),sun:s.jsxs("svg",{viewBox:"0 0 24 24","aria-hidden":"true",children:[s.jsx("circle",{cx:"12",cy:"12",r:"4",fill:"none",stroke:"currentColor",strokeWidth:"1.8"}),s.jsx("path",{d:"M12 2v3M12 19v3M4.2 4.2l2.1 2.1M17.7 17.7l2.1 2.1M2 12h3M19 12h3M4.2 19.8l2.1-2.1M17.7 6.3l2.1-2.1",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round",fill:"none"})]}),calendar:s.jsxs("svg",{viewBox:"0 0 24 24","aria-hidden":"true",children:[s.jsx("rect",{x:"4",y:"5",width:"16",height:"15",rx:"2",fill:"none",stroke:"currentColor",strokeWidth:"1.8"}),s.jsx("path",{d:"M8 3v4M16 3v4M4 9h16",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round"})]}),emergency:s.jsxs("svg",{viewBox:"0 0 24 24","aria-hidden":"true",children:[s.jsx("path",{d:"M12 4 3 20h18L12 4z",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinejoin:"round"}),s.jsx("path",{d:"M12 10v4M12 17h.01",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round"})]})};return s.jsx("span",{className:"icon",children:t[e]||null})}function H_({onToggleSidebar:e}){var Ae,H;const{user:t,logout:n,roleOverride:r}=Me(),i=Oe(),a=Cn(),{theme:o,cycleTheme:l}=Dj(),{settings:c}=fi(),[u,d]=m.useState(!1),[p,h]=m.useState(!1),[f,y]=m.useState([]),[b,E]=m.useState("ALL"),[g,x]=m.useState("ALL"),[w,_]=m.useState(""),[S,k]=m.useState(()=>{try{const F=localStorage.getItem("workflow_sla_last_scan");return F?JSON.parse(F):null}catch{return null}}),[I,C]=m.useState(!1),L=15e3,V=(Ae=c==null?void 0:c.branding)==null?void 0:Ae.logo,B=m.useRef(null),Y=(t==null?void 0:t.role)==="GUEST",W=(t==null?void 0:t.role)==="DOCTOR",O=t?Ss(t):"/",D=m.useMemo(()=>L_(t),[t]),Q=m.useMemo(()=>{const F=w.trim().toLowerCase();return F?D.filter(se=>se.label.toLowerCase().includes(F)).slice(0,8):[]},[w,D]),ae=m.useMemo(()=>f.filter(F=>!F.read).length,[f]),U=!!r&&!!(t!=null&&t.actualRole)&&t.actualRole!==t.role,Z=["SUPER_ADMIN","SYSTEM_ADMIN","DEVELOPER"].includes(t==null?void 0:t.role),le=m.useCallback(async()=>{var F,se,xe,Ce;if(Z)try{const Pe=await Vo(),Ge={pending:((se=(F=Pe==null?void 0:Pe.queues)==null?void 0:F.workforce)==null?void 0:se.totalPending)??0,breached:((Ce=(xe=Pe==null?void 0:Pe.queues)==null?void 0:xe.workforce)==null?void 0:Ce.breached)??0,updatedAt:new Date().toISOString(),lastScanAt:(S==null?void 0:S.lastScanAt)||null,escalationsL1:(S==null?void 0:S.escalationsL1)||0,escalationsL2:(S==null?void 0:S.escalationsL2)||0};k(Ge),localStorage.setItem("workflow_sla_last_scan",JSON.stringify(Ge))}catch{}},[Z,S==null?void 0:S.escalationsL1,S==null?void 0:S.escalationsL2,S==null?void 0:S.lastScanAt]),ye=m.useCallback(()=>{const F=new URLSearchParams;b!=="ALL"&&F.set("category",b),g==="READ"&&F.set("read","true"),g==="UNREAD"&&F.set("read","false");const se=F.toString();$_({query:se}).then(xe=>{Array.isArray(xe)?y(xe):Array.isArray(xe==null?void 0:xe.items)?y(xe.items):y([])}).catch(()=>y([]))},[b,g]);m.useEffect(()=>{p&&ye()},[p,ye]),m.useEffect(()=>{ye();const F=setInterval(ye,L);return()=>clearInterval(F)},[ye]),m.useEffect(()=>{if(le(),!Z)return;const F=setInterval(le,3e4);return()=>clearInterval(F)},[Z,le]);const je=m.useCallback(async()=>{var F,se,xe,Ce;C(!0);try{const Pe=await pp(),Ge={pending:(S==null?void 0:S.pending)??0,breached:(S==null?void 0:S.breached)??0,updatedAt:new Date().toISOString(),lastScanAt:(Pe==null?void 0:Pe.ranAt)||new Date().toISOString(),escalationsL1:((se=(F=Pe==null?void 0:Pe.result)==null?void 0:F.workforce)==null?void 0:se.escalationsL1)??0,escalationsL2:((Ce=(xe=Pe==null?void 0:Pe.result)==null?void 0:xe.workforce)==null?void 0:Ce.escalationsL2)??0};k(Ge),localStorage.setItem("workflow_sla_last_scan",JSON.stringify(Ge)),await le()}finally{C(!1)}},[le,S==null?void 0:S.breached,S==null?void 0:S.pending]);return m.useEffect(()=>{d(!1),h(!1),_("")},[a.pathname]),m.useEffect(()=>{const F=se=>{u&&B.current&&!B.current.contains(se.target)&&d(!1)};return document.addEventListener("mousedown",F),()=>document.removeEventListener("mousedown",F)},[u]),s.jsxs("header",{className:"navbar",children:[s.jsxs("div",{className:"navbar-left",children:[s.jsx("button",{className:"icon-btn",onClick:e,"aria-label":"Open navigator",title:"Navigator",children:s.jsx(wr,{name:"menu"})}),s.jsx("button",{className:"brand-btn",onClick:()=>i(Y?"/guest":O),children:V?s.jsx("span",{className:"brand-logo",style:{backgroundImage:`url(${V})`}}):"AfyaLink HCM"}),s.jsxs("button",{className:"icon-btn ghost",onClick:()=>i(O),"aria-label":"Home",title:"Home",children:[s.jsx(wr,{name:"home"}),"Home"]})]}),s.jsx("div",{className:"navbar-center",children:s.jsxs("div",{className:"search-wrap",children:[s.jsx("input",{className:"search-input",placeholder:"Search people, tasks, reports, help",value:w,onChange:F=>_(F.target.value)}),s.jsx("button",{className:"search-btn",onClick:()=>_(""),"aria-label":"Clear search",title:"Clear",children:"Clear"}),Q.length>0&&s.jsx("div",{className:"search-results",children:Q.map(F=>s.jsxs("button",{className:"search-result",onClick:()=>{i(F.path),_("")},children:[s.jsx("span",{className:"result-title",children:F.label}),s.jsx("span",{className:"result-path",children:F.path})]},F.path))})]})}),s.jsxs("div",{className:"navbar-right",children:[U&&s.jsxs("div",{className:"override-mode-wrap",children:[s.jsxs("span",{className:"override-mode-badge",title:`Actual role: ${t.actualRole}`,children:["Override Mode: Full Access  Viewing as: ",t.role]}),s.jsx("button",{className:"override-help",type:"button","aria-label":"Override mode help",title:"Override mode help","data-tip":"Override active: all actions execute with full permissions of the selected role.",children:"?"})]}),Z&&s.jsxs("div",{className:"sla-status-wrap",children:[s.jsxs("span",{className:`sla-status-chip ${((S==null?void 0:S.breached)||0)>0?"risk":"ok"}`,title:`Pending: ${(S==null?void 0:S.pending)??0}, Breached: ${(S==null?void 0:S.breached)??0}`,children:["SLA ",S!=null&&S.breached?`Breached ${S.breached}`:"Healthy"]}),s.jsx("button",{className:"icon-btn ghost",disabled:I,onClick:je,title:S!=null&&S.lastScanAt?`Last scan: ${new Date(S.lastScanAt).toLocaleString()}`:"Run Workflow SLA Scan",children:I?"Scanning...":"Scan SLA"})]}),s.jsxs("div",{className:"profile-wrap",children:[s.jsxs("button",{className:"icon-btn ghost",title:"Notifications",onClick:async()=>{await $s("OPEN_NOTIFICATIONS"),h(F=>!F)},children:[s.jsx(wr,{name:"bell"}),"Alerts",ae>0&&s.jsx("span",{className:"notif-badge",children:ae>99?"99+":ae})]}),p&&s.jsxs("div",{className:"notif-menu",children:[s.jsxs("div",{className:"notif-head",children:[s.jsx("span",{children:"Notifications"}),s.jsx("button",{className:"notif-close",onClick:()=>h(!1),"aria-label":"Close notifications",children:""})]}),Z&&s.jsxs("div",{className:"sla-mini",children:[s.jsxs("div",{className:"sla-mini-row",children:[s.jsx("strong",{children:"SLA Control"}),s.jsx("span",{className:S!=null&&S.breached?"text-danger":"",children:S!=null&&S.breached?`${S.breached} breached`:"No breaches"})]}),s.jsxs("div",{className:"sla-mini-meta",children:["Last scan:"," ",S!=null&&S.lastScanAt?new Date(S.lastScanAt).toLocaleString():"Never"]}),s.jsxs("div",{className:"sla-mini-actions",children:[s.jsx("button",{className:"btn-secondary",onClick:()=>{h(!1),i("/hospital-admin/approvals?view=breached#pending")},children:"Open Breaches"}),s.jsx("button",{className:"btn-secondary",onClick:()=>{h(!1),i("/hospital-admin/approvals#sla")},children:"SLA Policies"}),s.jsx("button",{className:"btn-secondary",disabled:I,onClick:je,children:I?"Scanning...":"Scan Now"})]})]}),s.jsxs("div",{className:"notif-filters",children:[s.jsxs("select",{value:b,onChange:F=>E(F.target.value),children:[s.jsx("option",{value:"ALL",children:"All Categories"}),s.jsx("option",{value:"WORKFORCE",children:"Workforce"}),s.jsx("option",{value:"SECURITY",children:"Security"}),s.jsx("option",{value:"BILLING",children:"Billing"}),s.jsx("option",{value:"SYSTEM",children:"System"}),s.jsx("option",{value:"INTEGRATION",children:"Integration"}),s.jsx("option",{value:"AI",children:"AI"})]}),s.jsxs("select",{value:g,onChange:F=>x(F.target.value),children:[s.jsx("option",{value:"ALL",children:"All Status"}),s.jsx("option",{value:"UNREAD",children:"Unread"}),s.jsx("option",{value:"READ",children:"Read"})]}),s.jsx("button",{className:"btn-secondary",onClick:async()=>{await Vj(),y(F=>F.map(se=>({...se,read:!0})))},children:"Mark all read"})]}),s.jsxs("div",{className:"notif-list",children:[f.slice(0,6).map(F=>s.jsxs("div",{className:"notif-item",children:[s.jsxs("div",{className:"notif-title",children:[F.title||"Notification",!F.read&&s.jsx("span",{className:"badge-dot",children:"!"})]}),s.jsx("div",{className:"notif-body",children:F.body||"-"}),s.jsx("div",{className:"notif-actions",children:s.jsx("button",{className:"btn-secondary",onClick:async()=>{F.read?(await Bj(F._id),y(se=>se.map(xe=>xe._id===F._id?{...xe,read:!1}:xe))):(await Uj(F._id),y(se=>se.map(xe=>xe._id===F._id?{...xe,read:!0}:xe)))},children:F.read?"Mark unread":"Mark read"})})]},F._id)),f.length===0&&s.jsx("div",{className:"muted",children:"No notifications"})]}),s.jsx("button",{className:"notif-link",onClick:()=>{h(!1),i("/admin/notifications")},children:"View All Notifications"})]})]}),W&&s.jsxs("button",{className:"icon-btn ghost",title:"Quick Calendar",onClick:()=>i("/doctor/schedule"),children:[s.jsx(wr,{name:"calendar"}),"Calendar"]}),W&&s.jsxs("button",{className:"icon-btn danger-soft",title:"Emergency Alert",onClick:async()=>{await $s("EMERGENCY_ALERT"),i("/doctor/ward")},children:[s.jsx(wr,{name:"emergency"}),"Emergency"]}),s.jsxs("button",{className:"icon-btn ghost",title:"Messages",onClick:async()=>{await $s("OPEN_MESSAGES"),i("/ai/chatbot")},children:[s.jsx(wr,{name:"chat"}),"Messages"]}),s.jsxs("button",{className:"icon-btn ghost",title:"Help",onClick:async()=>{await $s("OPEN_HELP"),i("/reports")},children:[s.jsx(wr,{name:"help"}),"Help"]}),s.jsxs("button",{className:"icon-btn ghost",title:"Theme",onClick:async()=>{await $s("TOGGLE_THEME"),l()},children:[s.jsx(wr,{name:"sun"}),o==="system"?"System":o==="dark"?"Dark":"Light"]}),s.jsxs("button",{className:"icon-btn ghost",title:"Settings",onClick:async()=>{await $s("OPEN_SETTINGS"),i("/profile")},children:[s.jsx(wr,{name:"settings"}),"Settings"]}),s.jsxs("div",{className:"profile-wrap",ref:B,children:[s.jsxs("button",{className:"profile-btn",onClick:()=>d(F=>!F),children:[s.jsx("span",{className:"avatar",children:((H=t==null?void 0:t.name)==null?void 0:H[0])||"U"}),s.jsxs("span",{className:"profile-meta",children:[s.jsx("span",{className:"profile-name",children:(t==null?void 0:t.name)||"User"}),s.jsx("span",{className:"profile-role",children:(t==null?void 0:t.role)||"User"})]})]}),u&&s.jsxs("div",{className:"profile-menu",children:[s.jsxs("div",{className:"profile-menu-head",children:[s.jsx("span",{children:"Profile"}),s.jsx("button",{className:"notif-close",onClick:()=>d(!1),"aria-label":"Close profile menu",children:""})]}),s.jsx("button",{onClick:()=>i("/profile"),children:"My Profile"}),s.jsx("button",{onClick:()=>i("/profile"),children:"Preferences"}),s.jsx("button",{onClick:()=>i("/reports"),children:"About AfyaLink"}),Y?s.jsx("button",{onClick:()=>i("/register"),children:"Upgrade"}):s.jsx("button",{className:"danger",onClick:n,children:"Sign Out"})]})]})]})]})}const rd={appointments:{read:["SUPER_ADMIN","DEVELOPER","HOSPITAL_ADMIN","DOCTOR","NURSE"],create:["DOCTOR","HOSPITAL_ADMIN"],update:["DOCTOR","HOSPITAL_ADMIN"],delete:["HOSPITAL_ADMIN"]},pharmacy:{read:["PHARMACIST","HOSPITAL_ADMIN"],dispense:["PHARMACIST"],manage:["HOSPITAL_ADMIN"]},inventory:{read:["PHARMACIST","HOSPITAL_ADMIN","SUPER_ADMIN","DEVELOPER","SYSTEM_ADMIN"],update:["PHARMACIST","HOSPITAL_ADMIN"]},billing:{read:["HOSPITAL_ADMIN","ACCOUNTANT"],create:["ACCOUNTANT"]},reports:{read:["SUPER_ADMIN","DEVELOPER","HOSPITAL_ADMIN"]},audit:{read:["SUPER_ADMIN","DEVELOPER","HOSPITAL_ADMIN"]}},q_=()=>{const{user:e}=Me();return{can:(n,r)=>{var a;return e?(((a=rd==null?void 0:rd[n])==null?void 0:a[r])||[]).includes(e.role):!1}}},z_=async()=>(await ue.get("/api/menu")).data;function vn({name:e}){var i,a;const{settings:t}=fi(),n={home:"",admin:"",hr:"",payroll:"",doctor:"",nurse:"",lab:"",pharmacy:"",staff:"",security:"",settings:"",analytics:"",reports:"",notifications:"",requests:"",inventory:"",ai:"",appointments:""},r=(a=(i=t==null?void 0:t.branding)==null?void 0:i.sidebarIcons)==null?void 0:a[e];return s.jsx("span",{className:"nav-icon","aria-hidden":"true",children:r?s.jsx("img",{className:"nav-icon-img",src:r,alt:""}):n[e]||""})}function W_({open:e=!0,onClose:t}){var b,E;const{user:n,logout:r}=Me(),{can:i}=q_(),{theme:a,setTheme:o}=Dj(),{settings:l}=fi(),c=Oe(),[u,d]=m.useState([]),[p,h]=m.useState(!1);if(m.useEffect(()=>{!n||!localStorage.getItem("token")||z_().then(x=>{d(x.menu||[]),h(!0)}).catch(()=>{d([]),h(!0)})},[n]),!n)return null;Ss(n);const f=Qe(n.role),y=!["SUPER_ADMIN","SYSTEM_ADMIN","GUEST","PATIENT"].includes(f);return n.role==="GUEST"?s.jsxs("aside",{className:`sidebar ${e?"":"collapsed"}`,onWheel:g=>g.stopPropagation(),children:[s.jsxs("div",{className:"sidebar-header sticky",children:[s.jsx("div",{className:"brand-mark",children:(b=l==null?void 0:l.branding)!=null&&b.logo?s.jsx("span",{className:"brand-logo",style:{backgroundImage:`url(${l.branding.logo})`}}):"AfyaLink"}),s.jsx("div",{className:"brand-sub",children:"Demo Workspace"})]}),s.jsx("div",{className:"sidebar-scroll",children:s.jsx("nav",{children:s.jsxs("ul",{children:[s.jsx("li",{children:s.jsxs("button",{className:"nav-btn",onClick:()=>{c("/guest"),t==null||t()},children:[s.jsx(vn,{name:"home"}),"Demo Home"]})}),s.jsxs(_t,{title:"Demo",children:[i("ai","chat")&&s.jsx(J,{to:"/ai/chatbot",icon:"ai",onSelect:t,children:"AI Chatbot"}),i("ai","medical")&&s.jsx(J,{to:"/ai/medical",icon:"ai",onSelect:t,children:"AI Assistant"})]})]})})}),s.jsxs("div",{className:"sidebar-footer sticky-footer",children:[s.jsxs("div",{className:"footer-actions",children:[s.jsxs("button",{className:"nav-btn",onClick:()=>{c("/reports"),t==null||t()},children:[s.jsx(vn,{name:"reports"}),"Help"]}),s.jsxs("button",{className:"nav-btn",onClick:()=>{c("/profile"),t==null||t()},children:[s.jsx(vn,{name:"settings"}),"Settings"]}),s.jsxs("button",{className:"nav-btn",onClick:()=>{r(),t==null||t()},children:[s.jsx(vn,{name:"security"}),"Sign Out"]})]}),s.jsx("div",{children:"AfyaLink  Demo Mode"})]})]}):s.jsxs("aside",{className:`sidebar ${e?"":"collapsed"}`,onWheel:g=>g.stopPropagation(),children:[s.jsxs("div",{className:"sidebar-header sticky",children:[s.jsx("div",{className:"brand-mark",children:(E=l==null?void 0:l.branding)!=null&&E.logo?s.jsx("span",{className:"brand-logo",style:{backgroundImage:`url(${l.branding.logo})`}}):"AfyaLink"}),s.jsxs("div",{className:"brand-sub",children:[n.role," Workspace"]})]}),s.jsx("div",{className:"sidebar-scroll",children:s.jsx("nav",{children:s.jsxs("ul",{children:[p&&u.length>0&&u.map(g=>s.jsx(_t,{title:g.section,children:g.items.map((x,w)=>x.path?s.jsx(J,{to:x.path,icon:x.icon||"admin",onSelect:t,children:x.label},x.path||`${g.section}-${w}`):s.jsx("li",{className:"nav-static",children:s.jsxs("span",{className:"nav-btn",children:[s.jsx(vn,{name:x.icon||"admin"}),x.label]})},`${g.section}-${w}`))},g.section)),p&&u.length===0&&s.jsxs(s.Fragment,{children:[["SUPER_ADMIN","DEVELOPER"].includes(f)&&s.jsxs(_t,{title:"All Dashboards",children:[s.jsx(J,{to:"/super-admin",icon:"admin",onSelect:t,children:"Super Admin"}),s.jsx(J,{to:"/system-admin",icon:"admin",onSelect:t,children:"System Admin"}),s.jsx(J,{to:"/hospital-admin",icon:"admin",onSelect:t,children:"Hospital Admin"}),s.jsx(J,{to:"/hr-manager",icon:"hr",onSelect:t,children:"HR Manager"}),s.jsx(J,{to:"/payroll-officer",icon:"payroll",onSelect:t,children:"Payroll Officer"}),s.jsx(J,{to:"/doctor",icon:"doctor",onSelect:t,children:"Doctor"}),s.jsx(J,{to:"/nurse",icon:"nurse",onSelect:t,children:"Nurse"}),s.jsx(J,{to:"/lab-tech",icon:"lab",onSelect:t,children:"Lab Tech"}),s.jsx(J,{to:"/pharmacy",icon:"pharmacy",onSelect:t,children:"Pharmacist"}),s.jsx(J,{to:"/staff",icon:"staff",onSelect:t,children:"Staff (Radiology/Therapy/Reception)"}),s.jsx(J,{to:"/security-admin",icon:"security",onSelect:t,children:"Security Admin"}),s.jsx(J,{to:"/security-officer",icon:"security",onSelect:t,children:"Security Officer"}),s.jsx(J,{to:"/developer",icon:"settings",onSelect:t,children:"Developer Console"}),s.jsx(J,{to:"/developer/queue-replay",icon:"settings",onSelect:t,children:"Queue Replay"}),s.jsx(J,{to:"/developer/webhook-retry",icon:"settings",onSelect:t,children:"Webhook Retry"}),s.jsx(J,{to:"/developer/decision-cockpit",icon:"analytics",onSelect:t,children:"Decision Cockpit"}),s.jsx(J,{to:"/developer/provenance-verify",icon:"security",onSelect:t,children:"Provenance Verify"}),s.jsx(J,{to:"/developer/ai-extraction-history",icon:"ai",onSelect:t,children:"AI Extraction History"})]}),s.jsxs(_t,{title:"Home",children:[s.jsx(J,{to:"/analytics",icon:"analytics",onSelect:t,children:"Insights"}),s.jsx(J,{to:"/reports",icon:"reports",onSelect:t,children:"Reports"}),f==="SYSTEM_ADMIN"&&s.jsx(J,{to:"/system-admin",icon:"admin",onSelect:t,children:"System Admin"}),["SYSTEM_ADMIN","SUPER_ADMIN","DEVELOPER"].includes(Qe(n.role))&&s.jsx(J,{to:"/system-admin/abac",icon:"security",onSelect:t,children:"ABAC Policies"}),["SYSTEM_ADMIN","SUPER_ADMIN","DEVELOPER"].includes(Qe(n.role))&&s.jsx(J,{to:"/system-admin/mapping-studio",icon:"settings",onSelect:t,children:"Mapping Studio"}),["SYSTEM_ADMIN","SUPER_ADMIN","DEVELOPER","HOSPITAL_ADMIN","HR_MANAGER","PAYROLL_OFFICER"].includes(Qe(n.role))&&s.jsx(J,{to:"/system-admin/nlp-analytics",icon:"analytics",onSelect:t,children:"NLP Analytics"}),["SYSTEM_ADMIN","SUPER_ADMIN","DEVELOPER","HOSPITAL_ADMIN","HR_MANAGER","DOCTOR","NURSE"].includes(Qe(n.role))&&s.jsx(J,{to:"/system-admin/clinical-intelligence",icon:"ai",onSelect:t,children:"Clinical Intelligence"}),["SYSTEM_ADMIN","SUPER_ADMIN","DEVELOPER","HOSPITAL_ADMIN"].includes(Qe(n.role))&&s.jsx(J,{to:"/system-admin/regulatory-reports",icon:"reports",onSelect:t,children:"Regulatory Reports"}),f==="DEVELOPER"&&s.jsx(J,{to:"/developer",icon:"settings",onSelect:t,children:"Developer Console"}),["SUPER_ADMIN","SYSTEM_ADMIN"].includes(Qe(n.role))&&s.jsx(J,{to:"/super-admin/hospitals",icon:"admin",onSelect:t,children:"Manage Hospitals"})]}),s.jsxs(_t,{title:"Human Resources",children:[s.jsx(J,{to:"/hospital-admin",icon:"admin",onSelect:t,children:"Hospital Admin"}),s.jsx(J,{to:"/hospital-admin/register-staff",icon:"staff",onSelect:t,children:"Register Staff"}),s.jsx(J,{to:"/hospital-admin/approvals",icon:"notifications",onSelect:t,children:"Approvals"}),s.jsx(J,{to:"/hospital-admin/staff",icon:"staff",onSelect:t,children:"Staff Management"}),y&&s.jsx(J,{to:"/workforce/requests",icon:"requests",onSelect:t,children:"My Requests"}),s.jsx(J,{to:"/staff",icon:"staff",onSelect:t,children:"Staff Workspace"}),s.jsx(J,{to:"/hr-manager",icon:"hr",onSelect:t,children:"HR Manager"}),i("inventory","read")&&s.jsx(J,{to:"/inventory",icon:"inventory",onSelect:t,children:"Inventory"}),i("pharmacy","read")&&s.jsx(J,{to:"/pharmacy",icon:"pharmacy",onSelect:t,children:"Pharmacy"})]}),s.jsxs(_t,{title:"Talent",children:[s.jsx(J,{to:"/admin/create-admin",icon:"admin",onSelect:t,children:"Admin Access"}),s.jsx(J,{to:"/admin/audit-logs",icon:"admin",onSelect:t,children:"Audit Logs"}),s.jsx(J,{to:"/admin/notifications",icon:"notifications",onSelect:t,children:"Notifications"})]}),s.jsxs(_t,{title:"Workforce",children:[s.jsx(J,{to:"/doctor",icon:"doctor",onSelect:t,children:"Clinician Dashboard"}),s.jsx(J,{to:"/nurse",icon:"nurse",onSelect:t,children:"Nursing Dashboard"}),s.jsx(J,{to:"/lab-tech",icon:"lab",onSelect:t,children:"Lab Dashboard"}),s.jsx(J,{to:"/labtech/labs",icon:"lab",onSelect:t,children:"Lab Tests"}),s.jsx(J,{to:"/doctor/appointments",icon:"appointments",onSelect:t,children:"Appointments"})]}),f==="DOCTOR"&&s.jsxs(_t,{title:"Doctor Workspace",children:[s.jsx(J,{to:"/doctor/schedule",icon:"appointments",onSelect:t,children:"My Schedule"}),s.jsx(J,{to:"/doctor/patients",icon:"doctor",onSelect:t,children:"My Patients"}),s.jsx(J,{to:"/doctor/opd",icon:"doctor",onSelect:t,children:"OPD Clinic"}),s.jsx(J,{to:"/doctor/ward",icon:"staff",onSelect:t,children:"Inpatient Ward"}),s.jsx(J,{to:"/doctor/surgery",icon:"reports",onSelect:t,children:"Surgery / Procedures"}),s.jsx(J,{to:"/doctor/lab-results",icon:"lab",onSelect:t,children:"Lab Results"}),s.jsx(J,{to:"/doctor/prescriptions",icon:"pharmacy",onSelect:t,children:"Prescriptions"}),s.jsx(J,{to:"/doctor/medical-records",icon:"reports",onSelect:t,children:"Medical Records"}),s.jsx(J,{to:"/doctor/referrals",icon:"reports",onSelect:t,children:"Referrals"}),s.jsx(J,{to:"/doctor/performance",icon:"analytics",onSelect:t,children:"Performance"}),s.jsx(J,{to:"/doctor/cme",icon:"doctor",onSelect:t,children:"CME & Certifications"}),s.jsx(J,{to:"/doctor/leave",icon:"requests",onSelect:t,children:"Leave Requests"}),s.jsx(J,{to:"/doctor/reports-notes",icon:"reports",onSelect:t,children:"Reports & Notes"}),s.jsx(J,{to:"/doctor/settings",icon:"settings",onSelect:t,children:"Settings"})]}),f==="NURSE"&&s.jsxs(_t,{title:"Nurse Workspace",children:[s.jsx(J,{to:"/nurse/shift",icon:"nurse",onSelect:t,children:"My Shift"}),s.jsx(J,{to:"/nurse/patients",icon:"staff",onSelect:t,children:"Assigned Patients"}),s.jsx(J,{to:"/nurse/medication",icon:"nurse",onSelect:t,children:"Medication Administration"}),s.jsx(J,{to:"/nurse/incidents",icon:"notifications",onSelect:t,children:"Incident Reports"}),s.jsx(J,{to:"/nurse/vitals",icon:"reports",onSelect:t,children:"Vitals Entry"}),s.jsx(J,{to:"/nurse/leave",icon:"requests",onSelect:t,children:"Leave Requests"}),s.jsx(J,{to:"/nurse/performance",icon:"analytics",onSelect:t,children:"Performance"})]}),f==="LAB_TECH"&&s.jsxs(_t,{title:"Lab Workspace",children:[s.jsx(J,{to:"/lab-tech/test-queue",icon:"lab",onSelect:t,children:"Test Queue"}),s.jsx(J,{to:"/lab-tech/equipment",icon:"lab",onSelect:t,children:"Equipment Logs"}),s.jsx(J,{to:"/lab-tech/samples",icon:"lab",onSelect:t,children:"Sample Tracking"}),s.jsx(J,{to:"/lab-tech/qc",icon:"analytics",onSelect:t,children:"Quality Control"}),s.jsx(J,{to:"/lab-tech/safety",icon:"security",onSelect:t,children:"Safety Checklist"}),s.jsx(J,{to:"/lab-tech/archive",icon:"reports",onSelect:t,children:"Reports Archive"})]}),f==="PHARMACIST"&&s.jsxs(_t,{title:"Pharmacy Workspace",children:[s.jsx(J,{to:"/pharmacy/queue",icon:"pharmacy",onSelect:t,children:"Prescription Queue"}),s.jsx(J,{to:"/pharmacy/inventory",icon:"inventory",onSelect:t,children:"Inventory"}),s.jsx(J,{to:"/pharmacy/controlled",icon:"security",onSelect:t,children:"Controlled Drugs"}),s.jsx(J,{to:"/pharmacy/expiry",icon:"notifications",onSelect:t,children:"Expiry Alerts"}),s.jsx(J,{to:"/pharmacy/suppliers",icon:"reports",onSelect:t,children:"Supplier Orders"}),s.jsx(J,{to:"/pharmacy/reports",icon:"reports",onSelect:t,children:"Reports"})]}),f==="PATIENT"&&s.jsxs(_t,{title:"Patient Workspace",children:[s.jsx(J,{to:"/patient/appointments",icon:"appointments",onSelect:t,children:"My Appointments"}),s.jsx(J,{to:"/patient/medical-records",icon:"reports",onSelect:t,children:"Medical Records"}),s.jsx(J,{to:"/patient/prescriptions",icon:"pharmacy",onSelect:t,children:"Prescriptions"}),s.jsx(J,{to:"/patient/lab-results",icon:"lab",onSelect:t,children:"Lab Results"}),s.jsx(J,{to:"/patient/billing",icon:"payroll",onSelect:t,children:"Billing"}),s.jsx(J,{to:"/patient/insurance",icon:"reports",onSelect:t,children:"Insurance"}),s.jsx(J,{to:"/patient/feedback",icon:"notifications",onSelect:t,children:"Feedback"})]}),s.jsxs(_t,{title:"Payroll & Finance",children:[s.jsx(J,{to:"/payments",icon:"payroll",onSelect:t,children:"Payroll & Payments"}),s.jsx(J,{to:"/payments/full",icon:"payroll",onSelect:t,children:"Payment Operations"}),Qe(n.role)==="SUPER_ADMIN"&&s.jsx(J,{to:"/admin/payment-settings",icon:"payroll",onSelect:t,children:"Payment Settings"}),s.jsx(J,{to:"/payroll-officer",icon:"payroll",onSelect:t,children:"Payroll Officer"})]}),s.jsxs(_t,{title:"AI & Automation",children:[s.jsx(J,{to:"/ai/medical",icon:"ai",onSelect:t,children:"Clinical Assistant"}),s.jsx(J,{to:"/ai/triage",icon:"ai",onSelect:t,children:"Triage"}),s.jsx(J,{to:"/ai/voice",icon:"ai",onSelect:t,children:"Voice Dictation"}),s.jsx(J,{to:"/ai/extract",icon:"ai",onSelect:t,children:"NeuroEdge Extract"}),s.jsx(J,{to:"/ai/chatbot",icon:"ai",onSelect:t,children:"Support Chat"}),s.jsx(J,{to:"/ai/ws",icon:"ai",onSelect:t,children:"Live AI Chat"})]}),s.jsxs(_t,{title:"Security & Setup",children:[s.jsx(J,{to:"/security-admin",icon:"security",onSelect:t,children:"Security Admin"}),s.jsx(J,{to:"/security-officer",icon:"security",onSelect:t,children:"Security Officer"}),s.jsx(J,{to:"/admin/realtime",icon:"settings",onSelect:t,children:"Integrations"}),s.jsx(J,{to:"/admin/crdt-patients",icon:"settings",onSelect:t,children:"Offline Sync"})]}),s.jsx(_t,{title:"Quick Actions",children:G_(Qe(n.role)).map(g=>s.jsx(J,{to:g.path,icon:"home",onSelect:t,children:g.label},g.path))}),s.jsxs(_t,{title:"Settings",children:[["SUPER_ADMIN","DEVELOPER"].includes(Qe(n.role))&&s.jsx(J,{to:"/super-admin/settings",icon:"settings",onSelect:t,children:"System Settings"}),s.jsx(J,{to:"/profile",icon:"settings",onSelect:t,children:"Account Settings"}),s.jsx(J,{to:"/reports",icon:"reports",onSelect:t,children:"Help & Policies"}),s.jsx(J,{to:"/admin/audit-logs",icon:"admin",onSelect:t,children:"Activity Log"}),s.jsxs("li",{className:"theme-row",children:[s.jsxs("button",{className:`nav-btn ${a==="light"?"active":""}`,onClick:()=>o("light"),children:[s.jsx(vn,{name:"settings"}),"Light"]}),s.jsxs("button",{className:`nav-btn ${a==="dark"?"active":""}`,onClick:()=>o("dark"),children:[s.jsx(vn,{name:"settings"}),"Dark"]}),s.jsxs("button",{className:`nav-btn ${a==="system"?"active":""}`,onClick:()=>o("system"),children:[s.jsx(vn,{name:"settings"}),"System"]})]})]})]})]})})}),s.jsxs("div",{className:"sidebar-footer sticky-footer",children:[s.jsxs("div",{className:"footer-actions",children:[s.jsxs("button",{className:"nav-btn",onClick:()=>{c("/reports"),t==null||t()},children:[s.jsx(vn,{name:"reports"}),"Help"]}),s.jsxs("button",{className:"nav-btn",onClick:()=>{c("/profile"),t==null||t()},children:[s.jsx(vn,{name:"settings"}),"Settings"]}),s.jsxs("button",{className:"nav-btn",onClick:()=>{r(),t==null||t()},children:[s.jsx(vn,{name:"security"}),"Sign Out"]})]}),s.jsx("div",{children:"AfyaLink  Secure"})]})]})}function _t({title:e,children:t}){return s.jsxs(s.Fragment,{children:[s.jsx("li",{className:"section-title",children:e}),t]})}function J({to:e,children:t,icon:n,onSelect:r}){const i=Oe();return s.jsx("li",{children:s.jsxs("button",{className:"nav-btn",onClick:()=>{i(e),r==null||r()},children:[s.jsx(vn,{name:n}),t]})})}function G_(e){const t=[{label:"Request Leave",path:"/workforce/requests#leave"},{label:"Request Overtime",path:"/workforce/requests#overtime"},{label:"Request Shift",path:"/workforce/requests#shift"}],n=[{label:"View Notifications",path:"/admin/notifications"},{label:"Open Reports",path:"/reports"}],r={SUPER_ADMIN:[{label:"Manage Hospitals",path:"/super-admin/hospitals"},{label:"Create Admin",path:"/admin/create-admin"},{label:"Audit Logs",path:"/admin/audit-logs"},{label:"SLA Policies",path:"/hospital-admin/approvals#sla"},{label:"Queue Insights",path:"/hospital-admin/approvals"}],SYSTEM_ADMIN:[{label:"Manage Hospitals",path:"/super-admin/hospitals"},{label:"Audit Logs",path:"/admin/audit-logs"},{label:"SLA Policies",path:"/hospital-admin/approvals#sla"},{label:"Queue Insights",path:"/hospital-admin/approvals"}],HOSPITAL_ADMIN:[{label:"Open Approvals",path:"/hospital-admin"},{label:"Inventory Review",path:"/inventory"},{label:"SLA Policies",path:"/hospital-admin/approvals#sla"}],HR_MANAGER:[{label:"Recruitment Pipeline",path:"/hr-manager"},{label:"Performance Reviews",path:"/hr-manager"}],PAYROLL_OFFICER:[{label:"Run Payroll",path:"/payroll-officer"},{label:"Payment Operations",path:"/payments/full"}],DOCTOR:[{label:"Start Consult",path:"/doctor"},{label:"Appointments",path:"/doctor/appointments"}],NURSE:[{label:"Start Round",path:"/nurse"},{label:"Patient Tasks",path:"/nurse"}],LAB_TECH:[{label:"Lab Queue",path:"/lab-tech"},{label:"Lab Tests",path:"/labtech/labs"}],PHARMACIST:[{label:"Dispense Queue",path:"/pharmacy"},{label:"Inventory",path:"/inventory"}],RADIOLOGIST:[],THERAPIST:[],RECEPTIONIST:[],DEVELOPER:[{label:"Integration Console",path:"/developer"},{label:"SLA Policies",path:"/hospital-admin/approvals#sla"},{label:"Queue Insights",path:"/hospital-admin/approvals"}],PATIENT:[{label:"Book Appointment",path:"/patient"},{label:"Payments",path:"/payments"}]},i=["HOSPITAL_ADMIN","HR_MANAGER","PAYROLL_OFFICER","DOCTOR","NURSE","LAB_TECH","PHARMACIST","RADIOLOGIST","THERAPIST","RECEPTIONIST","SECURITY_ADMIN","SECURITY_OFFICER"].includes(e);return[...r[e]||[],...i?t:[],...n]}function Y_(){const{settings:e}=fi(),t=e==null?void 0:e.ai;return!(t!=null&&t.enabled)||!(t!=null&&t.url)?null:s.jsxs("button",{className:"ai-float",onClick:()=>window.open(t.url,"_blank"),title:t.name||"NeuroEdge",children:[s.jsx("span",{className:"ai-float-badge",children:t.name||"NeuroEdge"}),s.jsx("span",{className:"ai-float-sub",children:t.greeting||"Ask AI"})]})}function K_(){const{user:e}=Me(),[t,n]=m.useState(!1);m.useEffect(()=>{if(!(e!=null&&e.id))return;const i=`tour_seen_${e.id}`;localStorage.getItem(i)==="true"||n(!0)},[e==null?void 0:e.id]);const r=()=>{e!=null&&e.id&&localStorage.setItem(`tour_seen_${e.id}`,"true"),n(!1)};return t?s.jsx("div",{className:"tour-backdrop",role:"dialog","aria-modal":"true",children:s.jsxs("div",{className:"tour-modal",children:[s.jsx("button",{className:"tour-close",onClick:r,"aria-label":"Close",children:""}),s.jsx("h3",{children:"Welcome to AfyaLink HRMS"}),s.jsx("p",{className:"muted",children:"Heres a quick guide to get you started. You can revisit this anytime from Help."}),s.jsxs("ul",{className:"tour-list",children:[s.jsx("li",{children:"Use the navigator to switch dashboards and modules."}),s.jsx("li",{children:"Search across people, tasks, and reports from the top bar."}),s.jsx("li",{children:"Complete your verification in Profile for full access."}),s.jsx("li",{children:"Check alerts for approvals, requests, and system notices."})]}),s.jsxs("div",{className:"tour-actions",children:[s.jsx("button",{className:"btn-secondary",onClick:r,children:"Skip"}),s.jsx("button",{className:"btn-primary",onClick:r,children:"Start"})]})]})}):null}function J_(e,...t){if(!e)return{allowed:!1,reason:"UNAUTHENTICATED"};if(!t.length)return{allowed:!0};const n=Qe(e.role),r=t.map(i=>Qe(i));return["SUPER_ADMIN","DEVELOPER"].includes(n)?{allowed:!0}:r.includes(n)?{allowed:!0}:{allowed:!1,reason:"FORBIDDEN"}}function ie({roles:e=[],children:t}){const{user:n,loading:r}=Me(),i=Cn();return r?null:n?J_(n,...e).allowed?t:s.jsx(go,{to:"/unauthorized",replace:!0}):s.jsx(go,{to:"/login",state:{from:i},replace:!0})}function Q_({children:e}){const{user:t,loading:n}=Me(),r=Cn(),i=Oe();return m.useEffect(()=>{if(n||!t)return;const a=Ss(t);r.pathname==="/"&&i(a,{replace:!0})},[t,n,r.pathname,i]),e}function Uc({label:e="Password",value:t,onChange:n,placeholder:r="",showStrength:i=!1}){const[a,o]=m.useState(!1),l=t.length>=12?"strong":t.length>=8?"medium":t.length>0?"weak":"";return s.jsxs("div",{children:[s.jsx("label",{children:e}),s.jsxs("div",{style:{position:"relative"},children:[s.jsx("input",{type:a?"text":"password",value:t,placeholder:r,onChange:n,required:!0}),s.jsx("span",{onClick:()=>o(!a),style:{position:"absolute",right:14,top:12,cursor:"pointer",userSelect:"none"},children:a?"":""})]}),i&&t&&s.jsxs("div",{className:`pw-strength ${l}`,children:["Password strength: ",s.jsx("b",{children:l})]})]})}function $j(){const{login:e}=Me(),t=Oe(),[n,r]=m.useState(null),i=async a=>{try{if(r(null),!(a!=null&&a.credential))throw new Error("Missing Google credential");const o=await oe("/api/auth/google",{method:"POST",body:{credential:a.credential}}),l=o.accessToken||o.token;await e(null,{directToken:!0,token:l,refreshToken:o.refreshToken,user:o.user}),t(Ss(o.user),{replace:!0})}catch(o){r(o.message||"Google authentication failed")}};return{GoogleButton:()=>s.jsx(PN,{onSuccess:i,onError:()=>r("Google authentication failed")}),error:n,clearError:()=>r(null)}}function Z_(){var _;const{login:e}=Me(),{settings:t}=fi(),n=Oe(),r=Cn(),{GoogleButton:i,error:a,clearError:o}=$j(),[l,c]=m.useState(""),[u,d]=m.useState(""),[p,h]=m.useState(!1),[f,y]=m.useState(""),[b,E]=m.useState(""),[g,x]=m.useState(!1);m.useEffect(()=>{new URLSearchParams(r.search).get("verify")&&E("Account created. Verify your email from Profile inside the app.")},[r.search]),m.useEffect(()=>{const S=localStorage.getItem("remember_email");S&&(c(S),h(!0))},[]);const w=async S=>{S.preventDefault(),y(""),E(""),x(!0),o==null||o();try{p?localStorage.setItem("remember_email",l):localStorage.removeItem("remember_email");const k=await e(l.trim(),u);if(k!=null&&k.requires2FA){n("/2fa",{state:{userId:k.userId,email:l}});return}if(!(k!=null&&k.user))throw new Error("Invalid credentials");if(!k.user.emailVerified&&!k.user.phoneVerified){E("Account not verified. Complete verification in Profile."),n("/profile",{replace:!0});return}n(Ss(k.user),{replace:!0})}catch(k){y(k.message||"Invalid credentials")}finally{x(!1)}};return s.jsx("div",{className:"auth-bg",children:s.jsxs("form",{className:"auth-card",onSubmit:w,children:[((_=t==null?void 0:t.branding)==null?void 0:_.logo)&&s.jsx("div",{className:"brand-logo",style:{backgroundImage:`url(${t.branding.logo})`,margin:"0 auto 10px"}}),s.jsx("h1",{children:"Welcome back"}),s.jsx("p",{className:"subtitle",children:"Sign in to AfyaLink HRMS"}),f&&s.jsx("div",{className:"auth-error",children:f}),b&&s.jsx("div",{className:"auth-info",children:b}),a&&s.jsx("div",{className:"auth-error",children:a}),s.jsx("label",{children:"Email or phone"}),s.jsx("input",{type:"text",value:l,onChange:S=>c(S.target.value),required:!0}),s.jsx(Uc,{label:"Password",value:u,onChange:S=>d(S.target.value),required:!0}),s.jsxs("div",{className:"auth-row",children:[s.jsxs("label",{className:"remember",children:[s.jsx("input",{type:"checkbox",checked:p,onChange:S=>h(S.target.checked)}),"Remember me"]}),s.jsx(li,{to:"/forgot-password",className:"forgot-link",children:"Forgot password?"})]}),s.jsx("button",{disabled:g,children:g?"Signing in...":"Sign in"}),s.jsx("div",{className:"divider",children:"or"}),s.jsx("div",{onClick:()=>o==null?void 0:o(),children:s.jsx(i,{})}),s.jsxs("div",{className:"auth-footer",children:[s.jsx("span",{children:"Dont have an account?"}),s.jsx(li,{to:"/register",children:"Create account"})]})]})})}function X_(){const e=Oe(),{login:t}=Me(),{GoogleButton:n,error:r}=$j(),[i,a]=m.useState({name:"",email:"",phone:"",nationalIdNumber:"",nationalIdCountry:"",password:"",confirmPassword:""}),[o,l]=m.useState(!1),[c,u]=m.useState(""),[d,p]=m.useState(""),h=y=>{a({...i,[y.target.name]:y.target.value}),u(""),p("")},f=async y=>{if(y.preventDefault(),i.password!==i.confirmPassword){u("Passwords do not match");return}try{l(!0),u(""),p("");const b=await oe("/api/auth/register",{method:"POST",body:{name:i.name.trim(),email:i.email?i.email.toLowerCase().trim():void 0,phone:i.phone?i.phone.trim():void 0,nationalIdNumber:i.nationalIdNumber||void 0,nationalIdCountry:i.nationalIdCountry||void 0,password:i.password}});b.accessToken&&b.user?(await t(null,{directToken:!0,token:b.accessToken,user:b.user}),p("Account created! Verify your email from Profile inside the app."),e(Ss(b.user),{replace:!0})):(p(b.phoneOtpSent?"Registration successful. An OTP was sent to your phone. Verify to activate your account.":b.msg||"Registration successful. Verify your email from Profile inside the app."),e("/login"))}catch(b){const E=b.message||"Registration failed";u(E)}finally{l(!1)}};return s.jsx("div",{className:"auth-bg",children:s.jsxs("form",{className:"auth-card",onSubmit:f,children:[s.jsx("h1",{children:"Create your account"}),s.jsx("p",{className:"subtitle",children:"Join AfyaLink HRMS"}),c&&s.jsx("div",{className:"auth-error",children:c}),d&&s.jsx("div",{className:"auth-info",children:d}),r&&s.jsx("div",{className:"auth-error",children:r}),s.jsx("label",{children:"Full Name"}),s.jsx("input",{name:"name",value:i.name,onChange:h,required:!0}),s.jsx("label",{children:"Email address (optional)"}),s.jsx("input",{type:"email",name:"email",value:i.email,onChange:h}),s.jsx("label",{children:"Phone number (optional)"}),s.jsx("input",{name:"phone",value:i.phone,onChange:h}),s.jsx("label",{children:"National ID Number"}),s.jsx("input",{name:"nationalIdNumber",value:i.nationalIdNumber,onChange:h}),s.jsx("label",{children:"National ID Country"}),s.jsx("input",{name:"nationalIdCountry",value:i.nationalIdCountry,onChange:h,placeholder:"e.g. KE, US, NG"}),s.jsx(Uc,{label:"Password",value:i.password,onChange:y=>a({...i,password:y.target.value}),showStrength:!0,required:!0}),s.jsx(Uc,{label:"Confirm password",value:i.confirmPassword,onChange:y=>a({...i,confirmPassword:y.target.value}),required:!0}),s.jsx("div",{className:"muted",style:{marginBottom:10},children:"Unverified accounts may be deleted after the verification deadline."}),s.jsx("button",{disabled:o,children:o?"Creating account...":"Create account"}),s.jsx("div",{className:"divider",children:"or"}),s.jsx(n,{}),s.jsxs("div",{className:"auth-footer",children:[s.jsx("span",{children:"Already have an account?"}),s.jsx(li,{to:"/login",children:"Login"})]})]})})}function eA(){const[e]=fj(),[t,n]=m.useState("verifying"),[r,i]=m.useState(0),[a,o]=m.useState(!1),[l,c]=m.useState(""),u=e.get("token");m.useEffect(()=>{if(!u){n("invalid");return}oe(`/api/auth/verify-email?token=${u}`).then(()=>n("success")).catch(()=>n("error"))},[u]),m.useEffect(()=>{if(r<=0)return;const p=setInterval(()=>i(h=>h-1),1e3);return()=>clearInterval(p)},[r]);const d=async()=>{try{o(!0);const p=await oe("/api/auth/resend-verification",{method:"POST",body:{email:l}});i(p.retryAfter||60)}catch{alert("Failed to resend verification email")}finally{o(!1)}};return s.jsxs("div",{className:"verify-page",children:[t==="verifying"&&s.jsxs("div",{className:"card pulse",children:[s.jsx("h1",{children:"Verifying"}),s.jsx("p",{children:"Please wait"})]}),t==="success"&&s.jsxs("div",{className:"card success pop",children:[s.jsx("h1",{children:" Email Verified"}),s.jsx("p",{children:"Your account is now active."}),s.jsx(li,{to:"/login",className:"btn",children:"Go to Login"})]}),t==="invalid"&&s.jsxs("div",{className:"card error shake",children:[s.jsx("h1",{children:" Invalid Link"}),s.jsx("p",{children:"This verification link is invalid."})]}),t==="error"&&s.jsxs("div",{className:"card error shake",children:[s.jsx("h1",{children:" Verification Failed"}),s.jsx("p",{children:"Link expired or already used."}),s.jsx("input",{type:"email",placeholder:"Enter your email",value:l,onChange:p=>c(p.target.value),style:{marginTop:12}}),s.jsx("button",{onClick:d,disabled:a||r>0||!l,className:"btn secondary",children:r>0?`Resend in ${r}s`:a?"Sending":"Resend verification email"})]})]})}function tA(){return s.jsx("div",{className:"auth-bg",children:s.jsxs("div",{className:"auth-card",children:[s.jsx("h1",{children:" Email Verified"}),s.jsx("p",{className:"subtitle",children:"Your email has been successfully verified. You can now log in to your account."}),s.jsx(li,{to:"/login",children:s.jsx("button",{children:"Go to login"})})]})})}function Eg(){return s.jsxs("div",{style:{padding:40},children:[s.jsx("h1",{children:"403  Unauthorized"}),s.jsx("p",{children:"You do not have permission to access this page."})]})}function nA(){const[e,t]=m.useState(""),[n,r]=m.useState(""),[i,a]=m.useState(""),[o,l]=m.useState(!1),c=async u=>{u.preventDefault(),l(!0),r(""),a("");try{await oe("/api/auth/forgot-password",{method:"POST",body:{email:e}}),r("If the email exists, a reset link has been sent.")}catch(d){a(d.message||"Something went wrong")}finally{l(!1)}};return s.jsx("div",{className:"auth-bg",children:s.jsxs("form",{className:"auth-card",onSubmit:c,children:[s.jsx("h1",{children:"Forgot password"}),s.jsx("p",{className:"subtitle",children:"Enter your email and well send you a reset link"}),i&&s.jsx("div",{className:"auth-error",children:i}),n&&s.jsx("div",{className:"auth-info",children:n}),s.jsx("label",{children:"Email address"}),s.jsx("input",{type:"email",required:!0,value:e,onChange:u=>t(u.target.value),placeholder:"you@example.com"}),s.jsx("button",{disabled:o,children:o?"Sending...":"Send reset link"})]})})}function rA(){const[e]=fj(),t=Oe(),n=e.get("token"),[r,i]=m.useState(""),[a,o]=m.useState(""),[l,c]=m.useState(""),[u,d]=m.useState(!1);m.useEffect(()=>{n||o("Invalid or expired reset link")},[n]);const p=async h=>{if(h.preventDefault(),o(""),c(""),d(!0),!n){o("Invalid or expired reset link"),d(!1);return}try{await oe("/api/auth/reset-password",{method:"POST",body:{token:n,password:r}}),c("Password reset successful. Redirecting to login..."),setTimeout(()=>t("/login"),2e3)}catch(f){o(f.message||"Reset link expired or invalid")}finally{d(!1)}};return s.jsx("div",{className:"auth-bg",children:s.jsxs("form",{className:"auth-card",onSubmit:p,children:[s.jsx("h1",{children:"Reset password"}),a&&s.jsx("div",{className:"auth-error",children:a}),l&&s.jsx("div",{className:"auth-info",children:l}),s.jsx(Uc,{label:"New password",value:r,onChange:h=>i(h.target.value),showStrength:!0,required:!0}),s.jsx("button",{disabled:u||!!a,children:u?"Resetting...":"Reset password"})]})})}function sA(){var p;const e=Oe(),t=Cn(),{complete2FA:n}=Me(),r=((p=t.state)==null?void 0:p.userId)||localStorage.getItem("2fa_user"),[i,a]=m.useState(""),[o,l]=m.useState(""),[c,u]=m.useState(!1);if(m.useEffect(()=>{r||e("/login",{replace:!0})},[r,e]),!r)return null;const d=async h=>{if(h.preventDefault(),i.length===6){l(""),u(!0);try{const f=await oe("/api/auth/2fa/verify",{method:"POST",body:{userId:r,otp:i}});n(f.accessToken,f.refreshToken),e("/",{replace:!0})}catch(f){l(f.message||"Verification failed")}finally{u(!1)}}};return s.jsxs("div",{className:"auth-card",children:[s.jsx("h2",{children:" Two-Factor Authentication"}),s.jsx("p",{children:"Enter the 6-digit code sent to your email"}),o&&s.jsx("p",{className:"error",children:o}),s.jsxs("form",{onSubmit:d,children:[s.jsx("input",{type:"text",inputMode:"numeric",maxLength:"6",placeholder:"123456",value:i,onChange:h=>a(h.target.value.replace(/\D/g,"")),required:!0}),s.jsx("button",{disabled:c||i.length!==6,children:c?"Verifying...":"Verify"})]}),s.jsx("style",{children:`
        .auth-card {
          max-width: 420px;
          margin: 80px auto;
          padding: 32px;
          border-radius: 16px;
          background: white;
          text-align: center;
          box-shadow: 0 10px 25px rgba(0,0,0,0.08);
        }
        input {
          width: 100%;
          padding: 14px;
          margin: 20px 0;
          font-size: 20px;
          text-align: center;
          letter-spacing: 8px;
          border-radius: 10px;
          border: 1px solid #ddd;
        }
        button {
          width: 100%;
          padding: 14px;
          background: #2563eb;
          color: white;
          border: none;
          border-radius: 10px;
          font-weight: 600;
          cursor: pointer;
        }
        button:disabled {
          opacity: 0.6;
          cursor: not-allowed;
        }
        .error {
          color: #dc2626;
          margin-top: 12px;
        }
      `})]})}function iA(){const e=Oe(),[t,n]=m.useState(null),[r,i]=m.useState(""),[a,o]=m.useState(!1),[l,c]=m.useState(!1),[u,d]=m.useState(""),[p,h]=m.useState(""),f=async()=>{try{const x=await oe("/api/auth/session-risk");n(x||null)}catch(x){n(null),h((x==null?void 0:x.message)||"Failed to load session risk")}};m.useEffect(()=>{f()},[]);const y=async()=>{c(!0),h(""),d("");try{await oe("/api/auth/step-up/request",{method:"POST"}),d("Step-up code sent. Check your email or phone.")}catch(x){h((x==null?void 0:x.message)||"Failed to request step-up code")}finally{c(!1)}},b=async x=>{x.preventDefault(),o(!0),h(""),d("");try{const w=await oe("/api/auth/step-up/verify",{method:"POST",body:{otp:r.trim()}});w!=null&&w.accessToken&&localStorage.setItem("token",w.accessToken),d("Session unlocked successfully."),setTimeout(()=>e(-1),600)}catch(w){w instanceof gj?h(w.message):h("Failed to verify step-up code")}finally{o(!1)}},E=(t==null?void 0:t.risk)||{},g=(t==null?void 0:t.restriction)||null;return s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"Session Security Check"}),s.jsx("p",{className:"muted",children:"Complete a step-up verification to continue sensitive actions."})]}),s.jsxs("div",{className:"welcome-actions",children:[s.jsx("button",{className:"btn-secondary",onClick:f,children:"Refresh Risk"}),s.jsx("button",{className:"btn-primary",onClick:y,disabled:l,children:l?"Sending...":"Send Step-up Code"})]})]}),s.jsx("section",{className:"section",children:s.jsxs("div",{className:"grid info-grid",children:[s.jsxs("div",{className:"card",children:[s.jsx("strong",{children:"Risk Level:"})," ",E.level||""]}),s.jsxs("div",{className:"card",children:[s.jsx("strong",{children:"Risk Score:"})," ",E.score??""]}),s.jsxs("div",{className:"card",children:[s.jsx("strong",{children:"Step-up Required:"})," ",t!=null&&t.requiresStepUp?"Yes":"No"]}),s.jsxs("div",{className:"card",children:[s.jsx("strong",{children:"Step-up Verified At:"})," ",(t==null?void 0:t.stepUpVerifiedAt)||"Not yet"]})]})}),g&&s.jsx("section",{className:"section",children:s.jsxs("div",{className:"card",children:[s.jsx("strong",{children:"Restriction Active"}),s.jsxs("div",{className:"muted",children:["Reason: ",g.reason||"RISK_RESTRICTION_ACTIVE"]}),s.jsxs("div",{className:"muted",children:["Until: ",g.until||"Auto-expiry pending"]})]})}),s.jsx("section",{className:"section",children:s.jsxs("form",{className:"card",onSubmit:b,children:[s.jsx("h3",{children:"Verify Step-up Code"}),s.jsx("input",{type:"text",value:r,onChange:x=>i(x.target.value),placeholder:"Enter 6-digit code",maxLength:8,required:!0}),s.jsx("div",{className:"welcome-actions",style:{marginTop:12},children:s.jsx("button",{className:"btn-primary",type:"submit",disabled:a,children:a?"Verifying...":"Verify & Unlock"})}),u&&s.jsx("p",{className:"auth-info",children:u}),p&&s.jsx("p",{className:"auth-error",children:p})]})})]})}function aA(){const e=Oe();return s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"AfyaLink Guest Portal"}),s.jsx("p",{className:"muted",children:"Public access for appointments, doctor directory, services and pre-registration."})]}),s.jsxs("div",{className:"welcome-actions",children:[s.jsx("button",{className:"btn-primary",onClick:()=>e("/register"),children:"Book Appointment"}),s.jsx("button",{className:"btn-secondary",onClick:()=>e("/login"),children:"Sign In"})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Guest Services"}),s.jsxs("div",{className:"panel-grid",children:[s.jsx("div",{className:"panel",children:"Search Doctor"}),s.jsx("div",{className:"panel",children:"Appointment Booking Form"}),s.jsx("div",{className:"panel",children:"Hospital Services"}),s.jsx("div",{className:"panel",children:"Contact & Support"}),s.jsx("div",{className:"panel",children:"Pre-Registration"})]})]})]})}const Il="verifyCooldownUntil";function oA(){const{user:e,canRoleOverride:t,roleOverride:n,setRoleOverride:r}=Me(),i=Oe(),[a,o]=m.useState(""),l=["SUPER_ADMIN","SYSTEM_ADMIN","HOSPITAL_ADMIN","DEVELOPER","DOCTOR","NURSE","LAB_TECH","PHARMACIST","RADIOLOGIST","THERAPIST","RECEPTIONIST","SECURITY_OFFICER","SECURITY_ADMIN","HR_MANAGER","PAYROLL_OFFICER","PATIENT","GUEST"],[c,u]=m.useState(!0),[d,p]=m.useState(""),[h,f]=m.useState(!1),[y,b]=m.useState(!0),[E,g]=m.useState(null),[x,w]=m.useState(!1),[_,S]=m.useState(""),[k,I]=m.useState(0),[C,L]=m.useState(""),[V,B]=m.useState(!1),[Y,W]=m.useState(""),[O,D]=m.useState(""),[Q,ae]=m.useState(!1),[U,Z]=m.useState(""),[le,ye]=m.useState(""),[je,Ae]=m.useState(!1),[H,F]=m.useState(""),[se,xe]=m.useState(""),[Ce,Pe]=m.useState(""),[Ge,X]=m.useState(!1),[he,ge]=m.useState(""),[me,Ne]=m.useState(!1),[dt,pt]=m.useState(""),[Te,we]=m.useState({gender:"",dateOfBirth:"",nationality:"",address:"",emergencyName:"",emergencyRelationship:"",emergencyPhone:""}),[ce,ve]=m.useState({employeeId:"",department:"",reportingManager:"",employmentType:"",hireDate:"",contractStart:"",contractEnd:"",workLocation:"",branch:""}),[fe,_e]=m.useState({specialization:"",subSpecialization:"",cmeCredits:"",researchPublications:"",testAuthorizationLevel:"",certifications:"",educationHistory:""}),[be,Ve]=m.useState({bankName:"",bankAccountName:"",bankAccountNumber:"",bankBranch:"",taxId:"",pensionInfo:"",salaryStructure:"",allowances:"",deductions:""}),[ke,tn]=m.useState({status:"ACTIVE",accessExpiresAt:""}),[fn,In]=m.useState(""),[Pt,pn]=m.useState(""),[Rn,mr]=m.useState(""),[gr,yr]=m.useState(!1),[vr,Fr]=m.useState(""),[mn,xr]=m.useState("");m.useEffect(()=>{Gt(),nn()},[]),m.useEffect(()=>{o(n||(e==null?void 0:e.actualRole)||(e==null?void 0:e.role)||"")},[n,e==null?void 0:e.actualRole,e==null?void 0:e.role]);const Gt=()=>{const z=Number(localStorage.getItem(Il));if(!z)return;const vt=Math.ceil((z-Date.now())/1e3);vt>0?I(vt):localStorage.removeItem(Il)};m.useEffect(()=>{if(k<=0)return;const z=setInterval(()=>{I(vt=>vt<=1?(localStorage.removeItem(Il),0):vt-1)},1e3);return()=>clearInterval(z)},[k]);const nn=async()=>{var z,vt,qr,yi,vi,xi,ji,bi,wi,Si,Ei,Ni,_i,Rs,Ts,Os,Ps,Ls,zr,Pn,Wr,gn,Ds,Kn,jr,Ms,Us,br,A,M;try{const v=await oe("/api/2fa/status");f(!!(v!=null&&v.enabled));const j=await oe("/api/profile");b(!!(j!=null&&j.emailVerified)),B(!!(j!=null&&j.phoneVerified)),L((j==null?void 0:j.phone)||""),Z((j==null?void 0:j.nationalIdNumber)||""),ye((j==null?void 0:j.nationalIdCountry)||""),xe((j==null?void 0:j.licenseNumber)||""),Pe(j!=null&&j.licenseExpiry?j.licenseExpiry.slice(0,10):""),g((j==null?void 0:j.verificationWarning)||null),we({gender:(j==null?void 0:j.gender)||"",dateOfBirth:j!=null&&j.dateOfBirth?j.dateOfBirth.slice(0,10):"",nationality:(j==null?void 0:j.nationality)||"",address:(j==null?void 0:j.address)||"",emergencyName:((z=j==null?void 0:j.emergencyContact)==null?void 0:z.name)||"",emergencyRelationship:((vt=j==null?void 0:j.emergencyContact)==null?void 0:vt.relationship)||"",emergencyPhone:((qr=j==null?void 0:j.emergencyContact)==null?void 0:qr.phone)||""}),ve({employeeId:((yi=j==null?void 0:j.employment)==null?void 0:yi.employeeId)||"",department:((vi=j==null?void 0:j.employment)==null?void 0:vi.department)||"",reportingManager:((xi=j==null?void 0:j.employment)==null?void 0:xi.reportingManager)||"",employmentType:((ji=j==null?void 0:j.employment)==null?void 0:ji.employmentType)||"",hireDate:(bi=j==null?void 0:j.employment)!=null&&bi.hireDate?j.employment.hireDate.slice(0,10):"",contractStart:(wi=j==null?void 0:j.employment)!=null&&wi.contractStart?j.employment.contractStart.slice(0,10):"",contractEnd:(Si=j==null?void 0:j.employment)!=null&&Si.contractEnd?j.employment.contractEnd.slice(0,10):"",workLocation:((Ei=j==null?void 0:j.employment)==null?void 0:Ei.workLocation)||"",branch:((Ni=j==null?void 0:j.employment)==null?void 0:Ni.branch)||""}),_e({specialization:((_i=j==null?void 0:j.credentials)==null?void 0:_i.specialization)||"",subSpecialization:((Rs=j==null?void 0:j.credentials)==null?void 0:Rs.subSpecialization)||"",cmeCredits:((Ts=j==null?void 0:j.credentials)==null?void 0:Ts.cmeCredits)??"",researchPublications:((Os=j==null?void 0:j.credentials)==null?void 0:Os.researchPublications)??"",testAuthorizationLevel:((Ps=j==null?void 0:j.credentials)==null?void 0:Ps.testAuthorizationLevel)||"",certifications:(((Ls=j==null?void 0:j.credentials)==null?void 0:Ls.certifications)||[]).join(", "),educationHistory:(((zr=j==null?void 0:j.credentials)==null?void 0:zr.educationHistory)||[]).join(", ")}),Ve({bankName:((Pn=j==null?void 0:j.financial)==null?void 0:Pn.bankName)||"",bankAccountName:((Wr=j==null?void 0:j.financial)==null?void 0:Wr.bankAccountName)||"",bankAccountNumber:((gn=j==null?void 0:j.financial)==null?void 0:gn.bankAccountNumber)||"",bankBranch:((Ds=j==null?void 0:j.financial)==null?void 0:Ds.bankBranch)||"",taxId:((Kn=j==null?void 0:j.financial)==null?void 0:Kn.taxId)||"",pensionInfo:((jr=j==null?void 0:j.financial)==null?void 0:jr.pensionInfo)||"",salaryStructure:((Ms=j==null?void 0:j.financial)==null?void 0:Ms.salaryStructure)||"",allowances:((Us=j==null?void 0:j.financial)==null?void 0:Us.allowances)??"",deductions:((br=j==null?void 0:j.financial)==null?void 0:br.deductions)??""}),tn({status:((A=j==null?void 0:j.systemProfile)==null?void 0:A.status)||"ACTIVE",accessExpiresAt:(M=j==null?void 0:j.systemProfile)!=null&&M.accessExpiresAt?j.systemProfile.accessExpiresAt.slice(0,10):""})}catch{p("Unable to load security settings")}finally{u(!1)}},gi=async()=>{Ne(!0),pt("");try{await oe("/api/profile",{method:"PUT",body:{gender:Te.gender||void 0,dateOfBirth:Te.dateOfBirth||void 0,nationality:Te.nationality||void 0,address:Te.address||void 0,emergencyContact:{name:Te.emergencyName||void 0,relationship:Te.emergencyRelationship||void 0,phone:Te.emergencyPhone||void 0},employment:{employeeId:ce.employeeId||void 0,department:ce.department||void 0,reportingManager:ce.reportingManager||void 0,employmentType:ce.employmentType||void 0,hireDate:ce.hireDate||void 0,contractStart:ce.contractStart||void 0,contractEnd:ce.contractEnd||void 0,workLocation:ce.workLocation||void 0,branch:ce.branch||void 0},credentials:{specialization:fe.specialization||void 0,subSpecialization:fe.subSpecialization||void 0,cmeCredits:fe.cmeCredits===""?void 0:Number(fe.cmeCredits),researchPublications:fe.researchPublications===""?void 0:Number(fe.researchPublications),testAuthorizationLevel:fe.testAuthorizationLevel||void 0,certifications:fe.certifications?fe.certifications.split(",").map(z=>z.trim()).filter(Boolean):[],educationHistory:fe.educationHistory?fe.educationHistory.split(",").map(z=>z.trim()).filter(Boolean):[]},financial:{bankName:be.bankName||void 0,bankAccountName:be.bankAccountName||void 0,bankAccountNumber:be.bankAccountNumber||void 0,bankBranch:be.bankBranch||void 0,taxId:be.taxId||void 0,pensionInfo:be.pensionInfo||void 0,salaryStructure:be.salaryStructure||void 0,allowances:be.allowances===""?void 0:Number(be.allowances),deductions:be.deductions===""?void 0:Number(be.deductions)},systemProfile:{status:ke.status||void 0,accessExpiresAt:ke.accessExpiresAt||void 0}}}),pt("Profile details updated.")}catch(z){pt(z.message||"Failed to update profile details")}finally{Ne(!1)}},Tn=async()=>{try{const z=!h;await oe("/api/2fa/toggle",{method:"POST",body:{enabled:z}}),f(z)}catch{p("Failed to update 2FA setting")}},Oa=async()=>{try{w(!0),S("");const z=await oe("/api/auth/resend-verification",{method:"POST",body:{email:e==null?void 0:e.email}}),vt=(z==null?void 0:z.retryAfter)||60;localStorage.setItem(Il,Date.now()+vt*1e3),I(vt),S(" Verification email sent. Check your inbox.")}catch{S(" Failed to send verification email")}finally{w(!1)}},Nt=()=>{if(y||V||!E)return null;const z={"14d":"Your profile will be deleted in 14 days.","3d":"Your profile will be deleted in 3 days.","2h":"Your profile will be deleted in 2 hours.",EXPIRED:"Your account has expired and will be deleted."};return s.jsxs("div",{className:"card warning-card",children:[s.jsx("h3",{children:" Verification Required"}),s.jsx("p",{children:z[E.type]}),E.type!=="EXPIRED"&&(e==null?void 0:e.email)&&s.jsx("button",{className:"primary",disabled:x||k>0,onClick:Oa,children:x?"Sending...":k>0?`Resend in ${k}s`:"Verify Account"}),_&&s.jsx("p",{style:{marginTop:8},children:_})]})},On=async()=>{Ae(!0),F("");try{await oe("/api/profile",{method:"PUT",body:{nationalIdNumber:U||void 0,nationalIdCountry:le||void 0}}),F("National ID updated")}catch(z){F(z.message||"Failed to update National ID")}finally{Ae(!1)}},wt=async()=>{X(!0),ge("");try{await oe("/api/profile",{method:"PUT",body:{licenseNumber:se||void 0,licenseExpiry:Ce||void 0}}),ge("License updated")}catch(z){ge(z.message||"Failed to update license")}finally{X(!1)}},ks=async()=>{ae(!0),D("");try{await oe("/api/auth/phone/request-otp",{method:"POST",body:{phone:C.trim()}}),B(!1),D("OTP sent to your phone.")}catch(z){D(z.message||"Failed to send OTP")}finally{ae(!1)}},Is=async()=>{ae(!0),D("");try{await oe("/api/auth/phone/verify",{method:"POST",body:{otp:Y.trim()}}),B(!0),W(""),D("Phone verified successfully.")}catch(z){D(z.message||"Invalid OTP")}finally{ae(!1)}},Pa=async z=>{if(z.preventDefault(),Fr(""),xr(""),Pt!==Rn){xr("Passwords do not match");return}yr(!0);try{const vt=await oe("/api/auth/change-password",{method:"POST",body:{currentPassword:fn,newPassword:Pt}});Fr("Password changed successfully"),In(""),pn(""),mr("")}catch(vt){xr(vt.message||"Password change failed")}finally{yr(!1)}},Hr={SUPER_ADMIN:["System configuration and permission matrix ownership","API key management and integration governance","Global audit and backup oversight"],SYSTEM_ADMIN:["Server operations and error diagnostics","Database and feature-toggle control","Integration reliability monitoring"],HOSPITAL_ADMIN:["Department and staffing operations","Shift, leave and approval oversight","Budget and branch execution control"],SECURITY_ADMIN:["Incident escalation and clearance governance","Visitor and surveillance compliance management","Emergency response coordination"],SECURITY_OFFICER:["Shift assignment and gate operations","Visitor verification and QR scanning","Incident reporting execution"],HR_MANAGER:["Recruitment and onboarding workflows","Performance and disciplinary tracking","Training and succession planning"],PAYROLL_OFFICER:["Payroll processing and payslip generation","Tax, pension, deductions and audit trail","Overtime and shift differential reconciliation"],DEVELOPER:["API logs, webhook diagnostics and feature flags","Performance tracing and release validation","Integration and automation reliability"],DOCTOR:["Medical license and specialization details","Clinical schedule and patient workload context","CME credits and publications tracking"],NURSE:["Ward/department assignment and shift readiness","Clinical workload and overtime visibility","Incident and quality reporting continuity"],LAB_TECH:["Test authorization level and assignment scope","Lab workflow accountability and compliance","Safety and equipment audit readiness"],PHARMACIST:["License and controlled-drug accountability","Inventory and dispensing governance","Expiry and interaction safety controls"],PATIENT:["Verified identity and emergency contact","Clinical and billing communication readiness","Secure self-service profile completeness"],GUEST:["Pre-registration and contact readiness","Limited-access appointment flow data","Upgrade eligibility details"],RADIOLOGIST:["Imaging authorization and reporting scope","Diagnostic workflow credential completeness","PACS and compliance readiness"],THERAPIST:["Treatment plan and session documentation profile","Progress tracking role context","Department and scheduling completeness"],RECEPTIONIST:["Patient intake and scheduling role context","Queue and billing initiation responsibility","Front-desk operational readiness"]};return c?s.jsx("p",{children:"Loading..."}):s.jsxs("div",{className:"profile-container",children:[t&&s.jsxs("div",{className:"card",children:[s.jsx("h3",{children:"Role View Switcher"}),s.jsxs("p",{children:["Use this to switch and test full permissions as different account types. Your actual account stays ",s.jsx("strong",{children:(e==null?void 0:e.actualRole)||(e==null?void 0:e.role)}),"."]}),s.jsxs("div",{className:"profile-row",children:[s.jsx("select",{value:a,onChange:z=>o(z.target.value),children:l.map(z=>s.jsx("option",{value:z,children:z},z))}),s.jsx("button",{className:"primary",onClick:()=>{r(a),i(Ss({role:a}))},children:"Switch Role View"}),s.jsx("button",{className:"secondary",onClick:()=>{const z=(e==null?void 0:e.actualRole)||(e==null?void 0:e.role);r(""),o(z),i(Ss({role:z}))},children:"Reset to My Role"})]})]}),Nt(),s.jsxs("div",{className:"card",children:[s.jsx("h3",{children:"Verification Status"}),s.jsxs("div",{className:"grid",children:[s.jsxs("div",{children:[s.jsx("strong",{children:"Email:"})," ",y?"Verified":"Not verified"]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Phone:"})," ",V?"Verified":"Not verified"]})]})]}),s.jsxs("div",{className:"card",children:[s.jsx("h3",{children:"Phone & National ID"}),s.jsx("p",{children:V?"Your phone number is verified.":"Verify your phone number to keep your account active."}),s.jsx("label",{children:"Phone number"}),s.jsx("input",{value:C,onChange:z=>L(z.target.value),placeholder:"+1 555 123 4567"}),s.jsxs("div",{className:"profile-row",children:[s.jsx("button",{className:"primary",onClick:ks,disabled:Q||!C.trim(),children:Q?"Sending...":"Send OTP"}),s.jsx("input",{value:Y,onChange:z=>W(z.target.value),placeholder:"Enter OTP",style:{maxWidth:180}}),s.jsx("button",{className:"success",onClick:Is,disabled:Q||!Y.trim(),children:Q?"Verifying...":"Verify"})]}),O&&s.jsx("p",{style:{marginTop:8},children:O}),s.jsx("hr",{style:{margin:"18px 0"}}),s.jsx("label",{children:"National ID Number"}),s.jsx("input",{value:U,onChange:z=>Z(z.target.value)}),s.jsx("label",{children:"National ID Country"}),s.jsx("input",{value:le,onChange:z=>ye(z.target.value),placeholder:"e.g. KE, US, NG"}),s.jsx("button",{className:"primary",onClick:On,disabled:je,style:{marginTop:8},children:je?"Saving...":"Save National ID"}),H&&s.jsx("p",{style:{marginTop:8},children:H}),s.jsx("hr",{style:{margin:"18px 0"}}),s.jsx("label",{children:"Professional License Number"}),s.jsx("input",{value:se,onChange:z=>xe(z.target.value),placeholder:"e.g. KMPDC-123456"}),s.jsx("label",{children:"License Expiry Date"}),s.jsx("input",{type:"date",value:Ce,onChange:z=>Pe(z.target.value)}),s.jsx("button",{className:"primary",onClick:wt,disabled:Ge,style:{marginTop:8},children:Ge?"Saving...":"Save License"}),he&&s.jsx("p",{style:{marginTop:8},children:he})]}),s.jsxs("div",{className:"card",children:[s.jsx("h3",{children:"Basic Information"}),s.jsx("label",{children:"Gender"}),s.jsxs("select",{value:Te.gender,onChange:z=>we({...Te,gender:z.target.value}),children:[s.jsx("option",{value:"",children:"Select"}),s.jsx("option",{value:"MALE",children:"Male"}),s.jsx("option",{value:"FEMALE",children:"Female"}),s.jsx("option",{value:"OTHER",children:"Other"}),s.jsx("option",{value:"PREFER_NOT_TO_SAY",children:"Prefer not to say"})]}),s.jsx("label",{children:"Date of Birth"}),s.jsx("input",{type:"date",value:Te.dateOfBirth,onChange:z=>we({...Te,dateOfBirth:z.target.value})}),s.jsx("label",{children:"Nationality"}),s.jsx("input",{value:Te.nationality,onChange:z=>we({...Te,nationality:z.target.value})}),s.jsx("label",{children:"Address"}),s.jsx("input",{value:Te.address,onChange:z=>we({...Te,address:z.target.value})}),s.jsx("label",{children:"Emergency Contact Name"}),s.jsx("input",{value:Te.emergencyName,onChange:z=>we({...Te,emergencyName:z.target.value})}),s.jsx("label",{children:"Emergency Contact Relationship"}),s.jsx("input",{value:Te.emergencyRelationship,onChange:z=>we({...Te,emergencyRelationship:z.target.value})}),s.jsx("label",{children:"Emergency Contact Phone"}),s.jsx("input",{value:Te.emergencyPhone,onChange:z=>we({...Te,emergencyPhone:z.target.value})})]}),s.jsxs("div",{className:"card",children:[s.jsx("h3",{children:"Employment Information"}),s.jsx("label",{children:"Employee ID"}),s.jsx("input",{value:ce.employeeId,onChange:z=>ve({...ce,employeeId:z.target.value})}),s.jsx("label",{children:"Department"}),s.jsx("input",{value:ce.department,onChange:z=>ve({...ce,department:z.target.value})}),s.jsx("label",{children:"Reporting Manager"}),s.jsx("input",{value:ce.reportingManager,onChange:z=>ve({...ce,reportingManager:z.target.value})}),s.jsx("label",{children:"Employment Type"}),s.jsxs("select",{value:ce.employmentType,onChange:z=>ve({...ce,employmentType:z.target.value}),children:[s.jsx("option",{value:"",children:"Select"}),s.jsx("option",{value:"FULL_TIME",children:"Full-time"}),s.jsx("option",{value:"LOCUM",children:"Locum"}),s.jsx("option",{value:"CONTRACT",children:"Contract"}),s.jsx("option",{value:"PART_TIME",children:"Part-time"}),s.jsx("option",{value:"INTERN",children:"Intern"})]}),s.jsx("label",{children:"Hire Date"}),s.jsx("input",{type:"date",value:ce.hireDate,onChange:z=>ve({...ce,hireDate:z.target.value})}),s.jsx("label",{children:"Contract Start"}),s.jsx("input",{type:"date",value:ce.contractStart,onChange:z=>ve({...ce,contractStart:z.target.value})}),s.jsx("label",{children:"Contract End"}),s.jsx("input",{type:"date",value:ce.contractEnd,onChange:z=>ve({...ce,contractEnd:z.target.value})}),s.jsx("label",{children:"Work Location"}),s.jsx("input",{value:ce.workLocation,onChange:z=>ve({...ce,workLocation:z.target.value})}),s.jsx("label",{children:"Branch"}),s.jsx("input",{value:ce.branch,onChange:z=>ve({...ce,branch:z.target.value})})]}),s.jsxs("div",{className:"card",children:[s.jsx("h3",{children:"Credentials & Professional Data"}),s.jsx("label",{children:"Specialization"}),s.jsx("input",{value:fe.specialization,onChange:z=>_e({...fe,specialization:z.target.value})}),s.jsx("label",{children:"Sub-specialization"}),s.jsx("input",{value:fe.subSpecialization,onChange:z=>_e({...fe,subSpecialization:z.target.value})}),s.jsx("label",{children:"Certifications (comma-separated)"}),s.jsx("input",{value:fe.certifications,onChange:z=>_e({...fe,certifications:z.target.value})}),s.jsx("label",{children:"Education History (comma-separated)"}),s.jsx("input",{value:fe.educationHistory,onChange:z=>_e({...fe,educationHistory:z.target.value})}),s.jsx("label",{children:"CME Credits"}),s.jsx("input",{type:"number",value:fe.cmeCredits,onChange:z=>_e({...fe,cmeCredits:z.target.value})}),s.jsx("label",{children:"Research Publications"}),s.jsx("input",{type:"number",value:fe.researchPublications,onChange:z=>_e({...fe,researchPublications:z.target.value})}),s.jsx("label",{children:"Test Authorization Level"}),s.jsx("input",{value:fe.testAuthorizationLevel,onChange:z=>_e({...fe,testAuthorizationLevel:z.target.value})})]}),s.jsxs("div",{className:"card",children:[s.jsx("h3",{children:"Financial Information"}),s.jsx("label",{children:"Bank Name"}),s.jsx("input",{value:be.bankName,onChange:z=>Ve({...be,bankName:z.target.value})}),s.jsx("label",{children:"Bank Account Name"}),s.jsx("input",{value:be.bankAccountName,onChange:z=>Ve({...be,bankAccountName:z.target.value})}),s.jsx("label",{children:"Bank Account Number"}),s.jsx("input",{value:be.bankAccountNumber,onChange:z=>Ve({...be,bankAccountNumber:z.target.value})}),s.jsx("label",{children:"Bank Branch"}),s.jsx("input",{value:be.bankBranch,onChange:z=>Ve({...be,bankBranch:z.target.value})}),s.jsx("label",{children:"Tax ID"}),s.jsx("input",{value:be.taxId,onChange:z=>Ve({...be,taxId:z.target.value})}),s.jsx("label",{children:"Pension Info"}),s.jsx("input",{value:be.pensionInfo,onChange:z=>Ve({...be,pensionInfo:z.target.value})}),s.jsx("label",{children:"Salary Structure"}),s.jsx("input",{value:be.salaryStructure,onChange:z=>Ve({...be,salaryStructure:z.target.value})}),s.jsx("label",{children:"Allowances"}),s.jsx("input",{type:"number",value:be.allowances,onChange:z=>Ve({...be,allowances:z.target.value})}),s.jsx("label",{children:"Deductions"}),s.jsx("input",{type:"number",value:be.deductions,onChange:z=>Ve({...be,deductions:z.target.value})})]}),s.jsxs("div",{className:"card",children:[s.jsx("h3",{children:"System Data"}),s.jsx("label",{children:"Status"}),s.jsxs("select",{value:ke.status,onChange:z=>tn({...ke,status:z.target.value}),children:[s.jsx("option",{value:"ACTIVE",children:"Active"}),s.jsx("option",{value:"SUSPENDED",children:"Suspended"}),s.jsx("option",{value:"ON_LEAVE",children:"On Leave"})]}),s.jsx("label",{children:"Access Expiration"}),s.jsx("input",{type:"date",value:ke.accessExpiresAt,onChange:z=>tn({...ke,accessExpiresAt:z.target.value})}),s.jsx("button",{className:"primary",onClick:gi,disabled:me,style:{marginTop:8},children:me?"Saving...":"Save Full Profile"}),dt&&s.jsx("p",{style:{marginTop:8},children:dt})]}),s.jsxs("div",{className:"card",children:[s.jsxs("h3",{children:["Role-Specific Profile Checklist (",e==null?void 0:e.role,")"]}),s.jsx("ul",{children:(Hr[e==null?void 0:e.role]||Hr.GUEST).map(z=>s.jsx("li",{children:z},z))})]}),s.jsxs("div",{className:"card",children:[s.jsx("h3",{children:"Two-Factor Authentication (2FA)"}),s.jsx("p",{children:h?"2FA is enabled. Youll be asked for a code at login.":"2FA is disabled. Your account uses password only."}),s.jsx("button",{className:h?"danger":"success",onClick:Tn,children:h?"Disable 2FA":"Enable 2FA"})]}),s.jsxs("div",{className:"card",style:{marginTop:24},children:[s.jsx("h3",{children:"Change Password"}),mn&&s.jsx("div",{className:"auth-error",children:mn}),vr&&s.jsx("div",{className:"auth-success",children:vr}),s.jsxs("form",{onSubmit:Pa,children:[s.jsx("label",{children:"Current password"}),s.jsx("input",{type:"password",value:fn,onChange:z=>In(z.target.value),required:!0}),s.jsx("label",{children:"New password"}),s.jsx("input",{type:"password",value:Pt,onChange:z=>pn(z.target.value),required:!0}),s.jsx("label",{children:"Confirm new password"}),s.jsx("input",{type:"password",value:Rn,onChange:z=>mr(z.target.value),required:!0}),s.jsx("button",{disabled:gr,style:{marginTop:8},children:gr?"Updating...":"Change password"})]})]}),d&&s.jsx("p",{style:{color:"red",marginTop:16},children:d})]})}const lA=()=>oe("/api/analytics/revenue/daily"),cA=()=>oe("/api/analytics/doctors/utilization"),uA=()=>oe("/api/analytics/pharmacy/profit");function dA(){const[e,t]=m.useState([]),[n,r]=m.useState([]),[i,a]=m.useState([]),[o,l]=m.useState("");m.useEffect(()=>{Promise.all([lA(),cA(),uA()]).then(([h,f,y])=>{t(Array.isArray(h)?h:[]),r(Array.isArray(f)?f:[]),a(Array.isArray(y)?y:[])}).catch(()=>l("Failed to load analytics"))},[]);const c=m.useMemo(()=>e.reduce((h,f)=>h+(f.total||0),0),[e]),u=m.useMemo(()=>Math.max(1,...e.map(h=>h.total||0)),[e]),d=m.useMemo(()=>Math.max(1,...n.map(h=>h.count||0)),[n]),p=m.useMemo(()=>Math.max(1,...i.map(h=>h.profit||0)),[i]);return s.jsxs("div",{className:"dashboard",children:[s.jsx("div",{className:"welcome-panel",children:s.jsxs("div",{children:[s.jsx("h2",{children:"Analytics"}),s.jsx("p",{className:"muted",children:"Live metrics and operational insights."})]})}),o&&s.jsx("div",{className:"card",children:o}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Revenue (Last 30 Days)"}),s.jsxs("div",{className:"grid info-grid",children:[s.jsxs("div",{className:"card",children:[s.jsx("div",{className:"card-title",children:"Total Revenue"}),s.jsxs("div",{className:"card-value",children:["KES ",c.toLocaleString()]})]}),s.jsxs("div",{className:"card",children:[s.jsx("div",{className:"card-title",children:"Days Tracked"}),s.jsx("div",{className:"card-value",children:e.length})]})]}),s.jsx("div",{className:"card chart-card",children:e.length===0?s.jsx("div",{className:"muted",children:"No revenue data yet."}):s.jsx("div",{className:"simple-chart",children:e.slice(-14).map(h=>{var f;return s.jsxs("div",{className:"bar-row",children:[s.jsx("span",{className:"bar-label",children:h._id}),s.jsx("div",{className:"bar-track",children:s.jsx("div",{className:"bar-fill",style:{width:`${h.total/u*100}%`}})}),s.jsxs("span",{className:"bar-value",children:["KES ",(f=h.total)==null?void 0:f.toLocaleString()]})]},h._id)})})})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Doctor Utilization (Top 10)"}),s.jsx("div",{className:"card chart-card",children:n.length===0?s.jsx("div",{className:"muted",children:"No utilization data yet."}):s.jsx("div",{className:"simple-chart",children:n.slice(0,10).map((h,f)=>{var y;return s.jsxs("div",{className:"bar-row",children:[s.jsx("span",{className:"bar-label",children:(((y=h.doctor)==null?void 0:y.name)||"Doctor").split(" ")[0]}),s.jsx("div",{className:"bar-track",children:s.jsx("div",{className:"bar-fill blue",style:{width:`${h.count/d*100}%`}})}),s.jsx("span",{className:"bar-value",children:h.count})]},h._id||f)})})})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Pharmacy Profit (Top Items)"}),s.jsx("div",{className:"card chart-card",children:i.length===0?s.jsx("div",{className:"muted",children:"No pharmacy profit data yet."}):s.jsx("div",{className:"simple-chart",children:i.slice(0,10).map((h,f)=>{var y;return s.jsxs("div",{className:"bar-row",children:[s.jsx("span",{className:"bar-label",children:h._id||"Item"}),s.jsx("div",{className:"bar-track",children:s.jsx("div",{className:"bar-fill green",style:{width:`${h.profit/p*100}%`}})}),s.jsxs("span",{className:"bar-value",children:["KES ",(y=h.profit)==null?void 0:y.toLocaleString()]})]},h._id||f)})})})]})]})}const Fj=(e={})=>{const t=new URLSearchParams;e.limit&&t.set("limit",String(e.limit)),e.cursor!==void 0&&e.cursor!==null&&t.set("cursor",e.cursor),e.cursorMode&&t.set("cursorMode","1");const n=t.toString();return n?`?${n}`:""},Ng=(e={})=>oe(`/api/reports${Fj(e)}`),_g=(e={})=>oe(`/api/reports/mine${Fj(e)}`),hA=e=>oe("/api/reports",{method:"POST",body:e}),fA=e=>oe(`/api/reports/${e}`,{method:"DELETE"});function pA(){const{user:e}=Me(),t=(e==null?void 0:e.role)||"",n=["SUPER_ADMIN","SYSTEM_ADMIN","HOSPITAL_ADMIN"].includes(t),r=["DOCTOR"].includes(t),i=["DOCTOR","PATIENT"].includes(t),[a,o]=m.useState([]),[l,c]=m.useState([]),[u,d]=m.useState(null),[p,h]=m.useState(null),[f,y]=m.useState(!1),[b,E]=m.useState(!1),[g,x]=m.useState(!1),[w,_]=m.useState(n?"all":"mine"),[S,k]=m.useState(""),[I,C]=m.useState({title:"",content:"",patient:""});m.useEffect(()=>{n&&Ng({cursorMode:!0,limit:25}).then(O=>{const D=Array.isArray(O)?O:Array.isArray(O==null?void 0:O.items)?O.items:[];o(D),d((O==null?void 0:O.nextCursor)||null),y(!!(O!=null&&O.hasMore))}).catch(()=>{o([]),d(null),y(!1)}),i&&_g({cursorMode:!0,limit:25}).then(O=>{const D=Array.isArray(O)?O:Array.isArray(O==null?void 0:O.items)?O.items:[];c(D),h((O==null?void 0:O.nextCursor)||null),E(!!(O!=null&&O.hasMore))}).catch(()=>{c([]),h(null),E(!1)})},[n,i]);const L=m.useMemo(()=>w==="all"?a:l,[w,a,l]),V=w==="all"?f:b,B=async()=>{if(k(""),!I.title||!I.content){k("Title and content are required.");return}try{const O={title:I.title,content:I.content,...I.patient?{patient:I.patient}:{}},D=await hA(O);C({title:"",content:"",patient:""}),c(Q=>[D,...Q])}catch(O){k(O.message||"Failed to create report")}},Y=async O=>{try{await fA(O),o(D=>D.filter(Q=>Q._id!==O)),c(D=>D.filter(Q=>Q._id!==O))}catch(D){k(D.message||"Failed to delete report")}},W=async()=>{x(!0),k("");try{if(w==="all"){const O=await Ng({cursorMode:!0,limit:25,cursor:u}),D=Array.isArray(O==null?void 0:O.items)?O.items:[];o(Q=>[...Q,...D]),d((O==null?void 0:O.nextCursor)||null),y(!!(O!=null&&O.hasMore))}else{const O=await _g({cursorMode:!0,limit:25,cursor:p}),D=Array.isArray(O==null?void 0:O.items)?O.items:[];c(Q=>[...Q,...D]),h((O==null?void 0:O.nextCursor)||null),E(!!(O!=null&&O.hasMore))}}catch(O){k(O.message||"Failed to load more reports")}finally{x(!1)}};return s.jsxs("div",{className:"dashboard",children:[s.jsx("div",{className:"welcome-panel",children:s.jsxs("div",{children:[s.jsx("h2",{children:"Reports"}),s.jsx("p",{className:"muted",children:"Clinical and operational reporting."})]})}),S&&s.jsx("div",{className:"card",children:S}),s.jsx("section",{className:"section",children:s.jsxs("div",{className:"action-list",children:[n&&s.jsx("button",{className:`action-pill ${w==="all"?"active":""}`,onClick:()=>_("all"),children:"All Reports"}),i&&s.jsx("button",{className:`action-pill ${w==="mine"?"active":""}`,onClick:()=>_("mine"),children:"My Reports"})]})}),r&&s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Create Report"}),s.jsxs("div",{className:"card form",children:[s.jsx("label",{children:"Title"}),s.jsx("input",{value:I.title,onChange:O=>C(D=>({...D,title:O.target.value}))}),s.jsx("label",{children:"Patient ID (optional)"}),s.jsx("input",{value:I.patient,onChange:O=>C(D=>({...D,patient:O.target.value}))}),s.jsx("label",{children:"Content"}),s.jsx("textarea",{rows:5,value:I.content,onChange:O=>C(D=>({...D,content:O.target.value}))}),s.jsx("button",{className:"btn-primary",onClick:B,children:"Create Report"})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:w==="all"?"All Reports":"My Reports"}),s.jsxs("div",{className:"card",children:[L.length===0?s.jsx("div",{className:"muted",children:"No reports found."}):s.jsx("div",{className:"report-list",children:L.map(O=>s.jsxs("div",{className:"report-item",children:[s.jsxs("div",{children:[s.jsx("div",{className:"report-title",children:O.title||"Untitled"}),s.jsx("div",{className:"muted",children:O.createdAt?new Date(O.createdAt).toLocaleString():""}),O.content&&s.jsx("div",{className:"report-content",children:String(O.content).slice(0,200)})]}),n&&s.jsx("button",{className:"btn-secondary",onClick:()=>Y(O._id),children:"Delete"})]},O._id))}),V&&s.jsx("div",{style:{marginTop:12},children:s.jsx("button",{className:"btn-secondary",disabled:g,onClick:W,children:g?"Loading...":"Load more"})})]})]})]})}async function mA({q:e,page:t=1,limit:n=25}={}){const r=new URLSearchParams({q:e,page:t,limit:n}).toString();return oe(`/api/inventory/list?${r}`)}function gA(){const[e,t]=m.useState([]),[n,r]=m.useState(""),[i,a]=m.useState(1),[o,l]=m.useState(0),[c,u]=m.useState(!1),[d,p]=m.useState("");m.useEffect(()=>{let f=!0;return u(!0),p(""),mA({q:n,page:i,limit:25}).then(y=>{f&&(t(y.items||[]),l(y.total||0))}).catch(()=>{f&&p("Failed to load inventory.")}).finally(()=>{f&&u(!1)}),()=>{f=!1}},[n,i]);const h=Math.max(1,Math.ceil(o/25));return s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"Inventory"}),s.jsx("p",{className:"muted",children:"Track stock levels across pharmacy items. Use search to filter."})]}),s.jsx("div",{className:"welcome-actions",children:s.jsx("input",{className:"input",placeholder:"Search inventory",value:n,onChange:f=>{a(1),r(f.target.value)}})})]}),d&&s.jsx("div",{className:"card",children:d}),s.jsx("div",{className:"card",children:c?s.jsx("div",{className:"muted",children:"Loading inventory..."}):s.jsxs("table",{className:"table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Item"}),s.jsx("th",{children:"SKU"}),s.jsx("th",{children:"Unit"}),s.jsx("th",{children:"Total Qty"}),s.jsx("th",{children:"Min Stock"})]})}),s.jsxs("tbody",{children:[e.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:"5",className:"muted",children:"No inventory items yet."})}),e.map(f=>s.jsxs("tr",{children:[s.jsx("td",{children:f.name}),s.jsx("td",{children:f.sku||""}),s.jsx("td",{children:f.unit||""}),s.jsx("td",{children:f.totalQuantity??0}),s.jsx("td",{children:f.minStock??0})]},f._id))]})]})}),s.jsxs("div",{className:"table-footer",children:[s.jsx("button",{className:"btn-secondary",disabled:i<=1,onClick:()=>a(f=>Math.max(1,f-1)),children:"Prev"}),s.jsxs("span",{className:"muted",children:["Page ",i," of ",h]}),s.jsx("button",{className:"btn-secondary",disabled:i>=h,onClick:()=>a(f=>Math.min(h,f+1)),children:"Next"})]})]})}const yA={CREATED:"#64748b",INSURANCE_PENDING:"#f59e0b",INSURANCE_APPROVED:"#16a34a",INSURANCE_REJECTED:"#dc2626",TRIAGE_PENDING:"#0ea5e9",CONSULTATION:"#0ea5e9",LAB_PENDING:"#8b5cf6",LAB_COMPLETED:"#22c55e",PRESCRIPTION_READY:"#3b82f6",PHARMACY_PENDING:"#3b82f6",DISPENSED:"#16a34a",PAYMENT_PENDING:"#f97316",PAID:"#22c55e",COMPLETED:"#15803d",CANCELLED:"#6b7280"};function ic({state:e}){if(!e)return null;const t=yA[e]||"#334155";return s.jsx("span",{style:{background:t,color:"white",padding:"4px 10px",borderRadius:999,fontSize:12,fontWeight:600,textTransform:"uppercase",letterSpacing:.4},children:e.replace(/_/g," ")})}function vA({sla:e}){if(!e)return null;const t=Math.floor(e.elapsedMs/6e4),n=e.breached;return s.jsxs("div",{style:{padding:"6px 10px",borderRadius:8,background:n?"#fee2e2":"#ecfeff",color:n?"#b91c1c":"#0369a1",fontSize:13,fontWeight:600,marginBottom:6},children:[" ",e.name,": ",t," min",n&&"  SLA BREACHED"]})}function xA({encounterId:e}){var d;const[t,n]=m.useState(null),[r,i]=m.useState(!0),[a,o]=m.useState("");m.useEffect(()=>{e&&l()},[e]);async function l(){i(!0),o("");try{const p=await oe(`/api/workflows/${e}/timeline`);n(p)}catch(p){o(p.message||"Failed to load workflow timeline")}finally{i(!1)}}if(!e)return null;if(r)return s.jsx("div",{className:"card",children:"Loading workflow"});if(a)return s.jsx("div",{className:"card",style:{color:"red"},children:a});const{workflow:c,audit:u}=t;return s.jsxs("div",{className:"card premium-card",children:[s.jsx("h3",{style:{marginBottom:12},children:"Workflow Timeline"}),s.jsxs("div",{style:{marginBottom:16},children:[s.jsx("strong",{children:"Current State:"})," ",s.jsx(ic,{state:c.state})]}),s.jsxs("div",{style:{marginBottom:20},children:[s.jsx("strong",{children:"Allowed Actions:"}),s.jsx("div",{style:{marginTop:8},children:c.allowedTransitions.length===0?s.jsx("em",{style:{opacity:.7},children:"No actions allowed"}):c.allowedTransitions.map(p=>s.jsx(ic,{state:p},p))})]}),((d=t.sla)==null?void 0:d.length)>0&&s.jsxs(s.Fragment,{children:[s.jsx("h4",{children:"SLA Timers"}),t.sla.map(p=>s.jsx(vA,{sla:p},p.name))]}),s.jsx("h4",{children:"Workflow History"}),c.history.length===0?s.jsx("em",{children:"No workflow transitions recorded."}):s.jsx("ul",{className:"timeline",children:c.history.map((p,h)=>s.jsxs("li",{className:"timeline-item",style:{marginBottom:12},children:[s.jsx(ic,{state:p.state}),s.jsx("div",{style:{fontSize:13,opacity:.8},children:new Date(p.at).toLocaleString()}),s.jsxs("div",{style:{fontSize:13},children:["By: ",p.by||"system"]})]},h))}),(u==null?void 0:u.length)>0&&s.jsxs(s.Fragment,{children:[s.jsx("h4",{style:{marginTop:24},children:"Audit Trail"}),s.jsx("ul",{className:"timeline audit",children:u.map(p=>s.jsxs("li",{className:"timeline-item",style:{marginBottom:12},children:[s.jsx("strong",{children:p.action}),s.jsx("div",{style:{fontSize:13,opacity:.8},children:new Date(p.at).toLocaleString()}),s.jsxs("div",{style:{fontSize:13},children:["Role: ",p.actorRole]})]},p.id))})]})]})}function jA(){const{user:e}=Me(),[t,n]=m.useState([]),[r,i]=m.useState(!1),[a,o]=m.useState("");m.useEffect(()=>{e&&l()},[e]);async function l(){try{const d=await oe("/api/billing/list");n(d||[])}catch{o("Failed to load transactions")}}async function c(d){var h,f,y;if(!((f=(h=d.workflow)==null?void 0:h.allowedTransitions)==null?void 0:f.includes("PAID"))){o("Payment not allowed at this stage");return}i(!0),o("");try{const b=await oe("/api/payments/stripe/create-intent",{method:"POST",body:{amount:d.amount,transactionId:d._id}});o(`Stripe Payment Intent created.
Client Secret:
`+(((y=b==null?void 0:b.data)==null?void 0:y.clientSecret)||(b==null?void 0:b.clientSecret)||""))}catch(b){o(b.message)}finally{i(!1)}}async function u(d){var h,f;if(!((f=(h=d.workflow)==null?void 0:h.allowedTransitions)==null?void 0:f.includes("PAID"))){o("Payment not allowed at this stage");return}if(!d.phone){o("Missing phone number on transaction");return}i(!0),o("");try{const y=await oe("/api/payments/mpesa/stk",{method:"POST",body:{amount:d.amount,phone:d.phone,transactionId:d._id}});o("M-Pesa STK Push sent. Await confirmation.")}catch(y){o(y.message)}finally{i(!1)}}return e?s.jsxs("div",{className:"card premium-card",children:[s.jsx("h2",{children:"Payments"}),a&&s.jsx("pre",{style:{background:"#f3f4f6",padding:12,whiteSpace:"pre-wrap"},children:a}),s.jsxs("table",{className:"table premium-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Patient"}),s.jsx("th",{children:"Amount"}),s.jsx("th",{children:"Status"}),s.jsx("th",{children:"Actions"}),s.jsx("th",{children:"Workflow"})]})}),s.jsx("tbody",{children:t.length?t.map(d=>{var h,f,y,b;const p=(f=(h=d.workflow)==null?void 0:h.allowedTransitions)==null?void 0:f.includes("PAID");return s.jsxs("tr",{children:[s.jsx("td",{children:((y=d.patient)==null?void 0:y.name)||""}),s.jsxs("td",{children:[d.amount," ",d.currency]}),s.jsx("td",{children:s.jsx(ic,{state:(b=d.workflow)==null?void 0:b.state})}),s.jsxs("td",{children:[s.jsx("button",{disabled:r||!p,onClick:()=>c(d),children:"Stripe"}),s.jsx("button",{disabled:r||!p,onClick:()=>u(d),style:{marginLeft:8},children:"M-Pesa"})]}),s.jsx("td",{style:{minWidth:280},children:s.jsx(xA,{encounterId:d.encounter})})]},d._id)}):s.jsx("tr",{children:s.jsx("td",{colSpan:"5",style:{textAlign:"center"},children:"No pending payments"})})})]})]}):s.jsx("div",{children:"Please log in"})}const Bc="http://localhost:5000";function bA(){const[e,t]=m.useState(100);async function n(){const a=await(await fetch(`${Bc}/payments/stripe/create-intent`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount:Number(e)})})).json();if(a.error){alert(a.error);return}alert("Client secret: "+a.clientSecret+`
(Use Stripe.js on frontend to complete payment)`)}async function r(){const a=await(await fetch(`${Bc}/payments/mpesa/stk`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount:Number(e),phone:"2547XXXXXXXX"})})).json();alert(JSON.stringify(a,null,2))}return s.jsxs("div",{children:[s.jsx("h2",{children:"Payments"}),s.jsxs("div",{children:[s.jsx("label",{children:"Amount: "}),s.jsx("input",{type:"number",value:e,onChange:i=>t(i.target.value)})]}),s.jsx("button",{onClick:n,children:"Pay with Stripe (create intent)"}),s.jsx("button",{onClick:r,children:"Pay with M-Pesa (STK push)"})]})}function Hj(){const e=R_(),{user:t}=Me(),[n,r]=m.useState([]),[i,a]=m.useState("");m.useEffect(()=>{if(!(!e||!t))return e.emit("ai:join"),e.on("ai:status",l=>{r(c=>[...c,{from:"sys",text:l}])}),e.on("ai:chunk",l=>{r(c=>[...c,{from:"ai",text:l}])}),e.on("ai:done",l=>{r(c=>[...c,{from:"ai",text:JSON.stringify(l)}])}),e.on("disconnect",()=>{r(l=>[...l,{from:"sys",text:"Disconnected"}])}),()=>{e.off("ai:status"),e.off("ai:chunk"),e.off("ai:done")}},[e,t]);const o=()=>{!i.trim()||!e||(e.emit("ai:message",{type:"diagnose",symptoms:i}),r(l=>[...l,{from:"user",text:i}]),a(""))};return s.jsxs("div",{children:[s.jsx("div",{style:{maxHeight:320,overflowY:"auto",border:"1px solid #eee",padding:8},children:n.map((l,c)=>s.jsxs("div",{style:{margin:6,background:l.from==="ai"?"#eef":l.from==="user"?"#dfd":"#eee",padding:8,borderRadius:6},children:[s.jsxs("b",{children:[l.from,":"]})," ",l.text]},c))}),s.jsxs("div",{style:{marginTop:8,display:"flex",gap:8},children:[s.jsx("input",{value:i,onChange:l=>a(l.target.value),style:{flex:1},placeholder:"Describe symptoms..."}),s.jsx("button",{onClick:o,children:"Ask AI"})]})]})}function wA(){const{user:e}=Me(),t=localStorage.getItem("token");return s.jsxs("div",{className:"dashboard",children:[s.jsx("div",{className:"welcome-panel",children:s.jsxs("div",{children:[s.jsx("h2",{children:"Medical Assistant"}),s.jsxs("p",{className:"muted",children:["Real-time clinical assistant chat for ",(e==null?void 0:e.name)||"current user","."]})]})}),s.jsx("section",{className:"section",children:s.jsx("div",{className:"card",children:s.jsx(Hj,{token:t})})})]})}async function SA(e){return oe("/api/triage/classify",{method:"POST",body:{symptoms:e}})}async function EA(e){return oe("/api/triage/classify",{method:"POST",body:{symptoms:e}})}async function NA(e){return oe("/api/triage/transcribe",{method:"POST",body:{audioBase64:e}})}function _A(){const[e,t]=m.useState(""),[n,r]=m.useState(null),[i,a]=m.useState(!1),[o,l]=m.useState("");async function c(){if(e.trim()){a(!0),l("");try{const u=await EA(e.trim());r(u)}catch(u){l(u.message||"Failed to classify triage")}finally{a(!1)}}}return s.jsxs("div",{className:"dashboard",children:[s.jsx("div",{className:"welcome-panel",children:s.jsxs("div",{children:[s.jsx("h2",{children:"AI Triage"}),s.jsx("p",{className:"muted",children:"Submit symptom details to get a triage priority and guidance."})]})}),s.jsx("section",{className:"section",children:s.jsxs("div",{className:"card",children:[s.jsx("label",{children:"Symptoms / Case Summary"}),s.jsx("textarea",{rows:6,value:e,onChange:u=>t(u.target.value),placeholder:"e.g. chest pain for 2 hours, shortness of breath..."}),s.jsx("div",{className:"welcome-actions",children:s.jsx("button",{className:"btn-primary",onClick:c,disabled:i,children:i?"Analyzing...":"Run Triage"})}),o&&s.jsx("p",{className:"error-text",children:o})]})}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Triage Output"}),s.jsxs("div",{className:"card",children:[!n&&s.jsx("p",{className:"muted",children:"No triage result yet."}),n&&s.jsxs(s.Fragment,{children:[s.jsxs("p",{children:["Priority: ",s.jsx("strong",{children:n.priority||"unknown"})]}),s.jsx("pre",{style:{whiteSpace:"pre-wrap",margin:0},children:JSON.stringify(n.out||n,null,2)})]})]})]})]})}function AA(){const[e,t]=m.useState(""),[n,r]=m.useState(""),[i,a]=m.useState(!1),[o,l]=m.useState("");async function c(){if(e.trim()){a(!0),l("");try{const u=await NA(e.trim());r((u==null?void 0:u.text)||JSON.stringify(u,null,2))}catch(u){l(u.message||"Failed to transcribe audio")}finally{a(!1)}}}return s.jsxs("div",{className:"dashboard",children:[s.jsx("div",{className:"welcome-panel",children:s.jsxs("div",{children:[s.jsx("h2",{children:"Voice Dictation"}),s.jsx("p",{className:"muted",children:"Paste base64 audio payload to transcribe through your AI provider."})]})}),s.jsx("section",{className:"section",children:s.jsxs("div",{className:"card",children:[s.jsx("label",{children:"Audio (base64)"}),s.jsx("textarea",{rows:6,value:e,onChange:u=>t(u.target.value),placeholder:"Base64 audio payload"}),s.jsx("div",{className:"welcome-actions",children:s.jsx("button",{className:"btn-primary",onClick:c,disabled:i,children:i?"Transcribing...":"Transcribe"})}),o&&s.jsx("p",{className:"error-text",children:o})]})}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Transcript"}),s.jsx("div",{className:"card",children:n?s.jsx("pre",{style:{whiteSpace:"pre-wrap",margin:0},children:n}):s.jsx("p",{className:"muted",children:"No transcript yet."})})]})]})}function CA(){var h,f;const{settings:e}=fi(),[t,n]=m.useState(""),[r,i]=m.useState(""),[a,o]=m.useState(!1),[l,c]=m.useState(""),u=((h=e==null?void 0:e.ai)==null?void 0:h.name)||"NeuroEdge",d=((f=e==null?void 0:e.ai)==null?void 0:f.url)||"";async function p(){var y;if(t.trim()){o(!0),c("");try{const b=await SA(t.trim());i(((y=b==null?void 0:b.out)==null?void 0:y.text)||JSON.stringify((b==null?void 0:b.out)||b,null,2))}catch(b){c(b.message||"Failed to get AI response")}finally{o(!1)}}}return s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsxs("h2",{children:[u," Assistant"]}),s.jsx("p",{className:"muted",children:"Ask clinical support questions. Responses are logged through the backend."})]}),s.jsx("div",{className:"welcome-actions",children:d&&s.jsx("a",{className:"btn-secondary",href:d,target:"_blank",rel:"noreferrer",children:"Open Full AI Workspace"})})]}),s.jsx("section",{className:"section",children:s.jsxs("div",{className:"card",children:[s.jsx("label",{children:"Message"}),s.jsx("textarea",{rows:5,value:t,onChange:y=>n(y.target.value),placeholder:"Describe symptoms, context, or question"}),s.jsx("div",{className:"welcome-actions",children:s.jsx("button",{className:"btn-primary",onClick:p,disabled:a,children:a?"Thinking...":"Send"})}),l&&s.jsx("p",{className:"error-text",children:l})]})}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Response"}),s.jsx("div",{className:"card",children:r?s.jsx("pre",{style:{whiteSpace:"pre-wrap",margin:0},children:r}):s.jsx("p",{className:"muted",children:"No response yet."})})]})]})}const kA=async e=>{const t=new FormData;return t.append("file",e),(await ue.post("/api/ai/extract",t)).data};function IA(){const[e,t]=m.useState(null),[n,r]=m.useState(!1),[i,a]=m.useState(""),[o,l]=m.useState(null),c=async()=>{if(e){r(!0),a("");try{const u=await kA(e);l(u||null)}catch(u){a((u==null?void 0:u.message)||"Failed to extract document"),l(null)}finally{r(!1)}}};return s.jsxs("div",{className:"dashboard",children:[s.jsx("div",{className:"welcome-panel",children:s.jsxs("div",{children:[s.jsx("h2",{children:"NeuroEdge Extract"}),s.jsx("p",{className:"muted",children:"Upload PDF/text/image files to extract raw content and structured fields."})]})}),s.jsx("section",{className:"section",children:s.jsxs("div",{className:"card",children:[s.jsx("label",{children:"Upload file"}),s.jsx("input",{type:"file",accept:".pdf,.txt,.csv,.png,.jpg,.jpeg,.webp,.tiff,.bmp",onChange:u=>{var d;return t(((d=u.target.files)==null?void 0:d[0])||null)}}),s.jsx("div",{className:"welcome-actions",children:s.jsx("button",{className:"btn-primary",onClick:c,disabled:!e||n,children:n?"Extracting...":"Extract"})}),i&&s.jsx("p",{className:"error-text",children:i})]})}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Extraction Output"}),s.jsx("div",{className:"card",children:o?s.jsx("pre",{style:{whiteSpace:"pre-wrap",margin:0},children:JSON.stringify(o,null,2)}):s.jsx("p",{className:"muted",children:"No extraction result yet."})})]})]})}const RA=e=>e.startsWith("/api/")?e:`/api${e.startsWith("/")?"":"/"}${e}`,He=async(e,t,n)=>({data:await oe(RA(t),{method:e,body:n})}),TA=e=>He("POST","/auth/login",e),OA=e=>He("POST","/auth/register",e),PA=async()=>(localStorage.removeItem("token"),localStorage.removeItem("refreshToken"),localStorage.removeItem("user"),{ok:!0}),LA=()=>He("GET","/auth/me"),DA=()=>He("GET","/users"),MA=e=>He("GET",`/users/${e}`),UA=(e,t)=>He("PUT",`/users/${e}`,t),BA=e=>He("DELETE",`/users/${e}`),VA=()=>He("GET","/hospitals"),$A=e=>He("GET",`/hospitals/${e}`),FA=e=>He("POST","/hospitals",e),HA=(e,t)=>He("PUT",`/hospitals/${e}`,t),qA=()=>He("GET","/patients"),zA=e=>He("GET",`/patients/${e}`),WA=e=>He("POST","/patients",e),GA=(e,t)=>He("PUT",`/patients/${e}`,t),YA=()=>He("GET","/appointments"),KA=e=>He("POST","/appointments",e),JA=(e,t)=>He("PUT",`/appointments/${e}`,t),QA=e=>He("DELETE",`/appointments/${e}`),ZA=()=>He("GET","/labs"),XA=e=>He("POST","/labs",e),e1=(e,t)=>He("PUT",`/labs/${e}`,t),t1=()=>He("GET","/financials"),n1=e=>He("POST","/financials",e),r1=(e,t)=>He("PUT",`/financials/${e}`,t),s1=()=>He("GET","/transfers"),i1=e=>He("POST","/transfers",e),a1=()=>He("GET","/notifications"),o1=e=>He("POST","/ai",e),l1=e=>He("POST","/ml",e),c1=(e,t)=>He("PATCH",e,t),as={login:TA,register:OA,logout:PA,getProfile:LA,getUsers:DA,getUserById:MA,updateUser:UA,deleteUser:BA,getHospitals:VA,getHospitalById:$A,createHospital:FA,updateHospital:HA,getPatients:qA,getPatientById:zA,createPatient:WA,updatePatient:GA,getAppointments:YA,createAppointment:KA,updateAppointment:JA,deleteAppointment:QA,getLabTests:ZA,createLabTest:XA,updateLabTest:e1,getFinancials:t1,createFinancial:n1,updateFinancial:r1,getTransfers:s1,createTransfer:i1,getNotifications:a1,runAI:o1,runML:l1,patch:c1};function u1(){const[e,t]=m.useState([]),[n,r]=m.useState({patient:"",doctor:"",scheduledAt:"",durationMins:30});m.useEffect(()=>i(),[]);const i=()=>as.get("/appointments").then(c=>{const u=c.data;t(Array.isArray(u)?u:Array.isArray(u==null?void 0:u.items)?u.items:[])}).catch(()=>{}),a=async()=>{if(!n.patient||!n.scheduledAt){alert("patient and date required");return}await as.post("/appointments",n),r({patient:"",doctor:"",scheduledAt:"",durationMins:30}),i()},o=async c=>{await as.delete("/appointments/"+c),i()},l=async c=>{await as.patch("/appointments/"+c,{status:"Completed"}),i()};return s.jsxs("div",{children:[s.jsx("h3",{children:"Appointments"}),s.jsxs("div",{style:{display:"flex",gap:12},children:[s.jsxs("div",{style:{flex:1},children:[s.jsx("input",{placeholder:"Patient ID",value:n.patient,onChange:c=>r({...n,patient:c.target.value})}),s.jsx("input",{placeholder:"Doctor ID",value:n.doctor,onChange:c=>r({...n,doctor:c.target.value})}),s.jsx("input",{type:"datetime-local",value:n.scheduledAt,onChange:c=>r({...n,scheduledAt:c.target.value})}),s.jsx("input",{type:"number",value:n.durationMins,onChange:c=>r({...n,durationMins:parseInt(c.target.value||30)})}),s.jsx("button",{onClick:a,children:"Create"})]}),s.jsx("div",{style:{flex:2},children:s.jsxs("table",{children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Patient"}),s.jsx("th",{children:"Doctor"}),s.jsx("th",{children:"When"}),s.jsx("th",{children:"Actions"})]})}),s.jsx("tbody",{children:e.map(c=>{var u,d;return s.jsxs("tr",{children:[s.jsx("td",{children:((u=c.patient)==null?void 0:u.firstName)||c.patient}),s.jsx("td",{children:((d=c.doctor)==null?void 0:d.name)||c.doctor}),s.jsx("td",{children:new Date(c.scheduledAt).toLocaleString()}),s.jsxs("td",{children:[s.jsx("button",{onClick:()=>l(c._id),children:"Complete"}),s.jsx("button",{onClick:()=>o(c._id),children:"Delete"})]})]},c._id)})})]})})]})]})}function kn({title:e,subtitle:t,kpis:n=[],panels:r=[],actions:i=[]}){const a=Oe();return s.jsxs("div",{className:"dashboard doctor-workspace",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:e}),s.jsx("p",{className:"muted",children:t})]}),s.jsx("div",{className:"welcome-actions",children:i.map(o=>s.jsx("button",{className:o.variant==="primary"?"btn-primary":"btn-secondary",onClick:()=>o.onClick?o.onClick(a):o.path?a(o.path):null,children:o.label},o.label))})]}),n.length>0&&s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Key Metrics"}),s.jsx("div",{className:"grid info-grid",children:n.map(o=>s.jsxs("div",{className:"card stat",children:[s.jsx("div",{className:"card-title",children:o.title}),s.jsx("div",{className:"card-value",children:o.value}),o.subtitle&&s.jsx("div",{className:"card-sub",children:o.subtitle})]},o.title))})]}),r.length>0&&s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Workspace"}),s.jsx("div",{className:"panel-grid",children:r.map(o=>s.jsxs("div",{className:"panel doctor-panel",children:[s.jsx("h4",{children:o.title}),s.jsx("p",{className:"muted",children:o.body})]},o.title))})]})]})}function d1(){return s.jsx(kn,{title:"My Schedule",subtitle:"Daily, weekly and monthly clinical planning with shift overlays and surgery blocks.",actions:[{label:"Day View",variant:"primary"},{label:"Week View"},{label:"Month View"}],kpis:[{title:"Today Blocks",value:"Live"},{title:"Recurring Clinics",value:"Enabled"},{title:"Telemedicine",value:"Enabled"},{title:"Multi-Branch",value:"Ready"}],panels:[{title:"Calendar Grid",body:"Color-coded OPD, surgery, ward rounds and leave overlays."},{title:"Shift Overlay",body:"On-call and regular shift windows overlaid on appointments."},{title:"Reschedule",body:"Drag and reschedule with automatic conflict checks."},{title:"Surgery Blocks",body:"Reserve and manage procedure slots."}]})}function h1(){const e=Oe(),[t,n]=m.useState(""),[r,i]=m.useState("ALL"),[a,o]=m.useState("ALL"),[l,c]=m.useState([]);m.useEffect(()=>{const d=t.trim(),p=d?`/api/patients?q=${encodeURIComponent(d)}&limit=100`:"/api/patients?limit=100";oe(p).then(h=>{const f=Array.isArray(h==null?void 0:h.items)?h.items:Array.isArray(h)?h:[];c(f)}).catch(()=>c([]))},[t]);const u=m.useMemo(()=>l.filter(d=>{const p=String(d.status||"ACTIVE").toUpperCase(),h=String(d.riskLevel||"MEDIUM").toUpperCase();return(a==="ALL"||p===a)&&(r==="ALL"||h===r)}),[l,r,a]);return s.jsxs("div",{className:"dashboard doctor-workspace",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"My Patients"}),s.jsx("p",{className:"muted",children:"Search and manage inpatient, outpatient and follow-up cases."})]}),s.jsxs("div",{className:"welcome-actions",children:[s.jsx("input",{className:"search-input",placeholder:"Search patient name or ID",value:t,onChange:d=>n(d.target.value)}),s.jsxs("select",{value:a,onChange:d=>o(d.target.value),children:[s.jsx("option",{value:"ALL",children:"All Status"}),s.jsx("option",{value:"ACTIVE",children:"Active"}),s.jsx("option",{value:"CRITICAL",children:"Critical"}),s.jsx("option",{value:"FOLLOW_UP",children:"Follow-up"})]}),s.jsxs("select",{value:r,onChange:d=>i(d.target.value),children:[s.jsx("option",{value:"ALL",children:"All Risk"}),s.jsx("option",{value:"HIGH",children:"High"}),s.jsx("option",{value:"MEDIUM",children:"Medium"}),s.jsx("option",{value:"LOW",children:"Low"})]})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Patient Table"}),s.jsx("div",{className:"table-wrap",children:s.jsxs("table",{className:"doctor-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Patient ID"}),s.jsx("th",{children:"Name"}),s.jsx("th",{children:"Age"}),s.jsx("th",{children:"Diagnosis"}),s.jsx("th",{children:"Admission Type"}),s.jsx("th",{children:"Status"}),s.jsx("th",{children:"Risk Level"}),s.jsx("th",{children:"Last Visit"}),s.jsx("th",{children:"Actions"})]})}),s.jsxs("tbody",{children:[u.map(d=>{var p;return s.jsxs("tr",{children:[s.jsx("td",{children:d.nationalId||((p=d._id)==null?void 0:p.slice(-8))||"-"}),s.jsx("td",{children:[d.firstName,d.lastName].filter(Boolean).join(" ")||"-"}),s.jsx("td",{children:d.age??"-"}),s.jsx("td",{children:d.primaryDiagnosis||"-"}),s.jsx("td",{children:d.admissionType||"Outpatient"}),s.jsx("td",{children:d.status||"ACTIVE"}),s.jsx("td",{children:d.riskLevel||"MEDIUM"}),s.jsx("td",{children:d.updatedAt?new Date(d.updatedAt).toLocaleDateString():"-"}),s.jsx("td",{children:s.jsxs("div",{className:"doctor-actions-row",children:[s.jsx("button",{className:"btn-secondary",onClick:()=>e(`/doctor/medical-records?patientId=${d._id}`),children:"Open Record"}),s.jsx("button",{className:"btn-secondary",onClick:()=>e(`/doctor/reports-notes?patientId=${d._id}`),children:"Add Note"}),s.jsx("button",{className:"btn-secondary",onClick:()=>e(`/doctor/prescriptions?patientId=${d._id}`),children:"Prescribe"}),s.jsx("button",{className:"btn-secondary",onClick:()=>e(`/doctor/referrals?patientId=${d._id}`),children:"Refer"})]})})]},d._id)}),u.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:"9",className:"muted",children:"No patients found."})})]})]})})]})]})}function f1(){return s.jsx(kn,{title:"OPD Clinic Workspace",subtitle:"Consultation screen for diagnosis, notes, coding, treatment and follow-up.",actions:[{label:"Open Consultation",variant:"primary"},{label:"Print Summary"},{label:"Send to Pharmacy"}],panels:[{title:"Patient Summary",body:"Vitals, allergies and insurance context."},{title:"Clinical Notes",body:"Auto-save notes editor with diagnosis and ICD coding."},{title:"Orders & Referrals",body:"Lab orders, prescriptions, specialist referrals and follow-up."},{title:"Consultation Actions",body:"Save & close, print summary and route to pharmacy."}]})}function p1(){return s.jsx(kn,{title:"Inpatient Ward",subtitle:"Bed assignments, daily progress, medication chart visibility and discharge workflow.",actions:[{label:"Open Ward List",variant:"primary"},{label:"Generate Discharge"}],panels:[{title:"Assigned Beds",body:"Current inpatient allocation by ward and risk level."},{title:"Progress Notes",body:"Daily care progression and treatment milestones."},{title:"Nursing Notes",body:"Cross-functional clinical visibility with nurse inputs."},{title:"Mortality Review",body:"Outcome and review logs for governance."}]})}function m1(){return s.jsx(kn,{title:"Surgery & Procedures",subtitle:"Pre-op to post-op documentation, checklists, outcomes and complications.",actions:[{label:"Open Surgery Calendar",variant:"primary"},{label:"Log Procedure"}],panels:[{title:"Surgery Calendar",body:"Procedure schedule by theater and team."},{title:"Pre-op Checklist",body:"Consent, readiness and anesthetic checks."},{title:"Procedure Notes",body:"Structured operative documentation."},{title:"Outcome Tracking",body:"Post-op outcomes and complication reports."}]})}function g1(){const[e,t]=m.useState([]);return m.useEffect(()=>{oe("/api/lab",{method:"GET"}).then(n=>t(Array.isArray(n==null?void 0:n.items)?n.items:Array.isArray(n)?n:[])).catch(()=>t([]))},[]),s.jsxs("div",{className:"dashboard doctor-workspace",children:[s.jsx("div",{className:"welcome-panel",children:s.jsxs("div",{children:[s.jsx("h2",{children:"Lab Results"}),s.jsx("p",{className:"muted",children:"Pending, completed and abnormal results with signature workflow."})]})}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Result Queue"}),s.jsx("div",{className:"table-wrap",children:s.jsxs("table",{className:"doctor-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Encounter"}),s.jsx("th",{children:"Status"}),s.jsx("th",{children:"Updated"}),s.jsx("th",{children:"Action"})]})}),s.jsxs("tbody",{children:[e.map(n=>s.jsxs("tr",{children:[s.jsx("td",{children:n.encounter||"-"}),s.jsx("td",{children:n.status||"-"}),s.jsx("td",{children:n.updatedAt?new Date(n.updatedAt).toLocaleString():"-"}),s.jsx("td",{children:s.jsx("button",{className:"btn-secondary",children:"Open"})})]},n._id)),e.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:"4",className:"muted",children:"No lab results found."})})]})]})})]})]})}function y1(){return s.jsx(kn,{title:"Prescriptions",subtitle:"Drug search, interaction warnings, dosage guidance and secure e-prescription export.",actions:[{label:"Create Prescription",variant:"primary"},{label:"Interaction Check"}],panels:[{title:"Medication Builder",body:"Search, dose, route, duration and refill controls."},{title:"Interaction Warnings",body:"Safety checks and allergy conflict alerts."},{title:"Controlled Drugs",body:"Controlled medication tracking and review logs."},{title:"Export",body:"Signed e-prescription output for pharmacy workflow."}]})}function v1(){return s.jsx(kn,{title:"Medical Records",subtitle:"Longitudinal patient history across visits, surgeries, labs, radiology and attachments.",actions:[{label:"Open Patient Timeline",variant:"primary"},{label:"Upload Attachment"}],panels:[{title:"Visit History",body:"Past consultations and clinical notes timeline."},{title:"Clinical History",body:"Surgeries, immunizations and chronic history."},{title:"Diagnostics",body:"Lab and radiology history with trend support."},{title:"Attachments",body:"Secure PDFs and imaging artifacts."}]})}function x1(){return s.jsx(kn,{title:"Referrals",subtitle:"Internal and external referrals with specialist transfer status tracking.",actions:[{label:"New Internal Referral",variant:"primary"},{label:"New External Referral"}],panels:[{title:"Internal Referrals",body:"Intra-hospital specialist handoffs."},{title:"External Referrals",body:"Cross-facility referral generation and tracking."},{title:"Transfer Status",body:"Pending, accepted, completed and declined states."}]})}function j1(){return s.jsx(kn,{title:"Performance",subtitle:"Operational and quality indicators aligned with HR performance evaluation.",actions:[{label:"View Monthly KPIs",variant:"primary"},{label:"Export Metrics"}],kpis:[{title:"Patient Load",value:"Live"},{title:"Surgery Count",value:"Live"},{title:"Complication Rate",value:"Live"},{title:"Attendance",value:"Live"},{title:"Overtime",value:"Live"},{title:"Leave Balance",value:"Live"}],panels:[{title:"Clinical Outcomes",body:"Outcome and complication trend snapshots."},{title:"Experience",body:"Patient satisfaction and service metrics."}]})}function b1(){return s.jsx(kn,{title:"CME & Certifications",subtitle:"License expiry, CME tracking, certificate vault and compliance reminders.",actions:[{label:"Upload Certificate",variant:"primary"},{label:"View Training Calendar"}],panels:[{title:"License Status",body:"License number and expiry countdown."},{title:"CME Credits",body:"Credits earned and upcoming requirement targets."},{title:"Compliance Alerts",body:"Expiring credentials and mandatory training reminders."}]})}function w1(){const e=Oe();return s.jsx(kn,{title:"Leave Requests",subtitle:"Manage leave balance, request submissions, approvals and shift impact.",actions:[{label:"Open My Requests",variant:"primary",onClick:()=>e("/workforce/requests#leave")},{label:"Request Overtime",onClick:()=>e("/workforce/requests#overtime")},{label:"Request Shift",onClick:()=>e("/workforce/requests#shift")}],panels:[{title:"Leave Balance",body:"Current available leave and planned allocations."},{title:"Approval Status",body:"Pending, approved and rejected history."},{title:"Shift Impact",body:"Coverage and continuity preview before submission."}]})}function S1(){return s.jsx(kn,{title:"Reports & Notes",subtitle:"Case archive, research notes, exports and publication tracking.",actions:[{label:"Open Reports",variant:"primary",path:"/reports"},{label:"New Note"}],panels:[{title:"Case Notes",body:"Structured archive of clinical notes."},{title:"Research Notes",body:"Research and academic note workspace."},{title:"Exports",body:"Downloadable report and performance data exports."}]})}function E1(){return s.jsx(kn,{title:"Doctor Settings",subtitle:"Profile, availability, notifications, signature and account security controls.",actions:[{label:"Open Profile",variant:"primary",path:"/profile"},{label:"Notification Preferences"}],panels:[{title:"Availability",body:"Clinic windows and scheduling preferences."},{title:"Digital Signature",body:"Upload and manage document signature identity."},{title:"Security",body:"2FA, session and account protection options."},{title:"Theme",body:"Light, dark and system display mode preferences."}]})}function qj(){const[e,t]=m.useState([]),[n,r]=m.useState({patient:"",testType:""});m.useEffect(()=>i(),[]);const i=()=>as.get("/labs").then(c=>t(c.data)).catch(()=>{}),a=async()=>{if(!n.patient||!n.testType)return alert("patient and test required");await as.post("/labs",n),r({patient:"",testType:""}),i()},o=async c=>{const u={values:{Hb:10+Math.round(Math.random()*5),WBC:5+Math.round(Math.random()*8)}};await as.post("/labs/"+c+"/result",{result:u,status:"Completed"}),i()},l=async c=>{await as.delete("/labs/"+c),i()};return s.jsxs("div",{children:[s.jsx("h3",{children:"Lab Tests"}),s.jsxs("div",{style:{display:"flex",gap:12},children:[s.jsxs("div",{style:{flex:1},children:[s.jsx("input",{placeholder:"Patient ID",value:n.patient,onChange:c=>r({...n,patient:c.target.value})}),s.jsx("input",{placeholder:"Test type",value:n.testType,onChange:c=>r({...n,testType:c.target.value})}),s.jsx("button",{onClick:a,children:"Order"})]}),s.jsx("div",{style:{flex:2},children:s.jsxs("table",{children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Patient"}),s.jsx("th",{children:"Test"}),s.jsx("th",{children:"Status"}),s.jsx("th",{children:"Actions"})]})}),s.jsx("tbody",{children:e.map(c=>{var u;return s.jsxs("tr",{children:[s.jsx("td",{children:((u=c.patient)==null?void 0:u.firstName)||c.patient}),s.jsx("td",{children:c.testType}),s.jsx("td",{children:c.status}),s.jsxs("td",{children:[s.jsx("button",{onClick:()=>o(c._id),children:"Upload Result"}),s.jsx("button",{onClick:()=>l(c._id),children:"Delete"})]})]},c._id)})})]})})]})]})}function nt({title:e,subtitle:t,actions:n=[],kpis:r=[],panels:i=[],children:a}){const o=Oe();return s.jsxs("div",{className:"dashboard doctor-workspace",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:e}),s.jsx("p",{className:"muted",children:t})]}),s.jsx("div",{className:"welcome-actions",children:n.map(l=>s.jsx("button",{className:l.variant==="primary"?"btn-primary":"btn-secondary",onClick:()=>l.onClick?l.onClick(o):l.path?o(l.path):null,children:l.label},l.label))})]}),r.length>0&&s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Summary"}),s.jsx("div",{className:"grid info-grid",children:r.map(l=>s.jsxs("div",{className:"card stat",children:[s.jsx("div",{className:"card-title",children:l.title}),s.jsx("div",{className:"card-value",children:l.value}),l.subtitle&&s.jsx("div",{className:"card-sub",children:l.subtitle})]},l.title))})]}),i.length>0&&s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Workspace"}),s.jsx("div",{className:"panel-grid",children:i.map(l=>s.jsxs("div",{className:"panel doctor-panel",children:[s.jsx("h4",{children:l.title}),s.jsx("p",{className:"muted",children:l.body})]},l.title))})]}),a]})}function N1(){return s.jsx(nt,{title:"My Shift",subtitle:"Current shift details, handover notes and real-time ward responsibilities.",actions:[{label:"Start Round",variant:"primary"},{label:"Handover Notes"}],panels:[{title:"Shift Window",body:"Current shift block and assigned zone."},{title:"Handover",body:"Incoming and outgoing shift notes."},{title:"Coverage",body:"Staff coverage snapshot for your unit."}]})}function _1(){const[e,t]=m.useState([]);return m.useEffect(()=>{oe("/api/patients?limit=50").then(n=>t(Array.isArray(n==null?void 0:n.items)?n.items:[])).catch(()=>t([]))},[]),s.jsxs("div",{className:"dashboard doctor-workspace",children:[s.jsx("div",{className:"welcome-panel",children:s.jsxs("div",{children:[s.jsx("h2",{children:"Assigned Patients"}),s.jsx("p",{className:"muted",children:"Patient list with quick actions for bedside workflow."})]})}),s.jsx("section",{className:"section",children:s.jsx("div",{className:"table-wrap",children:s.jsxs("table",{className:"doctor-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Name"}),s.jsx("th",{children:"Ward"}),s.jsx("th",{children:"Status"}),s.jsx("th",{children:"Risk"}),s.jsx("th",{children:"Action"})]})}),s.jsxs("tbody",{children:[e.map(n=>s.jsxs("tr",{children:[s.jsx("td",{children:[n.firstName,n.lastName].filter(Boolean).join(" ")||"-"}),s.jsx("td",{children:n.ward||"-"}),s.jsx("td",{children:n.status||"ACTIVE"}),s.jsx("td",{children:n.riskLevel||"MEDIUM"}),s.jsx("td",{children:s.jsx("button",{className:"btn-secondary",children:"Open"})})]},n._id)),e.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:"5",className:"muted",children:"No assigned patients found."})})]})]})})})]})}function A1(){return s.jsx(nt,{title:"Medication Administration",subtitle:"Due medications, verification checks and administration logs.",actions:[{label:"Open MAR",variant:"primary"},{label:"Drug Interaction Check"}],panels:[{title:"Due Medications",body:"Upcoming medication tasks by time."},{title:"Verification",body:"Patient, dose and route verification controls."},{title:"Administration Log",body:"Time-stamped medication administration records."}]})}function C1(){return s.jsx(nt,{title:"Incident Reports",subtitle:"Create, track and escalate safety incidents from nursing operations.",actions:[{label:"New Incident",variant:"primary"},{label:"Open Incident Queue"}],panels:[{title:"Quick Form",body:"Capture severity, event details and affected patient."},{title:"Escalations",body:"High-risk cases routed to security/admin."},{title:"History",body:"Review previously filed incidents and status."}]})}function k1(){return s.jsx(nt,{title:"Vitals Entry",subtitle:"Record patient vitals and flag abnormal trends for review.",actions:[{label:"New Vitals Record",variant:"primary"},{label:"Trend View"}],panels:[{title:"Vitals Form",body:"BP, pulse, temperature, SpO2 and pain scale inputs."},{title:"Trend Graphs",body:"Historical progression for quick deterioration detection."},{title:"Alerts",body:"Abnormal values push real-time alerts to care team."}]})}function I1(){return s.jsx(nt,{title:"Leave Requests",subtitle:"Leave balance, submission workflow and shift coverage impact preview.",actions:[{label:"Request Leave",variant:"primary",path:"/workforce/requests#leave"},{label:"Request Overtime",path:"/workforce/requests#overtime"}],panels:[{title:"Balance",body:"Current leave and carry-over totals."},{title:"Request History",body:"Approved, rejected and pending requests."},{title:"Coverage",body:"Shift impact preview before submit."}]})}function R1(){return s.jsx(nt,{title:"Performance",subtitle:"Attendance, task completion and supervisor feedback metrics.",kpis:[{title:"Attendance",value:"Live"},{title:"Task Completion",value:"Live"},{title:"Supervisor Feedback",value:"Live"}],panels:[{title:"Shift Score",body:"Shift punctuality and completion summary."},{title:"Care Quality",body:"Clinical task quality and incident ratio."}]})}function T1(){return s.jsx(qj,{})}function O1(){return s.jsx(nt,{title:"Equipment Logs",subtitle:"Track machine uptime, calibration and maintenance events.",actions:[{label:"New Log",variant:"primary"},{label:"Maintenance Calendar"}],panels:[{title:"Uptime",body:"Device uptime and downtime events."},{title:"Calibration",body:"Calibration due dates and completion records."},{title:"Maintenance",body:"Scheduled and emergency maintenance logs."}]})}function P1(){return s.jsx(nt,{title:"Sample Tracking",subtitle:"Monitor sample lifecycle from collection to result release.",actions:[{label:"Track Sample",variant:"primary"},{label:"Flag Delay"}],panels:[{title:"Collection",body:"Collected sample inventory and timestamps."},{title:"Processing",body:"In-lab progress state and queue slot."},{title:"Release",body:"Result-ready and signed-off status."}]})}function L1(){return s.jsx(nt,{title:"Quality Control",subtitle:"QC runs, deviations and corrective action tracking.",actions:[{label:"Run QC",variant:"primary"},{label:"Deviation Log"}],panels:[{title:"QC Runs",body:"Daily and batch QC checkpoints."},{title:"Deviations",body:"Abnormal QC outcomes and escalation."},{title:"Corrective Actions",body:"Action ownership and closure tracking."}]})}function D1(){return s.jsx(nt,{title:"Safety Checklist",subtitle:"Lab biosafety compliance checks and hazard readiness.",actions:[{label:"Start Checklist",variant:"primary"},{label:"Report Hazard"}],panels:[{title:"PPE",body:"Protective gear compliance checks."},{title:"Biohazard",body:"Containment and disposal controls."},{title:"Safety Audits",body:"Audit history and corrective tasks."}]})}function M1(){return s.jsx(nt,{title:"Reports Archive",subtitle:"Historical lab reports and export-ready records.",actions:[{label:"Open Reports",variant:"primary",path:"/reports"},{label:"Export Archive"}],panels:[{title:"Completed Reports",body:"Finalized reports by date and type."},{title:"Urgent Flags",body:"Priority report history and turnaround."}]})}function U1(){return s.jsx(nt,{title:"Prescription Queue",subtitle:"Pending and active prescriptions awaiting dispensing workflow.",actions:[{label:"Open Queue",variant:"primary"},{label:"Verify Interactions"}],panels:[{title:"Pending",body:"Newly created prescriptions awaiting validation."},{title:"In Progress",body:"Prescriptions currently being dispensed."},{title:"Completed",body:"Dispensed and closed prescriptions."}]})}function B1(){const e=Oe();return s.jsx(nt,{title:"Inventory",subtitle:"Stock visibility, reorder thresholds and replenishment management.",actions:[{label:"Open Inventory",variant:"primary",onClick:()=>e("/inventory")},{label:"Reorder Planner"}],panels:[{title:"Stock Levels",body:"Current quantity by item and category."},{title:"Low Stock",body:"Items below configured safety threshold."},{title:"Reorder",body:"Supplier reorder planning and execution."}]})}function V1(){return s.jsx(nt,{title:"Controlled Drugs",subtitle:"Controlled medication ledger, issue/return logs and compliance checks.",actions:[{label:"Open Controlled Log",variant:"primary"},{label:"Audit Export"}],panels:[{title:"Dispense Log",body:"Controlled drug issue records."},{title:"Stock Checks",body:"Count reconciliation and discrepancy flags."},{title:"Compliance",body:"Regulatory controls and audit artifacts."}]})}function $1(){return s.jsx(nt,{title:"Expiry Alerts",subtitle:"Medication expiry surveillance and near-expiry action workflow.",actions:[{label:"Review Alerts",variant:"primary"},{label:"Quarantine Batch"}],panels:[{title:"Near Expiry",body:"Batches approaching expiry."},{title:"Expired",body:"Expired items requiring disposal records."},{title:"Actions",body:"Return, quarantine and replacement actions."}]})}function F1(){return s.jsx(nt,{title:"Supplier Orders",subtitle:"Purchase order workflow, supplier lead times and delivery tracking.",actions:[{label:"Create PO",variant:"primary"},{label:"Track Deliveries"}],panels:[{title:"Open Orders",body:"Purchase orders awaiting fulfillment."},{title:"Deliveries",body:"Incoming shipment and receiving logs."},{title:"Supplier Performance",body:"Lead-time and reliability metrics."}]})}function H1(){return s.jsx(nt,{title:"Pharmacy Reports",subtitle:"Dispense volumes, controlled logs and inventory audit reports.",actions:[{label:"Open Reports",variant:"primary",path:"/reports"},{label:"Export CSV"}],panels:[{title:"Dispense Trends",body:"Daily and monthly dispensing analysis."},{title:"Controlled Audit",body:"Controlled drug variance and audit trail."},{title:"Inventory Reports",body:"Consumption and procurement reports."}]})}function q1(){return s.jsx(nt,{title:"My Appointments",subtitle:"Upcoming, completed and rescheduled appointment history.",actions:[{label:"Book Appointment",variant:"primary"},{label:"Reschedule"}],panels:[{title:"Upcoming",body:"Upcoming appointments and reminders."},{title:"History",body:"Completed visit history timeline."},{title:"Follow-up",body:"Required follow-up and action items."}]})}function z1(){return s.jsx(nt,{title:"Medical Records",subtitle:"Personal longitudinal records across visits, procedures, labs and files.",actions:[{label:"Open Timeline",variant:"primary"},{label:"Download Record"}],panels:[{title:"Visits",body:"Consultation and admission history."},{title:"Procedures",body:"Procedure and treatment history."},{title:"Attachments",body:"Uploaded reports and supporting documents."}]})}function W1(){return s.jsx(nt,{title:"Prescriptions",subtitle:"Active and historical prescriptions with refill and dosage guidance.",actions:[{label:"Active Prescriptions",variant:"primary"},{label:"Refill Request"}],panels:[{title:"Current Meds",body:"Currently active medications and dosage."},{title:"History",body:"Historical prescription records."},{title:"Refills",body:"Refill workflow and status tracking."}]})}function G1(){return s.jsx(nt,{title:"Lab Results",subtitle:"View completed labs, flagged values and trend history.",actions:[{label:"View Results",variant:"primary"},{label:"Download PDF"}],panels:[{title:"Completed",body:"Completed test result archive."},{title:"Flagged",body:"Abnormal values requiring review."},{title:"Trends",body:"Historic result trends over time."}]})}function Y1(){return s.jsx(nt,{title:"Billing",subtitle:"Invoices, outstanding balances, receipts and payment history.",actions:[{label:"Open Payments",variant:"primary",path:"/payments"},{label:"Download Receipt"}],panels:[{title:"Outstanding",body:"Pending invoices and due dates."},{title:"Paid",body:"Paid invoices and transaction history."},{title:"Receipts",body:"Receipt archive and exports."}]})}function K1(){return s.jsx(nt,{title:"Insurance",subtitle:"Coverage details, authorization status and claim references.",actions:[{label:"View Coverage",variant:"primary"},{label:"Claims History"}],panels:[{title:"Coverage",body:"Policy and coverage summary."},{title:"Authorizations",body:"Encounter authorization status."},{title:"Claims",body:"Claim outcomes and references."}]})}function J1(){return s.jsx(nt,{title:"Feedback",subtitle:"Submit service feedback and track responses.",actions:[{label:"Submit Feedback",variant:"primary"},{label:"View Responses"}],panels:[{title:"New Feedback",body:"Capture care and service feedback."},{title:"History",body:"Past submissions and status."},{title:"Messages",body:"Response thread from support teams."}]})}function Q1(){const[e,t]=m.useState("hospital-a"),[n,r]=m.useState(""),[i,a]=m.useState(""),[o,l]=m.useState(null);async function c(){const p=await(await fetch(`${Bc}/webhooks/${e}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({hl7:n})})).json();l(p)}async function u(){let d={};try{d=JSON.parse(i)}catch{alert("Invalid JSON");return}const h=await(await fetch(`${Bc}/webhooks/${e}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({resource:d})})).json();l(h)}return s.jsxs("div",{children:[s.jsx("h2",{children:"Real-Time Integrations (Webhooks)"}),s.jsxs("div",{style:{display:"flex",gap:12},children:[s.jsxs("div",{style:{flex:1},children:[s.jsx("h4",{children:"Send HL7 Message"}),s.jsx("input",{value:e,onChange:d=>t(d.target.value)}),s.jsx("textarea",{value:n,onChange:d=>r(d.target.value),rows:8,style:{width:"100%"},placeholder:"Paste raw HL7 message here (\\r delimited)"}),s.jsx("button",{onClick:c,children:"Send HL7"})]}),s.jsxs("div",{style:{flex:1},children:[s.jsx("h4",{children:"Send FHIR Patient Resource"}),s.jsx("textarea",{value:i,onChange:d=>a(d.target.value),rows:8,style:{width:"100%"},placeholder:"Paste FHIR Patient JSON here"}),s.jsx("button",{onClick:u,children:"Send FHIR"})]})]}),s.jsxs("div",{style:{marginTop:12},children:[s.jsx("h4",{children:"Response"}),s.jsx("pre",{children:JSON.stringify(o,null,2)})]})]})}var zj={exports:{}},Oh={exports:{}},Ag=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof window.msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto);if(Ag){var Cg=new Uint8Array(16);Oh.exports=function(){return Ag(Cg),Cg}}else{var kg=new Array(16);Oh.exports=function(){for(var t=0,n;t<16;t++)t&3||(n=Math.random()*4294967296),kg[t]=n>>>((t&3)<<3)&255;return kg}}var Wj=Oh.exports,Gj=[];for(var Rl=0;Rl<256;++Rl)Gj[Rl]=(Rl+256).toString(16).substr(1);function Z1(e,t){var n=t||0,r=Gj;return[r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]]].join("")}var Yj=Z1,X1=Wj,eC=Yj,Ig,sd,id=0,ad=0;function tC(e,t,n){var r=t&&n||0,i=t||[];e=e||{};var a=e.node||Ig,o=e.clockseq!==void 0?e.clockseq:sd;if(a==null||o==null){var l=X1();a==null&&(a=Ig=[l[0]|1,l[1],l[2],l[3],l[4],l[5]]),o==null&&(o=sd=(l[6]<<8|l[7])&16383)}var c=e.msecs!==void 0?e.msecs:new Date().getTime(),u=e.nsecs!==void 0?e.nsecs:ad+1,d=c-id+(u-ad)/1e4;if(d<0&&e.clockseq===void 0&&(o=o+1&16383),(d<0||c>id)&&e.nsecs===void 0&&(u=0),u>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");id=c,ad=u,sd=o,c+=122192928e5;var p=((c&268435455)*1e4+u)%4294967296;i[r++]=p>>>24&255,i[r++]=p>>>16&255,i[r++]=p>>>8&255,i[r++]=p&255;var h=c/4294967296*1e4&268435455;i[r++]=h>>>8&255,i[r++]=h&255,i[r++]=h>>>24&15|16,i[r++]=h>>>16&255,i[r++]=o>>>8|128,i[r++]=o&255;for(var f=0;f<6;++f)i[r+f]=a[f];return t||eC(i)}var nC=tC,rC=Wj,sC=Yj;function iC(e,t,n){var r=t&&n||0;typeof e=="string"&&(t=e==="binary"?new Array(16):null,e=null),e=e||{};var i=e.random||(e.rng||rC)();if(i[6]=i[6]&15|64,i[8]=i[8]&63|128,t)for(var a=0;a<16;++a)t[r+a]=i[a];return t||sC(i)}var aC=iC,oC=nC,Kj=aC,mp=Kj;mp.v1=oC;mp.v4=Kj;var lC=mp;const{v4:cC}=lC;function Jj(){return cC().replace(/-/g,"")}let gp=Jj;function yp(){return gp()}yp.setFactory=e=>{gp=e};yp.reset=()=>{gp=Jj};var vp=yp;const uC=Symbol("_options"),dC=Symbol("_cache"),hC=Symbol("_state"),fC=Symbol("_objectId"),pC=Symbol("_conflicts"),mC=Symbol("_change"),gC=Symbol("_elemIds");var Cs={OPTIONS:uC,CACHE:dC,STATE:hC,OBJECT_ID:fC,CONFLICTS:pC,CHANGE:mC,ELEM_IDS:gC};function Qj(e){return typeof e=="object"&&e!==null}function yC(e){if(!Qj(e))return{};let t={};for(let n of Object.keys(e))t[n]=e[n];return t}function vC(e){const t=/^(\d+)@(.*)$/.exec(e||"");if(!t)throw new RangeError(`Not a valid opId: ${e}`);return{counter:parseInt(t[1],10),actorId:t[2]}}function xC(e,t){if(!(e instanceof Uint8Array)||!(t instanceof Uint8Array))throw new TypeError("equalBytes can only compare Uint8Arrays");if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.byteLength;n++)if(e[n]!==t[n])return!1;return!0}function jC(e){const t=new Array(e);for(let n=0;n<e;n++)t[n]=null;return t}var hr={isObject:Qj,copyObject:yC,parseOpId:vC,equalBytes:xC,createArrayOfNulls:jC};const{OBJECT_ID:Fs}=Cs,{isObject:bC}=hr;let xp=class{constructor(t){if(typeof t=="string"){const n=[...t].map(r=>({value:r}));return to(void 0,n)}else if(Array.isArray(t)){const n=t.map(r=>({value:r}));return to(void 0,n)}else{if(t===void 0)return to(void 0,[]);throw new TypeError(`Unsupported initial value for Text: ${t}`)}}get length(){return this.elems.length}get(t){const n=this.elems[t].value;if(this.context&&bC(n)){const r=n[Fs],i=this.path.concat([{key:t,objectId:r}]);return this.context.instantiateObject(i,r)}else return n}getElemId(t){return this.elems[t].elemId}[Symbol.iterator](){let t=this.elems,n=-1;return{next(){return n+=1,n<t.length?{done:!1,value:t[n].value}:{done:!0}}}}toString(){let t="";for(const n of this.elems)typeof n.value=="string"&&(t+=n.value);return t}toSpans(){let t=[],n="";for(const r of this.elems)typeof r.value=="string"?n+=r.value:(n.length>0&&(t.push(n),n=""),t.push(r.value));return n.length>0&&t.push(n),t}toJSON(){return this.toString()}getWriteable(t,n){if(!this[Fs])throw new RangeError("getWriteable() requires the objectId to be set");const r=to(this[Fs],this.elems);return r.context=t,r.path=n,r}set(t,n){if(this.context)this.context.setListIndex(this.path,t,n);else if(!this[Fs])this.elems[t].value=n;else throw new TypeError("Automerge.Text object cannot be modified outside of a change block");return this}insertAt(t,...n){if(this.context)this.context.splice(this.path,t,0,n);else if(!this[Fs])this.elems.splice(t,0,...n.map(r=>({value:r})));else throw new TypeError("Automerge.Text object cannot be modified outside of a change block");return this}deleteAt(t,n=1){if(this.context)this.context.splice(this.path,t,n,[]);else if(!this[Fs])this.elems.splice(t,n);else throw new TypeError("Automerge.Text object cannot be modified outside of a change block");return this}};for(let e of["concat","every","filter","find","findIndex","forEach","includes","indexOf","join","lastIndexOf","map","reduce","reduceRight","slice","some","toLocaleString"])xp.prototype[e]=function(...t){return[...this][e](...t)};function to(e,t){const n=Object.create(xp.prototype);return n[Fs]=e,n.elems=t,n}var pu={Text:xp,instantiateText:to};const{OBJECT_ID:Hs,CONFLICTS:wC}=Cs,{isObject:Vc,copyObject:Rg}=hr;function od(e,t,n){for(let r of e)if(t[r]!==n[r]){if(typeof t[r]=="number"&&typeof n[r]=="number")return t[r]-n[r];{const i=""+t[r],a=""+n[r];if(i===a)continue;return i<a?-1:1}}return 0}let jp=class{constructor(){this.entries=Object.freeze({}),this.opIds=Object.freeze({}),Object.freeze(this)}byId(t){return this.entries[t]}get ids(){return Object.keys(this.entries).filter(t=>{const n=this.entries[t];return Vc(n)&&n.id===t})}get count(){return this.ids.length}get rows(){return this.ids.map(t=>this.byId(t))}filter(t,n){return this.rows.filter(t,n)}find(t,n){return this.rows.find(t,n)}map(t,n){return this.rows.map(t,n)}sort(t){if(typeof t=="function")return this.rows.sort(t);if(typeof t=="string")return this.rows.sort((n,r)=>od([t],n,r));if(Array.isArray(t))return this.rows.sort((n,r)=>od(t,n,r));if(t===void 0)return this.rows.sort((n,r)=>od(["id"],n,r));throw new TypeError(`Unsupported sorting argument: ${t}`)}[Symbol.iterator](){let t=this.rows,n=-1;return{next(){return n+=1,n<t.length?{done:!1,value:t[n]}:{done:!0}}}}_clone(){if(!this[Hs])throw new RangeError("clone() requires the objectId to be set");return Zj(this[Hs],Rg(this.entries),Rg(this.opIds))}_set(t,n,r){if(Object.isFrozen(this.entries))throw new Error("A table can only be modified in a change function");Vc(n)&&!Array.isArray(n)&&Object.defineProperty(n,"id",{value:t,enumerable:!0}),this.entries[t]=n,this.opIds[t]=r}remove(t){if(Object.isFrozen(this.entries))throw new Error("A table can only be modified in a change function");delete this.entries[t],delete this.opIds[t]}_freeze(){Object.freeze(this.entries),Object.freeze(this.opIds),Object.freeze(this)}getWriteable(t,n){if(!this[Hs])throw new RangeError("getWriteable() requires the objectId to be set");const r=Object.create(SC.prototype);return r[Hs]=this[Hs],r.context=t,r.entries=this.entries,r.opIds=this.opIds,r.path=n,r}toJSON(){const t={};for(let n of this.ids)t[n]=this.byId(n);return t}};class SC extends jp{byId(t){if(Vc(this.entries[t])&&this.entries[t].id===t){const n=this.entries[t][Hs],r=this.path.concat([{key:t,objectId:n}]);return this.context.instantiateObject(r,n,["id"])}}add(t){return this.context.addTableRow(this.path,t)}remove(t){if(Vc(this.entries[t])&&this.entries[t].id===t)this.context.deleteTableRow(this.path,t,this.opIds[t]);else throw new RangeError(`There is no row with ID ${t} in this table`)}}function Zj(e,t,n){const r=Object.create(jp.prototype);if(!e)throw new RangeError("instantiateTable requires an objectId to be given");return r[Hs]=e,r[wC]=Object.freeze({}),r.entries=t||{},r.opIds=n||{},r}var mu={Table:jp,instantiateTable:Zj};let Xj=class{constructor(t){this.value=t||0,Object.freeze(this)}valueOf(){return this.value}toString(){return this.valueOf().toString()}toJSON(){return this.value}};class EC extends Xj{increment(t){return t=typeof t=="number"?t:1,this.context.increment(this.path,this.key,t),this.value+=t,this.value}decrement(t){return this.increment(typeof t=="number"?-t:-1)}}function NC(e,t,n,r,i){const a=Object.create(EC.prototype);return a.value=e,a.context=t,a.path=n,a.objectId=r,a.key=i,a}var bp={Counter:Xj,getWriteableCounter:NC};const{isObject:_C,copyObject:Tg,parseOpId:$c}=hr,{OBJECT_ID:$o,CONFLICTS:ei,ELEM_IDS:ac}=Cs,{instantiateText:AC}=pu,{instantiateTable:CC}=mu,{Counter:kC}=bp;function Lr(e,t,n){return e.objectId?(t&&t[$o]!==e.objectId&&(t=void 0),tb(e,t,n)):e.datatype==="timestamp"?new Date(e.value):e.datatype==="counter"?new kC(e.value):e.value}function IC(e,t){const n=/^(\d+)@(.*)$/,r=n.test(e)?$c(e):{counter:0,actorId:e},i=n.test(t)?$c(t):{counter:0,actorId:t};return r.counter<i.counter?-1:r.counter>i.counter?1:r.actorId<i.actorId?-1:r.actorId>i.actorId?1:0}function RC(e,t,n,r){if(e)for(let i of Object.keys(e)){const a={},o=Object.keys(e[i]).sort(IC).reverse();for(let l of o){const c=e[i][l];n[i]&&n[i][l]?a[l]=Lr(c,n[i][l],r):a[l]=Lr(c,void 0,r)}o.length===0?(delete t[i],delete n[i]):(t[i]=a[o[0]],n[i]=a)}}function eb(e,t){const n=Tg(e),r=Tg(e?e[ei]:void 0);return Object.defineProperty(n,$o,{value:t}),Object.defineProperty(n,ei,{value:r}),n}function TC(e,t,n){const r=e.objectId;n[r]||(n[r]=eb(t,r));const i=n[r];return RC(e.props,i,i[ei],n),i}function OC(e,t,n){const r=e.objectId;n[r]||(n[r]=t?t._clone():CC(r));const i=n[r];for(let a of Object.keys(e.props||{})){const o=Object.keys(e.props[a]);if(o.length===0)i.remove(a);else if(o.length===1){const l=e.props[a][o[0]];i._set(a,Lr(l,i.byId(a),n),o[0])}else throw new RangeError("Conflicts are not supported on properties of a table")}return i}function PC(e,t){const n=e?e.slice():[],r=e&&e[ei]?e[ei].slice():[],i=e&&e[ac]?e[ac].slice():[];return Object.defineProperty(n,$o,{value:t}),Object.defineProperty(n,ei,{value:r}),Object.defineProperty(n,ac,{value:i}),n}function LC(e,t,n){const r=e.objectId;n[r]||(n[r]=PC(t,r));const i=n[r],a=i[ei],o=i[ac];for(let l=0;l<e.edits.length;l++){const c=e.edits[l];if(c.action==="insert"||c.action==="update"){const u=a[c.index]&&a[c.index][c.opId];let d=Lr(c.value,u,n),p={[c.opId]:d};for(;l<e.edits.length-1&&e.edits[l+1].index===c.index&&e.edits[l+1].action==="update";){l++;const h=e.edits[l],f=a[h.index]&&a[h.index][h.opId];d=Lr(h.value,f,n),p[h.opId]=d}c.action==="insert"?(i.splice(c.index,0,d),a.splice(c.index,0,p),o.splice(c.index,0,c.elemId)):(i[c.index]=d,a[c.index]=p)}else if(c.action==="multi-insert"){const u=$c(c.elemId),d=[],p=[],h=[],f=c.datatype;c.values.forEach((y,b)=>{const E=`${u.counter+b}@${u.actorId}`;y=Lr({value:y,datatype:f},void 0,n),p.push(y),h.push({[E]:{value:y,datatype:f,type:"value"}}),d.push(E)}),i.splice(c.index,0,...p),a.splice(c.index,0,...h),o.splice(c.index,0,...d)}else c.action==="remove"&&(i.splice(c.index,c.count),a.splice(c.index,c.count),o.splice(c.index,c.count))}return i}function DC(e,t,n){const r=e.objectId;let i;n[r]?i=n[r].elems:t?i=t.elems.slice():i=[];for(const a of e.edits)if(a.action==="insert"){const o=Lr(a.value,void 0,n),l={elemId:a.elemId,pred:[a.opId],value:o};i.splice(a.index,0,l)}else if(a.action==="multi-insert"){const o=$c(a.elemId),l=a.datatype,c=a.values.map((u,d)=>{u=Lr({datatype:l,value:u},void 0,n);const p=`${o.counter+d}@${o.actorId}`;return{elemId:p,pred:[p],value:u}});i.splice(a.index,0,...c)}else if(a.action==="update"){const o=i[a.index].elemId,l=Lr(a.value,i[a.index].value,n);i[a.index]={elemId:o,pred:[a.opId],value:l}}else a.action==="remove"&&i.splice(a.index,a.count);return n[r]=AC(r,i),n[r]}function tb(e,t,n){if(_C(t)&&(!e.props||Object.keys(e.props).length===0)&&(!e.edits||e.edits.length===0)&&!n[e.objectId])return t;if(e.type==="map")return TC(e,t,n);if(e.type==="table")return OC(e,t,n);if(e.type==="list")return LC(e,t,n);if(e.type==="text")return DC(e,t,n);throw new TypeError(`Unknown object type: ${e.type}`)}function MC(e){if(e[$o]!=="_root")throw new RangeError(`Not the root object: ${e[$o]}`);return eb(e,"_root")}var nb={interpretPatch:tb,cloneRootObject:MC};const{OBJECT_ID:ti,CHANGE:Fc,STATE:UC}=Cs,{createArrayOfNulls:BC}=hr,{Text:VC}=pu,{Table:$C}=mu;function nr(e){if(typeof e=="string"&&/^[0-9]+$/.test(e)&&(e=parseInt(e,10)),typeof e!="number")throw new TypeError("A list index must be a number, but you passed "+JSON.stringify(e));if(e<0||isNaN(e)||e===1/0||e===-1/0)throw new RangeError("A list index must be positive, but you passed "+e);return e}function FC(e,t,n){const r={deleteAt(i,a){return e.splice(n,nr(i),a||1,[]),this},fill(i,a,o){let l=e.getObject(t);for(let c=nr(a||0);c<nr(o||l.length);c++)e.setListIndex(n,c,i);return this},indexOf(i,a=0){const o=i[ti];if(o){const l=e.getObject(t);for(let c=a;c<l.length;c++)if(l[c][ti]===o)return c;return-1}else return e.getObject(t).indexOf(i,a)},insertAt(i,...a){return e.splice(n,nr(i),0,a),this},pop(){let i=e.getObject(t);if(i.length==0)return;const a=e.getObjectField(n,t,i.length-1);return e.splice(n,i.length-1,1,[]),a},push(...i){let a=e.getObject(t);return e.splice(n,a.length,0,i),e.getObject(t).length},shift(){if(e.getObject(t).length==0)return;const a=e.getObjectField(n,t,0);return e.splice(n,0,1,[]),a},splice(i,a,...o){let l=e.getObject(t);i=nr(i),(a===void 0||a>l.length-i)&&(a=l.length-i);const c=[];for(let u=0;u<a;u++)c.push(e.getObjectField(n,t,i+u));return e.splice(n,i,a,o),c},unshift(...i){return e.splice(n,0,0,i),e.getObject(t).length}};for(let i of["entries","keys","values"]){let a=e.getObject(t);r[i]=()=>a[i]()}for(let i of["concat","every","filter","find","findIndex","forEach","includes","join","lastIndexOf","map","reduce","reduceRight","slice","some","toLocaleString","toString"])r[i]=(...a)=>e.getObject(t).map((l,c)=>e.getObjectField(n,t,c))[i](...a);return r}const HC={get(e,t){const{context:n,objectId:r,path:i}=e;return t===ti?r:t===Fc?n:t===UC?{actorId:n.actorId}:n.getObjectField(i,r,t)},set(e,t,n){const{context:r,path:i,readonly:a}=e;if(Array.isArray(a)&&a.indexOf(t)>=0)throw new RangeError(`Object property "${t}" cannot be modified`);return r.setMapKey(i,t,n),!0},deleteProperty(e,t){const{context:n,path:r,readonly:i}=e;if(Array.isArray(i)&&i.indexOf(t)>=0)throw new RangeError(`Object property "${t}" cannot be modified`);return n.deleteMapKey(r,t),!0},has(e,t){const{context:n,objectId:r}=e;return[ti,Fc].includes(t)||t in n.getObject(r)},getOwnPropertyDescriptor(e,t){const{context:n,objectId:r}=e,i=n.getObject(r);if(t in i)return{configurable:!0,enumerable:!0,value:n.getObjectField(r,t)}},ownKeys(e){const{context:t,objectId:n}=e;return Object.keys(t.getObject(n))}},qC={get(e,t){const[n,r,i]=e;return t===Symbol.iterator?n.getObject(r)[Symbol.iterator]:t===ti?r:t===Fc?n:t==="length"?n.getObject(r).length:typeof t=="string"&&/^[0-9]+$/.test(t)?n.getObjectField(i,r,nr(t)):FC(n,r,i)[t]},set(e,t,n){const[r,i,a]=e;if(t==="length"){if(typeof n!="number")throw new RangeError("Invalid array length");const o=r.getObject(i).length;o>n?r.splice(a,n,o-n,[]):r.splice(a,o,0,BC(n-o))}else r.setListIndex(a,nr(t),n);return!0},deleteProperty(e,t){const[n,,r]=e;return n.splice(r,nr(t),1,[]),!0},has(e,t){const[n,r]=e;return typeof t=="string"&&/^[0-9]+$/.test(t)?nr(t)<n.getObject(r).length:["length",ti,Fc].includes(t)},getOwnPropertyDescriptor(e,t){const[n,r]=e,i=n.getObject(r);if(t==="length")return{writable:!0,value:i.length};if(t===ti)return{configurable:!1,enumerable:!1,value:r};if(typeof t=="string"&&/^[0-9]+$/.test(t)){const a=nr(t);if(a<i.length)return{configurable:!0,enumerable:!0,value:n.getObjectField(r,a)}}},ownKeys(e){const[t,n]=e,r=t.getObject(n);let i=["length"];for(let a of Object.keys(r))i.push(a);return i}};function rb(e,t,n,r){return new Proxy({context:e,objectId:t,path:n,readonly:r},HC)}function zC(e,t,n){return new Proxy([e,t,n],qC)}function WC(e,t,n){const r=this.getObject(t);return Array.isArray(r)?zC(this,t,e):r instanceof VC||r instanceof $C?r.getWriteable(this,e):rb(this,t,e,n)}function GC(e){return e.instantiateObject=WC,rb(e,"_root",[])}var YC={rootObjectProxy:GC};let KC=class{constructor(t){if(!(Number.isInteger(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER))throw new RangeError(`Value ${t} cannot be a uint`);this.value=t,Object.freeze(this)}},JC=class{constructor(t){if(!(Number.isInteger(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=0))throw new RangeError(`Value ${t} cannot be a uint`);this.value=t,Object.freeze(this)}},QC=class{constructor(t){if(typeof t!="number")throw new RangeError(`Value ${t} cannot be a float64`);this.value=t||0,Object.freeze(this)}};var sb={Int:KC,Uint:JC,Float64:QC};const{CACHE:ZC,OBJECT_ID:Tl,CONFLICTS:Gs,ELEM_IDS:Og,STATE:XC}=Cs,{interpretPatch:ek}=nb,{Text:no}=pu,{Table:ro}=mu,{Counter:Yr,getWriteableCounter:tk}=bp,{Int:ld,Uint:cd,Float64:ud}=sb,{isObject:qa,parseOpId:Pg,createArrayOfNulls:nk}=hr,rk=vp;let sk=class{constructor(t,n,r){this.actorId=n,this.nextOpNum=t[XC].maxOp+1,this.cache=t[ZC],this.updated={},this.ops=[],this.applyPatch=r||ek}addOp(t){this.ops.push(t),t.action==="set"&&t.values?this.nextOpNum+=t.values.length:t.action==="del"&&t.multiOp?this.nextOpNum+=t.multiOp:this.nextOpNum+=1}nextOpId(){return`${this.nextOpNum}@${this.actorId}`}getValueDescription(t){if(!["object","boolean","number","string"].includes(typeof t))throw new TypeError(`Unsupported type of value: ${typeof t}`);if(qa(t)){if(t instanceof Date)return{type:"value",value:t.getTime(),datatype:"timestamp"};if(t instanceof ld)return{type:"value",value:t.value,datatype:"int"};if(t instanceof cd)return{type:"value",value:t.value,datatype:"uint"};if(t instanceof ud)return{type:"value",value:t.value,datatype:"float64"};if(t instanceof Yr)return{type:"value",value:t.value,datatype:"counter"};{const n=t[Tl],r=this.getObjectType(n);if(!n)throw new RangeError(`Object ${JSON.stringify(t)} has no objectId`);return r==="list"||r==="text"?{objectId:n,type:r,edits:[]}:{objectId:n,type:r,props:{}}}}else return typeof t=="number"?Number.isInteger(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER?{type:"value",value:t,datatype:"int"}:{type:"value",value:t,datatype:"float64"}:{type:"value",value:t}}getValuesDescriptions(t,n,r){if(n instanceof ro){const i=n.byId(r),a=n.opIds[r];return i?{[a]:this.getValueDescription(i)}:{}}else if(n instanceof no){const i=n.get(r),a=n.getElemId(r);return i?{[a]:this.getValueDescription(i)}:{}}else{const i=n[Gs][r],a={};if(!i)throw new RangeError(`No children at key ${r} of path ${JSON.stringify(t)}`);for(let o of Object.keys(i))a[o]=this.getValueDescription(i[o]);return a}}getPropertyValue(t,n,r){return t instanceof ro?t.byId(n):t instanceof no?t.get(n):t[Gs][n][r]}getSubpatch(t,n){if(n.length==0)return t;let r=t,i=this.getObject("_root");for(let a of n){let o=this.getValuesDescriptions(n,i,a.key);if(r.props)r.props[a.key]||(r.props[a.key]=o);else if(r.edits)for(const c of Object.keys(o))r.edits.push({action:"update",index:a.key,opId:c,value:o[c]});let l=null;for(let c of Object.keys(o))o[c].objectId===a.objectId&&(l=c);if(!l)throw new RangeError(`Cannot find path object with objectId ${a.objectId}`);r=o[l],i=this.getPropertyValue(i,a.key,l)}return r}getObject(t){const n=this.updated[t]||this.cache[t];if(!n)throw new RangeError(`Target object does not exist: ${t}`);return n}getObjectType(t){if(t==="_root")return"map";const n=this.getObject(t);return n instanceof no?"text":n instanceof ro?"table":Array.isArray(n)?"list":"map"}getObjectField(t,n,r){if(!["string","number"].includes(typeof r))return;const i=this.getObject(n);if(i[r]instanceof Yr)return tk(i[r].value,this,t,n,r);if(qa(i[r])){const a=i[r][Tl],o=t.concat([{key:r,objectId:a}]);return this.instantiateObject(o,a)}else return i[r]}createNestedObjects(t,n,r,i,a,o){if(r[Tl])throw new RangeError("Cannot create a reference to an existing document object");const l=this.nextOpId();if(r instanceof no){this.addOp(o?{action:"makeText",obj:t,elemId:o,insert:i,pred:a}:{action:"makeText",obj:t,key:n,insert:i,pred:a});const c={objectId:l,type:"text",edits:[]};return this.insertListItems(c,0,[...r],!0),c}else if(r instanceof ro){if(r.count>0)throw new RangeError("Assigning a non-empty Table object is not supported");return this.addOp(o?{action:"makeTable",obj:t,elemId:o,insert:i,pred:a}:{action:"makeTable",obj:t,key:n,insert:i,pred:a}),{objectId:l,type:"table",props:{}}}else if(Array.isArray(r)){this.addOp(o?{action:"makeList",obj:t,elemId:o,insert:i,pred:a}:{action:"makeList",obj:t,key:n,insert:i,pred:a});const c={objectId:l,type:"list",edits:[]};return this.insertListItems(c,0,r,!0),c}else{this.addOp(o?{action:"makeMap",obj:t,elemId:o,insert:i,pred:a}:{action:"makeMap",obj:t,key:n,insert:i,pred:a});let c={};for(let u of Object.keys(r).sort()){const d=this.nextOpId(),p=this.setValue(l,u,r[u],!1,[]);c[u]={[d]:p}}return{objectId:l,type:"map",props:c}}}setValue(t,n,r,i,a,o){if(!t)throw new RangeError("setValue needs an objectId");if(n==="")throw new RangeError("The key of a map entry must not be an empty string");if(qa(r)&&!(r instanceof Date)&&!(r instanceof Yr)&&!(r instanceof ld)&&!(r instanceof cd)&&!(r instanceof ud))return this.createNestedObjects(t,n,r,i,a,o);{const l=this.getValueDescription(r),c={action:"set",obj:t,insert:i,value:l.value,pred:a};return o?c.elemId=o:c.key=n,l.datatype&&(c.datatype=l.datatype),this.addOp(c),l}}applyAtPath(t,n){let r={objectId:"_root",type:"map",props:{}};n(this.getSubpatch(r,t)),this.applyPatch(r,this.cache._root,this.updated)}setMapKey(t,n,r){if(typeof n!="string")throw new RangeError(`The key of a map entry must be a string, not ${typeof n}`);const i=t.length===0?"_root":t[t.length-1].objectId,a=this.getObject(i);if(a[n]instanceof Yr)throw new RangeError("Cannot overwrite a Counter object; use .increment() or .decrement() to change its value.");(a[n]!==r||Object.keys(a[Gs][n]||{}).length>1||r===void 0)&&this.applyAtPath(t,o=>{const l=za(a,n),c=this.nextOpId(),u=this.setValue(i,n,r,!1,l);o.props[n]={[c]:u}})}deleteMapKey(t,n){const r=t.length===0?"_root":t[t.length-1].objectId,i=this.getObject(r);if(i[n]!==void 0){const a=za(i,n);this.addOp({action:"del",obj:r,key:n,insert:!1,pred:a}),this.applyAtPath(t,o=>{o.props[n]={}})}}insertListItems(t,n,r,i){const a=i?[]:this.getObject(t.objectId);if(n<0||n>a.length)throw new RangeError(`List index ${n} is out of bounds for list of length ${a.length}`);if(r.length===0)return;let o=Ol(a,n,!0);const l=r.every(d=>typeof d=="string"||typeof d=="number"||typeof d=="boolean"||d===null||qa(d)&&(d instanceof Date||d instanceof Yr||d instanceof ld||d instanceof cd||d instanceof ud)),c=l?r.map(d=>this.getValueDescription(d)):[],u=c.every(d=>d.datatype===c[0].datatype);if(l&&u&&r.length>1){const d=this.nextOpId(),p=c[0].datatype,h=c.map(b=>b.value),f={action:"set",obj:t.objectId,elemId:o,insert:!0,values:h,pred:[]},y={action:"multi-insert",elemId:d,index:n,values:h};p&&(f.datatype=p,y.datatype=p),this.addOp(f),t.edits.push(y)}else for(let d=0;d<r.length;d++){let p=this.nextOpId();const h=this.setValue(t.objectId,n+d,r[d],!0,[],o);o=p,t.edits.push({action:"insert",index:n+d,elemId:o,opId:o,value:h})}}setListIndex(t,n,r){const i=t.length===0?"_root":t[t.length-1].objectId,a=this.getObject(i);if(n>=a.length){const o=nk(n-a.length);return o.push(r),this.splice(t,a.length,0,o)}if(a[n]instanceof Yr)throw new RangeError("Cannot overwrite a Counter object; use .increment() or .decrement() to change its value.");(a[n]!==r||Object.keys(a[Gs][n]||{}).length>1||r===void 0)&&this.applyAtPath(t,o=>{const l=za(a,n),c=this.nextOpId(),u=this.setValue(i,n,r,!1,l,Ol(a,n));o.edits.push({action:"update",index:n,opId:c,value:u})})}splice(t,n,r,i){const a=t.length===0?"_root":t[t.length-1].objectId;let o=this.getObject(a);if(n<0||r<0||n>o.length-r)throw new RangeError(`${r} deletions starting at index ${n} are out of bounds for list of length ${o.length}`);if(r===0&&i.length===0)return;let l={diffs:{objectId:"_root",type:"map",props:{}}},c=this.getSubpatch(l.diffs,t);if(r>0){let u,d,p;for(let h=0;h<r;h++){if(this.getObjectField(t,a,n+h)instanceof Yr)throw new TypeError("Unsupported operation: deleting a counter from a list");const f=Ol(o,n+h),y=Pg(f),b=za(o,n+h),E=b.length===1?Pg(b[0]):void 0;u&&d&&p&&E&&d.actorId===y.actorId&&d.counter+1===y.counter&&p.actorId===E.actorId&&p.counter+1===E.counter?u.multiOp=(u.multiOp||1)+1:(u&&this.addOp(u),u={action:"del",obj:a,elemId:f,insert:!1,pred:b}),d=y,p=E}this.addOp(u),c.edits.push({action:"remove",index:n,count:r})}i.length>0&&this.insertListItems(c,n,i,!1),this.applyPatch(l.diffs,this.cache._root,this.updated)}addTableRow(t,n){if(!qa(n)||Array.isArray(n))throw new TypeError("A table row must be an object");if(n[Tl])throw new TypeError("Cannot reuse an existing object as table row");if(n.id)throw new TypeError('A table row must not have an "id" property; it is generated automatically');const r=rk(),i=this.setValue(t[t.length-1].objectId,r,n,!1,[]);return this.applyAtPath(t,a=>{a.props[r]={[i.objectId]:i}}),r}deleteTableRow(t,n,r){const i=t[t.length-1].objectId;this.getObject(i).byId(n)&&(this.addOp({action:"del",obj:i,key:n,insert:!1,pred:[r]}),this.applyAtPath(t,o=>{o.props[n]={}}))}increment(t,n,r){const i=t.length===0?"_root":t[t.length-1].objectId,a=this.getObject(i);if(!(a[n]instanceof Yr))throw new TypeError("Only counter values can be incremented");const o=this.getObjectType(i),l=a[n].value+r,c=this.nextOpId(),u=za(a,n);if(o==="list"||o==="text"){const d=Ol(a,n,!1);this.addOp({action:"inc",obj:i,elemId:d,value:r,insert:!1,pred:u})}else this.addOp({action:"inc",obj:i,key:n,value:r,insert:!1,pred:u});this.applyAtPath(t,d=>{o==="list"||o==="text"?d.edits.push({action:"update",index:n,opId:c,value:{value:l,datatype:"counter"}}):d.props[n]={[c]:{value:l,datatype:"counter"}}})}};function za(e,t){return e instanceof ro?[e.opIds[t]]:e instanceof no?e.elems[t].pred:e[Gs]?e[Gs][t]?Object.keys(e[Gs][t]):[]:[]}function Ol(e,t,n=!1){if(n){if(t===0)return"_head";t-=1}if(e[Og])return e[Og][t];if(e.getElemId)return e.getElemId(t);throw new RangeError(`Cannot find elemId at list index ${t}`)}var ik={Context:sk};const{OBJECT_ID:ak,CONFLICTS:$t}=Cs;let ok=class{constructor(){this.observers={}}patchCallback(t,n,r,i,a){this._objectUpdate(t.diffs,n,r,i,a)}_objectUpdate(t,n,r,i,a){if(t.objectId){if(this.observers[t.objectId])for(let o of this.observers[t.objectId])o(t,n,r,i,a);if(t.type==="map"&&t.props)for(const o of Object.keys(t.props))for(const l of Object.keys(t.props[o]))this._objectUpdate(t.props[o][l],n&&n[$t]&&n[$t][o]&&n[$t][o][l],r&&r[$t]&&r[$t][o]&&r[$t][o][l],i,a);else if(t.type==="table"&&t.props)for(const o of Object.keys(t.props))for(const l of Object.keys(t.props[o]))this._objectUpdate(t.props[o][l],n&&n.byId(o),r&&r.byId(o),i,a);else if(t.type==="list"&&t.edits){let o=0;for(const l of t.edits)l.action==="insert"?(o-=1,this._objectUpdate(l.value,void 0,r&&r[$t]&&r[$t][l.index]&&r[$t][l.index][l.elemId],i,a)):l.action==="multi-insert"?o-=l.values.length:l.action==="update"?this._objectUpdate(l.value,n&&n[$t]&&n[$t][l.index+o]&&n[$t][l.index+o][l.opId],r&&r[$t]&&r[$t][l.index]&&r[$t][l.index][l.opId],i,a):l.action==="remove"&&(o+=l.count)}else if(t.type==="text"&&t.edits){let o=0;for(const l of t.edits)l.action==="insert"?(o-=1,this._objectUpdate(l.value,void 0,r&&r.get(l.index),i,a)):l.action==="multi-insert"?o-=l.values.length:l.action==="update"?this._objectUpdate(l.value,n&&n.get(l.index+o),r&&r.get(l.index),i,a):l.action==="remove"&&(o+=l.count)}}}observe(t,n){const r=t[ak];if(!r)throw new TypeError("The observed object must be part of an Automerge document");this.observers[r]||(this.observers[r]=[]),this.observers[r].push(n)}};var lk={Observable:ok};const{OPTIONS:sr,CACHE:zi,STATE:lr,OBJECT_ID:Sa,CONFLICTS:Wi,CHANGE:ib,ELEM_IDS:ck}=Cs,{isObject:wp,copyObject:Ph}=hr,uk=vp,{interpretPatch:dk,cloneRootObject:hk}=nb,{rootObjectProxy:fk}=YC,{Context:ab}=ik,{Text:Sp}=pu,{Table:ob}=mu,{Counter:pk}=bp,{Float64:mk,Int:gk,Uint:yk}=sb,{Observable:vk}=lk;function lb(e){if(typeof e!="string")throw new TypeError(`Unsupported type of actorId: ${typeof e}`);if(!/^[0-9a-f]+$/.test(e))throw new RangeError("actorId must consist only of lowercase hex digits");if(e.length%2!==0)throw new RangeError("actorId must consist of an even number of digits")}function gu(e,t,n){let r=t._root;if(r||(r=hk(e[zi]._root),t._root=r),Object.defineProperty(r,sr,{value:e[sr]}),Object.defineProperty(r,zi,{value:t}),Object.defineProperty(r,lr,{value:n}),e[sr].freeze)for(let i of Object.keys(t))t[i]instanceof ob?t[i]._freeze():t[i]instanceof Sp?(Object.freeze(t[i].elems),Object.freeze(t[i])):(Object.freeze(t[i]),Object.freeze(t[i][Wi]));for(let i of Object.keys(e[zi]))t[i]||(t[i]=e[zi][i]);return e[sr].freeze&&Object.freeze(t),r}function cb(e,t,n){const r=Ea(e);if(!r)throw new Error("Actor ID must be initialized with setActorId() before making a change");const i=Ph(e[lr]);i.seq+=1;const a={actor:r,seq:i.seq,startOp:i.maxOp+1,deps:i.deps,time:n&&typeof n.time=="number"?n.time:Math.round(new Date().getTime()/1e3),message:n&&typeof n.message=="string"?n.message:"",ops:t.ops};if(e[sr].backend){const[o,l,c]=e[sr].backend.applyLocalChange(i.backendState,a);i.backendState=o,i.lastLocalChange=c;const u=Lh(e,l,i),d=n&&n.patchCallback||e[sr].patchCallback;return d&&d(l,e,u,!0,[c]),[u,a]}else{const o={actor:r,seq:a.seq,before:e};return i.requests=i.requests.concat([o]),i.maxOp=i.maxOp+xk(a.ops),i.deps=[],[gu(e,t?t.updated:{},i),a]}}function xk(e){let t=0;for(const n of e)n.action==="set"&&n.values?t+=n.values.length:t+=1;return t}function jk(e){return e[lr]&&e[lr].lastLocalChange?e[lr].lastLocalChange:null}function Lh(e,t,n,r){const i=Ea(e),a={};dk(t.diffs,e,a);{if(!t.clock)throw new RangeError("patch is missing clock field");t.clock[i]&&t.clock[i]>n.seq&&(n.seq=t.clock[i]),n.clock=t.clock,n.deps=t.deps,n.maxOp=Math.max(n.maxOp,t.maxOp)}return gu(e,a,n)}function ub(e){if(typeof e=="string")e={actorId:e};else if(typeof e>"u")e={};else if(!wp(e))throw new TypeError(`Unsupported value for init() options: ${e}`);if(e.deferActorId||(e.actorId===void 0&&(e.actorId=uk()),lb(e.actorId)),e.observable){const i=e.patchCallback,a=e.observable;e.patchCallback=(o,l,c,u,d)=>{i&&i(o,l,c,u,d),a.patchCallback(o,l,c,u,d)}}const t={},n={_root:t},r={seq:0,maxOp:0,requests:[],clock:{},deps:[]};return e.backend&&(r.backendState=e.backend.init(),r.lastLocalChange=null),Object.defineProperty(t,Sa,{value:"_root"}),Object.defineProperty(t,sr,{value:Object.freeze(e)}),Object.defineProperty(t,Wi,{value:Object.freeze({})}),Object.defineProperty(t,zi,{value:Object.freeze(n)}),Object.defineProperty(t,lr,{value:Object.freeze(r)}),Object.freeze(t)}function bk(e,t){return db(ub(t),"Initialization",n=>Object.assign(n,e))}function db(e,t,n){if(e[Sa]!=="_root")throw new TypeError("The first argument to Automerge.change must be the document root");if(e[ib])throw new TypeError("Calls to Automerge.change cannot be nested");if(typeof t=="function"&&n===void 0&&([t,n]=[n,t]),typeof t=="string"&&(t={message:t}),t!==void 0&&!wp(t))throw new TypeError("Unsupported type of options");const r=Ea(e);if(!r)throw new Error("Actor ID must be initialized with setActorId() before making a change");const i=new ab(e,r);return n(fk(i)),Object.keys(i.updated).length===0?[e,null]:cb(e,i,t)}function wk(e,t){if(e[Sa]!=="_root")throw new TypeError("The first argument to Automerge.emptyChange must be the document root");if(typeof t=="string"&&(t={message:t}),t!==void 0&&!wp(t))throw new TypeError("Unsupported type of options");const n=Ea(e);if(!n)throw new Error("Actor ID must be initialized with setActorId() before making a change");return cb(e,new ab(e,n),t)}function Sk(e,t,n=void 0){if(e[Sa]!=="_root")throw new TypeError("The first argument to Frontend.applyPatch must be the document root");const r=Ph(e[lr]);if(e[sr].backend){if(!n)throw new RangeError("applyPatch must be called with the updated backend state");return r.backendState=n,Lh(e,t,r)}let i;if(r.requests.length>0)if(i=r.requests[0].before,t.actor===Ea(e)){if(r.requests[0].seq!==t.seq)throw new RangeError(`Mismatched sequence number: patch ${t.seq} does not match next request ${r.requests[0].seq}`);r.requests=r.requests.slice(1)}else r.requests=r.requests.slice();else i=e,r.requests=[];let a=Lh(i,t,r);return r.requests.length===0?a:(r.requests[0]=Ph(r.requests[0]),r.requests[0].before=a,gu(e,{},r))}function Ek(e){return e[Sa]}function Nk(e,t){if(e[ib])throw new TypeError("Cannot use getObjectById in a change callback");return e[zi][t]}function Ea(e){return e[lr].actorId||e[sr].actorId}function _k(e,t){lb(t);const n=Object.assign({},e[lr],{actorId:t});return gu(e,{},n)}function Ak(e,t){if(e[Wi]&&e[Wi][t]&&Object.keys(e[Wi][t]).length>1)return e[Wi][t]}function Ck(e,t=null,n="first"){if(e[Sa]!=="_root"){const r=Array.isArray(e)?". Note: Automerge.applyChanges now returns an array.":"";throw t?new TypeError(`The ${n} argument to Automerge.${t} must be the document root${r}`):new TypeError(`Argument is not an Automerge document root${r}`)}return e[lr].backendState}function kk(e){return e instanceof Sp?e.elems.map(t=>t.elemId):e[ck]}var Ik={init:ub,from:bk,change:db,emptyChange:wk,applyPatch:Sk,getObjectId:Ek,getObjectById:Nk,getActorId:Ea,setActorId:_k,getConflicts:Ak,getLastLocalChange:jk,getBackendState:Ck,getElementIds:kk,Text:Sp,Table:ob,Counter:pk,Observable:vk,Float64:mk,Int:gk,Uint:yk},fr={},Na={},pr={},_a={};const Rk=4,Lg=0,Dg=1,Tk=2;function Aa(e){let t=e.length;for(;--t>=0;)e[t]=0}const Ok=0,hb=1,Pk=2,Lk=3,Dk=258,Ep=29,rl=256,Fo=rl+1+Ep,ea=30,Np=19,fb=2*Fo+1,Ys=15,dd=16,Mk=7,_p=256,pb=16,mb=17,gb=18,Dh=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),oc=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),Uk=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),yb=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Bk=512,Cr=new Array((Fo+2)*2);Aa(Cr);const yo=new Array(ea*2);Aa(yo);const Ho=new Array(Bk);Aa(Ho);const qo=new Array(Dk-Lk+1);Aa(qo);const Ap=new Array(Ep);Aa(Ap);const Hc=new Array(ea);Aa(Hc);function hd(e,t,n,r,i){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=r,this.max_length=i,this.has_stree=e&&e.length}let vb,xb,jb;function fd(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}const bb=e=>e<256?Ho[e]:Ho[256+(e>>>7)],zo=(e,t)=>{e.pending_buf[e.pending++]=t&255,e.pending_buf[e.pending++]=t>>>8&255},Jt=(e,t,n)=>{e.bi_valid>dd-n?(e.bi_buf|=t<<e.bi_valid&65535,zo(e,e.bi_buf),e.bi_buf=t>>dd-e.bi_valid,e.bi_valid+=n-dd):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)},rr=(e,t,n)=>{Jt(e,n[t*2],n[t*2+1])},wb=(e,t)=>{let n=0;do n|=e&1,e>>>=1,n<<=1;while(--t>0);return n>>>1},Vk=e=>{e.bi_valid===16?(zo(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=e.bi_buf&255,e.bi_buf>>=8,e.bi_valid-=8)},$k=(e,t)=>{const n=t.dyn_tree,r=t.max_code,i=t.stat_desc.static_tree,a=t.stat_desc.has_stree,o=t.stat_desc.extra_bits,l=t.stat_desc.extra_base,c=t.stat_desc.max_length;let u,d,p,h,f,y,b=0;for(h=0;h<=Ys;h++)e.bl_count[h]=0;for(n[e.heap[e.heap_max]*2+1]=0,u=e.heap_max+1;u<fb;u++)d=e.heap[u],h=n[n[d*2+1]*2+1]+1,h>c&&(h=c,b++),n[d*2+1]=h,!(d>r)&&(e.bl_count[h]++,f=0,d>=l&&(f=o[d-l]),y=n[d*2],e.opt_len+=y*(h+f),a&&(e.static_len+=y*(i[d*2+1]+f)));if(b!==0){do{for(h=c-1;e.bl_count[h]===0;)h--;e.bl_count[h]--,e.bl_count[h+1]+=2,e.bl_count[c]--,b-=2}while(b>0);for(h=c;h!==0;h--)for(d=e.bl_count[h];d!==0;)p=e.heap[--u],!(p>r)&&(n[p*2+1]!==h&&(e.opt_len+=(h-n[p*2+1])*n[p*2],n[p*2+1]=h),d--)}},Sb=(e,t,n)=>{const r=new Array(Ys+1);let i=0,a,o;for(a=1;a<=Ys;a++)i=i+n[a-1]<<1,r[a]=i;for(o=0;o<=t;o++){let l=e[o*2+1];l!==0&&(e[o*2]=wb(r[l]++,l))}},Fk=()=>{let e,t,n,r,i;const a=new Array(Ys+1);for(n=0,r=0;r<Ep-1;r++)for(Ap[r]=n,e=0;e<1<<Dh[r];e++)qo[n++]=r;for(qo[n-1]=r,i=0,r=0;r<16;r++)for(Hc[r]=i,e=0;e<1<<oc[r];e++)Ho[i++]=r;for(i>>=7;r<ea;r++)for(Hc[r]=i<<7,e=0;e<1<<oc[r]-7;e++)Ho[256+i++]=r;for(t=0;t<=Ys;t++)a[t]=0;for(e=0;e<=143;)Cr[e*2+1]=8,e++,a[8]++;for(;e<=255;)Cr[e*2+1]=9,e++,a[9]++;for(;e<=279;)Cr[e*2+1]=7,e++,a[7]++;for(;e<=287;)Cr[e*2+1]=8,e++,a[8]++;for(Sb(Cr,Fo+1,a),e=0;e<ea;e++)yo[e*2+1]=5,yo[e*2]=wb(e,5);vb=new hd(Cr,Dh,rl+1,Fo,Ys),xb=new hd(yo,oc,0,ea,Ys),jb=new hd(new Array(0),Uk,0,Np,Mk)},Eb=e=>{let t;for(t=0;t<Fo;t++)e.dyn_ltree[t*2]=0;for(t=0;t<ea;t++)e.dyn_dtree[t*2]=0;for(t=0;t<Np;t++)e.bl_tree[t*2]=0;e.dyn_ltree[_p*2]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},Nb=e=>{e.bi_valid>8?zo(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},Mg=(e,t,n,r)=>{const i=t*2,a=n*2;return e[i]<e[a]||e[i]===e[a]&&r[t]<=r[n]},pd=(e,t,n)=>{const r=e.heap[n];let i=n<<1;for(;i<=e.heap_len&&(i<e.heap_len&&Mg(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!Mg(t,r,e.heap[i],e.depth));)e.heap[n]=e.heap[i],n=i,i<<=1;e.heap[n]=r},Ug=(e,t,n)=>{let r,i,a=0,o,l;if(e.sym_next!==0)do r=e.pending_buf[e.sym_buf+a++]&255,r+=(e.pending_buf[e.sym_buf+a++]&255)<<8,i=e.pending_buf[e.sym_buf+a++],r===0?rr(e,i,t):(o=qo[i],rr(e,o+rl+1,t),l=Dh[o],l!==0&&(i-=Ap[o],Jt(e,i,l)),r--,o=bb(r),rr(e,o,n),l=oc[o],l!==0&&(r-=Hc[o],Jt(e,r,l)));while(a<e.sym_next);rr(e,_p,t)},Mh=(e,t)=>{const n=t.dyn_tree,r=t.stat_desc.static_tree,i=t.stat_desc.has_stree,a=t.stat_desc.elems;let o,l,c=-1,u;for(e.heap_len=0,e.heap_max=fb,o=0;o<a;o++)n[o*2]!==0?(e.heap[++e.heap_len]=c=o,e.depth[o]=0):n[o*2+1]=0;for(;e.heap_len<2;)u=e.heap[++e.heap_len]=c<2?++c:0,n[u*2]=1,e.depth[u]=0,e.opt_len--,i&&(e.static_len-=r[u*2+1]);for(t.max_code=c,o=e.heap_len>>1;o>=1;o--)pd(e,n,o);u=a;do o=e.heap[1],e.heap[1]=e.heap[e.heap_len--],pd(e,n,1),l=e.heap[1],e.heap[--e.heap_max]=o,e.heap[--e.heap_max]=l,n[u*2]=n[o*2]+n[l*2],e.depth[u]=(e.depth[o]>=e.depth[l]?e.depth[o]:e.depth[l])+1,n[o*2+1]=n[l*2+1]=u,e.heap[1]=u++,pd(e,n,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],$k(e,t),Sb(n,c,e.bl_count)},Bg=(e,t,n)=>{let r,i=-1,a,o=t[0*2+1],l=0,c=7,u=4;for(o===0&&(c=138,u=3),t[(n+1)*2+1]=65535,r=0;r<=n;r++)a=o,o=t[(r+1)*2+1],!(++l<c&&a===o)&&(l<u?e.bl_tree[a*2]+=l:a!==0?(a!==i&&e.bl_tree[a*2]++,e.bl_tree[pb*2]++):l<=10?e.bl_tree[mb*2]++:e.bl_tree[gb*2]++,l=0,i=a,o===0?(c=138,u=3):a===o?(c=6,u=3):(c=7,u=4))},Vg=(e,t,n)=>{let r,i=-1,a,o=t[0*2+1],l=0,c=7,u=4;for(o===0&&(c=138,u=3),r=0;r<=n;r++)if(a=o,o=t[(r+1)*2+1],!(++l<c&&a===o)){if(l<u)do rr(e,a,e.bl_tree);while(--l!==0);else a!==0?(a!==i&&(rr(e,a,e.bl_tree),l--),rr(e,pb,e.bl_tree),Jt(e,l-3,2)):l<=10?(rr(e,mb,e.bl_tree),Jt(e,l-3,3)):(rr(e,gb,e.bl_tree),Jt(e,l-11,7));l=0,i=a,o===0?(c=138,u=3):a===o?(c=6,u=3):(c=7,u=4)}},Hk=e=>{let t;for(Bg(e,e.dyn_ltree,e.l_desc.max_code),Bg(e,e.dyn_dtree,e.d_desc.max_code),Mh(e,e.bl_desc),t=Np-1;t>=3&&e.bl_tree[yb[t]*2+1]===0;t--);return e.opt_len+=3*(t+1)+5+5+4,t},qk=(e,t,n,r)=>{let i;for(Jt(e,t-257,5),Jt(e,n-1,5),Jt(e,r-4,4),i=0;i<r;i++)Jt(e,e.bl_tree[yb[i]*2+1],3);Vg(e,e.dyn_ltree,t-1),Vg(e,e.dyn_dtree,n-1)},zk=e=>{let t=4093624447,n;for(n=0;n<=31;n++,t>>>=1)if(t&1&&e.dyn_ltree[n*2]!==0)return Lg;if(e.dyn_ltree[9*2]!==0||e.dyn_ltree[10*2]!==0||e.dyn_ltree[13*2]!==0)return Dg;for(n=32;n<rl;n++)if(e.dyn_ltree[n*2]!==0)return Dg;return Lg};let $g=!1;const Wk=e=>{$g||(Fk(),$g=!0),e.l_desc=new fd(e.dyn_ltree,vb),e.d_desc=new fd(e.dyn_dtree,xb),e.bl_desc=new fd(e.bl_tree,jb),e.bi_buf=0,e.bi_valid=0,Eb(e)},_b=(e,t,n,r)=>{Jt(e,(Ok<<1)+(r?1:0),3),Nb(e),zo(e,n),zo(e,~n),n&&e.pending_buf.set(e.window.subarray(t,t+n),e.pending),e.pending+=n},Gk=e=>{Jt(e,hb<<1,3),rr(e,_p,Cr),Vk(e)},Yk=(e,t,n,r)=>{let i,a,o=0;e.level>0?(e.strm.data_type===Tk&&(e.strm.data_type=zk(e)),Mh(e,e.l_desc),Mh(e,e.d_desc),o=Hk(e),i=e.opt_len+3+7>>>3,a=e.static_len+3+7>>>3,a<=i&&(i=a)):i=a=n+5,n+4<=i&&t!==-1?_b(e,t,n,r):e.strategy===Rk||a===i?(Jt(e,(hb<<1)+(r?1:0),3),Ug(e,Cr,yo)):(Jt(e,(Pk<<1)+(r?1:0),3),qk(e,e.l_desc.max_code+1,e.d_desc.max_code+1,o+1),Ug(e,e.dyn_ltree,e.dyn_dtree)),Eb(e),r&&Nb(e)},Kk=(e,t,n)=>(e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=n,t===0?e.dyn_ltree[n*2]++:(e.matches++,t--,e.dyn_ltree[(qo[n]+rl+1)*2]++,e.dyn_dtree[bb(t)*2]++),e.sym_next===e.sym_end);_a._tr_init=Wk;_a._tr_stored_block=_b;_a._tr_flush_block=Yk;_a._tr_tally=Kk;_a._tr_align=Gk;const Jk=(e,t,n,r)=>{let i=e&65535|0,a=e>>>16&65535|0,o=0;for(;n!==0;){o=n>2e3?2e3:n,n-=o;do i=i+t[r++]|0,a=a+i|0;while(--o);i%=65521,a%=65521}return i|a<<16|0};var Ab=Jk;const Qk=()=>{let e,t=[];for(var n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=e&1?3988292384^e>>>1:e>>>1;t[n]=e}return t},Zk=new Uint32Array(Qk()),Xk=(e,t,n,r)=>{const i=Zk,a=r+n;e^=-1;for(let o=r;o<a;o++)e=e>>>8^i[(e^t[o])&255];return e^-1};var Cb=Xk,Cp={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},pi={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:eI,_tr_stored_block:Uh,_tr_flush_block:tI,_tr_tally:vs,_tr_align:nI}=_a,kb=Ab,Kr=Cb,rI=Cp,{Z_NO_FLUSH:xs,Z_PARTIAL_FLUSH:sI,Z_FULL_FLUSH:iI,Z_FINISH:wn,Z_BLOCK:Fg,Z_OK:Ct,Z_STREAM_END:Hg,Z_STREAM_ERROR:cr,Z_DATA_ERROR:aI,Z_BUF_ERROR:md,Z_DEFAULT_COMPRESSION:oI,Z_FILTERED:lI,Z_HUFFMAN_ONLY:Pl,Z_RLE:cI,Z_FIXED:uI,Z_DEFAULT_STRATEGY:dI,Z_UNKNOWN:hI,Z_DEFLATED:yu}=pi,fI=9,pI=15,mI=8,gI=29,yI=256,Bh=yI+1+gI,vI=30,xI=19,jI=2*Bh+1,bI=15,De=3,os=258,ur=os+De+1,wI=32,ha=42,kp=57,Vh=69,$h=73,Fh=91,Hh=103,Ks=113,so=666,Ht=1,Ca=2,ci=3,ka=4,SI=3,Js=(e,t)=>(e.msg=rI[t],t),qg=e=>e*2-(e>4?9:0),es=e=>{let t=e.length;for(;--t>=0;)e[t]=0},EI=e=>{let t,n,r,i=e.w_size;t=e.hash_size,r=t;do n=e.head[--r],e.head[r]=n>=i?n-i:0;while(--t);t=i,r=t;do n=e.prev[--r],e.prev[r]=n>=i?n-i:0;while(--t)};let NI=(e,t,n)=>(t<<e.hash_shift^n)&e.hash_mask,js=NI;const sn=e=>{const t=e.state;let n=t.pending;n>e.avail_out&&(n=e.avail_out),n!==0&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+n),e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,t.pending===0&&(t.pending_out=0))},ln=(e,t)=>{tI(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,sn(e.strm)},Fe=(e,t)=>{e.pending_buf[e.pending++]=t},Wa=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=t&255},qh=(e,t,n,r)=>{let i=e.avail_in;return i>r&&(i=r),i===0?0:(e.avail_in-=i,t.set(e.input.subarray(e.next_in,e.next_in+i),n),e.state.wrap===1?e.adler=kb(e.adler,t,i,n):e.state.wrap===2&&(e.adler=Kr(e.adler,t,i,n)),e.next_in+=i,e.total_in+=i,i)},Ib=(e,t)=>{let n=e.max_chain_length,r=e.strstart,i,a,o=e.prev_length,l=e.nice_match;const c=e.strstart>e.w_size-ur?e.strstart-(e.w_size-ur):0,u=e.window,d=e.w_mask,p=e.prev,h=e.strstart+os;let f=u[r+o-1],y=u[r+o];e.prev_length>=e.good_match&&(n>>=2),l>e.lookahead&&(l=e.lookahead);do if(i=t,!(u[i+o]!==y||u[i+o-1]!==f||u[i]!==u[r]||u[++i]!==u[r+1])){r+=2,i++;do;while(u[++r]===u[++i]&&u[++r]===u[++i]&&u[++r]===u[++i]&&u[++r]===u[++i]&&u[++r]===u[++i]&&u[++r]===u[++i]&&u[++r]===u[++i]&&u[++r]===u[++i]&&r<h);if(a=os-(h-r),r=h-os,a>o){if(e.match_start=t,o=a,a>=l)break;f=u[r+o-1],y=u[r+o]}}while((t=p[t&d])>c&&--n!==0);return o<=e.lookahead?o:e.lookahead},fa=e=>{const t=e.w_size;let n,r,i;do{if(r=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-ur)&&(e.window.set(e.window.subarray(t,t+t-r),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,e.insert>e.strstart&&(e.insert=e.strstart),EI(e),r+=t),e.strm.avail_in===0)break;if(n=qh(e.strm,e.window,e.strstart+e.lookahead,r),e.lookahead+=n,e.lookahead+e.insert>=De)for(i=e.strstart-e.insert,e.ins_h=e.window[i],e.ins_h=js(e,e.ins_h,e.window[i+1]);e.insert&&(e.ins_h=js(e,e.ins_h,e.window[i+De-1]),e.prev[i&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=i,i++,e.insert--,!(e.lookahead+e.insert<De)););}while(e.lookahead<ur&&e.strm.avail_in!==0)},Rb=(e,t)=>{let n=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,r,i,a,o=0,l=e.strm.avail_in;do{if(r=65535,a=e.bi_valid+42>>3,e.strm.avail_out<a||(a=e.strm.avail_out-a,i=e.strstart-e.block_start,r>i+e.strm.avail_in&&(r=i+e.strm.avail_in),r>a&&(r=a),r<n&&(r===0&&t!==wn||t===xs||r!==i+e.strm.avail_in)))break;o=t===wn&&r===i+e.strm.avail_in?1:0,Uh(e,0,0,o),e.pending_buf[e.pending-4]=r,e.pending_buf[e.pending-3]=r>>8,e.pending_buf[e.pending-2]=~r,e.pending_buf[e.pending-1]=~r>>8,sn(e.strm),i&&(i>r&&(i=r),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+i),e.strm.next_out),e.strm.next_out+=i,e.strm.avail_out-=i,e.strm.total_out+=i,e.block_start+=i,r-=i),r&&(qh(e.strm,e.strm.output,e.strm.next_out,r),e.strm.next_out+=r,e.strm.avail_out-=r,e.strm.total_out+=r)}while(o===0);return l-=e.strm.avail_in,l&&(l>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=l&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-l,e.strm.next_in),e.strstart),e.strstart+=l,e.insert+=l>e.w_size-e.insert?e.w_size-e.insert:l),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),o?ka:t!==xs&&t!==wn&&e.strm.avail_in===0&&e.strstart===e.block_start?Ca:(a=e.window_size-e.strstart,e.strm.avail_in>a&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,a+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),a>e.strm.avail_in&&(a=e.strm.avail_in),a&&(qh(e.strm,e.window,e.strstart,a),e.strstart+=a,e.insert+=a>e.w_size-e.insert?e.w_size-e.insert:a),e.high_water<e.strstart&&(e.high_water=e.strstart),a=e.bi_valid+42>>3,a=e.pending_buf_size-a>65535?65535:e.pending_buf_size-a,n=a>e.w_size?e.w_size:a,i=e.strstart-e.block_start,(i>=n||(i||t===wn)&&t!==xs&&e.strm.avail_in===0&&i<=a)&&(r=i>a?a:i,o=t===wn&&e.strm.avail_in===0&&r===i?1:0,Uh(e,e.block_start,r,o),e.block_start+=r,sn(e.strm)),o?ci:Ht)},gd=(e,t)=>{let n,r;for(;;){if(e.lookahead<ur){if(fa(e),e.lookahead<ur&&t===xs)return Ht;if(e.lookahead===0)break}if(n=0,e.lookahead>=De&&(e.ins_h=js(e,e.ins_h,e.window[e.strstart+De-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),n!==0&&e.strstart-n<=e.w_size-ur&&(e.match_length=Ib(e,n)),e.match_length>=De)if(r=vs(e,e.strstart-e.match_start,e.match_length-De),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=De){e.match_length--;do e.strstart++,e.ins_h=js(e,e.ins_h,e.window[e.strstart+De-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(--e.match_length!==0);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=js(e,e.ins_h,e.window[e.strstart+1]);else r=vs(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(r&&(ln(e,!1),e.strm.avail_out===0))return Ht}return e.insert=e.strstart<De-1?e.strstart:De-1,t===wn?(ln(e,!0),e.strm.avail_out===0?ci:ka):e.sym_next&&(ln(e,!1),e.strm.avail_out===0)?Ht:Ca},Ii=(e,t)=>{let n,r,i;for(;;){if(e.lookahead<ur){if(fa(e),e.lookahead<ur&&t===xs)return Ht;if(e.lookahead===0)break}if(n=0,e.lookahead>=De&&(e.ins_h=js(e,e.ins_h,e.window[e.strstart+De-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=De-1,n!==0&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-ur&&(e.match_length=Ib(e,n),e.match_length<=5&&(e.strategy===lI||e.match_length===De&&e.strstart-e.match_start>4096)&&(e.match_length=De-1)),e.prev_length>=De&&e.match_length<=e.prev_length){i=e.strstart+e.lookahead-De,r=vs(e,e.strstart-1-e.prev_match,e.prev_length-De),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=i&&(e.ins_h=js(e,e.ins_h,e.window[e.strstart+De-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(--e.prev_length!==0);if(e.match_available=0,e.match_length=De-1,e.strstart++,r&&(ln(e,!1),e.strm.avail_out===0))return Ht}else if(e.match_available){if(r=vs(e,0,e.window[e.strstart-1]),r&&ln(e,!1),e.strstart++,e.lookahead--,e.strm.avail_out===0)return Ht}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(r=vs(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<De-1?e.strstart:De-1,t===wn?(ln(e,!0),e.strm.avail_out===0?ci:ka):e.sym_next&&(ln(e,!1),e.strm.avail_out===0)?Ht:Ca},_I=(e,t)=>{let n,r,i,a;const o=e.window;for(;;){if(e.lookahead<=os){if(fa(e),e.lookahead<=os&&t===xs)return Ht;if(e.lookahead===0)break}if(e.match_length=0,e.lookahead>=De&&e.strstart>0&&(i=e.strstart-1,r=o[i],r===o[++i]&&r===o[++i]&&r===o[++i])){a=e.strstart+os;do;while(r===o[++i]&&r===o[++i]&&r===o[++i]&&r===o[++i]&&r===o[++i]&&r===o[++i]&&r===o[++i]&&r===o[++i]&&i<a);e.match_length=os-(a-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=De?(n=vs(e,1,e.match_length-De),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=vs(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(ln(e,!1),e.strm.avail_out===0))return Ht}return e.insert=0,t===wn?(ln(e,!0),e.strm.avail_out===0?ci:ka):e.sym_next&&(ln(e,!1),e.strm.avail_out===0)?Ht:Ca},AI=(e,t)=>{let n;for(;;){if(e.lookahead===0&&(fa(e),e.lookahead===0)){if(t===xs)return Ht;break}if(e.match_length=0,n=vs(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(ln(e,!1),e.strm.avail_out===0))return Ht}return e.insert=0,t===wn?(ln(e,!0),e.strm.avail_out===0?ci:ka):e.sym_next&&(ln(e,!1),e.strm.avail_out===0)?Ht:Ca};function Zn(e,t,n,r,i){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=r,this.func=i}const io=[new Zn(0,0,0,0,Rb),new Zn(4,4,8,4,gd),new Zn(4,5,16,8,gd),new Zn(4,6,32,32,gd),new Zn(4,4,16,16,Ii),new Zn(8,16,32,32,Ii),new Zn(8,16,128,128,Ii),new Zn(8,32,128,256,Ii),new Zn(32,128,258,1024,Ii),new Zn(32,258,258,4096,Ii)],CI=e=>{e.window_size=2*e.w_size,es(e.head),e.max_lazy_match=io[e.level].max_lazy,e.good_match=io[e.level].good_length,e.nice_match=io[e.level].nice_length,e.max_chain_length=io[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=De-1,e.match_available=0,e.ins_h=0};function kI(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=yu,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(jI*2),this.dyn_dtree=new Uint16Array((2*vI+1)*2),this.bl_tree=new Uint16Array((2*xI+1)*2),es(this.dyn_ltree),es(this.dyn_dtree),es(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(bI+1),this.heap=new Uint16Array(2*Bh+1),es(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*Bh+1),es(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const sl=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.status!==ha&&t.status!==kp&&t.status!==Vh&&t.status!==$h&&t.status!==Fh&&t.status!==Hh&&t.status!==Ks&&t.status!==so?1:0},Tb=e=>{if(sl(e))return Js(e,cr);e.total_in=e.total_out=0,e.data_type=hI;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap===2?kp:t.wrap?ha:Ks,e.adler=t.wrap===2?0:1,t.last_flush=-2,eI(t),Ct},Ob=e=>{const t=Tb(e);return t===Ct&&CI(e.state),t},II=(e,t)=>sl(e)||e.state.wrap!==2?cr:(e.state.gzhead=t,Ct),Pb=(e,t,n,r,i,a)=>{if(!e)return cr;let o=1;if(t===oI&&(t=6),r<0?(o=0,r=-r):r>15&&(o=2,r-=16),i<1||i>fI||n!==yu||r<8||r>15||t<0||t>9||a<0||a>uI||r===8&&o!==1)return Js(e,cr);r===8&&(r=9);const l=new kI;return e.state=l,l.strm=e,l.status=ha,l.wrap=o,l.gzhead=null,l.w_bits=r,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=i+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+De-1)/De),l.window=new Uint8Array(l.w_size*2),l.head=new Uint16Array(l.hash_size),l.prev=new Uint16Array(l.w_size),l.lit_bufsize=1<<i+6,l.pending_buf_size=l.lit_bufsize*4,l.pending_buf=new Uint8Array(l.pending_buf_size),l.sym_buf=l.lit_bufsize,l.sym_end=(l.lit_bufsize-1)*3,l.level=t,l.strategy=a,l.method=n,Ob(e)},RI=(e,t)=>Pb(e,t,yu,pI,mI,dI),TI=(e,t)=>{if(sl(e)||t>Fg||t<0)return e?Js(e,cr):cr;const n=e.state;if(!e.output||e.avail_in!==0&&!e.input||n.status===so&&t!==wn)return Js(e,e.avail_out===0?md:cr);const r=n.last_flush;if(n.last_flush=t,n.pending!==0){if(sn(e),e.avail_out===0)return n.last_flush=-1,Ct}else if(e.avail_in===0&&qg(t)<=qg(r)&&t!==wn)return Js(e,md);if(n.status===so&&e.avail_in!==0)return Js(e,md);if(n.status===ha&&n.wrap===0&&(n.status=Ks),n.status===ha){let i=yu+(n.w_bits-8<<4)<<8,a=-1;if(n.strategy>=Pl||n.level<2?a=0:n.level<6?a=1:n.level===6?a=2:a=3,i|=a<<6,n.strstart!==0&&(i|=wI),i+=31-i%31,Wa(n,i),n.strstart!==0&&(Wa(n,e.adler>>>16),Wa(n,e.adler&65535)),e.adler=1,n.status=Ks,sn(e),n.pending!==0)return n.last_flush=-1,Ct}if(n.status===kp){if(e.adler=0,Fe(n,31),Fe(n,139),Fe(n,8),n.gzhead)Fe(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),Fe(n,n.gzhead.time&255),Fe(n,n.gzhead.time>>8&255),Fe(n,n.gzhead.time>>16&255),Fe(n,n.gzhead.time>>24&255),Fe(n,n.level===9?2:n.strategy>=Pl||n.level<2?4:0),Fe(n,n.gzhead.os&255),n.gzhead.extra&&n.gzhead.extra.length&&(Fe(n,n.gzhead.extra.length&255),Fe(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(e.adler=Kr(e.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=Vh;else if(Fe(n,0),Fe(n,0),Fe(n,0),Fe(n,0),Fe(n,0),Fe(n,n.level===9?2:n.strategy>=Pl||n.level<2?4:0),Fe(n,SI),n.status=Ks,sn(e),n.pending!==0)return n.last_flush=-1,Ct}if(n.status===Vh){if(n.gzhead.extra){let i=n.pending,a=(n.gzhead.extra.length&65535)-n.gzindex;for(;n.pending+a>n.pending_buf_size;){let l=n.pending_buf_size-n.pending;if(n.pending_buf.set(n.gzhead.extra.subarray(n.gzindex,n.gzindex+l),n.pending),n.pending=n.pending_buf_size,n.gzhead.hcrc&&n.pending>i&&(e.adler=Kr(e.adler,n.pending_buf,n.pending-i,i)),n.gzindex+=l,sn(e),n.pending!==0)return n.last_flush=-1,Ct;i=0,a-=l}let o=new Uint8Array(n.gzhead.extra);n.pending_buf.set(o.subarray(n.gzindex,n.gzindex+a),n.pending),n.pending+=a,n.gzhead.hcrc&&n.pending>i&&(e.adler=Kr(e.adler,n.pending_buf,n.pending-i,i)),n.gzindex=0}n.status=$h}if(n.status===$h){if(n.gzhead.name){let i=n.pending,a;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>i&&(e.adler=Kr(e.adler,n.pending_buf,n.pending-i,i)),sn(e),n.pending!==0)return n.last_flush=-1,Ct;i=0}n.gzindex<n.gzhead.name.length?a=n.gzhead.name.charCodeAt(n.gzindex++)&255:a=0,Fe(n,a)}while(a!==0);n.gzhead.hcrc&&n.pending>i&&(e.adler=Kr(e.adler,n.pending_buf,n.pending-i,i)),n.gzindex=0}n.status=Fh}if(n.status===Fh){if(n.gzhead.comment){let i=n.pending,a;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>i&&(e.adler=Kr(e.adler,n.pending_buf,n.pending-i,i)),sn(e),n.pending!==0)return n.last_flush=-1,Ct;i=0}n.gzindex<n.gzhead.comment.length?a=n.gzhead.comment.charCodeAt(n.gzindex++)&255:a=0,Fe(n,a)}while(a!==0);n.gzhead.hcrc&&n.pending>i&&(e.adler=Kr(e.adler,n.pending_buf,n.pending-i,i))}n.status=Hh}if(n.status===Hh){if(n.gzhead.hcrc){if(n.pending+2>n.pending_buf_size&&(sn(e),n.pending!==0))return n.last_flush=-1,Ct;Fe(n,e.adler&255),Fe(n,e.adler>>8&255),e.adler=0}if(n.status=Ks,sn(e),n.pending!==0)return n.last_flush=-1,Ct}if(e.avail_in!==0||n.lookahead!==0||t!==xs&&n.status!==so){let i=n.level===0?Rb(n,t):n.strategy===Pl?AI(n,t):n.strategy===cI?_I(n,t):io[n.level].func(n,t);if((i===ci||i===ka)&&(n.status=so),i===Ht||i===ci)return e.avail_out===0&&(n.last_flush=-1),Ct;if(i===Ca&&(t===sI?nI(n):t!==Fg&&(Uh(n,0,0,!1),t===iI&&(es(n.head),n.lookahead===0&&(n.strstart=0,n.block_start=0,n.insert=0))),sn(e),e.avail_out===0))return n.last_flush=-1,Ct}return t!==wn?Ct:n.wrap<=0?Hg:(n.wrap===2?(Fe(n,e.adler&255),Fe(n,e.adler>>8&255),Fe(n,e.adler>>16&255),Fe(n,e.adler>>24&255),Fe(n,e.total_in&255),Fe(n,e.total_in>>8&255),Fe(n,e.total_in>>16&255),Fe(n,e.total_in>>24&255)):(Wa(n,e.adler>>>16),Wa(n,e.adler&65535)),sn(e),n.wrap>0&&(n.wrap=-n.wrap),n.pending!==0?Ct:Hg)},OI=e=>{if(sl(e))return cr;const t=e.state.status;return e.state=null,t===Ks?Js(e,aI):Ct},PI=(e,t)=>{let n=t.length;if(sl(e))return cr;const r=e.state,i=r.wrap;if(i===2||i===1&&r.status!==ha||r.lookahead)return cr;if(i===1&&(e.adler=kb(e.adler,t,n,0)),r.wrap=0,n>=r.w_size){i===0&&(es(r.head),r.strstart=0,r.block_start=0,r.insert=0);let c=new Uint8Array(r.w_size);c.set(t.subarray(n-r.w_size,n),0),t=c,n=r.w_size}const a=e.avail_in,o=e.next_in,l=e.input;for(e.avail_in=n,e.next_in=0,e.input=t,fa(r);r.lookahead>=De;){let c=r.strstart,u=r.lookahead-(De-1);do r.ins_h=js(r,r.ins_h,r.window[c+De-1]),r.prev[c&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=c,c++;while(--u);r.strstart=c,r.lookahead=De-1,fa(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=De-1,r.match_available=0,e.next_in=o,e.input=l,e.avail_in=a,r.wrap=i,Ct};pr.deflateInit=RI;pr.deflateInit2=Pb;pr.deflateReset=Ob;pr.deflateResetKeep=Tb;pr.deflateSetHeader=II;pr.deflate=TI;pr.deflateEnd=OI;pr.deflateSetDictionary=PI;pr.deflateInfo="pako deflate (from Nodeca project)";var vu={};const LI=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);vu.assign=function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const n=t.shift();if(n){if(typeof n!="object")throw new TypeError(n+"must be non-object");for(const r in n)LI(n,r)&&(e[r]=n[r])}}return e};vu.flattenChunks=e=>{let t=0;for(let r=0,i=e.length;r<i;r++)t+=e[r].length;const n=new Uint8Array(t);for(let r=0,i=0,a=e.length;r<a;r++){let o=e[r];n.set(o,i),i+=o.length}return n};var il={};let Lb=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{Lb=!1}const Wo=new Uint8Array(256);for(let e=0;e<256;e++)Wo[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;Wo[254]=Wo[254]=1;il.string2buf=e=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(e);let t,n,r,i,a,o=e.length,l=0;for(i=0;i<o;i++)n=e.charCodeAt(i),(n&64512)===55296&&i+1<o&&(r=e.charCodeAt(i+1),(r&64512)===56320&&(n=65536+(n-55296<<10)+(r-56320),i++)),l+=n<128?1:n<2048?2:n<65536?3:4;for(t=new Uint8Array(l),a=0,i=0;a<l;i++)n=e.charCodeAt(i),(n&64512)===55296&&i+1<o&&(r=e.charCodeAt(i+1),(r&64512)===56320&&(n=65536+(n-55296<<10)+(r-56320),i++)),n<128?t[a++]=n:n<2048?(t[a++]=192|n>>>6,t[a++]=128|n&63):n<65536?(t[a++]=224|n>>>12,t[a++]=128|n>>>6&63,t[a++]=128|n&63):(t[a++]=240|n>>>18,t[a++]=128|n>>>12&63,t[a++]=128|n>>>6&63,t[a++]=128|n&63);return t};const DI=(e,t)=>{if(t<65534&&e.subarray&&Lb)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let n="";for(let r=0;r<t;r++)n+=String.fromCharCode(e[r]);return n};il.buf2string=(e,t)=>{const n=t||e.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(e.subarray(0,t));let r,i;const a=new Array(n*2);for(i=0,r=0;r<n;){let o=e[r++];if(o<128){a[i++]=o;continue}let l=Wo[o];if(l>4){a[i++]=65533,r+=l-1;continue}for(o&=l===2?31:l===3?15:7;l>1&&r<n;)o=o<<6|e[r++]&63,l--;if(l>1){a[i++]=65533;continue}o<65536?a[i++]=o:(o-=65536,a[i++]=55296|o>>10&1023,a[i++]=56320|o&1023)}return DI(a,i)};il.utf8border=(e,t)=>{t=t||e.length,t>e.length&&(t=e.length);let n=t-1;for(;n>=0&&(e[n]&192)===128;)n--;return n<0||n===0?t:n+Wo[e[n]]>t?n:t};function MI(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var Db=MI;const vo=pr,Mb=vu,Ub=il,zh=Cp,UI=Db,Bb=Object.prototype.toString,{Z_NO_FLUSH:BI,Z_SYNC_FLUSH:VI,Z_FULL_FLUSH:$I,Z_FINISH:FI,Z_OK:qc,Z_STREAM_END:HI,Z_DEFAULT_COMPRESSION:qI,Z_DEFAULT_STRATEGY:zI,Z_DEFLATED:WI}=pi;function al(e){this.options=Mb.assign({level:qI,method:WI,chunkSize:16384,windowBits:15,memLevel:8,strategy:zI},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new UI,this.strm.avail_out=0;let n=vo.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(n!==qc)throw new Error(zh[n]);if(t.header&&vo.deflateSetHeader(this.strm,t.header),t.dictionary){let r;if(typeof t.dictionary=="string"?r=Ub.string2buf(t.dictionary):Bb.call(t.dictionary)==="[object ArrayBuffer]"?r=new Uint8Array(t.dictionary):r=t.dictionary,n=vo.deflateSetDictionary(this.strm,r),n!==qc)throw new Error(zh[n]);this._dict_set=!0}}al.prototype.push=function(e,t){const n=this.strm,r=this.options.chunkSize;let i,a;if(this.ended)return!1;for(t===~~t?a=t:a=t===!0?FI:BI,typeof e=="string"?n.input=Ub.string2buf(e):Bb.call(e)==="[object ArrayBuffer]"?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;){if(n.avail_out===0&&(n.output=new Uint8Array(r),n.next_out=0,n.avail_out=r),(a===VI||a===$I)&&n.avail_out<=6){this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;continue}if(i=vo.deflate(n,a),i===HI)return n.next_out>0&&this.onData(n.output.subarray(0,n.next_out)),i=vo.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===qc;if(n.avail_out===0){this.onData(n.output);continue}if(a>0&&n.next_out>0){this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;continue}if(n.avail_in===0)break}return!0};al.prototype.onData=function(e){this.chunks.push(e)};al.prototype.onEnd=function(e){e===qc&&(this.result=Mb.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function Ip(e,t){const n=new al(t);if(n.push(e,!0),n.err)throw n.msg||zh[n.err];return n.result}function GI(e,t){return t=t||{},t.raw=!0,Ip(e,t)}function YI(e,t){return t=t||{},t.gzip=!0,Ip(e,t)}Na.Deflate=al;Na.deflate=Ip;Na.deflateRaw=GI;Na.gzip=YI;Na.constants=pi;var Ia={},Yn={};const Ll=16209,KI=16191;var JI=function(t,n){let r,i,a,o,l,c,u,d,p,h,f,y,b,E,g,x,w,_,S,k,I,C,L,V;const B=t.state;r=t.next_in,L=t.input,i=r+(t.avail_in-5),a=t.next_out,V=t.output,o=a-(n-t.avail_out),l=a+(t.avail_out-257),c=B.dmax,u=B.wsize,d=B.whave,p=B.wnext,h=B.window,f=B.hold,y=B.bits,b=B.lencode,E=B.distcode,g=(1<<B.lenbits)-1,x=(1<<B.distbits)-1;e:do{y<15&&(f+=L[r++]<<y,y+=8,f+=L[r++]<<y,y+=8),w=b[f&g];t:for(;;){if(_=w>>>24,f>>>=_,y-=_,_=w>>>16&255,_===0)V[a++]=w&65535;else if(_&16){S=w&65535,_&=15,_&&(y<_&&(f+=L[r++]<<y,y+=8),S+=f&(1<<_)-1,f>>>=_,y-=_),y<15&&(f+=L[r++]<<y,y+=8,f+=L[r++]<<y,y+=8),w=E[f&x];n:for(;;){if(_=w>>>24,f>>>=_,y-=_,_=w>>>16&255,_&16){if(k=w&65535,_&=15,y<_&&(f+=L[r++]<<y,y+=8,y<_&&(f+=L[r++]<<y,y+=8)),k+=f&(1<<_)-1,k>c){t.msg="invalid distance too far back",B.mode=Ll;break e}if(f>>>=_,y-=_,_=a-o,k>_){if(_=k-_,_>d&&B.sane){t.msg="invalid distance too far back",B.mode=Ll;break e}if(I=0,C=h,p===0){if(I+=u-_,_<S){S-=_;do V[a++]=h[I++];while(--_);I=a-k,C=V}}else if(p<_){if(I+=u+p-_,_-=p,_<S){S-=_;do V[a++]=h[I++];while(--_);if(I=0,p<S){_=p,S-=_;do V[a++]=h[I++];while(--_);I=a-k,C=V}}}else if(I+=p-_,_<S){S-=_;do V[a++]=h[I++];while(--_);I=a-k,C=V}for(;S>2;)V[a++]=C[I++],V[a++]=C[I++],V[a++]=C[I++],S-=3;S&&(V[a++]=C[I++],S>1&&(V[a++]=C[I++]))}else{I=a-k;do V[a++]=V[I++],V[a++]=V[I++],V[a++]=V[I++],S-=3;while(S>2);S&&(V[a++]=V[I++],S>1&&(V[a++]=V[I++]))}}else if(_&64){t.msg="invalid distance code",B.mode=Ll;break e}else{w=E[(w&65535)+(f&(1<<_)-1)];continue n}break}}else if(_&64)if(_&32){B.mode=KI;break e}else{t.msg="invalid literal/length code",B.mode=Ll;break e}else{w=b[(w&65535)+(f&(1<<_)-1)];continue t}break}}while(r<i&&a<l);S=y>>3,r-=S,y-=S<<3,f&=(1<<y)-1,t.next_in=r,t.next_out=a,t.avail_in=r<i?5+(i-r):5-(r-i),t.avail_out=a<l?257+(l-a):257-(a-l),B.hold=f,B.bits=y};const Ri=15,zg=852,Wg=592,Gg=0,yd=1,Yg=2,QI=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),ZI=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),XI=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),eR=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),tR=(e,t,n,r,i,a,o,l)=>{const c=l.bits;let u=0,d=0,p=0,h=0,f=0,y=0,b=0,E=0,g=0,x=0,w,_,S,k,I,C=null,L;const V=new Uint16Array(Ri+1),B=new Uint16Array(Ri+1);let Y=null,W,O,D;for(u=0;u<=Ri;u++)V[u]=0;for(d=0;d<r;d++)V[t[n+d]]++;for(f=c,h=Ri;h>=1&&V[h]===0;h--);if(f>h&&(f=h),h===0)return i[a++]=1<<24|64<<16|0,i[a++]=1<<24|64<<16|0,l.bits=1,0;for(p=1;p<h&&V[p]===0;p++);for(f<p&&(f=p),E=1,u=1;u<=Ri;u++)if(E<<=1,E-=V[u],E<0)return-1;if(E>0&&(e===Gg||h!==1))return-1;for(B[1]=0,u=1;u<Ri;u++)B[u+1]=B[u]+V[u];for(d=0;d<r;d++)t[n+d]!==0&&(o[B[t[n+d]]++]=d);if(e===Gg?(C=Y=o,L=20):e===yd?(C=QI,Y=ZI,L=257):(C=XI,Y=eR,L=0),x=0,d=0,u=p,I=a,y=f,b=0,S=-1,g=1<<f,k=g-1,e===yd&&g>zg||e===Yg&&g>Wg)return 1;for(;;){W=u-b,o[d]+1<L?(O=0,D=o[d]):o[d]>=L?(O=Y[o[d]-L],D=C[o[d]-L]):(O=96,D=0),w=1<<u-b,_=1<<y,p=_;do _-=w,i[I+(x>>b)+_]=W<<24|O<<16|D|0;while(_!==0);for(w=1<<u-1;x&w;)w>>=1;if(w!==0?(x&=w-1,x+=w):x=0,d++,--V[u]===0){if(u===h)break;u=t[n+o[d]]}if(u>f&&(x&k)!==S){for(b===0&&(b=f),I+=p,y=u-b,E=1<<y;y+b<h&&(E-=V[y+b],!(E<=0));)y++,E<<=1;if(g+=1<<y,e===yd&&g>zg||e===Yg&&g>Wg)return 1;S=x&k,i[S]=f<<24|y<<16|I-a|0}}return x!==0&&(i[I+x]=u-b<<24|64<<16|0),l.bits=f,0};var nR=tR;const Wh=Ab,Xn=Cb,rR=JI,xo=nR,sR=0,Vb=1,$b=2,{Z_FINISH:Kg,Z_BLOCK:iR,Z_TREES:Dl,Z_OK:ui,Z_STREAM_END:aR,Z_NEED_DICT:oR,Z_STREAM_ERROR:An,Z_DATA_ERROR:Fb,Z_MEM_ERROR:Hb,Z_BUF_ERROR:lR,Z_DEFLATED:Jg}=pi,xu=16180,Qg=16181,Zg=16182,Xg=16183,ey=16184,ty=16185,ny=16186,ry=16187,sy=16188,iy=16189,zc=16190,Sr=16191,vd=16192,ay=16193,xd=16194,oy=16195,ly=16196,cy=16197,uy=16198,Ml=16199,Ul=16200,dy=16201,hy=16202,fy=16203,py=16204,my=16205,jd=16206,gy=16207,yy=16208,et=16209,qb=16210,zb=16211,cR=852,uR=592,dR=15,hR=dR,vy=e=>(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24);function fR(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const mi=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<xu||t.mode>zb?1:0},Wb=e=>{if(mi(e))return An;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=t.wrap&1),t.mode=xu,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(cR),t.distcode=t.distdyn=new Int32Array(uR),t.sane=1,t.back=-1,ui},Gb=e=>{if(mi(e))return An;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,Wb(e)},Yb=(e,t)=>{let n;if(mi(e))return An;const r=e.state;return t<0?(n=0,t=-t):(n=(t>>4)+5,t<48&&(t&=15)),t&&(t<8||t>15)?An:(r.window!==null&&r.wbits!==t&&(r.window=null),r.wrap=n,r.wbits=t,Gb(e))},Kb=(e,t)=>{if(!e)return An;const n=new fR;e.state=n,n.strm=e,n.window=null,n.mode=xu;const r=Yb(e,t);return r!==ui&&(e.state=null),r},pR=e=>Kb(e,hR);let xy=!0,bd,wd;const mR=e=>{if(xy){bd=new Int32Array(512),wd=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(xo(Vb,e.lens,0,288,bd,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;xo($b,e.lens,0,32,wd,0,e.work,{bits:5}),xy=!1}e.lencode=bd,e.lenbits=9,e.distcode=wd,e.distbits=5},Jb=(e,t,n,r)=>{let i;const a=e.state;return a.window===null&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new Uint8Array(a.wsize)),r>=a.wsize?(a.window.set(t.subarray(n-a.wsize,n),0),a.wnext=0,a.whave=a.wsize):(i=a.wsize-a.wnext,i>r&&(i=r),a.window.set(t.subarray(n-r,n-r+i),a.wnext),r-=i,r?(a.window.set(t.subarray(n-r,n),0),a.wnext=r,a.whave=a.wsize):(a.wnext+=i,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=i))),0},gR=(e,t)=>{let n,r,i,a,o,l,c,u,d,p,h,f,y,b,E=0,g,x,w,_,S,k,I,C;const L=new Uint8Array(4);let V,B;const Y=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(mi(e)||!e.output||!e.input&&e.avail_in!==0)return An;n=e.state,n.mode===Sr&&(n.mode=vd),o=e.next_out,i=e.output,c=e.avail_out,a=e.next_in,r=e.input,l=e.avail_in,u=n.hold,d=n.bits,p=l,h=c,C=ui;e:for(;;)switch(n.mode){case xu:if(n.wrap===0){n.mode=vd;break}for(;d<16;){if(l===0)break e;l--,u+=r[a++]<<d,d+=8}if(n.wrap&2&&u===35615){n.wbits===0&&(n.wbits=15),n.check=0,L[0]=u&255,L[1]=u>>>8&255,n.check=Xn(n.check,L,2,0),u=0,d=0,n.mode=Qg;break}if(n.head&&(n.head.done=!1),!(n.wrap&1)||(((u&255)<<8)+(u>>8))%31){e.msg="incorrect header check",n.mode=et;break}if((u&15)!==Jg){e.msg="unknown compression method",n.mode=et;break}if(u>>>=4,d-=4,I=(u&15)+8,n.wbits===0&&(n.wbits=I),I>15||I>n.wbits){e.msg="invalid window size",n.mode=et;break}n.dmax=1<<n.wbits,n.flags=0,e.adler=n.check=1,n.mode=u&512?iy:Sr,u=0,d=0;break;case Qg:for(;d<16;){if(l===0)break e;l--,u+=r[a++]<<d,d+=8}if(n.flags=u,(n.flags&255)!==Jg){e.msg="unknown compression method",n.mode=et;break}if(n.flags&57344){e.msg="unknown header flags set",n.mode=et;break}n.head&&(n.head.text=u>>8&1),n.flags&512&&n.wrap&4&&(L[0]=u&255,L[1]=u>>>8&255,n.check=Xn(n.check,L,2,0)),u=0,d=0,n.mode=Zg;case Zg:for(;d<32;){if(l===0)break e;l--,u+=r[a++]<<d,d+=8}n.head&&(n.head.time=u),n.flags&512&&n.wrap&4&&(L[0]=u&255,L[1]=u>>>8&255,L[2]=u>>>16&255,L[3]=u>>>24&255,n.check=Xn(n.check,L,4,0)),u=0,d=0,n.mode=Xg;case Xg:for(;d<16;){if(l===0)break e;l--,u+=r[a++]<<d,d+=8}n.head&&(n.head.xflags=u&255,n.head.os=u>>8),n.flags&512&&n.wrap&4&&(L[0]=u&255,L[1]=u>>>8&255,n.check=Xn(n.check,L,2,0)),u=0,d=0,n.mode=ey;case ey:if(n.flags&1024){for(;d<16;){if(l===0)break e;l--,u+=r[a++]<<d,d+=8}n.length=u,n.head&&(n.head.extra_len=u),n.flags&512&&n.wrap&4&&(L[0]=u&255,L[1]=u>>>8&255,n.check=Xn(n.check,L,2,0)),u=0,d=0}else n.head&&(n.head.extra=null);n.mode=ty;case ty:if(n.flags&1024&&(f=n.length,f>l&&(f=l),f&&(n.head&&(I=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(r.subarray(a,a+f),I)),n.flags&512&&n.wrap&4&&(n.check=Xn(n.check,r,f,a)),l-=f,a+=f,n.length-=f),n.length))break e;n.length=0,n.mode=ny;case ny:if(n.flags&2048){if(l===0)break e;f=0;do I=r[a+f++],n.head&&I&&n.length<65536&&(n.head.name+=String.fromCharCode(I));while(I&&f<l);if(n.flags&512&&n.wrap&4&&(n.check=Xn(n.check,r,f,a)),l-=f,a+=f,I)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=ry;case ry:if(n.flags&4096){if(l===0)break e;f=0;do I=r[a+f++],n.head&&I&&n.length<65536&&(n.head.comment+=String.fromCharCode(I));while(I&&f<l);if(n.flags&512&&n.wrap&4&&(n.check=Xn(n.check,r,f,a)),l-=f,a+=f,I)break e}else n.head&&(n.head.comment=null);n.mode=sy;case sy:if(n.flags&512){for(;d<16;){if(l===0)break e;l--,u+=r[a++]<<d,d+=8}if(n.wrap&4&&u!==(n.check&65535)){e.msg="header crc mismatch",n.mode=et;break}u=0,d=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=Sr;break;case iy:for(;d<32;){if(l===0)break e;l--,u+=r[a++]<<d,d+=8}e.adler=n.check=vy(u),u=0,d=0,n.mode=zc;case zc:if(n.havedict===0)return e.next_out=o,e.avail_out=c,e.next_in=a,e.avail_in=l,n.hold=u,n.bits=d,oR;e.adler=n.check=1,n.mode=Sr;case Sr:if(t===iR||t===Dl)break e;case vd:if(n.last){u>>>=d&7,d-=d&7,n.mode=jd;break}for(;d<3;){if(l===0)break e;l--,u+=r[a++]<<d,d+=8}switch(n.last=u&1,u>>>=1,d-=1,u&3){case 0:n.mode=ay;break;case 1:if(mR(n),n.mode=Ml,t===Dl){u>>>=2,d-=2;break e}break;case 2:n.mode=ly;break;case 3:e.msg="invalid block type",n.mode=et}u>>>=2,d-=2;break;case ay:for(u>>>=d&7,d-=d&7;d<32;){if(l===0)break e;l--,u+=r[a++]<<d,d+=8}if((u&65535)!==(u>>>16^65535)){e.msg="invalid stored block lengths",n.mode=et;break}if(n.length=u&65535,u=0,d=0,n.mode=xd,t===Dl)break e;case xd:n.mode=oy;case oy:if(f=n.length,f){if(f>l&&(f=l),f>c&&(f=c),f===0)break e;i.set(r.subarray(a,a+f),o),l-=f,a+=f,c-=f,o+=f,n.length-=f;break}n.mode=Sr;break;case ly:for(;d<14;){if(l===0)break e;l--,u+=r[a++]<<d,d+=8}if(n.nlen=(u&31)+257,u>>>=5,d-=5,n.ndist=(u&31)+1,u>>>=5,d-=5,n.ncode=(u&15)+4,u>>>=4,d-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=et;break}n.have=0,n.mode=cy;case cy:for(;n.have<n.ncode;){for(;d<3;){if(l===0)break e;l--,u+=r[a++]<<d,d+=8}n.lens[Y[n.have++]]=u&7,u>>>=3,d-=3}for(;n.have<19;)n.lens[Y[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,V={bits:n.lenbits},C=xo(sR,n.lens,0,19,n.lencode,0,n.work,V),n.lenbits=V.bits,C){e.msg="invalid code lengths set",n.mode=et;break}n.have=0,n.mode=uy;case uy:for(;n.have<n.nlen+n.ndist;){for(;E=n.lencode[u&(1<<n.lenbits)-1],g=E>>>24,x=E>>>16&255,w=E&65535,!(g<=d);){if(l===0)break e;l--,u+=r[a++]<<d,d+=8}if(w<16)u>>>=g,d-=g,n.lens[n.have++]=w;else{if(w===16){for(B=g+2;d<B;){if(l===0)break e;l--,u+=r[a++]<<d,d+=8}if(u>>>=g,d-=g,n.have===0){e.msg="invalid bit length repeat",n.mode=et;break}I=n.lens[n.have-1],f=3+(u&3),u>>>=2,d-=2}else if(w===17){for(B=g+3;d<B;){if(l===0)break e;l--,u+=r[a++]<<d,d+=8}u>>>=g,d-=g,I=0,f=3+(u&7),u>>>=3,d-=3}else{for(B=g+7;d<B;){if(l===0)break e;l--,u+=r[a++]<<d,d+=8}u>>>=g,d-=g,I=0,f=11+(u&127),u>>>=7,d-=7}if(n.have+f>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=et;break}for(;f--;)n.lens[n.have++]=I}}if(n.mode===et)break;if(n.lens[256]===0){e.msg="invalid code -- missing end-of-block",n.mode=et;break}if(n.lenbits=9,V={bits:n.lenbits},C=xo(Vb,n.lens,0,n.nlen,n.lencode,0,n.work,V),n.lenbits=V.bits,C){e.msg="invalid literal/lengths set",n.mode=et;break}if(n.distbits=6,n.distcode=n.distdyn,V={bits:n.distbits},C=xo($b,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,V),n.distbits=V.bits,C){e.msg="invalid distances set",n.mode=et;break}if(n.mode=Ml,t===Dl)break e;case Ml:n.mode=Ul;case Ul:if(l>=6&&c>=258){e.next_out=o,e.avail_out=c,e.next_in=a,e.avail_in=l,n.hold=u,n.bits=d,rR(e,h),o=e.next_out,i=e.output,c=e.avail_out,a=e.next_in,r=e.input,l=e.avail_in,u=n.hold,d=n.bits,n.mode===Sr&&(n.back=-1);break}for(n.back=0;E=n.lencode[u&(1<<n.lenbits)-1],g=E>>>24,x=E>>>16&255,w=E&65535,!(g<=d);){if(l===0)break e;l--,u+=r[a++]<<d,d+=8}if(x&&!(x&240)){for(_=g,S=x,k=w;E=n.lencode[k+((u&(1<<_+S)-1)>>_)],g=E>>>24,x=E>>>16&255,w=E&65535,!(_+g<=d);){if(l===0)break e;l--,u+=r[a++]<<d,d+=8}u>>>=_,d-=_,n.back+=_}if(u>>>=g,d-=g,n.back+=g,n.length=w,x===0){n.mode=my;break}if(x&32){n.back=-1,n.mode=Sr;break}if(x&64){e.msg="invalid literal/length code",n.mode=et;break}n.extra=x&15,n.mode=dy;case dy:if(n.extra){for(B=n.extra;d<B;){if(l===0)break e;l--,u+=r[a++]<<d,d+=8}n.length+=u&(1<<n.extra)-1,u>>>=n.extra,d-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=hy;case hy:for(;E=n.distcode[u&(1<<n.distbits)-1],g=E>>>24,x=E>>>16&255,w=E&65535,!(g<=d);){if(l===0)break e;l--,u+=r[a++]<<d,d+=8}if(!(x&240)){for(_=g,S=x,k=w;E=n.distcode[k+((u&(1<<_+S)-1)>>_)],g=E>>>24,x=E>>>16&255,w=E&65535,!(_+g<=d);){if(l===0)break e;l--,u+=r[a++]<<d,d+=8}u>>>=_,d-=_,n.back+=_}if(u>>>=g,d-=g,n.back+=g,x&64){e.msg="invalid distance code",n.mode=et;break}n.offset=w,n.extra=x&15,n.mode=fy;case fy:if(n.extra){for(B=n.extra;d<B;){if(l===0)break e;l--,u+=r[a++]<<d,d+=8}n.offset+=u&(1<<n.extra)-1,u>>>=n.extra,d-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=et;break}n.mode=py;case py:if(c===0)break e;if(f=h-c,n.offset>f){if(f=n.offset-f,f>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=et;break}f>n.wnext?(f-=n.wnext,y=n.wsize-f):y=n.wnext-f,f>n.length&&(f=n.length),b=n.window}else b=i,y=o-n.offset,f=n.length;f>c&&(f=c),c-=f,n.length-=f;do i[o++]=b[y++];while(--f);n.length===0&&(n.mode=Ul);break;case my:if(c===0)break e;i[o++]=n.length,c--,n.mode=Ul;break;case jd:if(n.wrap){for(;d<32;){if(l===0)break e;l--,u|=r[a++]<<d,d+=8}if(h-=c,e.total_out+=h,n.total+=h,n.wrap&4&&h&&(e.adler=n.check=n.flags?Xn(n.check,i,h,o-h):Wh(n.check,i,h,o-h)),h=c,n.wrap&4&&(n.flags?u:vy(u))!==n.check){e.msg="incorrect data check",n.mode=et;break}u=0,d=0}n.mode=gy;case gy:if(n.wrap&&n.flags){for(;d<32;){if(l===0)break e;l--,u+=r[a++]<<d,d+=8}if(n.wrap&4&&u!==(n.total&4294967295)){e.msg="incorrect length check",n.mode=et;break}u=0,d=0}n.mode=yy;case yy:C=aR;break e;case et:C=Fb;break e;case qb:return Hb;case zb:default:return An}return e.next_out=o,e.avail_out=c,e.next_in=a,e.avail_in=l,n.hold=u,n.bits=d,(n.wsize||h!==e.avail_out&&n.mode<et&&(n.mode<jd||t!==Kg))&&Jb(e,e.output,e.next_out,h-e.avail_out),p-=e.avail_in,h-=e.avail_out,e.total_in+=p,e.total_out+=h,n.total+=h,n.wrap&4&&h&&(e.adler=n.check=n.flags?Xn(n.check,i,h,e.next_out-h):Wh(n.check,i,h,e.next_out-h)),e.data_type=n.bits+(n.last?64:0)+(n.mode===Sr?128:0)+(n.mode===Ml||n.mode===xd?256:0),(p===0&&h===0||t===Kg)&&C===ui&&(C=lR),C},yR=e=>{if(mi(e))return An;let t=e.state;return t.window&&(t.window=null),e.state=null,ui},vR=(e,t)=>{if(mi(e))return An;const n=e.state;return n.wrap&2?(n.head=t,t.done=!1,ui):An},xR=(e,t)=>{const n=t.length;let r,i,a;return mi(e)||(r=e.state,r.wrap!==0&&r.mode!==zc)?An:r.mode===zc&&(i=1,i=Wh(i,t,n,0),i!==r.check)?Fb:(a=Jb(e,t,n,n),a?(r.mode=qb,Hb):(r.havedict=1,ui))};Yn.inflateReset=Gb;Yn.inflateReset2=Yb;Yn.inflateResetKeep=Wb;Yn.inflateInit=pR;Yn.inflateInit2=Kb;Yn.inflate=gR;Yn.inflateEnd=yR;Yn.inflateGetHeader=vR;Yn.inflateSetDictionary=xR;Yn.inflateInfo="pako inflate (from Nodeca project)";function jR(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var bR=jR;const kr=Yn,Qb=vu,Gh=il,Yh=Cp,wR=Db,SR=bR,Zb=Object.prototype.toString,{Z_NO_FLUSH:ER,Z_FINISH:NR,Z_OK:Go,Z_STREAM_END:Sd,Z_NEED_DICT:Ed,Z_STREAM_ERROR:_R,Z_DATA_ERROR:jy,Z_MEM_ERROR:AR}=pi;function ol(e){this.options=Qb.assign({chunkSize:1024*64,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(e&&e.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15||(t.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new wR,this.strm.avail_out=0;let n=kr.inflateInit2(this.strm,t.windowBits);if(n!==Go)throw new Error(Yh[n]);if(this.header=new SR,kr.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=Gh.string2buf(t.dictionary):Zb.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(n=kr.inflateSetDictionary(this.strm,t.dictionary),n!==Go)))throw new Error(Yh[n])}ol.prototype.push=function(e,t){const n=this.strm,r=this.options.chunkSize,i=this.options.dictionary;let a,o,l;if(this.ended)return!1;for(t===~~t?o=t:o=t===!0?NR:ER,Zb.call(e)==="[object ArrayBuffer]"?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;){for(n.avail_out===0&&(n.output=new Uint8Array(r),n.next_out=0,n.avail_out=r),a=kr.inflate(n,o),a===Ed&&i&&(a=kr.inflateSetDictionary(n,i),a===Go?a=kr.inflate(n,o):a===jy&&(a=Ed));n.avail_in>0&&a===Sd&&n.state.wrap>0&&e[n.next_in]!==0;)kr.inflateReset(n),a=kr.inflate(n,o);switch(a){case _R:case jy:case Ed:case AR:return this.onEnd(a),this.ended=!0,!1}if(l=n.avail_out,n.next_out&&(n.avail_out===0||a===Sd))if(this.options.to==="string"){let c=Gh.utf8border(n.output,n.next_out),u=n.next_out-c,d=Gh.buf2string(n.output,c);n.next_out=u,n.avail_out=r-u,u&&n.output.set(n.output.subarray(c,c+u),0),this.onData(d)}else this.onData(n.output.length===n.next_out?n.output:n.output.subarray(0,n.next_out));if(!(a===Go&&l===0)){if(a===Sd)return a=kr.inflateEnd(this.strm),this.onEnd(a),this.ended=!0,!0;if(n.avail_in===0)break}}return!0};ol.prototype.onData=function(e){this.chunks.push(e)};ol.prototype.onEnd=function(e){e===Go&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=Qb.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function Rp(e,t){const n=new ol(t);if(n.push(e),n.err)throw n.msg||Yh[n.err];return n.result}function CR(e,t){return t=t||{},t.raw=!0,Rp(e,t)}Ia.Inflate=ol;Ia.inflate=Rp;Ia.inflateRaw=CR;Ia.ungzip=Rp;Ia.constants=pi;const{Deflate:kR,deflate:IR,deflateRaw:RR,gzip:TR}=Na,{Inflate:OR,inflate:PR,inflateRaw:LR,ungzip:DR}=Ia,MR=pi;fr.Deflate=kR;fr.deflate=IR;fr.deflateRaw=RR;fr.gzip=TR;fr.Inflate=OR;fr.inflate=PR;fr.inflateRaw=LR;fr.ungzip=DR;fr.constants=MR;const UR=new TextEncoder,BR=new TextDecoder("utf-8");function by(e){return UR.encode(e)}function Kh(e){return BR.decode(e)}function Xb(e){if(typeof e!="string")throw new TypeError("value is not a string");if(!/^([0-9a-f][0-9a-f])*$/.test(e))throw new RangeError("value is not hexadecimal");return e===""?new Uint8Array(0):new Uint8Array(e.match(/../g).map(t=>parseInt(t,16)))}const wy=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],e0=new Array(256);for(let e=0;e<256;e++)e0[e]=`${wy[e>>>4&15]}${wy[e&15]}`;function t0(e){let t="",n=e.byteLength;for(let r=0;r<n;r++)t+=e0[e[r]];return t}let Tp=class{constructor(){this.buf=new Uint8Array(16),this.offset=0}get buffer(){return this.finish(),this.buf.subarray(0,this.offset)}grow(t=0){let n=this.buf.byteLength*4;for(;n<t;)n*=2;const r=new Uint8Array(n);return r.set(this.buf,0),this.buf=r,this}appendByte(t){this.offset>=this.buf.byteLength&&this.grow(),this.buf[this.offset]=t,this.offset+=1}appendUint32(t){if(!Number.isInteger(t))throw new RangeError("value is not an integer");if(t<0||t>4294967295)throw new RangeError("number out of range");const n=Math.max(1,Math.ceil((32-Math.clz32(t))/7));this.offset+n>this.buf.byteLength&&this.grow();for(let r=0;r<n;r++)this.buf[this.offset+r]=t&127|(r===n-1?0:128),t>>>=7;return this.offset+=n,n}appendInt32(t){if(!Number.isInteger(t))throw new RangeError("value is not an integer");if(t<-2147483648||t>2147483647)throw new RangeError("number out of range");const n=Math.ceil((33-Math.clz32(t>=0?t:-t-1))/7);this.offset+n>this.buf.byteLength&&this.grow();for(let r=0;r<n;r++)this.buf[this.offset+r]=t&127|(r===n-1?0:128),t>>=7;return this.offset+=n,n}appendUint53(t){if(!Number.isInteger(t))throw new RangeError("value is not an integer");if(t<0||t>Number.MAX_SAFE_INTEGER)throw new RangeError("number out of range");const n=Math.floor(t/4294967296),r=(t&4294967295)>>>0;return this.appendUint64(n,r)}appendInt53(t){if(!Number.isInteger(t))throw new RangeError("value is not an integer");if(t<Number.MIN_SAFE_INTEGER||t>Number.MAX_SAFE_INTEGER)throw new RangeError("number out of range");const n=Math.floor(t/4294967296),r=(t&4294967295)>>>0;return this.appendInt64(n,r)}appendUint64(t,n){if(!Number.isInteger(t)||!Number.isInteger(n))throw new RangeError("value is not an integer");if(t<0||t>4294967295||n<0||n>4294967295)throw new RangeError("number out of range");if(t===0)return this.appendUint32(n);const r=Math.ceil((64-Math.clz32(t))/7);this.offset+r>this.buf.byteLength&&this.grow();for(let i=0;i<4;i++)this.buf[this.offset+i]=n&127|128,n>>>=7;this.buf[this.offset+4]=n&15|(t&7)<<4|(r===5?0:128),t>>>=3;for(let i=5;i<r;i++)this.buf[this.offset+i]=t&127|(i===r-1?0:128),t>>>=7;return this.offset+=r,r}appendInt64(t,n){if(!Number.isInteger(t)||!Number.isInteger(n))throw new RangeError("value is not an integer");if(t<-2147483648||t>2147483647||n<-2147483648||n>4294967295)throw new RangeError("number out of range");if(n>>>=0,t===0&&n<=2147483647)return this.appendInt32(n);if(t===-1&&n>=2147483648)return this.appendInt32(n-4294967296);const r=Math.ceil((65-Math.clz32(t>=0?t:-t-1))/7);this.offset+r>this.buf.byteLength&&this.grow();for(let i=0;i<4;i++)this.buf[this.offset+i]=n&127|128,n>>>=7;this.buf[this.offset+4]=n&15|(t&7)<<4|(r===5?0:128),t>>=3;for(let i=5;i<r;i++)this.buf[this.offset+i]=t&127|(i===r-1?0:128),t>>=7;return this.offset+=r,r}appendRawBytes(t){return this.offset+t.byteLength>this.buf.byteLength&&this.grow(this.offset+t.byteLength),this.buf.set(t,this.offset),this.offset+=t.byteLength,t.byteLength}appendRawString(t){if(typeof t!="string")throw new TypeError("value is not a string");return this.appendRawBytes(by(t))}appendPrefixedBytes(t){return this.appendUint53(t.byteLength),this.appendRawBytes(t),this}appendPrefixedString(t){if(typeof t!="string")throw new TypeError("value is not a string");return this.appendPrefixedBytes(by(t)),this}appendHexString(t){return this.appendPrefixedBytes(Xb(t)),this}finish(){}},Op=class{constructor(t){if(!(t instanceof Uint8Array))throw new TypeError(`Not a byte array: ${t}`);this.buf=t,this.offset=0}get done(){return this.offset===this.buf.byteLength}reset(){this.offset=0}skip(t){if(this.offset+t>this.buf.byteLength)throw new RangeError("cannot skip beyond end of buffer");this.offset+=t}readByte(){return this.offset+=1,this.buf[this.offset-1]}readUint32(){let t=0,n=0;for(;this.offset<this.buf.byteLength;){const r=this.buf[this.offset];if(n===28&&r&240)throw new RangeError("number out of range");if(t=(t|(r&127)<<n)>>>0,n+=7,this.offset++,!(r&128))return t}throw new RangeError("buffer ended with incomplete number")}readInt32(){let t=0,n=0;for(;this.offset<this.buf.byteLength;){const r=this.buf[this.offset];if(n===28&&r&128||n===28&&!(r&64)&&r&56||n===28&&r&64&&(r&56)!==56)throw new RangeError("number out of range");if(t|=(r&127)<<n,n+=7,this.offset++,!(r&128))return!(r&64)||n>28?t:t|-1<<n}throw new RangeError("buffer ended with incomplete number")}readUint53(){const{low32:t,high32:n}=this.readUint64();if(n<0||n>2097151)throw new RangeError("number out of range");return n*4294967296+t}readInt53(){const{low32:t,high32:n}=this.readInt64();if(n<-2097152||n===-2097152&&t===0||n>2097151)throw new RangeError("number out of range");return n*4294967296+t}readUint64(){let t=0,n=0,r=0;for(;this.offset<this.buf.byteLength&&r<=28;){const i=this.buf[this.offset];if(t=(t|(i&127)<<r)>>>0,r===28&&(n=(i&112)>>>4),r+=7,this.offset++,!(i&128))return{high32:n,low32:t}}for(r=3;this.offset<this.buf.byteLength;){const i=this.buf[this.offset];if(r===31&&i&254)throw new RangeError("number out of range");if(n=(n|(i&127)<<r)>>>0,r+=7,this.offset++,!(i&128))return{high32:n,low32:t}}throw new RangeError("buffer ended with incomplete number")}readInt64(){let t=0,n=0,r=0;for(;this.offset<this.buf.byteLength&&r<=28;){const i=this.buf[this.offset];if(t=(t|(i&127)<<r)>>>0,r===28&&(n=(i&112)>>>4),r+=7,this.offset++,!(i&128))return i&64&&(r<32&&(t=(t|-1<<r)>>>0),n|=-1<<Math.max(r-32,0)),{high32:n,low32:t}}for(r=3;this.offset<this.buf.byteLength;){const i=this.buf[this.offset];if(r===31&&i!==0&&i!==127)throw new RangeError("number out of range");if(n|=(i&127)<<r,r+=7,this.offset++,!(i&128))return i&64&&r<32&&(n|=-1<<r),{high32:n,low32:t}}throw new RangeError("buffer ended with incomplete number")}readRawBytes(t){const n=this.offset;if(n+t>this.buf.byteLength)throw new RangeError("subarray exceeds buffer size");return this.offset+=t,this.buf.subarray(n,this.offset)}readRawString(t){return Kh(this.readRawBytes(t))}readPrefixedBytes(){return this.readRawBytes(this.readUint53())}readPrefixedString(){return Kh(this.readPrefixedBytes())}readHexString(){return t0(this.readPrefixedBytes())}},n0=class extends Tp{constructor(t){super(),this.type=t,this.state="empty",this.lastValue=void 0,this.count=0,this.literal=[]}appendValue(t,n=1){this._appendValue(t,n)}_appendValue(t,n=1){n<=0||(this.state==="empty"?(this.state=t===null?"nulls":n===1?"loneValue":"repetition",this.lastValue=t,this.count=n):this.state==="loneValue"?t===null?(this.flush(),this.state="nulls",this.count=n):t===this.lastValue?(this.state="repetition",this.count=1+n):n>1?(this.flush(),this.state="repetition",this.count=n,this.lastValue=t):(this.state="literal",this.literal=[this.lastValue],this.lastValue=t):this.state==="repetition"?t===null?(this.flush(),this.state="nulls",this.count=n):t===this.lastValue?this.count+=n:n>1?(this.flush(),this.state="repetition",this.count=n,this.lastValue=t):(this.flush(),this.state="loneValue",this.lastValue=t):this.state==="literal"?t===null?(this.literal.push(this.lastValue),this.flush(),this.state="nulls",this.count=n):t===this.lastValue?(this.flush(),this.state="repetition",this.count=1+n):n>1?(this.literal.push(this.lastValue),this.flush(),this.state="repetition",this.count=n,this.lastValue=t):(this.literal.push(this.lastValue),this.lastValue=t):this.state==="nulls"&&(t===null?this.count+=n:n>1?(this.flush(),this.state="repetition",this.count=n,this.lastValue=t):(this.flush(),this.state="loneValue",this.lastValue=t)))}copyFrom(t,n={}){const{count:r,sumValues:i,sumShift:a}=n;if(!(t instanceof Pp)||t.type!==this.type)throw new TypeError("incompatible type of decoder");let o=typeof r=="number"?r:Number.MAX_SAFE_INTEGER,l=0,c=0;if(r&&o>0&&t.done)throw new RangeError(`cannot copy ${r} values`);if(o===0||t.done)return i?{nonNullValues:l,sum:c}:{nonNullValues:l};let u=t.readValue();if(u===null){const p=Math.min(t.count+1,o);if(o-=p,t.count-=p-1,this.appendValue(null,p),r&&o>0&&t.done)throw new RangeError(`cannot copy ${r} values`);if(o===0||t.done)return i?{nonNullValues:l,sum:c}:{nonNullValues:l};if(u=t.readValue(),u===null)throw new RangeError("null run must be followed by non-null value")}if(this.appendValue(u),o--,l++,i&&(c+=a?u>>>a:u),r&&o>0&&t.done)throw new RangeError(`cannot copy ${r} values`);if(o===0||t.done)return i?{nonNullValues:l,sum:c}:{nonNullValues:l};let d=t.count>0;for(;o>0&&!t.done;){d||t.readRecord();const p=Math.min(t.count,o);if(t.count-=p,t.state==="literal"){l+=p;for(let h=0;h<p;h++){if(t.done)throw new RangeError("incomplete literal");const f=t.readRawValue();if(f===t.lastValue)throw new RangeError("Repetition of values is not allowed in literal");t.lastValue=f,this._appendValue(f),i&&(c+=a?f>>>a:f)}}else if(t.state==="repetition"){l+=p,i&&(c+=p*(a?t.lastValue>>>a:t.lastValue));const h=t.lastValue;if(this._appendValue(h),p>1){if(this._appendValue(h),this.state!=="repetition")throw new RangeError(`Unexpected state ${this.state}`);this.count+=p-2}}else if(t.state==="nulls"){if(this._appendValue(null),this.state!=="nulls")throw new RangeError(`Unexpected state ${this.state}`);this.count+=p-1}d=!1,o-=p}if(r&&o>0&&t.done)throw new RangeError(`cannot copy ${r} values`);return i?{nonNullValues:l,sum:c}:{nonNullValues:l}}flush(){if(this.state==="loneValue")this.appendInt32(-1),this.appendRawValue(this.lastValue);else if(this.state==="repetition")this.appendInt53(this.count),this.appendRawValue(this.lastValue);else if(this.state==="literal"){this.appendInt53(-this.literal.length);for(let t of this.literal)this.appendRawValue(t)}else this.state==="nulls"&&(this.appendInt32(0),this.appendUint53(this.count));this.state="empty"}appendRawValue(t){if(this.type==="int")this.appendInt53(t);else if(this.type==="uint")this.appendUint53(t);else if(this.type==="utf8")this.appendPrefixedString(t);else throw new RangeError(`Unknown RLEEncoder datatype: ${this.type}`)}finish(){this.state==="literal"&&this.literal.push(this.lastValue),(this.state!=="nulls"||this.offset>0)&&this.flush()}},Pp=class extends Op{constructor(t,n){super(n),this.type=t,this.lastValue=void 0,this.count=0,this.state=void 0}get done(){return this.count===0&&this.offset===this.buf.byteLength}reset(){this.offset=0,this.lastValue=void 0,this.count=0,this.state=void 0}readValue(){if(this.done)return null;if(this.count===0&&this.readRecord(),this.count-=1,this.state==="literal"){const t=this.readRawValue();if(t===this.lastValue)throw new RangeError("Repetition of values is not allowed in literal");return this.lastValue=t,t}else return this.lastValue}skipValues(t){for(;t>0&&!this.done;){this.count===0&&(this.count=this.readInt53(),this.count>0?(this.lastValue=this.count<=t?this.skipRawValues(1):this.readRawValue(),this.state="repetition"):this.count<0?(this.count=-this.count,this.state="literal"):(this.count=this.readUint53(),this.lastValue=null,this.state="nulls"));const n=Math.min(t,this.count);this.state==="literal"&&this.skipRawValues(n),t-=n,this.count-=n}}readRecord(){if(this.count=this.readInt53(),this.count>1){const t=this.readRawValue();if((this.state==="repetition"||this.state==="literal")&&this.lastValue===t)throw new RangeError("Successive repetitions with the same value are not allowed");this.state="repetition",this.lastValue=t}else{if(this.count===1)throw new RangeError("Repetition count of 1 is not allowed, use a literal instead");if(this.count<0){if(this.count=-this.count,this.state==="literal")throw new RangeError("Successive literals are not allowed");this.state="literal"}else{if(this.state==="nulls")throw new RangeError("Successive null runs are not allowed");if(this.count=this.readUint53(),this.count===0)throw new RangeError("Zero-length null runs are not allowed");this.lastValue=null,this.state="nulls"}}}readRawValue(){if(this.type==="int")return this.readInt53();if(this.type==="uint")return this.readUint53();if(this.type==="utf8")return this.readPrefixedString();throw new RangeError(`Unknown RLEDecoder datatype: ${this.type}`)}skipRawValues(t){if(this.type==="utf8")for(let n=0;n<t;n++)this.skip(this.readUint53());else{for(;t>0&&this.offset<this.buf.byteLength;)this.buf[this.offset]&128||t--,this.offset++;if(t>0)throw new RangeError("cannot skip beyond end of buffer")}}},VR=class extends n0{constructor(){super("int"),this.absoluteValue=0}appendValue(t,n=1){n<=0||(typeof t=="number"?(super.appendValue(t-this.absoluteValue,1),this.absoluteValue=t,n>1&&super.appendValue(0,n-1)):super.appendValue(t,n))}copyFrom(t,n={}){if(n.sumValues)throw new RangeError("unsupported options for DeltaEncoder.copyFrom()");if(!(t instanceof r0))throw new TypeError("incompatible type of decoder");let r=n.count;if(r>0&&t.done)throw new RangeError(`cannot copy ${r} values`);if(r===0||t.done)return;let i=t.readValue(),a=0;if(this.appendValue(i),i===null){if(a=t.count+1,r!==void 0&&r<a&&(a=r),t.count-=a-1,this.count+=a-1,r>a&&t.done)throw new RangeError(`cannot copy ${r} values`);if(r===a||t.done)return;t.count===0&&this.appendValue(t.readValue())}r!==void 0&&(r-=a+1);const{nonNullValues:o,sum:l}=super.copyFrom(t,{count:r,sumValues:!0});o>0&&(this.absoluteValue=l,t.absoluteValue=l)}},r0=class extends Pp{constructor(t){super("int",t),this.absoluteValue=0}reset(){this.offset=0,this.lastValue=void 0,this.count=0,this.state=void 0,this.absoluteValue=0}readValue(){const t=super.readValue();return t===null?null:(this.absoluteValue+=t,this.absoluteValue)}skipValues(t){for(;t>0&&!this.done;){this.count===0&&this.readRecord();const n=Math.min(t,this.count);if(this.state==="literal")for(let r=0;r<n;r++)this.lastValue=this.readRawValue(),this.absoluteValue+=this.lastValue;else this.state==="repetition"&&(this.absoluteValue+=n*this.lastValue);t-=n,this.count-=n}}},$R=class extends Tp{constructor(){super(),this.lastValue=!1,this.count=0}appendValue(t,n=1){if(t!==!1&&t!==!0)throw new RangeError(`Unsupported value for BooleanEncoder: ${t}`);n<=0||(this.lastValue===t?this.count+=n:(this.appendUint53(this.count),this.lastValue=t,this.count=n))}copyFrom(t,n={}){if(!(t instanceof s0))throw new TypeError("incompatible type of decoder");const{count:r}=n;let i=typeof r=="number"?r:Number.MAX_SAFE_INTEGER;if(r&&i>0&&t.done)throw new RangeError(`cannot copy ${r} values`);if(i===0||t.done)return;this.appendValue(t.readValue()),i--;const a=Math.min(t.count,i);for(this.count+=a,t.count-=a,i-=a;i>0&&!t.done;){if(t.count=t.readUint53(),t.count===0)throw new RangeError("Zero-length runs are not allowed");t.lastValue=!t.lastValue,this.appendUint53(this.count);const o=Math.min(t.count,i);this.count=o,this.lastValue=t.lastValue,t.count-=o,i-=o}if(r&&i>0&&t.done)throw new RangeError(`cannot copy ${r} values`)}finish(){this.count>0&&(this.appendUint53(this.count),this.count=0)}},s0=class extends Op{constructor(t){super(t),this.lastValue=!0,this.firstRun=!0,this.count=0}get done(){return this.count===0&&this.offset===this.buf.byteLength}reset(){this.offset=0,this.lastValue=!0,this.firstRun=!0,this.count=0}readValue(){if(this.done)return!1;for(;this.count===0;){if(this.count=this.readUint53(),this.lastValue=!this.lastValue,this.count===0&&!this.firstRun)throw new RangeError("Zero-length runs are not allowed");this.firstRun=!1}return this.count-=1,this.lastValue}skipValues(t){for(;t>0&&!this.done;){if(this.count===0){if(this.count=this.readUint53(),this.lastValue=!this.lastValue,this.count===0&&!this.firstRun)throw new RangeError("Zero-length runs are not allowed");this.firstRun=!1}this.count<t?(t-=this.count,this.count=0):(this.count-=t,t=0)}}};var i0={utf8ToString:Kh,hexStringToBytes:Xb,bytesToHexString:t0,Encoder:Tp,Decoder:Op,RLEEncoder:n0,RLEDecoder:Pp,DeltaEncoder:VR,DeltaDecoder:r0,BooleanEncoder:$R,BooleanDecoder:s0},a0={exports:{}};(function(e){(function(t,n){var r={};n(r);var i=r.default;for(var a in r)i[a]=r[a];e.exports=i})(Ka,function(t){t.__esModule=!0,t.digestLength=32,t.blockSize=64;var n=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function r(h,f,y,b,E){for(var g,x,w,_,S,k,I,C,L,V,B,Y,W;E>=64;){for(g=f[0],x=f[1],w=f[2],_=f[3],S=f[4],k=f[5],I=f[6],C=f[7],V=0;V<16;V++)B=b+V*4,h[V]=(y[B]&255)<<24|(y[B+1]&255)<<16|(y[B+2]&255)<<8|y[B+3]&255;for(V=16;V<64;V++)L=h[V-2],Y=(L>>>17|L<<15)^(L>>>19|L<<13)^L>>>10,L=h[V-15],W=(L>>>7|L<<25)^(L>>>18|L<<14)^L>>>3,h[V]=(Y+h[V-7]|0)+(W+h[V-16]|0);for(V=0;V<64;V++)Y=(((S>>>6|S<<26)^(S>>>11|S<<21)^(S>>>25|S<<7))+(S&k^~S&I)|0)+(C+(n[V]+h[V]|0)|0)|0,W=((g>>>2|g<<30)^(g>>>13|g<<19)^(g>>>22|g<<10))+(g&x^g&w^x&w)|0,C=I,I=k,k=S,S=_+Y|0,_=w,w=x,x=g,g=Y+W|0;f[0]+=g,f[1]+=x,f[2]+=w,f[3]+=_,f[4]+=S,f[5]+=k,f[6]+=I,f[7]+=C,b+=64,E-=64}return b}var i=function(){function h(){this.digestLength=t.digestLength,this.blockSize=t.blockSize,this.state=new Int32Array(8),this.temp=new Int32Array(64),this.buffer=new Uint8Array(128),this.bufferLength=0,this.bytesHashed=0,this.finished=!1,this.reset()}return h.prototype.reset=function(){return this.state[0]=1779033703,this.state[1]=3144134277,this.state[2]=1013904242,this.state[3]=2773480762,this.state[4]=1359893119,this.state[5]=2600822924,this.state[6]=528734635,this.state[7]=1541459225,this.bufferLength=0,this.bytesHashed=0,this.finished=!1,this},h.prototype.clean=function(){for(var f=0;f<this.buffer.length;f++)this.buffer[f]=0;for(var f=0;f<this.temp.length;f++)this.temp[f]=0;this.reset()},h.prototype.update=function(f,y){if(y===void 0&&(y=f.length),this.finished)throw new Error("SHA256: can't update because hash was finished.");var b=0;if(this.bytesHashed+=y,this.bufferLength>0){for(;this.bufferLength<64&&y>0;)this.buffer[this.bufferLength++]=f[b++],y--;this.bufferLength===64&&(r(this.temp,this.state,this.buffer,0,64),this.bufferLength=0)}for(y>=64&&(b=r(this.temp,this.state,f,b,y),y%=64);y>0;)this.buffer[this.bufferLength++]=f[b++],y--;return this},h.prototype.finish=function(f){if(!this.finished){var y=this.bytesHashed,b=this.bufferLength,E=y/536870912|0,g=y<<3,x=y%64<56?64:128;this.buffer[b]=128;for(var w=b+1;w<x-8;w++)this.buffer[w]=0;this.buffer[x-8]=E>>>24&255,this.buffer[x-7]=E>>>16&255,this.buffer[x-6]=E>>>8&255,this.buffer[x-5]=E>>>0&255,this.buffer[x-4]=g>>>24&255,this.buffer[x-3]=g>>>16&255,this.buffer[x-2]=g>>>8&255,this.buffer[x-1]=g>>>0&255,r(this.temp,this.state,this.buffer,0,x),this.finished=!0}for(var w=0;w<8;w++)f[w*4+0]=this.state[w]>>>24&255,f[w*4+1]=this.state[w]>>>16&255,f[w*4+2]=this.state[w]>>>8&255,f[w*4+3]=this.state[w]>>>0&255;return this},h.prototype.digest=function(){var f=new Uint8Array(this.digestLength);return this.finish(f),f},h.prototype._saveState=function(f){for(var y=0;y<this.state.length;y++)f[y]=this.state[y]},h.prototype._restoreState=function(f,y){for(var b=0;b<this.state.length;b++)this.state[b]=f[b];this.bytesHashed=y,this.finished=!1,this.bufferLength=0},h}();t.Hash=i;var a=function(){function h(f){this.inner=new i,this.outer=new i,this.blockSize=this.inner.blockSize,this.digestLength=this.inner.digestLength;var y=new Uint8Array(this.blockSize);if(f.length>this.blockSize)new i().update(f).finish(y).clean();else for(var b=0;b<f.length;b++)y[b]=f[b];for(var b=0;b<y.length;b++)y[b]^=54;this.inner.update(y);for(var b=0;b<y.length;b++)y[b]^=106;this.outer.update(y),this.istate=new Uint32Array(8),this.ostate=new Uint32Array(8),this.inner._saveState(this.istate),this.outer._saveState(this.ostate);for(var b=0;b<y.length;b++)y[b]=0}return h.prototype.reset=function(){return this.inner._restoreState(this.istate,this.inner.blockSize),this.outer._restoreState(this.ostate,this.outer.blockSize),this},h.prototype.clean=function(){for(var f=0;f<this.istate.length;f++)this.ostate[f]=this.istate[f]=0;this.inner.clean(),this.outer.clean()},h.prototype.update=function(f){return this.inner.update(f),this},h.prototype.finish=function(f){return this.outer.finished?this.outer.finish(f):(this.inner.finish(f),this.outer.update(f,this.digestLength).finish(f)),this},h.prototype.digest=function(){var f=new Uint8Array(this.digestLength);return this.finish(f),f},h}();t.HMAC=a;function o(h){var f=new i().update(h),y=f.digest();return f.clean(),y}t.hash=o,t.default=o;function l(h,f){var y=new a(h).update(f),b=y.digest();return y.clean(),b}t.hmac=l;function c(h,f,y,b){var E=b[0];if(E===0)throw new Error("hkdf: cannot expand more");f.reset(),E>1&&f.update(h),y&&f.update(y),f.update(b),f.finish(h),b[0]++}var u=new Uint8Array(t.digestLength);function d(h,f,y,b){f===void 0&&(f=u),b===void 0&&(b=32);for(var E=new Uint8Array([1]),g=l(f,h),x=new a(g),w=new Uint8Array(x.digestLength),_=w.length,S=new Uint8Array(b),k=0;k<b;k++)_===w.length&&(c(w,x,y,E),_=0),S[k]=w[_++];return x.clean(),w.fill(0),E.fill(0),S}t.hkdf=d;function p(h,f,y,b){for(var E=new a(h),g=E.digestLength,x=new Uint8Array(4),w=new Uint8Array(g),_=new Uint8Array(g),S=new Uint8Array(b),k=0;k*g<b;k++){var I=k+1;x[0]=I>>>24&255,x[1]=I>>>16&255,x[2]=I>>>8&255,x[3]=I>>>0&255,E.reset(),E.update(f),E.update(x),E.finish(_);for(var C=0;C<g;C++)w[C]=_[C];for(var C=2;C<=y;C++){E.reset(),E.update(_).finish(_);for(var L=0;L<g;L++)w[L]^=_[L]}for(var C=0;C<g&&k*g+C<b;C++)S[k*g+C]=w[C]}for(var k=0;k<g;k++)w[k]=_[k]=0;for(var k=0;k<4;k++)x[k]=0;return E.clean(),S}t.pbkdf2=p})})(a0);var FR=a0.exports;const ju=fr,{copyObject:Sy,parseOpId:Or,equalBytes:Ey}=hr,{utf8ToString:HR,hexStringToBytes:o0,bytesToHexString:bu,Encoder:pa,Decoder:Qt,RLEEncoder:Dn,RLEDecoder:Ny,DeltaEncoder:lc,DeltaDecoder:qR,BooleanEncoder:l0,BooleanDecoder:zR}=i0,{Hash:c0}=FR,Gi=new Uint8Array([133,111,74,131]),Lp=0,Ra=1,ll=2,u0=256,Ee={GROUP_CARD:0,ACTOR_ID:1,INT_RLE:2,INT_DELTA:3,BOOLEAN:4,STRING_RLE:5,VALUE_LEN:6,VALUE_RAW:7},Yo=8,We={NULL:0,FALSE:1,TRUE:2,LEB128_UINT:3,LEB128_INT:4,IEEE754:5,UTF8:6,BYTES:7,COUNTER:8,TIMESTAMP:9,MIN_UNKNOWN:10,MAX_UNKNOWN:15},jo=["makeMap","set","makeList","del","makeText","inc","makeTable","link"],WR={makeMap:"map",makeList:"list",makeText:"text",makeTable:"table"},d0=[{columnName:"objActor",columnId:0|Ee.ACTOR_ID},{columnName:"objCtr",columnId:0|Ee.INT_RLE},{columnName:"keyActor",columnId:16|Ee.ACTOR_ID},{columnName:"keyCtr",columnId:16|Ee.INT_DELTA},{columnName:"keyStr",columnId:16|Ee.STRING_RLE},{columnName:"idActor",columnId:32|Ee.ACTOR_ID},{columnName:"idCtr",columnId:32|Ee.INT_DELTA},{columnName:"insert",columnId:48|Ee.BOOLEAN},{columnName:"action",columnId:64|Ee.INT_RLE},{columnName:"valLen",columnId:80|Ee.VALUE_LEN},{columnName:"valRaw",columnId:80|Ee.VALUE_RAW},{columnName:"chldActor",columnId:96|Ee.ACTOR_ID},{columnName:"chldCtr",columnId:96|Ee.INT_DELTA}],Dp=d0.concat([{columnName:"predNum",columnId:112|Ee.GROUP_CARD},{columnName:"predActor",columnId:112|Ee.ACTOR_ID},{columnName:"predCtr",columnId:112|Ee.INT_DELTA}]),h0=d0.concat([{columnName:"succNum",columnId:128|Ee.GROUP_CARD},{columnName:"succActor",columnId:128|Ee.ACTOR_ID},{columnName:"succCtr",columnId:128|Ee.INT_DELTA}]),f0=[{columnName:"actor",columnId:0|Ee.ACTOR_ID},{columnName:"seq",columnId:0|Ee.INT_DELTA},{columnName:"maxOp",columnId:16|Ee.INT_DELTA},{columnName:"time",columnId:32|Ee.INT_DELTA},{columnName:"message",columnId:48|Ee.STRING_RLE},{columnName:"depsNum",columnId:64|Ee.GROUP_CARD},{columnName:"depsIndex",columnId:64|Ee.INT_DELTA},{columnName:"extraLen",columnId:80|Ee.VALUE_LEN},{columnName:"extraRaw",columnId:80|Ee.VALUE_RAW}];function Bl(e,t){if(!e||!e.actorId)return e;const n=e.counter,r=t.indexOf(e.actorId);if(r<0)throw new RangeError("missing actorId");return{counter:n,actorNum:r,actorId:e.actorId}}function p0(e,t){return e.counter<t.counter?-1:e.counter>t.counter?1:e.actorId<t.actorId?-1:e.actorId>t.actorId?1:0}function GR(e,t){const n={},r=[];for(let a of e)a=Sy(a),n[a.actor]=!0,a.ops=tT(a.ops,a.startOp,a.actor),a.ops=a.ops.map(o=>{o=Sy(o),o.obj!=="_root"&&(o.obj=Or(o.obj)),o.elemId&&o.elemId!=="_head"&&(o.elemId=Or(o.elemId)),o.child&&(o.child=Or(o.child)),o.pred&&(o.pred=o.pred.map(Or)),o.obj.actorId&&(n[o.obj.actorId]=!0),o.elemId&&o.elemId.actorId&&(n[o.elemId.actorId]=!0),o.child&&o.child.actorId&&(n[o.child.actorId]=!0);for(let l of o.pred)n[l.actorId]=!0;return o}),r.push(a);let i=Object.keys(n).sort();i=[e[0].actor].concat(i.filter(a=>a!==e[0].actor));for(let a of r){a.actorNum=i.indexOf(a.actor);for(let o=0;o<a.ops.length;o++){let l=a.ops[o];l.id={counter:a.startOp+o,actorNum:a.actorNum,actorId:a.actor},l.obj=Bl(l.obj,i),l.elemId=Bl(l.elemId,i),l.child=Bl(l.child,i),l.pred=l.pred.map(c=>Bl(c,i))}}return{changes:r,actorIds:i}}function YR(e,t){if(e.obj==="_root")t.objActor.appendValue(null),t.objCtr.appendValue(null);else if(e.obj.actorNum>=0&&e.obj.counter>0)t.objActor.appendValue(e.obj.actorNum),t.objCtr.appendValue(e.obj.counter);else throw new RangeError(`Unexpected objectId reference: ${JSON.stringify(e.obj)}`)}function KR(e,t){if(e.key)t.keyActor.appendValue(null),t.keyCtr.appendValue(null),t.keyStr.appendValue(e.key);else if(e.elemId==="_head"&&e.insert)t.keyActor.appendValue(null),t.keyCtr.appendValue(0),t.keyStr.appendValue(null);else if(e.elemId&&e.elemId.actorNum>=0&&e.elemId.counter>0)t.keyActor.appendValue(e.elemId.actorNum),t.keyCtr.appendValue(e.elemId.counter),t.keyStr.appendValue(null);else throw new RangeError(`Unexpected operation key: ${JSON.stringify(e)}`)}function JR(e,t){const n=jo.indexOf(e.action);if(n>=0)t.action.appendValue(n);else if(typeof e.action=="number")t.action.appendValue(e.action);else throw new RangeError(`Unexpected operation action: ${e.action}`)}function QR(e){switch(e.datatype){case"counter":return[We.COUNTER,e.value];case"timestamp":return[We.TIMESTAMP,e.value];case"uint":return[We.LEB128_UINT,e.value];case"int":return[We.LEB128_INT,e.value];case"float64":{const t=new ArrayBuffer(8);return new DataView(t).setFloat64(0,e.value,!0),[We.IEEE754,new Uint8Array(t)]}default:if(Number.isInteger(e.value)&&e.value<=Number.MAX_SAFE_INTEGER&&e.value>=Number.MIN_SAFE_INTEGER)return[We.LEB128_INT,e.value];{const t=new ArrayBuffer(8);return new DataView(t).setFloat64(0,e.value,!0),[We.IEEE754,new Uint8Array(t)]}}}function ZR(e,t){if(e.action!=="set"&&e.action!=="inc"||e.value===null)t.valLen.appendValue(We.NULL);else if(e.value===!1)t.valLen.appendValue(We.FALSE);else if(e.value===!0)t.valLen.appendValue(We.TRUE);else if(typeof e.value=="string"){const n=t.valRaw.appendRawString(e.value);t.valLen.appendValue(n<<4|We.UTF8)}else if(ArrayBuffer.isView(e.value)){const n=t.valRaw.appendRawBytes(new Uint8Array(e.value.buffer));t.valLen.appendValue(n<<4|We.BYTES)}else if(typeof e.value=="number"){let[n,r]=QR(e),i;n===We.LEB128_UINT?i=t.valRaw.appendUint53(r):n===We.IEEE754?i=t.valRaw.appendRawBytes(r):i=t.valRaw.appendInt53(r),t.valLen.appendValue(i<<4|n)}else if(typeof e.datatype=="number"&&e.datatype>=We.MIN_UNKNOWN&&e.datatype<=We.MAX_UNKNOWN&&e.value instanceof Uint8Array){const n=t.valRaw.appendRawBytes(e.value);t.valLen.appendValue(n<<4|e.datatype)}else throw e.datatype?new RangeError(`Unknown datatype ${e.datatype} for value ${e.value}`):new RangeError(`Unsupported value in operation: ${e.value}`)}function m0(e,t){if(e===We.NULL)return{value:null};if(e===We.FALSE)return{value:!1};if(e===We.TRUE)return{value:!0};if(e%16===We.UTF8)return{value:HR(t)};if(e%16===We.LEB128_UINT)return{value:new Qt(t).readUint53(),datatype:"uint"};if(e%16===We.LEB128_INT)return{value:new Qt(t).readInt53(),datatype:"int"};if(e%16===We.IEEE754){const n=new DataView(t.buffer,t.byteOffset,t.byteLength);if(t.byteLength===8)return{value:n.getFloat64(0,!0),datatype:"float64"};throw new RangeError(`Invalid length for floating point number: ${t.byteLength}`)}else return e%16===We.COUNTER?{value:new Qt(t).readInt53(),datatype:"counter"}:e%16===We.TIMESTAMP?{value:new Qt(t).readInt53(),datatype:"timestamp"}:{value:t,datatype:e%16}}function _y(e,t,n,r){const{columnId:i,columnName:a,decoder:o}=e[t];if(i%8===Ee.VALUE_LEN&&t+1<e.length&&e[t+1].columnId===i+1){const l=o.readValue(),c=e[t+1].decoder.readRawBytes(l>>4),{value:u,datatype:d}=m0(l,c);return r[a]=u,d&&(r[a+"_datatype"]=d),2}else if(i%8===Ee.ACTOR_ID){const l=o.readValue();if(l===null)r[a]=null;else{if(!n[l])throw new RangeError(`No actor index ${l}`);r[a]=n[l]}}else r[a]=o.readValue();return 1}function XR(e,t){const n={objActor:new Dn("uint"),objCtr:new Dn("uint"),keyActor:new Dn("uint"),keyCtr:new lc,keyStr:new Dn("utf8"),insert:new l0,action:new Dn("uint"),valLen:new Dn("uint"),valRaw:new pa,chldActor:new Dn("uint"),chldCtr:new lc};n.predNum=new Dn("uint"),n.predCtr=new lc,n.predActor=new Dn("uint");for(let i of e){YR(i,n),KR(i,n),n.insert.appendValue(!!i.insert),JR(i,n),ZR(i,n),i.child&&i.child.counter?(n.chldActor.appendValue(i.child.actorNum),n.chldCtr.appendValue(i.child.counter)):(n.chldActor.appendValue(null),n.chldCtr.appendValue(null));{n.predNum.appendValue(i.pred.length),i.pred.sort(p0);for(let a=0;a<i.pred.length;a++)n.predActor.appendValue(i.pred[a].actorNum),n.predCtr.appendValue(i.pred[a].counter)}}let r=[];for(let{columnName:i,columnId:a}of Dp)n[i]&&r.push({columnId:a,columnName:i,encoder:n[i]});return r.sort((i,a)=>i.columnId-a.columnId)}function eT(e,t){return t===void 0?typeof e=="string"||typeof e=="boolean"||e===null:typeof e=="number"}function tT(e,t,n){let r=t,i=[];for(const a of e)if(a.action==="set"&&a.values&&a.insert){if(a.pred.length!==0)throw new RangeError("multi-insert pred must be empty");let o=a.elemId;const l=a.datatype;for(const c of a.values){if(!eT(c,l))throw new RangeError(`Decode failed: bad value/datatype association (${c},${l})`);i.push({action:"set",obj:a.obj,elemId:o,datatype:l,value:c,pred:[],insert:!0}),o=`${r}@${n}`,r+=1}}else if(a.action==="del"&&a.multiOp>1){if(a.pred.length!==1)throw new RangeError("multiOp deletion must have exactly one pred");const o=Or(a.elemId),l=Or(a.pred[0]);for(let c=0;c<a.multiOp;c++){const u=`${o.counter+c}@${o.actorId}`,d=[`${l.counter+c}@${l.actorId}`];i.push({action:"del",obj:a.obj,elemId:u,pred:d}),r+=1}}else i.push(a),r+=1;return i}function g0(e,t){const n=[];for(let r of e){const i=r.objCtr===null?"_root":`${r.objCtr}@${r.objActor}`,a=r.keyStr?void 0:r.keyCtr===0?"_head":`${r.keyCtr}@${r.keyActor}`,o=jo[r.action]||r.action,l=a?{obj:i,elemId:a,action:o}:{obj:i,key:r.keyStr,action:o};if(l.insert=!!r.insert,(jo[r.action]==="set"||jo[r.action]==="inc")&&(l.value=r.valLen,r.valLen_datatype&&(l.datatype=r.valLen_datatype)),!!r.chldCtr!=!!r.chldActor)throw new RangeError(`Mismatched child columns: ${r.chldCtr} and ${r.chldActor}`);r.chldCtr!==null&&(l.child=`${r.chldCtr}@${r.chldActor}`),t?(l.id=`${r.idCtr}@${r.idActor}`,l.succ=r.succNum.map(c=>`${c.succCtr}@${c.succActor}`),Ay(r.succNum.map(c=>({counter:c.succCtr,actorId:c.succActor})))):(l.pred=r.predNum.map(c=>`${c.predCtr}@${c.predActor}`),Ay(r.predNum.map(c=>({counter:c.predCtr,actorId:c.predActor})))),n.push(l)}return n}function Ay(e){let t=null;for(let n of e){if(t&&p0(t,n)!==-1)throw new RangeError("operation IDs are not in ascending order");t=n}}function nT(e){return(e&7)===Ee.INT_DELTA?new lc:(e&7)===Ee.BOOLEAN?new l0:(e&7)===Ee.STRING_RLE?new Dn("utf8"):(e&7)===Ee.VALUE_RAW?new pa:new Dn("uint")}function cc(e,t){return(e&7)===Ee.INT_DELTA?new qR(t):(e&7)===Ee.BOOLEAN?new zR(t):(e&7)===Ee.STRING_RLE?new Ny("utf8",t):(e&7)===Ee.VALUE_RAW?new Qt(t):new Ny("uint",t)}function y0(e,t){const n=new Uint8Array(0);let r=[],i=0,a=0;for(;i<e.length||a<t.length;)if(i===e.length||a<t.length&&t[a].columnId<e[i].columnId){const{columnId:o,columnName:l}=t[a];r.push({columnId:o,columnName:l,decoder:cc(o,n)}),a++}else if(a===t.length||e[i].columnId<t[a].columnId){const{columnId:o,buffer:l}=e[i];r.push({columnId:o,decoder:cc(o,l)}),i++}else{const{columnId:o,buffer:l}=e[i],{columnName:c}=t[a];r.push({columnId:o,columnName:c,decoder:cc(o,l)}),i++,a++}return r}function Jh(e,t,n){e=y0(e,n);let r=[];for(;e.some(i=>!i.decoder.done);){let i={},a=0;for(;a<e.length;){const o=e[a].columnId;let l=o>>4,c=1;for(;a+c<e.length&&e[a+c].columnId>>4===l;)c++;if(o%8===Ee.GROUP_CARD){const u=[],d=e[a].decoder.readValue();for(let p=0;p<d;p++){let h={};for(let f=1;f<c;f++)_y(e,a+f,t,h);u.push(h)}i[e[a].columnName]=u,a+=c}else a+=_y(e,a,t,i)}r.push(i)}return r}function Qh(e){const t=(-1^Yo)>>>0;let n=-1,r=[],i=e.readUint53();for(let a=0;a<i;a++){const o=e.readUint53(),l=e.readUint53();if((o&t)<=(n&t))throw new RangeError("Columns must be in ascending order");n=o,r.push({columnId:o,bufferLen:l})}return r}function Zh(e,t){const n=t.filter(r=>r.encoder.buffer.byteLength>0);e.appendUint53(n.length);for(let r of n)e.appendUint53(r.columnId),e.appendUint53(r.encoder.buffer.byteLength)}function v0(e){const t=e.readUint53(),n=[];for(let o=0;o<t;o++)n.push(bu(e.readRawBytes(32)));let r={actor:e.readHexString(),seq:e.readUint53(),startOp:e.readUint53(),time:e.readInt53(),message:e.readPrefixedString(),deps:n};const i=[r.actor],a=e.readUint53();for(let o=0;o<a;o++)i.push(e.readHexString());return r.actorIds=i,r}function x0(e,t){const r=Gi.byteLength+4+1+5,i=new pa;i.appendRawBytes(new Uint8Array(r)),t(i);const a=i.buffer,o=new pa;o.appendByte(e),o.appendUint53(a.byteLength-r);const l=o.buffer,c=new c0;c.update(l),c.update(a.subarray(r));const u=c.digest(),d=u.subarray(0,4);return a.set(Gi,r-l.byteLength-4-Gi.byteLength),a.set(d,r-l.byteLength-4),a.set(l,r-l.byteLength),{hash:u,bytes:a.subarray(r-l.byteLength-4-Gi.byteLength)}}function Ta(e,t){if(!Ey(e.readRawBytes(Gi.byteLength),Gi))throw new RangeError("Data does not begin with magic bytes 85 6f 4a 83");const n=e.readRawBytes(4),r=e.offset,i=e.readByte(),a=e.readUint53(),o={chunkType:i,chunkLength:a,chunkData:e.readRawBytes(a)};if(t){const l=new c0;l.update(e.buf.subarray(r,e.offset));const c=l.digest();if(!Ey(c.subarray(0,4),n))throw new RangeError("checksum does not match data");o.hash=bu(c)}return o}function j0(e){const{changes:t,actorIds:n}=GR([e]),r=t[0],{hash:i,bytes:a}=x0(Ra,l=>{if(!Array.isArray(r.deps))throw new TypeError("deps is not an array");l.appendUint53(r.deps.length);for(let u of r.deps.slice().sort())l.appendRawBytes(o0(u));l.appendHexString(r.actor),l.appendUint53(r.seq),l.appendUint53(r.startOp),l.appendInt53(r.time),l.appendPrefixedString(r.message||""),l.appendUint53(n.length-1);for(let u of n.slice(1))l.appendHexString(u);const c=XR(r.ops);Zh(l,c);for(let u of c)l.appendRawBytes(u.encoder.buffer);r.extraBytes&&l.appendRawBytes(r.extraBytes)}),o=bu(i);if(e.hash&&e.hash!==o)throw new RangeError(`Change hash does not match encoding: ${e.hash} != ${o}`);return a.byteLength>=u0?sT(a):a}function b0(e){e[8]===ll&&(e=w0(e));const t=new Qt(e),n=Ta(t,!0),r=new Qt(n.chunkData);if(!t.done)throw new RangeError("Encoded change has trailing data");if(n.chunkType!==Ra)throw new RangeError(`Unexpected chunk type: ${n.chunkType}`);const i=v0(r),a=Qh(r);for(let o=0;o<a.length;o++){if(a[o].columnId&Yo)throw new RangeError("change must not contain deflated columns");a[o].buffer=r.readRawBytes(a[o].bufferLen)}if(!r.done){const o=r.buf.byteLength-r.offset;i.extraBytes=r.readRawBytes(o)}return i.columns=a,i.hash=n.hash,i}function Mp(e){const t=b0(e);return t.ops=g0(Jh(t.columns,t.actorIds,Dp),!1),delete t.actorIds,delete t.columns,t}function rT(e,t){e[8]===ll&&(e=w0(e));const n=Ta(new Qt(e),t);if(n.chunkType!==Ra)throw new RangeError("Buffer chunk type is not a change");const r=v0(new Qt(n.chunkData));return r.change=e,t&&(r.hash=n.hash),r}function sT(e){const t=Ta(new Qt(e),!1);if(t.chunkType!==Ra)throw new RangeError(`Unexpected chunk type: ${t.chunkType}`);const n=ju.deflateRaw(t.chunkData),r=new pa;return r.appendRawBytes(e.subarray(0,8)),r.appendByte(ll),r.appendUint53(n.byteLength),r.appendRawBytes(n),r.buffer}function w0(e){const t=Ta(new Qt(e),!1);if(t.chunkType!==ll)throw new RangeError(`Unexpected chunk type: ${t.chunkType}`);const n=ju.inflateRaw(t.chunkData),r=new pa;return r.appendRawBytes(e.subarray(0,8)),r.appendByte(Ra),r.appendUint53(n.byteLength),r.appendRawBytes(n),r.buffer}function iT(e){let t=new Qt(e),n=[],r=0;for(;!t.done;)Ta(t,!1),n.push(e.subarray(r,t.offset)),r=t.offset;return n}function aT(e){let t=[];for(let n of e)for(let r of iT(n))r[8]===Lp?t=t.concat(dT(r)):(r[8]===Ra||r[8]===ll)&&t.push(Mp(r));return t}function oT(e,t){if(e===t)return 0;if(e==="_root")return-1;if(t==="_root")return 1;const n=Or(e),r=Or(t);return n.counter<r.counter?-1:n.counter>r.counter?1:n.actorId<r.actorId?-1:n.actorId>r.actorId?1:0}function lT(e,t){let n={};for(let i of e){if(i.ops=[],n[i.actor]||(n[i.actor]=[]),i.seq!==n[i.actor].length+1)throw new RangeError(`Expected seq = ${n[i.actor].length+1}, got ${i.seq}`);if(i.seq>1&&n[i.actor][i.seq-2].maxOp>i.maxOp)throw new RangeError("maxOp must increase monotonically per actor");n[i.actor].push(i)}let r={};for(let i of t){if(i.action==="del")throw new RangeError("document should not contain del operations");i.pred=r[i.id]?r[i.id].pred:[],r[i.id]=i;for(let a of i.succ){if(!r[a])if(i.elemId){const o=i.insert?i.id:i.elemId;r[a]={id:a,action:"del",obj:i.obj,elemId:o,pred:[]}}else r[a]={id:a,action:"del",obj:i.obj,key:i.key,pred:[]};r[a].pred.push(i.id)}delete i.succ}for(let i of Object.values(r))i.action==="del"&&t.push(i);for(let i of t){const{counter:a,actorId:o}=Or(i.id),l=n[o];let c=0,u=l.length;for(;c<u;){const d=Math.floor((c+u)/2);l[d].maxOp<a?c=d+1:u=d}if(c>=l.length)throw new RangeError(`Operation ID ${i.id} outside of allowed range`);l[c].ops.push(i)}for(let i of e){i.ops.sort((a,o)=>oT(a.id,o.id)),i.startOp=i.maxOp-i.ops.length+1,delete i.maxOp;for(let a=0;a<i.ops.length;a++){const o=i.ops[a],l=`${i.startOp+a}@${i.actor}`;if(o.id!==l)throw new RangeError(`Expected opId ${l}, got ${o.id}`);delete o.id}}}function cT(e,t){let n={};for(let o=0;o<e.length;o++){let l=e[o];l.deps=[];for(let c of l.depsNum.map(u=>u.depsIndex)){if(!e[c]||!e[c].hash)throw new RangeError(`No hash for index ${c} while processing index ${o}`);const u=e[c].hash;l.deps.push(u),n[u]&&delete n[u]}if(l.deps.sort(),delete l.depsNum,l.extraLen_datatype!==We.BYTES)throw new RangeError(`Bad datatype for extra bytes: ${We.BYTES}`);l.extraBytes=l.extraLen,delete l.extraLen_datatype,e[o]=Mp(j0(l)),n[e[o].hash]=!0}const r=Object.keys(n).sort();let i=r.length===t.length,a=0;for(;i&&a<r.length;)i=r[a]===t[a],a++;if(!i)throw new RangeError(`Mismatched heads hashes: expected ${t.join(", ")}, got ${r.join(", ")}`)}function uT(e){const{changesColumns:t,opsColumns:n,actorIds:r,heads:i,headsIndexes:a,extraBytes:o}=e;for(let l of t)Cy(l);for(let l of n)Cy(l);return x0(Lp,l=>{l.appendUint53(r.length);for(let c of r)l.appendHexString(c);l.appendUint53(i.length);for(let c of i.sort())l.appendRawBytes(o0(c));Zh(l,t),Zh(l,n);for(let c of t)l.appendRawBytes(c.encoder.buffer);for(let c of n)l.appendRawBytes(c.encoder.buffer);for(let c of a)l.appendUint53(c);o&&l.appendRawBytes(o)}).bytes}function S0(e){const t=new Qt(e),n=Ta(t,!0),r=new Qt(n.chunkData);if(!t.done)throw new RangeError("Encoded document has trailing data");if(n.chunkType!==Lp)throw new RangeError(`Unexpected chunk type: ${n.chunkType}`);const i=[],a=r.readUint53();for(let h=0;h<a;h++)i.push(r.readHexString());const o=[],l=[],c=r.readUint53();for(let h=0;h<c;h++)o.push(bu(r.readRawBytes(32)));const u=Qh(r),d=Qh(r);for(let h=0;h<u.length;h++)u[h].buffer=r.readRawBytes(u[h].bufferLen),ky(u[h]);for(let h=0;h<d.length;h++)d[h].buffer=r.readRawBytes(d[h].bufferLen),ky(d[h]);if(!r.done)for(let h=0;h<c;h++)l.push(r.readUint53());const p=r.readRawBytes(r.buf.byteLength-r.offset);return{changesColumns:u,opsColumns:d,actorIds:i,heads:o,headsIndexes:l,extraBytes:p}}function dT(e){const{changesColumns:t,opsColumns:n,actorIds:r,heads:i}=S0(e),a=Jh(t,r,f0),o=g0(Jh(n,r,h0),!0);return lT(a,o),cT(a,i),a}function Cy(e){e.encoder.buffer.byteLength>=u0&&(e.encoder={buffer:ju.deflateRaw(e.encoder.buffer)},e.columnId|=Yo)}function ky(e){e.columnId&Yo&&(e.buffer=ju.inflateRaw(e.buffer),e.columnId^=Yo)}var wu={COLUMN_TYPE:Ee,VALUE_TYPE:We,ACTIONS:jo,OBJECT_TYPE:WR,DOC_OPS_COLUMNS:h0,CHANGE_COLUMNS:Dp,DOCUMENT_COLUMNS:f0,encoderByColumnId:nT,decoderByColumnId:cc,makeDecoders:y0,decodeValue:m0,encodeChange:j0,decodeChangeColumns:b0,decodeChange:Mp,decodeChangeMeta:rT,decodeChanges:aT,encodeDocumentHeader:uT,decodeDocumentHeader:S0};const{parseOpId:Wc,copyObject:Gc}=hr,{COLUMN_TYPE:Rt,VALUE_TYPE:Xh,ACTIONS:Nr,OBJECT_TYPE:Iy,DOC_OPS_COLUMNS:Ry,CHANGE_COLUMNS:qe,DOCUMENT_COLUMNS:Mn,encoderByColumnId:ma,decoderByColumnId:Up,makeDecoders:Ko,decodeValue:Vl,encodeChange:hT,decodeChangeColumns:fT,decodeChangeMeta:pT,decodeChanges:mT,decodeDocumentHeader:gT,encodeDocumentHeader:yT}=wu,Su=600,vT=10,E0=7,N0=Math.floor(vT*Su/8),ut=0,it=1,kt=2,It=3,Ie=4,Mt=5,Je=6,Ut=7,mt=8,ts=9,Qs=10,ns=13,ta=14,na=15,Fn=13,ef=14,ra=15,Ty=qe.filter(e=>["predNum","predActor","predCtr"].includes(e.columnName)).map(e=>e.columnId);function tf(e,t,n){if(t.length===1)e[t[0]]=n;else{let r=Object.assign({},e[t[0]]);tf(r,t.slice(1),n),e[t[0]]=r}}function Oy(e,t,n,r){for(let O of t)O.decoder.reset();const{objActor:i,objCtr:a,keyActor:o,keyCtr:l,keyStr:c,idActor:u,idCtr:d,insert:p}=e,[h,f,,,y,b,E,g,x,,,,,w]=t.map(O=>O.decoder);let _=0,S=0,k=!1,I=null,C=null,L=null,V=null,B=null,Y=null,W=0;if(a!==null&&!r)for(;(!f.done||!h.done||!x.done)&&(C=f.readValue(),I=n[h.readValue()],x.skipValues(1),C===null||!I||C<a||C===a&&I<i);)_+=1;if((C!==a||I!==i)&&!r)return{found:!0,skipCount:_,visibleCount:S};if(c!==null){for(y.skipValues(_);!y.done;){const O=h.readValue();if(I=O===null?null:n[O],C=f.readValue(),B=y.readValue(),B!==null&&B<c&&C===a&&I===i)_+=1;else break}return{found:!0,skipCount:_,visibleCount:S}}if(E.skipValues(_),b.skipValues(_),g.skipValues(_),w.skipValues(_),V=E.readValue(),L=n[b.readValue()],Y=g.readValue(),W=w.readValue(),p){if(!r&&l!==null&&l>0&&o!==null){for(_+=1;!E.done&&!b.done&&(V!==l||L!==o)&&(Y&&(k=!1),W===0&&!k&&(S+=1,k=!0),V=E.readValue(),L=n[b.readValue()],C=f.readValue(),I=n[h.readValue()],Y=g.readValue(),W=w.readValue(),C===a&&I===i);)_+=1;if(C!==a||I!==i||V!==l||L!==o||!Y)return{found:!1,skipCount:_,visibleCount:S};if(Y&&(k=!1),W===0&&!k&&(S+=1,k=!0),E.done||b.done)return{found:!0,skipCount:_,visibleCount:S};V=E.readValue(),L=n[b.readValue()],C=f.readValue(),I=n[h.readValue()],Y=g.readValue(),W=w.readValue()}for(;(!Y||V>d||V===d&&L>u)&&C===a&&I===i&&(_+=1,Y&&(k=!1),W===0&&!k&&(S+=1,k=!0),!E.done&&!b.done);)V=E.readValue(),L=n[b.readValue()],C=f.readValue(),I=n[h.readValue()],Y=g.readValue(),W=w.readValue()}else if(l!==null&&l>0&&o!==null){for(;(!Y||V!==l||L!==o)&&C===a&&I===i&&(_+=1,Y&&(k=!1),W===0&&!k&&(S+=1,k=!0),!E.done&&!b.done);)V=E.readValue(),L=n[b.readValue()],C=f.readValue(),I=n[h.readValue()],Y=g.readValue(),W=w.readValue();if(C!==a||I!==i||V!==l||L!==o||!Y)return{found:!1,skipCount:_,visibleCount:S}}return{found:!0,skipCount:_,visibleCount:S}}function Py(e,t,n,r){const i=e.blocks[t],a=e.blocks[t+1];return i.lastObjectActor!==n||i.lastObjectCtr!==r||i.numVisible===void 0?0:i.lastVisibleActor===a.firstVisibleActor&&i.lastVisibleActor!==void 0&&i.lastVisibleCtr===a.firstVisibleCtr&&i.lastVisibleCtr!==void 0?i.numVisible-1:i.numVisible}function _0(e,t){const{objActor:n,objActorNum:r,objCtr:i,keyActor:a,keyCtr:o,keyStr:l}=t;let c=0,u=0;if(i!==null)for(;c<e.blocks.length-1;){const d=e.blocks[c].lastObjectActor===void 0?void 0:e.actorIds[e.blocks[c].lastObjectActor],p=e.blocks[c].lastObjectCtr;if(p===null||p<i||p===i&&d<n)c++;else break}if(l!==null){for(;c<e.blocks.length-1;){const{lastObjectActor:p,lastObjectCtr:h,lastKey:f}=e.blocks[c];if(i===h&&r===p&&f!==void 0&&f<l)c++;else break}const{skipCount:d}=Oy(t,e.blocks[c].columns,e.actorIds,!1);return{blockIndex:c,skipCount:d,visibleCount:0}}else{const d=o===null||o===0||a===null,p=a===null?null:e.actorIds.indexOf(a);let h=!1;for(;;){if(!d&&!h)for(;c<e.blocks.length-1&&e.blocks[c].lastObjectActor===r&&e.blocks[c].lastObjectCtr===i&&!xT(e.blocks[c].bloom,p,o);){if(e.blocks[c].lastObjectCtr>i)throw new RangeError(`Reference element not found: ${o}@${a}`);u+=Py(e,c,r,i),c++}const{found:f,skipCount:y,visibleCount:b}=Oy(t,e.blocks[c].columns,e.actorIds,h);if(c===e.blocks.length-1||e.blocks[c].lastObjectActor!==r||e.blocks[c].lastObjectCtr!==i){if(f)return{blockIndex:c,skipCount:y,visibleCount:u+b};throw new RangeError(`Reference element not found: ${o}@${a}`)}else if(f&&y<e.blocks[c].numOps)return{blockIndex:c,skipCount:y,visibleCount:u+b};h=f&&t.insert,u+=Py(e,c,r,i),c++}}}function A0(e,t,n){let r=8*e.byteLength,i=n%r,a=t%r,o=((n^t)*16777619>>>0)%r;for(let l=0;l<E0;l++)e[i>>>3]|=1<<(i&7),i=(i+a)%r,a=(a+o)%r}function xT(e,t,n){let r=8*e.byteLength,i=n%r,a=t%r,o=((n^t)*16777619>>>0)%r;for(let l=0;l<E0;l++){if(!(e[i>>>3]&1<<(i&7)))return!1;i=(i+a)%r,a=(a+o)%r}return!0}function C0(e){e.bloom=new Uint8Array(N0),e.numOps=0,e.lastKey=void 0,e.numVisible=void 0,e.lastObjectActor=void 0,e.lastObjectCtr=void 0,e.firstVisibleActor=void 0,e.firstVisibleCtr=void 0,e.lastVisibleActor=void 0,e.lastVisibleCtr=void 0;for(let d of e.columns)d.decoder.reset();const[t,n,r,i,a,o,l,c,,,,,,u]=e.columns.map(d=>d.decoder);for(;!l.done;){e.numOps+=1;const d=t.readValue(),p=n.readValue(),h=r.readValue(),f=i.readValue(),y=a.readValue(),b=o.readValue(),E=l.readValue(),g=c.readValue(),x=u.readValue();if((e.lastObjectActor!==d||e.lastObjectCtr!==p)&&(e.numVisible=0,e.lastObjectActor=d,e.lastObjectCtr=p),y!==null)e.lastKey=y;else if(g||f!==null){e.lastKey=void 0;const w=g?b:h,_=g?E:f;A0(e.bloom,w,_),x===0&&(e.firstVisibleActor===void 0&&(e.firstVisibleActor=w),e.firstVisibleCtr===void 0&&(e.firstVisibleCtr=_),(e.lastVisibleActor!==w||e.lastVisibleCtr!==_)&&(e.numVisible+=1,e.lastVisibleActor=w,e.lastVisibleCtr=_))}}}function Nd(e,t,n,r){if(t[Ie]!==null)e.lastObjectCtr===t[it]&&e.lastObjectActor===t[ut]&&(e.lastKey===void 0||e.lastKey<t[Ie])&&(e.lastKey=t[Ie]);else{const i=t[Ut]?t[Mt]:t[kt],a=t[Ut]?t[Je]:t[It];A0(e.bloom,i,a),(t[Fn]===0||r)&&(e.firstVisibleActor===void 0&&(e.firstVisibleActor=i),e.firstVisibleCtr===void 0&&(e.firstVisibleCtr=a),e.lastVisibleActor=i,e.lastVisibleCtr=a)}(e.lastObjectCtr===void 0||t[ut]!==null&&t[it]!==null&&(e.lastObjectCtr===null||e.lastObjectCtr<t[it]||e.lastObjectCtr===t[it]&&n[e.lastObjectActor]<n[t[ut]]))&&(e.lastObjectActor=t[ut],e.lastObjectCtr=t[it],e.lastKey=t[Ie]!==null?t[Ie]:void 0,e.numVisible=0)}function k0(e){for(let i of e.columns)i.decoder.reset();const t=Math.ceil(e.numOps/(.8*Su));let n=[],r=0;for(let i=1;i<=t;i++){const a=Math.ceil(i*e.numOps/t)-r,o=e.columns.map(u=>({columnId:u.columnId,encoder:ma(u.columnId)}));ga(o,e.columns,a);const c={columns:o.map(u=>{const d=Up(u.columnId,u.encoder.buffer);return{columnId:u.columnId,decoder:d}})};C0(c),n.push(c),r+=a}return n}function jT(e){const t=e[0].columns.map(n=>({columnId:n.columnId,encoder:ma(n.columnId)}));for(let n of e){for(let r of n.columns)r.decoder.reset();ga(t,n.columns,n.numOps)}return t}function ga(e,t,n){if(n===0)return;let r=0,i=-1,a=0,o=-1,l=0;for(let c of e){for(;r<t.length&&t[r].columnId<c.columnId;)r++;let u=null;r<t.length&&t[r].columnId===c.columnId&&t[r].decoder.buf.byteLength>0&&(u=t[r].decoder);const d=c.columnId>>4===i?a:n;if(c.columnId%8===Rt.GROUP_CARD)i=c.columnId>>4,u?a=c.encoder.copyFrom(u,{count:n,sumValues:!0}).sum:(c.encoder.appendValue(0,n),a=0);else if(c.columnId%8===Rt.VALUE_LEN)if(u){if(r+1===t.length||t[r+1].columnId!==c.columnId+1)throw new RangeError("VALUE_LEN column without accompanying VALUE_RAW column");o=c.columnId+1,l=c.encoder.copyFrom(u,{count:d,sumValues:!0,sumShift:4}).sum}else c.encoder.appendValue(null,d),o=c.columnId+1,l=0;else if(c.columnId%8===Rt.VALUE_RAW){if(c.columnId!==o)throw new RangeError("VALUE_RAW column without accompanying VALUE_LEN column");l>0&&c.encoder.appendRawBytes(u.readRawBytes(l))}else if(u)c.encoder.copyFrom(u,{count:d});else{const p=c.columnId%8===Rt.BOOLEAN?!1:null;c.encoder.appendValue(p,d)}}}function nf(e,t){let n=[],r,i=-1,a=0,o=-1,l=0;for(let c of e){if(c.columnId%8===Rt.VALUE_RAW){if(c.columnId!==o)throw new RangeError("unexpected VALUE_RAW column");r=c.decoder.readRawBytes(l)}else if(c.columnId%8===Rt.GROUP_CARD)i=c.columnId>>4,a=c.decoder.readValue()||0,r=a;else if(c.columnId>>4===i){r=[],c.columnId%8===Rt.VALUE_LEN&&(o=c.columnId+1,l=0);for(let u=0;u<a;u++){let d=c.decoder.readValue();c.columnId%8===Rt.ACTOR_ID&&t&&typeof d=="number"&&(d=t[d]),c.columnId%8===Rt.VALUE_LEN&&(l+=r>>>4),r.push(d)}}else r=c.decoder.readValue(),c.columnId%8===Rt.ACTOR_ID&&t&&typeof r=="number"&&(r=t[r]),c.columnId%8===Rt.VALUE_LEN&&(o=c.columnId+1,l=r>>>4);n.push(r)}return n}function uc(e,t,n){let r=0,i=-1,a=0;for(let o of e){for(;r<t.length&&t[r].columnId<o.columnId;)r++;if(r<t.length&&t[r].columnId===o.columnId){const l=n[r];if(o.columnId%8===Rt.GROUP_CARD)i=o.columnId>>4,a=l,o.encoder.appendValue(l);else if(o.columnId>>4===i){if(!Array.isArray(l)||l.length!==a)throw new RangeError("bad group value");for(let c of l)o.encoder.appendValue(c)}else o.columnId%8===Rt.VALUE_RAW?l&&o.encoder.appendRawBytes(l):o.encoder.appendValue(l)}else if(o.columnId%8===Rt.GROUP_CARD)i=o.columnId>>4,a=0,o.encoder.appendValue(0);else if(o.columnId%8!==Rt.VALUE_RAW){const l=o.columnId>>4===i?a:1;let c=null;o.columnId%8===Rt.BOOLEAN&&(c=!1),o.columnId%8===Rt.VALUE_LEN&&(c=0),o.encoder.appendValue(c,l)}}}function rf(e,t){let n=e.blocks[t];if(n.columns[mt].decoder.done){if(t===e.blocks.length-1)return{docOp:null,blockIndex:t};t+=1,n=e.blocks[t];for(let r of n.columns)r.decoder.reset();return{docOp:nf(n.columns),blockIndex:t}}else return{docOp:nf(n.columns),blockIndex:t}}function I0(e,t){for(;t.changeIndex<t.changes.length-1&&(!t.columns||t.columns[mt].decoder.done);){t.changeIndex+=1;const r=t.changes[t.changeIndex];t.columns=Ko(r.columns,qe),t.opCtr=r.startOp,t.columns[mt].decoder.done&&(r.maxOp=r.startOp-1),ET(e,t.columns);const{actorIds:i,actorTable:a}=NT(e.actorIds,r);e.actorIds=i,t.actorTable=a,t.actorIndex=e.actorIds.indexOf(r.actorIds[0])}if(t.columns[mt].decoder.done){t.done=!0,t.nextOp=null;return}t.nextOp=nf(t.columns,t.actorTable),t.nextOp[Mt]=t.actorIndex,t.nextOp[Je]=t.opCtr,t.changes[t.changeIndex].maxOp=t.opCtr,t.opCtr>e.maxOp&&(e.maxOp=t.opCtr),t.opCtr+=1;const n=t.nextOp;if(n[it]===null&&n[ut]!==null||n[it]!==null&&n[ut]===null)throw new RangeError(`Mismatched object reference: (${n[it]}, ${n[ut]})`);if(n[It]===null&&n[kt]!==null||n[It]===0&&n[kt]!==null||n[It]>0&&n[kt]===null)throw new RangeError(`Mismatched operation key: (${n[It]}, ${n[kt]})`)}function sa(e,t){return t==="list"||t==="text"?{objectId:e,type:t,edits:[]}:{objectId:e,type:t,props:{}}}function Ly(e,t,n=1){const r=Wc(e),i=Wc(t);return r.actorId===i.actorId&&r.counter+n===i.counter}function Jo(e,t){if(e.length===0){e.push(t);return}let n=e[e.length-1];n.action==="insert"&&t.action==="insert"&&n.index===t.index-1&&n.value.type==="value"&&t.value.type==="value"&&n.elemId===n.opId&&t.elemId===t.opId&&Ly(n.elemId,t.elemId,1)&&n.value.datatype===t.value.datatype&&typeof n.value.value==typeof t.value.value?(n.action="multi-insert",t.value.datatype&&(n.datatype=t.value.datatype),n.values=[n.value.value,t.value.value],delete n.value,delete n.opId):n.action==="multi-insert"&&t.action==="insert"&&n.index+n.values.length===t.index&&t.value.type==="value"&&t.elemId===t.opId&&Ly(n.elemId,t.elemId,n.values.length)&&n.datatype===t.value.datatype&&typeof n.values[0]==typeof t.value.value?n.values.push(t.value.value):n.action==="remove"&&t.action==="remove"&&n.index===t.index?n.count+=t.count:e.push(t)}function sf(e,t,n,r,i,a){let o=!1;if(a)for(;!o&&e.length>0;){const l=e[e.length-1];if((l.action==="insert"||l.action==="update")&&l.index===t)e.pop(),o=l.action==="insert";else if(l.action==="multi-insert"&&l.index+l.values.length-1===t)l.values.pop(),o=!0;else break}o?Jo(e,{action:"insert",index:t,elemId:n,opId:r,value:i}):Jo(e,{action:"update",index:t,opId:r,value:i})}function bT(e,t,n){let r=[];for(;e.length>0;){let a=e[e.length-1];if(a.action==="insert"){if(a.index!==t)throw new RangeError("last edit has unexpected index");r.unshift(e.pop());break}else if(a.action==="update"){if(a.index!==t)throw new RangeError("last edit has unexpected index");r.unshift(e.pop())}else throw new RangeError("last edit has unexpected action")}let i=!0;for(let a of r)sf(e,t,n,a.opId,a.value,i),i=!1}function af(e,t,n,r,i,a,o,l){const c=!t,u=r[mt]<Nr.length?Iy[Nr[r[mt]]]:null,d=`${r[Je]}@${i.actorIds[r[Mt]]}`,p=r[Ut]?r[Mt]:r[kt],h=r[Ut]?r[Je]:r[It],f=r[Ie]?r[Ie]:`${h}@${i.actorIds[p]}`;r[mt]%2===0&&!i.objectMeta[d]&&(i.objectMeta[d]={parentObj:n,parentKey:f,opId:d,type:u,children:{}},tf(i.objectMeta,[n,"children",f,d],{objectId:d,type:u,props:{}}));const y=!a[f];a[f]||(a[f]={visibleOps:[],hasChild:!1});const b=l!==void 0&&r[Fn]>0;b||(a[f].visibleOps.push(r),a[f].hasChild=a[f].hasChild||r[mt]%2===0);const E=i.objectMeta[n].children[f];if(a[f].hasChild||E&&Object.keys(E).length>0){let _={};for(let S of a[f].visibleOps){const k=`${S[Je]}@${i.actorIds[S[Mt]]}`;if(Nr[S[mt]]==="set")_[k]=Object.assign({type:"value"},Vl(S[ts],S[Qs]));else if(S[mt]%2===0){const I=S[mt]<Nr.length?Iy[Nr[S[mt]]]:null;_[k]=sa(k,I)}}tf(i.objectMeta,[n,"children",f],_)}let g,x;if(b&&Nr[r[mt]]==="set"&&(r[ts]&15)===Xh.COUNTER){a[f]||(a[f]={visibleOps:[],hasChild:!1}),a[f].counterStates||(a[f].counterStates={});let _=a[f].counterStates,S={opId:d,value:Vl(r[ts],r[Qs]).value,succs:{}};for(let k=0;k<r[Fn];k++){const I=`${r[ra][k]}@${i.actorIds[r[ef][k]]}`;_[I]=S,S.succs[I]=!0}}else if(Nr[r[mt]]==="inc"){if(!a[f]||!a[f].counterStates||!a[f].counterStates[d])throw new RangeError(`increment operation ${d} for unknown counter`);let _=a[f].counterStates[d];_.value+=Vl(r[ts],r[Qs]).value,delete _.succs[d],Object.keys(_.succs).length===0&&(g=_.opId,x={type:"value",datatype:"counter",value:_.value})}else b||(Nr[r[mt]]==="set"?(g=d,x=Object.assign({type:"value"},Vl(r[ts],r[Qs]))):r[mt]%2===0&&(e[d]||(e[d]=sa(d,u)),g=d,x=e[d]));e[n]||(e[n]=sa(n,i.objectMeta[n].type));const w=e[n];if(r[Ie]===null)if(l===0&&!c&&a[f].action==="insert"&&(a[f].action="update",bT(w.edits,o,f),t&&t.lastObjectActor===r[ut]&&t.lastObjectCtr===r[it]&&(t.numVisible-=1)),x)if(!a[f].action&&(l===void 0||c))a[f].action="insert",Jo(w.edits,{action:"insert",index:o,elemId:f,opId:g,value:x}),t&&t.lastObjectActor===r[ut]&&t.lastObjectCtr===r[it]&&(t.numVisible+=1);else if(a[f].action==="remove"){let _=w.edits[w.edits.length-1];if(_.action!=="remove")throw new RangeError("last edit has unexpected type");_.count>1?_.count-=1:w.edits.pop(),a[f].action="update",sf(w.edits,o,f,g,x,!0),t&&t.lastObjectActor===r[ut]&&t.lastObjectCtr===r[it]&&(t.numVisible+=1)}else sf(w.edits,o,f,g,x,!a[f].action),a[f].action||(a[f].action="update");else l===0&&!a[f].action&&(a[f].action="remove",Jo(w.edits,{action:"remove",index:o,count:1}),t&&t.lastObjectActor===r[ut]&&t.lastObjectCtr===r[it]&&(t.numVisible-=1));else(x||!c)&&((y||!w.props[r[Ie]])&&(w.props[r[Ie]]={}),x&&(w.props[r[Ie]][g]=x))}function wT(e,t,n,r,i,a,o){const l=r.nextOp,c=l[Ut],u=l[ut],d=l[it],p=u===null?"_root":`${d}@${i.actorIds[u]}`,h=r.actorIndex,f=i.actorIds[h];let y=!1,b=!1,E={},g;({docOp:g,blockIndex:o}=rf(i,o));let x=g===null?0:1,w=g===null?0:g[Fn],_=null,S=[],k=[],I=[],C=null;for(r.objectIds.add(p);;){if(S.length===0){y=!1;let O=r.nextOp;for(;!r.done&&O[Mt]===h&&O[Ut]===c&&O[ut]===l[ut]&&O[it]===l[it];){const D=S.length>0?S[S.length-1]:null;let Q=!1;for(let ae=0;ae<O[ns];ae++)for(let U of S)O[ta][ae]===U[Mt]&&O[na][ae]===U[Je]&&(Q=!0);if(O!==l){if(!(c&&D!==null&&O[Ie]===null&&O[kt]===D[Mt]&&O[It]===D[Je])){if(!(!c&&D!==null&&O[Ie]!==null&&O[Ie]===D[Ie]&&!Q)){if(!(!c&&D!==null&&O[Ie]===null&&D[Ie]===null&&O[kt]===D[kt]&&O[It]===D[It]&&!Q)){if(!(!c&&D===null&&O[Ie]===null&&g&&g[Ut]&&g[Ie]===null&&g[Mt]===O[kt]&&g[Je]===O[It])){if(!(!c&&D===null&&O[Ie]!==null&&C!==null&&C<O[Ie]))break}}}}}C=O!==null?O[Ie]:null,S.push(r.nextOp),k.push(r.columns),I.push(new Array(r.nextOp[ns])),I0(i,r),O=r.nextOp}}S.length>0&&(_=S[0]);const L=g&&g[ut]===_[ut]&&g[it]===_[it],V=g&&g[Ie]!==null&&g[Ie]===_[Ie],B=g&&g[Ie]===null&&_[Ie]===null&&(!g[Ut]&&g[kt]===_[kt]&&g[It]===_[It]||g[Ut]&&g[Mt]===_[kt]&&g[Je]===_[It]);if(S.length===0&&!(L&&(V||B)))break;let Y=!1,W=0;if(c||!L||g[Ie]===null&&_[Ie]!==null||g[Ie]!==null&&_[Ie]!==null&&_[Ie]<g[Ie]){if(W=S.length,!L&&!y&&_[Ie]===null&&!_[Ut])throw new RangeError(`could not find list element with ID: ${_[It]}@${i.actorIds[_[kt]]}`)}else if(V||B||y){for(let O=0;O<S.length;O++){const D=S[O];for(let Q=0;Q<D[ns];Q++)if(D[ta][Q]===g[Mt]&&D[na][Q]===g[Je]){let ae=0;for(;ae<g[Fn]&&(g[ra][ae]<D[Je]||g[ra][ae]===D[Je]&&i.actorIds[g[ef][ae]]<f);)ae++;g[ra].splice(ae,0,D[Je]),g[ef].splice(ae,0,h),g[Fn]++,I[O][Q]=!0;break}}if(B&&(y=!0),y&&!B)W=S.length;else if(S.length===0||g[Je]<_[Je]||g[Je]===_[Je]&&i.actorIds[g[Mt]]<f){Y=!0,af(e,t,p,g,i,E,a,w);for(let O=S.length-1;O>=0;O--){let D=!0;for(let Q=0;Q<S[O][ns];Q++)I[O][Q]||(D=!1);Nr[S[O][mt]]==="del"&&D&&(S.splice(O,1),k.splice(O,1),I.splice(O,1))}}else{if(g[Je]===_[Je]&&i.actorIds[g[Mt]]===f)throw new RangeError(`duplicate operation ID: ${_[Je]}@${f}`);W=1}}else Y=!0;if(Y&&(uc(n,i.blocks[o].columns,g),Nd(t,g,i.actorIds,!1),g[Ut]&&b&&(b=!1,a++),g[Fn]===0&&(b=!0),t.numOps++,{docOp:g,blockIndex:o}=rf(i,o),g!==null&&(x++,w=g[Fn])),W>0){for(let O=0;O<W;O++){let D=S[O];for(let Q=0;Q<D[ns];Q++)if(!I[O][Q])throw new RangeError(`no matching operation for pred: ${D[na][Q]}@${i.actorIds[D[ta][Q]]}`);uc(n,k[O],D),Nd(t,D,i.actorIds,!0),af(e,t,p,D,i,E,a),D[Ut]?(b=!1,a++):b=!0}W===S.length?(S.length=0,k.length=0,I.length=0):(S.splice(0,W),k.splice(0,W),I.splice(0,W)),t.numOps+=W}}return g&&(uc(n,i.blocks[o].columns,g),t.numOps++,Nd(t,g,i.actorIds,!1)),{docOpsConsumed:x,blockIndex:o}}function ST(e,t,n){const[r,i,a,o,l,c,u,d]=t.nextOp,p=r===null?null:n.actorIds[r],h=a===null?null:n.actorIds[a],f={objActor:p,objActorNum:r,objCtr:i,keyActor:h,keyCtr:o,keyStr:l,idActor:n.actorIds[c],idCtr:u,insert:d},{blockIndex:y,skipCount:b,visibleCount:E}=_0(n,f),g=n.blocks[y];for(let L of g.columns)L.decoder.reset();const x=b===0||g.firstVisibleActor===void 0||!d&&g.firstVisibleActor===a&&g.firstVisibleCtr===o,w={columns:void 0,bloom:new Uint8Array(g.bloom),numOps:b,lastKey:g.lastKey,numVisible:g.numVisible,lastObjectActor:g.lastObjectActor,lastObjectCtr:g.lastObjectCtr,firstVisibleActor:x?void 0:g.firstVisibleActor,firstVisibleCtr:x?void 0:g.firstVisibleCtr,lastVisibleActor:void 0,lastVisibleCtr:void 0},_=g.columns.map(L=>({columnId:L.columnId,encoder:ma(L.columnId)}));ga(_,g.columns,b);const{blockIndex:S,docOpsConsumed:k}=wT(e,w,_,t,n,E,y),I=n.blocks[S];let C=-b-k;for(let L=y;L<=S;L++)C+=n.blocks[L].numOps;ga(_,I.columns,C),w.numOps+=C;for(let L of I.columns)if(!L.decoder.done)throw new RangeError(`excess ops in column ${L.columnId}`);if(w.columns=_.map(L=>{const V=Up(L.columnId,L.encoder.buffer);return{columnId:L.columnId,decoder:V}}),y===S&&w.numOps<=Su)C>0&&g.lastVisibleActor!==void 0&&g.lastVisibleCtr!==void 0&&(w.lastVisibleActor=g.lastVisibleActor,w.lastVisibleCtr=g.lastVisibleCtr),n.blocks[y]=w;else{const L=k0(w);n.blocks.splice(y,S-y+1,...L)}}function ET(e,t){if(t[ut].columnId!==qe[ut].columnId||qe[ut].columnName!=="objActor"||t[it].columnId!==qe[it].columnId||qe[it].columnName!=="objCtr"||t[kt].columnId!==qe[kt].columnId||qe[kt].columnName!=="keyActor"||t[It].columnId!==qe[It].columnId||qe[It].columnName!=="keyCtr"||t[Ie].columnId!==qe[Ie].columnId||qe[Ie].columnName!=="keyStr"||t[Mt].columnId!==qe[Mt].columnId||qe[Mt].columnName!=="idActor"||t[Je].columnId!==qe[Je].columnId||qe[Je].columnName!=="idCtr"||t[Ut].columnId!==qe[Ut].columnId||qe[Ut].columnName!=="insert"||t[mt].columnId!==qe[mt].columnId||qe[mt].columnName!=="action"||t[ts].columnId!==qe[ts].columnId||qe[ts].columnName!=="valLen"||t[Qs].columnId!==qe[Qs].columnId||qe[Qs].columnName!=="valRaw"||t[ns].columnId!==qe[ns].columnId||qe[ns].columnName!=="predNum"||t[ta].columnId!==qe[ta].columnId||qe[ta].columnName!=="predActor"||t[na].columnId!==qe[na].columnId||qe[na].columnName!=="predCtr")throw new RangeError("unexpected columnId");const n=e.blocks[0].columns;if(!t.every(r=>Ty.includes(r.columnId)||n.find(i=>i.columnId===r.columnId))){let r=n.map(i=>({columnId:i.columnId}));for(let i of t){const{columnId:a}=i;!Ty.includes(a)&&!n.find(o=>o.columnId===a)&&r.push({columnId:a})}r.sort((i,a)=>i.columnId-a.columnId);for(let i=0;i<e.blocks.length;i++){let a=Gc(e.blocks[i]);a.columns=Ko(a.columns.map(o=>({columnId:o.columnId,buffer:o.decoder.buf})),r),e.blocks[i]=a}}}function NT(e,t){if(e.indexOf(t.actorIds[0])<0){if(t.seq!==1)throw new RangeError(`Seq ${t.seq} is the first change for actor ${t.actorIds[0]}`);e=e.concat([t.actorIds[0]])}const n=[];for(let r of t.actorIds){const i=e.indexOf(r);if(i<0)throw new RangeError(`actorId ${r} is not known to document`);n.push(i)}return{actorIds:e,actorTable:n}}function _T(e,t,n){for(let r of t){let i=n.objectMeta[r],a=null,o=!1;for(;;){const l=a&&Object.keys(i.children[a.parentKey]).length>0;if(e[r]||(e[r]=sa(r,i.type)),a&&l)if(i.type==="list"||i.type==="text"){for(let c of e[r].edits)c.opId&&i.children[a.parentKey][c.opId]&&(o=!0);if(!o){const c=Wc(r),u=Wc(a.parentKey),d={objActor:c.actorId,objCtr:c.counter,keyActor:u.actorId,keyCtr:u.counter,objActorNum:n.actorIds.indexOf(c.actorId),keyActorNum:n.actorIds.indexOf(u.actorId),keyStr:null,insert:!1},{visibleCount:p}=_0(n,d);for(let[h,f]of Object.entries(i.children[a.parentKey])){let y=f;f.objectId&&(e[f.objectId]||(e[f.objectId]=sa(f.objectId,f.type)),y=e[f.objectId]);const b={action:"update",index:p,opId:h,value:y};Jo(e[r].edits,b)}}}else{e[r].props[a.parentKey]||(e[r].props[a.parentKey]={});let c=e[r].props[a.parentKey];for(let[u,d]of Object.entries(i.children[a.parentKey]))c[u]?o=!0:d.objectId?(e[d.objectId]||(e[d.objectId]=sa(d.objectId,d.type)),c[u]=e[d.objectId]):c[u]=d}if(o||!i.parentObj||a&&!l)break;a=i,r=i.parentObj,i=n.objectMeta[r]}}return e}function AT(e,t,n,r,i){let a=new Set(n.heads),o=new Set,l=Gc(n.clock),c=[],u=[];for(let d of t){if(n.changeIndexByHash[d.hash]!==void 0||o.has(d.hash))continue;const p=(l[d.actor]||0)+1;let h=!0;for(let f of d.deps){const y=n.changeIndexByHash[f];(y===void 0||y===-1)&&!o.has(f)&&(h=!1)}if(!h)u.push(d);else if(d.seq<p){if(i)throw new RangeError(`Reuse of sequence number ${d.seq} for actor ${d.actor}`);return[[],t]}else{if(d.seq>p)throw new RangeError(`Skipped sequence number ${p} for actor ${d.actor}`);l[d.actor]=d.seq,o.add(d.hash);for(let f of d.deps)a.delete(f);a.add(d.hash),c.push(d)}}if(c.length>0){let d={changes:c,changeIndex:-1,objectIds:r};for(I0(n,d);!d.done;)ST(e,d,n);n.heads=[...a].sort(),n.clock=l}return[c,u]}function Dy(e){for(let d of e.blocks[0].columns)d.decoder.reset();let t={},n=null,r=0,i={_root:{objectId:"_root",type:"map",props:{}}},a=null,o=null,l="_root",c=!1,u=0;for(;{docOp:n,blockIndex:r}=rf(e,r),n!==null;){(n[ut]!==a||n[it]!==o)&&(l=`${n[it]}@${e.actorIds[n[ut]]}`,a=n[ut],o=n[it],t={},u=0,c=!1),n[Ut]&&c&&(c=!1,u++),n[Fn]===0&&(c=!0),n[Je]>e.maxOp&&(e.maxOp=n[Je]);for(let d=0;d<n[Fn];d++)n[ra][d]>e.maxOp&&(e.maxOp=n[ra][d]);af(i,null,l,n,e,t,u,n[Fn])}return i._root}function CT(e){const t=Ko(e.changesColumns,Mn),n=t[0].decoder,r=t[1].decoder,i=t[5].decoder,a=t[6].decoder;if(t[0].columnId!==Mn[0].columnId||Mn[0].columnName!=="actor"||t[1].columnId!==Mn[1].columnId||Mn[1].columnName!=="seq"||t[5].columnId!==Mn[5].columnId||Mn[5].columnName!=="depsNum"||t[6].columnId!==Mn[6].columnId||Mn[6].columnName!=="depsIndex")throw new RangeError("unexpected columnId");let o=0,l={},c=[],u=new Set;for(;!n.done;){const h=n.readValue(),f=r.readValue(),y=i.readValue(),b=e.actorIds[h];if(f!==1&&f!==l[b]+1)throw new RangeError(`Expected seq ${l[b]+1}, got ${f} for actor ${b}`);c.push(h),l[b]=f,u.add(o);for(let E=0;E<y;E++)u.delete(a.readValue());o++}const d=[...u].map(h=>e.actorIds[c[h]]).sort();for(let h of t)h.decoder.reset();const p=t.map(h=>({columnId:h.columnId,encoder:ma(h.columnId)}));return ga(p,t,o),{clock:l,headActors:d,encoders:p,numChanges:o}}function kT(e,t,n,r){uc(e,Mn,[n.indexOf(t.actor),t.seq,t.maxOp,t.time,t.message,t.deps.length,t.deps.map(i=>r[i]),t.extraBytes?t.extraBytes.byteLength<<4|Xh.BYTES:Xh.BYTES,t.extraBytes])}let IT=class R0{constructor(t){if(this.maxOp=0,this.haveHashGraph=!1,this.changes=[],this.changeIndexByHash={},this.dependenciesByHash={},this.dependentsByHash={},this.hashesByActor={},this.actorIds=[],this.heads=[],this.clock={},this.queue=[],this.objectMeta={_root:{parentObj:null,parentKey:null,opId:null,type:"map",children:{}}},t){const n=gT(t),{clock:r,headActors:i,encoders:a,numChanges:o}=CT(n);if(this.binaryDoc=t,this.changes=new Array(o),this.actorIds=n.actorIds,this.heads=n.heads,this.clock=r,this.changesEncoders=a,this.extraBytes=n.extraBytes,n.heads.length===1&&i.length===1&&(this.hashesByActor[i[0]]=[],this.hashesByActor[i[0]][r[i[0]]-1]=n.heads[0]),n.heads.length===n.headsIndexes.length)for(let c=0;c<n.heads.length;c++)this.changeIndexByHash[n.heads[c]]=n.headsIndexes[c];else if(n.heads.length===1)this.changeIndexByHash[n.heads[0]]=o-1;else for(let c of n.heads)this.changeIndexByHash[c]=-1;this.blocks=[{columns:Ko(n.opsColumns,Ry)}],C0(this.blocks[0]),this.blocks[0].numOps>Su&&(this.blocks=k0(this.blocks[0]));let l={blocks:this.blocks,actorIds:this.actorIds,objectMeta:this.objectMeta,maxOp:0};this.initPatch=Dy(l),this.maxOp=l.maxOp}else this.haveHashGraph=!0,this.changesEncoders=Mn.map(n=>({columnId:n.columnId,encoder:ma(n.columnId)})),this.blocks=[{columns:Ko([],Ry),bloom:new Uint8Array(N0),numOps:0,lastKey:void 0,numVisible:void 0,lastObjectActor:void 0,lastObjectCtr:void 0,firstVisibleActor:void 0,firstVisibleCtr:void 0,lastVisibleActor:void 0,lastVisibleCtr:void 0}]}clone(){let t=new R0;return t.maxOp=this.maxOp,t.haveHashGraph=this.haveHashGraph,t.changes=this.changes.slice(),t.changeIndexByHash=Gc(this.changeIndexByHash),t.dependenciesByHash=Gc(this.dependenciesByHash),t.dependentsByHash=Object.entries(this.dependentsByHash).reduce((n,[r,i])=>(n[r]=i.slice(),n),{}),t.hashesByActor=Object.entries(this.hashesByActor).reduce((n,[r,i])=>(n[r]=i.slice(),n),{}),t.actorIds=this.actorIds,t.heads=this.heads,t.clock=this.clock,t.blocks=this.blocks,t.objectMeta=this.objectMeta,t.queue=this.queue,t}applyChanges(t,n=!1){let r=t.map(d=>{const p=fT(d);return p.buffer=d,p}),i={_root:{objectId:"_root",type:"map",props:{}}},a={maxOp:this.maxOp,changeIndexByHash:this.changeIndexByHash,actorIds:this.actorIds,heads:this.heads,clock:this.clock,blocks:this.blocks.slice(),objectMeta:Object.assign({},this.objectMeta)},o=this.queue.length===0?r:r.concat(this.queue),l=[],c=new Set;for(;;){const[d,p]=AT(i,o,a,c,this.haveHashGraph);o=p;for(let h=0;h<d.length;h++)a.changeIndexByHash[d[h].hash]=this.changes.length+l.length+h;if(d.length>0&&(l=l.concat(d)),o.length===0)break;if(d.length===0){if(this.haveHashGraph)break;this.computeHashGraph(),a.changeIndexByHash=this.changeIndexByHash}}_T(i,c,a);for(let d of l){this.changes.push(d.buffer),this.hashesByActor[d.actor]||(this.hashesByActor[d.actor]=[]),this.hashesByActor[d.actor][d.seq-1]=d.hash,this.changeIndexByHash[d.hash]=this.changes.length-1,this.dependenciesByHash[d.hash]=d.deps,this.dependentsByHash[d.hash]=[];for(let p of d.deps)this.dependentsByHash[p]||(this.dependentsByHash[p]=[]),this.dependentsByHash[p].push(d.hash);kT(this.changesEncoders,d,a.actorIds,this.changeIndexByHash)}this.maxOp=a.maxOp,this.actorIds=a.actorIds,this.heads=a.heads,this.clock=a.clock,this.blocks=a.blocks,this.objectMeta=a.objectMeta,this.queue=o,this.binaryDoc=null,this.initPatch=null;let u={maxOp:this.maxOp,clock:this.clock,deps:this.heads,pendingChanges:this.queue.length,diffs:i._root};return n&&r.length===1&&(u.actor=r[0].actor,u.seq=r[0].seq),u}computeHashGraph(){const t=this.save();this.haveHashGraph=!0,this.changes=[],this.changeIndexByHash={},this.dependenciesByHash={},this.dependentsByHash={},this.hashesByActor={},this.clock={};for(let n of mT([t])){const r=hT(n);this.changes.push(r),this.changeIndexByHash[n.hash]=this.changes.length-1,this.dependenciesByHash[n.hash]=n.deps,this.dependentsByHash[n.hash]=[];for(let a of n.deps)this.dependentsByHash[a].push(n.hash);n.seq===1&&(this.hashesByActor[n.actor]=[]),this.hashesByActor[n.actor].push(n.hash);const i=(this.clock[n.actor]||0)+1;if(n.seq!==i)throw new RangeError(`Expected seq ${i}, got seq ${n.seq} from actor ${n.actor}`);this.clock[n.actor]=n.seq}}getChanges(t){if(this.haveHashGraph||this.computeHashGraph(),t.length===0)return this.changes.slice();let n=[],r={},i=[];for(let a of t){r[a]=!0;const o=this.dependentsByHash[a];if(!o)throw new RangeError(`hash not found: ${a}`);n.push(...o)}for(;n.length>0;){const a=n.pop();if(r[a]=!0,i.push(a),!this.dependenciesByHash[a].every(o=>r[o]))break;n.push(...this.dependentsByHash[a])}if(n.length===0&&this.heads.every(a=>r[a]))return i.map(a=>this.changes[this.changeIndexByHash[a]]);for(n=t.slice(),r={};n.length>0;){const a=n.pop();if(!r[a]){const o=this.dependenciesByHash[a];if(!o)throw new RangeError(`hash not found: ${a}`);n.push(...o),r[a]=!0}}return this.changes.filter(a=>!r[pT(a,!0).hash])}getChangesAdded(t){this.haveHashGraph||this.computeHashGraph();let n=this.heads.slice(),r={},i=[];for(;n.length>0;){const a=n.pop();!r[a]&&t.changeIndexByHash[a]===void 0&&(r[a]=!0,i.push(a),n.push(...this.dependenciesByHash[a]))}return i.reverse().map(a=>this.changes[this.changeIndexByHash[a]])}getChangeByHash(t){return this.haveHashGraph||this.computeHashGraph(),this.changes[this.changeIndexByHash[t]]}getMissingDeps(t=[]){this.haveHashGraph||this.computeHashGraph();let n=new Set(t),r=new Set;for(let a of this.queue){r.add(a.hash);for(let o of a.deps)n.add(o)}let i=[];for(let a of n)this.changeIndexByHash[a]===void 0&&!r.has(a)&&i.push(a);return i.sort()}save(){if(this.binaryDoc)return this.binaryDoc;const t=this.changesEncoders.map(r=>({columnId:r.columnId,encoder:ma(r.columnId)})),n=this.changesEncoders.map(r=>{const i=Up(r.columnId,r.encoder.buffer);return{columnId:r.columnId,decoder:i}});return ga(t,n,this.changes.length),this.binaryDoc=yT({changesColumns:this.changesEncoders,opsColumns:jT(this.blocks),actorIds:this.actorIds,heads:this.heads,headsIndexes:this.heads.map(r=>this.changeIndexByHash[r]),extraBytes:this.extraBytes}),this.changesEncoders=t,this.binaryDoc}getPatch(){const t={_root:{parentObj:null,parentKey:null,opId:null,type:"map",children:{}}},n={blocks:this.blocks,actorIds:this.actorIds,objectMeta:t,maxOp:0},r=this.initPatch?this.initPatch:Dy(n);return{maxOp:this.maxOp,clock:this.clock,deps:this.heads,pendingChanges:this.queue.length,diffs:r}}};var RT={BackendDoc:IT};function TT(e){if(e.frozen)throw new Error("Attempting to use an outdated Automerge document that has already been updated. Please use the latest document state, or call Automerge.clone() if you really need to use this old document state.");return e.state}var OT={backendState:TT};const{encodeChange:PT}=wu,{BackendDoc:T0}=RT,{backendState:Gn}=OT;function LT(){return{state:new T0,heads:[]}}function DT(e){return{state:Gn(e).clone(),heads:e.heads}}function MT(e){e.state=null,e.frozen=!0}function UT(e,t){const n=Gn(e),r=n.applyChanges(t);return e.frozen=!0,[{state:n,heads:n.heads},r]}function My(e,t,n){if(e.hashesByActor[t]&&e.hashesByActor[t][n]||!e.haveHashGraph&&(e.computeHashGraph(),e.hashesByActor[t]&&e.hashesByActor[t][n]))return e.hashesByActor[t][n];throw new RangeError(`Unknown change: actorId = ${t}, seq = ${n+1}`)}function BT(e,t){const n=Gn(e);if(t.seq<=n.clock[t.actor])throw new RangeError("Change request has already been applied");if(t.seq>1){const o=My(n,t.actor,t.seq-2);if(!o)throw new RangeError(`Cannot find hash of localChange before seq=${t.seq}`);let l={[o]:!0};for(let c of t.deps)l[c]=!0;t.deps=Object.keys(l).sort()}const r=PT(t),i=n.applyChanges([r],!0);e.frozen=!0;const a=My(n,t.actor,t.seq-1);return i.deps=i.deps.filter(o=>o!==a),[{state:n,heads:n.heads},i,r]}function VT(e){return Gn(e).save()}function $T(e){const t=new T0(e);return{state:t,heads:t.heads}}function FT(e,t){const n=Gn(e);return n.applyChanges(t),e.frozen=!0,{state:n,heads:n.heads}}function HT(e){return Gn(e).getPatch()}function qT(e){return e.heads}function zT(e){return O0(e,[])}function O0(e,t){if(!Array.isArray(t))throw new TypeError("Pass an array of hashes to Backend.getChanges()");return Gn(e).getChanges(t)}function WT(e,t){return Gn(t).getChangesAdded(Gn(e))}function GT(e,t){return Gn(e).getChangeByHash(t)}function YT(e,t=[]){return Gn(e).getMissingDeps(t)}var P0={init:LT,clone:DT,free:MT,applyChanges:UT,applyLocalChange:BT,save:VT,load:$T,loadChanges:FT,getPatch:HT,getHeads:qT,getAllChanges:zT,getChanges:O0,getChangesAdded:WT,getChangeByHash:GT,getMissingDeps:YT};const Hn=P0,{hexStringToBytes:L0,bytesToHexString:KT,Encoder:Bp,Decoder:Vp}=i0,{decodeChangeMeta:Yc}=wu,{copyObject:JT}=hr,D0=32,M0=66,U0=67,QT=10,ZT=7;class B0{constructor(t){if(Array.isArray(t)){this.numEntries=t.length,this.numBitsPerEntry=QT,this.numProbes=ZT,this.bits=new Uint8Array(Math.ceil(this.numEntries*this.numBitsPerEntry/8));for(let n of t)this.addHash(n)}else if(t instanceof Uint8Array)if(t.byteLength===0)this.numEntries=0,this.numBitsPerEntry=0,this.numProbes=0,this.bits=t;else{const n=new Vp(t);this.numEntries=n.readUint32(),this.numBitsPerEntry=n.readUint32(),this.numProbes=n.readUint32(),this.bits=n.readRawBytes(Math.ceil(this.numEntries*this.numBitsPerEntry/8))}else throw new TypeError("invalid argument")}get bytes(){if(this.numEntries===0)return new Uint8Array(0);const t=new Bp;return t.appendUint32(this.numEntries),t.appendUint32(this.numBitsPerEntry),t.appendUint32(this.numProbes),t.appendRawBytes(this.bits),t.buffer}getProbes(t){const n=L0(t),r=8*this.bits.byteLength;if(n.byteLength!==32)throw new RangeError(`Not a 256-bit hash: ${t}`);let i=((n[0]|n[1]<<8|n[2]<<16|n[3]<<24)>>>0)%r,a=((n[4]|n[5]<<8|n[6]<<16|n[7]<<24)>>>0)%r,o=((n[8]|n[9]<<8|n[10]<<16|n[11]<<24)>>>0)%r;const l=[i];for(let c=1;c<this.numProbes;c++)i=(i+a)%r,a=(a+o)%r,l.push(i);return l}addHash(t){for(let n of this.getProbes(t))this.bits[n>>>3]|=1<<(n&7)}containsHash(t){if(this.numEntries===0)return!1;for(let n of this.getProbes(t))if(!(this.bits[n>>>3]&1<<(n&7)))return!1;return!0}}function dc(e,t){if(!Array.isArray(t))throw new TypeError("hashes must be an array");e.appendUint32(t.length);for(let n=0;n<t.length;n++){if(n>0&&t[n-1]>=t[n])throw new RangeError("hashes must be sorted");const r=L0(t[n]);if(r.byteLength!==D0)throw new TypeError("heads hashes must be 256 bits");e.appendRawBytes(r)}}function hc(e){let t=e.readUint32(),n=[];for(let r=0;r<t;r++)n.push(KT(e.readRawBytes(D0)));return n}function of(e){const t=new Bp;t.appendByte(M0),dc(t,e.heads),dc(t,e.need),t.appendUint32(e.have.length);for(let n of e.have)dc(t,n.lastSync),t.appendPrefixedBytes(n.bloom);t.appendUint32(e.changes.length);for(let n of e.changes)t.appendPrefixedBytes(n);return t.buffer}function V0(e){const t=new Vp(e),n=t.readByte();if(n!==M0)throw new RangeError(`Unexpected message type: ${n}`);const r=hc(t),i=hc(t),a=t.readUint32();let o={heads:r,need:i,have:[],changes:[]};for(let c=0;c<a;c++){const u=hc(t),d=t.readPrefixedBytes(t);o.have.push({lastSync:u,bloom:d})}const l=t.readUint32();for(let c=0;c<l;c++){const u=t.readPrefixedBytes();o.changes.push(u)}return o}function XT(e){const t=new Bp;return t.appendByte(U0),dc(t,e.sharedHeads),t.buffer}function eO(e){const t=new Vp(e),n=t.readByte();if(n!==U0)throw new RangeError(`Unexpected record type: ${n}`);const r=hc(t);return Object.assign($0(),{sharedHeads:r})}function tO(e,t){const r=Hn.getChanges(e,t).map(i=>Yc(i,!0).hash);return{lastSync:t,bloom:new B0(r).bytes}}function nO(e,t,n){if(t.length===0)return n.map(p=>Hn.getChangeByHash(e,p)).filter(p=>p!==void 0);let r={},i=[];for(let p of t){for(let h of p.lastSync)r[h]=!0;i.push(new B0(p.bloom))}const a=Hn.getChanges(e,Object.keys(r)).map(p=>Yc(p,!0));let o={},l={},c={};for(let p of a){o[p.hash]=!0;for(let h of p.deps)l[h]||(l[h]=[]),l[h].push(p.hash);i.every(h=>!h.containsHash(p.hash))&&(c[p.hash]=!0)}let u=Object.keys(c);for(;u.length>0;){const p=u.pop();if(l[p])for(let h of l[p])c[h]||(c[h]=!0,u.push(h))}let d=[];for(let p of n)if(c[p]=!0,!o[p]){const h=Hn.getChangeByHash(e,p);h&&d.push(h)}for(let p of a)c[p.hash]&&d.push(p.change);return d}function $0(){return{sharedHeads:[],lastSentHeads:[],theirHeads:null,theirNeed:null,theirHave:null,sentHashes:{}}}function lf(e,t){return e.length===t.length&&e.every((n,r)=>n===t[r])}function rO(e,t){if(!e)throw new Error("generateSyncMessage called with no Automerge document");if(!t)throw new Error("generateSyncMessage requires a syncState, which can be created with initSyncState()");let{sharedHeads:n,lastSentHeads:r,theirHeads:i,theirNeed:a,theirHave:o,sentHashes:l}=t;const c=Hn.getHeads(e),u=Hn.getMissingDeps(e,i||[]);let d=[];if((!i||u.every(b=>i.includes(b)))&&(d=[tO(e,n)]),o&&o.length>0&&!o[0].lastSync.every(E=>Hn.getChangeByHash(e,E))){const E={heads:c,need:[],have:[{lastSync:[],bloom:new Uint8Array(0)}],changes:[]};return[t,of(E)]}let p=Array.isArray(o)&&Array.isArray(a)?nO(e,o,a):[];const h=Array.isArray(r)&&lf(c,r),f=Array.isArray(i)&&lf(c,i);if(h&&f&&p.length===0)return[t,null];p=p.filter(b=>!l[Yc(b,!0).hash]);const y={heads:c,have:d,need:u,changes:p};if(p.length>0){l=JT(l);for(const b of p)l[Yc(b,!0).hash]=!0}return t=Object.assign({},t,{lastSentHeads:c,sentHashes:l}),[t,of(y)]}function sO(e,t,n){const r=t.filter(o=>!e.includes(o)),i=n.filter(o=>t.includes(o));return[...new Set([...r,...i])].sort()}function iO(e,t,n){if(!e)throw new Error("generateSyncMessage called with no Automerge document");if(!t)throw new Error("generateSyncMessage requires a syncState, which can be created with initSyncState()");let{sharedHeads:r,lastSentHeads:i,sentHashes:a}=t,o=null;const l=V0(n),c=Hn.getHeads(e);l.changes.length>0&&([e,o]=Hn.applyChanges(e,l.changes),r=sO(c,Hn.getHeads(e),r)),l.changes.length===0&&lf(l.heads,c)&&(i=l.heads);const u=l.heads.filter(p=>Hn.getChangeByHash(e,p));u.length===l.heads.length?(r=l.heads,l.heads.length===0&&(i=[],a=[])):r=[...new Set(u.concat(r))].sort();const d={sharedHeads:r,lastSentHeads:i,theirHave:l.have,theirHeads:l.heads,theirNeed:l.need,sentHashes:a};return[e,d,o]}var aO={receiveSyncMessage:iO,generateSyncMessage:rO,encodeSyncMessage:of,decodeSyncMessage:V0,initSyncState:$0,encodeSyncState:XT,decodeSyncState:eO};const{init:oO,clone:lO,free:cO,applyChanges:uO,applyLocalChange:dO,save:hO,load:fO,loadChanges:pO,getPatch:mO,getHeads:gO,getAllChanges:yO,getChanges:vO,getChangesAdded:xO,getChangeByHash:jO,getMissingDeps:bO}=P0,{receiveSyncMessage:wO,generateSyncMessage:SO,encodeSyncMessage:EO,decodeSyncMessage:NO,encodeSyncState:_O,decodeSyncState:AO,initSyncState:CO}=aO;var kO={init:oO,clone:lO,free:cO,applyChanges:uO,applyLocalChange:dO,save:hO,load:fO,loadChanges:pO,getPatch:mO,getHeads:gO,getAllChanges:yO,getChanges:vO,getChangesAdded:xO,getChangeByHash:jO,getMissingDeps:bO,receiveSyncMessage:wO,generateSyncMessage:SO,encodeSyncMessage:EO,decodeSyncMessage:NO,encodeSyncState:_O,decodeSyncState:AO,initSyncState:CO};(function(e){const t=vp,n=Ik,{OPTIONS:r}=Cs,{encodeChange:i,decodeChange:a}=wu,{isObject:o}=hr;let l=kO;function c(B){if(typeof B=="string")B={actorId:B};else if(typeof B>"u")B={};else if(!o(B))throw new TypeError(`Unsupported options for init(): ${B}`);return n.init(Object.assign({backend:l},B))}function u(B,Y){const W={message:"Initialization"};return d(c(Y),W,O=>Object.assign(O,B))}function d(B,Y,W){const[O]=n.change(B,Y,W);return O}function p(B,Y){const[W]=n.emptyChange(B,Y);return W}function h(B,Y={}){const W=l.clone(n.getBackendState(B,"clone"));return w(c(Y),l.getPatch(W),W,[],Y)}function f(B){l.free(n.getBackendState(B,"free"))}function y(B,Y={}){const W=l.load(B);return w(c(Y),l.getPatch(W),W,[B],Y)}function b(B){return l.save(n.getBackendState(B,"save"))}function E(B,Y){const W=n.getBackendState(B,"merge"),O=n.getBackendState(Y,"merge","second"),D=l.getChangesAdded(W,O),[Q]=_(B,D);return Q}function g(B,Y){const W=n.getBackendState(B,"getChanges"),O=n.getBackendState(Y,"getChanges","second");return l.getChanges(O,l.getHeads(W))}function x(B){return l.getAllChanges(n.getBackendState(B,"getAllChanges"))}function w(B,Y,W,O,D){const Q=n.applyPatch(B,Y,W),ae=D.patchCallback||B[r].patchCallback;return ae&&ae(Y,B,Q,!1,O),Q}function _(B,Y,W={}){const O=n.getBackendState(B,"applyChanges"),[D,Q]=l.applyChanges(O,Y);return[w(B,Q,D,Y,W),Q]}function S(B,Y){if(!o(B)||!o(Y))return B===Y;const W=Object.keys(B).sort(),O=Object.keys(Y).sort();if(W.length!==O.length)return!1;for(let D=0;D<W.length;D++)if(W[D]!==O[D]||!S(B[W[D]],Y[O[D]]))return!1;return!0}function k(B){const Y=n.getActorId(B),W=x(B);return W.map((O,D)=>({get change(){return a(O)},get snapshot(){const Q=l.loadChanges(l.init(),W.slice(0,D+1));return n.applyPatch(c(Y),l.getPatch(Q),Q)}}))}function I(B,Y){const W=n.getBackendState(B,"generateSyncMessage");return l.generateSyncMessage(W,Y)}function C(B,Y,W){const O=n.getBackendState(B,"receiveSyncMessage"),[D,Q,ae]=l.receiveSyncMessage(O,Y,W);if(!ae)return[B,Q,ae];let U=null;return B[r].patchCallback&&(U=l.decodeSyncMessage(W).changes),[w(B,ae,D,U,{}),Q,ae]}function L(){return l.initSyncState()}function V(B){l=B}e.exports={init:c,from:u,change:d,emptyChange:p,clone:h,free:f,load:y,save:b,merge:E,getChanges:g,getAllChanges:x,applyChanges:_,encodeChange:i,decodeChange:a,equals:S,getHistory:k,uuid:t,Frontend:n,setDefaultBackend:V,generateSyncMessage:I,receiveSyncMessage:C,initSyncState:L,get Backend(){return l}};for(let B of["getObjectId","getObjectById","getActorId","setActorId","getConflicts","getLastLocalChange","Text","Table","Counter","Observable","Int","Uint","Float64"])e.exports[B]=n[B]})(zj);var IO=zj.exports;const ni=uf(IO);function $l(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var F0={exports:{}};/*!
    localForage -- Offline Storage, Improved
    Version 1.10.0
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/(function(e,t){(function(n){e.exports=n()})(function(){return function n(r,i,a){function o(u,d){if(!i[u]){if(!r[u]){var p=typeof $l=="function"&&$l;if(!d&&p)return p(u,!0);if(l)return l(u,!0);var h=new Error("Cannot find module '"+u+"'");throw h.code="MODULE_NOT_FOUND",h}var f=i[u]={exports:{}};r[u][0].call(f.exports,function(y){var b=r[u][1][y];return o(b||y)},f,f.exports,n,r,i,a)}return i[u].exports}for(var l=typeof $l=="function"&&$l,c=0;c<a.length;c++)o(a[c]);return o}({1:[function(n,r,i){(function(a){var o=a.MutationObserver||a.WebKitMutationObserver,l;if(o){var c=0,u=new o(y),d=a.document.createTextNode("");u.observe(d,{characterData:!0}),l=function(){d.data=c=++c%2}}else if(!a.setImmediate&&typeof a.MessageChannel<"u"){var p=new a.MessageChannel;p.port1.onmessage=y,l=function(){p.port2.postMessage(0)}}else"document"in a&&"onreadystatechange"in a.document.createElement("script")?l=function(){var E=a.document.createElement("script");E.onreadystatechange=function(){y(),E.onreadystatechange=null,E.parentNode.removeChild(E),E=null},a.document.documentElement.appendChild(E)}:l=function(){setTimeout(y,0)};var h,f=[];function y(){h=!0;for(var E,g,x=f.length;x;){for(g=f,f=[],E=-1;++E<x;)g[E]();x=f.length}h=!1}r.exports=b;function b(E){f.push(E)===1&&!h&&l()}}).call(this,typeof Ka<"u"?Ka:typeof self<"u"?self:typeof window<"u"?window:{})},{}],2:[function(n,r,i){var a=n(1);function o(){}var l={},c=["REJECTED"],u=["FULFILLED"],d=["PENDING"];r.exports=p;function p(S){if(typeof S!="function")throw new TypeError("resolver must be a function");this.state=d,this.queue=[],this.outcome=void 0,S!==o&&b(this,S)}p.prototype.catch=function(S){return this.then(null,S)},p.prototype.then=function(S,k){if(typeof S!="function"&&this.state===u||typeof k!="function"&&this.state===c)return this;var I=new this.constructor(o);if(this.state!==d){var C=this.state===u?S:k;f(I,C,this.outcome)}else this.queue.push(new h(I,S,k));return I};function h(S,k,I){this.promise=S,typeof k=="function"&&(this.onFulfilled=k,this.callFulfilled=this.otherCallFulfilled),typeof I=="function"&&(this.onRejected=I,this.callRejected=this.otherCallRejected)}h.prototype.callFulfilled=function(S){l.resolve(this.promise,S)},h.prototype.otherCallFulfilled=function(S){f(this.promise,this.onFulfilled,S)},h.prototype.callRejected=function(S){l.reject(this.promise,S)},h.prototype.otherCallRejected=function(S){f(this.promise,this.onRejected,S)};function f(S,k,I){a(function(){var C;try{C=k(I)}catch(L){return l.reject(S,L)}C===S?l.reject(S,new TypeError("Cannot resolve promise with itself")):l.resolve(S,C)})}l.resolve=function(S,k){var I=E(y,k);if(I.status==="error")return l.reject(S,I.value);var C=I.value;if(C)b(S,C);else{S.state=u,S.outcome=k;for(var L=-1,V=S.queue.length;++L<V;)S.queue[L].callFulfilled(k)}return S},l.reject=function(S,k){S.state=c,S.outcome=k;for(var I=-1,C=S.queue.length;++I<C;)S.queue[I].callRejected(k);return S};function y(S){var k=S&&S.then;if(S&&(typeof S=="object"||typeof S=="function")&&typeof k=="function")return function(){k.apply(S,arguments)}}function b(S,k){var I=!1;function C(Y){I||(I=!0,l.reject(S,Y))}function L(Y){I||(I=!0,l.resolve(S,Y))}function V(){k(L,C)}var B=E(V);B.status==="error"&&C(B.value)}function E(S,k){var I={};try{I.value=S(k),I.status="success"}catch(C){I.status="error",I.value=C}return I}p.resolve=g;function g(S){return S instanceof this?S:l.resolve(new this(o),S)}p.reject=x;function x(S){var k=new this(o);return l.reject(k,S)}p.all=w;function w(S){var k=this;if(Object.prototype.toString.call(S)!=="[object Array]")return this.reject(new TypeError("must be an array"));var I=S.length,C=!1;if(!I)return this.resolve([]);for(var L=new Array(I),V=0,B=-1,Y=new this(o);++B<I;)W(S[B],B);return Y;function W(O,D){k.resolve(O).then(Q,function(ae){C||(C=!0,l.reject(Y,ae))});function Q(ae){L[D]=ae,++V===I&&!C&&(C=!0,l.resolve(Y,L))}}}p.race=_;function _(S){var k=this;if(Object.prototype.toString.call(S)!=="[object Array]")return this.reject(new TypeError("must be an array"));var I=S.length,C=!1;if(!I)return this.resolve([]);for(var L=-1,V=new this(o);++L<I;)B(S[L]);return V;function B(Y){k.resolve(Y).then(function(W){C||(C=!0,l.resolve(V,W))},function(W){C||(C=!0,l.reject(V,W))})}}},{1:1}],3:[function(n,r,i){(function(a){typeof a.Promise!="function"&&(a.Promise=n(2))}).call(this,typeof Ka<"u"?Ka:typeof self<"u"?self:typeof window<"u"?window:{})},{2:2}],4:[function(n,r,i){var a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(v){return typeof v}:function(v){return v&&typeof Symbol=="function"&&v.constructor===Symbol&&v!==Symbol.prototype?"symbol":typeof v};function o(v,j){if(!(v instanceof j))throw new TypeError("Cannot call a class as a function")}function l(){try{if(typeof indexedDB<"u")return indexedDB;if(typeof webkitIndexedDB<"u")return webkitIndexedDB;if(typeof mozIndexedDB<"u")return mozIndexedDB;if(typeof OIndexedDB<"u")return OIndexedDB;if(typeof msIndexedDB<"u")return msIndexedDB}catch{return}}var c=l();function u(){try{if(!c||!c.open)return!1;var v=typeof openDatabase<"u"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),j=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!v||j)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch{return!1}}function d(v,j){v=v||[],j=j||{};try{return new Blob(v,j)}catch(T){if(T.name!=="TypeError")throw T;for(var N=typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder,R=new N,P=0;P<v.length;P+=1)R.append(v[P]);return R.getBlob(j.type)}}typeof Promise>"u"&&n(3);var p=Promise;function h(v,j){j&&v.then(function(N){j(null,N)},function(N){j(N)})}function f(v,j,N){typeof j=="function"&&v.then(j),typeof N=="function"&&v.catch(N)}function y(v){return typeof v!="string"&&(console.warn(v+" used as a key, but it is not a string."),v=String(v)),v}function b(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var E="local-forage-detect-blob-support",g=void 0,x={},w=Object.prototype.toString,_="readonly",S="readwrite";function k(v){for(var j=v.length,N=new ArrayBuffer(j),R=new Uint8Array(N),P=0;P<j;P++)R[P]=v.charCodeAt(P);return N}function I(v){return new p(function(j){var N=v.transaction(E,S),R=d([""]);N.objectStore(E).put(R,"key"),N.onabort=function(P){P.preventDefault(),P.stopPropagation(),j(!1)},N.oncomplete=function(){var P=navigator.userAgent.match(/Chrome\/(\d+)/),T=navigator.userAgent.match(/Edge\//);j(T||!P||parseInt(P[1],10)>=43)}}).catch(function(){return!1})}function C(v){return typeof g=="boolean"?p.resolve(g):I(v).then(function(j){return g=j,g})}function L(v){var j=x[v.name],N={};N.promise=new p(function(R,P){N.resolve=R,N.reject=P}),j.deferredOperations.push(N),j.dbReady?j.dbReady=j.dbReady.then(function(){return N.promise}):j.dbReady=N.promise}function V(v){var j=x[v.name],N=j.deferredOperations.pop();if(N)return N.resolve(),N.promise}function B(v,j){var N=x[v.name],R=N.deferredOperations.pop();if(R)return R.reject(j),R.promise}function Y(v,j){return new p(function(N,R){if(x[v.name]=x[v.name]||je(),v.db)if(j)L(v),v.db.close();else return N(v.db);var P=[v.name];j&&P.push(v.version);var T=c.open.apply(c,P);j&&(T.onupgradeneeded=function($){var q=T.result;try{q.createObjectStore(v.storeName),$.oldVersion<=1&&q.createObjectStore(E)}catch(G){if(G.name==="ConstraintError")console.warn('The database "'+v.name+'" has been upgraded from version '+$.oldVersion+" to version "+$.newVersion+', but the storage "'+v.storeName+'" already exists.');else throw G}}),T.onerror=function($){$.preventDefault(),R(T.error)},T.onsuccess=function(){var $=T.result;$.onversionchange=function(q){q.target.close()},N($),V(v)}})}function W(v){return Y(v,!1)}function O(v){return Y(v,!0)}function D(v,j){if(!v.db)return!0;var N=!v.db.objectStoreNames.contains(v.storeName),R=v.version<v.db.version,P=v.version>v.db.version;if(R&&(v.version!==j&&console.warn('The database "'+v.name+`" can't be downgraded from version `+v.db.version+" to version "+v.version+"."),v.version=v.db.version),P||N){if(N){var T=v.db.version+1;T>v.version&&(v.version=T)}return!0}return!1}function Q(v){return new p(function(j,N){var R=new FileReader;R.onerror=N,R.onloadend=function(P){var T=btoa(P.target.result||"");j({__local_forage_encoded_blob:!0,data:T,type:v.type})},R.readAsBinaryString(v)})}function ae(v){var j=k(atob(v.data));return d([j],{type:v.type})}function U(v){return v&&v.__local_forage_encoded_blob}function Z(v){var j=this,N=j._initReady().then(function(){var R=x[j._dbInfo.name];if(R&&R.dbReady)return R.dbReady});return f(N,v,v),N}function le(v){L(v);for(var j=x[v.name],N=j.forages,R=0;R<N.length;R++){var P=N[R];P._dbInfo.db&&(P._dbInfo.db.close(),P._dbInfo.db=null)}return v.db=null,W(v).then(function(T){return v.db=T,D(v)?O(v):T}).then(function(T){v.db=j.db=T;for(var $=0;$<N.length;$++)N[$]._dbInfo.db=T}).catch(function(T){throw B(v,T),T})}function ye(v,j,N,R){R===void 0&&(R=1);try{var P=v.db.transaction(v.storeName,j);N(null,P)}catch(T){if(R>0&&(!v.db||T.name==="InvalidStateError"||T.name==="NotFoundError"))return p.resolve().then(function(){if(!v.db||T.name==="NotFoundError"&&!v.db.objectStoreNames.contains(v.storeName)&&v.version<=v.db.version)return v.db&&(v.version=v.db.version+1),O(v)}).then(function(){return le(v).then(function(){ye(v,j,N,R-1)})}).catch(N);N(T)}}function je(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function Ae(v){var j=this,N={db:null};if(v)for(var R in v)N[R]=v[R];var P=x[N.name];P||(P=je(),x[N.name]=P),P.forages.push(j),j._initReady||(j._initReady=j.ready,j.ready=Z);var T=[];function $(){return p.resolve()}for(var q=0;q<P.forages.length;q++){var G=P.forages[q];G!==j&&T.push(G._initReady().catch($))}var ne=P.forages.slice(0);return p.all(T).then(function(){return N.db=P.db,W(N)}).then(function(re){return N.db=re,D(N,j._defaultConfig.version)?O(N):re}).then(function(re){N.db=P.db=re,j._dbInfo=N;for(var pe=0;pe<ne.length;pe++){var Se=ne[pe];Se!==j&&(Se._dbInfo.db=N.db,Se._dbInfo.version=N.version)}})}function H(v,j){var N=this;v=y(v);var R=new p(function(P,T){N.ready().then(function(){ye(N._dbInfo,_,function($,q){if($)return T($);try{var G=q.objectStore(N._dbInfo.storeName),ne=G.get(v);ne.onsuccess=function(){var re=ne.result;re===void 0&&(re=null),U(re)&&(re=ae(re)),P(re)},ne.onerror=function(){T(ne.error)}}catch(re){T(re)}})}).catch(T)});return h(R,j),R}function F(v,j){var N=this,R=new p(function(P,T){N.ready().then(function(){ye(N._dbInfo,_,function($,q){if($)return T($);try{var G=q.objectStore(N._dbInfo.storeName),ne=G.openCursor(),re=1;ne.onsuccess=function(){var pe=ne.result;if(pe){var Se=pe.value;U(Se)&&(Se=ae(Se));var Ue=v(Se,pe.key,re++);Ue!==void 0?P(Ue):pe.continue()}else P()},ne.onerror=function(){T(ne.error)}}catch(pe){T(pe)}})}).catch(T)});return h(R,j),R}function se(v,j,N){var R=this;v=y(v);var P=new p(function(T,$){var q;R.ready().then(function(){return q=R._dbInfo,w.call(j)==="[object Blob]"?C(q.db).then(function(G){return G?j:Q(j)}):j}).then(function(G){ye(R._dbInfo,S,function(ne,re){if(ne)return $(ne);try{var pe=re.objectStore(R._dbInfo.storeName);G===null&&(G=void 0);var Se=pe.put(G,v);re.oncomplete=function(){G===void 0&&(G=null),T(G)},re.onabort=re.onerror=function(){var Ue=Se.error?Se.error:Se.transaction.error;$(Ue)}}catch(Ue){$(Ue)}})}).catch($)});return h(P,N),P}function xe(v,j){var N=this;v=y(v);var R=new p(function(P,T){N.ready().then(function(){ye(N._dbInfo,S,function($,q){if($)return T($);try{var G=q.objectStore(N._dbInfo.storeName),ne=G.delete(v);q.oncomplete=function(){P()},q.onerror=function(){T(ne.error)},q.onabort=function(){var re=ne.error?ne.error:ne.transaction.error;T(re)}}catch(re){T(re)}})}).catch(T)});return h(R,j),R}function Ce(v){var j=this,N=new p(function(R,P){j.ready().then(function(){ye(j._dbInfo,S,function(T,$){if(T)return P(T);try{var q=$.objectStore(j._dbInfo.storeName),G=q.clear();$.oncomplete=function(){R()},$.onabort=$.onerror=function(){var ne=G.error?G.error:G.transaction.error;P(ne)}}catch(ne){P(ne)}})}).catch(P)});return h(N,v),N}function Pe(v){var j=this,N=new p(function(R,P){j.ready().then(function(){ye(j._dbInfo,_,function(T,$){if(T)return P(T);try{var q=$.objectStore(j._dbInfo.storeName),G=q.count();G.onsuccess=function(){R(G.result)},G.onerror=function(){P(G.error)}}catch(ne){P(ne)}})}).catch(P)});return h(N,v),N}function Ge(v,j){var N=this,R=new p(function(P,T){if(v<0){P(null);return}N.ready().then(function(){ye(N._dbInfo,_,function($,q){if($)return T($);try{var G=q.objectStore(N._dbInfo.storeName),ne=!1,re=G.openKeyCursor();re.onsuccess=function(){var pe=re.result;if(!pe){P(null);return}v===0||ne?P(pe.key):(ne=!0,pe.advance(v))},re.onerror=function(){T(re.error)}}catch(pe){T(pe)}})}).catch(T)});return h(R,j),R}function X(v){var j=this,N=new p(function(R,P){j.ready().then(function(){ye(j._dbInfo,_,function(T,$){if(T)return P(T);try{var q=$.objectStore(j._dbInfo.storeName),G=q.openKeyCursor(),ne=[];G.onsuccess=function(){var re=G.result;if(!re){R(ne);return}ne.push(re.key),re.continue()},G.onerror=function(){P(G.error)}}catch(re){P(re)}})}).catch(P)});return h(N,v),N}function he(v,j){j=b.apply(this,arguments);var N=this.config();v=typeof v!="function"&&v||{},v.name||(v.name=v.name||N.name,v.storeName=v.storeName||N.storeName);var R=this,P;if(!v.name)P=p.reject("Invalid arguments");else{var T=v.name===N.name&&R._dbInfo.db,$=T?p.resolve(R._dbInfo.db):W(v).then(function(q){var G=x[v.name],ne=G.forages;G.db=q;for(var re=0;re<ne.length;re++)ne[re]._dbInfo.db=q;return q});v.storeName?P=$.then(function(q){if(q.objectStoreNames.contains(v.storeName)){var G=q.version+1;L(v);var ne=x[v.name],re=ne.forages;q.close();for(var pe=0;pe<re.length;pe++){var Se=re[pe];Se._dbInfo.db=null,Se._dbInfo.version=G}var Ue=new p(function($e,rt){var Xe=c.open(v.name,G);Xe.onerror=function(xt){var yn=Xe.result;yn.close(),rt(xt)},Xe.onupgradeneeded=function(){var xt=Xe.result;xt.deleteObjectStore(v.storeName)},Xe.onsuccess=function(){var xt=Xe.result;xt.close(),$e(xt)}});return Ue.then(function($e){ne.db=$e;for(var rt=0;rt<re.length;rt++){var Xe=re[rt];Xe._dbInfo.db=$e,V(Xe._dbInfo)}}).catch(function($e){throw(B(v,$e)||p.resolve()).catch(function(){}),$e})}}):P=$.then(function(q){L(v);var G=x[v.name],ne=G.forages;q.close();for(var re=0;re<ne.length;re++){var pe=ne[re];pe._dbInfo.db=null}var Se=new p(function(Ue,$e){var rt=c.deleteDatabase(v.name);rt.onerror=function(){var Xe=rt.result;Xe&&Xe.close(),$e(rt.error)},rt.onblocked=function(){console.warn('dropInstance blocked for database "'+v.name+'" until all open connections are closed')},rt.onsuccess=function(){var Xe=rt.result;Xe&&Xe.close(),Ue(Xe)}});return Se.then(function(Ue){G.db=Ue;for(var $e=0;$e<ne.length;$e++){var rt=ne[$e];V(rt._dbInfo)}}).catch(function(Ue){throw(B(v,Ue)||p.resolve()).catch(function(){}),Ue})})}return h(P,j),P}var ge={_driver:"asyncStorage",_initStorage:Ae,_support:u(),iterate:F,getItem:H,setItem:se,removeItem:xe,clear:Ce,length:Pe,key:Ge,keys:X,dropInstance:he};function me(){return typeof openDatabase=="function"}var Ne="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",dt="~~local_forage_type~",pt=/^~~local_forage_type~([^~]+)~/,Te="__lfsc__:",we=Te.length,ce="arbf",ve="blob",fe="si08",_e="ui08",be="uic8",Ve="si16",ke="si32",tn="ur16",fn="ui32",In="fl32",Pt="fl64",pn=we+ce.length,Rn=Object.prototype.toString;function mr(v){var j=v.length*.75,N=v.length,R,P=0,T,$,q,G;v[v.length-1]==="="&&(j--,v[v.length-2]==="="&&j--);var ne=new ArrayBuffer(j),re=new Uint8Array(ne);for(R=0;R<N;R+=4)T=Ne.indexOf(v[R]),$=Ne.indexOf(v[R+1]),q=Ne.indexOf(v[R+2]),G=Ne.indexOf(v[R+3]),re[P++]=T<<2|$>>4,re[P++]=($&15)<<4|q>>2,re[P++]=(q&3)<<6|G&63;return ne}function gr(v){var j=new Uint8Array(v),N="",R;for(R=0;R<j.length;R+=3)N+=Ne[j[R]>>2],N+=Ne[(j[R]&3)<<4|j[R+1]>>4],N+=Ne[(j[R+1]&15)<<2|j[R+2]>>6],N+=Ne[j[R+2]&63];return j.length%3===2?N=N.substring(0,N.length-1)+"=":j.length%3===1&&(N=N.substring(0,N.length-2)+"=="),N}function yr(v,j){var N="";if(v&&(N=Rn.call(v)),v&&(N==="[object ArrayBuffer]"||v.buffer&&Rn.call(v.buffer)==="[object ArrayBuffer]")){var R,P=Te;v instanceof ArrayBuffer?(R=v,P+=ce):(R=v.buffer,N==="[object Int8Array]"?P+=fe:N==="[object Uint8Array]"?P+=_e:N==="[object Uint8ClampedArray]"?P+=be:N==="[object Int16Array]"?P+=Ve:N==="[object Uint16Array]"?P+=tn:N==="[object Int32Array]"?P+=ke:N==="[object Uint32Array]"?P+=fn:N==="[object Float32Array]"?P+=In:N==="[object Float64Array]"?P+=Pt:j(new Error("Failed to get type for BinaryArray"))),j(P+gr(R))}else if(N==="[object Blob]"){var T=new FileReader;T.onload=function(){var $=dt+v.type+"~"+gr(this.result);j(Te+ve+$)},T.readAsArrayBuffer(v)}else try{j(JSON.stringify(v))}catch($){console.error("Couldn't convert value into a JSON string: ",v),j(null,$)}}function vr(v){if(v.substring(0,we)!==Te)return JSON.parse(v);var j=v.substring(pn),N=v.substring(we,pn),R;if(N===ve&&pt.test(j)){var P=j.match(pt);R=P[1],j=j.substring(P[0].length)}var T=mr(j);switch(N){case ce:return T;case ve:return d([T],{type:R});case fe:return new Int8Array(T);case _e:return new Uint8Array(T);case be:return new Uint8ClampedArray(T);case Ve:return new Int16Array(T);case tn:return new Uint16Array(T);case ke:return new Int32Array(T);case fn:return new Uint32Array(T);case In:return new Float32Array(T);case Pt:return new Float64Array(T);default:throw new Error("Unkown type: "+N)}}var Fr={serialize:yr,deserialize:vr,stringToBuffer:mr,bufferToString:gr};function mn(v,j,N,R){v.executeSql("CREATE TABLE IF NOT EXISTS "+j.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],N,R)}function xr(v){var j=this,N={db:null};if(v)for(var R in v)N[R]=typeof v[R]!="string"?v[R].toString():v[R];var P=new p(function(T,$){try{N.db=openDatabase(N.name,String(N.version),N.description,N.size)}catch(q){return $(q)}N.db.transaction(function(q){mn(q,N,function(){j._dbInfo=N,T()},function(G,ne){$(ne)})},$)});return N.serializer=Fr,P}function Gt(v,j,N,R,P,T){v.executeSql(N,R,P,function($,q){q.code===q.SYNTAX_ERR?$.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[j.storeName],function(G,ne){ne.rows.length?T(G,q):mn(G,j,function(){G.executeSql(N,R,P,T)},T)},T):T($,q)},T)}function nn(v,j){var N=this;v=y(v);var R=new p(function(P,T){N.ready().then(function(){var $=N._dbInfo;$.db.transaction(function(q){Gt(q,$,"SELECT * FROM "+$.storeName+" WHERE key = ? LIMIT 1",[v],function(G,ne){var re=ne.rows.length?ne.rows.item(0).value:null;re&&(re=$.serializer.deserialize(re)),P(re)},function(G,ne){T(ne)})})}).catch(T)});return h(R,j),R}function gi(v,j){var N=this,R=new p(function(P,T){N.ready().then(function(){var $=N._dbInfo;$.db.transaction(function(q){Gt(q,$,"SELECT * FROM "+$.storeName,[],function(G,ne){for(var re=ne.rows,pe=re.length,Se=0;Se<pe;Se++){var Ue=re.item(Se),$e=Ue.value;if($e&&($e=$.serializer.deserialize($e)),$e=v($e,Ue.key,Se+1),$e!==void 0){P($e);return}}P()},function(G,ne){T(ne)})})}).catch(T)});return h(R,j),R}function Tn(v,j,N,R){var P=this;v=y(v);var T=new p(function($,q){P.ready().then(function(){j===void 0&&(j=null);var G=j,ne=P._dbInfo;ne.serializer.serialize(j,function(re,pe){pe?q(pe):ne.db.transaction(function(Se){Gt(Se,ne,"INSERT OR REPLACE INTO "+ne.storeName+" (key, value) VALUES (?, ?)",[v,re],function(){$(G)},function(Ue,$e){q($e)})},function(Se){if(Se.code===Se.QUOTA_ERR){if(R>0){$(Tn.apply(P,[v,G,N,R-1]));return}q(Se)}})})}).catch(q)});return h(T,N),T}function Oa(v,j,N){return Tn.apply(this,[v,j,N,1])}function Nt(v,j){var N=this;v=y(v);var R=new p(function(P,T){N.ready().then(function(){var $=N._dbInfo;$.db.transaction(function(q){Gt(q,$,"DELETE FROM "+$.storeName+" WHERE key = ?",[v],function(){P()},function(G,ne){T(ne)})})}).catch(T)});return h(R,j),R}function On(v){var j=this,N=new p(function(R,P){j.ready().then(function(){var T=j._dbInfo;T.db.transaction(function($){Gt($,T,"DELETE FROM "+T.storeName,[],function(){R()},function(q,G){P(G)})})}).catch(P)});return h(N,v),N}function wt(v){var j=this,N=new p(function(R,P){j.ready().then(function(){var T=j._dbInfo;T.db.transaction(function($){Gt($,T,"SELECT COUNT(key) as c FROM "+T.storeName,[],function(q,G){var ne=G.rows.item(0).c;R(ne)},function(q,G){P(G)})})}).catch(P)});return h(N,v),N}function ks(v,j){var N=this,R=new p(function(P,T){N.ready().then(function(){var $=N._dbInfo;$.db.transaction(function(q){Gt(q,$,"SELECT key FROM "+$.storeName+" WHERE id = ? LIMIT 1",[v+1],function(G,ne){var re=ne.rows.length?ne.rows.item(0).key:null;P(re)},function(G,ne){T(ne)})})}).catch(T)});return h(R,j),R}function Is(v){var j=this,N=new p(function(R,P){j.ready().then(function(){var T=j._dbInfo;T.db.transaction(function($){Gt($,T,"SELECT key FROM "+T.storeName,[],function(q,G){for(var ne=[],re=0;re<G.rows.length;re++)ne.push(G.rows.item(re).key);R(ne)},function(q,G){P(G)})})}).catch(P)});return h(N,v),N}function Pa(v){return new p(function(j,N){v.transaction(function(R){R.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(P,T){for(var $=[],q=0;q<T.rows.length;q++)$.push(T.rows.item(q).name);j({db:v,storeNames:$})},function(P,T){N(T)})},function(R){N(R)})})}function Hr(v,j){j=b.apply(this,arguments);var N=this.config();v=typeof v!="function"&&v||{},v.name||(v.name=v.name||N.name,v.storeName=v.storeName||N.storeName);var R=this,P;return v.name?P=new p(function(T){var $;v.name===N.name?$=R._dbInfo.db:$=openDatabase(v.name,"","",0),v.storeName?T({db:$,storeNames:[v.storeName]}):T(Pa($))}).then(function(T){return new p(function($,q){T.db.transaction(function(G){function ne(Ue){return new p(function($e,rt){G.executeSql("DROP TABLE IF EXISTS "+Ue,[],function(){$e()},function(Xe,xt){rt(xt)})})}for(var re=[],pe=0,Se=T.storeNames.length;pe<Se;pe++)re.push(ne(T.storeNames[pe]));p.all(re).then(function(){$()}).catch(function(Ue){q(Ue)})},function(G){q(G)})})}):P=p.reject("Invalid arguments"),h(P,j),P}var z={_driver:"webSQLStorage",_initStorage:xr,_support:me(),iterate:gi,getItem:nn,setItem:Oa,removeItem:Nt,clear:On,length:wt,key:ks,keys:Is,dropInstance:Hr};function vt(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}function qr(v,j){var N=v.name+"/";return v.storeName!==j.storeName&&(N+=v.storeName+"/"),N}function yi(){var v="_localforage_support_test";try{return localStorage.setItem(v,!0),localStorage.removeItem(v),!1}catch{return!0}}function vi(){return!yi()||localStorage.length>0}function xi(v){var j=this,N={};if(v)for(var R in v)N[R]=v[R];return N.keyPrefix=qr(v,j._defaultConfig),vi()?(j._dbInfo=N,N.serializer=Fr,p.resolve()):p.reject()}function ji(v){var j=this,N=j.ready().then(function(){for(var R=j._dbInfo.keyPrefix,P=localStorage.length-1;P>=0;P--){var T=localStorage.key(P);T.indexOf(R)===0&&localStorage.removeItem(T)}});return h(N,v),N}function bi(v,j){var N=this;v=y(v);var R=N.ready().then(function(){var P=N._dbInfo,T=localStorage.getItem(P.keyPrefix+v);return T&&(T=P.serializer.deserialize(T)),T});return h(R,j),R}function wi(v,j){var N=this,R=N.ready().then(function(){for(var P=N._dbInfo,T=P.keyPrefix,$=T.length,q=localStorage.length,G=1,ne=0;ne<q;ne++){var re=localStorage.key(ne);if(re.indexOf(T)===0){var pe=localStorage.getItem(re);if(pe&&(pe=P.serializer.deserialize(pe)),pe=v(pe,re.substring($),G++),pe!==void 0)return pe}}});return h(R,j),R}function Si(v,j){var N=this,R=N.ready().then(function(){var P=N._dbInfo,T;try{T=localStorage.key(v)}catch{T=null}return T&&(T=T.substring(P.keyPrefix.length)),T});return h(R,j),R}function Ei(v){var j=this,N=j.ready().then(function(){for(var R=j._dbInfo,P=localStorage.length,T=[],$=0;$<P;$++){var q=localStorage.key($);q.indexOf(R.keyPrefix)===0&&T.push(q.substring(R.keyPrefix.length))}return T});return h(N,v),N}function Ni(v){var j=this,N=j.keys().then(function(R){return R.length});return h(N,v),N}function _i(v,j){var N=this;v=y(v);var R=N.ready().then(function(){var P=N._dbInfo;localStorage.removeItem(P.keyPrefix+v)});return h(R,j),R}function Rs(v,j,N){var R=this;v=y(v);var P=R.ready().then(function(){j===void 0&&(j=null);var T=j;return new p(function($,q){var G=R._dbInfo;G.serializer.serialize(j,function(ne,re){if(re)q(re);else try{localStorage.setItem(G.keyPrefix+v,ne),$(T)}catch(pe){(pe.name==="QuotaExceededError"||pe.name==="NS_ERROR_DOM_QUOTA_REACHED")&&q(pe),q(pe)}})})});return h(P,N),P}function Ts(v,j){if(j=b.apply(this,arguments),v=typeof v!="function"&&v||{},!v.name){var N=this.config();v.name=v.name||N.name,v.storeName=v.storeName||N.storeName}var R=this,P;return v.name?P=new p(function(T){v.storeName?T(qr(v,R._defaultConfig)):T(v.name+"/")}).then(function(T){for(var $=localStorage.length-1;$>=0;$--){var q=localStorage.key($);q.indexOf(T)===0&&localStorage.removeItem(q)}}):P=p.reject("Invalid arguments"),h(P,j),P}var Os={_driver:"localStorageWrapper",_initStorage:xi,_support:vt(),iterate:wi,getItem:bi,setItem:Rs,removeItem:_i,clear:ji,length:Ni,key:Si,keys:Ei,dropInstance:Ts},Ps=function(j,N){return j===N||typeof j=="number"&&typeof N=="number"&&isNaN(j)&&isNaN(N)},Ls=function(j,N){for(var R=j.length,P=0;P<R;){if(Ps(j[P],N))return!0;P++}return!1},zr=Array.isArray||function(v){return Object.prototype.toString.call(v)==="[object Array]"},Pn={},Wr={},gn={INDEXEDDB:ge,WEBSQL:z,LOCALSTORAGE:Os},Ds=[gn.INDEXEDDB._driver,gn.WEBSQL._driver,gn.LOCALSTORAGE._driver],Kn=["dropInstance"],jr=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(Kn),Ms={description:"",driver:Ds.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function Us(v,j){v[j]=function(){var N=arguments;return v.ready().then(function(){return v[j].apply(v,N)})}}function br(){for(var v=1;v<arguments.length;v++){var j=arguments[v];if(j)for(var N in j)j.hasOwnProperty(N)&&(zr(j[N])?arguments[0][N]=j[N].slice():arguments[0][N]=j[N])}return arguments[0]}var A=function(){function v(j){o(this,v);for(var N in gn)if(gn.hasOwnProperty(N)){var R=gn[N],P=R._driver;this[N]=P,Pn[P]||this.defineDriver(R)}this._defaultConfig=br({},Ms),this._config=br({},this._defaultConfig,j),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return v.prototype.config=function(N){if((typeof N>"u"?"undefined":a(N))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var R in N){if(R==="storeName"&&(N[R]=N[R].replace(/\W/g,"_")),R==="version"&&typeof N[R]!="number")return new Error("Database version must be a number.");this._config[R]=N[R]}return"driver"in N&&N.driver?this.setDriver(this._config.driver):!0}else return typeof N=="string"?this._config[N]:this._config},v.prototype.defineDriver=function(N,R,P){var T=new p(function($,q){try{var G=N._driver,ne=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!N._driver){q(ne);return}for(var re=jr.concat("_initStorage"),pe=0,Se=re.length;pe<Se;pe++){var Ue=re[pe],$e=!Ls(Kn,Ue);if(($e||N[Ue])&&typeof N[Ue]!="function"){q(ne);return}}var rt=function(){for(var yn=function(Eu){return function(){var rn=new Error("Method "+Eu+" is not implemented by the current driver"),lt=p.reject(rn);return h(lt,arguments[arguments.length-1]),lt}},Jn=0,cl=Kn.length;Jn<cl;Jn++){var Ai=Kn[Jn];N[Ai]||(N[Ai]=yn(Ai))}};rt();var Xe=function(yn){Pn[G]&&console.info("Redefining LocalForage driver: "+G),Pn[G]=N,Wr[G]=yn,$()};"_support"in N?N._support&&typeof N._support=="function"?N._support().then(Xe,q):Xe(!!N._support):Xe(!0)}catch(xt){q(xt)}});return f(T,R,P),T},v.prototype.driver=function(){return this._driver||null},v.prototype.getDriver=function(N,R,P){var T=Pn[N]?p.resolve(Pn[N]):p.reject(new Error("Driver not found."));return f(T,R,P),T},v.prototype.getSerializer=function(N){var R=p.resolve(Fr);return f(R,N),R},v.prototype.ready=function(N){var R=this,P=R._driverSet.then(function(){return R._ready===null&&(R._ready=R._initDriver()),R._ready});return f(P,N,N),P},v.prototype.setDriver=function(N,R,P){var T=this;zr(N)||(N=[N]);var $=this._getSupportedDrivers(N);function q(){T._config.driver=T.driver()}function G(pe){return T._extend(pe),q(),T._ready=T._initStorage(T._config),T._ready}function ne(pe){return function(){var Se=0;function Ue(){for(;Se<pe.length;){var $e=pe[Se];return Se++,T._dbInfo=null,T._ready=null,T.getDriver($e).then(G).catch(Ue)}q();var rt=new Error("No available storage method found.");return T._driverSet=p.reject(rt),T._driverSet}return Ue()}}var re=this._driverSet!==null?this._driverSet.catch(function(){return p.resolve()}):p.resolve();return this._driverSet=re.then(function(){var pe=$[0];return T._dbInfo=null,T._ready=null,T.getDriver(pe).then(function(Se){T._driver=Se._driver,q(),T._wrapLibraryMethodsWithReady(),T._initDriver=ne($)})}).catch(function(){q();var pe=new Error("No available storage method found.");return T._driverSet=p.reject(pe),T._driverSet}),f(this._driverSet,R,P),this._driverSet},v.prototype.supports=function(N){return!!Wr[N]},v.prototype._extend=function(N){br(this,N)},v.prototype._getSupportedDrivers=function(N){for(var R=[],P=0,T=N.length;P<T;P++){var $=N[P];this.supports($)&&R.push($)}return R},v.prototype._wrapLibraryMethodsWithReady=function(){for(var N=0,R=jr.length;N<R;N++)Us(this,jr[N])},v.prototype.createInstance=function(N){return new v(N)},v}(),M=new A;r.exports=M},{3:3}]},{},[4])(4)})})(F0);var RO=F0.exports;const $p=uf(RO);$p.config({name:"AfyaLinkCRDT"});async function TO(e){const t=await $p.getItem("doc:"+e);let n;if(t&&t.bin)try{n=ni.load(Uint8Array.from(atob(t.bin),r=>r.charCodeAt(0)))}catch(r){console.error("load local doc fail",r),n=ni.init()}else n=ni.init();return{doc:n,docId:e}}async function Fp(e,t){const n=ni.save(t),r=btoa(String.fromCharCode(...new Uint8Array(n)));return await $p.setItem("doc:"+e,{bin:r,ts:Date.now()}),!0}async function OO(e,t){const n=ni.change(e.doc,t);return await Fp(e.docId,n),e.doc=n,e}async function PO(e,t){const r=ni.getAllChanges(e.doc).map(a=>btoa(String.fromCharCode(...new Uint8Array(a))));return!!(await fetch(t+"/api/crdt/"+e.docId+"/changes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({changes:r}),credentials:"include"})).ok}async function LO(e,t){const n=await fetch(t+"/api/crdt/"+e,{credentials:"include"});if(!n.ok)throw new Error("pull failed");const r=await n.json();if(!r.bin)return null;const i=Uint8Array.from(atob(r.bin),o=>o.charCodeAt(0)),a=ni.load(i);return await Fp(e,a),a}const Fl={initDoc:TO,changeDoc:OO,saveLocal:Fp,syncToServer:PO,pullFromServer:LO},Uy="http://localhost:5000";function DO(){const[e,t]=m.useState(null),[n,r]=m.useState("");m.useEffect(()=>{async function o(){const l=await Fl.initDoc("patients_demo");if(t(l),l.doc&&l.doc.patients){const c=Object.keys(l.doc.patients);c.length&&r(l.doc.patients[c[0]].firstName||"")}}o()},[]);async function i(){const o=await Fl.changeDoc(e,l=>{l.patients||(l.patients={});const c="p_"+Date.now();l.patients[c]={firstName:"New",lastName:"",createdAt:Date.now()}});t(o)}async function a(){await Fl.syncToServer(e,Uy);const o=await Fl.pullFromServer("patients_demo",Uy);o&&alert("Pulled server doc with patients: "+(o.patients?Object.keys(o.patients).length:0))}return s.jsxs("div",{children:[s.jsx("h2",{children:"CRDT Patient Editor (demo)"}),s.jsx("button",{onClick:i,children:"Add Patient"}),s.jsx("button",{onClick:a,children:"Sync Now"}),s.jsxs("div",{children:["First name sample: ",n]})]})}function MO(){const[e,t]=m.useState([]),[n,r]=m.useState(!1),[i,a]=m.useState("ALL"),[o,l]=m.useState("ALL");return m.useEffect(()=>{r(!0),F_({category:i,read:o==="ALL"?void 0:o==="READ"?"true":"false"}).then(u=>{Array.isArray(u)?t(u):Array.isArray(u==null?void 0:u.items)?t(u.items):t([])}).catch(()=>t([])).finally(()=>r(!1))},[i,o]),s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"Notifications"}),s.jsx("p",{className:"muted",children:"Recent workflow and system updates."})]}),s.jsxs("div",{className:"welcome-actions",children:[s.jsxs("select",{value:i,onChange:c=>a(c.target.value),children:[s.jsx("option",{value:"ALL",children:"All Categories"}),s.jsx("option",{value:"WORKFORCE",children:"Workforce"}),s.jsx("option",{value:"SECURITY",children:"Security"}),s.jsx("option",{value:"BILLING",children:"Billing"}),s.jsx("option",{value:"SYSTEM",children:"System"}),s.jsx("option",{value:"INTEGRATION",children:"Integration"}),s.jsx("option",{value:"AI",children:"AI"})]}),s.jsxs("select",{value:o,onChange:c=>l(c.target.value),children:[s.jsx("option",{value:"ALL",children:"All Status"}),s.jsx("option",{value:"UNREAD",children:"Unread"}),s.jsx("option",{value:"READ",children:"Read"})]}),s.jsx("button",{className:"btn-secondary",onClick:async()=>{await Vj(),t(c=>c.map(u=>({...u,read:!0})))},children:"Mark all read"})]})]}),s.jsx("section",{className:"section",children:s.jsxs("div",{className:"card",children:[n&&s.jsx("p",{children:"Loading..."}),!n&&s.jsxs("table",{className:"table lite",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Time"}),s.jsx("th",{children:"Title"}),s.jsx("th",{children:"Category"}),s.jsx("th",{children:"Message"}),s.jsx("th",{children:"Actions"})]})}),s.jsxs("tbody",{children:[e.map(c=>s.jsxs("tr",{children:[s.jsx("td",{children:new Date(c.createdAt).toLocaleString()}),s.jsxs("td",{children:[c.title||"Notification",!c.read&&s.jsx("span",{className:"badge-dot",style:{marginLeft:8},children:"!"})]}),s.jsx("td",{children:c.category||"SYSTEM"}),s.jsx("td",{children:c.body||"-"}),s.jsx("td",{children:s.jsx("button",{className:"btn-secondary",onClick:async()=>{c.read?(await Bj(c._id),t(u=>u.map(d=>d._id===c._id?{...d,read:!1}:d))):(await Uj(c._id),t(u=>u.map(d=>d._id===c._id?{...d,read:!0}:d)))},children:c.read?"Mark unread":"Mark read"})})]},c._id)),e.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:"5",children:"No notifications yet"})})]})]})]})})]})}function UO(){const[e,t]=m.useState({}),[n,r]=m.useState({stripePublishable:"",stripeSecret:"",mpesaConsumerKey:"",mpesaConsumerSecret:"",mpesaShortcode:"",flutterSecret:"",mode:"test",adminPassword:"",otp:""}),[i,a]=m.useState("edit");m.useEffect(()=>{o()},[]);async function o(){const h=await(await Ir("/api/payment-settings/get")).json();t(h)}async function l(){if(!n.adminPassword||n.adminPassword.length<8){alert("Admin password required and must be >=8 chars");return}const p={stripe:{publishable:n.stripePublishable,secret:n.stripeSecret},mpesa:{consumerKey:n.mpesaConsumerKey,consumerSecret:n.mpesaConsumerSecret,shortcode:n.mpesaShortcode},flutterwave:{secret:n.flutterSecret},mode:n.mode,adminPassword:n.adminPassword},f=await(await Ir("/api/payment-settings/save",{method:"POST",body:p})).json();alert(JSON.stringify(f))}async function c(){const h=await(await Ir("/api/payment-settings/reveal/request",{method:"POST"})).json();h.ok&&a("otp_requested"),alert(h.message||JSON.stringify(h))}async function u(){const h=await(await Ir("/api/payment-settings/reveal/verify",{method:"POST",body:{code:n.otp,adminPassword:n.adminPassword}})).json();h.ok?(alert("Secrets revealed: "+JSON.stringify(h.secrets)),a("edit")):alert(JSON.stringify(h))}async function d(){const p=prompt("Enter OLD admin password"),h=prompt("Enter NEW admin password (store it safely)");if(!p||!h)return;const y=await(await Ir("/api/payment-settings/rotate-password",{method:"POST",body:{oldPassword:p,newPassword:h}})).json();alert(JSON.stringify(y))}return s.jsxs("div",{children:[s.jsx("h2",{children:"Payment Settings"}),s.jsxs("div",{children:[s.jsx("label",{children:"Stripe Publishable"}),s.jsx("input",{value:n.stripePublishable,onChange:p=>r(h=>({...h,stripePublishable:p.target.value}))})]}),s.jsxs("div",{children:[s.jsx("label",{children:"Stripe Secret"}),s.jsx("input",{value:n.stripeSecret,onChange:p=>r(h=>({...h,stripeSecret:p.target.value}))})]}),s.jsxs("div",{children:[s.jsx("label",{children:"MPESA Consumer Key"}),s.jsx("input",{value:n.mpesaConsumerKey,onChange:p=>r(h=>({...h,mpesaConsumerKey:p.target.value}))})]}),s.jsxs("div",{children:[s.jsx("label",{children:"MPESA Consumer Secret"}),s.jsx("input",{value:n.mpesaConsumerSecret,onChange:p=>r(h=>({...h,mpesaConsumerSecret:p.target.value}))})]}),s.jsxs("div",{children:[s.jsx("label",{children:"MPESA Shortcode"}),s.jsx("input",{value:n.mpesaShortcode,onChange:p=>r(h=>({...h,mpesaShortcode:p.target.value}))})]}),s.jsxs("div",{children:[s.jsx("label",{children:"Flutter Secret"}),s.jsx("input",{value:n.flutterSecret,onChange:p=>r(h=>({...h,flutterSecret:p.target.value}))})]}),s.jsxs("div",{children:[s.jsx("label",{children:"Admin Password (required to encrypt)"}),s.jsx("input",{type:"password",value:n.adminPassword,onChange:p=>r(h=>({...h,adminPassword:p.target.value}))})]}),s.jsxs("div",{style:{marginTop:12},children:[s.jsx("button",{onClick:l,children:"Save Settings (Encrypted)"})," ",s.jsx("button",{onClick:c,children:"Request 2FA"})," ",s.jsx("button",{onClick:d,children:"Rotate Admin Password"})]}),i==="otp_requested"&&s.jsxs("div",{style:{marginTop:12},children:[s.jsx("label",{children:"Enter OTP"}),s.jsx("input",{value:n.otp,onChange:p=>r(h=>({...h,otp:p.target.value}))}),s.jsx("button",{onClick:u,children:"Verify & Reveal"})]}),s.jsxs("div",{style:{marginTop:12},children:[s.jsx("h4",{children:"Metadata"}),s.jsx("pre",{children:JSON.stringify(e,null,2)})]})]})}function BO({points:e=[]}){const t=(e||[]).map(u=>Number(u)).filter(u=>Number.isFinite(u));if(t.length<2)return null;const n=120,r=28,i=Math.min(...t),o=Math.max(...t)-i||1,l=n/Math.max(1,t.length-1),c=t.map((u,d)=>{const p=d*l,h=r-(u-i)/o*(r-4)-2;return`${p},${h}`}).join(" ");return s.jsx("svg",{width:n,height:r,viewBox:`0 0 ${n} ${r}`,"aria-hidden":"true",children:s.jsx("polyline",{fill:"none",stroke:"var(--app-accent-2, #2563eb)",strokeWidth:"2",points:c})})}const te=({title:e,value:t,subtitle:n,trend:r,status:i="neutral"})=>s.jsxs("div",{className:`card stat stat-${i}`,children:[s.jsx("div",{className:"card-title",children:e}),s.jsx("div",{className:"card-value",children:t}),Array.isArray(r)&&r.length>1&&s.jsx("div",{style:{marginTop:6},children:s.jsx(BO,{points:r})}),n&&s.jsx("div",{className:"card-sub",children:n})]}),VO=()=>oe("/api/dashboard/doctor"),$O=()=>oe("/api/dashboard/nurse"),FO=()=>oe("/api/dashboard/hr"),HO=()=>oe("/api/dashboard/payroll"),qO=()=>oe("/api/dashboard/staff"),zO=()=>oe("/api/dashboard/lab-tech"),WO=()=>oe("/api/dashboard/security-admin"),GO=()=>oe("/api/dashboard/security-officer"),YO=()=>oe("/api/dashboard/hospital-admin"),KO=()=>oe("/api/dashboard/patient"),JO=()=>oe("/api/dashboard/super-admin"),Hp=async e=>oe("/api/ml/staffing/forecast",{method:"POST",body:e}),qp=async e=>oe("/api/ml/burnout/score",{method:"POST",body:e}),H0=async e=>oe("/api/ml/causal/impact",{method:"POST",body:e}),q0=async e=>oe("/api/ml/digital-twin/simulate",{method:"POST",body:e});function QO(){const{user:e}=Me(),t=Oe(),[n,r]=m.useState(null),[i,a]=m.useState([]),[o,l]=m.useState([]),[c,u]=m.useState(null),[d,p]=m.useState([]),h=b=>{const E=Number(b||0);return E>=75?"risk":E>=45?"warn":"good"},f=async()=>{try{const b=await qp({hoursPerWeek:56,nightShifts:7,consecutiveDays:7,overtimeHours:14,leaveBalanceDays:6,incidentsIn30d:1});u(b||null),p(E=>[...E,Number((b==null?void 0:b.score)||0)].slice(-12))}catch{u(null)}};m.useEffect(()=>{VO().then(E=>r(E)).catch(()=>r(null)),oe("/api/appointments?limit=8&cursorMode=1").then(E=>a(Array.isArray(E==null?void 0:E.items)?E.items:[])).catch(()=>a([])),oe("/api/notifications?limit=8").then(E=>{const g=Array.isArray(E==null?void 0:E.items)?E.items:Array.isArray(E)?E:[];l(g.slice(0,8))}).catch(()=>l([])),f();const b=setInterval(f,45e3);return()=>clearInterval(b)},[]);const y=m.useMemo(()=>[{title:"Todays Appointments",value:(n==null?void 0:n.appointmentsToday)??""},{title:"Inpatients Assigned",value:(n==null?void 0:n.activeEncounters)??""},{title:"Surgeries Scheduled",value:(n==null?void 0:n.upcomingAppointments)??""},{title:"Pending Lab Results",value:(n==null?void 0:n.pendingLabResults)??""},{title:"License Expiry (Days)",value:(n==null?void 0:n.licenseExpiryDays)??""}],[n]);return s.jsxs("div",{className:"dashboard doctor-workspace",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"Doctor Clinical Workspace"}),s.jsxs("p",{className:"muted",children:["Welcome, Dr. ",(e==null?void 0:e.name)||"Clinician",". Zero-click access to todays patients and critical alerts."]})]}),s.jsxs("div",{className:"welcome-actions",children:[s.jsx("button",{className:"btn-primary",onClick:()=>t("/doctor/patients"),children:"Todays Patients"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/doctor/opd"),children:"Start Consultation"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/doctor/schedule"),children:"Open Schedule"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/doctor/leave"),children:"Leave Requests"})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Clinical KPIs"}),s.jsx("div",{className:"grid info-grid",children:y.map(b=>s.jsx(te,{title:b.title,value:b.value},b.title))})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"AI Wellbeing Signal"}),s.jsxs("div",{className:"grid info-grid",children:[s.jsx(te,{title:"Burnout Risk Score",value:(c==null?void 0:c.score)??"",trend:d,subtitle:"Auto-refresh 45s",status:h(c==null?void 0:c.score)}),s.jsx(te,{title:"Risk Band",value:(c==null?void 0:c.band)??""}),s.jsx(te,{title:"Recommendations",value:Array.isArray(c==null?void 0:c.recommendations)?c.recommendations.length:""})]}),s.jsx("div",{className:"welcome-actions",children:s.jsx("button",{className:"btn-secondary",onClick:()=>t("/system-admin/clinical-intelligence"),children:"Open Clinical Intelligence"})})]}),s.jsxs("section",{className:"section doctor-main-grid",children:[s.jsxs("div",{className:"card doctor-schedule-card",children:[s.jsx("h3",{children:"Todays Schedule"}),s.jsx("div",{className:"table-wrap",children:s.jsxs("table",{className:"doctor-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Time"}),s.jsx("th",{children:"Type"}),s.jsx("th",{children:"Patient"}),s.jsx("th",{children:"Status"}),s.jsx("th",{children:"Actions"})]})}),s.jsxs("tbody",{children:[i.map(b=>{var E,g;return s.jsxs("tr",{children:[s.jsx("td",{children:b.scheduledAt?new Date(b.scheduledAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"-"}),s.jsx("td",{children:b.type||"OPD"}),s.jsx("td",{children:((E=b.patient)==null?void 0:E.name)||((g=b.patient)==null?void 0:g.firstName)||"-"}),s.jsx("td",{children:b.status||"Scheduled"}),s.jsx("td",{children:s.jsxs("div",{className:"doctor-actions-row",children:[s.jsx("button",{className:"btn-secondary",onClick:()=>t("/doctor/medical-records"),children:"Open Record"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/doctor/opd"),children:"Start Consultation"})]})})]},b._id)}),i.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:"5",className:"muted",children:"No appointments loaded."})})]})]})})]}),s.jsxs("div",{className:"card doctor-alerts-card",children:[s.jsx("h3",{children:"Alerts Panel"}),s.jsxs("div",{className:"alert-stack",children:[o.map(b=>s.jsx("button",{className:"verify-banner",onClick:()=>t("/admin/notifications"),children:s.jsx("span",{children:b.title||"Clinical Alert"})},b._id)),o.length===0&&s.jsx("div",{className:"muted",children:"No active alerts."})]})]})]})]})}function ZO(){const{user:e}=Me(),t=Oe(),[n,r]=m.useState(null);return m.useEffect(()=>{KO().then(r).catch(()=>r(null))},[]),s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"Patient Self-Service Portal"}),s.jsx("p",{className:"muted",children:"Appointments, records, lab results, billing and insurance in one place."})]}),s.jsxs("div",{className:"welcome-actions",children:[s.jsx("button",{className:"btn-primary",onClick:()=>t("/patient"),children:"My Appointments"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/payments"),children:"Billing"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/profile"),children:"Profile"})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Top Summary"}),s.jsxs("div",{className:"grid info-grid",children:[s.jsx(te,{title:"Upcoming Appointment",value:(n==null?void 0:n.upcomingAppointments)??""}),s.jsx(te,{title:"Outstanding Bill",value:(n==null?void 0:n.unpaidInvoices)??""}),s.jsx(te,{title:"Active Prescription",value:(n==null?void 0:n.prescriptionsActive)??""}),s.jsx(te,{title:"Lab Results",value:(n==null?void 0:n.labResults)??""})]})]}),s.jsxs("section",{className:"section doctor-main-grid",children:[s.jsxs("div",{className:"card doctor-schedule-card",children:[s.jsx("h3",{children:"Health Timeline"}),s.jsxs("div",{className:"panel-grid",children:[s.jsx("button",{className:"action-link",onClick:()=>t("/patient"),children:"Medical Records"}),s.jsx("button",{className:"action-link",onClick:()=>t("/patient"),children:"Prescriptions"}),s.jsx("button",{className:"action-link",onClick:()=>t("/patient"),children:"Lab Results"}),s.jsx("button",{className:"action-link",onClick:()=>t("/patient"),children:"Insurance"})]})]}),s.jsxs("div",{className:"card doctor-alerts-card",children:[s.jsx("h3",{children:"Notifications"}),s.jsxs("div",{className:"alert-stack",children:[s.jsx("button",{className:"btn-secondary",onClick:()=>t("/admin/notifications"),children:"Messages"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/patient"),children:"Feedback"})]})]})]})]})}function XO(){var i,a;const{user:e}=Me(),t=Oe(),[n,r]=m.useState(null);return m.useEffect(()=>{$O().then(r).catch(()=>r(null))},[]),s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"Nurse Clinical Operations"}),s.jsx("p",{className:"muted",children:"Shift execution, patient assignment, medication administration and incident logging."})]}),s.jsxs("div",{className:"welcome-actions",children:[s.jsx("button",{className:"btn-primary",onClick:()=>t("/nurse"),children:"My Shift"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/nurse"),children:"Assigned Patients"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/workforce/requests#leave"),children:"Leave Requests"})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Nursing Snapshot"}),s.jsxs("div",{className:"grid info-grid",children:[s.jsx(te,{title:"Shift Info",value:"Active"}),s.jsx(te,{title:"Assigned Patients",value:(n==null?void 0:n.patientsTotal)??""}),s.jsx(te,{title:"Medication Due Alerts",value:(n==null?void 0:n.pendingLabOrders)??""}),s.jsx(te,{title:"Pending Requests",value:((i=n==null?void 0:n.pendingRequests)==null?void 0:i.total)??""})]})]}),s.jsxs("section",{className:"section doctor-main-grid",children:[s.jsxs("div",{className:"card doctor-schedule-card",children:[s.jsx("h3",{children:"Center Workspace"}),s.jsxs("div",{className:"panel-grid",children:[s.jsx("button",{className:"action-link",onClick:()=>t("/nurse"),children:"Patient Task List"}),s.jsx("button",{className:"action-link",onClick:()=>t("/nurse"),children:"Medication Administration"}),s.jsx("button",{className:"action-link",onClick:()=>t("/nurse"),children:"Vitals Entry"}),s.jsx("button",{className:"action-link",onClick:()=>t("/nurse"),children:"Incident Reports"})]})]}),s.jsxs("div",{className:"card doctor-alerts-card",children:[s.jsx("h3",{children:"Right Panel"}),s.jsxs("div",{className:"alert-stack",children:[s.jsxs("div",{className:"action-pill",children:["Critical Alerts: ",(n==null?void 0:n.appointmentsToday)??""]}),s.jsxs("div",{className:"action-pill",children:["Leave Pending: ",((a=n==null?void 0:n.pendingRequests)==null?void 0:a.leave)??""]}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/workforce/requests"),children:"Open My Requests"})]})]})]})]})}function eP(){const{user:e}=Me(),t=Oe(),[n,r]=m.useState(null);return m.useEffect(()=>{zO().then(r).catch(()=>r(null))},[]),s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"Lab Technician Diagnostics"}),s.jsx("p",{className:"muted",children:"Test queue, sample tracking, quality control and equipment readiness."})]}),s.jsxs("div",{className:"welcome-actions",children:[s.jsx("button",{className:"btn-primary",onClick:()=>t("/labtech/labs"),children:"Test Queue"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/lab-tech"),children:"Equipment Logs"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/reports"),children:"Reports Archive"})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Lab Metrics"}),s.jsxs("div",{className:"grid info-grid",children:[s.jsx(te,{title:"Pending Tests",value:(n==null?void 0:n.pendingOrders)??""}),s.jsx(te,{title:"Completed Today",value:(n==null?void 0:n.completedToday)??""}),s.jsx(te,{title:"Abnormal Results",value:(n==null?void 0:n.overdueOrders)??""}),s.jsx(te,{title:"Orders Today",value:(n==null?void 0:n.ordersToday)??""})]})]}),s.jsxs("section",{className:"section doctor-main-grid",children:[s.jsxs("div",{className:"card doctor-schedule-card",children:[s.jsx("h3",{children:"Center Workspace"}),s.jsxs("div",{className:"panel-grid",children:[s.jsx("button",{className:"action-link",onClick:()=>t("/labtech/labs"),children:"Test Processing Table"}),s.jsx("button",{className:"action-link",onClick:()=>t("/lab-tech"),children:"Sample Tracking"}),s.jsx("button",{className:"action-link",onClick:()=>t("/lab-tech"),children:"Quality Control"}),s.jsx("button",{className:"action-link",onClick:()=>t("/lab-tech"),children:"Safety Checklist"})]})]}),s.jsxs("div",{className:"card doctor-alerts-card",children:[s.jsx("h3",{children:"Right Insights"}),s.jsxs("div",{className:"alert-stack",children:[s.jsx("div",{className:"action-pill",children:"Equipment Status: Live"}),s.jsxs("div",{className:"action-pill",children:["Urgent Flagged: ",(n==null?void 0:n.overdueOrders)??""]})]})]})]})]})}function tP(){const e=Oe(),[t,n]=m.useState([]);m.useEffect(()=>{oe("/api/pharmacy?limit=25").then(i=>n(Array.isArray(i==null?void 0:i.items)?i.items:Array.isArray(i)?i:[])).catch(()=>n([]))},[]);const r=t.filter(i=>Number((i==null?void 0:i.qty)||0)<=Number((i==null?void 0:i.minStock)||0)).length;return s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"Pharmacy Control Center"}),s.jsx("p",{className:"muted",children:"Prescription queue, inventory, controlled drugs and expiry monitoring."})]}),s.jsxs("div",{className:"welcome-actions",children:[s.jsx("button",{className:"btn-primary",onClick:()=>e("/pharmacy"),children:"Prescription Queue"}),s.jsx("button",{className:"btn-secondary",onClick:()=>e("/inventory"),children:"Inventory"}),s.jsx("button",{className:"btn-secondary",onClick:()=>e("/reports"),children:"Reports"})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Pharmacy Snapshot"}),s.jsxs("div",{className:"grid info-grid",children:[s.jsx(te,{title:"Pending Prescriptions",value:t.length}),s.jsx(te,{title:"Low Stock Alerts",value:r}),s.jsx(te,{title:"Expiring Drugs",value:"Live"}),s.jsx(te,{title:"Controlled Drugs",value:"Tracked"})]})]}),s.jsxs("section",{className:"section doctor-main-grid",children:[s.jsxs("div",{className:"card doctor-schedule-card",children:[s.jsx("h3",{children:"Dispensing Queue"}),s.jsx("div",{className:"table-wrap",children:s.jsxs("table",{className:"doctor-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Drug"}),s.jsx("th",{children:"Qty"}),s.jsx("th",{children:"Min"}),s.jsx("th",{children:"Status"})]})}),s.jsxs("tbody",{children:[t.slice(0,10).map(i=>s.jsxs("tr",{children:[s.jsx("td",{children:i.name||"-"}),s.jsx("td",{children:i.qty??"-"}),s.jsx("td",{children:i.minStock??"-"}),s.jsx("td",{children:Number(i.qty||0)<=Number(i.minStock||0)?"Low":"OK"})]},i._id)),t.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:"4",className:"muted",children:"No inventory data."})})]})]})})]}),s.jsxs("div",{className:"card doctor-alerts-card",children:[s.jsx("h3",{children:"Interaction Alerts"}),s.jsxs("div",{className:"alert-stack",children:[s.jsx("div",{className:"action-pill",children:"Drug interaction checks active"}),s.jsx("button",{className:"btn-secondary",onClick:()=>e("/reports"),children:"Open Safety Reports"})]})]})]})]})}function nP(){var o,l,c,u;const{user:e}=Me(),t=Oe(),[n,r]=m.useState(null),[i,a]=m.useState(null);return m.useEffect(()=>{JO().then(r).catch(()=>r(null)),Vo().then(a).catch(()=>a(null))},[]),s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"Super Admin Control Center"}),s.jsx("p",{className:"muted",children:"Global governance for hospitals, workforce, payroll, security and platform health."})]}),s.jsxs("div",{className:"welcome-actions",children:[s.jsx("button",{className:"btn-primary",onClick:()=>t("/super-admin/hospitals"),children:"Hospitals"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/admin/create-admin"),children:"Role Management"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/payments/full"),children:"Global Payroll"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/super-admin/settings"),children:"System Settings"})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Global Snapshot"}),s.jsxs("div",{className:"grid info-grid",children:[s.jsx(te,{title:"Total Hospitals",value:(n==null?void 0:n.totalHospitals)??""}),s.jsx(te,{title:"Total Staff",value:(n==null?void 0:n.totalUsers)??""}),s.jsx(te,{title:"Active Patients",value:(n==null?void 0:n.totalPatients)??""}),s.jsx(te,{title:"Payroll This Month",value:(n==null?void 0:n.paymentsThisMonth)??""}),s.jsx(te,{title:"Workforce Pending",value:((l=(o=i==null?void 0:i.queues)==null?void 0:o.workforce)==null?void 0:l.totalPending)??""}),s.jsx(te,{title:"Workforce Breached",value:((u=(c=i==null?void 0:i.queues)==null?void 0:c.workforce)==null?void 0:u.breached)??""})]})]}),s.jsxs("section",{className:"section doctor-main-grid",children:[s.jsxs("div",{className:"card doctor-schedule-card",children:[s.jsx("h3",{children:"Global Admin Workspace"}),s.jsxs("div",{className:"panel-grid",children:[s.jsx("button",{className:"action-link",onClick:async()=>{await $s("REVENUE_OVERVIEW"),t("/payments/full")},children:"Revenue Graph"}),s.jsx("button",{className:"action-link",onClick:()=>t("/analytics"),children:"Workforce Distribution"}),s.jsx("button",{className:"action-link",onClick:()=>t("/reports"),children:"Compliance Alerts"}),s.jsx("button",{className:"action-link",onClick:()=>t("/admin/audit-logs"),children:"Audit Logs"}),s.jsx("button",{className:"action-link",onClick:()=>t("/security-admin"),children:"Security Incidents"}),s.jsx("button",{className:"action-link",onClick:()=>t("/system-admin"),children:"System Status Monitor"})]})]}),s.jsxs("div",{className:"card doctor-alerts-card",children:[s.jsx("h3",{children:"Right Insights Panel"}),s.jsxs("div",{className:"alert-stack",children:[s.jsxs("div",{className:"action-pill",children:["Active Sessions: ",(n==null?void 0:n.activeHospitals)??""]}),s.jsxs("div",{className:"action-pill",children:["Pending Requests: ",(n==null?void 0:n.pendingRequests)??""]}),s.jsxs("div",{className:"action-pill",children:["Invoices: ",(n==null?void 0:n.invoicesThisMonth)??""]}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/admin/notifications"),children:"Open Alerts"})]})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"System Administration"}),s.jsxs("div",{className:"action-list",children:[s.jsx("button",{className:"action-link",onClick:()=>t("/admin/realtime"),children:"Integration Hub"}),s.jsx("button",{className:"action-link",onClick:()=>t("/admin/crdt-patients"),children:"Offline Sync"}),s.jsx("button",{className:"action-link",onClick:()=>t("/admin/audit-logs"),children:"Audit Trails"}),s.jsx("button",{className:"action-link",onClick:()=>t("/reports"),children:"Regulatory Reports"})]})]})]})}const rP=async e=>(await ue.post("/api/hospitals",e)).data,z0=async()=>(await ue.get("/api/super-admin/hospitals")).data,W0=async e=>(await ue.post("/api/super-admin/register-hospital-admin",e)).data,G0=async e=>(await ue.post("/api/super-admin/register-system-admin",e)).data,Y0=async e=>(await ue.post("/api/super-admin/register-developer",e)).data;function sP(){const{user:e}=Me(),[t,n]=m.useState([]),[r,i]=m.useState(""),[a,o]=m.useState(1),l=10,[c,u]=m.useState(!1),[d,p]=m.useState(null),[h,f]=m.useState({name:"",address:"",contact:"",code:""}),[y,b]=m.useState({name:"",email:"",password:"",hospitalId:""}),[E,g]=m.useState({name:"",email:"",password:""}),[x,w]=m.useState({name:"",email:"",password:""}),_=async()=>{try{const D=await z0(),Q=Array.isArray(D)?D:D.hospitals||[];n(Q)}catch{n([])}};m.useEffect(()=>{_()},[]);const S=(e==null?void 0:e.role)==="SUPER_ADMIN",k=(e==null?void 0:e.role)==="SYSTEM_ADMIN";if(!S&&!k)return s.jsx("p",{children:" Access denied"});const I=async D=>{var Q,ae;D.preventDefault(),u(!0),p(null);try{await rP(h),p(" Hospital created"),f({name:"",address:"",contact:"",code:""}),await _()}catch(U){p(((ae=(Q=U.response)==null?void 0:Q.data)==null?void 0:ae.msg)||"Failed to create hospital")}finally{u(!1)}},C=async D=>{var Q,ae;D.preventDefault(),u(!0),p(null);try{await W0(y),p(" Hospital admin created"),b({name:"",email:"",password:"",hospitalId:""}),await _()}catch(U){p(((ae=(Q=U.response)==null?void 0:Q.data)==null?void 0:ae.msg)||"Failed to create hospital admin")}finally{u(!1)}},L=async D=>{var Q,ae;D.preventDefault(),u(!0),p(null);try{await G0(E),p(" System admin created"),g({name:"",email:"",password:""})}catch(U){p(((ae=(Q=U.response)==null?void 0:Q.data)==null?void 0:ae.msg)||"Failed to create system admin")}finally{u(!1)}},V=async D=>{var Q,ae;D.preventDefault(),u(!0),p(null);try{await Y0(x),p(" Developer created"),w({name:"",email:"",password:""})}catch(U){p(((ae=(Q=U.response)==null?void 0:Q.data)==null?void 0:ae.msg)||"Failed to create developer")}finally{u(!1)}},B=t.filter(D=>{var ae,U;const Q=r.trim().toLowerCase();return Q?((ae=D.name)==null?void 0:ae.toLowerCase().includes(Q))||((U=D.code)==null?void 0:U.toLowerCase().includes(Q)):!0}),Y=Math.max(1,Math.ceil(B.length/l)),W=Math.min(a,Y),O=B.slice((W-1)*l,W*l);return s.jsxs("div",{className:"dashboard",children:[s.jsx("div",{className:"welcome-panel",children:s.jsxs("div",{children:[s.jsx("h2",{children:"Hospitals & Admins"}),s.jsx("p",{className:"muted",children:"Create hospitals, assign hospital admins, and delegate system admins to scale onboarding."})]})}),d&&s.jsx("div",{className:"card",children:d}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Create Hospital"}),s.jsxs("form",{className:"card form",onSubmit:I,children:[s.jsx("input",{placeholder:"Hospital name",value:h.name,onChange:D=>f({...h,name:D.target.value}),required:!0}),s.jsx("input",{placeholder:"Address",value:h.address,onChange:D=>f({...h,address:D.target.value})}),s.jsx("input",{placeholder:"Contact",value:h.contact,onChange:D=>f({...h,contact:D.target.value})}),s.jsx("input",{placeholder:"Optional code",value:h.code,onChange:D=>f({...h,code:D.target.value})}),s.jsx("button",{disabled:c,children:c?"Creating...":"Create Hospital"})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Register Hospital Admin"}),s.jsxs("form",{className:"card form",onSubmit:C,children:[s.jsx("input",{placeholder:"Full name",value:y.name,onChange:D=>b({...y,name:D.target.value}),required:!0}),s.jsx("input",{placeholder:"Email address",type:"email",value:y.email,onChange:D=>b({...y,email:D.target.value}),required:!0}),s.jsx("input",{placeholder:"Temporary password",type:"password",value:y.password,onChange:D=>b({...y,password:D.target.value}),required:!0}),s.jsxs("select",{value:y.hospitalId,onChange:D=>b({...y,hospitalId:D.target.value}),required:!0,children:[s.jsx("option",{value:"",children:"Select hospital"}),t.map(D=>s.jsx("option",{value:D._id,children:D.name},D._id))]}),s.jsx("button",{disabled:c,children:c?"Creating...":"Create Hospital Admin"})]})]}),S&&s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Register System Admin"}),s.jsxs("form",{className:"card form",onSubmit:L,children:[s.jsx("input",{placeholder:"Full name",value:E.name,onChange:D=>g({...E,name:D.target.value}),required:!0}),s.jsx("input",{placeholder:"Email address",type:"email",value:E.email,onChange:D=>g({...E,email:D.target.value}),required:!0}),s.jsx("input",{placeholder:"Temporary password",type:"password",value:E.password,onChange:D=>g({...E,password:D.target.value}),required:!0}),s.jsx("button",{disabled:c,children:c?"Creating...":"Create System Admin"})]})]}),S&&s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Register Developer"}),s.jsxs("form",{className:"card form",onSubmit:V,children:[s.jsx("input",{placeholder:"Full name",value:x.name,onChange:D=>w({...x,name:D.target.value}),required:!0}),s.jsx("input",{placeholder:"Email address",type:"email",value:x.email,onChange:D=>w({...x,email:D.target.value}),required:!0}),s.jsx("input",{placeholder:"Temporary password",type:"password",value:x.password,onChange:D=>w({...x,password:D.target.value}),required:!0}),s.jsx("button",{disabled:c,children:c?"Creating...":"Create Developer"})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Hospitals"}),s.jsxs("div",{className:"card",children:[s.jsx("div",{className:"search-wrap",style:{marginBottom:12},children:s.jsx("input",{className:"search-input",placeholder:"Search hospitals",value:r,onChange:D=>{i(D.target.value),o(1)}})}),s.jsxs("table",{className:"table lite",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Name"}),s.jsx("th",{children:"Code"}),s.jsx("th",{children:"Admins"}),s.jsx("th",{children:"Status"})]})}),s.jsxs("tbody",{children:[O.map(D=>s.jsxs("tr",{children:[s.jsx("td",{children:D.name}),s.jsx("td",{children:D.code||"-"}),s.jsx("td",{children:(D.admins||[]).map(Q=>`${Q.name} (${Q.email})`).join(", ")||"None"}),s.jsx("td",{children:D.active===!1?"Inactive":"Active"})]},D._id)),O.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:"4",children:"No hospitals yet"})})]})]}),s.jsxs("div",{className:"action-list",style:{marginTop:12},children:[s.jsx("button",{className:"btn-secondary",onClick:()=>o(D=>Math.max(1,D-1)),disabled:W===1,children:"Prev"}),s.jsxs("span",{className:"muted",children:["Page ",W," of ",Y]}),s.jsx("button",{className:"btn-secondary",onClick:()=>o(D=>Math.min(Y,D+1)),disabled:W===Y,children:"Next"})]})]})]})]})}const iP=async()=>(await ue.get("/api/system-settings")).data,aP=async e=>(await ue.put("/api/system-settings",e)).data;function By(e){return new Promise((t,n)=>{const r=new FileReader;r.onload=()=>t(r.result),r.onerror=n,r.readAsDataURL(e)})}function oP(){const{user:e}=Me(),{settings:t,setSettings:n}=fi(),[r,i]=m.useState({branding:{appIcon:"",favicon:"",logo:"",loginBackground:"",homeBackground:"",sidebarIcons:{}},ai:{enabled:!1,name:"NeuroEdge",url:"",greeting:"Hi, how can I help?"}}),[a,o]=m.useState(!1),[l,c]=m.useState(null);if(!["SUPER_ADMIN","DEVELOPER"].includes(e==null?void 0:e.role))return s.jsx("p",{children:" Access denied"});m.useEffect(()=>{iP().then(f=>{const y={branding:{...r.branding,...f.branding||{}},ai:{...r.ai,...f.ai||{}}};i(y)}).catch(()=>{})},[]);const u=async()=>{var f,y;o(!0),c(null);try{const b=await aP(r);c(" Settings saved"),b.settings&&n(b.settings)}catch(b){c(((y=(f=b.response)==null?void 0:f.data)==null?void 0:y.message)||"Failed to save settings")}finally{o(!1)}},d=async(f,y)=>{if(!y)return;const b=await By(y);i(E=>({...E,branding:{...E.branding,[f]:b}}))},p=async(f,y)=>{if(!y)return;const b=await By(y);i(E=>({...E,branding:{...E.branding,sidebarIcons:{...E.branding.sidebarIcons||{},[f]:b}}}))},h=[{key:"home",label:"Home"},{key:"admin",label:"Admin"},{key:"hr",label:"HR"},{key:"payroll",label:"Payroll"},{key:"doctor",label:"Doctor"},{key:"nurse",label:"Nurse"},{key:"lab",label:"Lab"},{key:"pharmacy",label:"Pharmacy"},{key:"staff",label:"Staff"},{key:"security",label:"Security"},{key:"settings",label:"Settings"},{key:"analytics",label:"Analytics"},{key:"reports",label:"Reports"},{key:"notifications",label:"Notifications"},{key:"requests",label:"Requests"},{key:"inventory",label:"Inventory"},{key:"ai",label:"AI"},{key:"appointments",label:"Appointments"}];return s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"System Settings"}),s.jsx("p",{className:"muted",children:"Branding, payments, and AI configuration."})]}),s.jsx("div",{className:"welcome-actions",children:s.jsx("button",{className:"btn-primary",onClick:u,disabled:a,children:a?"Saving...":"Save Settings"})})]}),l&&s.jsx("div",{className:"card",children:l}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Branding Assets"}),s.jsxs("div",{className:"card form",children:[s.jsx("label",{children:"Main App Icon"}),s.jsx("input",{type:"file",accept:"image/*",onChange:f=>{var y;return d("appIcon",(y=f.target.files)==null?void 0:y[0])}}),s.jsx("label",{children:"Favicon (.ico or png)"}),s.jsx("input",{type:"file",accept:"image/*",onChange:f=>{var y;return d("favicon",(y=f.target.files)==null?void 0:y[0])}}),s.jsx("label",{children:"Logo (Navbar/Sidebar)"}),s.jsx("input",{type:"file",accept:"image/*",onChange:f=>{var y;return d("logo",(y=f.target.files)==null?void 0:y[0])}}),s.jsx("label",{children:"Login Background Image"}),s.jsx("input",{type:"file",accept:"image/*",onChange:f=>{var y;return d("loginBackground",(y=f.target.files)==null?void 0:y[0])}}),s.jsx("label",{children:"Home Background Image"}),s.jsx("input",{type:"file",accept:"image/*",onChange:f=>{var y;return d("homeBackground",(y=f.target.files)==null?void 0:y[0])}})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Sidebar Icons"}),s.jsx("div",{className:"card form",children:h.map(f=>{var y;return s.jsxs("div",{className:"icon-upload-row",children:[s.jsxs("label",{children:[f.label," Icon"]}),s.jsx("input",{type:"file",accept:"image/*",onChange:b=>{var E;return p(f.key,(E=b.target.files)==null?void 0:E[0])}}),((y=r.branding.sidebarIcons)==null?void 0:y[f.key])&&s.jsx("img",{src:r.branding.sidebarIcons[f.key],alt:`${f.label} icon`,className:"icon-preview"})]},f.key)})})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Payments"}),s.jsxs("div",{className:"card",children:[s.jsx("p",{className:"muted",children:"Use the Payment Settings page to set Stripe, Mpesa, Flutterwave, and card settings."}),s.jsx("a",{className:"action-link",href:"/admin/payment-settings",children:"Open Payment Settings"})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"NeuroEdge AI"}),s.jsxs("div",{className:"card form",children:[s.jsxs("label",{children:[s.jsx("input",{type:"checkbox",checked:r.ai.enabled,onChange:f=>i(y=>({...y,ai:{...y.ai,enabled:f.target.checked}}))}),"Enable Floating AI"]}),s.jsx("label",{children:"AI Name"}),s.jsx("input",{value:r.ai.name,onChange:f=>i(y=>({...y,ai:{...y.ai,name:f.target.value}}))}),s.jsx("label",{children:"AI URL"}),s.jsx("input",{placeholder:"https://neuroedge.ai/chat",value:r.ai.url,onChange:f=>i(y=>({...y,ai:{...y.ai,url:f.target.value}}))}),s.jsx("label",{children:"Greeting"}),s.jsx("input",{value:r.ai.greeting,onChange:f=>i(y=>({...y,ai:{...y.ai,greeting:f.target.value}}))})]})]})]})}function lP(){var p,h,f,y,b,E;const{user:e}=Me(),t=Oe(),[n,r]=m.useState(null),[i,a]=m.useState(null),[o,l]=m.useState({requiredDoctors:[],requiredNurses:[],doctorGap:[],nurseGap:[]}),c=(g,x)=>{l(w=>({...w,[g]:[...w[g]||[],Number(x||0)].slice(-12)}))},u=g=>{const x=Number(g||0);return x<=0?"good":x<=3?"warn":"risk"},d=async()=>{var g,x,w,_;try{const S=await Hp({beds:180,occupancyRate:.76,avgPatientsPerDoctor:12,avgPatientsPerNurse:5,horizonDays:7});a(S||null),c("requiredDoctors",((g=S==null?void 0:S.forecast)==null?void 0:g.requiredDoctors)||0),c("requiredNurses",((x=S==null?void 0:S.forecast)==null?void 0:x.requiredNurses)||0),c("doctorGap",((w=S==null?void 0:S.forecast)==null?void 0:w.doctorGap)||0),c("nurseGap",((_=S==null?void 0:S.forecast)==null?void 0:_.nurseGap)||0)}catch{a(null)}};return m.useEffect(()=>{YO().then(r).catch(()=>r(null)),d();const g=setInterval(d,45e3);return()=>clearInterval(g)},[]),s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"Hospital Admin Operations"}),s.jsx("p",{className:"muted",children:"Branch-level staffing, approvals, bed flow, attendance and alerts."})]}),s.jsxs("div",{className:"welcome-actions",children:[s.jsx("button",{className:"btn-primary",onClick:()=>t("/hospital-admin/staff"),children:"Staff Directory"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/hospital-admin/approvals"),children:"Leave Approvals"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/hospital-admin/register-staff"),children:"Recruitment Requests"})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Top Metrics"}),s.jsxs("div",{className:"grid info-grid",children:[s.jsx(te,{title:"Staff Count",value:(n==null?void 0:n.totalStaff)??""}),s.jsx(te,{title:"Bed Occupancy",value:(n==null?void 0:n.patientsTotal)??""}),s.jsx(te,{title:"Shift Coverage %",value:(n==null?void 0:n.openShifts)??""}),s.jsx(te,{title:"Department Alerts",value:(n==null?void 0:n.pendingRequests)??""})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"AI Staffing Risk"}),s.jsxs("div",{className:"grid info-grid",children:[s.jsx(te,{title:"Required Doctors",value:((p=i==null?void 0:i.forecast)==null?void 0:p.requiredDoctors)??"",trend:o.requiredDoctors,subtitle:"Auto-refresh 45s"}),s.jsx(te,{title:"Required Nurses",value:((h=i==null?void 0:i.forecast)==null?void 0:h.requiredNurses)??"",trend:o.requiredNurses,subtitle:"Auto-refresh 45s"}),s.jsx(te,{title:"Doctor Gap",value:((f=i==null?void 0:i.forecast)==null?void 0:f.doctorGap)??"",trend:o.doctorGap,subtitle:"Auto-refresh 45s",status:u((y=i==null?void 0:i.forecast)==null?void 0:y.doctorGap)}),s.jsx(te,{title:"Nurse Gap",value:((b=i==null?void 0:i.forecast)==null?void 0:b.nurseGap)??"",trend:o.nurseGap,subtitle:"Auto-refresh 45s",status:u((E=i==null?void 0:i.forecast)==null?void 0:E.nurseGap)})]})]}),s.jsxs("section",{className:"section doctor-main-grid",children:[s.jsxs("div",{className:"card doctor-schedule-card",children:[s.jsx("h3",{children:"Center Workspace"}),s.jsxs("div",{className:"panel-grid",children:[s.jsx("button",{className:"action-link",onClick:()=>t("/workforce/requests#shift"),children:"Shift Calendar"}),s.jsx("button",{className:"action-link",onClick:()=>t("/reports"),children:"Attendance Heatmap"}),s.jsx("button",{className:"action-link",onClick:()=>t("/hospital-admin/staff"),children:"Staff Directory"}),s.jsx("button",{className:"action-link",onClick:()=>t("/reports"),children:"Budget Overview"})]})]}),s.jsxs("div",{className:"card doctor-alerts-card",children:[s.jsx("h3",{children:"Right Panel"}),s.jsxs("div",{className:"alert-stack",children:[s.jsxs("div",{className:"action-pill",children:["Pending Approvals: ",(n==null?void 0:n.pendingRequests)??""]}),s.jsxs("div",{className:"action-pill",children:["Critical Alerts: ",(n==null?void 0:n.appointmentsToday)??""]}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/admin/notifications"),children:"Announcements"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/security-admin"),children:"Incident Reports"})]})]})]})]})}function cP(){const{user:e}=Me(),[t,n]=m.useState({name:"",email:"",password:"",role:"doctor"}),[r,i]=m.useState(!1),[a,o]=m.useState(null);if((e==null?void 0:e.role)!=="HOSPITAL_ADMIN")return s.jsx("p",{children:" Access denied"});const l=async c=>{var u,d,p;c.preventDefault(),i(!0),o(null);try{const h=await ue.post("/api/hospital-admin/register-staff",t);o(((u=h.data)==null?void 0:u.msg)||" Staff registered"),n({name:"",email:"",password:"",role:"doctor"})}catch(h){o(((p=(d=h.response)==null?void 0:d.data)==null?void 0:p.msg)||"Failed to register staff")}finally{i(!1)}};return s.jsxs("div",{className:"dashboard",children:[s.jsx("div",{className:"welcome-panel",children:s.jsxs("div",{children:[s.jsx("h2",{children:"Register Hospital Staff"}),s.jsx("p",{className:"muted",children:"Add staff members to your hospital workforce."})]})}),a&&s.jsx("div",{className:"card",children:a}),s.jsxs("form",{className:"card form",onSubmit:l,children:[s.jsx("input",{placeholder:"Full name",value:t.name,required:!0,onChange:c=>n({...t,name:c.target.value})}),s.jsx("input",{placeholder:"Email address",type:"email",value:t.email,required:!0,onChange:c=>n({...t,email:c.target.value})}),s.jsx("input",{placeholder:"Temporary password",type:"password",value:t.password,required:!0,onChange:c=>n({...t,password:c.target.value})}),s.jsxs("select",{value:t.role,onChange:c=>n({...t,role:c.target.value}),children:[s.jsx("option",{value:"doctor",children:"Doctor"}),s.jsx("option",{value:"nurse",children:"Nurse"}),s.jsx("option",{value:"lab_tech",children:"Lab Tech"}),s.jsx("option",{value:"pharmacist",children:"Pharmacist"}),s.jsx("option",{value:"radiologist",children:"Radiologist"}),s.jsx("option",{value:"therapist",children:"Therapist"}),s.jsx("option",{value:"receptionist",children:"Receptionist"}),s.jsx("option",{value:"security_officer",children:"Security Officer"}),s.jsx("option",{value:"hr_manager",children:"HR Manager"}),s.jsx("option",{value:"payroll_officer",children:"Payroll Officer"})]}),s.jsx("button",{disabled:r,children:r?"Creating...":"Register Staff"})]})]})}const zp=(e,t={})=>{const n=new URLSearchParams;e&&n.set("status",e),t.limit&&n.set("limit",String(t.limit)),t.cursor!==void 0&&t.cursor!==null&&n.set("cursor",t.cursor),t.cursorMode&&n.set("cursorMode","1");const r=n.toString();return r?`?${r}`:""},uP=(e,t)=>ue.get(`/api/workforce/leave/my${zp(e,t)}`),dP=e=>ue.post("/api/workforce/leave",e),hP=e=>ue.post(`/api/workforce/leave/${e}/approve`),fP=(e,t)=>ue.post(`/api/workforce/leave/${e}/reject`,{reason:t}),pP=(e,t)=>ue.get(`/api/workforce/overtime/my${zp(e,t)}`),mP=e=>ue.post("/api/workforce/overtime",e),gP=e=>ue.post(`/api/workforce/overtime/${e}/approve`),yP=(e,t)=>ue.post(`/api/workforce/overtime/${e}/reject`,{reason:t}),Ti=(e,t,n={})=>{const r=new URLSearchParams;r.set("kind",String(e||"").toUpperCase()),r.set("status",t),n.limit&&r.set("limit",String(n.limit)),n.cursor!==void 0&&n.cursor!==null&&r.set("cursor",n.cursor),n.cursorMode&&r.set("cursorMode","1");const i=r.toString();return ue.get(`/api/workforce/pending${i?`?${i}`:""}`)},vP=(e,t)=>ue.get(`/api/workforce/shifts/my${zp(e,t)}`),xP=e=>ue.post("/api/workforce/shifts",e),jP=e=>ue.post(`/api/workforce/shifts/${e}/approve`),bP=(e,t)=>ue.post(`/api/workforce/shifts/${e}/reject`,{reason:t}),wP=()=>ue.get("/api/workforce/sla/policies"),SP=(e,t)=>ue.put(`/api/workforce/sla/policies/${e}`,t),EP=()=>ue.get("/api/workforce/queue-insights"),NP=()=>ue.get("/api/workforce/automation/policies"),_P=(e={})=>{const t=new URLSearchParams;e.includeInactive&&t.set("includeInactive","1");const n=t.toString();return ue.get(`/api/workforce/automation/presets${n?`?${n}`:""}`)},AP=e=>ue.post("/api/workforce/automation/presets/apply-all",{presetKey:e}),CP=e=>ue.post("/api/workforce/automation/presets",e),kP=e=>ue.delete(`/api/workforce/automation/presets/${encodeURIComponent(String(e||"").toUpperCase())}`),IP=e=>ue.post(`/api/workforce/automation/presets/${encodeURIComponent(String(e||"").toUpperCase())}/reactivate`),RP=(e={})=>{const t=new URLSearchParams;e.limit&&t.set("limit",String(e.limit));const n=t.toString();return ue.get(`/api/workforce/automation/presets/history${n?`?${n}`:""}`)},TP=(e,t)=>ue.put(`/api/workforce/automation/policies/${e}`,t),OP=e=>ue.post("/api/workforce/automation/simulate",e),PP=(e={})=>{const t=new URLSearchParams;e.requestType&&t.set("requestType",String(e.requestType).toUpperCase()),e.limit&&t.set("limit",String(e.limit));const n=t.toString();return ue.get(`/api/workforce/automation/preview${n?`?${n}`:""}`)},LP=()=>ue.post("/api/workforce/automation/sweep"),DP=new Set(["HOSPITAL_ADMIN","SUPER_ADMIN","SYSTEM_ADMIN","DEVELOPER","HR_MANAGER","PAYROLL_OFFICER"]),MP=new Set(["SUPER_ADMIN","SYSTEM_ADMIN","DEVELOPER"]),_d="approvals_triage_prefs",Ga="approvals_query_cache_v1",UP=15*60*1e3;function Er(e){return e!=null&&e.slaDueAt?e.status==="PENDING"&&new Date(e.slaDueAt).getTime()<Date.now():!1}function BP(){var Rs,Ts,Os,Ps,Ls,zr,Pn,Wr,gn,Ds,Kn,jr,Ms,Us,br;const{user:e}=Me(),t=Cn(),[n,r]=m.useState([]),[i,a]=m.useState([]),[o,l]=m.useState([]),[c,u]=m.useState(null),[d,p]=m.useState(null),[h,f]=m.useState(null),[y,b]=m.useState(!1),[E,g]=m.useState(!1),[x,w]=m.useState(!1),[_,S]=m.useState(!1),[k,I]=m.useState(""),[C,L]=m.useState(null),[V,B]=m.useState([]),[Y,W]=m.useState({}),[O,D]=m.useState([]),[Q,ae]=m.useState([]),[U,Z]=m.useState(!1),[le,ye]=m.useState([]),[je,Ae]=m.useState({key:"",name:"",description:"",config:{active:!0,autoApprove:!1,requireSecondApprover:!0,fallbackRole:"AUTO",escalationAfterMinutes:120,conditions:{priorityAgeMultiplier:1,priorityWeightCap:5}}}),[H,F]=m.useState({}),[se,xe]=m.useState(!1),[Ce,Pe]=m.useState(!1),[Ge,X]=m.useState(!1),[he,ge]=m.useState(null),[me,Ne]=m.useState(null),[dt,pt]=m.useState(!1),[Te,we]=m.useState(null),[ce,ve]=m.useState("ALL"),[fe,_e]=m.useState("ALL"),[be,Ve]=m.useState(0),[ke,tn]=m.useState(!0),[fn,In]=m.useState(!1),[Pt,pn]=m.useState(""),[Rn,mr]=m.useState(""),gr=m.useRef(null),[yr,vr]=m.useState(!1),[Fr,mn]=m.useState("Live  now"),xr=m.useRef(!1),Gt=e==null?void 0:e.role;if(!DP.has(Gt))return s.jsx("p",{children:"Access denied"});const nn=`${Gt||"UNKNOWN"}:${(e==null?void 0:e._id)||(e==null?void 0:e.id)||(e==null?void 0:e.email)||"anon"}`,gi=MP.has(Gt),Tn=A=>Array.isArray(A)?{items:A,nextCursor:null,hasMore:!1}:{items:Array.isArray(A==null?void 0:A.items)?A.items:[],nextCursor:(A==null?void 0:A.nextCursor)||null,hasMore:!!(A!=null&&A.hasMore)},Oa=(A,M)=>{var j;const v=(j=Q.find(N=>String((N==null?void 0:N.key)||"").toUpperCase()===String(M||"").toUpperCase()))==null?void 0:j.config;v&&F(N=>{var T,$;const R=N[A]||{},P=R.conditions||{};return{...N,[A]:{...R,active:!0,autoApprove:v.autoApprove,requireSecondApprover:v.requireSecondApprover,fallbackRole:v.fallbackRole,escalationAfterMinutes:v.escalationAfterMinutes,conditions:{...P,priorityAgeMultiplier:Number(((T=v.conditions)==null?void 0:T.priorityAgeMultiplier)??1),priorityWeightCap:Number((($=v.conditions)==null?void 0:$.priorityWeightCap)??5)}}}})},Nt=async({append:A=!1}={})=>{var M,v,j,N,R,P;A?S(!0):xe(!0),we(null);try{const T=fe==="ALL"?["LEAVE","OVERTIME","SHIFT"]:[fe],$=T.includes("LEAVE")&&(!A||y&&!!c),q=T.includes("OVERTIME")&&(!A||E&&!!d),G=T.includes("SHIFT")&&(!A||x&&!!h),[ne,re,pe,Se,Ue,$e,rt,Xe]=await Promise.all([$?Ti("LEAVE","PENDING",{cursorMode:!0,limit:25,cursor:A?c:void 0}):Promise.resolve(null),q?Ti("OVERTIME","PENDING",{cursorMode:!0,limit:25,cursor:A?d:void 0}):Promise.resolve(null),G?Ti("SHIFT","PENDING",{cursorMode:!0,limit:25,cursor:A?h:void 0}):Promise.resolve(null),A?Promise.resolve({data:C}):EP(),A?Promise.resolve({data:{items:V}}):wP(),A?Promise.resolve({data:{items:O}}):NP(),A?Promise.resolve({data:{items:Q}}):_P({includeInactive:U}),A?Promise.resolve({data:{items:le}}):RP({limit:50})]),xt=$?Tn(ne.data):{items:[],nextCursor:null,hasMore:!1},yn=q?Tn(re.data):{items:[],nextCursor:null,hasMore:!1},Jn=G?Tn(pe.data):{items:[],nextCursor:null,hasMore:!1};A?($?(r(rn=>[...rn,...xt.items]),u(xt.nextCursor),b(xt.hasMore)):b(!1),q?(a(rn=>[...rn,...yn.items]),p(yn.nextCursor),g(yn.hasMore)):g(!1),G?(l(rn=>[...rn,...Jn.items]),f(Jn.nextCursor),w(Jn.hasMore)):w(!1)):(r(xt.items),a(yn.items),l(Jn.items),u(xt.nextCursor),p(yn.nextCursor),f(Jn.nextCursor),b(xt.hasMore),g(yn.hasMore),w(Jn.hasMore)),L(Se.data||null);const cl=Array.isArray((M=Ue.data)==null?void 0:M.items)?Ue.data.items:[];A||(mn("Live  now"),B(cl),W(cl.reduce((rn,lt)=>(rn[lt.requestType]={targetMinutes:lt.targetMinutes,escalationMinutes:lt.escalationMinutes,active:lt.active!==!1},rn),{})));const Ai=Array.isArray((v=$e.data)==null?void 0:v.items)?$e.data.items:[],Wp=Array.isArray((j=rt.data)==null?void 0:j.items)?rt.data.items:[],Eu=Array.isArray((N=Xe.data)==null?void 0:N.items)?Xe.data.items:[];A||(D(Ai),ae(Wp),ye(Eu),F(Ai.reduce((rn,lt)=>{var Gp,Yp,Kp,Jp,Qp,Zp;return rn[lt.requestType]={active:lt.active!==!1,autoApprove:lt.autoApprove===!0,requireSecondApprover:lt.requireSecondApprover===!0,fallbackRole:lt.fallbackRole||"HOSPITAL_ADMIN",escalationAfterMinutes:Number(lt.escalationAfterMinutes||120),conditions:{maxLeaveDays:Number(((Gp=lt.conditions)==null?void 0:Gp.maxLeaveDays)||0),maxOvertimeHours:Number(((Yp=lt.conditions)==null?void 0:Yp.maxOvertimeHours)||0),priorityAgeMultiplier:Number(((Kp=lt.conditions)==null?void 0:Kp.priorityAgeMultiplier)??1),priorityWeightCap:Number(((Jp=lt.conditions)==null?void 0:Jp.priorityWeightCap)??5),allowedShiftTypes:Array.isArray((Qp=lt.conditions)==null?void 0:Qp.allowedShiftTypes)?lt.conditions.allowedShiftTypes.join(","):"",fallbackCandidates:Array.isArray((Zp=lt.conditions)==null?void 0:Zp.fallbackCandidates)?lt.conditions.fallbackCandidates.join(","):""}},rn},{})))}catch(T){we(((P=(R=T==null?void 0:T.response)==null?void 0:R.data)==null?void 0:P.message)||"Failed to load approvals")}finally{A?S(!1):xe(!1)}};m.useEffect(()=>{try{const A=localStorage.getItem(Ga);if(!A){mn("Live  now"),vr(!0);return}const M=JSON.parse(A),v=M==null?void 0:M[nn];if(!v||typeof v!="object"){mn("Live  now"),vr(!0);return}const j=Date.now()-new Date(v.updatedAt||0).getTime();if(!Number.isFinite(j)||j<0||j>UP){mn("Live  now"),vr(!0);return}const N=Math.max(0,Math.floor(j/6e4));v.queueKindFilter&&_e(v.queueKindFilter),Array.isArray(v.leave)&&r(v.leave),Array.isArray(v.overtime)&&a(v.overtime),Array.isArray(v.shifts)&&l(v.shifts),(typeof v.leaveCursor=="string"||v.leaveCursor===null)&&u(v.leaveCursor),(typeof v.overtimeCursor=="string"||v.overtimeCursor===null)&&p(v.overtimeCursor),(typeof v.shiftCursor=="string"||v.shiftCursor===null)&&f(v.shiftCursor),typeof v.hasMoreLeave=="boolean"&&b(v.hasMoreLeave),typeof v.hasMoreOvertime=="boolean"&&g(v.hasMoreOvertime),typeof v.hasMoreShift=="boolean"&&w(v.hasMoreShift),v.queue&&typeof v.queue=="object"&&L(v.queue),mn(`Cached  ${N}m ago`),xr.current=!0}catch{}finally{vr(!0)}},[nn]),m.useEffect(()=>{if(yr){if(xr.current){xr.current=!1;return}Nt({append:!1})}},[yr,fe,U]),m.useEffect(()=>{const A=new URLSearchParams(t.search),M=String(A.get("view")||"").toLowerCase();A.has("view")&&ve(M==="breached"?"BREACHED":"ALL");const j=window.location.hash;if(!j)return;const N=document.getElementById(j.replace("#",""));N&&setTimeout(()=>N.scrollIntoView({behavior:"smooth"}),120)},[t.search]),m.useEffect(()=>{try{const A=localStorage.getItem(_d);if(!A)return;const M=JSON.parse(A),v=M==null?void 0:M[nn];if(!v||typeof v!="object")return;(v.viewMode==="ALL"||v.viewMode==="BREACHED")&&ve(v.viewMode),typeof v.autoAdvance=="boolean"&&tn(v.autoAdvance),typeof v.filter=="string"&&mr(v.filter)}catch{}},[nn]),m.useEffect(()=>{try{const A=localStorage.getItem(_d),M=A?JSON.parse(A):{};M[nn]={viewMode:ce,autoAdvance:ke,filter:Rn,updatedAt:new Date().toISOString()},localStorage.setItem(_d,JSON.stringify(M))}catch{}},[nn,ce,ke,Rn]),m.useEffect(()=>{if(yr)try{const A=localStorage.getItem(Ga),M=A?JSON.parse(A):{};M[nn]={queueKindFilter:fe,leave:n,overtime:i,shifts:o,leaveCursor:c,overtimeCursor:d,shiftCursor:h,hasMoreLeave:y,hasMoreOvertime:E,hasMoreShift:x,queue:C,updatedAt:new Date().toISOString()},localStorage.setItem(Ga,JSON.stringify(M))}catch{}},[yr,nn,fe,n,i,o,c,d,h,y,E,x,C]);const On=m.useMemo(()=>[...n.map(A=>({...A,kind:"LEAVE"})),...i.map(A=>({...A,kind:"OVERTIME"})),...o.map(A=>({...A,kind:"SHIFT"}))].filter(A=>ce==="BREACHED"?Er(A):!0).filter(A=>fe==="ALL"?!0:A.kind===fe).filter(A=>{var T,$;const M=Rn.trim().toLowerCase();if(!M)return!0;const v=String(((T=A.requester)==null?void 0:T.name)||"").toLowerCase(),j=String((($=A.requester)==null?void 0:$.role)||"").toLowerCase(),N=String(A.kind||"").toLowerCase(),R=String(A.type||A.shiftType||"").toLowerCase(),P=String(A.reason||"").toLowerCase();return v.includes(M)||j.includes(M)||N.includes(M)||R.includes(M)||P.includes(M)}).sort((A,M)=>{const v=Er(A)?1:0,j=Er(M)?1:0;if(v!==j)return j-v;const N=A.slaDueAt?new Date(A.slaDueAt).getTime():Number.MAX_SAFE_INTEGER,R=M.slaDueAt?new Date(M.slaDueAt).getTime():Number.MAX_SAFE_INTEGER;return N!==R?N-R:new Date(M.createdAt).getTime()-new Date(A.createdAt).getTime()}),[n,i,o,ce,fe,Rn]),wt=m.useMemo(()=>On.filter(A=>Er(A)),[On]),ks=m.useMemo(()=>{const A={LEAVE:0,OVERTIME:0,SHIFT:0};for(const M of On)Object.prototype.hasOwnProperty.call(A,M.kind)&&(A[M.kind]+=1);return A},[On]),Is=async A=>{var M,v;try{if(I(A),A==="LEAVE"){if(!y||!c)return;const j=await Ti("LEAVE","PENDING",{cursorMode:!0,limit:25,cursor:c}),N=Tn(j.data);r(R=>[...R,...N.items]),u(N.nextCursor),b(N.hasMore)}if(A==="OVERTIME"){if(!E||!d)return;const j=await Ti("OVERTIME","PENDING",{cursorMode:!0,limit:25,cursor:d}),N=Tn(j.data);a(R=>[...R,...N.items]),p(N.nextCursor),g(N.hasMore)}if(A==="SHIFT"){if(!x||!h)return;const j=await Ti("SHIFT","PENDING",{cursorMode:!0,limit:25,cursor:h}),N=Tn(j.data);l(R=>[...R,...N.items]),f(N.nextCursor),w(N.hasMore)}}catch(j){we(((v=(M=j==null?void 0:j.response)==null?void 0:M.data)==null?void 0:v.message)||`Failed to load more ${A} requests`)}finally{I("")}},Pa=async()=>{try{const A=localStorage.getItem(Ga),M=A?JSON.parse(A):{};delete M[nn],localStorage.setItem(Ga,JSON.stringify(M))}catch{}_e("ALL"),ve("ALL"),mr(""),r([]),a([]),l([]),u(null),p(null),f(null),b(!1),g(!1),w(!1),await Nt({append:!1}),mn("Live  now"),we("View reset and reloaded from server")},Hr=()=>{if(!wt.length)return;const A=be%wt.length,M=wt[A],v=`${M.kind}-${M._id}`;pn(v);const j=`breach-row-${v}`,N=document.getElementById(j);N&&N.scrollIntoView({behavior:"smooth",block:"center"}),Ve(R=>(R+1)%wt.length)};m.useEffect(()=>{fn&&(In(!1),setTimeout(()=>{Hr()},120))},[fn,On]),m.useEffect(()=>{if(!Pt)return;wt.some(M=>`${M.kind}-${M._id}`===Pt)||pn("")},[Pt,wt]);const z=()=>{if(!wt.length)return null;if(Pt){const A=wt.find(M=>`${M.kind}-${M._id}`===Pt);if(A)return A}return wt[0]},vt=async(A,M,v=!1)=>{var j,N;try{A==="LEAVE"&&await hP(M),A==="OVERTIME"&&await gP(M),A==="SHIFT"&&await jP(M),await Nt({append:!1}),ke&&v&&In(!0),we(`${A} request approved`)}catch(R){we(((N=(j=R==null?void 0:R.response)==null?void 0:j.data)==null?void 0:N.message)||`Failed to approve ${A} request`)}},qr=async(A,M,v=!1)=>{var N,R;const j=prompt("Rejection reason")||"Rejected";try{A==="LEAVE"&&await fP(M,j),A==="OVERTIME"&&await yP(M,j),A==="SHIFT"&&await bP(M,j),await Nt({append:!1}),ke&&v&&In(!0),we(`${A} request rejected`)}catch(P){we(((R=(N=P==null?void 0:P.response)==null?void 0:N.data)==null?void 0:R.message)||`Failed to reject ${A} request`)}},yi=async A=>{var v,j;const M=Y[A];if(M){Pe(!0);try{await SP(A,{targetMinutes:Number(M.targetMinutes),escalationMinutes:Number(M.escalationMinutes),active:!!M.active}),await Nt({append:!1}),we(`${A} SLA policy updated`)}catch(N){we(((j=(v=N==null?void 0:N.response)==null?void 0:v.data)==null?void 0:j.message)||`Failed to update ${A} policy`)}finally{Pe(!1)}}},vi=async A=>{var v,j,N,R,P,T,$,q;const M=H[A];if(M){X(!0);try{await TP(A,{active:!!M.active,autoApprove:!!M.autoApprove,requireSecondApprover:!!M.requireSecondApprover,fallbackRole:String(M.fallbackRole||"").toUpperCase(),escalationAfterMinutes:Number(M.escalationAfterMinutes||120),conditions:{maxLeaveDays:Number(((v=M.conditions)==null?void 0:v.maxLeaveDays)||0),maxOvertimeHours:Number(((j=M.conditions)==null?void 0:j.maxOvertimeHours)||0),priorityAgeMultiplier:Number(((N=M.conditions)==null?void 0:N.priorityAgeMultiplier)??1),priorityWeightCap:Number(((R=M.conditions)==null?void 0:R.priorityWeightCap)??5),allowedShiftTypes:String(((P=M.conditions)==null?void 0:P.allowedShiftTypes)||"").split(",").map(G=>G.trim().toUpperCase()).filter(Boolean),fallbackCandidates:String(((T=M.conditions)==null?void 0:T.fallbackCandidates)||"").split(",").map(G=>G.trim().toUpperCase()).filter(Boolean)}}),await Nt(),we(`${A} automation policy updated`)}catch(G){we(((q=($=G==null?void 0:G.response)==null?void 0:$.data)==null?void 0:q.message)||`Failed to update ${A} automation`)}finally{X(!1)}}},xi=async()=>{var A,M,v,j;try{const N=await LP(),R=((M=(A=N==null?void 0:N.data)==null?void 0:A.escalated)==null?void 0:M.total)??0;we(`Automation sweep completed. Escalated: ${R}`),await Nt()}catch(N){we(((j=(v=N==null?void 0:N.response)==null?void 0:v.data)==null?void 0:j.message)||"Automation sweep failed")}},ji=async A=>{var M,v;if(A){X(!0);try{await AP(A),await Nt({append:!1}),we(`Applied ${A} preset to all request types`)}catch(j){we(((v=(M=j==null?void 0:j.response)==null?void 0:M.data)==null?void 0:v.message)||"Failed to apply preset to all")}finally{X(!1)}}},bi=async()=>{var A,M;X(!0);try{await CP(je),await Nt({append:!1}),we(`Custom preset ${je.key||je.name} saved`)}catch(v){we(((M=(A=v==null?void 0:v.response)==null?void 0:A.data)==null?void 0:M.message)||"Failed to save custom preset")}finally{X(!1)}},wi=A=>{var v,j;if(!A)return;const M=A.config||{};Ae({key:String(A.key||"").toUpperCase(),name:A.name||"",description:A.description||"",config:{active:M.active!==!1,autoApprove:M.autoApprove===!0,requireSecondApprover:M.requireSecondApprover!==!1,fallbackRole:M.fallbackRole||"AUTO",escalationAfterMinutes:Number(M.escalationAfterMinutes||120),conditions:{priorityAgeMultiplier:Number(((v=M.conditions)==null?void 0:v.priorityAgeMultiplier)??1),priorityWeightCap:Number(((j=M.conditions)==null?void 0:j.priorityWeightCap)??5)}}})},Si=async A=>{var M,v;if(A){X(!0);try{await kP(A),await Nt({append:!1}),we(`Custom preset ${A} deactivated`)}catch(j){we(((v=(M=j==null?void 0:j.response)==null?void 0:M.data)==null?void 0:v.message)||"Failed to deactivate custom preset")}finally{X(!1)}}},Ei=async A=>{var M,v;if(A){X(!0);try{await IP(A),await Nt({append:!1}),we(`Custom preset ${A} reactivated`)}catch(j){we(((v=(M=j==null?void 0:j.response)==null?void 0:M.data)==null?void 0:v.message)||"Failed to reactivate custom preset")}finally{X(!1)}}},Ni=async()=>{var A,M;pt(!0);try{const v=await PP({limit:100});Ne((v==null?void 0:v.data)||null),we("Escalation preview generated")}catch(v){we(((M=(A=v==null?void 0:v.response)==null?void 0:A.data)==null?void 0:M.message)||"Escalation preview failed")}finally{pt(!1)}},_i=async A=>{var j,N,R,P,T;const M=H[A];if(!M)return;const v=A==="LEAVE"?{startDate:new Date().toISOString(),endDate:new Date().toISOString()}:A==="OVERTIME"?{hours:Number(((j=M.conditions)==null?void 0:j.maxOvertimeHours)||1)}:{shiftType:((R=String(((N=M.conditions)==null?void 0:N.allowedShiftTypes)||"DAY").split(",")[0])==null?void 0:R.trim())||"DAY"};try{const $=await OP({requestType:A,sample:v});ge({requestType:A,...$.data}),we(`${A} simulation ran`)}catch($){we(((T=(P=$==null?void 0:$.response)==null?void 0:P.data)==null?void 0:T.message)||"Simulation failed")}};return m.useEffect(()=>{const A=v=>{if(!v)return!1;const j=String(v.tagName||"").toLowerCase();return j==="input"||j==="textarea"||j==="select"||v.isContentEditable},M=async v=>{var R;if(A(v.target))return;const j=String(v.key||"").toLowerCase();if(!["j","a","r","u","f"].includes(j))return;if(v.preventDefault(),j==="f"){(R=gr.current)==null||R.focus();return}if(j==="u"){ve(P=>P==="BREACHED"?"ALL":"BREACHED");return}if(j==="j"){Hr();return}const N=z();if(N){if(j==="a"){await vt(N.kind,N._id,!0);return}j==="r"&&await qr(N.kind,N._id,!0)}};return window.addEventListener("keydown",M),()=>window.removeEventListener("keydown",M)},[wt,Pt,ke,be]),s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"Workforce Approvals"}),s.jsx("p",{className:"muted",children:"Leave, overtime and shift approvals with SLA monitoring."})]}),s.jsxs("div",{className:"welcome-actions",children:[s.jsx("span",{className:"triage-shortcuts",children:"Shortcuts: J next  A approve  R reject  U breached only  F filter"}),s.jsx("input",{ref:gr,className:"triage-filter-input",placeholder:"Filter staff, role, type, reason...",value:Rn,onChange:A=>mr(A.target.value)}),s.jsxs("button",{className:`btn-secondary ${ke?"active":""}`,onClick:()=>tn(A=>!A),title:"When enabled, approving/rejecting a breached item moves focus to the next breached item.",children:["Auto-Advance: ",ke?"On":"Off"]}),s.jsxs("button",{className:"btn-secondary",onClick:Hr,disabled:!wt.length,title:wt.length?"Jump to next overdue request":"No breached rows",children:["Jump to Next Breached ",wt.length?`(${wt.length})`:""]}),s.jsx("button",{className:"btn-secondary",onClick:()=>ve(A=>A==="BREACHED"?"ALL":"BREACHED"),children:ce==="BREACHED"?"Show All":"Show Breached Only"}),s.jsxs("select",{value:fe,onChange:A=>_e(A.target.value),title:"Filter pending table by request type",children:[s.jsx("option",{value:"ALL",children:"All Queues"}),s.jsx("option",{value:"LEAVE",children:"Leave"}),s.jsx("option",{value:"OVERTIME",children:"Overtime"}),s.jsx("option",{value:"SHIFT",children:"Shift"})]}),s.jsx("button",{className:"btn-secondary",onClick:()=>Nt({append:!1}),disabled:se,children:"Refresh"}),s.jsx("button",{className:"btn-secondary",onClick:Pa,disabled:se,children:"Reset View"}),s.jsx("span",{className:"muted",children:Fr})]})]}),Te&&s.jsx("div",{className:"card",children:Te}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Queue Insights"}),s.jsxs("div",{className:"grid info-grid",children:[s.jsxs("div",{className:"card stat",children:[s.jsx("div",{className:"card-title",children:"Pending"}),s.jsx("div",{className:"card-value",children:((Rs=C==null?void 0:C.totals)==null?void 0:Rs.pending)??""})]}),s.jsxs("div",{className:"card stat",children:[s.jsx("div",{className:"card-title",children:"Breached"}),s.jsx("div",{className:"card-value",children:((Ts=C==null?void 0:C.totals)==null?void 0:Ts.breached)??""})]}),s.jsxs("div",{className:"card stat",children:[s.jsx("div",{className:"card-title",children:"L2 Pending"}),s.jsx("div",{className:"card-value",children:((Os=C==null?void 0:C.totals)==null?void 0:Os.l2Pending)??""})]}),s.jsxs("div",{className:"card stat",children:[s.jsx("div",{className:"card-title",children:"Approved"}),s.jsx("div",{className:"card-value",children:((Ps=C==null?void 0:C.totals)==null?void 0:Ps.approved)??""})]}),s.jsxs("div",{className:"card stat",children:[s.jsx("div",{className:"card-title",children:"Rejected"}),s.jsx("div",{className:"card-value",children:((Ls=C==null?void 0:C.totals)==null?void 0:Ls.rejected)??""})]})]})]}),s.jsxs("section",{className:"section",id:"sla",children:[s.jsx("h3",{children:"SLA Policies"}),s.jsx("div",{className:"card",children:s.jsxs("table",{className:"table lite",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Request Type"}),s.jsx("th",{children:"Target (mins)"}),s.jsx("th",{children:"Escalation (mins)"}),s.jsx("th",{children:"Active"}),s.jsx("th",{children:"Action"})]})}),s.jsxs("tbody",{children:[V.map(A=>{const M=Y[A.requestType]||{};return s.jsxs("tr",{children:[s.jsx("td",{children:A.requestType}),s.jsx("td",{children:s.jsx("input",{type:"number",min:"1",value:M.targetMinutes??"",onChange:v=>W(j=>({...j,[A.requestType]:{...j[A.requestType],targetMinutes:v.target.value}}))})}),s.jsx("td",{children:s.jsx("input",{type:"number",min:"1",value:M.escalationMinutes??"",onChange:v=>W(j=>({...j,[A.requestType]:{...j[A.requestType],escalationMinutes:v.target.value}}))})}),s.jsx("td",{children:s.jsx("input",{type:"checkbox",checked:!!M.active,onChange:v=>W(j=>({...j,[A.requestType]:{...j[A.requestType],active:v.target.checked}}))})}),s.jsx("td",{children:s.jsx("button",{className:"btn-secondary",disabled:Ce,onClick:()=>yi(A.requestType),children:"Save"})})]},A.requestType)}),V.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:"5",children:"No SLA policies loaded"})})]})]})})]}),s.jsxs("section",{className:"section",id:"automation",children:[s.jsx("h3",{children:"Automation Policies"}),s.jsxs("div",{className:"card",children:[s.jsxs("div",{className:"welcome-actions",style:{marginBottom:10},children:[s.jsx("button",{className:"btn-secondary",onClick:xi,children:"Run Escalation Sweep"}),s.jsx("button",{className:"btn-secondary",onClick:Ni,disabled:dt,children:dt?"Previewing...":"Preview Escalation Plan"}),Q.map(A=>s.jsxs("button",{className:"btn-secondary",disabled:Ge,title:`${A.description||""}${A.version?` | v${A.version}`:""}`,onClick:()=>ji(A.key),children:["Apply ",A.name||A.key," to all"]},`preset-all-${A.key}`)),s.jsx("button",{className:"btn-secondary",onClick:()=>Z(A=>!A),children:U?"Hide Inactive Presets":"Show Inactive Presets"})]}),s.jsxs("div",{className:"card",style:{marginBottom:10},children:[s.jsx("strong",{children:"Preset Catalog"}),s.jsx("div",{className:"table-wrap",style:{marginTop:10},children:s.jsxs("table",{className:"table lite",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Key"}),s.jsx("th",{children:"Name"}),s.jsx("th",{children:"Source"}),s.jsx("th",{children:"Version"}),s.jsx("th",{children:"Actions"})]})}),s.jsxs("tbody",{children:[Q.map(A=>{const M=A.source==="CUSTOM";return s.jsxs("tr",{children:[s.jsx("td",{children:A.key}),s.jsx("td",{children:A.name||"-"}),s.jsx("td",{children:A.source||"SYSTEM"}),s.jsx("td",{children:A.version||1}),s.jsxs("td",{children:[s.jsx("button",{className:"btn-secondary",onClick:()=>wi(A),children:"Clone to Form"}),M&&A.active!==!1&&gi&&s.jsx("button",{className:"btn-danger",disabled:Ge,onClick:()=>Si(A.key),children:"Deactivate"}),M&&A.active===!1&&gi&&s.jsx("button",{className:"btn-secondary",disabled:Ge,onClick:()=>Ei(A.key),children:"Reactivate"})]})]},`preset-row-${A.key}`)}),Q.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:"5",children:"No presets available"})})]})]})})]}),s.jsxs("div",{className:"card",style:{marginBottom:10},children:[s.jsx("strong",{children:"Create/Update Custom Preset"}),s.jsxs("div",{className:"grid info-grid",style:{marginTop:10},children:[s.jsxs("label",{children:["Key",s.jsx("input",{type:"text",placeholder:"e.g. NIGHT_SHIFT_RUSH",value:je.key,onChange:A=>Ae(M=>({...M,key:A.target.value.toUpperCase().replace(/[^A-Z0-9_]/g,"")}))})]}),s.jsxs("label",{children:["Name",s.jsx("input",{type:"text",placeholder:"Human readable name",value:je.name,onChange:A=>Ae(M=>({...M,name:A.target.value}))})]}),s.jsxs("label",{children:["Description",s.jsx("input",{type:"text",placeholder:"When to use this preset",value:je.description,onChange:A=>Ae(M=>({...M,description:A.target.value}))})]}),s.jsxs("label",{children:["Escalate After (min)",s.jsx("input",{type:"number",min:"5",max:"10080",value:je.config.escalationAfterMinutes,onChange:A=>Ae(M=>({...M,config:{...M.config,escalationAfterMinutes:A.target.value}}))})]}),s.jsxs("label",{children:["Fallback Role",s.jsxs("select",{value:je.config.fallbackRole,onChange:A=>Ae(M=>({...M,config:{...M.config,fallbackRole:A.target.value}})),children:[s.jsx("option",{value:"AUTO",children:"AUTO"}),s.jsx("option",{value:"HOSPITAL_ADMIN",children:"HOSPITAL_ADMIN"}),s.jsx("option",{value:"HR_MANAGER",children:"HR_MANAGER"}),s.jsx("option",{value:"PAYROLL_OFFICER",children:"PAYROLL_OFFICER"}),s.jsx("option",{value:"SYSTEM_ADMIN",children:"SYSTEM_ADMIN"}),s.jsx("option",{value:"SUPER_ADMIN",children:"SUPER_ADMIN"})]})]}),s.jsxs("label",{children:["Priority Age Multiplier",s.jsx("input",{type:"number",min:"0.1",max:"10",step:"0.1",value:je.config.conditions.priorityAgeMultiplier,onChange:A=>Ae(M=>({...M,config:{...M.config,conditions:{...M.config.conditions,priorityAgeMultiplier:A.target.value}}}))})]}),s.jsxs("label",{children:["Priority Weight Cap",s.jsx("input",{type:"number",min:"1",max:"20",step:"0.1",value:je.config.conditions.priorityWeightCap,onChange:A=>Ae(M=>({...M,config:{...M.config,conditions:{...M.config.conditions,priorityWeightCap:A.target.value}}}))})]}),s.jsxs("label",{children:[s.jsx("input",{type:"checkbox",checked:!!je.config.autoApprove,onChange:A=>Ae(M=>({...M,config:{...M.config,autoApprove:A.target.checked}}))}),"Auto-Approve"]}),s.jsxs("label",{children:[s.jsx("input",{type:"checkbox",checked:!!je.config.requireSecondApprover,onChange:A=>Ae(M=>({...M,config:{...M.config,requireSecondApprover:A.target.checked}}))}),"Require 2nd Approver"]})]}),s.jsxs("div",{className:"welcome-actions",style:{marginTop:10},children:[s.jsx("button",{className:"btn-secondary",disabled:Ge,onClick:bi,children:"Save Custom Preset"}),s.jsx("button",{className:"btn-secondary",onClick:()=>Ae({key:"",name:"",description:"",config:{active:!0,autoApprove:!1,requireSecondApprover:!0,fallbackRole:"AUTO",escalationAfterMinutes:120,conditions:{priorityAgeMultiplier:1,priorityWeightCap:5}}}),children:"Reset Form"})]})]}),s.jsxs("div",{className:"card",style:{marginBottom:10},children:[s.jsx("strong",{children:"Preset Usage History"}),s.jsx("div",{className:"table-wrap",style:{marginTop:10},children:s.jsxs("table",{className:"table lite",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Time"}),s.jsx("th",{children:"Action"}),s.jsx("th",{children:"Preset"}),s.jsx("th",{children:"Actor"}),s.jsx("th",{children:"Role"})]})}),s.jsxs("tbody",{children:[le.map(A=>{var M,v,j;return s.jsxs("tr",{children:[s.jsx("td",{children:A.createdAt?new Date(A.createdAt).toLocaleString():"-"}),s.jsx("td",{children:A.action}),s.jsx("td",{children:A.presetKey||"-"}),s.jsx("td",{children:((M=A.actor)==null?void 0:M.name)||((v=A.actor)==null?void 0:v.email)||"-"}),s.jsx("td",{children:((j=A.actor)==null?void 0:j.role)||"-"})]},`preset-history-${A.id}`)}),le.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:"5",children:"No preset usage history yet"})})]})]})})]}),me&&s.jsxs("div",{className:"card",style:{marginBottom:10},children:[s.jsxs("strong",{children:["Escalation Preview  Candidates: ",((zr=me==null?void 0:me.totals)==null?void 0:zr.totalCandidates)??0]}),s.jsxs("div",{className:"muted",style:{marginTop:6},children:["Generated:"," ",me!=null&&me.generatedAt?new Date(me.generatedAt).toLocaleString():"-"]}),s.jsx("div",{className:"grid info-grid",style:{marginTop:10},children:((me==null?void 0:me.previews)||[]).map(A=>s.jsxs("div",{className:"card stat",children:[s.jsx("div",{className:"card-title",children:A.requestType}),s.jsx("div",{className:"card-value",children:A.totalCandidates||0}),s.jsx("div",{className:"muted",children:A.eligible?`Fallback: ${A.fallbackRole||"-"} (${A.fallbackMode||"FIXED"})`:`Ineligible: ${A.reason||"N/A"}`}),A.eligible&&s.jsxs("div",{className:"muted",children:["Weighted demand: ",A.weightedCandidates??0]}),A.eligible&&A.priorityTuning&&s.jsxs("div",{className:"muted",children:["Tuning: age x",A.priorityTuning.priorityAgeMultiplier??1,", cap"," ",A.priorityTuning.priorityWeightCap??5]}),Array.isArray(A.roleForecast)&&A.roleForecast.length>0&&s.jsx("div",{className:"muted",style:{marginTop:8},children:A.roleForecast.map(M=>s.jsxs("div",{children:[M.role,": now ",M.currentPendingAssignments," (+age ",M.currentAvgPendingAgeMinutes,"m)"," "," / +",M.projectedAssignments," (w ",M.projectedWeightedAssignments,") "," ",M.projectedAvgPendingPerUser,"/user, pressure ",M.projectedPriorityPressure]},`${A.requestType}-${M.role}`))})]},`preview-${A.requestType}`))})]}),s.jsxs("table",{className:"table lite",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Request Type"}),s.jsx("th",{children:"Policy Active"}),s.jsx("th",{children:"Auto-Approve"}),s.jsx("th",{children:"2nd Approver"}),s.jsx("th",{children:"Fallback Role"}),s.jsx("th",{children:"Escalate After (min)"}),s.jsx("th",{children:"Max Leave Days"}),s.jsx("th",{children:"Max Overtime Hours"}),s.jsx("th",{children:"Priority Age Multiplier"}),s.jsx("th",{children:"Priority Weight Cap"}),s.jsx("th",{children:"Allowed Shift Types (comma)"}),s.jsx("th",{children:"Fallback Candidates (comma roles)"}),s.jsx("th",{children:"Action"})]})}),s.jsxs("tbody",{children:[O.map(A=>{var v,j,N,R,P,T;const M=H[A.requestType]||{};return s.jsxs("tr",{children:[s.jsx("td",{children:A.requestType}),s.jsx("td",{children:s.jsx("input",{type:"checkbox",checked:!!M.active,onChange:$=>F(q=>({...q,[A.requestType]:{...q[A.requestType],active:$.target.checked}}))})}),s.jsx("td",{children:s.jsx("input",{type:"checkbox",checked:!!M.autoApprove,onChange:$=>F(q=>({...q,[A.requestType]:{...q[A.requestType],autoApprove:$.target.checked}}))})}),s.jsx("td",{children:s.jsx("input",{type:"checkbox",checked:!!M.requireSecondApprover,onChange:$=>F(q=>({...q,[A.requestType]:{...q[A.requestType],requireSecondApprover:$.target.checked}}))})}),s.jsx("td",{children:s.jsxs("select",{value:M.fallbackRole||"HOSPITAL_ADMIN",onChange:$=>F(q=>({...q,[A.requestType]:{...q[A.requestType],fallbackRole:$.target.value}})),children:[s.jsx("option",{value:"AUTO",children:"AUTO (workload-aware)"}),s.jsx("option",{value:"HOSPITAL_ADMIN",children:"HOSPITAL_ADMIN"}),s.jsx("option",{value:"HR_MANAGER",children:"HR_MANAGER"}),s.jsx("option",{value:"PAYROLL_OFFICER",children:"PAYROLL_OFFICER"}),s.jsx("option",{value:"SYSTEM_ADMIN",children:"SYSTEM_ADMIN"}),s.jsx("option",{value:"SUPER_ADMIN",children:"SUPER_ADMIN"})]})}),s.jsx("td",{children:s.jsx("input",{type:"number",min:"5",max:"10080",value:M.escalationAfterMinutes??120,onChange:$=>F(q=>({...q,[A.requestType]:{...q[A.requestType],escalationAfterMinutes:$.target.value}}))})}),s.jsx("td",{children:s.jsx("input",{type:"number",min:"0",max:"60",value:((v=M.conditions)==null?void 0:v.maxLeaveDays)??0,onChange:$=>F(q=>{var G;return{...q,[A.requestType]:{...q[A.requestType],conditions:{...((G=q[A.requestType])==null?void 0:G.conditions)||{},maxLeaveDays:$.target.value}}}})})}),s.jsx("td",{children:s.jsx("input",{type:"number",min:"0",max:"24",value:((j=M.conditions)==null?void 0:j.maxOvertimeHours)??0,onChange:$=>F(q=>{var G;return{...q,[A.requestType]:{...q[A.requestType],conditions:{...((G=q[A.requestType])==null?void 0:G.conditions)||{},maxOvertimeHours:$.target.value}}}})})}),s.jsx("td",{children:s.jsx("input",{type:"number",min:"0.1",max:"10",step:"0.1",value:((N=M.conditions)==null?void 0:N.priorityAgeMultiplier)??1,onChange:$=>F(q=>{var G;return{...q,[A.requestType]:{...q[A.requestType],conditions:{...((G=q[A.requestType])==null?void 0:G.conditions)||{},priorityAgeMultiplier:$.target.value}}}})})}),s.jsx("td",{children:s.jsx("input",{type:"number",min:"1",max:"20",step:"0.1",value:((R=M.conditions)==null?void 0:R.priorityWeightCap)??5,onChange:$=>F(q=>{var G;return{...q,[A.requestType]:{...q[A.requestType],conditions:{...((G=q[A.requestType])==null?void 0:G.conditions)||{},priorityWeightCap:$.target.value}}}})})}),s.jsx("td",{children:s.jsx("input",{type:"text",value:((P=M.conditions)==null?void 0:P.allowedShiftTypes)??"",onChange:$=>F(q=>{var G;return{...q,[A.requestType]:{...q[A.requestType],conditions:{...((G=q[A.requestType])==null?void 0:G.conditions)||{},allowedShiftTypes:$.target.value}}}})})}),s.jsx("td",{children:s.jsx("input",{type:"text",value:((T=M.conditions)==null?void 0:T.fallbackCandidates)??"",onChange:$=>F(q=>{var G;return{...q,[A.requestType]:{...q[A.requestType],conditions:{...((G=q[A.requestType])==null?void 0:G.conditions)||{},fallbackCandidates:$.target.value}}}})})}),s.jsxs("td",{children:[s.jsx("div",{className:"action-list",style:{marginBottom:8},children:Q.map($=>s.jsx("button",{className:"btn-secondary",title:`${$.description||""}${$.version?` | v${$.version}`:""}`,onClick:()=>Oa(A.requestType,$.key),children:$.name||$.key},`preset-row-${A.requestType}-${$.key}`))}),s.jsx("button",{className:"btn-secondary",disabled:Ge,onClick:()=>vi(A.requestType),children:"Save"}),s.jsx("button",{className:"btn-secondary",onClick:()=>_i(A.requestType),children:"Simulate"})]})]},`auto-${A.requestType}`)}),O.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:"13",children:"No automation policies loaded"})})]})]}),he&&s.jsxs("div",{className:"card",style:{marginTop:10},children:[s.jsxs("strong",{children:["Simulation (",he.requestType,")"]}),s.jsxs("div",{className:"muted",children:["Auto-Approve: ",(Pn=he==null?void 0:he.decision)!=null&&Pn.autoApprove?"Yes":"No"," | Requires 2nd Approver: ",(Wr=he==null?void 0:he.decision)!=null&&Wr.requiresSecondApprover?"Yes":"No"," | Fallback: ",((gn=he==null?void 0:he.decision)==null?void 0:gn.fallbackRole)||"-"]})]})]})]}),s.jsxs("section",{className:"section",id:"pending",children:[s.jsx("h3",{children:"Pending Requests"}),s.jsxs("div",{className:"card",children:[s.jsxs("div",{className:"action-list",style:{marginBottom:12},children:[s.jsx("button",{className:`action-pill ${fe==="ALL"?"active":""}`,onClick:()=>_e("ALL"),children:"All"}),s.jsx("button",{className:`action-pill ${fe==="LEAVE"?"active":""}`,onClick:()=>_e("LEAVE"),children:"Leave"}),s.jsx("button",{className:`action-pill ${fe==="OVERTIME"?"active":""}`,onClick:()=>_e("OVERTIME"),children:"Overtime"}),s.jsx("button",{className:`action-pill ${fe==="SHIFT"?"active":""}`,onClick:()=>_e("SHIFT"),children:"Shift"})]}),s.jsxs("div",{className:"action-list",style:{marginBottom:12},children:[s.jsxs("span",{className:"muted",children:["Leave: ",ks.LEAVE,((Kn=(Ds=C==null?void 0:C.queues)==null?void 0:Ds.leave)==null?void 0:Kn.pending)!=null?` / total ${C.queues.leave.pending}`:""]}),s.jsx("button",{className:"btn-secondary",disabled:!y||k==="LEAVE",onClick:()=>Is("LEAVE"),children:k==="LEAVE"?"Loading...":"Load more Leave"}),s.jsxs("span",{className:"muted",children:["Overtime: ",ks.OVERTIME,((Ms=(jr=C==null?void 0:C.queues)==null?void 0:jr.overtime)==null?void 0:Ms.pending)!=null?` / total ${C.queues.overtime.pending}`:""]}),s.jsx("button",{className:"btn-secondary",disabled:!E||k==="OVERTIME",onClick:()=>Is("OVERTIME"),children:k==="OVERTIME"?"Loading...":"Load more Overtime"}),s.jsxs("span",{className:"muted",children:["Shift: ",ks.SHIFT,((br=(Us=C==null?void 0:C.queues)==null?void 0:Us.shift)==null?void 0:br.pending)!=null?` / total ${C.queues.shift.pending}`:""]}),s.jsx("button",{className:"btn-secondary",disabled:!x||k==="SHIFT",onClick:()=>Is("SHIFT"),children:k==="SHIFT"?"Loading...":"Load more Shift"}),s.jsx("button",{className:"btn-secondary",disabled:_,onClick:()=>Nt({append:!0}),children:_?"Loading...":"Load more All"})]}),s.jsxs("table",{className:"table lite",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Staff"}),s.jsx("th",{children:"Role"}),s.jsx("th",{children:"Type"}),s.jsx("th",{children:"Category"}),s.jsx("th",{children:"Requested"}),s.jsx("th",{children:"SLA Due"}),s.jsx("th",{children:"Stage"}),s.jsx("th",{children:"Reason"}),s.jsx("th",{children:"Actions"})]})}),s.jsxs("tbody",{children:[On.map(A=>{var M,v;return s.jsxs("tr",{id:`breach-row-${A.kind}-${A._id}`,className:[Er(A)?"breached-row":"",Pt===`${A.kind}-${A._id}`?"breached-row-active":""].join(" ").trim(),children:[s.jsx("td",{children:((M=A.requester)==null?void 0:M.name)||"-"}),s.jsx("td",{children:((v=A.requester)==null?void 0:v.role)||"-"}),s.jsx("td",{children:A.kind}),s.jsx("td",{children:A.type||A.shiftType||`${A.hours||"-"} hrs`}),s.jsx("td",{children:new Date(A.createdAt).toLocaleDateString()}),s.jsxs("td",{className:Er(A)?"text-danger":"",children:[A.slaDueAt?new Date(A.slaDueAt).toLocaleString():"-",Er(A)&&s.jsx("span",{className:"breach-pill",children:"BREACHED"})]}),s.jsx("td",{children:A.approvalStage||"L1_PENDING"}),s.jsx("td",{children:A.reason||"-"}),s.jsxs("td",{children:[s.jsx("button",{className:"btn-secondary",onClick:()=>vt(A.kind,A._id,Er(A)),children:"Approve"}),s.jsx("button",{className:"btn-secondary",onClick:()=>qr(A.kind,A._id,Er(A)),children:"Reject"})]})]},`${A.kind}-${A._id}`)}),On.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:"9",children:"No pending approvals"})})]})]})]})]})]})}function VP(){const{user:e}=Me(),[t,n]=m.useState([]),[r,i]=m.useState(!1),[a,o]=m.useState(null);if((e==null?void 0:e.role)!=="HOSPITAL_ADMIN"&&(e==null?void 0:e.role)!=="SUPER_ADMIN")return s.jsx("p",{children:" Access denied"});const l=async()=>{i(!0),o(null);try{const h=((await ue.get("/api/users")).data||[]).filter(f=>["HOSPITAL_ADMIN","DOCTOR","NURSE","LAB_TECH","PHARMACIST","RADIOLOGIST","THERAPIST","RECEPTIONIST","SECURITY_OFFICER","HR_MANAGER","PAYROLL_OFFICER"].includes(f.role));n(h)}catch{o("Failed to load staff")}finally{i(!1)}};m.useEffect(()=>{l()},[]);const c=async d=>{await ue.patch(`/api/users/${d}`,{active:!1}),l()},u=async(d,p)=>{await ue.patch(`/api/users/${d}`,{role:p}),l()};return s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"Staff Management"}),s.jsx("p",{className:"muted",children:"Approve roles, deactivate accounts."})]}),s.jsx("div",{className:"welcome-actions",children:s.jsx("button",{className:"btn-secondary",onClick:l,disabled:r,children:"Refresh"})})]}),a&&s.jsx("div",{className:"card",children:a}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Staff"}),s.jsx("div",{className:"card",children:s.jsxs("table",{className:"table lite",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Name"}),s.jsx("th",{children:"Email"}),s.jsx("th",{children:"Role"}),s.jsx("th",{children:"Status"}),s.jsx("th",{children:"Actions"})]})}),s.jsxs("tbody",{children:[t.map(d=>s.jsxs("tr",{children:[s.jsx("td",{children:d.name}),s.jsx("td",{children:d.email}),s.jsx("td",{children:s.jsxs("select",{value:d.role,onChange:p=>u(d._id,p.target.value),children:[s.jsx("option",{value:"HOSPITAL_ADMIN",children:"Hospital Admin"}),s.jsx("option",{value:"DOCTOR",children:"Doctor"}),s.jsx("option",{value:"NURSE",children:"Nurse"}),s.jsx("option",{value:"LAB_TECH",children:"Lab Tech"}),s.jsx("option",{value:"PHARMACIST",children:"Pharmacist"}),s.jsx("option",{value:"RADIOLOGIST",children:"Radiologist"}),s.jsx("option",{value:"THERAPIST",children:"Therapist"}),s.jsx("option",{value:"RECEPTIONIST",children:"Receptionist"}),s.jsx("option",{value:"SECURITY_OFFICER",children:"Security Officer"}),s.jsx("option",{value:"HR_MANAGER",children:"HR Manager"}),s.jsx("option",{value:"PAYROLL_OFFICER",children:"Payroll Officer"})]})}),s.jsx("td",{children:d.active===!1?"Inactive":"Active"}),s.jsx("td",{children:s.jsx("button",{className:"btn-secondary",onClick:()=>c(d._id),disabled:d.active===!1,children:"Deactivate"})})]},d._id)),t.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:"5",children:"No staff found"})})]})]})})]})]})}function $P(){const{user:e}=Me(),t=Oe(),[n,r]=m.useState(null);return m.useEffect(()=>{GO().then(r).catch(()=>r(null))},[]),s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"Security Officer Field Console"}),s.jsx("p",{className:"muted",children:"Current shift execution, visitor flow, gate scanning and incident response."})]}),s.jsxs("div",{className:"welcome-actions",children:[s.jsx("button",{className:"btn-primary",onClick:()=>t("/security-officer"),children:"My Shift"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/security-officer"),children:"Visitor Check-In"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/security-officer"),children:"Emergency Alert"})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Shift & Zone"}),s.jsxs("div",{className:"grid info-grid",children:[s.jsx(te,{title:"Current Shift",value:"Active"}),s.jsx(te,{title:"Assigned Zone",value:(e==null?void 0:e.hospital)||"Main"}),s.jsx(te,{title:"Open Incidents",value:(n==null?void 0:n.openIncidents)??""}),s.jsx(te,{title:"Incidents Today",value:(n==null?void 0:n.incidentsToday)??""})]})]}),s.jsxs("section",{className:"section doctor-main-grid",children:[s.jsxs("div",{className:"card doctor-schedule-card",children:[s.jsx("h3",{children:"Center Operations"}),s.jsxs("div",{className:"panel-grid",children:[s.jsx("button",{className:"action-link",onClick:()=>t("/security-officer"),children:"QR Scanner Panel"}),s.jsx("button",{className:"action-link",onClick:()=>t("/security-officer"),children:"Visitor Log Table"}),s.jsx("button",{className:"action-link",onClick:()=>t("/security-officer"),children:"Patrol Logs"})]})]}),s.jsxs("div",{className:"card doctor-alerts-card",children:[s.jsx("h3",{children:"Right Actions"}),s.jsxs("div",{className:"alert-stack",children:[s.jsx("button",{className:"btn-secondary",onClick:()=>t("/security-officer"),children:"Incident Quick Form"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/security-officer"),children:"Alert Button"})]})]})]})]})}function FP(){const{user:e}=Me(),t=Oe(),[n,r]=m.useState(null);return m.useEffect(()=>{WO().then(r).catch(()=>r(null))},[]),s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"Security Governance Dashboard"}),s.jsx("p",{className:"muted",children:"Access control, visitor management, incident response and device authorization."})]}),s.jsxs("div",{className:"welcome-actions",children:[s.jsx("button",{className:"btn-primary",onClick:()=>t("/security-admin"),children:"Access Logs"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/admin/notifications"),children:"Suspicious Alerts"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/reports"),children:"Compliance Reports"})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Security Snapshot"}),s.jsxs("div",{className:"grid info-grid",children:[s.jsx(te,{title:"Active Access Points",value:(n==null?void 0:n.officersActive)??""}),s.jsx(te,{title:"Open Incidents",value:(n==null?void 0:n.openIncidents)??""}),s.jsx(te,{title:"Escalated Incidents",value:(n==null?void 0:n.escalatedIncidents)??""}),s.jsx(te,{title:"Incidents Today",value:(n==null?void 0:n.incidentsToday)??""})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Security Control Panels"}),s.jsxs("div",{className:"panel-grid",children:[s.jsx("button",{className:"action-link",onClick:()=>t("/security-admin"),children:"Clearance Levels"}),s.jsx("button",{className:"action-link",onClick:()=>t("/security-admin"),children:"Visitor Management"}),s.jsx("button",{className:"action-link",onClick:()=>t("/security-admin"),children:"Device Authorization"}),s.jsx("button",{className:"action-link",onClick:()=>t("/security-admin"),children:"Emergency Protocols"}),s.jsx("button",{className:"action-link",onClick:()=>t("/security-admin"),children:"Blacklist Database"})]})]})]})}function HP(){const{user:e}=Me(),t=Oe(),[n,r]=m.useState(null);m.useEffect(()=>{qO().then(r).catch(()=>r(null))},[]);const i=m.useMemo(()=>String((e==null?void 0:e.role)||"").toUpperCase(),[e==null?void 0:e.role]),a=i==="RADIOLOGIST"?"Radiologist Workspace":i==="THERAPIST"?"Therapist Workspace":i==="RECEPTIONIST"?"Receptionist Workspace":"Staff Workspace",o=i==="RADIOLOGIST"?["Imaging Queue","Scan Viewer","Report Editor","Equipment Logs","AI Assistance Overlay"]:i==="THERAPIST"?["Session Schedule","Patient Notes","Treatment Plans","Progress Tracking","Follow-up Planner"]:["Appointment Scheduling","Patient Check-In","Billing Initiation","Queue Management","Visitor Log"];return s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:a}),s.jsx("p",{className:"muted",children:"Role-specific operational dashboard with requests, queues and alerts."})]}),s.jsxs("div",{className:"welcome-actions",children:[s.jsx("button",{className:"btn-primary",onClick:()=>t("/staff"),children:"Open Workspace"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/workforce/requests"),children:"My Requests"})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Daily Summary"}),s.jsxs("div",{className:"grid info-grid",children:[s.jsx(te,{title:"My Pending Requests",value:(n==null?void 0:n.myPendingRequests)??""}),s.jsx(te,{title:"Hospital Pending Requests",value:(n==null?void 0:n.hospitalPendingRequests)??""}),s.jsx(te,{title:"Unread Notifications",value:(n==null?void 0:n.notificationsUnread)??""}),s.jsx(te,{title:"Appointments Today",value:(n==null?void 0:n.appointmentsToday)??""})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Role Workspace"}),s.jsx("div",{className:"panel-grid",children:o.map(l=>s.jsx("div",{className:"panel",children:l},l))})]})]})}function qP(){var y,b;const{user:e}=Me(),t=Oe(),[n,r]=m.useState(null),[i,a]=m.useState(null),[o,l]=m.useState(null),[c,u]=m.useState({burnoutScore:[],projectedKpi:[],projectedChange:[]}),d=(E,g)=>{u(x=>({...x,[E]:[...x[E]||[],Number(g||0)].slice(-12)}))},p=E=>{const g=Number(E||0);return g>=75?"risk":g>=45?"warn":"good"},h=E=>{const g=Number(E||0);return g<0?"risk":g<3?"warn":"good"},f=async()=>{try{const[E,g]=await Promise.all([qp({hoursPerWeek:50,nightShifts:4,consecutiveDays:6,overtimeHours:10,leaveBalanceDays:9,incidentsIn30d:1}),H0({baseline:100,interventions:[{name:"Shift rebalance",effectPct:6,confidence:.75},{name:"Fast-track hiring",effectPct:8,confidence:.65}]})]);a(E||null),l(g||null),d("burnoutScore",(E==null?void 0:E.score)||0),d("projectedKpi",(g==null?void 0:g.projected)||0),d("projectedChange",(g==null?void 0:g.changePct)||0)}catch{a(null),l(null)}};return m.useEffect(()=>{FO().then(r).catch(()=>r(null)),f();const E=setInterval(f,45e3);return()=>clearInterval(E)},[]),s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"HR Manager Command Center"}),s.jsx("p",{className:"muted",children:"Recruitment, onboarding, contracts, performance and workforce analytics."})]}),s.jsxs("div",{className:"welcome-actions",children:[s.jsx("button",{className:"btn-primary",onClick:()=>t("/hospital-admin/register-staff"),children:"Recruitment Pipeline"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/hospital-admin/staff"),children:"Employee Profiles"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/workforce/requests"),children:"Leave Management"})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Top HR KPIs"}),s.jsxs("div",{className:"grid info-grid",children:[s.jsx(te,{title:"Open Positions",value:(n==null?void 0:n.newHires)??""}),s.jsx(te,{title:"Leave Pending",value:((y=n==null?void 0:n.pendingRequests)==null?void 0:y.leave)??""}),s.jsx(te,{title:"Turnover %",value:(n==null?void 0:n.inactiveStaff)??""}),s.jsx(te,{title:"Compliance Alerts",value:(n==null?void 0:n.missingLicenses)??""})]})]}),s.jsxs("section",{className:"section doctor-main-grid",children:[s.jsxs("div",{className:"card doctor-schedule-card",children:[s.jsx("h3",{children:"Center Workspace"}),s.jsxs("div",{className:"panel-grid",children:[s.jsx("button",{className:"action-link",onClick:()=>t("/hospital-admin/register-staff"),children:"Recruitment Kanban"}),s.jsx("button",{className:"action-link",onClick:()=>t("/hospital-admin/staff"),children:"Contracts"}),s.jsx("button",{className:"action-link",onClick:()=>t("/hr-manager"),children:"Performance Reviews"}),s.jsx("button",{className:"action-link",onClick:()=>t("/hr-manager"),children:"Training & Certifications"}),s.jsx("button",{className:"action-link",onClick:()=>t("/hr-manager"),children:"Succession Planning"})]})]}),s.jsxs("div",{className:"card doctor-alerts-card",children:[s.jsx("h3",{children:"Right Insights"}),s.jsxs("div",{className:"alert-stack",children:[s.jsxs("div",{className:"action-pill",children:["Pending Requests: ",((b=n==null?void 0:n.pendingRequests)==null?void 0:b.total)??""]}),s.jsxs("div",{className:"action-pill",children:["Incomplete Staff: ",(n==null?void 0:n.incompleteStaff)??""]}),s.jsxs("div",{className:"action-pill",children:["Inactive Staff: ",(n==null?void 0:n.inactiveStaff)??""]})]})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"AI Workforce Intelligence"}),s.jsxs("div",{className:"grid info-grid",children:[s.jsx(te,{title:"Burnout Score",value:(i==null?void 0:i.score)??"",trend:c.burnoutScore,subtitle:"Auto-refresh 45s",status:p(i==null?void 0:i.score)}),s.jsx(te,{title:"Burnout Band",value:(i==null?void 0:i.band)??""}),s.jsx(te,{title:"Projected KPI",value:(o==null?void 0:o.projected)??"",trend:c.projectedKpi,subtitle:"Auto-refresh 45s",status:h(o==null?void 0:o.changePct)}),s.jsx(te,{title:"Projected Change %",value:(o==null?void 0:o.changePct)??"",trend:c.projectedChange,subtitle:"Auto-refresh 45s",status:h(o==null?void 0:o.changePct)})]})]})]})}function zP(){const{user:e}=Me(),t=Oe(),[n,r]=m.useState(null);return m.useEffect(()=>{HO().then(r).catch(()=>r(null))},[]),s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"Payroll Officer Engine"}),s.jsx("p",{className:"muted",children:"Run payroll, manage deductions, taxes, loans and audit-ready payroll history."})]}),s.jsxs("div",{className:"welcome-actions",children:[s.jsx("button",{className:"btn-primary",onClick:()=>t("/payments/full"),children:"Run Payroll"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/reports"),children:"Tax Reports"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/workforce/requests#overtime"),children:"Overtime"})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Payroll Status"}),s.jsxs("div",{className:"grid info-grid",children:[s.jsx(te,{title:"Current Payroll Status",value:(n==null?void 0:n.invoicesThisMonth)??""}),s.jsx(te,{title:"Total Gross",value:(n==null?void 0:n.totalThisMonth)??""}),s.jsx(te,{title:"Total Deductions",value:(n==null?void 0:n.unpaidInvoices)??""}),s.jsx(te,{title:"Net Pay Summary",value:(n==null?void 0:n.paidThisMonth)??""})]})]}),s.jsxs("section",{className:"section doctor-main-grid",children:[s.jsxs("div",{className:"card doctor-schedule-card",children:[s.jsx("h3",{children:"Payroll Table"}),s.jsxs("div",{className:"panel-grid",children:[s.jsx("button",{className:"action-link",onClick:()=>t("/payments/full"),children:"Overtime Management"}),s.jsx("button",{className:"action-link",onClick:()=>t("/payments/full"),children:"Allowances & Deductions"}),s.jsx("button",{className:"action-link",onClick:()=>t("/reports"),children:"Loan Management"}),s.jsx("button",{className:"action-link",onClick:()=>t("/payments/full"),children:"Generate Payslips"})]})]}),s.jsxs("div",{className:"card doctor-alerts-card",children:[s.jsx("h3",{children:"Right Insights"}),s.jsxs("div",{className:"alert-stack",children:[s.jsxs("div",{className:"action-pill",children:["Pending Approvals: ",(n==null?void 0:n.pendingApprovals)??""]}),s.jsxs("div",{className:"action-pill",children:["Overdue Payroll: ",(n==null?void 0:n.overduePayroll)??""]}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/reports"),children:"Audit Trail"})]})]})]})]})}function WP(){var p,h,f,y,b,E,g,x,w,_,S,k;const e=Oe(),[t,n]=m.useState(null),[r,i]=m.useState(null),[a,o]=m.useState(!1),[l,c]=m.useState(null),u=async()=>{try{const[I,C]=await Promise.all([Vo(),Th()]);n(I||null),i((C==null?void 0:C.trust)||null)}catch{n(null),i(null)}};m.useEffect(()=>{u()},[]);const d=async()=>{var I,C,L,V,B,Y;o(!0),c(null);try{const W=await pp(),O=((C=(I=W==null?void 0:W.result)==null?void 0:I.workforce)==null?void 0:C.escalationsL1)??0,D=((V=(L=W==null?void 0:W.result)==null?void 0:L.workforce)==null?void 0:V.escalationsL2)??0;c(`Workflow SLA scan completed (L1: ${O}, L2: ${D})`),localStorage.setItem("workflow_sla_last_scan",JSON.stringify({lastScanAt:(W==null?void 0:W.ranAt)||new Date().toISOString(),escalationsL1:O,escalationsL2:D,updatedAt:new Date().toISOString()})),await u()}catch(W){c(((Y=(B=W==null?void 0:W.response)==null?void 0:B.data)==null?void 0:Y.message)||"Failed to run workflow SLA scan")}finally{o(!1)}};return s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"Developer Engineering Console"}),s.jsx("p",{className:"muted",children:"API observability, queue health, trust controls and SLA operations."})]}),s.jsxs("div",{className:"welcome-actions",children:[s.jsx("button",{className:"btn-primary",onClick:d,disabled:a,children:a?"Running SLA Scan...":"Run Workflow SLA Scan"}),s.jsx("button",{className:"btn-secondary",onClick:u,children:"Refresh Metrics"}),s.jsx("button",{className:"btn-secondary",onClick:()=>e("/developer/queue-replay"),children:"Queue Replay"}),s.jsx("button",{className:"btn-secondary",onClick:()=>e("/developer/decision-cockpit"),children:"Decision Cockpit"})]})]}),l&&s.jsx("div",{className:"card",children:l}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Queue Metrics"}),s.jsxs("div",{className:"grid info-grid",children:[s.jsx(te,{title:"Integration Waiting",value:((h=(p=t==null?void 0:t.queues)==null?void 0:p.integration)==null?void 0:h.waiting)??""}),s.jsx(te,{title:"DLQ Failed",value:((y=(f=t==null?void 0:t.queues)==null?void 0:f.dlq)==null?void 0:y.failed)??""}),s.jsx(te,{title:"Webhook Waiting",value:((E=(b=t==null?void 0:t.queues)==null?void 0:b.webhook)==null?void 0:E.waiting)??""}),s.jsx(te,{title:"Notification Waiting",value:((x=(g=t==null?void 0:t.queues)==null?void 0:g.notifications)==null?void 0:x.waiting)??""}),s.jsx(te,{title:"Workforce Pending",value:((_=(w=t==null?void 0:t.queues)==null?void 0:w.workforce)==null?void 0:_.totalPending)??""}),s.jsx(te,{title:"Workforce Breached",value:((k=(S=t==null?void 0:t.queues)==null?void 0:S.workforce)==null?void 0:k.breached)??""})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Trust Foundation"}),s.jsxs("div",{className:"grid info-grid",children:[s.jsx(te,{title:"Ledger Writes (24h)",value:(r==null?void 0:r.ledgerWrites24h)??""}),s.jsx(te,{title:"Policy Denials (24h)",value:(r==null?void 0:r.policyDenials24h)??""}),s.jsx(te,{title:"Consent Denials (24h)",value:(r==null?void 0:r.consentDenials24h)??""}),s.jsx(te,{title:"Risk Step-Ups (24h)",value:(r==null?void 0:r.highRiskStepUps24h)??""}),s.jsx(te,{title:"Active Consents",value:(r==null?void 0:r.activeConsents)??""})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Engineering Tools"}),s.jsxs("div",{className:"panel-grid",children:[s.jsx("button",{className:"action-link",onClick:()=>e("/developer/webhook-retry"),children:"Webhook Retry"}),s.jsx("button",{className:"action-link",onClick:()=>e("/developer/queue-replay"),children:"Job Queue Replay"}),s.jsx("button",{className:"action-link",onClick:()=>e("/developer/decision-cockpit"),children:"Decision Cockpit"}),s.jsx("button",{className:"action-link",onClick:()=>e("/system-admin/clinical-intelligence"),children:"Clinical Intelligence"}),s.jsx("button",{className:"action-link",onClick:()=>e("/developer/provenance-verify"),children:"Provenance Verify"}),s.jsx("button",{className:"action-link",onClick:()=>e("/ai/extract"),children:"NeuroEdge Extract"}),s.jsx("button",{className:"action-link",onClick:()=>e("/admin/realtime"),children:"Integration Monitor"}),s.jsx("button",{className:"action-link",onClick:()=>e("/admin/audit-logs"),children:"Audit Logs"}),s.jsx("button",{className:"action-link",onClick:()=>e("/super-admin/settings"),children:"Feature Flags"}),s.jsx("button",{className:"action-link",onClick:()=>e("/hospital-admin/approvals"),children:"Workforce Approvals"})]})]})]})}const Vy=async()=>(await ue.get("/api/system-admin/metrics")).data,GP=async()=>{var t;return((t=(await ue.get("/api/system-admin/risk-policy")).data)==null?void 0:t.policy)||null},YP=async e=>{var n;return((n=(await ue.put("/api/system-admin/risk-policy",e)).data)==null?void 0:n.policy)||null},$y=async(e={})=>{var i;const t=new URLSearchParams;e.domain&&t.set("domain",e.domain),e.resource&&t.set("resource",e.resource),e.action&&t.set("action",e.action),e.activeOnly&&t.set("activeOnly","1");const n=t.toString();return((i=(await ue.get(`/api/system-admin/abac-policies${n?`?${n}`:""}`)).data)==null?void 0:i.items)||[]},Fy=async e=>(await ue.post("/api/system-admin/abac-policies",e)).data,Hy=async(e,t)=>(await ue.put(`/api/system-admin/abac-policies/${e}`,t)).data,KP=async e=>(await ue.delete(`/api/system-admin/abac-policies/${e}`)).data,JP=async e=>(await ue.post("/api/system-admin/abac-simulate",e)).data,QP=async(e={})=>{var i;const t=new URLSearchParams;e.activeOnly&&t.set("activeOnly","1");const n=t.toString();return((i=(await ue.get(`/api/system-admin/abac-test-cases${n?`?${n}`:""}`)).data)==null?void 0:i.items)||[]},ZP=async e=>(await ue.post("/api/system-admin/abac-test-cases",e)).data,XP=async e=>(await ue.delete(`/api/system-admin/abac-test-cases/${e}`)).data,eL=async e=>(await ue.post(`/api/system-admin/abac-test-cases/${e}/run`)).data,tL=async()=>(await ue.post("/api/system-admin/abac-test-cases/run-all")).data;function nL(){var L,V,B,Y,W,O,D,Q,ae,U,Z,le,ye,je,Ae,H,F,se,xe,Ce,Pe,Ge,X,he,ge,me,Ne,dt,pt,Te,we;const e=Oe(),[t,n]=m.useState(null),[r,i]=m.useState(null),[a,o]=m.useState(null),[l,c]=m.useState(!1),[u,d]=m.useState(null),[p,h]=m.useState(null),[f,y]=m.useState(!1),[b,E]=m.useState(null),[g,x]=m.useState({doctorGap:[],nurseGap:[],underCapacity:[],pendingShifts:[]}),w=(ce,ve)=>{x(fe=>({...fe,[ce]:[...fe[ce]||[],Number(ve||0)].slice(-12)}))},_=ce=>{const ve=Number(ce||0);return ve<=0?"good":ve<=5?"warn":"risk"},S=(ce,ve=1,fe=3)=>{const _e=Number(ce||0);return _e>=fe?"risk":_e>=ve?"warn":"good"},k=async()=>{var ce,ve,fe,_e,be;try{const[Ve,ke]=await Promise.all([Hp({beds:300,occupancyRate:.8,avgPatientsPerDoctor:14,avgPatientsPerNurse:5,horizonDays:14}),q0({departments:[{name:"ICU",staff:22,demand:28,absenteeismRate:.06},{name:"Emergency",staff:36,demand:41,absenteeismRate:.05},{name:"Surgery",staff:18,demand:17,absenteeismRate:.04}]})]);E({forecast:Ve,twin:ke});const tn=Array.isArray((ce=ke==null?void 0:ke.twin)==null?void 0:ce.departments)?ke.twin.departments.filter(fn=>fn.status==="UNDER_CAPACITY").length:0;w("doctorGap",((ve=Ve==null?void 0:Ve.forecast)==null?void 0:ve.doctorGap)||0),w("nurseGap",((fe=Ve==null?void 0:Ve.forecast)==null?void 0:fe.nurseGap)||0),w("underCapacity",tn),w("pendingShifts",((be=(_e=ke==null?void 0:ke.twin)==null?void 0:_e.pendingRequests)==null?void 0:be.shifts)||0)}catch{E(null)}};m.useEffect(()=>{Promise.all([Vy(),Vo(),Th()]).then(([ve,fe,_e])=>{n(ve||null),i(fe||null),o((_e==null?void 0:_e.trust)||null)}).catch(()=>{n(null),i(null),o(null)}),GP().then(ve=>h(ve||null)).catch(()=>h(null)),k();const ce=setInterval(k,45e3);return()=>clearInterval(ce)},[]);const I=async()=>{var ce,ve,fe,_e,be,Ve;c(!0),d(null);try{const ke=await pp(),tn=((ve=(ce=ke==null?void 0:ke.result)==null?void 0:ce.workforce)==null?void 0:ve.escalationsL1)??0,fn=((_e=(fe=ke==null?void 0:ke.result)==null?void 0:fe.workforce)==null?void 0:_e.escalationsL2)??0;d(`SLA scan completed (L1: ${tn}, L2: ${fn})`);const[In,Pt,pn]=await Promise.all([Vy(),Vo(),Th()]);n(In||null),i(Pt||null),o((pn==null?void 0:pn.trust)||null)}catch(ke){d(((Ve=(be=ke==null?void 0:ke.response)==null?void 0:be.data)==null?void 0:Ve.message)||"Failed to run SLA scan")}finally{c(!1)}},C=async()=>{if(p){y(!0),d(null);try{const ce=await YP(p);h(ce||p),d("Adaptive risk policy updated.")}catch(ce){d((ce==null?void 0:ce.message)||"Failed to update risk policy")}finally{y(!1)}}};return s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"System Admin Technical Center"}),s.jsx("p",{className:"muted",children:"Operational reliability, queue health, integration stability and deployment visibility."})]}),s.jsxs("div",{className:"welcome-actions",children:[s.jsx("button",{className:"btn-primary",onClick:I,disabled:l,children:l?"Running SLA Scan...":"Run Workflow SLA Scan"}),s.jsx("button",{className:"btn-primary",onClick:()=>e("/developer"),children:"Server Metrics"}),s.jsx("button",{className:"btn-secondary",onClick:()=>e("/developer/queue-replay"),children:"Job Queue"}),s.jsx("button",{className:"btn-secondary",onClick:()=>e("/admin/realtime"),children:"Integration Monitor"})]})]}),u&&s.jsx("div",{className:"card",children:u}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"System Widgets"}),s.jsxs("div",{className:"grid info-grid",children:[s.jsx(te,{title:"CPU / Memory",value:((V=(L=r==null?void 0:r.queues)==null?void 0:L.integration)==null?void 0:V.active)??""}),s.jsx(te,{title:"Req / Min",value:((Y=(B=r==null?void 0:r.queues)==null?void 0:B.integration)==null?void 0:Y.completed)??""}),s.jsx(te,{title:"Failed Logins",value:((W=t==null?void 0:t.approvals)==null?void 0:W.total)??""}),s.jsx(te,{title:"Job Status",value:((D=(O=r==null?void 0:r.queues)==null?void 0:O.integration)==null?void 0:D.waiting)??""}),s.jsx(te,{title:"Microservices",value:(t==null?void 0:t.hospitals)??""}),s.jsx(te,{title:"Database Health",value:((ae=(Q=r==null?void 0:r.queues)==null?void 0:Q.dlq)==null?void 0:ae.failed)??""}),s.jsx(te,{title:"Workforce Breached",value:((Z=(U=r==null?void 0:r.queues)==null?void 0:U.workforce)==null?void 0:Z.breached)??""}),s.jsx(te,{title:"Policy Denials (24h)",value:(a==null?void 0:a.policyDenials24h)??""})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Technical Operations"}),s.jsxs("div",{className:"panel-grid",children:[s.jsx("button",{className:"action-link",onClick:()=>e("/developer"),children:"Error Logs"}),s.jsx("button",{className:"action-link",onClick:()=>e("/developer"),children:"API Logs"}),s.jsx("button",{className:"action-link",onClick:()=>e("/developer/queue-replay"),children:"Queue Monitor"}),s.jsx("button",{className:"action-link",onClick:()=>e("/developer/webhook-retry"),children:"Webhook Retry"}),s.jsx("button",{className:"action-link",onClick:()=>e("/system-admin/abac"),children:"ABAC Policies"}),s.jsx("button",{className:"action-link",onClick:()=>e("/system-admin/mapping-studio"),children:"Mapping Studio"}),s.jsx("button",{className:"action-link",onClick:()=>e("/system-admin/nlp-analytics"),children:"NLP Analytics"}),s.jsx("button",{className:"action-link",onClick:()=>e("/system-admin/clinical-intelligence"),children:"Clinical Intelligence"}),s.jsx("button",{className:"action-link",onClick:()=>e("/system-admin/regulatory-reports"),children:"Regulatory Reports"}),s.jsx("button",{className:"action-link",onClick:()=>e("/developer/ai-extraction-history"),children:"AI Extraction History"}),s.jsx("button",{className:"action-link",onClick:()=>e("/super-admin/settings"),children:"Feature Flags"}),s.jsx("button",{className:"action-link",onClick:()=>e("/admin/realtime"),children:"Integration Hub"})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"AI Intelligence Snapshot"}),s.jsxs("div",{className:"grid info-grid",children:[s.jsx(te,{title:"Doctor Gap",value:((ye=(le=b==null?void 0:b.forecast)==null?void 0:le.forecast)==null?void 0:ye.doctorGap)??"",trend:g.doctorGap,subtitle:"Auto-refresh 45s",status:_((Ae=(je=b==null?void 0:b.forecast)==null?void 0:je.forecast)==null?void 0:Ae.doctorGap)}),s.jsx(te,{title:"Nurse Gap",value:((F=(H=b==null?void 0:b.forecast)==null?void 0:H.forecast)==null?void 0:F.nurseGap)??"",trend:g.nurseGap,subtitle:"Auto-refresh 45s",status:_((xe=(se=b==null?void 0:b.forecast)==null?void 0:se.forecast)==null?void 0:xe.nurseGap)}),s.jsx(te,{title:"Under-Capacity Units",value:Array.isArray((Pe=(Ce=b==null?void 0:b.twin)==null?void 0:Ce.twin)==null?void 0:Pe.departments)?b.twin.twin.departments.filter(ce=>ce.status==="UNDER_CAPACITY").length:"",trend:g.underCapacity,subtitle:"Auto-refresh 45s",status:S(Array.isArray((X=(Ge=b==null?void 0:b.twin)==null?void 0:Ge.twin)==null?void 0:X.departments)?b.twin.twin.departments.filter(ce=>ce.status==="UNDER_CAPACITY").length:0,1,2)}),s.jsx(te,{title:"Twin Pending Shifts",value:((me=(ge=(he=b==null?void 0:b.twin)==null?void 0:he.twin)==null?void 0:ge.pendingRequests)==null?void 0:me.shifts)??"",trend:g.pendingShifts,subtitle:"Auto-refresh 45s",status:S((pt=(dt=(Ne=b==null?void 0:b.twin)==null?void 0:Ne.twin)==null?void 0:dt.pendingRequests)==null?void 0:pt.shifts,5,15)})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Adaptive Risk Policy"}),s.jsx("div",{className:"card",children:p?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"grid info-grid",children:[s.jsxs("label",{className:"muted",children:["High Threshold",s.jsx("input",{type:"number",value:((Te=p.thresholds)==null?void 0:Te.high)??70,onChange:ce=>h(ve=>({...ve,thresholds:{...(ve==null?void 0:ve.thresholds)||{},high:Number(ce.target.value||70)}}))})]}),s.jsxs("label",{className:"muted",children:["Critical Threshold",s.jsx("input",{type:"number",value:((we=p.thresholds)==null?void 0:we.critical)??90,onChange:ce=>h(ve=>({...ve,thresholds:{...(ve==null?void 0:ve.thresholds)||{},critical:Number(ce.target.value||90)}}))})]}),s.jsxs("label",{className:"muted",children:["Restriction Minutes",s.jsx("input",{type:"number",value:p.restrictionMinutes??30,onChange:ce=>h(ve=>({...ve,restrictionMinutes:Number(ce.target.value||30)}))})]}),s.jsxs("label",{className:"muted",children:["Impossible Travel Window (min)",s.jsx("input",{type:"number",value:p.impossibleTravelWindowMinutes??90,onChange:ce=>h(ve=>({...ve,impossibleTravelWindowMinutes:Number(ce.target.value||90)}))})]})]}),s.jsxs("div",{className:"welcome-actions",style:{marginTop:12},children:[s.jsx("button",{className:"btn-primary",onClick:C,disabled:f,children:f?"Saving...":"Save Risk Policy"}),s.jsx("button",{className:"btn-secondary",onClick:()=>e("/step-up"),children:"Step-up Console"})]})]}):s.jsx("p",{className:"muted",children:"Risk policy unavailable."})})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Admin Controls"}),s.jsxs("div",{className:"action-list",children:[s.jsx("button",{className:"action-link",onClick:()=>e("/super-admin/hospitals"),children:"Hospitals"}),s.jsx("button",{className:"action-link",onClick:()=>e("/admin/create-admin"),children:"Role Overrides"}),s.jsx("button",{className:"action-link",onClick:()=>e("/admin/audit-logs"),children:"Audit Logs"}),s.jsx("button",{className:"action-link",onClick:()=>e("/admin/notifications"),children:"Alerts"})]})]})]})}const Ad={domain:"INTEROP",resource:"transfer_export",action:"read",effect:"ALLOW",roles:"DOCTOR,HOSPITAL_ADMIN,SYSTEM_ADMIN,SUPER_ADMIN,DEVELOPER",priority:100,active:!0,requireActiveConsent:!0,requireSameHospitalOrPrivileged:!0,requiredScopes:""},qy=e=>`${String(e.domain||"").toUpperCase()}::${String(e.resource||"").toLowerCase()}::${String(e.action||"").toLowerCase()}::${String(e.effect||"ALLOW").toUpperCase()}::${Number(e.priority||100)}`;function rL(){var le,ye,je,Ae;const[e,t]=m.useState([]),[n,r]=m.useState(Ad),[i,a]=m.useState(null),[o,l]=m.useState(!1),[c,u]=m.useState(""),[d,p]=m.useState(!1),[h,f]=m.useState({domain:"INTEROP",resource:"transfer_export",action:"read",role:"DOCTOR",sameHospital:!1,hasActiveConsent:!1,sourceHospitalBypass:!1,allowedScopes:""}),[y,b]=m.useState(null),[E,g]=m.useState(!1),[x,w]=m.useState([]),[_,S]=m.useState(!1),[k,I]=m.useState(null),C=async()=>{l(!0);try{const[H,F]=await Promise.all([$y(),QP()]);t(Array.isArray(H)?H:[]),w(Array.isArray(F)?F:[])}catch(H){u((H==null?void 0:H.message)||"Failed to load ABAC policies"),t([]),w([])}finally{l(!1)}};m.useEffect(()=>{C()},[]);const L=()=>({domain:n.domain,resource:n.resource,action:n.action,effect:n.effect,roles:String(n.roles||"").split(",").map(H=>H.trim().toUpperCase()).filter(Boolean),priority:Number(n.priority||100),active:!!n.active,conditions:{requireActiveConsent:!!n.requireActiveConsent,requireSameHospitalOrPrivileged:!!n.requireSameHospitalOrPrivileged,requiredScopes:String(n.requiredScopes||"").split(",").map(H=>H.trim().toLowerCase()).filter(Boolean)}}),V=async()=>{u("");try{const H=L();i?(await Hy(i,H),u("ABAC policy updated")):(await Fy(H),u("ABAC policy created")),r(Ad),a(null),await C()}catch(H){u((H==null?void 0:H.message)||"Failed to save ABAC policy")}},B=H=>{var F,se,xe;a(H._id),r({domain:H.domain||"",resource:H.resource||"",action:H.action||"",effect:H.effect||"ALLOW",roles:Array.isArray(H.roles)?H.roles.join(","):"",priority:H.priority??100,active:H.active!==!1,requireActiveConsent:((F=H.conditions)==null?void 0:F.requireActiveConsent)===!0,requireSameHospitalOrPrivileged:((se=H.conditions)==null?void 0:se.requireSameHospitalOrPrivileged)===!0,requiredScopes:Array.isArray((xe=H.conditions)==null?void 0:xe.requiredScopes)?H.conditions.requiredScopes.join(","):""})},Y=async H=>{try{await KP(H),u("ABAC policy deleted"),await C()}catch(F){u((F==null?void 0:F.message)||"Failed to delete ABAC policy")}},W=()=>{const H=e.map(Ce=>({domain:Ce.domain,resource:Ce.resource,action:Ce.action,effect:Ce.effect,roles:Ce.roles||[],priority:Ce.priority??100,active:Ce.active!==!1,conditions:Ce.conditions||{}})),F=new Blob([JSON.stringify(H,null,2)],{type:"application/json"}),se=URL.createObjectURL(F),xe=document.createElement("a");xe.href=se,xe.download="abac-policies.json",xe.click(),URL.revokeObjectURL(se)},O=async H=>{var F,se,xe;if(H){p(!0),u("");try{const Ce=await H.text(),Pe=JSON.parse(Ce);if(!Array.isArray(Pe))throw new Error("JSON must be an array of policies");const Ge=await $y(),X=new Map(Ge.map(me=>[qy(me),me]));let he=0,ge=0;for(const me of Pe){const Ne={domain:String(me.domain||"").toUpperCase(),resource:String(me.resource||"").toLowerCase(),action:String(me.action||"").toLowerCase(),effect:String(me.effect||"ALLOW").toUpperCase(),roles:Array.isArray(me.roles)?me.roles.map(pt=>String(pt||"").toUpperCase()).filter(Boolean):[],priority:Number(me.priority||100),active:me.active!==!1,conditions:{requireActiveConsent:((F=me==null?void 0:me.conditions)==null?void 0:F.requireActiveConsent)===!0,requireSameHospitalOrPrivileged:((se=me==null?void 0:me.conditions)==null?void 0:se.requireSameHospitalOrPrivileged)===!0,requiredScopes:Array.isArray((xe=me==null?void 0:me.conditions)==null?void 0:xe.requiredScopes)?me.conditions.requiredScopes.map(pt=>String(pt||"").toLowerCase()).filter(Boolean):[]}},dt=X.get(qy(Ne));dt!=null&&dt._id?(await Hy(dt._id,Ne),ge+=1):(await Fy(Ne),he+=1)}u(`Import complete: ${he} created, ${ge} updated.`),await C()}catch(Ce){u((Ce==null?void 0:Ce.message)||"Failed to import ABAC policies")}finally{p(!1)}}},D=async()=>{g(!0),b(null),u("");try{const H={domain:h.domain,resource:h.resource,action:h.action,role:h.role,sameHospital:h.sameHospital,hasActiveConsent:h.hasActiveConsent,sourceHospitalBypass:h.sourceHospitalBypass,allowedScopes:String(h.allowedScopes||"").split(",").map(se=>se.trim().toLowerCase()).filter(Boolean)},F=await JP(H);b(F)}catch(H){u((H==null?void 0:H.message)||"Failed to run ABAC simulation")}finally{g(!1)}},Q=async()=>{u("");try{const H={name:`${h.domain}/${h.resource}/${h.action}/${h.role}`,input:{domain:h.domain,resource:h.resource,action:h.action,role:h.role,sameHospital:h.sameHospital,hasActiveConsent:h.hasActiveConsent,sourceHospitalBypass:h.sourceHospitalBypass,allowedScopes:String(h.allowedScopes||"").split(",").map(F=>F.trim().toLowerCase()).filter(Boolean)},expected:y!=null&&y.decision?{allowed:y.decision.allowed,reason:y.decision.reason||""}:{allowed:null,reason:""},active:!0};await ZP(H),u("Simulation saved as ABAC test case."),await C()}catch(H){u((H==null?void 0:H.message)||"Failed to save test case")}},ae=async H=>{var F;try{const se=await eL(H);u(`Test ${(se==null?void 0:se.name)||H}: ${se!=null&&se.passed?"PASSED":"FAILED"} (${((F=se==null?void 0:se.decision)==null?void 0:F.reason)||"n/a"})`),await C()}catch(se){u((se==null?void 0:se.message)||"Failed to run test case")}},U=async()=>{var H,F;S(!0),I(null),u("");try{const se=await tL();I((se==null?void 0:se.totals)||null),u(`ABAC test run complete: ${((H=se==null?void 0:se.totals)==null?void 0:H.passed)||0} passed, ${((F=se==null?void 0:se.totals)==null?void 0:F.failed)||0} failed.`),await C()}catch(se){u((se==null?void 0:se.message)||"Failed to run all test cases")}finally{S(!1)}},Z=async H=>{try{await XP(H),u("Test case deleted."),await C()}catch(F){u((F==null?void 0:F.message)||"Failed to delete test case")}};return s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"ABAC Policy Engine"}),s.jsx("p",{className:"muted",children:"Manage zero-trust attribute-based rules across domains."})]}),s.jsxs("div",{className:"welcome-actions",children:[s.jsx("button",{className:"btn-secondary",onClick:C,disabled:o,children:"Refresh"}),s.jsx("button",{className:"btn-secondary",onClick:W,disabled:o||d,children:"Export JSON"}),s.jsxs("label",{className:"btn-secondary",style:{cursor:"pointer"},children:[d?"Importing...":"Import JSON",s.jsx("input",{type:"file",accept:"application/json",style:{display:"none"},onChange:H=>{var F;return O((F=H.target.files)==null?void 0:F[0])},disabled:d})]})]})]}),c&&s.jsx("div",{className:"card",children:c}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:i?"Edit Policy":"Create Policy"}),s.jsxs("div",{className:"card",children:[s.jsxs("div",{className:"grid info-grid",children:[s.jsxs("label",{children:["Domain",s.jsx("input",{value:n.domain,onChange:H=>r(F=>({...F,domain:H.target.value.toUpperCase()}))})]}),s.jsxs("label",{children:["Resource",s.jsx("input",{value:n.resource,onChange:H=>r(F=>({...F,resource:H.target.value}))})]}),s.jsxs("label",{children:["Action",s.jsx("input",{value:n.action,onChange:H=>r(F=>({...F,action:H.target.value}))})]}),s.jsxs("label",{children:["Effect",s.jsxs("select",{value:n.effect,onChange:H=>r(F=>({...F,effect:H.target.value})),children:[s.jsx("option",{value:"ALLOW",children:"ALLOW"}),s.jsx("option",{value:"DENY",children:"DENY"})]})]}),s.jsxs("label",{children:["Roles (comma)",s.jsx("input",{value:n.roles,onChange:H=>r(F=>({...F,roles:H.target.value}))})]}),s.jsxs("label",{children:["Priority",s.jsx("input",{type:"number",value:n.priority,onChange:H=>r(F=>({...F,priority:H.target.value}))})]}),s.jsxs("label",{children:["Required Scopes (comma)",s.jsx("input",{value:n.requiredScopes,onChange:H=>r(F=>({...F,requiredScopes:H.target.value}))})]}),s.jsxs("label",{children:[s.jsx("input",{type:"checkbox",checked:n.active,onChange:H=>r(F=>({...F,active:H.target.checked}))})," Active"]}),s.jsxs("label",{children:[s.jsx("input",{type:"checkbox",checked:n.requireActiveConsent,onChange:H=>r(F=>({...F,requireActiveConsent:H.target.checked}))})," Require Active Consent"]}),s.jsxs("label",{children:[s.jsx("input",{type:"checkbox",checked:n.requireSameHospitalOrPrivileged,onChange:H=>r(F=>({...F,requireSameHospitalOrPrivileged:H.target.checked}))})," Require Same Hospital Or Privileged"]})]}),s.jsxs("div",{className:"welcome-actions",style:{marginTop:10},children:[s.jsx("button",{className:"btn-primary",onClick:V,children:i?"Update Policy":"Create Policy"}),s.jsx("button",{className:"btn-secondary",onClick:()=>{r(Ad),a(null)},children:"Reset"})]})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Policy List"}),s.jsx("div",{className:"card",children:s.jsxs("table",{className:"table lite",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Domain"}),s.jsx("th",{children:"Resource"}),s.jsx("th",{children:"Action"}),s.jsx("th",{children:"Effect"}),s.jsx("th",{children:"Priority"}),s.jsx("th",{children:"Active"}),s.jsx("th",{children:"Actions"})]})}),s.jsxs("tbody",{children:[e.map(H=>s.jsxs("tr",{children:[s.jsx("td",{children:H.domain}),s.jsx("td",{children:H.resource}),s.jsx("td",{children:H.action}),s.jsx("td",{children:H.effect}),s.jsx("td",{children:H.priority}),s.jsx("td",{children:H.active?"Yes":"No"}),s.jsxs("td",{children:[s.jsx("button",{className:"btn-secondary",onClick:()=>B(H),children:"Edit"}),s.jsx("button",{className:"btn-danger",onClick:()=>Y(H._id),children:"Delete"})]})]},H._id)),e.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:"7",children:"No ABAC policies defined"})})]})]})})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Policy Simulator"}),s.jsxs("div",{className:"card",children:[s.jsxs("div",{className:"grid info-grid",children:[s.jsxs("label",{children:["Domain",s.jsx("input",{value:h.domain,onChange:H=>f(F=>({...F,domain:H.target.value.toUpperCase()}))})]}),s.jsxs("label",{children:["Resource",s.jsx("input",{value:h.resource,onChange:H=>f(F=>({...F,resource:H.target.value}))})]}),s.jsxs("label",{children:["Action",s.jsx("input",{value:h.action,onChange:H=>f(F=>({...F,action:H.target.value}))})]}),s.jsxs("label",{children:["Role",s.jsx("input",{value:h.role,onChange:H=>f(F=>({...F,role:H.target.value.toUpperCase()}))})]}),s.jsxs("label",{children:["Allowed scopes (comma)",s.jsx("input",{value:h.allowedScopes,onChange:H=>f(F=>({...F,allowedScopes:H.target.value}))})]}),s.jsxs("label",{children:[s.jsx("input",{type:"checkbox",checked:h.sameHospital,onChange:H=>f(F=>({...F,sameHospital:H.target.checked}))})," Same hospital"]}),s.jsxs("label",{children:[s.jsx("input",{type:"checkbox",checked:h.hasActiveConsent,onChange:H=>f(F=>({...F,hasActiveConsent:H.target.checked}))})," Active consent"]}),s.jsxs("label",{children:[s.jsx("input",{type:"checkbox",checked:h.sourceHospitalBypass,onChange:H=>f(F=>({...F,sourceHospitalBypass:H.target.checked}))})," Source hospital bypass"]})]}),s.jsxs("div",{className:"welcome-actions",style:{marginTop:10},children:[s.jsx("button",{className:"btn-primary",onClick:D,disabled:E,children:E?"Simulating...":"Run Simulation"}),s.jsx("button",{className:"btn-secondary",onClick:Q,disabled:!h.domain||!h.resource||!h.action||!h.role,children:"Save as Test Case"})]}),y&&s.jsxs("div",{className:"card",style:{marginTop:12},children:[s.jsxs("p",{children:["Decision:"," ",s.jsx("strong",{style:{color:(le=y==null?void 0:y.decision)!=null&&le.allowed?"#127a4b":"#b42318"},children:(ye=y==null?void 0:y.decision)!=null&&ye.allowed?"ALLOW":"DENY"})," ","(",((je=y==null?void 0:y.decision)==null?void 0:je.reason)||"n/a",")"]}),s.jsxs("p",{className:"muted",children:["Matched Policy: ",((Ae=y==null?void 0:y.matchedPolicy)==null?void 0:Ae._id)||"None"]}),s.jsxs("details",{children:[s.jsxs("summary",{children:["Trace (",Array.isArray(y==null?void 0:y.trace)?y.trace.length:0,")"]}),s.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:JSON.stringify(y.trace||[],null,2)})]})]})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"ABAC Regression Test Cases"}),s.jsxs("div",{className:"card",children:[s.jsxs("div",{className:"welcome-actions",style:{marginBottom:10},children:[s.jsx("button",{className:"btn-primary",onClick:U,disabled:_,children:_?"Running All...":"Run All Active Tests"}),k&&s.jsxs("span",{className:"muted",children:["Total: ",k.active||0," | Passed: ",k.passed||0," | Failed:"," ",k.failed||0]})]}),s.jsxs("table",{className:"table lite",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Name"}),s.jsx("th",{children:"Input"}),s.jsx("th",{children:"Expected"}),s.jsx("th",{children:"Last Run"}),s.jsx("th",{children:"Actions"})]})}),s.jsxs("tbody",{children:[x.map(H=>{var F,se,xe,Ce,Pe,Ge,X;return s.jsxs("tr",{children:[s.jsx("td",{children:H.name}),s.jsxs("td",{children:[(F=H.input)==null?void 0:F.domain,"/",(se=H.input)==null?void 0:se.resource,"/",(xe=H.input)==null?void 0:xe.action,"/",(Ce=H.input)==null?void 0:Ce.role]}),s.jsx("td",{children:typeof((Pe=H.expected)==null?void 0:Pe.allowed)=="boolean"?`${H.expected.allowed?"ALLOW":"DENY"}${(Ge=H.expected)!=null&&Ge.reason?` (${H.expected.reason})`:""}`:"Any"}),s.jsx("td",{children:H.lastRunAt?`${new Date(H.lastRunAt).toLocaleString()} - ${(X=H.lastRun)!=null&&X.passed?"PASS":"FAIL"}`:"Not run"}),s.jsxs("td",{children:[s.jsx("button",{className:"btn-secondary",onClick:()=>ae(H._id),children:"Run"}),s.jsx("button",{className:"btn-danger",onClick:()=>Z(H._id),children:"Delete"})]})]},H._id)}),x.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:"5",children:"No ABAC test cases yet."})})]})]})]})]})]})}const sL=async()=>oe("/api/mapping"),iL=async e=>oe("/api/mapping",{method:"POST",body:e}),aL=async(e,t)=>oe(`/api/mapping/${e}`,{method:"PUT",body:t}),oL=async e=>oe(`/api/mapping/${e}`,{method:"DELETE"}),lL=async()=>oe("/api/mapping/catalog/templates"),cL=async e=>oe("/api/mapping/preview",{method:"POST",body:e}),uL=async e=>oe("/api/mapping/sign",{method:"POST",body:e}),dL=async e=>oe("/api/mapping/verify",{method:"POST",body:e}),Cd={messageType:"ORM^O01",sourceSystem:"LIS",targetSystem:"EMR",mappingJson:JSON.stringify({"PID-5":"patient.name","PID-7":"patient.dateOfBirth","OBR-4":"order.testCode"},null,2)};function hL(){const[e,t]=m.useState([]),[n,r]=m.useState([]),[i,a]=m.useState(Cd),[o,l]=m.useState(null),[c,u]=m.useState("HL7"),[d,p]=m.useState(`MSH|^~\\&|LIS|HOSP|EMR|HOSP|20260220||ORM^O01|123|P|2.3
PID|1||P001||Jane Doe||1988-02-02
OBR|1|||CBC^Panel`),[h,f]=m.useState(""),[y,b]=m.useState(null),[E,g]=m.useState(""),[x,w]=m.useState(""),[_,S]=m.useState(null),[k,I]=m.useState(""),[C,L]=m.useState(!1),V=m.useMemo(()=>{try{return JSON.parse(i.mappingJson||"{}")}catch{return null}},[i.mappingJson]),B=async()=>{L(!0),I("");try{const[U,Z]=await Promise.all([sL(),lL()]);t(Array.isArray(U)?U:[]),r(Array.isArray(Z==null?void 0:Z.templates)?Z.templates:[])}catch(U){I((U==null?void 0:U.message)||"Failed to load mapping studio"),t([]),r([])}finally{L(!1)}};m.useEffect(()=>{B()},[]);const Y=async()=>{if(I(""),!V){I("Mapping JSON is invalid.");return}try{const U={messageType:i.messageType,sourceSystem:i.sourceSystem,targetSystem:i.targetSystem,mapping:V};o?(await aL(o,U),I("Mapping updated.")):(await iL(U),I("Mapping created.")),a(Cd),l(null),await B()}catch(U){I((U==null?void 0:U.message)||"Failed to save mapping")}},W=U=>{l(U._id),a({messageType:U.messageType||"",sourceSystem:U.sourceSystem||"",targetSystem:U.targetSystem||"",mappingJson:JSON.stringify(U.mapping||{},null,2)})},O=async U=>{I("");try{await oL(U),I("Mapping deleted."),await B()}catch(Z){I((Z==null?void 0:Z.message)||"Failed to delete mapping")}},D=async()=>{var U;I(""),b(null);try{const Z={format:c,payload:c==="FHIR"?JSON.parse(d||"{}"):d,...h?{mappingId:h}:{mapping:V||{}}},le=await cL(Z);b(le||null),(U=le==null?void 0:le.provenance)!=null&&U.signature&&w(le.provenance.signature)}catch(Z){I((Z==null?void 0:Z.message)||"Preview failed")}},Q=async()=>{var U;I("");try{const Z=JSON.parse(E||"{}"),le=await uL({payload:Z,context:{module:"mapping_studio_ui"}});w(((U=le==null?void 0:le.signature)==null?void 0:U.signature)||""),I("Payload signed.")}catch(Z){I((Z==null?void 0:Z.message)||"Sign failed")}},ae=async()=>{I(""),S(null);try{const U=JSON.parse(E||"{}"),Z=await dL({payload:U,signature:x});S((Z==null?void 0:Z.verification)||null)}catch(U){I((U==null?void 0:U.message)||"Verify failed")}};return s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"FHIR/HL7 Transformation Studio"}),s.jsx("p",{className:"muted",children:"Create mappings, preview transformations, and verify signed provenance."})]}),s.jsx("div",{className:"welcome-actions",children:s.jsx("button",{className:"btn-secondary",onClick:B,disabled:C,children:"Refresh"})})]}),k&&s.jsx("div",{className:"card",children:k}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:o?"Edit Mapping":"Create Mapping"}),s.jsxs("div",{className:"card",children:[s.jsxs("div",{className:"grid info-grid",children:[s.jsxs("label",{children:["Message Type",s.jsx("input",{value:i.messageType,onChange:U=>a(Z=>({...Z,messageType:U.target.value}))})]}),s.jsxs("label",{children:["Source System",s.jsx("input",{value:i.sourceSystem,onChange:U=>a(Z=>({...Z,sourceSystem:U.target.value}))})]}),s.jsxs("label",{children:["Target System",s.jsx("input",{value:i.targetSystem,onChange:U=>a(Z=>({...Z,targetSystem:U.target.value}))})]})]}),s.jsxs("label",{children:["Mapping JSON",s.jsx("textarea",{rows:10,value:i.mappingJson,onChange:U=>a(Z=>({...Z,mappingJson:U.target.value}))})]}),s.jsxs("div",{className:"welcome-actions",style:{marginTop:10},children:[s.jsx("button",{className:"btn-primary",onClick:Y,children:o?"Update Mapping":"Save Mapping"}),s.jsx("button",{className:"btn-secondary",onClick:()=>{a(Cd),l(null)},children:"Reset"})]})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Preview + Provenance"}),s.jsxs("div",{className:"card",children:[s.jsxs("div",{className:"grid info-grid",children:[s.jsxs("label",{children:["Format",s.jsxs("select",{value:c,onChange:U=>u(U.target.value),children:[s.jsx("option",{value:"HL7",children:"HL7"}),s.jsx("option",{value:"FHIR",children:"FHIR"})]})]}),s.jsxs("label",{children:["Use saved mapping",s.jsxs("select",{value:h,onChange:U=>f(U.target.value),children:[s.jsx("option",{value:"",children:"Current editor mapping"}),e.map(U=>s.jsxs("option",{value:U._id,children:[U.messageType," / ",U.sourceSystem,"  ",U.targetSystem]},U._id))]})]})]}),s.jsxs("label",{children:["Source payload (",c,")",s.jsx("textarea",{rows:8,value:d,onChange:U=>p(U.target.value)})]}),s.jsx("div",{className:"welcome-actions",style:{marginTop:10},children:s.jsx("button",{className:"btn-primary",onClick:D,children:"Preview Transform"})}),y&&s.jsxs("details",{style:{marginTop:10},open:!0,children:[s.jsx("summary",{children:"Preview Result"}),s.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:JSON.stringify(y,null,2)})]})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Signature Tools"}),s.jsxs("div",{className:"card",children:[s.jsxs("label",{children:["Payload JSON",s.jsx("textarea",{rows:6,value:E,onChange:U=>g(U.target.value)})]}),s.jsxs("label",{children:["Signature",s.jsx("input",{value:x,onChange:U=>w(U.target.value)})]}),s.jsxs("div",{className:"welcome-actions",style:{marginTop:10},children:[s.jsx("button",{className:"btn-secondary",onClick:Q,children:"Sign Payload"}),s.jsx("button",{className:"btn-secondary",onClick:ae,children:"Verify Signature"})]}),_&&s.jsxs("div",{className:"card",style:{marginTop:10},children:["Verification: ",s.jsx("strong",{children:_.valid?"VALID":"INVALID"})," (",_.reason,")"]})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Saved Mappings"}),s.jsx("div",{className:"card",children:s.jsxs("table",{className:"table lite",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Type"}),s.jsx("th",{children:"Source"}),s.jsx("th",{children:"Target"}),s.jsx("th",{children:"Actions"})]})}),s.jsxs("tbody",{children:[e.map(U=>s.jsxs("tr",{children:[s.jsx("td",{children:U.messageType}),s.jsx("td",{children:U.sourceSystem}),s.jsx("td",{children:U.targetSystem}),s.jsxs("td",{children:[s.jsx("button",{className:"btn-secondary",onClick:()=>W(U),children:"Edit"}),s.jsx("button",{className:"btn-danger",onClick:()=>O(U._id),children:"Delete"})]})]},U._id)),e.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:"4",children:"No mappings found."})})]})]})})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Template Catalog"}),s.jsxs("div",{className:"panel-grid",children:[n.map(U=>s.jsxs("div",{className:"card",children:[s.jsx("strong",{children:U.title}),s.jsx("p",{className:"muted",children:U.format}),s.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:JSON.stringify(U.mapping,null,2)})]},U.id)),n.length===0&&s.jsx("div",{className:"card muted",children:"No templates."})]})]})]})}const fL=async e=>oe("/api/analytics/nlp/query",{method:"POST",body:{query:e}}),pL=async()=>oe("/api/reports/regulatory/auto");function mL(){const[e,t]=m.useState("Show pending approvals this week"),[n,r]=m.useState(null),[i,a]=m.useState(""),[o,l]=m.useState(!1),c=async()=>{l(!0),a(""),r(null);try{const u=await fL(e);r(u||null)}catch(u){a((u==null?void 0:u.message)||"Failed to run NLP analytics query")}finally{l(!1)}};return s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"NLP Analytics"}),s.jsx("p",{className:"muted",children:"Ask analytics questions in natural language and get actionable metrics."})]}),s.jsx("div",{className:"welcome-actions",children:s.jsx("button",{className:"btn-primary",onClick:c,disabled:o,children:o?"Running...":"Run Query"})})]}),i&&s.jsx("div",{className:"card",children:i}),s.jsx("section",{className:"section",children:s.jsxs("div",{className:"card",children:[s.jsxs("label",{children:["Query",s.jsx("input",{value:e,onChange:u=>t(u.target.value),placeholder:"e.g. show revenue for last 30 days"})]}),s.jsxs("div",{className:"welcome-actions",style:{marginTop:10},children:[s.jsx("button",{className:"btn-secondary",onClick:()=>t("Show revenue this month"),children:"Revenue"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("Show active staff"),children:"Staff"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("Show pending approvals"),children:"Approvals"})]})]})}),n&&s.jsx("section",{className:"section",children:s.jsxs("div",{className:"card",children:[s.jsx("h3",{children:"Interpretation"}),s.jsx("p",{children:n.interpretation}),s.jsx("h3",{children:"Metrics"}),s.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:JSON.stringify(n.metrics,null,2)}),s.jsx("h3",{children:"Suggested Follow-ups"}),s.jsx("ul",{children:(n.suggestedFollowUps||[]).map((u,d)=>s.jsx("li",{children:u},`s-${d}`))})]})})]})}function gL(){var l,c,u,d,p;const[e,t]=m.useState(null),[n,r]=m.useState(""),[i,a]=m.useState(!1),o=async()=>{a(!0),r("");try{const h=await pL();t((h==null?void 0:h.report)||null)}catch(h){r((h==null?void 0:h.message)||"Failed to generate regulatory auto report"),t(null)}finally{a(!1)}};return s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"Regulatory Auto Report"}),s.jsx("p",{className:"muted",children:"Generated compliance snapshot for workforce, approvals, and security events."})]}),s.jsx("div",{className:"welcome-actions",children:s.jsx("button",{className:"btn-primary",onClick:o,disabled:i,children:i?"Generating...":"Generate Report"})})]}),n&&s.jsx("div",{className:"card",children:n}),e&&s.jsxs(s.Fragment,{children:[s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Summary"}),s.jsxs("div",{className:"grid info-grid",children:[s.jsx(te,{title:"Staff Total",value:((l=e==null?void 0:e.workforce)==null?void 0:l.staffTotal)??""}),s.jsx(te,{title:"Inactive Staff",value:((c=e==null?void 0:e.workforce)==null?void 0:c.inactiveStaff)??""}),s.jsx(te,{title:"Pending Approvals",value:((u=e==null?void 0:e.approvals)==null?void 0:u.total)??""}),s.jsx(te,{title:"Export Events (30d)",value:((d=e==null?void 0:e.compliance)==null?void 0:d.exportEvents)??""}),s.jsx(te,{title:"ABAC Denials (30d)",value:((p=e==null?void 0:e.compliance)==null?void 0:p.abacDeniedEvents)??""})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Flags"}),s.jsxs("div",{className:"panel-grid",children:[(e.flags||[]).map(h=>s.jsx("div",{className:"card",children:h},h)),(e.flags||[]).length===0&&s.jsx("div",{className:"card muted",children:"No critical flags."})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Raw Report"}),s.jsx("div",{className:"card",children:s.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:JSON.stringify(e,null,2)})})]})]})]})}function yL(){const[e,t]=m.useState(""),[n,r]=m.useState(""),[i,a]=m.useState({beds:220,occupancyRate:.78,avgPatientsPerDoctor:14,avgPatientsPerNurse:5,horizonDays:14}),[o,l]=m.useState(null),[c,u]=m.useState({hoursPerWeek:52,nightShifts:6,consecutiveDays:7,overtimeHours:12,leaveBalanceDays:8,incidentsIn30d:1}),[d,p]=m.useState(null),[h,f]=m.useState({baseline:100,interventionsJson:JSON.stringify([{name:"Add ICU nurses",effectPct:8,confidence:.7},{name:"Shift rebalancing",effectPct:5,confidence:.8}],null,2)}),[y,b]=m.useState(null),[E,g]=m.useState({departmentsJson:JSON.stringify([{name:"ICU",staff:18,demand:24,absenteeismRate:.08},{name:"Emergency",staff:26,demand:30,absenteeismRate:.05},{name:"Pediatrics",staff:15,demand:12,absenteeismRate:.03}],null,2)}),[x,w]=m.useState(null),_=async()=>{r("forecast"),t("");try{const C=await Hp(i);l(C||null)}catch(C){t((C==null?void 0:C.message)||"Failed to run staffing forecast")}finally{r("")}},S=async()=>{r("burnout"),t("");try{const C=await qp(c);p(C||null)}catch(C){t((C==null?void 0:C.message)||"Failed to run burnout scoring")}finally{r("")}},k=async()=>{r("causal"),t("");try{const C=JSON.parse(h.interventionsJson||"[]"),L=await H0({baseline:Number(h.baseline||0),interventions:C});b(L||null)}catch(C){t((C==null?void 0:C.message)||"Failed to run causal impact")}finally{r("")}},I=async()=>{r("twin"),t("");try{const C=JSON.parse(E.departmentsJson||"[]"),L=await q0({departments:C});w(L||null)}catch(C){t((C==null?void 0:C.message)||"Failed to run digital twin simulation")}finally{r("")}};return s.jsxs("div",{className:"dashboard",children:[s.jsx("div",{className:"welcome-panel",children:s.jsxs("div",{children:[s.jsx("h2",{children:"Clinical Intelligence Lab"}),s.jsx("p",{className:"muted",children:"AI staffing planner, burnout risk scoring, causal impact simulation, and hospital digital twin."})]})}),e&&s.jsx("div",{className:"card",children:e}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Staffing Forecast"}),s.jsxs("div",{className:"card",children:[s.jsxs("div",{className:"grid info-grid",children:[s.jsxs("label",{children:["Beds",s.jsx("input",{type:"number",value:i.beds,onChange:C=>a(L=>({...L,beds:Number(C.target.value||0)}))})]}),s.jsxs("label",{children:["Occupancy Rate",s.jsx("input",{type:"number",step:"0.01",value:i.occupancyRate,onChange:C=>a(L=>({...L,occupancyRate:Number(C.target.value||0)}))})]}),s.jsxs("label",{children:["Patients/Doctor",s.jsx("input",{type:"number",value:i.avgPatientsPerDoctor,onChange:C=>a(L=>({...L,avgPatientsPerDoctor:Number(C.target.value||1)}))})]}),s.jsxs("label",{children:["Patients/Nurse",s.jsx("input",{type:"number",value:i.avgPatientsPerNurse,onChange:C=>a(L=>({...L,avgPatientsPerNurse:Number(C.target.value||1)}))})]}),s.jsxs("label",{children:["Horizon Days",s.jsx("input",{type:"number",value:i.horizonDays,onChange:C=>a(L=>({...L,horizonDays:Number(C.target.value||1)}))})]})]}),s.jsx("div",{className:"welcome-actions",style:{marginTop:10},children:s.jsx("button",{className:"btn-primary",onClick:_,disabled:n==="forecast",children:n==="forecast"?"Running...":"Run Staffing Forecast"})}),o&&s.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:JSON.stringify(o,null,2)})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Burnout Risk Scoring"}),s.jsxs("div",{className:"card",children:[s.jsxs("div",{className:"grid info-grid",children:[s.jsxs("label",{children:["Hours/Week",s.jsx("input",{type:"number",value:c.hoursPerWeek,onChange:C=>u(L=>({...L,hoursPerWeek:Number(C.target.value||0)}))})]}),s.jsxs("label",{children:["Night Shifts",s.jsx("input",{type:"number",value:c.nightShifts,onChange:C=>u(L=>({...L,nightShifts:Number(C.target.value||0)}))})]}),s.jsxs("label",{children:["Consecutive Days",s.jsx("input",{type:"number",value:c.consecutiveDays,onChange:C=>u(L=>({...L,consecutiveDays:Number(C.target.value||0)}))})]}),s.jsxs("label",{children:["Overtime Hours",s.jsx("input",{type:"number",value:c.overtimeHours,onChange:C=>u(L=>({...L,overtimeHours:Number(C.target.value||0)}))})]}),s.jsxs("label",{children:["Leave Balance",s.jsx("input",{type:"number",value:c.leaveBalanceDays,onChange:C=>u(L=>({...L,leaveBalanceDays:Number(C.target.value||0)}))})]}),s.jsxs("label",{children:["Incidents 30d",s.jsx("input",{type:"number",value:c.incidentsIn30d,onChange:C=>u(L=>({...L,incidentsIn30d:Number(C.target.value||0)}))})]})]}),s.jsx("div",{className:"welcome-actions",style:{marginTop:10},children:s.jsx("button",{className:"btn-primary",onClick:S,disabled:n==="burnout",children:n==="burnout"?"Running...":"Run Burnout Scoring"})}),d&&s.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:JSON.stringify(d,null,2)})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Causal Impact Simulation"}),s.jsxs("div",{className:"card",children:[s.jsxs("label",{children:["Baseline Metric",s.jsx("input",{type:"number",value:h.baseline,onChange:C=>f(L=>({...L,baseline:Number(C.target.value||0)}))})]}),s.jsxs("label",{children:["Interventions JSON",s.jsx("textarea",{rows:7,value:h.interventionsJson,onChange:C=>f(L=>({...L,interventionsJson:C.target.value}))})]}),s.jsx("div",{className:"welcome-actions",style:{marginTop:10},children:s.jsx("button",{className:"btn-primary",onClick:k,disabled:n==="causal",children:n==="causal"?"Running...":"Run Causal Simulation"})}),y&&s.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:JSON.stringify(y,null,2)})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Digital Twin Simulation"}),s.jsxs("div",{className:"card",children:[s.jsxs("label",{children:["Departments JSON",s.jsx("textarea",{rows:8,value:E.departmentsJson,onChange:C=>g(L=>({...L,departmentsJson:C.target.value}))})]}),s.jsx("div",{className:"welcome-actions",style:{marginTop:10},children:s.jsx("button",{className:"btn-primary",onClick:I,disabled:n==="twin",children:n==="twin"?"Running...":"Run Digital Twin"})}),x&&s.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:JSON.stringify(x,null,2)})]})]})]})}const Ya="my_requests_query_cache_v1",vL=15*60*1e3;function xL(){const{user:e}=Me(),t=Oe(),[n,r]=m.useState(!1),[i,a]=m.useState(null),[o,l]=m.useState([]),[c,u]=m.useState([]),[d,p]=m.useState([]),[h,f]=m.useState(null),[y,b]=m.useState(null),[E,g]=m.useState(null),[x,w]=m.useState(!1),[_,S]=m.useState(!1),[k,I]=m.useState(!1),[C,L]=m.useState("ALL"),[V,B]=m.useState(!1),[Y,W]=m.useState("Live  now"),O=m.useRef(!1),[D,Q]=m.useState({type:"Annual",startDate:"",endDate:"",reason:""}),[ae,U]=m.useState({hours:"",date:"",reason:""}),[Z,le]=m.useState({shiftType:"Day",date:"",reason:""}),ye=`${(e==null?void 0:e.role)||"UNKNOWN"}:${(e==null?void 0:e._id)||(e==null?void 0:e.id)||(e==null?void 0:e.email)||"anon"}`,je=X=>Array.isArray(X)?{items:X,nextCursor:null,hasMore:!1}:{items:Array.isArray(X==null?void 0:X.items)?X.items:[],nextCursor:(X==null?void 0:X.nextCursor)||null,hasMore:!!(X!=null&&X.hasMore)},Ae=async(X="ALL",{append:he=!1}={})=>{var ge,me;r(!0),a(null);try{const Ne=X!=="ALL"?X:void 0,dt=!he||x&&!!h,pt=!he||_&&!!y,Te=!he||k&&!!E,[we,ce,ve]=await Promise.all([dt?uP(Ne,{limit:25,cursorMode:!0,cursor:he?h:void 0}):Promise.resolve(null),pt?pP(Ne,{limit:25,cursorMode:!0,cursor:he?y:void 0}):Promise.resolve(null),Te?vP(Ne,{limit:25,cursorMode:!0,cursor:he?E:void 0}):Promise.resolve(null)]),fe=dt?je(we.data):{items:[],nextCursor:null,hasMore:!1},_e=pt?je(ce.data):{items:[],nextCursor:null,hasMore:!1},be=Te?je(ve.data):{items:[],nextCursor:null,hasMore:!1};he?(dt?(l(Ve=>[...Ve,...fe.items]),f(fe.nextCursor),w(fe.hasMore)):w(!1),pt?(u(Ve=>[...Ve,..._e.items]),b(_e.nextCursor),S(_e.hasMore)):S(!1),Te?(p(Ve=>[...Ve,...be.items]),g(be.nextCursor),I(be.hasMore)):I(!1)):(l(fe.items),u(_e.items),p(be.items),f(fe.nextCursor),b(_e.nextCursor),g(be.nextCursor),w(fe.hasMore),S(_e.hasMore),I(be.hasMore),W("Live  now"))}catch(Ne){a(((me=(ge=Ne.response)==null?void 0:ge.data)==null?void 0:me.message)||"Failed to load requests")}finally{r(!1)}};m.useEffect(()=>{try{const X=localStorage.getItem(Ya);if(!X){W("Live  now"),B(!0);return}const he=JSON.parse(X),ge=he==null?void 0:he[ye];if(!ge||typeof ge!="object"){W("Live  now"),B(!0);return}const me=Date.now()-new Date(ge.updatedAt||0).getTime();if(!Number.isFinite(me)||me<0||me>vL){W("Live  now"),B(!0);return}const Ne=Math.max(0,Math.floor(me/6e4));ge.statusFilter&&L(ge.statusFilter),Array.isArray(ge.leave)&&l(ge.leave),Array.isArray(ge.overtime)&&u(ge.overtime),Array.isArray(ge.shifts)&&p(ge.shifts),(typeof ge.leaveCursor=="string"||ge.leaveCursor===null)&&f(ge.leaveCursor),(typeof ge.overtimeCursor=="string"||ge.overtimeCursor===null)&&b(ge.overtimeCursor),(typeof ge.shiftCursor=="string"||ge.shiftCursor===null)&&g(ge.shiftCursor),typeof ge.hasMoreLeave=="boolean"&&w(ge.hasMoreLeave),typeof ge.hasMoreOvertime=="boolean"&&S(ge.hasMoreOvertime),typeof ge.hasMoreShift=="boolean"&&I(ge.hasMoreShift),W(`Cached  ${Ne}m ago`),O.current=!0}catch{}finally{B(!0)}},[ye]),m.useEffect(()=>{if(V){if(O.current){O.current=!1;return}Ae(C,{append:!1})}},[V,C]),m.useEffect(()=>{const X=window.location.hash;if(!X)return;const he=document.getElementById(X.replace("#",""));he&&setTimeout(()=>he.scrollIntoView({behavior:"smooth"}),150)},[]),m.useEffect(()=>{if(V)try{const X=localStorage.getItem(Ya),he=X?JSON.parse(X):{};he[ye]={statusFilter:C,leave:o,overtime:c,shifts:d,leaveCursor:h,overtimeCursor:y,shiftCursor:E,hasMoreLeave:x,hasMoreOvertime:_,hasMoreShift:k,updatedAt:new Date().toISOString()},localStorage.setItem(Ya,JSON.stringify(he))}catch{}},[V,ye,C,o,c,d,h,y,E,x,_,k]);const H=m.useMemo(()=>[...o.map(he=>({...he,kind:"Leave"})),...c.map(he=>({...he,kind:"Overtime"})),...d.map(he=>({...he,kind:"Shift"}))].sort((he,ge)=>new Date(ge.createdAt)-new Date(he.createdAt)),[o,c,d]),F=async X=>{var he,ge;X.preventDefault(),r(!0),a(null);try{await dP({type:D.type,startDate:D.startDate,endDate:D.endDate,reason:D.reason}),Q({type:"Annual",startDate:"",endDate:"",reason:""}),await Ae(C,{append:!1}),a(" Leave request submitted")}catch(me){a(((ge=(he=me.response)==null?void 0:he.data)==null?void 0:ge.message)||"Failed to submit leave request")}finally{r(!1)}},se=async X=>{var he,ge;X.preventDefault(),r(!0),a(null);try{await mP({hours:Number(ae.hours),date:ae.date,reason:ae.reason}),U({hours:"",date:"",reason:""}),await Ae(C,{append:!1}),a(" Overtime request submitted")}catch(me){a(((ge=(he=me.response)==null?void 0:he.data)==null?void 0:ge.message)||"Failed to submit overtime request")}finally{r(!1)}},xe=async X=>{var he,ge;X.preventDefault(),r(!0),a(null);try{await xP({shiftType:Z.shiftType,date:Z.date,reason:Z.reason}),le({shiftType:"Day",date:"",reason:""}),await Ae(C,{append:!1}),a(" Shift request submitted")}catch(me){a(((ge=(he=me.response)==null?void 0:he.data)==null?void 0:ge.message)||"Failed to submit shift request")}finally{r(!1)}},Ce=H.filter(X=>C==="ALL"?!0:X.status===C),Pe=()=>{const he=[["Type","Category","Status","Requested","Details"],...Ce.map(Ne=>[Ne.kind,Ne.type||Ne.shiftType||`${Ne.hours} hrs`,Ne.status,Ne.createdAt?new Date(Ne.createdAt).toLocaleDateString():"-",Ne.reason||""])].map(Ne=>Ne.map(dt=>`"${String(dt).replace(/"/g,'""')}"`).join(",")).join(`
`),ge=new Blob([he],{type:"text/csv"}),me=document.createElement("a");me.href=URL.createObjectURL(ge),me.download="my-requests.csv",me.click()},Ge=async()=>{try{const X=localStorage.getItem(Ya),he=X?JSON.parse(X):{};delete he[ye],localStorage.setItem(Ya,JSON.stringify(he))}catch{}L("ALL"),l([]),u([]),p([]),f(null),b(null),g(null),w(!1),S(!1),I(!1),await Ae("ALL",{append:!1}),W("Live  now"),a("View reset and reloaded from server")};return s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"My Requests"}),s.jsx("p",{className:"muted",children:"Submit leave, overtime, or shift requests and track approvals."})]}),s.jsxs("div",{className:"welcome-actions",children:[s.jsx("button",{className:"btn-secondary",onClick:()=>Ae(C,{append:!1}),disabled:n,children:"Refresh"}),s.jsx("button",{className:"btn-secondary",onClick:Ge,disabled:n,children:"Reset View"}),s.jsx("span",{className:"muted",children:Y}),((e==null?void 0:e.role)==="HOSPITAL_ADMIN"||(e==null?void 0:e.role)==="SUPER_ADMIN")&&s.jsx("button",{className:"btn-primary",onClick:()=>t("/hospital-admin/approvals"),children:"View Approvals"})]})]}),i&&s.jsx("div",{className:"card",children:i}),s.jsxs("section",{className:"section",id:"leave",children:[s.jsx("h3",{children:"Leave Request"}),s.jsxs("form",{className:"card form",onSubmit:F,children:[s.jsxs("select",{value:D.type,onChange:X=>Q({...D,type:X.target.value}),children:[s.jsx("option",{value:"Annual",children:"Annual"}),s.jsx("option",{value:"Sick",children:"Sick"}),s.jsx("option",{value:"Study",children:"Study"}),s.jsx("option",{value:"Maternity",children:"Maternity"}),s.jsx("option",{value:"Paternity",children:"Paternity"}),s.jsx("option",{value:"Compassionate",children:"Compassionate"})]}),s.jsx("input",{type:"date",value:D.startDate,onChange:X=>Q({...D,startDate:X.target.value}),required:!0}),s.jsx("input",{type:"date",value:D.endDate,onChange:X=>Q({...D,endDate:X.target.value}),required:!0}),s.jsx("input",{placeholder:"Reason (optional)",value:D.reason,onChange:X=>Q({...D,reason:X.target.value})}),s.jsx("button",{disabled:n,children:n?"Submitting...":"Submit Leave"})]})]}),s.jsxs("section",{className:"section",id:"overtime",children:[s.jsx("h3",{children:"Overtime Request"}),s.jsxs("form",{className:"card form",onSubmit:se,children:[s.jsx("input",{type:"number",min:"1",placeholder:"Hours",value:ae.hours,onChange:X=>U({...ae,hours:X.target.value}),required:!0}),s.jsx("input",{type:"date",value:ae.date,onChange:X=>U({...ae,date:X.target.value}),required:!0}),s.jsx("input",{placeholder:"Reason (optional)",value:ae.reason,onChange:X=>U({...ae,reason:X.target.value})}),s.jsx("button",{disabled:n,children:n?"Submitting...":"Submit Overtime"})]})]}),s.jsxs("section",{className:"section",id:"shift",children:[s.jsx("h3",{children:"Shift Request"}),s.jsxs("form",{className:"card form",onSubmit:xe,children:[s.jsxs("select",{value:Z.shiftType,onChange:X=>le({...Z,shiftType:X.target.value}),children:[s.jsx("option",{value:"Day",children:"Day Shift"}),s.jsx("option",{value:"Night",children:"Night Shift"}),s.jsx("option",{value:"On-Call",children:"On-Call"}),s.jsx("option",{value:"Weekend",children:"Weekend"})]}),s.jsx("input",{type:"date",value:Z.date,onChange:X=>le({...Z,date:X.target.value}),required:!0}),s.jsx("input",{placeholder:"Reason (optional)",value:Z.reason,onChange:X=>le({...Z,reason:X.target.value})}),s.jsx("button",{disabled:n,children:n?"Submitting...":"Submit Shift"})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"My Recent Requests"}),s.jsxs("div",{className:"card",children:[s.jsxs("div",{className:"action-list",style:{marginBottom:12},children:[s.jsxs("select",{value:C,onChange:X=>L(X.target.value),children:[s.jsx("option",{value:"ALL",children:"All Statuses"}),s.jsx("option",{value:"PENDING",children:"Pending"}),s.jsx("option",{value:"APPROVED",children:"Approved"}),s.jsx("option",{value:"REJECTED",children:"Rejected"})]}),s.jsx("button",{className:"btn-secondary",onClick:Pe,children:"Export CSV"})]}),s.jsxs("table",{className:"table lite",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Type"}),s.jsx("th",{children:"Category"}),s.jsx("th",{children:"Status"}),s.jsx("th",{children:"Requested"}),s.jsx("th",{children:"Details"})]})}),s.jsxs("tbody",{children:[Ce.map(X=>s.jsxs("tr",{children:[s.jsx("td",{children:X.kind}),s.jsx("td",{children:X.type||X.shiftType||`${X.hours} hrs`}),s.jsx("td",{children:X.status}),s.jsx("td",{children:X.createdAt?new Date(X.createdAt).toLocaleDateString():"-"}),s.jsx("td",{children:X.reason||"-"})]},X._id)),Ce.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:"5",children:"No requests yet"})})]})]}),(x||_||k)&&s.jsx("div",{style:{marginTop:12},children:s.jsx("button",{className:"btn-secondary",disabled:n,onClick:()=>Ae(C,{append:!0}),children:n?"Loading...":"Load more"})})]})]})]})}const K0=async()=>(await ue.get("/api/integrations/dlq-inspect")).data,cf=async e=>(await ue.post(`/api/integrations/dlq/${e}/retry`)).data,jL=async(e,t)=>(await ue.put(`/api/integrations/dlq-inspect/${e}`,{data:t})).data;function bL(){const[e,t]=m.useState([]),[n,r]=m.useState(!1),[i,a]=m.useState(null),[o,l]=m.useState(null),[c,u]=m.useState(""),d=async()=>{r(!0),a(null);try{const f=await K0();t(Array.isArray(f)?f:[])}catch{t([]),a("Failed to load DLQ items")}finally{r(!1)}};m.useEffect(()=>{d()},[]);const p=f=>{l(f),u(JSON.stringify(f.data||{},null,2))},h=async(f=!1)=>{if(o)try{const y=JSON.parse(c);await jL(o.id,y),f&&await cf(o.id),a(" Payload updated"),l(null),d()}catch{a("Invalid JSON payload")}};return s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"Queue Replay"}),s.jsx("p",{className:"muted",children:"Inspect deadletter queue entries and replay them into the integration queue."})]}),s.jsx("div",{className:"welcome-actions",children:s.jsx("button",{className:"btn-secondary",onClick:d,disabled:n,children:"Refresh"})})]}),i&&s.jsx("div",{className:"card",children:i}),s.jsx("section",{className:"section",children:s.jsx("div",{className:"card",children:s.jsxs("table",{className:"table lite",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"ID"}),s.jsx("th",{children:"Reason"}),s.jsx("th",{children:"Attempts"}),s.jsx("th",{children:"Queued"}),s.jsx("th",{children:"Actions"})]})}),s.jsxs("tbody",{children:[e.map(f=>s.jsxs("tr",{children:[s.jsx("td",{children:f.id}),s.jsx("td",{children:f.failedReason||"-"}),s.jsx("td",{children:f.attemptsMade||0}),s.jsx("td",{children:f.timestamp?new Date(f.timestamp).toLocaleString():"-"}),s.jsxs("td",{children:[s.jsx("button",{className:"btn-secondary",onClick:async()=>{await cf(f.id),d()},children:"Replay"}),s.jsx("button",{className:"btn-secondary",onClick:()=>p(f),children:"Edit"})]})]},f.id)),e.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:"5",children:"No DLQ items"})})]})]})})}),o&&s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Edit Payload"}),s.jsxs("div",{className:"card",children:[s.jsx("textarea",{rows:12,style:{width:"100%"},value:c,onChange:f=>u(f.target.value)}),s.jsxs("div",{className:"action-list",style:{marginTop:12},children:[s.jsx("button",{className:"btn-secondary",onClick:()=>h(!1),children:"Save"}),s.jsx("button",{className:"btn-primary",onClick:()=>h(!0),children:"Save & Replay"}),s.jsx("button",{className:"btn-secondary",onClick:()=>l(null),children:"Cancel"})]})]})]})]})}function wL(){const[e,t]=m.useState([]),[n,r]=m.useState(!1),[i,a]=m.useState(null),o=async()=>{r(!0),a(null);try{const l=await K0(),c=(Array.isArray(l)?l:[]).filter(u=>{var d,p;return((d=u==null?void 0:u.data)==null?void 0:d.connectorId)||((p=u==null?void 0:u.data)==null?void 0:p.payload)});t(c)}catch{t([]),a("Failed to load webhook retries")}finally{r(!1)}};return m.useEffect(()=>{o()},[]),s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"Webhook Retry"}),s.jsx("p",{className:"muted",children:"Retry failed webhook payloads from the integration DLQ."})]}),s.jsx("div",{className:"welcome-actions",children:s.jsx("button",{className:"btn-secondary",onClick:o,disabled:n,children:"Refresh"})})]}),i&&s.jsx("div",{className:"card",children:i}),s.jsx("section",{className:"section",children:s.jsx("div",{className:"card",children:s.jsxs("table",{className:"table lite",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"ID"}),s.jsx("th",{children:"Connector"}),s.jsx("th",{children:"Reason"}),s.jsx("th",{children:"Attempts"}),s.jsx("th",{children:"Actions"})]})}),s.jsxs("tbody",{children:[e.map(l=>{var c;return s.jsxs("tr",{children:[s.jsx("td",{children:l.id}),s.jsx("td",{children:((c=l==null?void 0:l.data)==null?void 0:c.connectorId)||"-"}),s.jsx("td",{children:l.failedReason||"-"}),s.jsx("td",{children:l.attemptsMade||0}),s.jsx("td",{children:s.jsx("button",{className:"btn-secondary",onClick:async()=>{await cf(l.id),o()},children:"Retry Webhook"})})]},l.id)}),e.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:"5",children:"No webhook retries queued"})})]})]})})})]})}function SL(){var a,o,l,c;const[e,t]=m.useState(null),[n,r]=m.useState(""),i=async()=>{r("");try{const u=await V_();t(u||null)}catch(u){r((u==null?void 0:u.message)||"Failed to load decision cockpit"),t(null)}};return m.useEffect(()=>{i()},[]),s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"Decision Cockpit"}),s.jsx("p",{className:"muted",children:"Operational anomalies, trust signals and next best actions."})]}),s.jsx("div",{className:"welcome-actions",children:s.jsx("button",{className:"btn-secondary",onClick:i,children:"Refresh"})})]}),n&&s.jsx("div",{className:"card",children:n}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Key Totals"}),s.jsxs("div",{className:"grid info-grid",children:[s.jsx(te,{title:"DLQ Failed",value:((a=e==null?void 0:e.totals)==null?void 0:a.dlqFailed)??""}),s.jsx(te,{title:"Workforce Pending",value:((o=e==null?void 0:e.totals)==null?void 0:o.workforcePending)??""}),s.jsx(te,{title:"ABAC Denials (24h)",value:((l=e==null?void 0:e.totals)==null?void 0:l.abacDenials24h)??""})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Anomalies"}),s.jsxs("div",{className:"panel-grid",children:[((e==null?void 0:e.anomalies)||[]).map(u=>s.jsxs("div",{className:"card",children:[s.jsx("strong",{children:u.title}),s.jsxs("p",{className:"muted",children:["Severity: ",u.severity," | Metric: ",u.metric]}),s.jsx("p",{children:u.why}),s.jsxs("p",{children:[s.jsx("strong",{children:"Action:"})," ",u.action]})]},u.id)),!((c=e==null?void 0:e.anomalies)!=null&&c.length)&&s.jsx("div",{className:"card muted",children:"No anomalies detected."})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Recommendations"}),s.jsx("div",{className:"panel-grid",children:((e==null?void 0:e.recommendations)||[]).map((u,d)=>{var p,h;return s.jsxs("div",{className:"card",children:[s.jsx("strong",{children:((h=(p=u.type)==null?void 0:p.toUpperCase)==null?void 0:h.call(p))||"RECOMMENDATION"}),s.jsx("p",{children:u.text})]},`rec-${d}`)})})]})]})}const EL=async(e={})=>{const t=new URLSearchParams;e.status&&t.set("status",e.status),e.limit&&t.set("limit",String(e.limit)),e.page&&t.set("page",String(e.page)),e.cursor&&t.set("cursor",e.cursor);const n=t.toString();return(await ue.get(`/api/transfers${n?`?${n}`:""}`)).data},NL=async({transferId:e,payload:t,signature:n})=>(await ue.post(`/api/transfers/${e}/provenance/verify`,{payload:t,signature:n})).data;function _L(){const[e,t]=m.useState([]),[n,r]=m.useState(""),[i,a]=m.useState("{}"),[o,l]=m.useState(""),[c,u]=m.useState(!1),[d,p]=m.useState(""),[h,f]=m.useState(null),y=async()=>{var E;try{const g=await EL({limit:50}),x=Array.isArray(g==null?void 0:g.items)?g.items:[];t(x),!n&&((E=x[0])!=null&&E._id)&&r(x[0]._id)}catch{t([])}};m.useEffect(()=>{y()},[]);const b=async()=>{u(!0),p(""),f(null);try{const E=JSON.parse(i||"{}"),g=await NL({transferId:n,payload:E,signature:o});f(g)}catch(E){p((E==null?void 0:E.message)||"Failed to verify provenance")}finally{u(!1)}};return s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"Transfer Provenance Verify"}),s.jsx("p",{className:"muted",children:"Verify signed transfer payload integrity for receiving hospitals."})]}),s.jsx("div",{className:"welcome-actions",children:s.jsx("button",{className:"btn-secondary",onClick:y,children:"Refresh Transfers"})})]}),d&&s.jsx("div",{className:"card",children:d}),s.jsx("section",{className:"section",children:s.jsxs("div",{className:"card",children:[s.jsx("label",{children:"Transfer"}),s.jsx("select",{value:n,onChange:E=>r(E.target.value),children:e.map(E=>s.jsxs("option",{value:E._id,children:[E._id,"  ",E.status]},E._id))}),s.jsx("label",{style:{marginTop:12},children:"Payload (JSON)"}),s.jsx("textarea",{rows:8,value:i,onChange:E=>a(E.target.value)}),s.jsx("label",{style:{marginTop:12},children:"Signature"}),s.jsx("input",{type:"text",value:o,onChange:E=>l(E.target.value),placeholder:"X-AfyaLink-Provenance signature"}),s.jsx("div",{className:"welcome-actions",children:s.jsx("button",{className:"btn-primary",onClick:b,disabled:c||!n||!o,children:c?"Verifying...":"Verify Signature"})})]})}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Verification Result"}),s.jsx("div",{className:"card",children:h?s.jsx("pre",{style:{whiteSpace:"pre-wrap",margin:0},children:JSON.stringify(h,null,2)}):s.jsx("p",{className:"muted",children:"No verification result yet."})})]})]})}const AL=async(e={})=>{const t=new URLSearchParams;e.action&&t.set("action",e.action),e.limit&&t.set("limit",String(e.limit)),e.hospital&&t.set("hospital",String(e.hospital));const n=t.toString();return(await ue.get(`/api/ai_admin/list${n?`?${n}`:""}`)).data},CL=["AI_DOCUMENT_EXTRACTED","AI_DOCUMENT_EXTRACTION_FAILED","AI_DIGITAL_TWIN_RUN"];function kL(){const[e,t]=m.useState([]),[n,r]=m.useState(!1),[i,a]=m.useState(""),[o,l]=m.useState({action:"AI_DOCUMENT_EXTRACTED",hospital:"",limit:100}),[c,u]=m.useState(""),d=async(h=o)=>{r(!0),a("");try{const f=await AL(h);t(Array.isArray(f==null?void 0:f.items)?f.items:[])}catch(f){a((f==null?void 0:f.message)||"Failed to load extraction history"),t([])}finally{r(!1)}};m.useEffect(()=>{d()},[]);const p=e.filter(h=>{var x,w,_,S,k;const f=String(c||"").trim().toLowerCase();if(!f)return!0;const y=`${((x=h.actor)==null?void 0:x.name)||""} ${((w=h.actor)==null?void 0:w.email)||""}`.toLowerCase(),b=String(((_=h.metadata)==null?void 0:_.filename)||"").toLowerCase(),E=String(((S=h.metadata)==null?void 0:S.mimeType)||"").toLowerCase(),g=String(((k=h.metadata)==null?void 0:k.provider)||"").toLowerCase();return y.includes(f)||b.includes(f)||E.includes(f)||g.includes(f)});return s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"AI Extraction History"}),s.jsx("p",{className:"muted",children:"Audit trail of NeuroEdge document extraction operations."})]}),s.jsx("div",{className:"welcome-actions",children:s.jsx("button",{className:"btn-secondary",onClick:d,disabled:n,children:"Refresh"})})]}),i&&s.jsx("div",{className:"card",children:i}),s.jsxs("section",{className:"section",children:[s.jsxs("div",{className:"card",style:{marginBottom:12},children:[s.jsxs("div",{className:"grid info-grid",children:[s.jsxs("label",{children:["Action",s.jsx("select",{value:o.action,onChange:h=>l(f=>({...f,action:h.target.value})),children:CL.map(h=>s.jsx("option",{value:h,children:h},h))})]}),s.jsxs("label",{children:["Hospital Id",s.jsx("input",{value:o.hospital,onChange:h=>l(f=>({...f,hospital:h.target.value})),placeholder:"Optional hospital id"})]}),s.jsxs("label",{children:["Limit",s.jsx("select",{value:o.limit,onChange:h=>l(f=>({...f,limit:Number(h.target.value)})),children:[25,50,100,200].map(h=>s.jsx("option",{value:h,children:h},h))})]}),s.jsxs("label",{children:["Search",s.jsx("input",{value:c,onChange:h=>u(h.target.value),placeholder:"actor, file, provider, mime"})]})]}),s.jsxs("div",{className:"welcome-actions",style:{marginTop:10},children:[s.jsx("button",{className:"btn-primary",onClick:()=>d(o),disabled:n,children:"Apply Filters"}),s.jsx("button",{className:"btn-secondary",onClick:()=>{const h={action:"AI_DOCUMENT_EXTRACTED",hospital:"",limit:100};l(h),u(""),d(h)},disabled:n,children:"Reset"})]})]}),s.jsx("div",{className:"card",children:s.jsxs("table",{className:"table lite",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Time"}),s.jsx("th",{children:"Actor"}),s.jsx("th",{children:"Role"}),s.jsx("th",{children:"Filename"}),s.jsx("th",{children:"MimeType"}),s.jsx("th",{children:"Size"}),s.jsx("th",{children:"Provider"}),s.jsx("th",{children:"Status"})]})}),s.jsxs("tbody",{children:[p.map(h=>{var f,y,b,E,g,x,w;return s.jsxs("tr",{children:[s.jsx("td",{children:h.createdAt?new Date(h.createdAt).toLocaleString():"-"}),s.jsx("td",{children:((f=h.actor)==null?void 0:f.name)||((y=h.actor)==null?void 0:y.email)||"-"}),s.jsx("td",{children:((b=h.actor)==null?void 0:b.role)||"-"}),s.jsx("td",{children:((E=h.metadata)==null?void 0:E.filename)||"-"}),s.jsx("td",{children:((g=h.metadata)==null?void 0:g.mimeType)||"-"}),s.jsx("td",{children:((x=h.metadata)==null?void 0:x.size)||"-"}),s.jsx("td",{children:((w=h.metadata)==null?void 0:w.provider)||"-"}),s.jsx("td",{children:h.success?"Success":h.error||"Failed"})]},h.id)}),p.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:"8",children:"No extraction logs found"})})]})]})})]})]})}function IL(){return s.jsxs("div",{style:{padding:24},children:[s.jsx("h1",{style:{fontSize:24,fontWeight:700,marginBottom:20},children:"Admin Tools"}),s.jsxs("div",{className:"grid",style:{marginBottom:24},children:[s.jsx(te,{title:"Audit Logs",value:"Live",subtitle:"Security events"}),s.jsx(te,{title:"Admin Accounts",value:"Manage",subtitle:"Create and review"}),s.jsx(te,{title:"System Access",value:"RBAC",subtitle:"Role governance"})]}),s.jsxs("div",{style:{display:"flex",gap:12},children:[s.jsx(li,{to:"/admin/audit-logs",children:"Open Audit Logs"}),s.jsx(li,{to:"/admin/create-admin",children:"Create Admin"})]})]})}async function RL(e={}){const t=new URLSearchParams(e).toString();return await oe(`/api/audit?${t}`)}function TL(){const[e,t]=m.useState([]),[n,r]=m.useState({}),[i,a]=m.useState(!0),o=async()=>{a(!0);const c=await RL(n);t(c.data),a(!1)};m.useEffect(()=>{o()},[]);const l=()=>{const u=`time,actor,action,resource,success,ip
`+e.map(h=>{var f;return{time:new Date(h.createdAt).toISOString(),actor:(f=h.actorId)==null?void 0:f.email,action:h.action,resource:h.resource,success:h.success,ip:h.ip}}).map(h=>Object.values(h).join(",")).join(`
`),d=new Blob([u],{type:"text/csv"}),p=document.createElement("a");p.href=URL.createObjectURL(d),p.download="audit-logs.csv",p.click()};return s.jsxs("div",{className:"card",children:[s.jsx("h2",{children:" Audit Logs"}),s.jsxs("div",{className:"row",children:[s.jsx("input",{placeholder:"Action",onChange:c=>r({...n,action:c.target.value})}),s.jsx("input",{placeholder:"Resource",onChange:c=>r({...n,resource:c.target.value})}),s.jsx("button",{onClick:o,children:"Filter"}),s.jsx("button",{onClick:l,children:"Export CSV"})]}),i?s.jsx("p",{children:"Loading..."}):s.jsxs("table",{children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Time"}),s.jsx("th",{children:"Actor"}),s.jsx("th",{children:"Action"}),s.jsx("th",{children:"Resource"}),s.jsx("th",{children:"Success"}),s.jsx("th",{children:"IP"})]})}),s.jsx("tbody",{children:e.map(c=>{var u;return s.jsxs("tr",{children:[s.jsx("td",{children:new Date(c.createdAt).toLocaleString()}),s.jsx("td",{children:(u=c.actorId)==null?void 0:u.email}),s.jsx("td",{children:c.action}),s.jsx("td",{children:c.resource}),s.jsx("td",{children:c.success?"":""}),s.jsx("td",{children:c.ip})]},c._id)})})]})]})}function OL(){const{user:e}=Me(),[t,n]=m.useState([]),[r,i]=m.useState({name:"",email:"",password:"",role:"HOSPITAL_ADMIN",hospitalId:""}),[a,o]=m.useState(!1),[l,c]=m.useState(null);if((e==null?void 0:e.role)!=="SUPER_ADMIN")return s.jsx("p",{children:" Access denied"});Zo.useEffect(()=>{z0().then(d=>n(Array.isArray(d)?d:d.hospitals||[])).catch(()=>n([]))},[]);const u=async d=>{var p,h;d.preventDefault(),o(!0),c(null);try{r.role==="SYSTEM_ADMIN"?(await G0({name:r.name,email:r.email,password:r.password}),c(" System admin created")):r.role==="DEVELOPER"?(await Y0({name:r.name,email:r.email,password:r.password}),c(" Developer created")):(await W0({name:r.name,email:r.email,password:r.password,hospitalId:r.hospitalId}),c(" Hospital admin created")),i({name:"",email:"",password:"",role:"HOSPITAL_ADMIN",hospitalId:""})}catch(f){c(((h=(p=f.response)==null?void 0:p.data)==null?void 0:h.msg)||"Failed to create admin")}finally{o(!1)}};return s.jsxs("div",{className:"card",children:[s.jsx("h2",{children:" Create Admin"}),s.jsxs("form",{onSubmit:u,className:"form",children:[s.jsx("input",{placeholder:"Full name",value:r.name,required:!0,onChange:d=>i({...r,name:d.target.value})}),s.jsx("input",{placeholder:"Email address",type:"email",value:r.email,required:!0,onChange:d=>i({...r,email:d.target.value})}),s.jsx("input",{placeholder:"Temporary password",type:"password",value:r.password,required:!0,onChange:d=>i({...r,password:d.target.value})}),s.jsxs("select",{value:r.role,onChange:d=>i({...r,role:d.target.value}),children:[s.jsx("option",{value:"HOSPITAL_ADMIN",children:"Hospital Admin"}),s.jsx("option",{value:"SYSTEM_ADMIN",children:"System Admin"}),s.jsx("option",{value:"DEVELOPER",children:"Developer"})]}),r.role==="HOSPITAL_ADMIN"&&s.jsxs("select",{value:r.hospitalId,onChange:d=>i({...r,hospitalId:d.target.value}),required:!0,children:[s.jsx("option",{value:"",children:"Select hospital"}),t.map(d=>s.jsx("option",{value:d._id,children:d.name},d._id))]}),s.jsx("button",{disabled:a,children:a?"Creating...":"Create Admin"})]}),l&&s.jsx("p",{style:{marginTop:10},children:l})]})}function PL(){const{user:e}=Me(),t=Oe(),[n,r]=m.useState(!1),[i,a]=m.useState([]),[o,l]=m.useState(null),[c,u]=m.useState(()=>{try{return JSON.parse(localStorage.getItem("dismissed_reminders")||"[]")}catch{return[]}}),d=h=>{switch(h){case"DOCTOR":return"/api/dashboard/doctor";case"NURSE":return"/api/dashboard/nurse";case"LAB_TECH":return"/api/dashboard/lab-tech";case"HR_MANAGER":return"/api/dashboard/hr";case"PAYROLL_OFFICER":return"/api/dashboard/payroll";case"HOSPITAL_ADMIN":return"/api/dashboard/hospital-admin";case"SECURITY_ADMIN":return"/api/dashboard/security-admin";case"SECURITY_OFFICER":return"/api/dashboard/security-officer";case"PATIENT":return"/api/dashboard/patient";case"SUPER_ADMIN":return"/api/dashboard/super-admin";case"RADIOLOGIST":case"THERAPIST":case"RECEPTIONIST":return"/api/dashboard/staff";default:return null}};m.useEffect(()=>{const h=f=>{const y=(f==null?void 0:f.detail)||{};l({code:y.code||"SESSION_SECURITY",message:y.message||"Additional verification is required."}),t("/step-up")};return window.addEventListener("afyalink:session-security",h),()=>{window.removeEventListener("afyalink:session-security",h)}},[t]),m.useEffect(()=>{let h=!0;if(!e)return;oe("/api/auth/session-risk").then(b=>{var E;!h||!b||(b.restriction||b.requiresStepUp?(l({code:b.restriction?"SESSION_RESTRICTED":"STEP_UP_REQUIRED",message:((E=b.restriction)==null?void 0:E.reason)==="CRITICAL_LOGIN_RISK"?"Your session is temporarily restricted due to critical login risk. Verify step-up to unlock.":"Step-up verification is required for sensitive actions."}),a(g=>{var w;const x=(g||[]).filter(_=>_.id!=="session-stepup");return[{id:"session-stepup",text:((w=b.restriction)==null?void 0:w.reason)==="CRITICAL_LOGIN_RISK"?"Session restricted. Click to complete step-up verification.":"Sensitive actions require step-up verification. Click to verify.",action:()=>t("/step-up")},...x]})):l(null))}).catch(()=>{});const f=d(e==null?void 0:e.role),y=f?oe(f):Promise.resolve(null);return Promise.all([oe("/api/profile"),oe("/api/2fa/status"),y]).then(([b,E,g])=>{var w,_,S;if(!h)return;const x=[];if(b!=null&&b.emailVerified||x.push({id:"email",text:((w=b==null?void 0:b.verificationWarning)==null?void 0:w.message)||"Your email is not verified. Click to verify in Profile.",action:()=>t("/profile")}),b!=null&&b.phoneVerified||x.push({id:"phone",text:"Verify your phone number to secure your account.",action:()=>t("/profile")}),(!(b!=null&&b.nationalIdNumber)||!(b!=null&&b.nationalIdCountry))&&x.push({id:"id",text:"Add your National ID details to complete your profile.",action:()=>t("/profile")}),E!=null&&E.enabled||x.push({id:"2fa",text:"Enable two-factor authentication for stronger security.",action:()=>t("/profile")}),g){const k=e==null?void 0:e.role;((_=g.pendingRequests)==null?void 0:_.total)>0&&x.push({id:"pending-requests",text:`You have ${g.pendingRequests.total} pending requests.`,action:()=>t(k==="HOSPITAL_ADMIN"?"/hospital-admin/approvals":"/workforce/requests")}),k==="HOSPITAL_ADMIN"&&g.pendingRequests>0&&x.push({id:"pending-approvals",text:`You have ${g.pendingRequests} approvals waiting.`,action:()=>t("/hospital-admin/approvals")}),k==="HR_MANAGER"&&((S=g.pendingRequests)==null?void 0:S.total)>0&&x.push({id:"hr-requests",text:`Workforce requests pending: ${g.pendingRequests.total}.`,action:()=>t("/hr-manager")}),k==="PAYROLL_OFFICER"&&g.pendingApprovals>0&&x.push({id:"payroll-approvals",text:`Payroll approvals pending: ${g.pendingApprovals}.`,action:()=>t("/payroll-officer")}),(k==="PAYROLL_OFFICER"||k==="HOSPITAL_ADMIN"||k==="SUPER_ADMIN")&&g.overduePayroll>0&&x.push({id:"overdue-payroll",text:`Overdue payroll items: ${g.overduePayroll}.`,action:()=>t(k==="PAYROLL_OFFICER"?"/payroll-officer":"/payments")}),k==="SUPER_ADMIN"&&g.pendingRequests>0&&x.push({id:"super-pending",text:`Global approvals pending: ${g.pendingRequests}.`,action:()=>t("/admin/notifications")}),(k==="HOSPITAL_ADMIN"||k==="HR_MANAGER"||k==="SUPER_ADMIN")&&g.incompleteStaff>0&&x.push({id:"incomplete-staff",text:`${g.incompleteStaff} staff records are incomplete.`,action:()=>t(k==="SUPER_ADMIN"?"/super-admin":k==="HR_MANAGER"?"/hr-manager":"/hospital-admin/staff")}),(k==="HOSPITAL_ADMIN"||k==="HR_MANAGER"||k==="SUPER_ADMIN")&&g.inactiveStaff>0&&x.push({id:"inactive-staff",text:`${g.inactiveStaff} staff accounts are inactive.`,action:()=>t(k==="SUPER_ADMIN"?"/super-admin":k==="HR_MANAGER"?"/hr-manager":"/hospital-admin/staff")}),(k==="HOSPITAL_ADMIN"||k==="HR_MANAGER"||k==="SUPER_ADMIN")&&g.missingLicenses>0&&x.push({id:"missing-licenses",text:`${g.missingLicenses} staff are missing license details.`,action:()=>t(k==="SUPER_ADMIN"?"/super-admin":k==="HR_MANAGER"?"/hr-manager":"/hospital-admin/staff")}),["RADIOLOGIST","THERAPIST","RECEPTIONIST"].includes(k)&&g.myPendingRequests>0&&x.push({id:"my-requests",text:`You have ${g.myPendingRequests} pending requests.`,action:()=>t("/workforce/requests")}),g.notificationsUnread>0&&x.push({id:"unread-notifs",text:`You have ${g.notificationsUnread} unread notifications.`,action:()=>t(["SUPER_ADMIN","SYSTEM_ADMIN","HOSPITAL_ADMIN"].includes(k)?"/admin/notifications":"/profile")}),k==="LAB_TECH"&&g.pendingOrders>0&&x.push({id:"lab-orders",text:`${g.pendingOrders} lab orders are pending.`,action:()=>t("/lab-tech")}),k==="NURSE"&&g.pendingLabOrders>0&&x.push({id:"lab-pending",text:`${g.pendingLabOrders} lab orders are pending.`,action:()=>t("/nurse")}),k==="DOCTOR"&&g.upcomingAppointments>0&&x.push({id:"doctor-appts",text:`${g.upcomingAppointments} upcoming appointments.`,action:()=>t("/doctor/appointments")}),k==="PATIENT"&&(g.upcomingAppointments>0&&x.push({id:"patient-appts",text:`${g.upcomingAppointments} upcoming appointments.`,action:()=>t("/patient")}),g.unpaidInvoices>0&&x.push({id:"patient-invoices",text:`${g.unpaidInvoices} unpaid invoices.`,action:()=>t("/payments")})),(k==="SECURITY_ADMIN"||k==="SECURITY_OFFICER")&&g.openIncidents>0&&x.push({id:"security-incidents",text:`${g.openIncidents} security incidents are open.`,action:()=>t(k==="SECURITY_ADMIN"?"/security-admin":"/security-officer")})}a(x)}).catch(()=>{}),()=>{h=!1}},[e==null?void 0:e.id]);const p=h=>{const f=Array.from(new Set([...c||[],h]));u(f),localStorage.setItem("dismissed_reminders",JSON.stringify(f))};return s.jsxs(s.Fragment,{children:[e&&s.jsx(H_,{onToggleSidebar:()=>r(h=>!h)}),e&&n&&s.jsx("button",{className:"sidebar-backdrop","aria-label":"Close navigator",onClick:()=>r(!1)}),s.jsxs("div",{className:`app-grid ${n?"":"sidebar-collapsed"}`,children:[e&&s.jsx(W_,{open:n,onClose:()=>r(!1)}),s.jsxs("main",{className:"main",children:[o&&s.jsxs("button",{className:"verify-banner",onClick:()=>t("/step-up"),children:[o.message,s.jsx("span",{className:"banner-close",role:"button","aria-label":"Dismiss notice",onClick:h=>{h.stopPropagation(),l(null)},children:""})]}),i.filter(h=>!c.includes(h.id)).map(h=>s.jsxs("button",{className:"verify-banner",onClick:h.action,children:[h.text,s.jsx("span",{className:"banner-close",role:"button","aria-label":"Dismiss reminder",onClick:f=>{f.stopPropagation(),p(h.id)},children:""})]},h.id)),s.jsx(hj,{})]})]}),e&&s.jsx(K_,{}),e&&s.jsx(Y_,{})]})}function LL(){return s.jsx(I_,{children:s.jsxs(yN,{children:[s.jsx(K,{path:"/",element:s.jsx(go,{to:"/login",replace:!0})}),s.jsx(K,{path:"/login",element:s.jsx(Z_,{})}),s.jsx(K,{path:"/register",element:s.jsx(X_,{})}),s.jsx(K,{path:"/verify-email",element:s.jsx(eA,{})}),s.jsx(K,{path:"/verify-success",element:s.jsx(tA,{})}),s.jsx(K,{path:"/forgot-password",element:s.jsx(nA,{})}),s.jsx(K,{path:"/reset-password",element:s.jsx(rA,{})}),s.jsx(K,{path:"/2fa",element:s.jsx(sA,{})}),s.jsx(K,{path:"/step-up",element:s.jsx(iA,{})}),s.jsx(K,{path:"/unauthorized",element:s.jsx(Eg,{})}),s.jsx(K,{path:"/403",element:s.jsx(Eg,{})}),s.jsxs(K,{element:s.jsx(ie,{children:s.jsx(Q_,{children:s.jsx(PL,{})})}),children:[s.jsx(K,{path:"/patient",element:s.jsx(ie,{roles:["PATIENT","SUPER_ADMIN","DEVELOPER"],children:s.jsx(ZO,{})})}),s.jsx(K,{path:"/patient/appointments",element:s.jsx(ie,{roles:["PATIENT","SUPER_ADMIN","DEVELOPER"],children:s.jsx(q1,{})})}),s.jsx(K,{path:"/patient/medical-records",element:s.jsx(ie,{roles:["PATIENT","SUPER_ADMIN","DEVELOPER"],children:s.jsx(z1,{})})}),s.jsx(K,{path:"/patient/prescriptions",element:s.jsx(ie,{roles:["PATIENT","SUPER_ADMIN","DEVELOPER"],children:s.jsx(W1,{})})}),s.jsx(K,{path:"/patient/lab-results",element:s.jsx(ie,{roles:["PATIENT","SUPER_ADMIN","DEVELOPER"],children:s.jsx(G1,{})})}),s.jsx(K,{path:"/patient/billing",element:s.jsx(ie,{roles:["PATIENT","SUPER_ADMIN","DEVELOPER"],children:s.jsx(Y1,{})})}),s.jsx(K,{path:"/patient/insurance",element:s.jsx(ie,{roles:["PATIENT","SUPER_ADMIN","DEVELOPER"],children:s.jsx(K1,{})})}),s.jsx(K,{path:"/patient/feedback",element:s.jsx(ie,{roles:["PATIENT","SUPER_ADMIN","DEVELOPER"],children:s.jsx(J1,{})})}),s.jsx(K,{path:"/doctor",element:s.jsx(ie,{roles:["DOCTOR","SUPER_ADMIN","DEVELOPER"],children:s.jsx(QO,{})})}),s.jsx(K,{path:"/nurse",element:s.jsx(ie,{roles:["NURSE","SUPER_ADMIN","DEVELOPER"],children:s.jsx(XO,{})})}),s.jsx(K,{path:"/nurse/shift",element:s.jsx(ie,{roles:["NURSE","SUPER_ADMIN","DEVELOPER"],children:s.jsx(N1,{})})}),s.jsx(K,{path:"/nurse/patients",element:s.jsx(ie,{roles:["NURSE","SUPER_ADMIN","DEVELOPER"],children:s.jsx(_1,{})})}),s.jsx(K,{path:"/nurse/medication",element:s.jsx(ie,{roles:["NURSE","SUPER_ADMIN","DEVELOPER"],children:s.jsx(A1,{})})}),s.jsx(K,{path:"/nurse/incidents",element:s.jsx(ie,{roles:["NURSE","SUPER_ADMIN","DEVELOPER"],children:s.jsx(C1,{})})}),s.jsx(K,{path:"/nurse/vitals",element:s.jsx(ie,{roles:["NURSE","SUPER_ADMIN","DEVELOPER"],children:s.jsx(k1,{})})}),s.jsx(K,{path:"/nurse/leave",element:s.jsx(ie,{roles:["NURSE","SUPER_ADMIN","DEVELOPER"],children:s.jsx(I1,{})})}),s.jsx(K,{path:"/nurse/performance",element:s.jsx(ie,{roles:["NURSE","SUPER_ADMIN","DEVELOPER"],children:s.jsx(R1,{})})}),s.jsx(K,{path:"/lab-tech",element:s.jsx(ie,{roles:["LAB_TECH","SUPER_ADMIN","DEVELOPER"],children:s.jsx(eP,{})})}),s.jsx(K,{path:"/lab-tech/test-queue",element:s.jsx(ie,{roles:["LAB_TECH","SUPER_ADMIN","DEVELOPER"],children:s.jsx(T1,{})})}),s.jsx(K,{path:"/lab-tech/equipment",element:s.jsx(ie,{roles:["LAB_TECH","SUPER_ADMIN","DEVELOPER"],children:s.jsx(O1,{})})}),s.jsx(K,{path:"/lab-tech/samples",element:s.jsx(ie,{roles:["LAB_TECH","SUPER_ADMIN","DEVELOPER"],children:s.jsx(P1,{})})}),s.jsx(K,{path:"/lab-tech/qc",element:s.jsx(ie,{roles:["LAB_TECH","SUPER_ADMIN","DEVELOPER"],children:s.jsx(L1,{})})}),s.jsx(K,{path:"/lab-tech/safety",element:s.jsx(ie,{roles:["LAB_TECH","SUPER_ADMIN","DEVELOPER"],children:s.jsx(D1,{})})}),s.jsx(K,{path:"/lab-tech/archive",element:s.jsx(ie,{roles:["LAB_TECH","SUPER_ADMIN","DEVELOPER"],children:s.jsx(M1,{})})}),s.jsx(K,{path:"/pharmacy",element:s.jsx(ie,{roles:["PHARMACIST","SUPER_ADMIN","DEVELOPER"],children:s.jsx(tP,{})})}),s.jsx(K,{path:"/pharmacy/queue",element:s.jsx(ie,{roles:["PHARMACIST","SUPER_ADMIN","DEVELOPER"],children:s.jsx(U1,{})})}),s.jsx(K,{path:"/pharmacy/inventory",element:s.jsx(ie,{roles:["PHARMACIST","SUPER_ADMIN","DEVELOPER"],children:s.jsx(B1,{})})}),s.jsx(K,{path:"/pharmacy/controlled",element:s.jsx(ie,{roles:["PHARMACIST","SUPER_ADMIN","DEVELOPER"],children:s.jsx(V1,{})})}),s.jsx(K,{path:"/pharmacy/expiry",element:s.jsx(ie,{roles:["PHARMACIST","SUPER_ADMIN","DEVELOPER"],children:s.jsx($1,{})})}),s.jsx(K,{path:"/pharmacy/suppliers",element:s.jsx(ie,{roles:["PHARMACIST","SUPER_ADMIN","DEVELOPER"],children:s.jsx(F1,{})})}),s.jsx(K,{path:"/pharmacy/reports",element:s.jsx(ie,{roles:["PHARMACIST","SUPER_ADMIN","DEVELOPER"],children:s.jsx(H1,{})})}),s.jsx(K,{path:"/staff",element:s.jsx(ie,{roles:["RADIOLOGIST","THERAPIST","RECEPTIONIST","SUPER_ADMIN","DEVELOPER"],children:s.jsx(HP,{})})}),s.jsx(K,{path:"/hr-manager",element:s.jsx(ie,{roles:["HR_MANAGER","SUPER_ADMIN","DEVELOPER"],children:s.jsx(qP,{})})}),s.jsx(K,{path:"/payroll-officer",element:s.jsx(ie,{roles:["PAYROLL_OFFICER","SUPER_ADMIN","DEVELOPER"],children:s.jsx(zP,{})})}),s.jsx(K,{path:"/developer",element:s.jsx(ie,{roles:["DEVELOPER"],children:s.jsx(WP,{})})}),s.jsx(K,{path:"/developer/queue-replay",element:s.jsx(ie,{roles:["DEVELOPER","SUPER_ADMIN"],children:s.jsx(bL,{})})}),s.jsx(K,{path:"/developer/webhook-retry",element:s.jsx(ie,{roles:["DEVELOPER","SUPER_ADMIN"],children:s.jsx(wL,{})})}),s.jsx(K,{path:"/developer/decision-cockpit",element:s.jsx(ie,{roles:["DEVELOPER","SUPER_ADMIN","SYSTEM_ADMIN"],children:s.jsx(SL,{})})}),s.jsx(K,{path:"/developer/provenance-verify",element:s.jsx(ie,{roles:["DEVELOPER","SUPER_ADMIN","SYSTEM_ADMIN"],children:s.jsx(_L,{})})}),s.jsx(K,{path:"/developer/ai-extraction-history",element:s.jsx(ie,{roles:["DEVELOPER","SUPER_ADMIN","SYSTEM_ADMIN"],children:s.jsx(kL,{})})}),s.jsx(K,{path:"/super-admin",element:s.jsx(ie,{roles:["SUPER_ADMIN"],children:s.jsx(nP,{})})}),s.jsx(K,{path:"/super-admin/hospitals",element:s.jsx(ie,{roles:["SUPER_ADMIN","SYSTEM_ADMIN"],children:s.jsx(sP,{})})}),s.jsx(K,{path:"/super-admin/settings",element:s.jsx(ie,{roles:["SUPER_ADMIN","DEVELOPER"],children:s.jsx(oP,{})})}),s.jsx(K,{path:"/system-admin",element:s.jsx(ie,{roles:["SYSTEM_ADMIN","SUPER_ADMIN","DEVELOPER"],children:s.jsx(nL,{})})}),s.jsx(K,{path:"/system-admin/abac",element:s.jsx(ie,{roles:["SYSTEM_ADMIN","SUPER_ADMIN","DEVELOPER"],children:s.jsx(rL,{})})}),s.jsx(K,{path:"/system-admin/mapping-studio",element:s.jsx(ie,{roles:["SYSTEM_ADMIN","SUPER_ADMIN","DEVELOPER"],children:s.jsx(hL,{})})}),s.jsx(K,{path:"/system-admin/nlp-analytics",element:s.jsx(ie,{roles:["SYSTEM_ADMIN","SUPER_ADMIN","DEVELOPER","HOSPITAL_ADMIN","HR_MANAGER","PAYROLL_OFFICER"],children:s.jsx(mL,{})})}),s.jsx(K,{path:"/system-admin/regulatory-reports",element:s.jsx(ie,{roles:["SYSTEM_ADMIN","SUPER_ADMIN","DEVELOPER","HOSPITAL_ADMIN"],children:s.jsx(gL,{})})}),s.jsx(K,{path:"/system-admin/clinical-intelligence",element:s.jsx(ie,{roles:["SYSTEM_ADMIN","SUPER_ADMIN","DEVELOPER","HOSPITAL_ADMIN","HR_MANAGER","DOCTOR","NURSE"],children:s.jsx(yL,{})})}),s.jsx(K,{path:"/hospital-admin",element:s.jsx(ie,{roles:["HOSPITAL_ADMIN","SUPER_ADMIN","DEVELOPER"],children:s.jsx(lP,{})})}),s.jsx(K,{path:"/hospital-admin/register-staff",element:s.jsx(ie,{roles:["HOSPITAL_ADMIN"],children:s.jsx(cP,{})})}),s.jsx(K,{path:"/hospital-admin/approvals",element:s.jsx(ie,{roles:["HOSPITAL_ADMIN","SUPER_ADMIN","SYSTEM_ADMIN","DEVELOPER"],children:s.jsx(BP,{})})}),s.jsx(K,{path:"/hospital-admin/staff",element:s.jsx(ie,{roles:["HOSPITAL_ADMIN","SUPER_ADMIN"],children:s.jsx(VP,{})})}),s.jsx(K,{path:"/security-officer",element:s.jsx(ie,{roles:["SECURITY_OFFICER","SUPER_ADMIN","DEVELOPER"],children:s.jsx($P,{})})}),s.jsx(K,{path:"/security-admin",element:s.jsx(ie,{roles:["SECURITY_ADMIN","SUPER_ADMIN","DEVELOPER"],children:s.jsx(FP,{})})}),s.jsx(K,{path:"/guest",element:s.jsx(ie,{roles:["GUEST"],children:s.jsx(aA,{})})}),s.jsxs(K,{path:"/admin",element:s.jsx(ie,{roles:["SUPER_ADMIN","SYSTEM_ADMIN","HOSPITAL_ADMIN"],children:s.jsx(hj,{})}),children:[s.jsx(K,{index:!0,element:s.jsx(IL,{})}),s.jsx(K,{path:"audit-logs",element:s.jsx(TL,{})}),s.jsx(K,{path:"realtime",element:s.jsx(Q1,{})}),s.jsx(K,{path:"crdt-patients",element:s.jsx(DO,{})}),s.jsx(K,{path:"notifications",element:s.jsx(MO,{})}),s.jsx(K,{path:"payment-settings",element:s.jsx(ie,{roles:["SUPER_ADMIN"],children:s.jsx(UO,{})})}),s.jsx(K,{path:"create-admin",element:s.jsx(ie,{roles:["SUPER_ADMIN"],children:s.jsx(OL,{})})})]}),s.jsx(K,{path:"/profile",element:s.jsx(oA,{})}),s.jsx(K,{path:"/analytics",element:s.jsx(dA,{})}),s.jsx(K,{path:"/reports",element:s.jsx(pA,{})}),s.jsx(K,{path:"/inventory",element:s.jsx(gA,{})}),s.jsx(K,{path:"/payments",element:s.jsx(jA,{})}),s.jsx(K,{path:"/payments/full",element:s.jsx(bA,{})}),s.jsx(K,{path:"/ai/medical",element:s.jsx(wA,{})}),s.jsx(K,{path:"/ai/triage",element:s.jsx(_A,{})}),s.jsx(K,{path:"/ai/voice",element:s.jsx(AA,{})}),s.jsx(K,{path:"/ai/chatbot",element:s.jsx(CA,{})}),s.jsx(K,{path:"/ai/extract",element:s.jsx(IA,{})}),s.jsx(K,{path:"/ai/ws",element:s.jsx(Hj,{})}),s.jsx(K,{path:"/workforce/requests",element:s.jsx(ie,{roles:["HOSPITAL_ADMIN","HR_MANAGER","PAYROLL_OFFICER","DOCTOR","NURSE","LAB_TECH","PHARMACIST","RADIOLOGIST","THERAPIST","RECEPTIONIST","SECURITY_ADMIN","SECURITY_OFFICER"],children:s.jsx(xL,{})})}),s.jsx(K,{path:"/doctor/appointments",element:s.jsx(ie,{roles:["DOCTOR","SUPER_ADMIN","DEVELOPER"],children:s.jsx(u1,{})})}),s.jsx(K,{path:"/doctor/schedule",element:s.jsx(ie,{roles:["DOCTOR","SUPER_ADMIN","DEVELOPER"],children:s.jsx(d1,{})})}),s.jsx(K,{path:"/doctor/patients",element:s.jsx(ie,{roles:["DOCTOR","SUPER_ADMIN","DEVELOPER"],children:s.jsx(h1,{})})}),s.jsx(K,{path:"/doctor/opd",element:s.jsx(ie,{roles:["DOCTOR","SUPER_ADMIN","DEVELOPER"],children:s.jsx(f1,{})})}),s.jsx(K,{path:"/doctor/ward",element:s.jsx(ie,{roles:["DOCTOR","SUPER_ADMIN","DEVELOPER"],children:s.jsx(p1,{})})}),s.jsx(K,{path:"/doctor/surgery",element:s.jsx(ie,{roles:["DOCTOR","SUPER_ADMIN","DEVELOPER"],children:s.jsx(m1,{})})}),s.jsx(K,{path:"/doctor/lab-results",element:s.jsx(ie,{roles:["DOCTOR","SUPER_ADMIN","DEVELOPER"],children:s.jsx(g1,{})})}),s.jsx(K,{path:"/doctor/prescriptions",element:s.jsx(ie,{roles:["DOCTOR","SUPER_ADMIN","DEVELOPER"],children:s.jsx(y1,{})})}),s.jsx(K,{path:"/doctor/medical-records",element:s.jsx(ie,{roles:["DOCTOR","SUPER_ADMIN","DEVELOPER"],children:s.jsx(v1,{})})}),s.jsx(K,{path:"/doctor/referrals",element:s.jsx(ie,{roles:["DOCTOR","SUPER_ADMIN","DEVELOPER"],children:s.jsx(x1,{})})}),s.jsx(K,{path:"/doctor/performance",element:s.jsx(ie,{roles:["DOCTOR","SUPER_ADMIN","DEVELOPER"],children:s.jsx(j1,{})})}),s.jsx(K,{path:"/doctor/cme",element:s.jsx(ie,{roles:["DOCTOR","SUPER_ADMIN","DEVELOPER"],children:s.jsx(b1,{})})}),s.jsx(K,{path:"/doctor/leave",element:s.jsx(ie,{roles:["DOCTOR","SUPER_ADMIN","DEVELOPER"],children:s.jsx(w1,{})})}),s.jsx(K,{path:"/doctor/reports-notes",element:s.jsx(ie,{roles:["DOCTOR","SUPER_ADMIN","DEVELOPER"],children:s.jsx(S1,{})})}),s.jsx(K,{path:"/doctor/settings",element:s.jsx(ie,{roles:["DOCTOR","SUPER_ADMIN","DEVELOPER"],children:s.jsx(E1,{})})}),s.jsx(K,{path:"/labtech/labs",element:s.jsx(ie,{roles:["LAB_TECH"],children:s.jsx(qj,{})})}),s.jsx(K,{path:"/superadmin",element:s.jsx(go,{to:"/super-admin",replace:!0})}),s.jsx(K,{path:"/hospitaladmin",element:s.jsx(go,{to:"/hospital-admin",replace:!0})})]}),s.jsx(K,{path:"*",element:s.jsx("div",{children:"404  Page not found"})})]})})}const DL="269045019074-0238dca5sn2fq84dp96kilqmf24h24j3.apps.googleusercontent.com";kd.createRoot(document.getElementById("root")).render(s.jsx(Zo.StrictMode,{children:s.jsx(IN,{clientId:DL,children:s.jsx(NN,{children:s.jsx(M_,{children:s.jsx(B_,{children:s.jsx(DN,{children:s.jsx(LL,{})})})})})})}));
