function Q0(e,t){for(var n=0;n<t.length;n++){const r=t[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in e)){const a=Object.getOwnPropertyDescriptor(r,i);a&&Object.defineProperty(e,i,a.get?a:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(i){if(i.ep)return;i.ep=!0;const a=n(i);fetch(i.href,a)}})();var Qa=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function df(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Wy={exports:{}},Jc={},Gy={exports:{}},ke={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xo=Symbol.for("react.element"),Z0=Symbol.for("react.portal"),X0=Symbol.for("react.fragment"),ew=Symbol.for("react.strict_mode"),tw=Symbol.for("react.profiler"),nw=Symbol.for("react.provider"),rw=Symbol.for("react.context"),sw=Symbol.for("react.forward_ref"),iw=Symbol.for("react.suspense"),aw=Symbol.for("react.memo"),ow=Symbol.for("react.lazy"),em=Symbol.iterator;function lw(e){return e===null||typeof e!="object"?null:(e=em&&e[em]||e["@@iterator"],typeof e=="function"?e:null)}var Yy={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Ky=Object.assign,Jy={};function va(e,t,n){this.props=e,this.context=t,this.refs=Jy,this.updater=n||Yy}va.prototype.isReactComponent={};va.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};va.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Qy(){}Qy.prototype=va.prototype;function hf(e,t,n){this.props=e,this.context=t,this.refs=Jy,this.updater=n||Yy}var ff=hf.prototype=new Qy;ff.constructor=hf;Ky(ff,va.prototype);ff.isPureReactComponent=!0;var tm=Array.isArray,Zy=Object.prototype.hasOwnProperty,pf={current:null},Xy={key:!0,ref:!0,__self:!0,__source:!0};function ev(e,t,n){var r,i={},a=null,o=null;if(t!=null)for(r in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(a=""+t.key),t)Zy.call(t,r)&&!Xy.hasOwnProperty(r)&&(i[r]=t[r]);var l=arguments.length-2;if(l===1)i.children=n;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];i.children=c}if(e&&e.defaultProps)for(r in l=e.defaultProps,l)i[r]===void 0&&(i[r]=l[r]);return{$$typeof:Xo,type:e,key:a,ref:o,props:i,_owner:pf.current}}function cw(e,t){return{$$typeof:Xo,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function mf(e){return typeof e=="object"&&e!==null&&e.$$typeof===Xo}function uw(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var nm=/\/+/g;function _u(e,t){return typeof e=="object"&&e!==null&&e.key!=null?uw(""+e.key):t.toString(36)}function ql(e,t,n,r,i){var a=typeof e;(a==="undefined"||a==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(a){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case Xo:case Z0:o=!0}}if(o)return o=e,i=i(o),e=r===""?"."+_u(o,0):r,tm(i)?(n="",e!=null&&(n=e.replace(nm,"$&/")+"/"),ql(i,t,n,"",function(u){return u})):i!=null&&(mf(i)&&(i=cw(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(nm,"$&/")+"/")+e)),t.push(i)),1;if(o=0,r=r===""?".":r+":",tm(e))for(var l=0;l<e.length;l++){a=e[l];var c=r+_u(a,l);o+=ql(a,t,n,c,i)}else if(c=lw(e),typeof c=="function")for(e=c.call(e),l=0;!(a=e.next()).done;)a=a.value,c=r+_u(a,l++),o+=ql(a,t,n,c,i);else if(a==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function dl(e,t,n){if(e==null)return e;var r=[],i=0;return ql(e,r,"","",function(a){return t.call(n,a,i++)}),r}function dw(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var nn={current:null},zl={transition:null},hw={ReactCurrentDispatcher:nn,ReactCurrentBatchConfig:zl,ReactCurrentOwner:pf};function tv(){throw Error("act(...) is not supported in production builds of React.")}ke.Children={map:dl,forEach:function(e,t,n){dl(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return dl(e,function(){t++}),t},toArray:function(e){return dl(e,function(t){return t})||[]},only:function(e){if(!mf(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};ke.Component=va;ke.Fragment=X0;ke.Profiler=tw;ke.PureComponent=hf;ke.StrictMode=ew;ke.Suspense=iw;ke.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=hw;ke.act=tv;ke.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=Ky({},e.props),i=e.key,a=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(a=t.ref,o=pf.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)Zy.call(t,c)&&!Xy.hasOwnProperty(c)&&(r[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:Xo,type:e.type,key:i,ref:a,props:r,_owner:o}};ke.createContext=function(e){return e={$$typeof:rw,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:nw,_context:e},e.Consumer=e};ke.createElement=ev;ke.createFactory=function(e){var t=ev.bind(null,e);return t.type=e,t};ke.createRef=function(){return{current:null}};ke.forwardRef=function(e){return{$$typeof:sw,render:e}};ke.isValidElement=mf;ke.lazy=function(e){return{$$typeof:ow,_payload:{_status:-1,_result:e},_init:dw}};ke.memo=function(e,t){return{$$typeof:aw,type:e,compare:t===void 0?null:t}};ke.startTransition=function(e){var t=zl.transition;zl.transition={};try{e()}finally{zl.transition=t}};ke.unstable_act=tv;ke.useCallback=function(e,t){return nn.current.useCallback(e,t)};ke.useContext=function(e){return nn.current.useContext(e)};ke.useDebugValue=function(){};ke.useDeferredValue=function(e){return nn.current.useDeferredValue(e)};ke.useEffect=function(e,t){return nn.current.useEffect(e,t)};ke.useId=function(){return nn.current.useId()};ke.useImperativeHandle=function(e,t,n){return nn.current.useImperativeHandle(e,t,n)};ke.useInsertionEffect=function(e,t){return nn.current.useInsertionEffect(e,t)};ke.useLayoutEffect=function(e,t){return nn.current.useLayoutEffect(e,t)};ke.useMemo=function(e,t){return nn.current.useMemo(e,t)};ke.useReducer=function(e,t,n){return nn.current.useReducer(e,t,n)};ke.useRef=function(e){return nn.current.useRef(e)};ke.useState=function(e){return nn.current.useState(e)};ke.useSyncExternalStore=function(e,t,n){return nn.current.useSyncExternalStore(e,t,n)};ke.useTransition=function(){return nn.current.useTransition()};ke.version="18.3.1";Gy.exports=ke;var g=Gy.exports;const xa=df(g),fw=Q0({__proto__:null,default:xa},[g]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pw=g,mw=Symbol.for("react.element"),gw=Symbol.for("react.fragment"),yw=Object.prototype.hasOwnProperty,vw=pw.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,xw={key:!0,ref:!0,__self:!0,__source:!0};function nv(e,t,n){var r,i={},a=null,o=null;n!==void 0&&(a=""+n),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(o=t.ref);for(r in t)yw.call(t,r)&&!xw.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)i[r]===void 0&&(i[r]=t[r]);return{$$typeof:mw,type:e,key:a,ref:o,props:i,_owner:vw.current}}Jc.Fragment=gw;Jc.jsx=nv;Jc.jsxs=nv;Wy.exports=Jc;var s=Wy.exports,Id={},rv={exports:{}},wn={},sv={exports:{}},iv={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(M,X){var ae=M.length;M.push(X);e:for(;0<ae;){var pe=ae-1>>>1,fe=M[pe];if(0<i(fe,X))M[pe]=X,M[ae]=fe,ae=pe;else break e}}function n(M){return M.length===0?null:M[0]}function r(M){if(M.length===0)return null;var X=M[0],ae=M.pop();if(ae!==X){M[0]=ae;e:for(var pe=0,fe=M.length,Le=fe>>>1;pe<Le;){var F=2*(pe+1)-1,Z=M[F],Y=F+1,ye=M[Y];if(0>i(Z,ae))Y<fe&&0>i(ye,Z)?(M[pe]=ye,M[Y]=ae,pe=Y):(M[pe]=Z,M[F]=ae,pe=F);else if(Y<fe&&0>i(ye,ae))M[pe]=ye,M[Y]=ae,pe=Y;else break e}}return X}function i(M,X){var ae=M.sortIndex-X.sortIndex;return ae!==0?ae:M.id-X.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var c=[],u=[],d=1,p=null,h=3,f=!1,v=!1,j=!1,_=typeof setTimeout=="function"?setTimeout:null,m=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(M){for(var X=n(u);X!==null;){if(X.callback===null)r(u);else if(X.startTime<=M)r(u),X.sortIndex=X.expirationTime,t(c,X);else break;X=n(u)}}function N(M){if(j=!1,b(M),!v)if(n(c)!==null)v=!0,K(A);else{var X=n(u);X!==null&&ce(N,X.startTime-M)}}function A(M,X){v=!1,j&&(j=!1,m(I),I=-1),f=!0;var ae=h;try{for(b(X),p=n(c);p!==null&&(!(p.expirationTime>X)||M&&!B());){var pe=p.callback;if(typeof pe=="function"){p.callback=null,h=p.priorityLevel;var fe=pe(p.expirationTime<=X);X=e.unstable_now(),typeof fe=="function"?p.callback=fe:p===n(c)&&r(c),b(X)}else r(c);p=n(c)}if(p!==null)var Le=!0;else{var F=n(u);F!==null&&ce(N,F.startTime-X),Le=!1}return Le}finally{p=null,h=ae,f=!1}}var E=!1,R=null,I=-1,T=5,L=-1;function B(){return!(e.unstable_now()-L<T)}function W(){if(R!==null){var M=e.unstable_now();L=M;var X=!0;try{X=R(!0,M)}finally{X?z():(E=!1,R=null)}}else E=!1}var z;if(typeof y=="function")z=function(){y(W)};else if(typeof MessageChannel<"u"){var P=new MessageChannel,V=P.port2;P.port1.onmessage=W,z=function(){V.postMessage(null)}}else z=function(){_(W,0)};function K(M){R=M,E||(E=!0,z())}function ce(M,X){I=_(function(){M(e.unstable_now())},X)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(M){M.callback=null},e.unstable_continueExecution=function(){v||f||(v=!0,K(A))},e.unstable_forceFrameRate=function(M){0>M||125<M?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<M?Math.floor(1e3/M):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return n(c)},e.unstable_next=function(M){switch(h){case 1:case 2:case 3:var X=3;break;default:X=h}var ae=h;h=X;try{return M()}finally{h=ae}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(M,X){switch(M){case 1:case 2:case 3:case 4:case 5:break;default:M=3}var ae=h;h=M;try{return X()}finally{h=ae}},e.unstable_scheduleCallback=function(M,X,ae){var pe=e.unstable_now();switch(typeof ae=="object"&&ae!==null?(ae=ae.delay,ae=typeof ae=="number"&&0<ae?pe+ae:pe):ae=pe,M){case 1:var fe=-1;break;case 2:fe=250;break;case 5:fe=1073741823;break;case 4:fe=1e4;break;default:fe=5e3}return fe=ae+fe,M={id:d++,callback:X,priorityLevel:M,startTime:ae,expirationTime:fe,sortIndex:-1},ae>pe?(M.sortIndex=ae,t(u,M),n(c)===null&&M===n(u)&&(j?(m(I),I=-1):j=!0,ce(N,ae-pe))):(M.sortIndex=fe,t(c,M),v||f||(v=!0,K(A))),M},e.unstable_shouldYield=B,e.unstable_wrapCallback=function(M){var X=h;return function(){var ae=h;h=X;try{return M.apply(this,arguments)}finally{h=ae}}}})(iv);sv.exports=iv;var jw=sv.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bw=g,bn=jw;function ee(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var av=new Set,So={};function fi(e,t){aa(e,t),aa(e+"Capture",t)}function aa(e,t){for(So[e]=t,e=0;e<t.length;e++)av.add(t[e])}var Ur=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Rd=Object.prototype.hasOwnProperty,ww=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,rm={},sm={};function Sw(e){return Rd.call(sm,e)?!0:Rd.call(rm,e)?!1:ww.test(e)?sm[e]=!0:(rm[e]=!0,!1)}function Ew(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Nw(e,t,n,r){if(t===null||typeof t>"u"||Ew(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function rn(e,t,n,r,i,a,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=o}var Ft={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Ft[e]=new rn(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Ft[t]=new rn(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Ft[e]=new rn(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Ft[e]=new rn(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Ft[e]=new rn(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Ft[e]=new rn(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Ft[e]=new rn(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Ft[e]=new rn(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Ft[e]=new rn(e,5,!1,e.toLowerCase(),null,!1,!1)});var gf=/[\-:]([a-z])/g;function yf(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(gf,yf);Ft[t]=new rn(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(gf,yf);Ft[t]=new rn(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(gf,yf);Ft[t]=new rn(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Ft[e]=new rn(e,1,!1,e.toLowerCase(),null,!1,!1)});Ft.xlinkHref=new rn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Ft[e]=new rn(e,1,!1,e.toLowerCase(),null,!0,!0)});function vf(e,t,n,r){var i=Ft.hasOwnProperty(t)?Ft[t]:null;(i!==null?i.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Nw(t,n,i,r)&&(n=null),r||i===null?Sw(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=n===null?i.type===3?!1:"":n:(t=i.attributeName,r=i.attributeNamespace,n===null?e.removeAttribute(t):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var Fr=bw.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,hl=Symbol.for("react.element"),Pi=Symbol.for("react.portal"),Li=Symbol.for("react.fragment"),xf=Symbol.for("react.strict_mode"),Td=Symbol.for("react.profiler"),ov=Symbol.for("react.provider"),lv=Symbol.for("react.context"),jf=Symbol.for("react.forward_ref"),Od=Symbol.for("react.suspense"),Pd=Symbol.for("react.suspense_list"),bf=Symbol.for("react.memo"),Kr=Symbol.for("react.lazy"),cv=Symbol.for("react.offscreen"),im=Symbol.iterator;function Ma(e){return e===null||typeof e!="object"?null:(e=im&&e[im]||e["@@iterator"],typeof e=="function"?e:null)}var ut=Object.assign,Au;function Za(e){if(Au===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Au=t&&t[1]||""}return`
`+Au+e}var Cu=!1;function ku(e,t){if(!e||Cu)return"";Cu=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var r=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){r=u}e.call(t.prototype)}else{try{throw Error()}catch(u){r=u}e()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),a=r.stack.split(`
`),o=i.length-1,l=a.length-1;1<=o&&0<=l&&i[o]!==a[l];)l--;for(;1<=o&&0<=l;o--,l--)if(i[o]!==a[l]){if(o!==1||l!==1)do if(o--,l--,0>l||i[o]!==a[l]){var c=`
`+i[o].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=o&&0<=l);break}}}finally{Cu=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?Za(e):""}function _w(e){switch(e.tag){case 5:return Za(e.type);case 16:return Za("Lazy");case 13:return Za("Suspense");case 19:return Za("SuspenseList");case 0:case 2:case 15:return e=ku(e.type,!1),e;case 11:return e=ku(e.type.render,!1),e;case 1:return e=ku(e.type,!0),e;default:return""}}function Ld(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Li:return"Fragment";case Pi:return"Portal";case Td:return"Profiler";case xf:return"StrictMode";case Od:return"Suspense";case Pd:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case lv:return(e.displayName||"Context")+".Consumer";case ov:return(e._context.displayName||"Context")+".Provider";case jf:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case bf:return t=e.displayName||null,t!==null?t:Ld(e.type)||"Memo";case Kr:t=e._payload,e=e._init;try{return Ld(e(t))}catch{}}return null}function Aw(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ld(t);case 8:return t===xf?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function js(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function uv(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Cw(e){var t=uv(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,a=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,a.call(this,o)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function fl(e){e._valueTracker||(e._valueTracker=Cw(e))}function dv(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=uv(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function pc(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Dd(e,t){var n=t.checked;return ut({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function am(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=js(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function hv(e,t){t=t.checked,t!=null&&vf(e,"checked",t,!1)}function Md(e,t){hv(e,t);var n=js(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Ud(e,t.type,n):t.hasOwnProperty("defaultValue")&&Ud(e,t.type,js(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function om(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function Ud(e,t,n){(t!=="number"||pc(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var Xa=Array.isArray;function Ki(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+js(n),t=null,i=0;i<e.length;i++){if(e[i].value===n){e[i].selected=!0,r&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function Bd(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(ee(91));return ut({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function lm(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(ee(92));if(Xa(n)){if(1<n.length)throw Error(ee(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:js(n)}}function fv(e,t){var n=js(t.value),r=js(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function cm(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function pv(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Vd(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?pv(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var pl,mv=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,i){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(pl=pl||document.createElement("div"),pl.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=pl.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Eo(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var lo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},kw=["Webkit","ms","Moz","O"];Object.keys(lo).forEach(function(e){kw.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),lo[t]=lo[e]})});function gv(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||lo.hasOwnProperty(e)&&lo[e]?(""+t).trim():t+"px"}function yv(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=gv(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}var Iw=ut({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function $d(e,t){if(t){if(Iw[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(ee(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(ee(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(ee(61))}if(t.style!=null&&typeof t.style!="object")throw Error(ee(62))}}function Fd(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Hd=null;function wf(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var qd=null,Ji=null,Qi=null;function um(e){if(e=nl(e)){if(typeof qd!="function")throw Error(ee(280));var t=e.stateNode;t&&(t=tu(t),qd(e.stateNode,e.type,t))}}function vv(e){Ji?Qi?Qi.push(e):Qi=[e]:Ji=e}function xv(){if(Ji){var e=Ji,t=Qi;if(Qi=Ji=null,um(e),t)for(e=0;e<t.length;e++)um(t[e])}}function jv(e,t){return e(t)}function bv(){}var Iu=!1;function wv(e,t,n){if(Iu)return e(t,n);Iu=!0;try{return jv(e,t,n)}finally{Iu=!1,(Ji!==null||Qi!==null)&&(bv(),xv())}}function No(e,t){var n=e.stateNode;if(n===null)return null;var r=tu(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(ee(231,t,typeof n));return n}var zd=!1;if(Ur)try{var Ua={};Object.defineProperty(Ua,"passive",{get:function(){zd=!0}}),window.addEventListener("test",Ua,Ua),window.removeEventListener("test",Ua,Ua)}catch{zd=!1}function Rw(e,t,n,r,i,a,o,l,c){var u=Array.prototype.slice.call(arguments,3);try{t.apply(n,u)}catch(d){this.onError(d)}}var co=!1,mc=null,gc=!1,Wd=null,Tw={onError:function(e){co=!0,mc=e}};function Ow(e,t,n,r,i,a,o,l,c){co=!1,mc=null,Rw.apply(Tw,arguments)}function Pw(e,t,n,r,i,a,o,l,c){if(Ow.apply(this,arguments),co){if(co){var u=mc;co=!1,mc=null}else throw Error(ee(198));gc||(gc=!0,Wd=u)}}function pi(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function Sv(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function dm(e){if(pi(e)!==e)throw Error(ee(188))}function Lw(e){var t=e.alternate;if(!t){if(t=pi(e),t===null)throw Error(ee(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(i===null)break;var a=i.alternate;if(a===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===n)return dm(i),e;if(a===r)return dm(i),t;a=a.sibling}throw Error(ee(188))}if(n.return!==r.return)n=i,r=a;else{for(var o=!1,l=i.child;l;){if(l===n){o=!0,n=i,r=a;break}if(l===r){o=!0,r=i,n=a;break}l=l.sibling}if(!o){for(l=a.child;l;){if(l===n){o=!0,n=a,r=i;break}if(l===r){o=!0,r=a,n=i;break}l=l.sibling}if(!o)throw Error(ee(189))}}if(n.alternate!==r)throw Error(ee(190))}if(n.tag!==3)throw Error(ee(188));return n.stateNode.current===n?e:t}function Ev(e){return e=Lw(e),e!==null?Nv(e):null}function Nv(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Nv(e);if(t!==null)return t;e=e.sibling}return null}var _v=bn.unstable_scheduleCallback,hm=bn.unstable_cancelCallback,Dw=bn.unstable_shouldYield,Mw=bn.unstable_requestPaint,vt=bn.unstable_now,Uw=bn.unstable_getCurrentPriorityLevel,Sf=bn.unstable_ImmediatePriority,Av=bn.unstable_UserBlockingPriority,yc=bn.unstable_NormalPriority,Bw=bn.unstable_LowPriority,Cv=bn.unstable_IdlePriority,Qc=null,hr=null;function Vw(e){if(hr&&typeof hr.onCommitFiberRoot=="function")try{hr.onCommitFiberRoot(Qc,e,void 0,(e.current.flags&128)===128)}catch{}}var Jn=Math.clz32?Math.clz32:Hw,$w=Math.log,Fw=Math.LN2;function Hw(e){return e>>>=0,e===0?32:31-($w(e)/Fw|0)|0}var ml=64,gl=4194304;function eo(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function vc(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,i=e.suspendedLanes,a=e.pingedLanes,o=n&268435455;if(o!==0){var l=o&~i;l!==0?r=eo(l):(a&=o,a!==0&&(r=eo(a)))}else o=n&~i,o!==0?r=eo(o):a!==0&&(r=eo(a));if(r===0)return 0;if(t!==0&&t!==r&&!(t&i)&&(i=r&-r,a=t&-t,i>=a||i===16&&(a&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-Jn(t),i=1<<n,r|=e[n],t&=~i;return r}function qw(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function zw(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,a=e.pendingLanes;0<a;){var o=31-Jn(a),l=1<<o,c=i[o];c===-1?(!(l&n)||l&r)&&(i[o]=qw(l,t)):c<=t&&(e.expiredLanes|=l),a&=~l}}function Gd(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function kv(){var e=ml;return ml<<=1,!(ml&4194240)&&(ml=64),e}function Ru(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function el(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Jn(t),e[t]=n}function Ww(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-Jn(n),a=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~a}}function Ef(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-Jn(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var We=0;function Iv(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Rv,Nf,Tv,Ov,Pv,Yd=!1,yl=[],os=null,ls=null,cs=null,_o=new Map,Ao=new Map,Qr=[],Gw="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function fm(e,t){switch(e){case"focusin":case"focusout":os=null;break;case"dragenter":case"dragleave":ls=null;break;case"mouseover":case"mouseout":cs=null;break;case"pointerover":case"pointerout":_o.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ao.delete(t.pointerId)}}function Ba(e,t,n,r,i,a){return e===null||e.nativeEvent!==a?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:a,targetContainers:[i]},t!==null&&(t=nl(t),t!==null&&Nf(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function Yw(e,t,n,r,i){switch(t){case"focusin":return os=Ba(os,e,t,n,r,i),!0;case"dragenter":return ls=Ba(ls,e,t,n,r,i),!0;case"mouseover":return cs=Ba(cs,e,t,n,r,i),!0;case"pointerover":var a=i.pointerId;return _o.set(a,Ba(_o.get(a)||null,e,t,n,r,i)),!0;case"gotpointercapture":return a=i.pointerId,Ao.set(a,Ba(Ao.get(a)||null,e,t,n,r,i)),!0}return!1}function Lv(e){var t=Ws(e.target);if(t!==null){var n=pi(t);if(n!==null){if(t=n.tag,t===13){if(t=Sv(n),t!==null){e.blockedOn=t,Pv(e.priority,function(){Tv(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Wl(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Kd(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);Hd=r,n.target.dispatchEvent(r),Hd=null}else return t=nl(n),t!==null&&Nf(t),e.blockedOn=n,!1;t.shift()}return!0}function pm(e,t,n){Wl(e)&&n.delete(t)}function Kw(){Yd=!1,os!==null&&Wl(os)&&(os=null),ls!==null&&Wl(ls)&&(ls=null),cs!==null&&Wl(cs)&&(cs=null),_o.forEach(pm),Ao.forEach(pm)}function Va(e,t){e.blockedOn===t&&(e.blockedOn=null,Yd||(Yd=!0,bn.unstable_scheduleCallback(bn.unstable_NormalPriority,Kw)))}function Co(e){function t(i){return Va(i,e)}if(0<yl.length){Va(yl[0],e);for(var n=1;n<yl.length;n++){var r=yl[n];r.blockedOn===e&&(r.blockedOn=null)}}for(os!==null&&Va(os,e),ls!==null&&Va(ls,e),cs!==null&&Va(cs,e),_o.forEach(t),Ao.forEach(t),n=0;n<Qr.length;n++)r=Qr[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<Qr.length&&(n=Qr[0],n.blockedOn===null);)Lv(n),n.blockedOn===null&&Qr.shift()}var Zi=Fr.ReactCurrentBatchConfig,xc=!0;function Jw(e,t,n,r){var i=We,a=Zi.transition;Zi.transition=null;try{We=1,_f(e,t,n,r)}finally{We=i,Zi.transition=a}}function Qw(e,t,n,r){var i=We,a=Zi.transition;Zi.transition=null;try{We=4,_f(e,t,n,r)}finally{We=i,Zi.transition=a}}function _f(e,t,n,r){if(xc){var i=Kd(e,t,n,r);if(i===null)$u(e,t,r,jc,n),fm(e,r);else if(Yw(i,e,t,n,r))r.stopPropagation();else if(fm(e,r),t&4&&-1<Gw.indexOf(e)){for(;i!==null;){var a=nl(i);if(a!==null&&Rv(a),a=Kd(e,t,n,r),a===null&&$u(e,t,r,jc,n),a===i)break;i=a}i!==null&&r.stopPropagation()}else $u(e,t,r,null,n)}}var jc=null;function Kd(e,t,n,r){if(jc=null,e=wf(r),e=Ws(e),e!==null)if(t=pi(e),t===null)e=null;else if(n=t.tag,n===13){if(e=Sv(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return jc=e,null}function Dv(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Uw()){case Sf:return 1;case Av:return 4;case yc:case Bw:return 16;case Cv:return 536870912;default:return 16}default:return 16}}var ns=null,Af=null,Gl=null;function Mv(){if(Gl)return Gl;var e,t=Af,n=t.length,r,i="value"in ns?ns.value:ns.textContent,a=i.length;for(e=0;e<n&&t[e]===i[e];e++);var o=n-e;for(r=1;r<=o&&t[n-r]===i[a-r];r++);return Gl=i.slice(e,1<r?1-r:void 0)}function Yl(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function vl(){return!0}function mm(){return!1}function Sn(e){function t(n,r,i,a,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=a,this.target=o,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(n=e[l],this[l]=n?n(a):a[l]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?vl:mm,this.isPropagationStopped=mm,this}return ut(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=vl)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=vl)},persist:function(){},isPersistent:vl}),t}var ja={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Cf=Sn(ja),tl=ut({},ja,{view:0,detail:0}),Zw=Sn(tl),Tu,Ou,$a,Zc=ut({},tl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:kf,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==$a&&($a&&e.type==="mousemove"?(Tu=e.screenX-$a.screenX,Ou=e.screenY-$a.screenY):Ou=Tu=0,$a=e),Tu)},movementY:function(e){return"movementY"in e?e.movementY:Ou}}),gm=Sn(Zc),Xw=ut({},Zc,{dataTransfer:0}),eS=Sn(Xw),tS=ut({},tl,{relatedTarget:0}),Pu=Sn(tS),nS=ut({},ja,{animationName:0,elapsedTime:0,pseudoElement:0}),rS=Sn(nS),sS=ut({},ja,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),iS=Sn(sS),aS=ut({},ja,{data:0}),ym=Sn(aS),oS={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},lS={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},cS={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function uS(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=cS[e])?!!t[e]:!1}function kf(){return uS}var dS=ut({},tl,{key:function(e){if(e.key){var t=oS[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Yl(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?lS[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:kf,charCode:function(e){return e.type==="keypress"?Yl(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Yl(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),hS=Sn(dS),fS=ut({},Zc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),vm=Sn(fS),pS=ut({},tl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:kf}),mS=Sn(pS),gS=ut({},ja,{propertyName:0,elapsedTime:0,pseudoElement:0}),yS=Sn(gS),vS=ut({},Zc,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),xS=Sn(vS),jS=[9,13,27,32],If=Ur&&"CompositionEvent"in window,uo=null;Ur&&"documentMode"in document&&(uo=document.documentMode);var bS=Ur&&"TextEvent"in window&&!uo,Uv=Ur&&(!If||uo&&8<uo&&11>=uo),xm=" ",jm=!1;function Bv(e,t){switch(e){case"keyup":return jS.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Vv(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Di=!1;function wS(e,t){switch(e){case"compositionend":return Vv(t);case"keypress":return t.which!==32?null:(jm=!0,xm);case"textInput":return e=t.data,e===xm&&jm?null:e;default:return null}}function SS(e,t){if(Di)return e==="compositionend"||!If&&Bv(e,t)?(e=Mv(),Gl=Af=ns=null,Di=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Uv&&t.locale!=="ko"?null:t.data;default:return null}}var ES={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function bm(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!ES[e.type]:t==="textarea"}function $v(e,t,n,r){vv(r),t=bc(t,"onChange"),0<t.length&&(n=new Cf("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var ho=null,ko=null;function NS(e){Zv(e,0)}function Xc(e){var t=Bi(e);if(dv(t))return e}function _S(e,t){if(e==="change")return t}var Fv=!1;if(Ur){var Lu;if(Ur){var Du="oninput"in document;if(!Du){var wm=document.createElement("div");wm.setAttribute("oninput","return;"),Du=typeof wm.oninput=="function"}Lu=Du}else Lu=!1;Fv=Lu&&(!document.documentMode||9<document.documentMode)}function Sm(){ho&&(ho.detachEvent("onpropertychange",Hv),ko=ho=null)}function Hv(e){if(e.propertyName==="value"&&Xc(ko)){var t=[];$v(t,ko,e,wf(e)),wv(NS,t)}}function AS(e,t,n){e==="focusin"?(Sm(),ho=t,ko=n,ho.attachEvent("onpropertychange",Hv)):e==="focusout"&&Sm()}function CS(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Xc(ko)}function kS(e,t){if(e==="click")return Xc(t)}function IS(e,t){if(e==="input"||e==="change")return Xc(t)}function RS(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Zn=typeof Object.is=="function"?Object.is:RS;function Io(e,t){if(Zn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!Rd.call(t,i)||!Zn(e[i],t[i]))return!1}return!0}function Em(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Nm(e,t){var n=Em(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Em(n)}}function qv(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?qv(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function zv(){for(var e=window,t=pc();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=pc(e.document)}return t}function Rf(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function TS(e){var t=zv(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&qv(n.ownerDocument.documentElement,n)){if(r!==null&&Rf(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=n.textContent.length,a=Math.min(r.start,i);r=r.end===void 0?a:Math.min(r.end,i),!e.extend&&a>r&&(i=r,r=a,a=i),i=Nm(n,a);var o=Nm(n,r);i&&o&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),a>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var OS=Ur&&"documentMode"in document&&11>=document.documentMode,Mi=null,Jd=null,fo=null,Qd=!1;function _m(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Qd||Mi==null||Mi!==pc(r)||(r=Mi,"selectionStart"in r&&Rf(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),fo&&Io(fo,r)||(fo=r,r=bc(Jd,"onSelect"),0<r.length&&(t=new Cf("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=Mi)))}function xl(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Ui={animationend:xl("Animation","AnimationEnd"),animationiteration:xl("Animation","AnimationIteration"),animationstart:xl("Animation","AnimationStart"),transitionend:xl("Transition","TransitionEnd")},Mu={},Wv={};Ur&&(Wv=document.createElement("div").style,"AnimationEvent"in window||(delete Ui.animationend.animation,delete Ui.animationiteration.animation,delete Ui.animationstart.animation),"TransitionEvent"in window||delete Ui.transitionend.transition);function eu(e){if(Mu[e])return Mu[e];if(!Ui[e])return e;var t=Ui[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in Wv)return Mu[e]=t[n];return e}var Gv=eu("animationend"),Yv=eu("animationiteration"),Kv=eu("animationstart"),Jv=eu("transitionend"),Qv=new Map,Am="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ss(e,t){Qv.set(e,t),fi(t,[e])}for(var Uu=0;Uu<Am.length;Uu++){var Bu=Am[Uu],PS=Bu.toLowerCase(),LS=Bu[0].toUpperCase()+Bu.slice(1);Ss(PS,"on"+LS)}Ss(Gv,"onAnimationEnd");Ss(Yv,"onAnimationIteration");Ss(Kv,"onAnimationStart");Ss("dblclick","onDoubleClick");Ss("focusin","onFocus");Ss("focusout","onBlur");Ss(Jv,"onTransitionEnd");aa("onMouseEnter",["mouseout","mouseover"]);aa("onMouseLeave",["mouseout","mouseover"]);aa("onPointerEnter",["pointerout","pointerover"]);aa("onPointerLeave",["pointerout","pointerover"]);fi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));fi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));fi("onBeforeInput",["compositionend","keypress","textInput","paste"]);fi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));fi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));fi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var to="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),DS=new Set("cancel close invalid load scroll toggle".split(" ").concat(to));function Cm(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,Pw(r,t,void 0,e),e.currentTarget=null}function Zv(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var a=void 0;if(t)for(var o=r.length-1;0<=o;o--){var l=r[o],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==a&&i.isPropagationStopped())break e;Cm(i,l,u),a=c}else for(o=0;o<r.length;o++){if(l=r[o],c=l.instance,u=l.currentTarget,l=l.listener,c!==a&&i.isPropagationStopped())break e;Cm(i,l,u),a=c}}}if(gc)throw e=Wd,gc=!1,Wd=null,e}function Qe(e,t){var n=t[nh];n===void 0&&(n=t[nh]=new Set);var r=e+"__bubble";n.has(r)||(Xv(t,e,2,!1),n.add(r))}function Vu(e,t,n){var r=0;t&&(r|=4),Xv(n,e,r,t)}var jl="_reactListening"+Math.random().toString(36).slice(2);function Ro(e){if(!e[jl]){e[jl]=!0,av.forEach(function(n){n!=="selectionchange"&&(DS.has(n)||Vu(n,!1,e),Vu(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[jl]||(t[jl]=!0,Vu("selectionchange",!1,t))}}function Xv(e,t,n,r){switch(Dv(t)){case 1:var i=Jw;break;case 4:i=Qw;break;default:i=_f}n=i.bind(null,t,n,e),i=void 0,!zd||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),r?i!==void 0?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):i!==void 0?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function $u(e,t,n,r,i){var a=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===i||l.nodeType===8&&l.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;o=o.return}for(;l!==null;){if(o=Ws(l),o===null)return;if(c=o.tag,c===5||c===6){r=a=o;continue e}l=l.parentNode}}r=r.return}wv(function(){var u=a,d=wf(n),p=[];e:{var h=Qv.get(e);if(h!==void 0){var f=Cf,v=e;switch(e){case"keypress":if(Yl(n)===0)break e;case"keydown":case"keyup":f=hS;break;case"focusin":v="focus",f=Pu;break;case"focusout":v="blur",f=Pu;break;case"beforeblur":case"afterblur":f=Pu;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=gm;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=eS;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=mS;break;case Gv:case Yv:case Kv:f=rS;break;case Jv:f=yS;break;case"scroll":f=Zw;break;case"wheel":f=xS;break;case"copy":case"cut":case"paste":f=iS;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=vm}var j=(t&4)!==0,_=!j&&e==="scroll",m=j?h!==null?h+"Capture":null:h;j=[];for(var y=u,b;y!==null;){b=y;var N=b.stateNode;if(b.tag===5&&N!==null&&(b=N,m!==null&&(N=No(y,m),N!=null&&j.push(To(y,N,b)))),_)break;y=y.return}0<j.length&&(h=new f(h,v,null,n,d),p.push({event:h,listeners:j}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",f=e==="mouseout"||e==="pointerout",h&&n!==Hd&&(v=n.relatedTarget||n.fromElement)&&(Ws(v)||v[Br]))break e;if((f||h)&&(h=d.window===d?d:(h=d.ownerDocument)?h.defaultView||h.parentWindow:window,f?(v=n.relatedTarget||n.toElement,f=u,v=v?Ws(v):null,v!==null&&(_=pi(v),v!==_||v.tag!==5&&v.tag!==6)&&(v=null)):(f=null,v=u),f!==v)){if(j=gm,N="onMouseLeave",m="onMouseEnter",y="mouse",(e==="pointerout"||e==="pointerover")&&(j=vm,N="onPointerLeave",m="onPointerEnter",y="pointer"),_=f==null?h:Bi(f),b=v==null?h:Bi(v),h=new j(N,y+"leave",f,n,d),h.target=_,h.relatedTarget=b,N=null,Ws(d)===u&&(j=new j(m,y+"enter",v,n,d),j.target=b,j.relatedTarget=_,N=j),_=N,f&&v)t:{for(j=f,m=v,y=0,b=j;b;b=Ci(b))y++;for(b=0,N=m;N;N=Ci(N))b++;for(;0<y-b;)j=Ci(j),y--;for(;0<b-y;)m=Ci(m),b--;for(;y--;){if(j===m||m!==null&&j===m.alternate)break t;j=Ci(j),m=Ci(m)}j=null}else j=null;f!==null&&km(p,h,f,j,!1),v!==null&&_!==null&&km(p,_,v,j,!0)}}e:{if(h=u?Bi(u):window,f=h.nodeName&&h.nodeName.toLowerCase(),f==="select"||f==="input"&&h.type==="file")var A=_S;else if(bm(h))if(Fv)A=IS;else{A=CS;var E=AS}else(f=h.nodeName)&&f.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(A=kS);if(A&&(A=A(e,u))){$v(p,A,n,d);break e}E&&E(e,h,u),e==="focusout"&&(E=h._wrapperState)&&E.controlled&&h.type==="number"&&Ud(h,"number",h.value)}switch(E=u?Bi(u):window,e){case"focusin":(bm(E)||E.contentEditable==="true")&&(Mi=E,Jd=u,fo=null);break;case"focusout":fo=Jd=Mi=null;break;case"mousedown":Qd=!0;break;case"contextmenu":case"mouseup":case"dragend":Qd=!1,_m(p,n,d);break;case"selectionchange":if(OS)break;case"keydown":case"keyup":_m(p,n,d)}var R;if(If)e:{switch(e){case"compositionstart":var I="onCompositionStart";break e;case"compositionend":I="onCompositionEnd";break e;case"compositionupdate":I="onCompositionUpdate";break e}I=void 0}else Di?Bv(e,n)&&(I="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(I="onCompositionStart");I&&(Uv&&n.locale!=="ko"&&(Di||I!=="onCompositionStart"?I==="onCompositionEnd"&&Di&&(R=Mv()):(ns=d,Af="value"in ns?ns.value:ns.textContent,Di=!0)),E=bc(u,I),0<E.length&&(I=new ym(I,e,null,n,d),p.push({event:I,listeners:E}),R?I.data=R:(R=Vv(n),R!==null&&(I.data=R)))),(R=bS?wS(e,n):SS(e,n))&&(u=bc(u,"onBeforeInput"),0<u.length&&(d=new ym("onBeforeInput","beforeinput",null,n,d),p.push({event:d,listeners:u}),d.data=R))}Zv(p,t)})}function To(e,t,n){return{instance:e,listener:t,currentTarget:n}}function bc(e,t){for(var n=t+"Capture",r=[];e!==null;){var i=e,a=i.stateNode;i.tag===5&&a!==null&&(i=a,a=No(e,n),a!=null&&r.unshift(To(e,a,i)),a=No(e,t),a!=null&&r.push(To(e,a,i))),e=e.return}return r}function Ci(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function km(e,t,n,r,i){for(var a=t._reactName,o=[];n!==null&&n!==r;){var l=n,c=l.alternate,u=l.stateNode;if(c!==null&&c===r)break;l.tag===5&&u!==null&&(l=u,i?(c=No(n,a),c!=null&&o.unshift(To(n,c,l))):i||(c=No(n,a),c!=null&&o.push(To(n,c,l)))),n=n.return}o.length!==0&&e.push({event:t,listeners:o})}var MS=/\r\n?/g,US=/\u0000|\uFFFD/g;function Im(e){return(typeof e=="string"?e:""+e).replace(MS,`
`).replace(US,"")}function bl(e,t,n){if(t=Im(t),Im(e)!==t&&n)throw Error(ee(425))}function wc(){}var Zd=null,Xd=null;function eh(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var th=typeof setTimeout=="function"?setTimeout:void 0,BS=typeof clearTimeout=="function"?clearTimeout:void 0,Rm=typeof Promise=="function"?Promise:void 0,VS=typeof queueMicrotask=="function"?queueMicrotask:typeof Rm<"u"?function(e){return Rm.resolve(null).then(e).catch($S)}:th;function $S(e){setTimeout(function(){throw e})}function Fu(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){e.removeChild(i),Co(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);Co(t)}function us(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Tm(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var ba=Math.random().toString(36).slice(2),lr="__reactFiber$"+ba,Oo="__reactProps$"+ba,Br="__reactContainer$"+ba,nh="__reactEvents$"+ba,FS="__reactListeners$"+ba,HS="__reactHandles$"+ba;function Ws(e){var t=e[lr];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Br]||n[lr]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=Tm(e);e!==null;){if(n=e[lr])return n;e=Tm(e)}return t}e=n,n=e.parentNode}return null}function nl(e){return e=e[lr]||e[Br],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Bi(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(ee(33))}function tu(e){return e[Oo]||null}var rh=[],Vi=-1;function Es(e){return{current:e}}function Xe(e){0>Vi||(e.current=rh[Vi],rh[Vi]=null,Vi--)}function Je(e,t){Vi++,rh[Vi]=e.current,e.current=t}var bs={},Kt=Es(bs),cn=Es(!1),ii=bs;function oa(e,t){var n=e.type.contextTypes;if(!n)return bs;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i={},a;for(a in n)i[a]=t[a];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function un(e){return e=e.childContextTypes,e!=null}function Sc(){Xe(cn),Xe(Kt)}function Om(e,t,n){if(Kt.current!==bs)throw Error(ee(168));Je(Kt,t),Je(cn,n)}function ex(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in t))throw Error(ee(108,Aw(e)||"Unknown",i));return ut({},n,r)}function Ec(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||bs,ii=Kt.current,Je(Kt,e),Je(cn,cn.current),!0}function Pm(e,t,n){var r=e.stateNode;if(!r)throw Error(ee(169));n?(e=ex(e,t,ii),r.__reactInternalMemoizedMergedChildContext=e,Xe(cn),Xe(Kt),Je(Kt,e)):Xe(cn),Je(cn,n)}var kr=null,nu=!1,Hu=!1;function tx(e){kr===null?kr=[e]:kr.push(e)}function qS(e){nu=!0,tx(e)}function Ns(){if(!Hu&&kr!==null){Hu=!0;var e=0,t=We;try{var n=kr;for(We=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}kr=null,nu=!1}catch(i){throw kr!==null&&(kr=kr.slice(e+1)),_v(Sf,Ns),i}finally{We=t,Hu=!1}}return null}var $i=[],Fi=0,Nc=null,_c=0,Cn=[],kn=0,ai=null,Or=1,Pr="";function $s(e,t){$i[Fi++]=_c,$i[Fi++]=Nc,Nc=e,_c=t}function nx(e,t,n){Cn[kn++]=Or,Cn[kn++]=Pr,Cn[kn++]=ai,ai=e;var r=Or;e=Pr;var i=32-Jn(r)-1;r&=~(1<<i),n+=1;var a=32-Jn(t)+i;if(30<a){var o=i-i%5;a=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Or=1<<32-Jn(t)+i|n<<i|r,Pr=a+e}else Or=1<<a|n<<i|r,Pr=e}function Tf(e){e.return!==null&&($s(e,1),nx(e,1,0))}function Of(e){for(;e===Nc;)Nc=$i[--Fi],$i[Fi]=null,_c=$i[--Fi],$i[Fi]=null;for(;e===ai;)ai=Cn[--kn],Cn[kn]=null,Pr=Cn[--kn],Cn[kn]=null,Or=Cn[--kn],Cn[kn]=null}var jn=null,vn=null,nt=!1,Gn=null;function rx(e,t){var n=Tn(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function Lm(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,jn=e,vn=us(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,jn=e,vn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=ai!==null?{id:Or,overflow:Pr}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=Tn(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,jn=e,vn=null,!0):!1;default:return!1}}function sh(e){return(e.mode&1)!==0&&(e.flags&128)===0}function ih(e){if(nt){var t=vn;if(t){var n=t;if(!Lm(e,t)){if(sh(e))throw Error(ee(418));t=us(n.nextSibling);var r=jn;t&&Lm(e,t)?rx(r,n):(e.flags=e.flags&-4097|2,nt=!1,jn=e)}}else{if(sh(e))throw Error(ee(418));e.flags=e.flags&-4097|2,nt=!1,jn=e}}}function Dm(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;jn=e}function wl(e){if(e!==jn)return!1;if(!nt)return Dm(e),nt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!eh(e.type,e.memoizedProps)),t&&(t=vn)){if(sh(e))throw sx(),Error(ee(418));for(;t;)rx(e,t),t=us(t.nextSibling)}if(Dm(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(ee(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){vn=us(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}vn=null}}else vn=jn?us(e.stateNode.nextSibling):null;return!0}function sx(){for(var e=vn;e;)e=us(e.nextSibling)}function la(){vn=jn=null,nt=!1}function Pf(e){Gn===null?Gn=[e]:Gn.push(e)}var zS=Fr.ReactCurrentBatchConfig;function Fa(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ee(309));var r=n.stateNode}if(!r)throw Error(ee(147,e));var i=r,a=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===a?t.ref:(t=function(o){var l=i.refs;o===null?delete l[a]:l[a]=o},t._stringRef=a,t)}if(typeof e!="string")throw Error(ee(284));if(!n._owner)throw Error(ee(290,e))}return e}function Sl(e,t){throw e=Object.prototype.toString.call(t),Error(ee(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Mm(e){var t=e._init;return t(e._payload)}function ix(e){function t(m,y){if(e){var b=m.deletions;b===null?(m.deletions=[y],m.flags|=16):b.push(y)}}function n(m,y){if(!e)return null;for(;y!==null;)t(m,y),y=y.sibling;return null}function r(m,y){for(m=new Map;y!==null;)y.key!==null?m.set(y.key,y):m.set(y.index,y),y=y.sibling;return m}function i(m,y){return m=ps(m,y),m.index=0,m.sibling=null,m}function a(m,y,b){return m.index=b,e?(b=m.alternate,b!==null?(b=b.index,b<y?(m.flags|=2,y):b):(m.flags|=2,y)):(m.flags|=1048576,y)}function o(m){return e&&m.alternate===null&&(m.flags|=2),m}function l(m,y,b,N){return y===null||y.tag!==6?(y=Ju(b,m.mode,N),y.return=m,y):(y=i(y,b),y.return=m,y)}function c(m,y,b,N){var A=b.type;return A===Li?d(m,y,b.props.children,N,b.key):y!==null&&(y.elementType===A||typeof A=="object"&&A!==null&&A.$$typeof===Kr&&Mm(A)===y.type)?(N=i(y,b.props),N.ref=Fa(m,y,b),N.return=m,N):(N=tc(b.type,b.key,b.props,null,m.mode,N),N.ref=Fa(m,y,b),N.return=m,N)}function u(m,y,b,N){return y===null||y.tag!==4||y.stateNode.containerInfo!==b.containerInfo||y.stateNode.implementation!==b.implementation?(y=Qu(b,m.mode,N),y.return=m,y):(y=i(y,b.children||[]),y.return=m,y)}function d(m,y,b,N,A){return y===null||y.tag!==7?(y=ti(b,m.mode,N,A),y.return=m,y):(y=i(y,b),y.return=m,y)}function p(m,y,b){if(typeof y=="string"&&y!==""||typeof y=="number")return y=Ju(""+y,m.mode,b),y.return=m,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case hl:return b=tc(y.type,y.key,y.props,null,m.mode,b),b.ref=Fa(m,null,y),b.return=m,b;case Pi:return y=Qu(y,m.mode,b),y.return=m,y;case Kr:var N=y._init;return p(m,N(y._payload),b)}if(Xa(y)||Ma(y))return y=ti(y,m.mode,b,null),y.return=m,y;Sl(m,y)}return null}function h(m,y,b,N){var A=y!==null?y.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return A!==null?null:l(m,y,""+b,N);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case hl:return b.key===A?c(m,y,b,N):null;case Pi:return b.key===A?u(m,y,b,N):null;case Kr:return A=b._init,h(m,y,A(b._payload),N)}if(Xa(b)||Ma(b))return A!==null?null:d(m,y,b,N,null);Sl(m,b)}return null}function f(m,y,b,N,A){if(typeof N=="string"&&N!==""||typeof N=="number")return m=m.get(b)||null,l(y,m,""+N,A);if(typeof N=="object"&&N!==null){switch(N.$$typeof){case hl:return m=m.get(N.key===null?b:N.key)||null,c(y,m,N,A);case Pi:return m=m.get(N.key===null?b:N.key)||null,u(y,m,N,A);case Kr:var E=N._init;return f(m,y,b,E(N._payload),A)}if(Xa(N)||Ma(N))return m=m.get(b)||null,d(y,m,N,A,null);Sl(y,N)}return null}function v(m,y,b,N){for(var A=null,E=null,R=y,I=y=0,T=null;R!==null&&I<b.length;I++){R.index>I?(T=R,R=null):T=R.sibling;var L=h(m,R,b[I],N);if(L===null){R===null&&(R=T);break}e&&R&&L.alternate===null&&t(m,R),y=a(L,y,I),E===null?A=L:E.sibling=L,E=L,R=T}if(I===b.length)return n(m,R),nt&&$s(m,I),A;if(R===null){for(;I<b.length;I++)R=p(m,b[I],N),R!==null&&(y=a(R,y,I),E===null?A=R:E.sibling=R,E=R);return nt&&$s(m,I),A}for(R=r(m,R);I<b.length;I++)T=f(R,m,I,b[I],N),T!==null&&(e&&T.alternate!==null&&R.delete(T.key===null?I:T.key),y=a(T,y,I),E===null?A=T:E.sibling=T,E=T);return e&&R.forEach(function(B){return t(m,B)}),nt&&$s(m,I),A}function j(m,y,b,N){var A=Ma(b);if(typeof A!="function")throw Error(ee(150));if(b=A.call(b),b==null)throw Error(ee(151));for(var E=A=null,R=y,I=y=0,T=null,L=b.next();R!==null&&!L.done;I++,L=b.next()){R.index>I?(T=R,R=null):T=R.sibling;var B=h(m,R,L.value,N);if(B===null){R===null&&(R=T);break}e&&R&&B.alternate===null&&t(m,R),y=a(B,y,I),E===null?A=B:E.sibling=B,E=B,R=T}if(L.done)return n(m,R),nt&&$s(m,I),A;if(R===null){for(;!L.done;I++,L=b.next())L=p(m,L.value,N),L!==null&&(y=a(L,y,I),E===null?A=L:E.sibling=L,E=L);return nt&&$s(m,I),A}for(R=r(m,R);!L.done;I++,L=b.next())L=f(R,m,I,L.value,N),L!==null&&(e&&L.alternate!==null&&R.delete(L.key===null?I:L.key),y=a(L,y,I),E===null?A=L:E.sibling=L,E=L);return e&&R.forEach(function(W){return t(m,W)}),nt&&$s(m,I),A}function _(m,y,b,N){if(typeof b=="object"&&b!==null&&b.type===Li&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case hl:e:{for(var A=b.key,E=y;E!==null;){if(E.key===A){if(A=b.type,A===Li){if(E.tag===7){n(m,E.sibling),y=i(E,b.props.children),y.return=m,m=y;break e}}else if(E.elementType===A||typeof A=="object"&&A!==null&&A.$$typeof===Kr&&Mm(A)===E.type){n(m,E.sibling),y=i(E,b.props),y.ref=Fa(m,E,b),y.return=m,m=y;break e}n(m,E);break}else t(m,E);E=E.sibling}b.type===Li?(y=ti(b.props.children,m.mode,N,b.key),y.return=m,m=y):(N=tc(b.type,b.key,b.props,null,m.mode,N),N.ref=Fa(m,y,b),N.return=m,m=N)}return o(m);case Pi:e:{for(E=b.key;y!==null;){if(y.key===E)if(y.tag===4&&y.stateNode.containerInfo===b.containerInfo&&y.stateNode.implementation===b.implementation){n(m,y.sibling),y=i(y,b.children||[]),y.return=m,m=y;break e}else{n(m,y);break}else t(m,y);y=y.sibling}y=Qu(b,m.mode,N),y.return=m,m=y}return o(m);case Kr:return E=b._init,_(m,y,E(b._payload),N)}if(Xa(b))return v(m,y,b,N);if(Ma(b))return j(m,y,b,N);Sl(m,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,y!==null&&y.tag===6?(n(m,y.sibling),y=i(y,b),y.return=m,m=y):(n(m,y),y=Ju(b,m.mode,N),y.return=m,m=y),o(m)):n(m,y)}return _}var ca=ix(!0),ax=ix(!1),Ac=Es(null),Cc=null,Hi=null,Lf=null;function Df(){Lf=Hi=Cc=null}function Mf(e){var t=Ac.current;Xe(Ac),e._currentValue=t}function ah(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Xi(e,t){Cc=e,Lf=Hi=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(an=!0),e.firstContext=null)}function Pn(e){var t=e._currentValue;if(Lf!==e)if(e={context:e,memoizedValue:t,next:null},Hi===null){if(Cc===null)throw Error(ee(308));Hi=e,Cc.dependencies={lanes:0,firstContext:e}}else Hi=Hi.next=e;return t}var Gs=null;function Uf(e){Gs===null?Gs=[e]:Gs.push(e)}function ox(e,t,n,r){var i=t.interleaved;return i===null?(n.next=n,Uf(t)):(n.next=i.next,i.next=n),t.interleaved=n,Vr(e,r)}function Vr(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var Jr=!1;function Bf(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function lx(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Dr(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function ds(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,Ve&2){var i=r.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),r.pending=t,Vr(e,n)}return i=r.interleaved,i===null?(t.next=t,Uf(r)):(t.next=i.next,i.next=t),r.interleaved=t,Vr(e,n)}function Kl(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Ef(e,n)}}function Um(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,a=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};a===null?i=a=o:a=a.next=o,n=n.next}while(n!==null);a===null?i=a=t:a=a.next=t}else i=a=t;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function kc(e,t,n,r){var i=e.updateQueue;Jr=!1;var a=i.firstBaseUpdate,o=i.lastBaseUpdate,l=i.shared.pending;if(l!==null){i.shared.pending=null;var c=l,u=c.next;c.next=null,o===null?a=u:o.next=u,o=c;var d=e.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==o&&(l===null?d.firstBaseUpdate=u:l.next=u,d.lastBaseUpdate=c))}if(a!==null){var p=i.baseState;o=0,d=u=c=null,l=a;do{var h=l.lane,f=l.eventTime;if((r&h)===h){d!==null&&(d=d.next={eventTime:f,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var v=e,j=l;switch(h=t,f=n,j.tag){case 1:if(v=j.payload,typeof v=="function"){p=v.call(f,p,h);break e}p=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=j.payload,h=typeof v=="function"?v.call(f,p,h):v,h==null)break e;p=ut({},p,h);break e;case 2:Jr=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,h=i.effects,h===null?i.effects=[l]:h.push(l))}else f={eventTime:f,lane:h,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(u=d=f,c=p):d=d.next=f,o|=h;if(l=l.next,l===null){if(l=i.shared.pending,l===null)break;h=l,l=h.next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}while(!0);if(d===null&&(c=p),i.baseState=c,i.firstBaseUpdate=u,i.lastBaseUpdate=d,t=i.shared.interleaved,t!==null){i=t;do o|=i.lane,i=i.next;while(i!==t)}else a===null&&(i.shared.lanes=0);li|=o,e.lanes=o,e.memoizedState=p}}function Bm(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(ee(191,i));i.call(r)}}}var rl={},fr=Es(rl),Po=Es(rl),Lo=Es(rl);function Ys(e){if(e===rl)throw Error(ee(174));return e}function Vf(e,t){switch(Je(Lo,t),Je(Po,e),Je(fr,rl),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Vd(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Vd(t,e)}Xe(fr),Je(fr,t)}function ua(){Xe(fr),Xe(Po),Xe(Lo)}function cx(e){Ys(Lo.current);var t=Ys(fr.current),n=Vd(t,e.type);t!==n&&(Je(Po,e),Je(fr,n))}function $f(e){Po.current===e&&(Xe(fr),Xe(Po))}var ot=Es(0);function Ic(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var qu=[];function Ff(){for(var e=0;e<qu.length;e++)qu[e]._workInProgressVersionPrimary=null;qu.length=0}var Jl=Fr.ReactCurrentDispatcher,zu=Fr.ReactCurrentBatchConfig,oi=0,ct=null,At=null,Tt=null,Rc=!1,po=!1,Do=0,WS=0;function qt(){throw Error(ee(321))}function Hf(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Zn(e[n],t[n]))return!1;return!0}function qf(e,t,n,r,i,a){if(oi=a,ct=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Jl.current=e===null||e.memoizedState===null?JS:QS,e=n(r,i),po){a=0;do{if(po=!1,Do=0,25<=a)throw Error(ee(301));a+=1,Tt=At=null,t.updateQueue=null,Jl.current=ZS,e=n(r,i)}while(po)}if(Jl.current=Tc,t=At!==null&&At.next!==null,oi=0,Tt=At=ct=null,Rc=!1,t)throw Error(ee(300));return e}function zf(){var e=Do!==0;return Do=0,e}function or(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Tt===null?ct.memoizedState=Tt=e:Tt=Tt.next=e,Tt}function Ln(){if(At===null){var e=ct.alternate;e=e!==null?e.memoizedState:null}else e=At.next;var t=Tt===null?ct.memoizedState:Tt.next;if(t!==null)Tt=t,At=e;else{if(e===null)throw Error(ee(310));At=e,e={memoizedState:At.memoizedState,baseState:At.baseState,baseQueue:At.baseQueue,queue:At.queue,next:null},Tt===null?ct.memoizedState=Tt=e:Tt=Tt.next=e}return Tt}function Mo(e,t){return typeof t=="function"?t(e):t}function Wu(e){var t=Ln(),n=t.queue;if(n===null)throw Error(ee(311));n.lastRenderedReducer=e;var r=At,i=r.baseQueue,a=n.pending;if(a!==null){if(i!==null){var o=i.next;i.next=a.next,a.next=o}r.baseQueue=i=a,n.pending=null}if(i!==null){a=i.next,r=r.baseState;var l=o=null,c=null,u=a;do{var d=u.lane;if((oi&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var p={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=p,o=r):c=c.next=p,ct.lanes|=d,li|=d}u=u.next}while(u!==null&&u!==a);c===null?o=r:c.next=l,Zn(r,t.memoizedState)||(an=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=c,n.lastRenderedState=r}if(e=n.interleaved,e!==null){i=e;do a=i.lane,ct.lanes|=a,li|=a,i=i.next;while(i!==e)}else i===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Gu(e){var t=Ln(),n=t.queue;if(n===null)throw Error(ee(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,a=t.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do a=e(a,o.action),o=o.next;while(o!==i);Zn(a,t.memoizedState)||(an=!0),t.memoizedState=a,t.baseQueue===null&&(t.baseState=a),n.lastRenderedState=a}return[a,r]}function ux(){}function dx(e,t){var n=ct,r=Ln(),i=t(),a=!Zn(r.memoizedState,i);if(a&&(r.memoizedState=i,an=!0),r=r.queue,Wf(px.bind(null,n,r,e),[e]),r.getSnapshot!==t||a||Tt!==null&&Tt.memoizedState.tag&1){if(n.flags|=2048,Uo(9,fx.bind(null,n,r,i,t),void 0,null),Ot===null)throw Error(ee(349));oi&30||hx(n,t,i)}return i}function hx(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=ct.updateQueue,t===null?(t={lastEffect:null,stores:null},ct.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function fx(e,t,n,r){t.value=n,t.getSnapshot=r,mx(t)&&gx(e)}function px(e,t,n){return n(function(){mx(t)&&gx(e)})}function mx(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Zn(e,n)}catch{return!0}}function gx(e){var t=Vr(e,1);t!==null&&Qn(t,e,1,-1)}function Vm(e){var t=or();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Mo,lastRenderedState:e},t.queue=e,e=e.dispatch=KS.bind(null,ct,e),[t.memoizedState,e]}function Uo(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=ct.updateQueue,t===null?(t={lastEffect:null,stores:null},ct.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function yx(){return Ln().memoizedState}function Ql(e,t,n,r){var i=or();ct.flags|=e,i.memoizedState=Uo(1|t,n,void 0,r===void 0?null:r)}function ru(e,t,n,r){var i=Ln();r=r===void 0?null:r;var a=void 0;if(At!==null){var o=At.memoizedState;if(a=o.destroy,r!==null&&Hf(r,o.deps)){i.memoizedState=Uo(t,n,a,r);return}}ct.flags|=e,i.memoizedState=Uo(1|t,n,a,r)}function $m(e,t){return Ql(8390656,8,e,t)}function Wf(e,t){return ru(2048,8,e,t)}function vx(e,t){return ru(4,2,e,t)}function xx(e,t){return ru(4,4,e,t)}function jx(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function bx(e,t,n){return n=n!=null?n.concat([e]):null,ru(4,4,jx.bind(null,t,e),n)}function Gf(){}function wx(e,t){var n=Ln();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Hf(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Sx(e,t){var n=Ln();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Hf(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Ex(e,t,n){return oi&21?(Zn(n,t)||(n=kv(),ct.lanes|=n,li|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,an=!0),e.memoizedState=n)}function GS(e,t){var n=We;We=n!==0&&4>n?n:4,e(!0);var r=zu.transition;zu.transition={};try{e(!1),t()}finally{We=n,zu.transition=r}}function Nx(){return Ln().memoizedState}function YS(e,t,n){var r=fs(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},_x(e))Ax(t,n);else if(n=ox(e,t,n,r),n!==null){var i=tn();Qn(n,e,r,i),Cx(n,t,r)}}function KS(e,t,n){var r=fs(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(_x(e))Ax(t,i);else{var a=e.alternate;if(e.lanes===0&&(a===null||a.lanes===0)&&(a=t.lastRenderedReducer,a!==null))try{var o=t.lastRenderedState,l=a(o,n);if(i.hasEagerState=!0,i.eagerState=l,Zn(l,o)){var c=t.interleaved;c===null?(i.next=i,Uf(t)):(i.next=c.next,c.next=i),t.interleaved=i;return}}catch{}finally{}n=ox(e,t,i,r),n!==null&&(i=tn(),Qn(n,e,r,i),Cx(n,t,r))}}function _x(e){var t=e.alternate;return e===ct||t!==null&&t===ct}function Ax(e,t){po=Rc=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Cx(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Ef(e,n)}}var Tc={readContext:Pn,useCallback:qt,useContext:qt,useEffect:qt,useImperativeHandle:qt,useInsertionEffect:qt,useLayoutEffect:qt,useMemo:qt,useReducer:qt,useRef:qt,useState:qt,useDebugValue:qt,useDeferredValue:qt,useTransition:qt,useMutableSource:qt,useSyncExternalStore:qt,useId:qt,unstable_isNewReconciler:!1},JS={readContext:Pn,useCallback:function(e,t){return or().memoizedState=[e,t===void 0?null:t],e},useContext:Pn,useEffect:$m,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,Ql(4194308,4,jx.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Ql(4194308,4,e,t)},useInsertionEffect:function(e,t){return Ql(4,2,e,t)},useMemo:function(e,t){var n=or();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=or();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=YS.bind(null,ct,e),[r.memoizedState,e]},useRef:function(e){var t=or();return e={current:e},t.memoizedState=e},useState:Vm,useDebugValue:Gf,useDeferredValue:function(e){return or().memoizedState=e},useTransition:function(){var e=Vm(!1),t=e[0];return e=GS.bind(null,e[1]),or().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=ct,i=or();if(nt){if(n===void 0)throw Error(ee(407));n=n()}else{if(n=t(),Ot===null)throw Error(ee(349));oi&30||hx(r,t,n)}i.memoizedState=n;var a={value:n,getSnapshot:t};return i.queue=a,$m(px.bind(null,r,a,e),[e]),r.flags|=2048,Uo(9,fx.bind(null,r,a,n,t),void 0,null),n},useId:function(){var e=or(),t=Ot.identifierPrefix;if(nt){var n=Pr,r=Or;n=(r&~(1<<32-Jn(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=Do++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=WS++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},QS={readContext:Pn,useCallback:wx,useContext:Pn,useEffect:Wf,useImperativeHandle:bx,useInsertionEffect:vx,useLayoutEffect:xx,useMemo:Sx,useReducer:Wu,useRef:yx,useState:function(){return Wu(Mo)},useDebugValue:Gf,useDeferredValue:function(e){var t=Ln();return Ex(t,At.memoizedState,e)},useTransition:function(){var e=Wu(Mo)[0],t=Ln().memoizedState;return[e,t]},useMutableSource:ux,useSyncExternalStore:dx,useId:Nx,unstable_isNewReconciler:!1},ZS={readContext:Pn,useCallback:wx,useContext:Pn,useEffect:Wf,useImperativeHandle:bx,useInsertionEffect:vx,useLayoutEffect:xx,useMemo:Sx,useReducer:Gu,useRef:yx,useState:function(){return Gu(Mo)},useDebugValue:Gf,useDeferredValue:function(e){var t=Ln();return At===null?t.memoizedState=e:Ex(t,At.memoizedState,e)},useTransition:function(){var e=Gu(Mo)[0],t=Ln().memoizedState;return[e,t]},useMutableSource:ux,useSyncExternalStore:dx,useId:Nx,unstable_isNewReconciler:!1};function qn(e,t){if(e&&e.defaultProps){t=ut({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function oh(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:ut({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var su={isMounted:function(e){return(e=e._reactInternals)?pi(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=tn(),i=fs(e),a=Dr(r,i);a.payload=t,n!=null&&(a.callback=n),t=ds(e,a,i),t!==null&&(Qn(t,e,i,r),Kl(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=tn(),i=fs(e),a=Dr(r,i);a.tag=1,a.payload=t,n!=null&&(a.callback=n),t=ds(e,a,i),t!==null&&(Qn(t,e,i,r),Kl(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=tn(),r=fs(e),i=Dr(n,r);i.tag=2,t!=null&&(i.callback=t),t=ds(e,i,r),t!==null&&(Qn(t,e,r,n),Kl(t,e,r))}};function Fm(e,t,n,r,i,a,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,a,o):t.prototype&&t.prototype.isPureReactComponent?!Io(n,r)||!Io(i,a):!0}function kx(e,t,n){var r=!1,i=bs,a=t.contextType;return typeof a=="object"&&a!==null?a=Pn(a):(i=un(t)?ii:Kt.current,r=t.contextTypes,a=(r=r!=null)?oa(e,i):bs),t=new t(n,a),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=su,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=a),t}function Hm(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&su.enqueueReplaceState(t,t.state,null)}function lh(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs={},Bf(e);var a=t.contextType;typeof a=="object"&&a!==null?i.context=Pn(a):(a=un(t)?ii:Kt.current,i.context=oa(e,a)),i.state=e.memoizedState,a=t.getDerivedStateFromProps,typeof a=="function"&&(oh(e,t,a,n),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&su.enqueueReplaceState(i,i.state,null),kc(e,n,i,r),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function da(e,t){try{var n="",r=t;do n+=_w(r),r=r.return;while(r);var i=n}catch(a){i=`
Error generating stack: `+a.message+`
`+a.stack}return{value:e,source:t,stack:i,digest:null}}function Yu(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function ch(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var XS=typeof WeakMap=="function"?WeakMap:Map;function Ix(e,t,n){n=Dr(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Pc||(Pc=!0,xh=r),ch(e,t)},n}function Rx(e,t,n){n=Dr(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){ch(e,t)}}var a=e.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(n.callback=function(){ch(e,t),typeof r!="function"&&(hs===null?hs=new Set([this]):hs.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),n}function qm(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new XS;var i=new Set;r.set(t,i)}else i=r.get(t),i===void 0&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=fE.bind(null,e,t,n),t.then(e,e))}function zm(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Wm(e,t,n,r,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=Dr(-1,1),t.tag=2,ds(n,t,1))),n.lanes|=1),e)}var eE=Fr.ReactCurrentOwner,an=!1;function Xt(e,t,n,r){t.child=e===null?ax(t,null,n,r):ca(t,e.child,n,r)}function Gm(e,t,n,r,i){n=n.render;var a=t.ref;return Xi(t,i),r=qf(e,t,n,r,a,i),n=zf(),e!==null&&!an?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,$r(e,t,i)):(nt&&n&&Tf(t),t.flags|=1,Xt(e,t,r,i),t.child)}function Ym(e,t,n,r,i){if(e===null){var a=n.type;return typeof a=="function"&&!tp(a)&&a.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=a,Tx(e,t,a,r,i)):(e=tc(n.type,null,r,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(a=e.child,!(e.lanes&i)){var o=a.memoizedProps;if(n=n.compare,n=n!==null?n:Io,n(o,r)&&e.ref===t.ref)return $r(e,t,i)}return t.flags|=1,e=ps(a,r),e.ref=t.ref,e.return=t,t.child=e}function Tx(e,t,n,r,i){if(e!==null){var a=e.memoizedProps;if(Io(a,r)&&e.ref===t.ref)if(an=!1,t.pendingProps=r=a,(e.lanes&i)!==0)e.flags&131072&&(an=!0);else return t.lanes=e.lanes,$r(e,t,i)}return uh(e,t,n,r,i)}function Ox(e,t,n){var r=t.pendingProps,i=r.children,a=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Je(zi,yn),yn|=n;else{if(!(n&1073741824))return e=a!==null?a.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Je(zi,yn),yn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=a!==null?a.baseLanes:n,Je(zi,yn),yn|=r}else a!==null?(r=a.baseLanes|n,t.memoizedState=null):r=n,Je(zi,yn),yn|=r;return Xt(e,t,i,n),t.child}function Px(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function uh(e,t,n,r,i){var a=un(n)?ii:Kt.current;return a=oa(t,a),Xi(t,i),n=qf(e,t,n,r,a,i),r=zf(),e!==null&&!an?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,$r(e,t,i)):(nt&&r&&Tf(t),t.flags|=1,Xt(e,t,n,i),t.child)}function Km(e,t,n,r,i){if(un(n)){var a=!0;Ec(t)}else a=!1;if(Xi(t,i),t.stateNode===null)Zl(e,t),kx(t,n,r),lh(t,n,r,i),r=!0;else if(e===null){var o=t.stateNode,l=t.memoizedProps;o.props=l;var c=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=Pn(u):(u=un(n)?ii:Kt.current,u=oa(t,u));var d=n.getDerivedStateFromProps,p=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";p||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||c!==u)&&Hm(t,o,r,u),Jr=!1;var h=t.memoizedState;o.state=h,kc(t,r,o,i),c=t.memoizedState,l!==r||h!==c||cn.current||Jr?(typeof d=="function"&&(oh(t,n,d,r),c=t.memoizedState),(l=Jr||Fm(t,n,l,r,h,c,u))?(p||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),o.props=r,o.state=c,o.context=u,r=l):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,lx(e,t),l=t.memoizedProps,u=t.type===t.elementType?l:qn(t.type,l),o.props=u,p=t.pendingProps,h=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=Pn(c):(c=un(n)?ii:Kt.current,c=oa(t,c));var f=n.getDerivedStateFromProps;(d=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==p||h!==c)&&Hm(t,o,r,c),Jr=!1,h=t.memoizedState,o.state=h,kc(t,r,o,i);var v=t.memoizedState;l!==p||h!==v||cn.current||Jr?(typeof f=="function"&&(oh(t,n,f,r),v=t.memoizedState),(u=Jr||Fm(t,n,u,r,h,v,c)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,v,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,v,c)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=v),o.props=r,o.state=v,o.context=c,r=u):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return dh(e,t,n,r,a,i)}function dh(e,t,n,r,i,a){Px(e,t);var o=(t.flags&128)!==0;if(!r&&!o)return i&&Pm(t,n,!1),$r(e,t,a);r=t.stateNode,eE.current=t;var l=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&o?(t.child=ca(t,e.child,null,a),t.child=ca(t,null,l,a)):Xt(e,t,l,a),t.memoizedState=r.state,i&&Pm(t,n,!0),t.child}function Lx(e){var t=e.stateNode;t.pendingContext?Om(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Om(e,t.context,!1),Vf(e,t.containerInfo)}function Jm(e,t,n,r,i){return la(),Pf(i),t.flags|=256,Xt(e,t,n,r),t.child}var hh={dehydrated:null,treeContext:null,retryLane:0};function fh(e){return{baseLanes:e,cachePool:null,transitions:null}}function Dx(e,t,n){var r=t.pendingProps,i=ot.current,a=!1,o=(t.flags&128)!==0,l;if((l=o)||(l=e!==null&&e.memoizedState===null?!1:(i&2)!==0),l?(a=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),Je(ot,i&1),e===null)return ih(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=r.children,e=r.fallback,a?(r=t.mode,a=t.child,o={mode:"hidden",children:o},!(r&1)&&a!==null?(a.childLanes=0,a.pendingProps=o):a=ou(o,r,0,null),e=ti(e,r,n,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=fh(n),t.memoizedState=hh,e):Yf(t,o));if(i=e.memoizedState,i!==null&&(l=i.dehydrated,l!==null))return tE(e,t,o,r,l,i,n);if(a){a=r.fallback,o=t.mode,i=e.child,l=i.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&t.child!==i?(r=t.child,r.childLanes=0,r.pendingProps=c,t.deletions=null):(r=ps(i,c),r.subtreeFlags=i.subtreeFlags&14680064),l!==null?a=ps(l,a):(a=ti(a,o,n,null),a.flags|=2),a.return=t,r.return=t,r.sibling=a,t.child=r,r=a,a=t.child,o=e.child.memoizedState,o=o===null?fh(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},a.memoizedState=o,a.childLanes=e.childLanes&~n,t.memoizedState=hh,r}return a=e.child,e=a.sibling,r=ps(a,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function Yf(e,t){return t=ou({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function El(e,t,n,r){return r!==null&&Pf(r),ca(t,e.child,null,n),e=Yf(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function tE(e,t,n,r,i,a,o){if(n)return t.flags&256?(t.flags&=-257,r=Yu(Error(ee(422))),El(e,t,o,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(a=r.fallback,i=t.mode,r=ou({mode:"visible",children:r.children},i,0,null),a=ti(a,i,o,null),a.flags|=2,r.return=t,a.return=t,r.sibling=a,t.child=r,t.mode&1&&ca(t,e.child,null,o),t.child.memoizedState=fh(o),t.memoizedState=hh,a);if(!(t.mode&1))return El(e,t,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var l=r.dgst;return r=l,a=Error(ee(419)),r=Yu(a,r,void 0),El(e,t,o,r)}if(l=(o&e.childLanes)!==0,an||l){if(r=Ot,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==a.retryLane&&(a.retryLane=i,Vr(e,i),Qn(r,e,i,-1))}return ep(),r=Yu(Error(ee(421))),El(e,t,o,r)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=pE.bind(null,e),i._reactRetry=t,null):(e=a.treeContext,vn=us(i.nextSibling),jn=t,nt=!0,Gn=null,e!==null&&(Cn[kn++]=Or,Cn[kn++]=Pr,Cn[kn++]=ai,Or=e.id,Pr=e.overflow,ai=t),t=Yf(t,r.children),t.flags|=4096,t)}function Qm(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),ah(e.return,t,n)}function Ku(e,t,n,r,i){var a=e.memoizedState;a===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailMode=i)}function Mx(e,t,n){var r=t.pendingProps,i=r.revealOrder,a=r.tail;if(Xt(e,t,r.children,n),r=ot.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Qm(e,n,t);else if(e.tag===19)Qm(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Je(ot,r),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;n!==null;)e=n.alternate,e!==null&&Ic(e)===null&&(i=n),n=n.sibling;n=i,n===null?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),Ku(t,!1,i,n,a);break;case"backwards":for(n=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&Ic(e)===null){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}Ku(t,!0,n,null,a);break;case"together":Ku(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Zl(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function $r(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),li|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(ee(153));if(t.child!==null){for(e=t.child,n=ps(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=ps(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function nE(e,t,n){switch(t.tag){case 3:Lx(t),la();break;case 5:cx(t);break;case 1:un(t.type)&&Ec(t);break;case 4:Vf(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;Je(Ac,r._currentValue),r._currentValue=i;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(Je(ot,ot.current&1),t.flags|=128,null):n&t.child.childLanes?Dx(e,t,n):(Je(ot,ot.current&1),e=$r(e,t,n),e!==null?e.sibling:null);Je(ot,ot.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return Mx(e,t,n);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Je(ot,ot.current),r)break;return null;case 22:case 23:return t.lanes=0,Ox(e,t,n)}return $r(e,t,n)}var Ux,ph,Bx,Vx;Ux=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};ph=function(){};Bx=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,Ys(fr.current);var a=null;switch(n){case"input":i=Dd(e,i),r=Dd(e,r),a=[];break;case"select":i=ut({},i,{value:void 0}),r=ut({},r,{value:void 0}),a=[];break;case"textarea":i=Bd(e,i),r=Bd(e,r),a=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=wc)}$d(n,r);var o;n=null;for(u in i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var l=i[u];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(So.hasOwnProperty(u)?a||(a=[]):(a=a||[]).push(u,null));for(u in r){var c=r[u];if(l=i!=null?i[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(a||(a=[]),a.push(u,n)),n=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(a=a||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(a=a||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(So.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&Qe("scroll",e),a||l===c||(a=[])):(a=a||[]).push(u,c))}n&&(a=a||[]).push("style",n);var u=a;(t.updateQueue=u)&&(t.flags|=4)}};Vx=function(e,t,n,r){n!==r&&(t.flags|=4)};function Ha(e,t){if(!nt)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function zt(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function rE(e,t,n){var r=t.pendingProps;switch(Of(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return zt(t),null;case 1:return un(t.type)&&Sc(),zt(t),null;case 3:return r=t.stateNode,ua(),Xe(cn),Xe(Kt),Ff(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(wl(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Gn!==null&&(wh(Gn),Gn=null))),ph(e,t),zt(t),null;case 5:$f(t);var i=Ys(Lo.current);if(n=t.type,e!==null&&t.stateNode!=null)Bx(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(ee(166));return zt(t),null}if(e=Ys(fr.current),wl(t)){r=t.stateNode,n=t.type;var a=t.memoizedProps;switch(r[lr]=t,r[Oo]=a,e=(t.mode&1)!==0,n){case"dialog":Qe("cancel",r),Qe("close",r);break;case"iframe":case"object":case"embed":Qe("load",r);break;case"video":case"audio":for(i=0;i<to.length;i++)Qe(to[i],r);break;case"source":Qe("error",r);break;case"img":case"image":case"link":Qe("error",r),Qe("load",r);break;case"details":Qe("toggle",r);break;case"input":am(r,a),Qe("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!a.multiple},Qe("invalid",r);break;case"textarea":lm(r,a),Qe("invalid",r)}$d(n,a),i=null;for(var o in a)if(a.hasOwnProperty(o)){var l=a[o];o==="children"?typeof l=="string"?r.textContent!==l&&(a.suppressHydrationWarning!==!0&&bl(r.textContent,l,e),i=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(a.suppressHydrationWarning!==!0&&bl(r.textContent,l,e),i=["children",""+l]):So.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Qe("scroll",r)}switch(n){case"input":fl(r),om(r,a,!0);break;case"textarea":fl(r),cm(r);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(r.onclick=wc)}r=i,t.updateQueue=r,r!==null&&(t.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=pv(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=o.createElement(n,{is:r.is}):(e=o.createElement(n),n==="select"&&(o=e,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):e=o.createElementNS(e,n),e[lr]=t,e[Oo]=r,Ux(e,t,!1,!1),t.stateNode=e;e:{switch(o=Fd(n,r),n){case"dialog":Qe("cancel",e),Qe("close",e),i=r;break;case"iframe":case"object":case"embed":Qe("load",e),i=r;break;case"video":case"audio":for(i=0;i<to.length;i++)Qe(to[i],e);i=r;break;case"source":Qe("error",e),i=r;break;case"img":case"image":case"link":Qe("error",e),Qe("load",e),i=r;break;case"details":Qe("toggle",e),i=r;break;case"input":am(e,r),i=Dd(e,r),Qe("invalid",e);break;case"option":i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=ut({},r,{value:void 0}),Qe("invalid",e);break;case"textarea":lm(e,r),i=Bd(e,r),Qe("invalid",e);break;default:i=r}$d(n,i),l=i;for(a in l)if(l.hasOwnProperty(a)){var c=l[a];a==="style"?yv(e,c):a==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&mv(e,c)):a==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&Eo(e,c):typeof c=="number"&&Eo(e,""+c):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(So.hasOwnProperty(a)?c!=null&&a==="onScroll"&&Qe("scroll",e):c!=null&&vf(e,a,c,o))}switch(n){case"input":fl(e),om(e,r,!1);break;case"textarea":fl(e),cm(e);break;case"option":r.value!=null&&e.setAttribute("value",""+js(r.value));break;case"select":e.multiple=!!r.multiple,a=r.value,a!=null?Ki(e,!!r.multiple,a,!1):r.defaultValue!=null&&Ki(e,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=wc)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return zt(t),null;case 6:if(e&&t.stateNode!=null)Vx(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(ee(166));if(n=Ys(Lo.current),Ys(fr.current),wl(t)){if(r=t.stateNode,n=t.memoizedProps,r[lr]=t,(a=r.nodeValue!==n)&&(e=jn,e!==null))switch(e.tag){case 3:bl(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&bl(r.nodeValue,n,(e.mode&1)!==0)}a&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[lr]=t,t.stateNode=r}return zt(t),null;case 13:if(Xe(ot),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(nt&&vn!==null&&t.mode&1&&!(t.flags&128))sx(),la(),t.flags|=98560,a=!1;else if(a=wl(t),r!==null&&r.dehydrated!==null){if(e===null){if(!a)throw Error(ee(318));if(a=t.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(ee(317));a[lr]=t}else la(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;zt(t),a=!1}else Gn!==null&&(wh(Gn),Gn=null),a=!0;if(!a)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||ot.current&1?Ct===0&&(Ct=3):ep())),t.updateQueue!==null&&(t.flags|=4),zt(t),null);case 4:return ua(),ph(e,t),e===null&&Ro(t.stateNode.containerInfo),zt(t),null;case 10:return Mf(t.type._context),zt(t),null;case 17:return un(t.type)&&Sc(),zt(t),null;case 19:if(Xe(ot),a=t.memoizedState,a===null)return zt(t),null;if(r=(t.flags&128)!==0,o=a.rendering,o===null)if(r)Ha(a,!1);else{if(Ct!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=Ic(e),o!==null){for(t.flags|=128,Ha(a,!1),r=o.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)a=n,e=r,a.flags&=14680066,o=a.alternate,o===null?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=o.childLanes,a.lanes=o.lanes,a.child=o.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=o.memoizedProps,a.memoizedState=o.memoizedState,a.updateQueue=o.updateQueue,a.type=o.type,e=o.dependencies,a.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Je(ot,ot.current&1|2),t.child}e=e.sibling}a.tail!==null&&vt()>ha&&(t.flags|=128,r=!0,Ha(a,!1),t.lanes=4194304)}else{if(!r)if(e=Ic(o),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),Ha(a,!0),a.tail===null&&a.tailMode==="hidden"&&!o.alternate&&!nt)return zt(t),null}else 2*vt()-a.renderingStartTime>ha&&n!==1073741824&&(t.flags|=128,r=!0,Ha(a,!1),t.lanes=4194304);a.isBackwards?(o.sibling=t.child,t.child=o):(n=a.last,n!==null?n.sibling=o:t.child=o,a.last=o)}return a.tail!==null?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=vt(),t.sibling=null,n=ot.current,Je(ot,r?n&1|2:n&1),t):(zt(t),null);case 22:case 23:return Xf(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?yn&1073741824&&(zt(t),t.subtreeFlags&6&&(t.flags|=8192)):zt(t),null;case 24:return null;case 25:return null}throw Error(ee(156,t.tag))}function sE(e,t){switch(Of(t),t.tag){case 1:return un(t.type)&&Sc(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return ua(),Xe(cn),Xe(Kt),Ff(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return $f(t),null;case 13:if(Xe(ot),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(ee(340));la()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Xe(ot),null;case 4:return ua(),null;case 10:return Mf(t.type._context),null;case 22:case 23:return Xf(),null;case 24:return null;default:return null}}var Nl=!1,Yt=!1,iE=typeof WeakSet=="function"?WeakSet:Set,de=null;function qi(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){ft(e,t,r)}else n.current=null}function mh(e,t,n){try{n()}catch(r){ft(e,t,r)}}var Zm=!1;function aE(e,t){if(Zd=xc,e=zv(),Rf(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,a=r.focusNode;r=r.focusOffset;try{n.nodeType,a.nodeType}catch{n=null;break e}var o=0,l=-1,c=-1,u=0,d=0,p=e,h=null;t:for(;;){for(var f;p!==n||i!==0&&p.nodeType!==3||(l=o+i),p!==a||r!==0&&p.nodeType!==3||(c=o+r),p.nodeType===3&&(o+=p.nodeValue.length),(f=p.firstChild)!==null;)h=p,p=f;for(;;){if(p===e)break t;if(h===n&&++u===i&&(l=o),h===a&&++d===r&&(c=o),(f=p.nextSibling)!==null)break;p=h,h=p.parentNode}p=f}n=l===-1||c===-1?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(Xd={focusedElem:e,selectionRange:n},xc=!1,de=t;de!==null;)if(t=de,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,de=e;else for(;de!==null;){t=de;try{var v=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var j=v.memoizedProps,_=v.memoizedState,m=t.stateNode,y=m.getSnapshotBeforeUpdate(t.elementType===t.type?j:qn(t.type,j),_);m.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var b=t.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ee(163))}}catch(N){ft(t,t.return,N)}if(e=t.sibling,e!==null){e.return=t.return,de=e;break}de=t.return}return v=Zm,Zm=!1,v}function mo(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&e)===e){var a=i.destroy;i.destroy=void 0,a!==void 0&&mh(t,n,a)}i=i.next}while(i!==r)}}function iu(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function gh(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function $x(e){var t=e.alternate;t!==null&&(e.alternate=null,$x(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[lr],delete t[Oo],delete t[nh],delete t[FS],delete t[HS])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Fx(e){return e.tag===5||e.tag===3||e.tag===4}function Xm(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Fx(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function yh(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=wc));else if(r!==4&&(e=e.child,e!==null))for(yh(e,t,n),e=e.sibling;e!==null;)yh(e,t,n),e=e.sibling}function vh(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(vh(e,t,n),e=e.sibling;e!==null;)vh(e,t,n),e=e.sibling}var Dt=null,zn=!1;function Wr(e,t,n){for(n=n.child;n!==null;)Hx(e,t,n),n=n.sibling}function Hx(e,t,n){if(hr&&typeof hr.onCommitFiberUnmount=="function")try{hr.onCommitFiberUnmount(Qc,n)}catch{}switch(n.tag){case 5:Yt||qi(n,t);case 6:var r=Dt,i=zn;Dt=null,Wr(e,t,n),Dt=r,zn=i,Dt!==null&&(zn?(e=Dt,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):Dt.removeChild(n.stateNode));break;case 18:Dt!==null&&(zn?(e=Dt,n=n.stateNode,e.nodeType===8?Fu(e.parentNode,n):e.nodeType===1&&Fu(e,n),Co(e)):Fu(Dt,n.stateNode));break;case 4:r=Dt,i=zn,Dt=n.stateNode.containerInfo,zn=!0,Wr(e,t,n),Dt=r,zn=i;break;case 0:case 11:case 14:case 15:if(!Yt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var a=i,o=a.destroy;a=a.tag,o!==void 0&&(a&2||a&4)&&mh(n,t,o),i=i.next}while(i!==r)}Wr(e,t,n);break;case 1:if(!Yt&&(qi(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){ft(n,t,l)}Wr(e,t,n);break;case 21:Wr(e,t,n);break;case 22:n.mode&1?(Yt=(r=Yt)||n.memoizedState!==null,Wr(e,t,n),Yt=r):Wr(e,t,n);break;default:Wr(e,t,n)}}function eg(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new iE),t.forEach(function(r){var i=mE.bind(null,e,r);n.has(r)||(n.add(r),r.then(i,i))})}}function $n(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var a=e,o=t,l=o;e:for(;l!==null;){switch(l.tag){case 5:Dt=l.stateNode,zn=!1;break e;case 3:Dt=l.stateNode.containerInfo,zn=!0;break e;case 4:Dt=l.stateNode.containerInfo,zn=!0;break e}l=l.return}if(Dt===null)throw Error(ee(160));Hx(a,o,i),Dt=null,zn=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(u){ft(i,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)qx(t,e),t=t.sibling}function qx(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if($n(t,e),sr(e),r&4){try{mo(3,e,e.return),iu(3,e)}catch(j){ft(e,e.return,j)}try{mo(5,e,e.return)}catch(j){ft(e,e.return,j)}}break;case 1:$n(t,e),sr(e),r&512&&n!==null&&qi(n,n.return);break;case 5:if($n(t,e),sr(e),r&512&&n!==null&&qi(n,n.return),e.flags&32){var i=e.stateNode;try{Eo(i,"")}catch(j){ft(e,e.return,j)}}if(r&4&&(i=e.stateNode,i!=null)){var a=e.memoizedProps,o=n!==null?n.memoizedProps:a,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&a.type==="radio"&&a.name!=null&&hv(i,a),Fd(l,o);var u=Fd(l,a);for(o=0;o<c.length;o+=2){var d=c[o],p=c[o+1];d==="style"?yv(i,p):d==="dangerouslySetInnerHTML"?mv(i,p):d==="children"?Eo(i,p):vf(i,d,p,u)}switch(l){case"input":Md(i,a);break;case"textarea":fv(i,a);break;case"select":var h=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!a.multiple;var f=a.value;f!=null?Ki(i,!!a.multiple,f,!1):h!==!!a.multiple&&(a.defaultValue!=null?Ki(i,!!a.multiple,a.defaultValue,!0):Ki(i,!!a.multiple,a.multiple?[]:"",!1))}i[Oo]=a}catch(j){ft(e,e.return,j)}}break;case 6:if($n(t,e),sr(e),r&4){if(e.stateNode===null)throw Error(ee(162));i=e.stateNode,a=e.memoizedProps;try{i.nodeValue=a}catch(j){ft(e,e.return,j)}}break;case 3:if($n(t,e),sr(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Co(t.containerInfo)}catch(j){ft(e,e.return,j)}break;case 4:$n(t,e),sr(e);break;case 13:$n(t,e),sr(e),i=e.child,i.flags&8192&&(a=i.memoizedState!==null,i.stateNode.isHidden=a,!a||i.alternate!==null&&i.alternate.memoizedState!==null||(Qf=vt())),r&4&&eg(e);break;case 22:if(d=n!==null&&n.memoizedState!==null,e.mode&1?(Yt=(u=Yt)||d,$n(t,e),Yt=u):$n(t,e),sr(e),r&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!d&&e.mode&1)for(de=e,d=e.child;d!==null;){for(p=de=d;de!==null;){switch(h=de,f=h.child,h.tag){case 0:case 11:case 14:case 15:mo(4,h,h.return);break;case 1:qi(h,h.return);var v=h.stateNode;if(typeof v.componentWillUnmount=="function"){r=h,n=h.return;try{t=r,v.props=t.memoizedProps,v.state=t.memoizedState,v.componentWillUnmount()}catch(j){ft(r,n,j)}}break;case 5:qi(h,h.return);break;case 22:if(h.memoizedState!==null){ng(p);continue}}f!==null?(f.return=h,de=f):ng(p)}d=d.sibling}e:for(d=null,p=e;;){if(p.tag===5){if(d===null){d=p;try{i=p.stateNode,u?(a=i.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(l=p.stateNode,c=p.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=gv("display",o))}catch(j){ft(e,e.return,j)}}}else if(p.tag===6){if(d===null)try{p.stateNode.nodeValue=u?"":p.memoizedProps}catch(j){ft(e,e.return,j)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===e)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===e)break e;for(;p.sibling===null;){if(p.return===null||p.return===e)break e;d===p&&(d=null),p=p.return}d===p&&(d=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:$n(t,e),sr(e),r&4&&eg(e);break;case 21:break;default:$n(t,e),sr(e)}}function sr(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(Fx(n)){var r=n;break e}n=n.return}throw Error(ee(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Eo(i,""),r.flags&=-33);var a=Xm(e);vh(e,a,i);break;case 3:case 4:var o=r.stateNode.containerInfo,l=Xm(e);yh(e,l,o);break;default:throw Error(ee(161))}}catch(c){ft(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function oE(e,t,n){de=e,zx(e)}function zx(e,t,n){for(var r=(e.mode&1)!==0;de!==null;){var i=de,a=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||Nl;if(!o){var l=i.alternate,c=l!==null&&l.memoizedState!==null||Yt;l=Nl;var u=Yt;if(Nl=o,(Yt=c)&&!u)for(de=i;de!==null;)o=de,c=o.child,o.tag===22&&o.memoizedState!==null?rg(i):c!==null?(c.return=o,de=c):rg(i);for(;a!==null;)de=a,zx(a),a=a.sibling;de=i,Nl=l,Yt=u}tg(e)}else i.subtreeFlags&8772&&a!==null?(a.return=i,de=a):tg(e)}}function tg(e){for(;de!==null;){var t=de;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Yt||iu(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!Yt)if(n===null)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:qn(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;a!==null&&Bm(t,a,r);break;case 3:var o=t.updateQueue;if(o!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}Bm(t,o,n)}break;case 5:var l=t.stateNode;if(n===null&&t.flags&4){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var p=d.dehydrated;p!==null&&Co(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ee(163))}Yt||t.flags&512&&gh(t)}catch(h){ft(t,t.return,h)}}if(t===e){de=null;break}if(n=t.sibling,n!==null){n.return=t.return,de=n;break}de=t.return}}function ng(e){for(;de!==null;){var t=de;if(t===e){de=null;break}var n=t.sibling;if(n!==null){n.return=t.return,de=n;break}de=t.return}}function rg(e){for(;de!==null;){var t=de;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{iu(4,t)}catch(c){ft(t,n,c)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var i=t.return;try{r.componentDidMount()}catch(c){ft(t,i,c)}}var a=t.return;try{gh(t)}catch(c){ft(t,a,c)}break;case 5:var o=t.return;try{gh(t)}catch(c){ft(t,o,c)}}}catch(c){ft(t,t.return,c)}if(t===e){de=null;break}var l=t.sibling;if(l!==null){l.return=t.return,de=l;break}de=t.return}}var lE=Math.ceil,Oc=Fr.ReactCurrentDispatcher,Kf=Fr.ReactCurrentOwner,On=Fr.ReactCurrentBatchConfig,Ve=0,Ot=null,bt=null,$t=0,yn=0,zi=Es(0),Ct=0,Bo=null,li=0,au=0,Jf=0,go=null,sn=null,Qf=0,ha=1/0,Cr=null,Pc=!1,xh=null,hs=null,_l=!1,rs=null,Lc=0,yo=0,jh=null,Xl=-1,ec=0;function tn(){return Ve&6?vt():Xl!==-1?Xl:Xl=vt()}function fs(e){return e.mode&1?Ve&2&&$t!==0?$t&-$t:zS.transition!==null?(ec===0&&(ec=kv()),ec):(e=We,e!==0||(e=window.event,e=e===void 0?16:Dv(e.type)),e):1}function Qn(e,t,n,r){if(50<yo)throw yo=0,jh=null,Error(ee(185));el(e,n,r),(!(Ve&2)||e!==Ot)&&(e===Ot&&(!(Ve&2)&&(au|=n),Ct===4&&Zr(e,$t)),dn(e,r),n===1&&Ve===0&&!(t.mode&1)&&(ha=vt()+500,nu&&Ns()))}function dn(e,t){var n=e.callbackNode;zw(e,t);var r=vc(e,e===Ot?$t:0);if(r===0)n!==null&&hm(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&hm(n),t===1)e.tag===0?qS(sg.bind(null,e)):tx(sg.bind(null,e)),VS(function(){!(Ve&6)&&Ns()}),n=null;else{switch(Iv(r)){case 1:n=Sf;break;case 4:n=Av;break;case 16:n=yc;break;case 536870912:n=Cv;break;default:n=yc}n=Xx(n,Wx.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function Wx(e,t){if(Xl=-1,ec=0,Ve&6)throw Error(ee(327));var n=e.callbackNode;if(ea()&&e.callbackNode!==n)return null;var r=vc(e,e===Ot?$t:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=Dc(e,r);else{t=r;var i=Ve;Ve|=2;var a=Yx();(Ot!==e||$t!==t)&&(Cr=null,ha=vt()+500,ei(e,t));do try{dE();break}catch(l){Gx(e,l)}while(!0);Df(),Oc.current=a,Ve=i,bt!==null?t=0:(Ot=null,$t=0,t=Ct)}if(t!==0){if(t===2&&(i=Gd(e),i!==0&&(r=i,t=bh(e,i))),t===1)throw n=Bo,ei(e,0),Zr(e,r),dn(e,vt()),n;if(t===6)Zr(e,r);else{if(i=e.current.alternate,!(r&30)&&!cE(i)&&(t=Dc(e,r),t===2&&(a=Gd(e),a!==0&&(r=a,t=bh(e,a))),t===1))throw n=Bo,ei(e,0),Zr(e,r),dn(e,vt()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(ee(345));case 2:Fs(e,sn,Cr);break;case 3:if(Zr(e,r),(r&130023424)===r&&(t=Qf+500-vt(),10<t)){if(vc(e,0)!==0)break;if(i=e.suspendedLanes,(i&r)!==r){tn(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=th(Fs.bind(null,e,sn,Cr),t);break}Fs(e,sn,Cr);break;case 4:if(Zr(e,r),(r&4194240)===r)break;for(t=e.eventTimes,i=-1;0<r;){var o=31-Jn(r);a=1<<o,o=t[o],o>i&&(i=o),r&=~a}if(r=i,r=vt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*lE(r/1960))-r,10<r){e.timeoutHandle=th(Fs.bind(null,e,sn,Cr),r);break}Fs(e,sn,Cr);break;case 5:Fs(e,sn,Cr);break;default:throw Error(ee(329))}}}return dn(e,vt()),e.callbackNode===n?Wx.bind(null,e):null}function bh(e,t){var n=go;return e.current.memoizedState.isDehydrated&&(ei(e,t).flags|=256),e=Dc(e,t),e!==2&&(t=sn,sn=n,t!==null&&wh(t)),e}function wh(e){sn===null?sn=e:sn.push.apply(sn,e)}function cE(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],a=i.getSnapshot;i=i.value;try{if(!Zn(a(),i))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Zr(e,t){for(t&=~Jf,t&=~au,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-Jn(t),r=1<<n;e[n]=-1,t&=~r}}function sg(e){if(Ve&6)throw Error(ee(327));ea();var t=vc(e,0);if(!(t&1))return dn(e,vt()),null;var n=Dc(e,t);if(e.tag!==0&&n===2){var r=Gd(e);r!==0&&(t=r,n=bh(e,r))}if(n===1)throw n=Bo,ei(e,0),Zr(e,t),dn(e,vt()),n;if(n===6)throw Error(ee(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Fs(e,sn,Cr),dn(e,vt()),null}function Zf(e,t){var n=Ve;Ve|=1;try{return e(t)}finally{Ve=n,Ve===0&&(ha=vt()+500,nu&&Ns())}}function ci(e){rs!==null&&rs.tag===0&&!(Ve&6)&&ea();var t=Ve;Ve|=1;var n=On.transition,r=We;try{if(On.transition=null,We=1,e)return e()}finally{We=r,On.transition=n,Ve=t,!(Ve&6)&&Ns()}}function Xf(){yn=zi.current,Xe(zi)}function ei(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,BS(n)),bt!==null)for(n=bt.return;n!==null;){var r=n;switch(Of(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Sc();break;case 3:ua(),Xe(cn),Xe(Kt),Ff();break;case 5:$f(r);break;case 4:ua();break;case 13:Xe(ot);break;case 19:Xe(ot);break;case 10:Mf(r.type._context);break;case 22:case 23:Xf()}n=n.return}if(Ot=e,bt=e=ps(e.current,null),$t=yn=t,Ct=0,Bo=null,Jf=au=li=0,sn=go=null,Gs!==null){for(t=0;t<Gs.length;t++)if(n=Gs[t],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,a=n.pending;if(a!==null){var o=a.next;a.next=i,r.next=o}n.pending=r}Gs=null}return e}function Gx(e,t){do{var n=bt;try{if(Df(),Jl.current=Tc,Rc){for(var r=ct.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Rc=!1}if(oi=0,Tt=At=ct=null,po=!1,Do=0,Kf.current=null,n===null||n.return===null){Ct=1,Bo=t,bt=null;break}e:{var a=e,o=n.return,l=n,c=t;if(t=$t,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=l,p=d.tag;if(!(d.mode&1)&&(p===0||p===11||p===15)){var h=d.alternate;h?(d.updateQueue=h.updateQueue,d.memoizedState=h.memoizedState,d.lanes=h.lanes):(d.updateQueue=null,d.memoizedState=null)}var f=zm(o);if(f!==null){f.flags&=-257,Wm(f,o,l,a,t),f.mode&1&&qm(a,u,t),t=f,c=u;var v=t.updateQueue;if(v===null){var j=new Set;j.add(c),t.updateQueue=j}else v.add(c);break e}else{if(!(t&1)){qm(a,u,t),ep();break e}c=Error(ee(426))}}else if(nt&&l.mode&1){var _=zm(o);if(_!==null){!(_.flags&65536)&&(_.flags|=256),Wm(_,o,l,a,t),Pf(da(c,l));break e}}a=c=da(c,l),Ct!==4&&(Ct=2),go===null?go=[a]:go.push(a),a=o;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t;var m=Ix(a,c,t);Um(a,m);break e;case 1:l=c;var y=a.type,b=a.stateNode;if(!(a.flags&128)&&(typeof y.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(hs===null||!hs.has(b)))){a.flags|=65536,t&=-t,a.lanes|=t;var N=Rx(a,l,t);Um(a,N);break e}}a=a.return}while(a!==null)}Jx(n)}catch(A){t=A,bt===n&&n!==null&&(bt=n=n.return);continue}break}while(!0)}function Yx(){var e=Oc.current;return Oc.current=Tc,e===null?Tc:e}function ep(){(Ct===0||Ct===3||Ct===2)&&(Ct=4),Ot===null||!(li&268435455)&&!(au&268435455)||Zr(Ot,$t)}function Dc(e,t){var n=Ve;Ve|=2;var r=Yx();(Ot!==e||$t!==t)&&(Cr=null,ei(e,t));do try{uE();break}catch(i){Gx(e,i)}while(!0);if(Df(),Ve=n,Oc.current=r,bt!==null)throw Error(ee(261));return Ot=null,$t=0,Ct}function uE(){for(;bt!==null;)Kx(bt)}function dE(){for(;bt!==null&&!Dw();)Kx(bt)}function Kx(e){var t=Zx(e.alternate,e,yn);e.memoizedProps=e.pendingProps,t===null?Jx(e):bt=t,Kf.current=null}function Jx(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=sE(n,t),n!==null){n.flags&=32767,bt=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Ct=6,bt=null;return}}else if(n=rE(n,t,yn),n!==null){bt=n;return}if(t=t.sibling,t!==null){bt=t;return}bt=t=e}while(t!==null);Ct===0&&(Ct=5)}function Fs(e,t,n){var r=We,i=On.transition;try{On.transition=null,We=1,hE(e,t,n,r)}finally{On.transition=i,We=r}return null}function hE(e,t,n,r){do ea();while(rs!==null);if(Ve&6)throw Error(ee(327));n=e.finishedWork;var i=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(ee(177));e.callbackNode=null,e.callbackPriority=0;var a=n.lanes|n.childLanes;if(Ww(e,a),e===Ot&&(bt=Ot=null,$t=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||_l||(_l=!0,Xx(yc,function(){return ea(),null})),a=(n.flags&15990)!==0,n.subtreeFlags&15990||a){a=On.transition,On.transition=null;var o=We;We=1;var l=Ve;Ve|=4,Kf.current=null,aE(e,n),qx(n,e),TS(Xd),xc=!!Zd,Xd=Zd=null,e.current=n,oE(n),Mw(),Ve=l,We=o,On.transition=a}else e.current=n;if(_l&&(_l=!1,rs=e,Lc=i),a=e.pendingLanes,a===0&&(hs=null),Vw(n.stateNode),dn(e,vt()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Pc)throw Pc=!1,e=xh,xh=null,e;return Lc&1&&e.tag!==0&&ea(),a=e.pendingLanes,a&1?e===jh?yo++:(yo=0,jh=e):yo=0,Ns(),null}function ea(){if(rs!==null){var e=Iv(Lc),t=On.transition,n=We;try{if(On.transition=null,We=16>e?16:e,rs===null)var r=!1;else{if(e=rs,rs=null,Lc=0,Ve&6)throw Error(ee(331));var i=Ve;for(Ve|=4,de=e.current;de!==null;){var a=de,o=a.child;if(de.flags&16){var l=a.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(de=u;de!==null;){var d=de;switch(d.tag){case 0:case 11:case 15:mo(8,d,a)}var p=d.child;if(p!==null)p.return=d,de=p;else for(;de!==null;){d=de;var h=d.sibling,f=d.return;if($x(d),d===u){de=null;break}if(h!==null){h.return=f,de=h;break}de=f}}}var v=a.alternate;if(v!==null){var j=v.child;if(j!==null){v.child=null;do{var _=j.sibling;j.sibling=null,j=_}while(j!==null)}}de=a}}if(a.subtreeFlags&2064&&o!==null)o.return=a,de=o;else e:for(;de!==null;){if(a=de,a.flags&2048)switch(a.tag){case 0:case 11:case 15:mo(9,a,a.return)}var m=a.sibling;if(m!==null){m.return=a.return,de=m;break e}de=a.return}}var y=e.current;for(de=y;de!==null;){o=de;var b=o.child;if(o.subtreeFlags&2064&&b!==null)b.return=o,de=b;else e:for(o=y;de!==null;){if(l=de,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:iu(9,l)}}catch(A){ft(l,l.return,A)}if(l===o){de=null;break e}var N=l.sibling;if(N!==null){N.return=l.return,de=N;break e}de=l.return}}if(Ve=i,Ns(),hr&&typeof hr.onPostCommitFiberRoot=="function")try{hr.onPostCommitFiberRoot(Qc,e)}catch{}r=!0}return r}finally{We=n,On.transition=t}}return!1}function ig(e,t,n){t=da(n,t),t=Ix(e,t,1),e=ds(e,t,1),t=tn(),e!==null&&(el(e,1,t),dn(e,t))}function ft(e,t,n){if(e.tag===3)ig(e,e,n);else for(;t!==null;){if(t.tag===3){ig(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(hs===null||!hs.has(r))){e=da(n,e),e=Rx(t,e,1),t=ds(t,e,1),e=tn(),t!==null&&(el(t,1,e),dn(t,e));break}}t=t.return}}function fE(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=tn(),e.pingedLanes|=e.suspendedLanes&n,Ot===e&&($t&n)===n&&(Ct===4||Ct===3&&($t&130023424)===$t&&500>vt()-Qf?ei(e,0):Jf|=n),dn(e,t)}function Qx(e,t){t===0&&(e.mode&1?(t=gl,gl<<=1,!(gl&130023424)&&(gl=4194304)):t=1);var n=tn();e=Vr(e,t),e!==null&&(el(e,t,n),dn(e,n))}function pE(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Qx(e,n)}function mE(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(ee(314))}r!==null&&r.delete(t),Qx(e,n)}var Zx;Zx=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||cn.current)an=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return an=!1,nE(e,t,n);an=!!(e.flags&131072)}else an=!1,nt&&t.flags&1048576&&nx(t,_c,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Zl(e,t),e=t.pendingProps;var i=oa(t,Kt.current);Xi(t,n),i=qf(null,t,r,e,i,n);var a=zf();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,un(r)?(a=!0,Ec(t)):a=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Bf(t),i.updater=su,t.stateNode=i,i._reactInternals=t,lh(t,r,e,n),t=dh(null,t,r,!0,a,n)):(t.tag=0,nt&&a&&Tf(t),Xt(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Zl(e,t),e=t.pendingProps,i=r._init,r=i(r._payload),t.type=r,i=t.tag=yE(r),e=qn(r,e),i){case 0:t=uh(null,t,r,e,n);break e;case 1:t=Km(null,t,r,e,n);break e;case 11:t=Gm(null,t,r,e,n);break e;case 14:t=Ym(null,t,r,qn(r.type,e),n);break e}throw Error(ee(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:qn(r,i),uh(e,t,r,i,n);case 1:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:qn(r,i),Km(e,t,r,i,n);case 3:e:{if(Lx(t),e===null)throw Error(ee(387));r=t.pendingProps,a=t.memoizedState,i=a.element,lx(e,t),kc(t,r,null,n);var o=t.memoizedState;if(r=o.element,a.isDehydrated)if(a={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=a,t.memoizedState=a,t.flags&256){i=da(Error(ee(423)),t),t=Jm(e,t,r,n,i);break e}else if(r!==i){i=da(Error(ee(424)),t),t=Jm(e,t,r,n,i);break e}else for(vn=us(t.stateNode.containerInfo.firstChild),jn=t,nt=!0,Gn=null,n=ax(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(la(),r===i){t=$r(e,t,n);break e}Xt(e,t,r,n)}t=t.child}return t;case 5:return cx(t),e===null&&ih(t),r=t.type,i=t.pendingProps,a=e!==null?e.memoizedProps:null,o=i.children,eh(r,i)?o=null:a!==null&&eh(r,a)&&(t.flags|=32),Px(e,t),Xt(e,t,o,n),t.child;case 6:return e===null&&ih(t),null;case 13:return Dx(e,t,n);case 4:return Vf(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=ca(t,null,r,n):Xt(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:qn(r,i),Gm(e,t,r,i,n);case 7:return Xt(e,t,t.pendingProps,n),t.child;case 8:return Xt(e,t,t.pendingProps.children,n),t.child;case 12:return Xt(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,a=t.memoizedProps,o=i.value,Je(Ac,r._currentValue),r._currentValue=o,a!==null)if(Zn(a.value,o)){if(a.children===i.children&&!cn.current){t=$r(e,t,n);break e}}else for(a=t.child,a!==null&&(a.return=t);a!==null;){var l=a.dependencies;if(l!==null){o=a.child;for(var c=l.firstContext;c!==null;){if(c.context===r){if(a.tag===1){c=Dr(-1,n&-n),c.tag=2;var u=a.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}a.lanes|=n,c=a.alternate,c!==null&&(c.lanes|=n),ah(a.return,n,t),l.lanes|=n;break}c=c.next}}else if(a.tag===10)o=a.type===t.type?null:a.child;else if(a.tag===18){if(o=a.return,o===null)throw Error(ee(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),ah(o,n,t),o=a.sibling}else o=a.child;if(o!==null)o.return=a;else for(o=a;o!==null;){if(o===t){o=null;break}if(a=o.sibling,a!==null){a.return=o.return,o=a;break}o=o.return}a=o}Xt(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,Xi(t,n),i=Pn(i),r=r(i),t.flags|=1,Xt(e,t,r,n),t.child;case 14:return r=t.type,i=qn(r,t.pendingProps),i=qn(r.type,i),Ym(e,t,r,i,n);case 15:return Tx(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:qn(r,i),Zl(e,t),t.tag=1,un(r)?(e=!0,Ec(t)):e=!1,Xi(t,n),kx(t,r,i),lh(t,r,i,n),dh(null,t,r,!0,e,n);case 19:return Mx(e,t,n);case 22:return Ox(e,t,n)}throw Error(ee(156,t.tag))};function Xx(e,t){return _v(e,t)}function gE(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Tn(e,t,n,r){return new gE(e,t,n,r)}function tp(e){return e=e.prototype,!(!e||!e.isReactComponent)}function yE(e){if(typeof e=="function")return tp(e)?1:0;if(e!=null){if(e=e.$$typeof,e===jf)return 11;if(e===bf)return 14}return 2}function ps(e,t){var n=e.alternate;return n===null?(n=Tn(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function tc(e,t,n,r,i,a){var o=2;if(r=e,typeof e=="function")tp(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case Li:return ti(n.children,i,a,t);case xf:o=8,i|=8;break;case Td:return e=Tn(12,n,t,i|2),e.elementType=Td,e.lanes=a,e;case Od:return e=Tn(13,n,t,i),e.elementType=Od,e.lanes=a,e;case Pd:return e=Tn(19,n,t,i),e.elementType=Pd,e.lanes=a,e;case cv:return ou(n,i,a,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case ov:o=10;break e;case lv:o=9;break e;case jf:o=11;break e;case bf:o=14;break e;case Kr:o=16,r=null;break e}throw Error(ee(130,e==null?e:typeof e,""))}return t=Tn(o,n,t,i),t.elementType=e,t.type=r,t.lanes=a,t}function ti(e,t,n,r){return e=Tn(7,e,r,t),e.lanes=n,e}function ou(e,t,n,r){return e=Tn(22,e,r,t),e.elementType=cv,e.lanes=n,e.stateNode={isHidden:!1},e}function Ju(e,t,n){return e=Tn(6,e,null,t),e.lanes=n,e}function Qu(e,t,n){return t=Tn(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function vE(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ru(0),this.expirationTimes=Ru(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ru(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function np(e,t,n,r,i,a,o,l,c){return e=new vE(e,t,n,l,c),t===1?(t=1,a===!0&&(t|=8)):t=0,a=Tn(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Bf(a),e}function xE(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Pi,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function ej(e){if(!e)return bs;e=e._reactInternals;e:{if(pi(e)!==e||e.tag!==1)throw Error(ee(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(un(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(ee(171))}if(e.tag===1){var n=e.type;if(un(n))return ex(e,n,t)}return t}function tj(e,t,n,r,i,a,o,l,c){return e=np(n,r,!0,e,i,a,o,l,c),e.context=ej(null),n=e.current,r=tn(),i=fs(n),a=Dr(r,i),a.callback=t??null,ds(n,a,i),e.current.lanes=i,el(e,i,r),dn(e,r),e}function lu(e,t,n,r){var i=t.current,a=tn(),o=fs(i);return n=ej(n),t.context===null?t.context=n:t.pendingContext=n,t=Dr(a,o),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=ds(i,t,o),e!==null&&(Qn(e,i,o,a),Kl(e,i,o)),o}function Mc(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function ag(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function rp(e,t){ag(e,t),(e=e.alternate)&&ag(e,t)}function jE(){return null}var nj=typeof reportError=="function"?reportError:function(e){console.error(e)};function sp(e){this._internalRoot=e}cu.prototype.render=sp.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(ee(409));lu(e,t,null,null)};cu.prototype.unmount=sp.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;ci(function(){lu(null,e,null,null)}),t[Br]=null}};function cu(e){this._internalRoot=e}cu.prototype.unstable_scheduleHydration=function(e){if(e){var t=Ov();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Qr.length&&t!==0&&t<Qr[n].priority;n++);Qr.splice(n,0,e),n===0&&Lv(e)}};function ip(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function uu(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function og(){}function bE(e,t,n,r,i){if(i){if(typeof r=="function"){var a=r;r=function(){var u=Mc(o);a.call(u)}}var o=tj(t,r,e,0,null,!1,!1,"",og);return e._reactRootContainer=o,e[Br]=o.current,Ro(e.nodeType===8?e.parentNode:e),ci(),o}for(;i=e.lastChild;)e.removeChild(i);if(typeof r=="function"){var l=r;r=function(){var u=Mc(c);l.call(u)}}var c=np(e,0,!1,null,null,!1,!1,"",og);return e._reactRootContainer=c,e[Br]=c.current,Ro(e.nodeType===8?e.parentNode:e),ci(function(){lu(t,c,n,r)}),c}function du(e,t,n,r,i){var a=n._reactRootContainer;if(a){var o=a;if(typeof i=="function"){var l=i;i=function(){var c=Mc(o);l.call(c)}}lu(t,o,e,i)}else o=bE(n,t,e,i,r);return Mc(o)}Rv=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=eo(t.pendingLanes);n!==0&&(Ef(t,n|1),dn(t,vt()),!(Ve&6)&&(ha=vt()+500,Ns()))}break;case 13:ci(function(){var r=Vr(e,1);if(r!==null){var i=tn();Qn(r,e,1,i)}}),rp(e,1)}};Nf=function(e){if(e.tag===13){var t=Vr(e,134217728);if(t!==null){var n=tn();Qn(t,e,134217728,n)}rp(e,134217728)}};Tv=function(e){if(e.tag===13){var t=fs(e),n=Vr(e,t);if(n!==null){var r=tn();Qn(n,e,t,r)}rp(e,t)}};Ov=function(){return We};Pv=function(e,t){var n=We;try{return We=e,t()}finally{We=n}};qd=function(e,t,n){switch(t){case"input":if(Md(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=tu(r);if(!i)throw Error(ee(90));dv(r),Md(r,i)}}}break;case"textarea":fv(e,n);break;case"select":t=n.value,t!=null&&Ki(e,!!n.multiple,t,!1)}};jv=Zf;bv=ci;var wE={usingClientEntryPoint:!1,Events:[nl,Bi,tu,vv,xv,Zf]},qa={findFiberByHostInstance:Ws,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},SE={bundleType:qa.bundleType,version:qa.version,rendererPackageName:qa.rendererPackageName,rendererConfig:qa.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Fr.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Ev(e),e===null?null:e.stateNode},findFiberByHostInstance:qa.findFiberByHostInstance||jE,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Al=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Al.isDisabled&&Al.supportsFiber)try{Qc=Al.inject(SE),hr=Al}catch{}}wn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=wE;wn.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ip(t))throw Error(ee(200));return xE(e,t,null,n)};wn.createRoot=function(e,t){if(!ip(e))throw Error(ee(299));var n=!1,r="",i=nj;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=np(e,1,!1,null,null,n,!1,r,i),e[Br]=t.current,Ro(e.nodeType===8?e.parentNode:e),new sp(t)};wn.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(ee(188)):(e=Object.keys(e).join(","),Error(ee(268,e)));return e=Ev(t),e=e===null?null:e.stateNode,e};wn.flushSync=function(e){return ci(e)};wn.hydrate=function(e,t,n){if(!uu(t))throw Error(ee(200));return du(null,e,t,!0,n)};wn.hydrateRoot=function(e,t,n){if(!ip(e))throw Error(ee(405));var r=n!=null&&n.hydratedSources||null,i=!1,a="",o=nj;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(a=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),t=tj(t,null,e,1,n??null,i,!1,a,o),e[Br]=t.current,Ro(e),r)for(e=0;e<r.length;e++)n=r[e],i=n._getVersion,i=i(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new cu(t)};wn.render=function(e,t,n){if(!uu(t))throw Error(ee(200));return du(null,e,t,!1,n)};wn.unmountComponentAtNode=function(e){if(!uu(e))throw Error(ee(40));return e._reactRootContainer?(ci(function(){du(null,null,e,!1,function(){e._reactRootContainer=null,e[Br]=null})}),!0):!1};wn.unstable_batchedUpdates=Zf;wn.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!uu(n))throw Error(ee(200));if(e==null||e._reactInternals===void 0)throw Error(ee(38));return du(e,t,n,!1,r)};wn.version="18.3.1-next-f1338f8080-20240426";function rj(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(rj)}catch(e){console.error(e)}}rj(),rv.exports=wn;var EE=rv.exports,lg=EE;Id.createRoot=lg.createRoot,Id.hydrateRoot=lg.hydrateRoot;/**
 * @remix-run/router v1.23.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Vo(){return Vo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Vo.apply(this,arguments)}var ss;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(ss||(ss={}));const cg="popstate";function NE(e){e===void 0&&(e={});function t(r,i){let{pathname:a,search:o,hash:l}=r.location;return Sh("",{pathname:a,search:o,hash:l},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(r,i){return typeof i=="string"?i:Uc(i)}return AE(t,n,null,e)}function xt(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function ap(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function _E(){return Math.random().toString(36).substr(2,8)}function ug(e,t){return{usr:e.state,key:e.key,idx:t}}function Sh(e,t,n,r){return n===void 0&&(n=null),Vo({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?wa(t):t,{state:n,key:t&&t.key||r||_E()})}function Uc(e){let{pathname:t="/",search:n="",hash:r=""}=e;return n&&n!=="?"&&(t+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(t+=r.charAt(0)==="#"?r:"#"+r),t}function wa(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}function AE(e,t,n,r){r===void 0&&(r={});let{window:i=document.defaultView,v5Compat:a=!1}=r,o=i.history,l=ss.Pop,c=null,u=d();u==null&&(u=0,o.replaceState(Vo({},o.state,{idx:u}),""));function d(){return(o.state||{idx:null}).idx}function p(){l=ss.Pop;let _=d(),m=_==null?null:_-u;u=_,c&&c({action:l,location:j.location,delta:m})}function h(_,m){l=ss.Push;let y=Sh(j.location,_,m);u=d()+1;let b=ug(y,u),N=j.createHref(y);try{o.pushState(b,"",N)}catch(A){if(A instanceof DOMException&&A.name==="DataCloneError")throw A;i.location.assign(N)}a&&c&&c({action:l,location:j.location,delta:1})}function f(_,m){l=ss.Replace;let y=Sh(j.location,_,m);u=d();let b=ug(y,u),N=j.createHref(y);o.replaceState(b,"",N),a&&c&&c({action:l,location:j.location,delta:0})}function v(_){let m=i.location.origin!=="null"?i.location.origin:i.location.href,y=typeof _=="string"?_:Uc(_);return y=y.replace(/ $/,"%20"),xt(m,"No window.location.(origin|href) available to create URL for href: "+y),new URL(y,m)}let j={get action(){return l},get location(){return e(i,o)},listen(_){if(c)throw new Error("A history only accepts one active listener");return i.addEventListener(cg,p),c=_,()=>{i.removeEventListener(cg,p),c=null}},createHref(_){return t(i,_)},createURL:v,encodeLocation(_){let m=v(_);return{pathname:m.pathname,search:m.search,hash:m.hash}},push:h,replace:f,go(_){return o.go(_)}};return j}var dg;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(dg||(dg={}));function CE(e,t,n){return n===void 0&&(n="/"),kE(e,t,n)}function kE(e,t,n,r){let i=typeof t=="string"?wa(t):t,a=op(i.pathname||"/",n);if(a==null)return null;let o=sj(e);IE(o);let l=null;for(let c=0;l==null&&c<o.length;++c){let u=FE(a);l=BE(o[c],u)}return l}function sj(e,t,n,r){t===void 0&&(t=[]),n===void 0&&(n=[]),r===void 0&&(r="");let i=(a,o,l)=>{let c={relativePath:l===void 0?a.path||"":l,caseSensitive:a.caseSensitive===!0,childrenIndex:o,route:a};c.relativePath.startsWith("/")&&(xt(c.relativePath.startsWith(r),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(r.length));let u=ms([r,c.relativePath]),d=n.concat(c);a.children&&a.children.length>0&&(xt(a.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),sj(a.children,t,d,u)),!(a.path==null&&!a.index)&&t.push({path:u,score:ME(u,a.index),routesMeta:d})};return e.forEach((a,o)=>{var l;if(a.path===""||!((l=a.path)!=null&&l.includes("?")))i(a,o);else for(let c of ij(a.path))i(a,o,c)}),t}function ij(e){let t=e.split("/");if(t.length===0)return[];let[n,...r]=t,i=n.endsWith("?"),a=n.replace(/\?$/,"");if(r.length===0)return i?[a,""]:[a];let o=ij(r.join("/")),l=[];return l.push(...o.map(c=>c===""?a:[a,c].join("/"))),i&&l.push(...o),l.map(c=>e.startsWith("/")&&c===""?"/":c)}function IE(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:UE(t.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const RE=/^:[\w-]+$/,TE=3,OE=2,PE=1,LE=10,DE=-2,hg=e=>e==="*";function ME(e,t){let n=e.split("/"),r=n.length;return n.some(hg)&&(r+=DE),t&&(r+=OE),n.filter(i=>!hg(i)).reduce((i,a)=>i+(RE.test(a)?TE:a===""?PE:LE),r)}function UE(e,t){return e.length===t.length&&e.slice(0,-1).every((r,i)=>r===t[i])?e[e.length-1]-t[t.length-1]:0}function BE(e,t,n){let{routesMeta:r}=e,i={},a="/",o=[];for(let l=0;l<r.length;++l){let c=r[l],u=l===r.length-1,d=a==="/"?t:t.slice(a.length)||"/",p=VE({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},d),h=c.route;if(!p)return null;Object.assign(i,p.params),o.push({params:i,pathname:ms([a,p.pathname]),pathnameBase:GE(ms([a,p.pathnameBase])),route:h}),p.pathnameBase!=="/"&&(a=ms([a,p.pathnameBase]))}return o}function VE(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=$E(e.path,e.caseSensitive,e.end),i=t.match(n);if(!i)return null;let a=i[0],o=a.replace(/(.)\/+$/,"$1"),l=i.slice(1);return{params:r.reduce((u,d,p)=>{let{paramName:h,isOptional:f}=d;if(h==="*"){let j=l[p]||"";o=a.slice(0,a.length-j.length).replace(/(.)\/+$/,"$1")}const v=l[p];return f&&!v?u[h]=void 0:u[h]=(v||"").replace(/%2F/g,"/"),u},{}),pathname:a,pathnameBase:o,pattern:e}}function $E(e,t,n){t===void 0&&(t=!1),n===void 0&&(n=!0),ap(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let r=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,c)=>(r.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(r.push({paramName:"*"}),i+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":e!==""&&e!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,t?void 0:"i"),r]}function FE(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return ap(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function op(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&r!=="/"?null:e.slice(n)||"/"}const HE=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,qE=e=>HE.test(e);function zE(e,t){t===void 0&&(t="/");let{pathname:n,search:r="",hash:i=""}=typeof e=="string"?wa(e):e,a;if(n)if(qE(n))a=n;else{if(n.includes("//")){let o=n;n=n.replace(/\/\/+/g,"/"),ap(!1,"Pathnames cannot have embedded double slashes - normalizing "+(o+" -> "+n))}n.startsWith("/")?a=fg(n.substring(1),"/"):a=fg(n,t)}else a=t;return{pathname:a,search:YE(r),hash:KE(i)}}function fg(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function Zu(e,t,n,r){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function WE(e){return e.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function lp(e,t){let n=WE(e);return t?n.map((r,i)=>i===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function cp(e,t,n,r){r===void 0&&(r=!1);let i;typeof e=="string"?i=wa(e):(i=Vo({},e),xt(!i.pathname||!i.pathname.includes("?"),Zu("?","pathname","search",i)),xt(!i.pathname||!i.pathname.includes("#"),Zu("#","pathname","hash",i)),xt(!i.search||!i.search.includes("#"),Zu("#","search","hash",i)));let a=e===""||i.pathname==="",o=a?"/":i.pathname,l;if(o==null)l=n;else{let p=t.length-1;if(!r&&o.startsWith("..")){let h=o.split("/");for(;h[0]==="..";)h.shift(),p-=1;i.pathname=h.join("/")}l=p>=0?t[p]:"/"}let c=zE(i,l),u=o&&o!=="/"&&o.endsWith("/"),d=(a||o===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(u||d)&&(c.pathname+="/"),c}const ms=e=>e.join("/").replace(/\/\/+/g,"/"),GE=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),YE=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,KE=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function JE(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const aj=["post","put","patch","delete"];new Set(aj);const QE=["get",...aj];new Set(QE);/**
 * React Router v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function $o(){return $o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},$o.apply(this,arguments)}const up=g.createContext(null),ZE=g.createContext(null),_s=g.createContext(null),hu=g.createContext(null),Hr=g.createContext({outlet:null,matches:[],isDataRoute:!1}),oj=g.createContext(null);function XE(e,t){let{relative:n}=t===void 0?{}:t;Sa()||xt(!1);let{basename:r,navigator:i}=g.useContext(_s),{hash:a,pathname:o,search:l}=cj(e,{relative:n}),c=o;return r!=="/"&&(c=o==="/"?r:ms([r,o])),i.createHref({pathname:c,search:l,hash:a})}function Sa(){return g.useContext(hu)!=null}function hn(){return Sa()||xt(!1),g.useContext(hu).location}function lj(e){g.useContext(_s).static||g.useLayoutEffect(e)}function Re(){let{isDataRoute:e}=g.useContext(Hr);return e?pN():eN()}function eN(){Sa()||xt(!1);let e=g.useContext(up),{basename:t,future:n,navigator:r}=g.useContext(_s),{matches:i}=g.useContext(Hr),{pathname:a}=hn(),o=JSON.stringify(lp(i,n.v7_relativeSplatPath)),l=g.useRef(!1);return lj(()=>{l.current=!0}),g.useCallback(function(u,d){if(d===void 0&&(d={}),!l.current)return;if(typeof u=="number"){r.go(u);return}let p=cp(u,JSON.parse(o),a,d.relative==="path");e==null&&t!=="/"&&(p.pathname=p.pathname==="/"?t:ms([t,p.pathname])),(d.replace?r.replace:r.push)(p,d.state,d)},[t,r,o,a,e])}const tN=g.createContext(null);function nN(e){let t=g.useContext(Hr).outlet;return t&&g.createElement(tN.Provider,{value:e},t)}function cj(e,t){let{relative:n}=t===void 0?{}:t,{future:r}=g.useContext(_s),{matches:i}=g.useContext(Hr),{pathname:a}=hn(),o=JSON.stringify(lp(i,r.v7_relativeSplatPath));return g.useMemo(()=>cp(e,JSON.parse(o),a,n==="path"),[e,o,a,n])}function rN(e,t){return sN(e,t)}function sN(e,t,n,r){Sa()||xt(!1);let{navigator:i}=g.useContext(_s),{matches:a}=g.useContext(Hr),o=a[a.length-1],l=o?o.params:{};o&&o.pathname;let c=o?o.pathnameBase:"/";o&&o.route;let u=hn(),d;if(t){var p;let _=typeof t=="string"?wa(t):t;c==="/"||(p=_.pathname)!=null&&p.startsWith(c)||xt(!1),d=_}else d=u;let h=d.pathname||"/",f=h;if(c!=="/"){let _=c.replace(/^\//,"").split("/");f="/"+h.replace(/^\//,"").split("/").slice(_.length).join("/")}let v=CE(e,{pathname:f}),j=cN(v&&v.map(_=>Object.assign({},_,{params:Object.assign({},l,_.params),pathname:ms([c,i.encodeLocation?i.encodeLocation(_.pathname).pathname:_.pathname]),pathnameBase:_.pathnameBase==="/"?c:ms([c,i.encodeLocation?i.encodeLocation(_.pathnameBase).pathname:_.pathnameBase])})),a,n,r);return t&&j?g.createElement(hu.Provider,{value:{location:$o({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:ss.Pop}},j):j}function iN(){let e=fN(),t=JE(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return g.createElement(g.Fragment,null,g.createElement("h2",null,"Unexpected Application Error!"),g.createElement("h3",{style:{fontStyle:"italic"}},t),n?g.createElement("pre",{style:i},n):null,null)}const aN=g.createElement(iN,null);class oN extends g.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,n){return n.location!==t.location||n.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:n.error,location:n.location,revalidation:t.revalidation||n.revalidation}}componentDidCatch(t,n){console.error("React Router caught the following error during render",t,n)}render(){return this.state.error!==void 0?g.createElement(Hr.Provider,{value:this.props.routeContext},g.createElement(oj.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function lN(e){let{routeContext:t,match:n,children:r}=e,i=g.useContext(up);return i&&i.static&&i.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=n.route.id),g.createElement(Hr.Provider,{value:t},r)}function cN(e,t,n,r){var i;if(t===void 0&&(t=[]),n===void 0&&(n=null),r===void 0&&(r=null),e==null){var a;if(!n)return null;if(n.errors)e=n.matches;else if((a=r)!=null&&a.v7_partialHydration&&t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let o=e,l=(i=n)==null?void 0:i.errors;if(l!=null){let d=o.findIndex(p=>p.route.id&&(l==null?void 0:l[p.route.id])!==void 0);d>=0||xt(!1),o=o.slice(0,Math.min(o.length,d+1))}let c=!1,u=-1;if(n&&r&&r.v7_partialHydration)for(let d=0;d<o.length;d++){let p=o[d];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(u=d),p.route.id){let{loaderData:h,errors:f}=n,v=p.route.loader&&h[p.route.id]===void 0&&(!f||f[p.route.id]===void 0);if(p.route.lazy||v){c=!0,u>=0?o=o.slice(0,u+1):o=[o[0]];break}}}return o.reduceRight((d,p,h)=>{let f,v=!1,j=null,_=null;n&&(f=l&&p.route.id?l[p.route.id]:void 0,j=p.route.errorElement||aN,c&&(u<0&&h===0?(mN("route-fallback"),v=!0,_=null):u===h&&(v=!0,_=p.route.hydrateFallbackElement||null)));let m=t.concat(o.slice(0,h+1)),y=()=>{let b;return f?b=j:v?b=_:p.route.Component?b=g.createElement(p.route.Component,null):p.route.element?b=p.route.element:b=d,g.createElement(lN,{match:p,routeContext:{outlet:d,matches:m,isDataRoute:n!=null},children:b})};return n&&(p.route.ErrorBoundary||p.route.errorElement||h===0)?g.createElement(oN,{location:n.location,revalidation:n.revalidation,component:j,error:f,children:y(),routeContext:{outlet:null,matches:m,isDataRoute:!0}}):y()},null)}var uj=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(uj||{}),dj=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(dj||{});function uN(e){let t=g.useContext(up);return t||xt(!1),t}function dN(e){let t=g.useContext(ZE);return t||xt(!1),t}function hN(e){let t=g.useContext(Hr);return t||xt(!1),t}function hj(e){let t=hN(),n=t.matches[t.matches.length-1];return n.route.id||xt(!1),n.route.id}function fN(){var e;let t=g.useContext(oj),n=dN(),r=hj();return t!==void 0?t:(e=n.errors)==null?void 0:e[r]}function pN(){let{router:e}=uN(uj.UseNavigateStable),t=hj(dj.UseNavigateStable),n=g.useRef(!1);return lj(()=>{n.current=!0}),g.useCallback(function(i,a){a===void 0&&(a={}),n.current&&(typeof i=="number"?e.navigate(i):e.navigate(i,$o({fromRouteId:t},a)))},[e,t])}const pg={};function mN(e,t,n){pg[e]||(pg[e]=!0)}function gN(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function vo(e){let{to:t,replace:n,state:r,relative:i}=e;Sa()||xt(!1);let{future:a,static:o}=g.useContext(_s),{matches:l}=g.useContext(Hr),{pathname:c}=hn(),u=Re(),d=cp(t,lp(l,a.v7_relativeSplatPath),c,i==="path"),p=JSON.stringify(d);return g.useEffect(()=>u(JSON.parse(p),{replace:n,state:r,relative:i}),[u,p,i,n,r]),null}function fj(e){return nN(e.context)}function J(e){xt(!1)}function yN(e){let{basename:t="/",children:n=null,location:r,navigationType:i=ss.Pop,navigator:a,static:o=!1,future:l}=e;Sa()&&xt(!1);let c=t.replace(/^\/*/,"/"),u=g.useMemo(()=>({basename:c,navigator:a,static:o,future:$o({v7_relativeSplatPath:!1},l)}),[c,l,a,o]);typeof r=="string"&&(r=wa(r));let{pathname:d="/",search:p="",hash:h="",state:f=null,key:v="default"}=r,j=g.useMemo(()=>{let _=op(d,c);return _==null?null:{location:{pathname:_,search:p,hash:h,state:f,key:v},navigationType:i}},[c,d,p,h,f,v,i]);return j==null?null:g.createElement(_s.Provider,{value:u},g.createElement(hu.Provider,{children:n,value:j}))}function vN(e){let{children:t,location:n}=e;return rN(Eh(t),n)}new Promise(()=>{});function Eh(e,t){t===void 0&&(t=[]);let n=[];return g.Children.forEach(e,(r,i)=>{if(!g.isValidElement(r))return;let a=[...t,i];if(r.type===g.Fragment){n.push.apply(n,Eh(r.props.children,a));return}r.type!==J&&xt(!1),!r.props.index||!r.props.children||xt(!1);let o={id:r.props.id||a.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=Eh(r.props.children,a)),n.push(o)}),n}/**
 * React Router DOM v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Nh(){return Nh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Nh.apply(this,arguments)}function xN(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}function jN(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function bN(e,t){return e.button===0&&(!t||t==="_self")&&!jN(e)}function _h(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,n)=>{let r=e[n];return t.concat(Array.isArray(r)?r.map(i=>[n,i]):[[n,r]])},[]))}function wN(e,t){let n=_h(e);return t&&t.forEach((r,i)=>{n.has(i)||t.getAll(i).forEach(a=>{n.append(i,a)})}),n}const SN=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],EN="6";try{window.__reactRouterVersion=EN}catch{}const NN="startTransition",mg=fw[NN];function _N(e){let{basename:t,children:n,future:r,window:i}=e,a=g.useRef();a.current==null&&(a.current=NE({window:i,v5Compat:!0}));let o=a.current,[l,c]=g.useState({action:o.action,location:o.location}),{v7_startTransition:u}=r||{},d=g.useCallback(p=>{u&&mg?mg(()=>c(p)):c(p)},[c,u]);return g.useLayoutEffect(()=>o.listen(d),[o,d]),g.useEffect(()=>gN(r),[r]),g.createElement(yN,{basename:t,children:n,location:l.location,navigationType:l.action,navigator:o,future:r})}const AN=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",CN=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ui=g.forwardRef(function(t,n){let{onClick:r,relative:i,reloadDocument:a,replace:o,state:l,target:c,to:u,preventScrollReset:d,viewTransition:p}=t,h=xN(t,SN),{basename:f}=g.useContext(_s),v,j=!1;if(typeof u=="string"&&CN.test(u)&&(v=u,AN))try{let b=new URL(window.location.href),N=u.startsWith("//")?new URL(b.protocol+u):new URL(u),A=op(N.pathname,f);N.origin===b.origin&&A!=null?u=A+N.search+N.hash:j=!0}catch{}let _=XE(u,{relative:i}),m=kN(u,{replace:o,state:l,target:c,preventScrollReset:d,relative:i,viewTransition:p});function y(b){r&&r(b),b.defaultPrevented||m(b)}return g.createElement("a",Nh({},h,{href:v||_,onClick:j||a?r:y,ref:n,target:c}))});var gg;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(gg||(gg={}));var yg;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(yg||(yg={}));function kN(e,t){let{target:n,replace:r,state:i,preventScrollReset:a,relative:o,viewTransition:l}=t===void 0?{}:t,c=Re(),u=hn(),d=cj(e,{relative:o});return g.useCallback(p=>{if(bN(p,n)){p.preventDefault();let h=r!==void 0?r:Uc(u)===Uc(d);c(e,{replace:h,state:i,preventScrollReset:a,relative:o,viewTransition:l})}},[u,c,d,r,i,n,e,a,o,l])}function pj(e){let t=g.useRef(_h(e)),n=g.useRef(!1),r=hn(),i=g.useMemo(()=>wN(r.search,n.current?null:t.current),[r.search]),a=Re(),o=g.useCallback((l,c)=>{const u=_h(typeof l=="function"?l(i):l);n.current=!0,a("?"+u,c)},[a,i]);return[i,o]}function IN(e={}){const{nonce:t,onScriptLoadSuccess:n,onScriptLoadError:r}=e,[i,a]=g.useState(!1),o=g.useRef(n);o.current=n;const l=g.useRef(r);return l.current=r,g.useEffect(()=>{const c=document.createElement("script");return c.src="https://accounts.google.com/gsi/client",c.async=!0,c.defer=!0,c.nonce=t,c.onload=()=>{var u;a(!0),(u=o.current)===null||u===void 0||u.call(o)},c.onerror=()=>{var u;a(!1),(u=l.current)===null||u===void 0||u.call(l)},document.body.appendChild(c),()=>{document.body.removeChild(c)}},[t]),i}const mj=g.createContext(null);function RN({clientId:e,nonce:t,onScriptLoadSuccess:n,onScriptLoadError:r,children:i}){const a=IN({nonce:t,onScriptLoadSuccess:n,onScriptLoadError:r}),o=g.useMemo(()=>({clientId:e,scriptLoadedSuccessfully:a}),[e,a]);return xa.createElement(mj.Provider,{value:o},i)}function TN(){const e=g.useContext(mj);if(!e)throw new Error("Google OAuth components must be used within GoogleOAuthProvider");return e}function ON(e){var t;return(t=e==null?void 0:e.clientId)!==null&&t!==void 0?t:e==null?void 0:e.client_id}const PN={large:40,medium:32,small:20};function LN({onSuccess:e,onError:t,useOneTap:n,promptMomentNotification:r,type:i="standard",theme:a="outline",size:o="large",text:l,shape:c,logo_alignment:u,width:d,locale:p,click_listener:h,containerProps:f,...v}){const j=g.useRef(null),{clientId:_,scriptLoadedSuccessfully:m}=TN(),y=g.useRef(e);y.current=e;const b=g.useRef(t);b.current=t;const N=g.useRef(r);return N.current=r,g.useEffect(()=>{var A,E,R,I,T,L,B,W,z;if(m)return(R=(E=(A=window==null?void 0:window.google)===null||A===void 0?void 0:A.accounts)===null||E===void 0?void 0:E.id)===null||R===void 0||R.initialize({client_id:_,callback:P=>{var V;if(!(P!=null&&P.credential))return(V=b.current)===null||V===void 0?void 0:V.call(b);const{credential:K,select_by:ce}=P;y.current({credential:K,clientId:ON(P),select_by:ce})},...v}),(L=(T=(I=window==null?void 0:window.google)===null||I===void 0?void 0:I.accounts)===null||T===void 0?void 0:T.id)===null||L===void 0||L.renderButton(j.current,{type:i,theme:a,size:o,text:l,shape:c,logo_alignment:u,width:d,locale:p,click_listener:h}),n&&((z=(W=(B=window==null?void 0:window.google)===null||B===void 0?void 0:B.accounts)===null||W===void 0?void 0:W.id)===null||z===void 0||z.prompt(N.current)),()=>{var P,V,K;n&&((K=(V=(P=window==null?void 0:window.google)===null||P===void 0?void 0:P.accounts)===null||V===void 0?void 0:V.id)===null||K===void 0||K.cancel())}},[_,m,n,i,a,o,l,c,u,d,p]),xa.createElement("div",{...f,ref:j,style:{height:PN[o],...f==null?void 0:f.style}})}const gj="http://localhost:5000";class yj extends Error{constructor(t,n,r){super(t),this.name="ApiError",this.status=n,this.data=r||{},this.code=(r==null?void 0:r.code)||null}}async function vj(e){try{return await e.json()}catch{return{}}}async function le(e,t={},n=!1){const r=localStorage.getItem("token"),i={Accept:"application/json",...t.headers||{}},a=e.includes("/auth/login")||e.includes("/auth/register")||e.includes("/auth/google");if(r&&!a){i.Authorization=`Bearer ${r}`;const c=localStorage.getItem("role_override"),u=localStorage.getItem("strict_impersonation")==="1";c&&(i["X-Afya-View-Role"]=c,u&&(i["X-Afya-Strict-Impersonation"]="1"))}t.body&&typeof t.body=="object"&&(t.body=JSON.stringify(t.body),i["Content-Type"]="application/json");let o;try{o=await fetch(`${gj}${e}`,{...t,credentials:"include",headers:i})}catch{throw new Error("Network error. Please check your connection.")}if(o.status===401&&!n&&!a){if(await DN())return le(e,t,!0);throw xj(),new Error("Session expired. Please sign in again.")}const l=await vj(o);if(!o.ok){const c=new yj(l.msg||l.message||"Request failed",o.status,l);throw(c.code==="STEP_UP_REQUIRED"||c.code==="SESSION_RESTRICTED")&&window.dispatchEvent(new CustomEvent("afyalink:session-security",{detail:{code:c.code,message:c.message,restriction:(l==null?void 0:l.restriction)||null}})),c}return l}async function DN(){try{const e=localStorage.getItem("refreshToken");if(!e)return!1;const t=await fetch(`${gj}/api/auth/refresh`,{method:"POST",credentials:"include",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({refreshToken:e})});if(!t.ok)return!1;const n=await vj(t);return n!=null&&n.accessToken?(localStorage.setItem("token",n.accessToken),n.refreshToken&&localStorage.setItem("refreshToken",n.refreshToken),!0):!1}catch{return!1}}function xj(){localStorage.removeItem("token"),localStorage.removeItem("refreshToken"),window.location.href="/login"}const vg=Object.freeze({SUPERADMIN:"SUPER_ADMIN",SUPER_ADMIN:"SUPER_ADMIN",SYSTEMADMIN:"SYSTEM_ADMIN",SYSTEM_ADMIN:"SYSTEM_ADMIN",DEVELOPER:"DEVELOPER",HOSPITALADMIN:"HOSPITAL_ADMIN",HOSPITAL_ADMIN:"HOSPITAL_ADMIN",DOCTOR:"DOCTOR",NURSE:"NURSE",LABTECH:"LAB_TECH",LAB_TECH:"LAB_TECH",PHARMACIST:"PHARMACIST",SECURITYOFFICER:"SECURITY_OFFICER",SECURITY_OFFICER:"SECURITY_OFFICER",SECURITYADMIN:"SECURITY_ADMIN",SECURITY_ADMIN:"SECURITY_ADMIN",HRMANAGER:"HR_MANAGER",HR_MANAGER:"HR_MANAGER",PAYROLLOFFICER:"PAYROLL_OFFICER",PAYROLL_OFFICER:"PAYROLL_OFFICER",RADIOLOGIST:"RADIOLOGIST",THERAPIST:"THERAPIST",RECEPTIONIST:"RECEPTIONIST",PATIENT:"PATIENT",GUEST:"GUEST"});function Ge(e){if(typeof e!="string")return"";const t=e.trim().replace(/[\s-]+/g,"_").toUpperCase(),n=t.replaceAll("_","");return vg[t]||vg[n]||t}function Cl(e){try{const n=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),r=decodeURIComponent(atob(n).split("").map(i=>"%"+("00"+i.charCodeAt(0).toString(16)).slice(-2)).join(""));return JSON.parse(r)}catch{return null}}const jj=g.createContext(null),ki="role_override",Ii="strict_impersonation";function MN({children:e}){const[t,n]=g.useState(null),[r,i]=g.useState(()=>localStorage.getItem(ki)||""),[a,o]=g.useState(()=>localStorage.getItem(Ii)==="1"),[l,c]=g.useState(!0),u=Ge(t==null?void 0:t.role)==="SUPER_ADMIN"||Ge(t==null?void 0:t.role)==="DEVELOPER",d=Ge(u&&r?r:t==null?void 0:t.role),p=t?{...t,actualRole:Ge(t.role),role:d}:null;g.useEffect(()=>{let m=!0;return(async()=>{try{const b=localStorage.getItem("user"),N=localStorage.getItem("token"),A=localStorage.getItem("refreshToken");if(!N||!b){m&&n(null);return}const E=Cl(N),R=Ge(E==null?void 0:E.role),I=(E==null?void 0:E.exp)&&E.exp*1e3<Date.now();if(!R||I){if(!A)throw new Error("Token expired");const T=await fetch("http://localhost:5000/api/auth/refresh",{method:"POST",credentials:"include",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({refreshToken:A})});if(!T.ok)throw new Error("Refresh failed");const L=await T.json();if(!(L!=null&&L.accessToken)||!(L!=null&&L.user))throw new Error("Refresh failed");localStorage.setItem("token",L.accessToken),L.refreshToken&&localStorage.setItem("refreshToken",L.refreshToken),localStorage.setItem("user",JSON.stringify(L.user)),m&&n({...L.user,role:Ge(L.user.role),twoFactorVerified:!0});return}m&&n({...JSON.parse(b),role:R,twoFactorVerified:(E==null?void 0:E.twoFactor)!==!1})}catch{localStorage.removeItem("token"),localStorage.removeItem("refreshToken"),localStorage.removeItem("user"),localStorage.removeItem("2fa_pending"),localStorage.removeItem("2fa_user"),localStorage.removeItem(ki),localStorage.removeItem(Ii),m&&n(null)}})().finally(()=>{m&&c(!1)}),()=>{m=!1}},[]);const h=async(m,y)=>{var R;if(typeof y=="object"&&(y==null?void 0:y.directToken)===!0){const I=(y==null?void 0:y.token)||m;if(!I)throw new Error("Missing access token");const T=Cl(I),L=Ge(T==null?void 0:T.role);if(!L)throw new Error("Invalid Google token");const B={id:T.id,name:T.name,email:T.email,phone:T.phone,role:L};return localStorage.setItem("token",I),y!=null&&y.refreshToken&&localStorage.setItem("refreshToken",y.refreshToken),localStorage.setItem("user",JSON.stringify(B)),n({...B,twoFactorVerified:!0}),{user:B}}const b=await le("/api/auth/login",{method:"POST",body:{identifier:m,password:y}});if(b.requires2FA)return localStorage.setItem("2fa_pending","true"),localStorage.setItem("2fa_user",b.userId),{requires2FA:!0,userId:b.userId};const N=Ge((R=b.user)==null?void 0:R.role);if(!N)throw new Error("User role missing");const A={id:b.user.id,name:b.user.name,email:b.user.email,phone:b.user.phone,phoneVerified:b.user.phoneVerified,emailVerified:b.user.emailVerified,role:N};localStorage.setItem("token",b.accessToken),b.refreshToken&&localStorage.setItem("refreshToken",b.refreshToken),localStorage.setItem("user",JSON.stringify(A));const E=Cl(b.accessToken);return n({...A,twoFactorVerified:(E==null?void 0:E.twoFactor)!==!1}),{user:A}},f=(m,y)=>{const b=Cl(m);if(!(b!=null&&b.role))return;const N=Ge(b.role);localStorage.setItem("token",m),y&&localStorage.setItem("refreshToken",y),localStorage.removeItem("2fa_pending"),localStorage.removeItem("2fa_user");const A=JSON.parse(localStorage.getItem("user"));n({...A,role:N,twoFactorVerified:!0})},v=async()=>{try{const m=localStorage.getItem("refreshToken");await le("/api/auth/logout",{method:"POST",body:m?{refreshToken:m}:{}})}catch{}finally{localStorage.removeItem("token"),localStorage.removeItem("refreshToken"),localStorage.removeItem("user"),localStorage.removeItem("2fa_pending"),localStorage.removeItem("2fa_user"),localStorage.removeItem(ki),localStorage.removeItem(Ii),n(null),xj()}},j=m=>{const y=Ge(m);return u?y?(localStorage.setItem(ki,y),i(y),!0):(localStorage.removeItem(ki),i(""),!0):!1},_=m=>{if(!u)return!1;const y=!!m;return y?localStorage.setItem(Ii,"1"):localStorage.removeItem(Ii),o(y),!0};return g.useEffect(()=>{!u&&r&&(localStorage.removeItem(ki),i("")),!u&&a&&(localStorage.removeItem(Ii),o(!1))},[u,r,a]),s.jsx(jj.Provider,{value:{user:p,loading:l,isAuthenticated:!!p,role:p==null?void 0:p.role,actualRole:p==null?void 0:p.actualRole,roleOverride:r,strictImpersonation:a,canRoleOverride:u,setRoleOverride:j,setStrictImpersonation:_,login:h,complete2FA:f,logout:v,hasRole:(...m)=>m.includes(p==null?void 0:p.role),isAdmin:["SUPER_ADMIN","HOSPITAL_ADMIN"].includes(p==null?void 0:p.role),is2FAVerified:!!(p!=null&&p.twoFactorVerified)},children:l?s.jsx("div",{}):e})}function Me(){const e=g.useContext(jj);if(!e)throw new Error("useAuth must be used inside AuthProvider");return e}const vr=Object.create(null);vr.open="0";vr.close="1";vr.ping="2";vr.pong="3";vr.message="4";vr.upgrade="5";vr.noop="6";const nc=Object.create(null);Object.keys(vr).forEach(e=>{nc[vr[e]]=e});const Ah={type:"error",data:"parser error"},bj=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",wj=typeof ArrayBuffer=="function",Sj=e=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer,dp=({type:e,data:t},n,r)=>bj&&t instanceof Blob?n?r(t):xg(t,r):wj&&(t instanceof ArrayBuffer||Sj(t))?n?r(t):xg(new Blob([t]),r):r(vr[e]+(t||"")),xg=(e,t)=>{const n=new FileReader;return n.onload=function(){const r=n.result.split(",")[1];t("b"+(r||""))},n.readAsDataURL(e)};function jg(e){return e instanceof Uint8Array?e:e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}let Xu;function UN(e,t){if(bj&&e.data instanceof Blob)return e.data.arrayBuffer().then(jg).then(t);if(wj&&(e.data instanceof ArrayBuffer||Sj(e.data)))return t(jg(e.data));dp(e,!1,n=>{Xu||(Xu=new TextEncoder),t(Xu.encode(n))})}const bg="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",no=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let e=0;e<bg.length;e++)no[bg.charCodeAt(e)]=e;const BN=e=>{let t=e.length*.75,n=e.length,r,i=0,a,o,l,c;e[e.length-1]==="="&&(t--,e[e.length-2]==="="&&t--);const u=new ArrayBuffer(t),d=new Uint8Array(u);for(r=0;r<n;r+=4)a=no[e.charCodeAt(r)],o=no[e.charCodeAt(r+1)],l=no[e.charCodeAt(r+2)],c=no[e.charCodeAt(r+3)],d[i++]=a<<2|o>>4,d[i++]=(o&15)<<4|l>>2,d[i++]=(l&3)<<6|c&63;return u},VN=typeof ArrayBuffer=="function",hp=(e,t)=>{if(typeof e!="string")return{type:"message",data:Ej(e,t)};const n=e.charAt(0);return n==="b"?{type:"message",data:$N(e.substring(1),t)}:nc[n]?e.length>1?{type:nc[n],data:e.substring(1)}:{type:nc[n]}:Ah},$N=(e,t)=>{if(VN){const n=BN(e);return Ej(n,t)}else return{base64:!0,data:e}},Ej=(e,t)=>{switch(t){case"blob":return e instanceof Blob?e:new Blob([e]);case"arraybuffer":default:return e instanceof ArrayBuffer?e:e.buffer}},Nj="",FN=(e,t)=>{const n=e.length,r=new Array(n);let i=0;e.forEach((a,o)=>{dp(a,!1,l=>{r[o]=l,++i===n&&t(r.join(Nj))})})},HN=(e,t)=>{const n=e.split(Nj),r=[];for(let i=0;i<n.length;i++){const a=hp(n[i],t);if(r.push(a),a.type==="error")break}return r};function qN(){return new TransformStream({transform(e,t){UN(e,n=>{const r=n.length;let i;if(r<126)i=new Uint8Array(1),new DataView(i.buffer).setUint8(0,r);else if(r<65536){i=new Uint8Array(3);const a=new DataView(i.buffer);a.setUint8(0,126),a.setUint16(1,r)}else{i=new Uint8Array(9);const a=new DataView(i.buffer);a.setUint8(0,127),a.setBigUint64(1,BigInt(r))}e.data&&typeof e.data!="string"&&(i[0]|=128),t.enqueue(i),t.enqueue(n)})}})}let ed;function kl(e){return e.reduce((t,n)=>t+n.length,0)}function Il(e,t){if(e[0].length===t)return e.shift();const n=new Uint8Array(t);let r=0;for(let i=0;i<t;i++)n[i]=e[0][r++],r===e[0].length&&(e.shift(),r=0);return e.length&&r<e[0].length&&(e[0]=e[0].slice(r)),n}function zN(e,t){ed||(ed=new TextDecoder);const n=[];let r=0,i=-1,a=!1;return new TransformStream({transform(o,l){for(n.push(o);;){if(r===0){if(kl(n)<1)break;const c=Il(n,1);a=(c[0]&128)===128,i=c[0]&127,i<126?r=3:i===126?r=1:r=2}else if(r===1){if(kl(n)<2)break;const c=Il(n,2);i=new DataView(c.buffer,c.byteOffset,c.length).getUint16(0),r=3}else if(r===2){if(kl(n)<8)break;const c=Il(n,8),u=new DataView(c.buffer,c.byteOffset,c.length),d=u.getUint32(0);if(d>Math.pow(2,21)-1){l.enqueue(Ah);break}i=d*Math.pow(2,32)+u.getUint32(4),r=3}else{if(kl(n)<i)break;const c=Il(n,i);l.enqueue(hp(a?c:ed.decode(c),t)),r=0}if(i===0||i>e){l.enqueue(Ah);break}}}})}const _j=4;function wt(e){if(e)return WN(e)}function WN(e){for(var t in wt.prototype)e[t]=wt.prototype[t];return e}wt.prototype.on=wt.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this};wt.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this};wt.prototype.off=wt.prototype.removeListener=wt.prototype.removeAllListeners=wt.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var n=this._callbacks["$"+e];if(!n)return this;if(arguments.length==1)return delete this._callbacks["$"+e],this;for(var r,i=0;i<n.length;i++)if(r=n[i],r===t||r.fn===t){n.splice(i,1);break}return n.length===0&&delete this._callbacks["$"+e],this};wt.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks["$"+e],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(n){n=n.slice(0);for(var r=0,i=n.length;r<i;++r)n[r].apply(this,t)}return this};wt.prototype.emitReserved=wt.prototype.emit;wt.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]};wt.prototype.hasListeners=function(e){return!!this.listeners(e).length};const fu=typeof Promise=="function"&&typeof Promise.resolve=="function"?t=>Promise.resolve().then(t):(t,n)=>n(t,0),In=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),GN="arraybuffer";function Aj(e,...t){return t.reduce((n,r)=>(e.hasOwnProperty(r)&&(n[r]=e[r]),n),{})}const YN=In.setTimeout,KN=In.clearTimeout;function pu(e,t){t.useNativeTimers?(e.setTimeoutFn=YN.bind(In),e.clearTimeoutFn=KN.bind(In)):(e.setTimeoutFn=In.setTimeout.bind(In),e.clearTimeoutFn=In.clearTimeout.bind(In))}const JN=1.33;function QN(e){return typeof e=="string"?ZN(e):Math.ceil((e.byteLength||e.size)*JN)}function ZN(e){let t=0,n=0;for(let r=0,i=e.length;r<i;r++)t=e.charCodeAt(r),t<128?n+=1:t<2048?n+=2:t<55296||t>=57344?n+=3:(r++,n+=4);return n}function Cj(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function XN(e){let t="";for(let n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t}function e_(e){let t={},n=e.split("&");for(let r=0,i=n.length;r<i;r++){let a=n[r].split("=");t[decodeURIComponent(a[0])]=decodeURIComponent(a[1])}return t}class t_ extends Error{constructor(t,n,r){super(t),this.description=n,this.context=r,this.type="TransportError"}}class fp extends wt{constructor(t){super(),this.writable=!1,pu(this,t),this.opts=t,this.query=t.query,this.socket=t.socket,this.supportsBinary=!t.forceBase64}onError(t,n,r){return super.emitReserved("error",new t_(t,n,r)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(t){this.readyState==="open"&&this.write(t)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(t){const n=hp(t,this.socket.binaryType);this.onPacket(n)}onPacket(t){super.emitReserved("packet",t)}onClose(t){this.readyState="closed",super.emitReserved("close",t)}pause(t){}createUri(t,n={}){return t+"://"+this._hostname()+this._port()+this.opts.path+this._query(n)}_hostname(){const t=this.opts.hostname;return t.indexOf(":")===-1?t:"["+t+"]"}_port(){return this.opts.port&&(this.opts.secure&&Number(this.opts.port)!==443||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(t){const n=XN(t);return n.length?"?"+n:""}}class n_ extends fp{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(t){this.readyState="pausing";const n=()=>{this.readyState="paused",t()};if(this._polling||!this.writable){let r=0;this._polling&&(r++,this.once("pollComplete",function(){--r||n()})),this.writable||(r++,this.once("drain",function(){--r||n()}))}else n()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(t){const n=r=>{if(this.readyState==="opening"&&r.type==="open"&&this.onOpen(),r.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(r)};HN(t,this.socket.binaryType).forEach(n),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const t=()=>{this.write([{type:"close"}])};this.readyState==="open"?t():this.once("open",t)}write(t){this.writable=!1,FN(t,n=>{this.doWrite(n,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const t=this.opts.secure?"https":"http",n=this.query||{};return this.opts.timestampRequests!==!1&&(n[this.opts.timestampParam]=Cj()),!this.supportsBinary&&!n.sid&&(n.b64=1),this.createUri(t,n)}}let kj=!1;try{kj=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const r_=kj;function s_(){}class i_ extends n_{constructor(t){if(super(t),typeof location<"u"){const n=location.protocol==="https:";let r=location.port;r||(r=n?"443":"80"),this.xd=typeof location<"u"&&t.hostname!==location.hostname||r!==t.port}}doWrite(t,n){const r=this.request({method:"POST",data:t});r.on("success",n),r.on("error",(i,a)=>{this.onError("xhr post error",i,a)})}doPoll(){const t=this.request();t.on("data",this.onData.bind(this)),t.on("error",(n,r)=>{this.onError("xhr poll error",n,r)}),this.pollXhr=t}}class pr extends wt{constructor(t,n,r){super(),this.createRequest=t,pu(this,r),this._opts=r,this._method=r.method||"GET",this._uri=n,this._data=r.data!==void 0?r.data:null,this._create()}_create(){var t;const n=Aj(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");n.xdomain=!!this._opts.xd;const r=this._xhr=this.createRequest(n);try{r.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){r.setDisableHeaderCheck&&r.setDisableHeaderCheck(!0);for(let i in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(i)&&r.setRequestHeader(i,this._opts.extraHeaders[i])}}catch{}if(this._method==="POST")try{r.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{r.setRequestHeader("Accept","*/*")}catch{}(t=this._opts.cookieJar)===null||t===void 0||t.addCookies(r),"withCredentials"in r&&(r.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(r.timeout=this._opts.requestTimeout),r.onreadystatechange=()=>{var i;r.readyState===3&&((i=this._opts.cookieJar)===null||i===void 0||i.parseCookies(r.getResponseHeader("set-cookie"))),r.readyState===4&&(r.status===200||r.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof r.status=="number"?r.status:0)},0))},r.send(this._data)}catch(i){this.setTimeoutFn(()=>{this._onError(i)},0);return}typeof document<"u"&&(this._index=pr.requestsCount++,pr.requests[this._index]=this)}_onError(t){this.emitReserved("error",t,this._xhr),this._cleanup(!0)}_cleanup(t){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=s_,t)try{this._xhr.abort()}catch{}typeof document<"u"&&delete pr.requests[this._index],this._xhr=null}}_onLoad(){const t=this._xhr.responseText;t!==null&&(this.emitReserved("data",t),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}pr.requestsCount=0;pr.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",wg);else if(typeof addEventListener=="function"){const e="onpagehide"in In?"pagehide":"unload";addEventListener(e,wg,!1)}}function wg(){for(let e in pr.requests)pr.requests.hasOwnProperty(e)&&pr.requests[e].abort()}const a_=function(){const e=Ij({xdomain:!1});return e&&e.responseType!==null}();class o_ extends i_{constructor(t){super(t);const n=t&&t.forceBase64;this.supportsBinary=a_&&!n}request(t={}){return Object.assign(t,{xd:this.xd},this.opts),new pr(Ij,this.uri(),t)}}function Ij(e){const t=e.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!t||r_))return new XMLHttpRequest}catch{}if(!t)try{return new In[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const Rj=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class l_ extends fp{get name(){return"websocket"}doOpen(){const t=this.uri(),n=this.opts.protocols,r=Rj?{}:Aj(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(r.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(t,n,r)}catch(i){return this.emitReserved("error",i)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=t=>this.onClose({description:"websocket connection closed",context:t}),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=!1;for(let n=0;n<t.length;n++){const r=t[n],i=n===t.length-1;dp(r,this.supportsBinary,a=>{try{this.doWrite(r,a)}catch{}i&&fu(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const t=this.opts.secure?"wss":"ws",n=this.query||{};return this.opts.timestampRequests&&(n[this.opts.timestampParam]=Cj()),this.supportsBinary||(n.b64=1),this.createUri(t,n)}}const td=In.WebSocket||In.MozWebSocket;class c_ extends l_{createSocket(t,n,r){return Rj?new td(t,n,r):n?new td(t,n):new td(t)}doWrite(t,n){this.ws.send(n)}}class u_ extends fp{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(t){return this.emitReserved("error",t)}this._transport.closed.then(()=>{this.onClose()}).catch(t=>{this.onError("webtransport error",t)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(t=>{const n=zN(Number.MAX_SAFE_INTEGER,this.socket.binaryType),r=t.readable.pipeThrough(n).getReader(),i=qN();i.readable.pipeTo(t.writable),this._writer=i.writable.getWriter();const a=()=>{r.read().then(({done:l,value:c})=>{l||(this.onPacket(c),a())}).catch(l=>{})};a();const o={type:"open"};this.query.sid&&(o.data=`{"sid":"${this.query.sid}"}`),this._writer.write(o).then(()=>this.onOpen())})})}write(t){this.writable=!1;for(let n=0;n<t.length;n++){const r=t[n],i=n===t.length-1;this._writer.write(r).then(()=>{i&&fu(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var t;(t=this._transport)===null||t===void 0||t.close()}}const d_={websocket:c_,webtransport:u_,polling:o_},h_=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,f_=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function Ch(e){if(e.length>8e3)throw"URI too long";const t=e,n=e.indexOf("["),r=e.indexOf("]");n!=-1&&r!=-1&&(e=e.substring(0,n)+e.substring(n,r).replace(/:/g,";")+e.substring(r,e.length));let i=h_.exec(e||""),a={},o=14;for(;o--;)a[f_[o]]=i[o]||"";return n!=-1&&r!=-1&&(a.source=t,a.host=a.host.substring(1,a.host.length-1).replace(/;/g,":"),a.authority=a.authority.replace("[","").replace("]","").replace(/;/g,":"),a.ipv6uri=!0),a.pathNames=p_(a,a.path),a.queryKey=m_(a,a.query),a}function p_(e,t){const n=/\/{2,9}/g,r=t.replace(n,"/").split("/");return(t.slice(0,1)=="/"||t.length===0)&&r.splice(0,1),t.slice(-1)=="/"&&r.splice(r.length-1,1),r}function m_(e,t){const n={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(r,i,a){i&&(n[i]=a)}),n}const kh=typeof addEventListener=="function"&&typeof removeEventListener=="function",rc=[];kh&&addEventListener("offline",()=>{rc.forEach(e=>e())},!1);class gs extends wt{constructor(t,n){if(super(),this.binaryType=GN,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,t&&typeof t=="object"&&(n=t,t=null),t){const r=Ch(t);n.hostname=r.host,n.secure=r.protocol==="https"||r.protocol==="wss",n.port=r.port,r.query&&(n.query=r.query)}else n.host&&(n.hostname=Ch(n.host).host);pu(this,n),this.secure=n.secure!=null?n.secure:typeof location<"u"&&location.protocol==="https:",n.hostname&&!n.port&&(n.port=this.secure?"443":"80"),this.hostname=n.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=n.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},n.transports.forEach(r=>{const i=r.prototype.name;this.transports.push(i),this._transportsByName[i]=r}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},n),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=e_(this.opts.query)),kh&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},rc.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(t){const n=Object.assign({},this.opts.query);n.EIO=_j,n.transport=t,this.id&&(n.sid=this.id);const r=Object.assign({},this.opts,{query:n,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[t]);return new this._transportsByName[t](r)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const t=this.opts.rememberUpgrade&&gs.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const n=this.createTransport(t);n.open(),this.setTransport(n)}setTransport(t){this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",n=>this._onClose("transport close",n))}onOpen(){this.readyState="open",gs.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",t),this.emitReserved("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const n=new Error("server error");n.code=t.data,this._onError(n);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data);break}}onHandshake(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this._pingInterval=t.pingInterval,this._pingTimeout=t.pingTimeout,this._maxPayload=t.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const t=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+t,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},t),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const t=this._getWritablePackets();this.transport.send(t),this._prevBufferLen=t.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let n=1;for(let r=0;r<this.writeBuffer.length;r++){const i=this.writeBuffer[r].data;if(i&&(n+=QN(i)),r>0&&n>this._maxPayload)return this.writeBuffer.slice(0,r);n+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const t=Date.now()>this._pingTimeoutTime;return t&&(this._pingTimeoutTime=0,fu(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),t}write(t,n,r){return this._sendPacket("message",t,n,r),this}send(t,n,r){return this._sendPacket("message",t,n,r),this}_sendPacket(t,n,r,i){if(typeof n=="function"&&(i=n,n=void 0),typeof r=="function"&&(i=r,r=null),this.readyState==="closing"||this.readyState==="closed")return;r=r||{},r.compress=r.compress!==!1;const a={type:t,data:n,options:r};this.emitReserved("packetCreate",a),this.writeBuffer.push(a),i&&this.once("flush",i),this.flush()}close(){const t=()=>{this._onClose("forced close"),this.transport.close()},n=()=>{this.off("upgrade",n),this.off("upgradeError",n),t()},r=()=>{this.once("upgrade",n),this.once("upgradeError",n)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?r():t()}):this.upgrading?r():t()),this}_onError(t){if(gs.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",t),this._onClose("transport error",t)}_onClose(t,n){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),kh&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const r=rc.indexOf(this._offlineEventListener);r!==-1&&rc.splice(r,1)}this.readyState="closed",this.id=null,this.emitReserved("close",t,n),this.writeBuffer=[],this._prevBufferLen=0}}}gs.protocol=_j;class g_ extends gs{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let t=0;t<this._upgrades.length;t++)this._probe(this._upgrades[t])}_probe(t){let n=this.createTransport(t),r=!1;gs.priorWebsocketSuccess=!1;const i=()=>{r||(n.send([{type:"ping",data:"probe"}]),n.once("packet",p=>{if(!r)if(p.type==="pong"&&p.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",n),!n)return;gs.priorWebsocketSuccess=n.name==="websocket",this.transport.pause(()=>{r||this.readyState!=="closed"&&(d(),this.setTransport(n),n.send([{type:"upgrade"}]),this.emitReserved("upgrade",n),n=null,this.upgrading=!1,this.flush())})}else{const h=new Error("probe error");h.transport=n.name,this.emitReserved("upgradeError",h)}}))};function a(){r||(r=!0,d(),n.close(),n=null)}const o=p=>{const h=new Error("probe error: "+p);h.transport=n.name,a(),this.emitReserved("upgradeError",h)};function l(){o("transport closed")}function c(){o("socket closed")}function u(p){n&&p.name!==n.name&&a()}const d=()=>{n.removeListener("open",i),n.removeListener("error",o),n.removeListener("close",l),this.off("close",c),this.off("upgrading",u)};n.once("open",i),n.once("error",o),n.once("close",l),this.once("close",c),this.once("upgrading",u),this._upgrades.indexOf("webtransport")!==-1&&t!=="webtransport"?this.setTimeoutFn(()=>{r||n.open()},200):n.open()}onHandshake(t){this._upgrades=this._filterUpgrades(t.upgrades),super.onHandshake(t)}_filterUpgrades(t){const n=[];for(let r=0;r<t.length;r++)~this.transports.indexOf(t[r])&&n.push(t[r]);return n}}let y_=class extends g_{constructor(t,n={}){const r=typeof t=="object"?t:n;(!r.transports||r.transports&&typeof r.transports[0]=="string")&&(r.transports=(r.transports||["polling","websocket","webtransport"]).map(i=>d_[i]).filter(i=>!!i)),super(t,r)}};function v_(e,t="",n){let r=e;n=n||typeof location<"u"&&location,e==null&&(e=n.protocol+"//"+n.host),typeof e=="string"&&(e.charAt(0)==="/"&&(e.charAt(1)==="/"?e=n.protocol+e:e=n.host+e),/^(https?|wss?):\/\//.test(e)||(typeof n<"u"?e=n.protocol+"//"+e:e="https://"+e),r=Ch(e)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";const a=r.host.indexOf(":")!==-1?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+a+":"+r.port+t,r.href=r.protocol+"://"+a+(n&&n.port===r.port?"":":"+r.port),r}const x_=typeof ArrayBuffer=="function",j_=e=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer,Tj=Object.prototype.toString,b_=typeof Blob=="function"||typeof Blob<"u"&&Tj.call(Blob)==="[object BlobConstructor]",w_=typeof File=="function"||typeof File<"u"&&Tj.call(File)==="[object FileConstructor]";function pp(e){return x_&&(e instanceof ArrayBuffer||j_(e))||b_&&e instanceof Blob||w_&&e instanceof File}function sc(e,t){if(!e||typeof e!="object")return!1;if(Array.isArray(e)){for(let n=0,r=e.length;n<r;n++)if(sc(e[n]))return!0;return!1}if(pp(e))return!0;if(e.toJSON&&typeof e.toJSON=="function"&&arguments.length===1)return sc(e.toJSON(),!0);for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&sc(e[n]))return!0;return!1}function S_(e){const t=[],n=e.data,r=e;return r.data=Ih(n,t),r.attachments=t.length,{packet:r,buffers:t}}function Ih(e,t){if(!e)return e;if(pp(e)){const n={_placeholder:!0,num:t.length};return t.push(e),n}else if(Array.isArray(e)){const n=new Array(e.length);for(let r=0;r<e.length;r++)n[r]=Ih(e[r],t);return n}else if(typeof e=="object"&&!(e instanceof Date)){const n={};for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=Ih(e[r],t));return n}return e}function E_(e,t){return e.data=Rh(e.data,t),delete e.attachments,e}function Rh(e,t){if(!e)return e;if(e&&e._placeholder===!0){if(typeof e.num=="number"&&e.num>=0&&e.num<t.length)return t[e.num];throw new Error("illegal attachments")}else if(Array.isArray(e))for(let n=0;n<e.length;n++)e[n]=Rh(e[n],t);else if(typeof e=="object")for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(e[n]=Rh(e[n],t));return e}const N_=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"];var Oe;(function(e){e[e.CONNECT=0]="CONNECT",e[e.DISCONNECT=1]="DISCONNECT",e[e.EVENT=2]="EVENT",e[e.ACK=3]="ACK",e[e.CONNECT_ERROR=4]="CONNECT_ERROR",e[e.BINARY_EVENT=5]="BINARY_EVENT",e[e.BINARY_ACK=6]="BINARY_ACK"})(Oe||(Oe={}));let __=class{constructor(t){this.replacer=t}encode(t){return(t.type===Oe.EVENT||t.type===Oe.ACK)&&sc(t)?this.encodeAsBinary({type:t.type===Oe.EVENT?Oe.BINARY_EVENT:Oe.BINARY_ACK,nsp:t.nsp,data:t.data,id:t.id}):[this.encodeAsString(t)]}encodeAsString(t){let n=""+t.type;return(t.type===Oe.BINARY_EVENT||t.type===Oe.BINARY_ACK)&&(n+=t.attachments+"-"),t.nsp&&t.nsp!=="/"&&(n+=t.nsp+","),t.id!=null&&(n+=t.id),t.data!=null&&(n+=JSON.stringify(t.data,this.replacer)),n}encodeAsBinary(t){const n=S_(t),r=this.encodeAsString(n.packet),i=n.buffers;return i.unshift(r),i}},A_=class Oj extends wt{constructor(t){super(),this.reviver=t}add(t){let n;if(typeof t=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");n=this.decodeString(t);const r=n.type===Oe.BINARY_EVENT;r||n.type===Oe.BINARY_ACK?(n.type=r?Oe.EVENT:Oe.ACK,this.reconstructor=new C_(n),n.attachments===0&&super.emitReserved("decoded",n)):super.emitReserved("decoded",n)}else if(pp(t)||t.base64)if(this.reconstructor)n=this.reconstructor.takeBinaryData(t),n&&(this.reconstructor=null,super.emitReserved("decoded",n));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+t)}decodeString(t){let n=0;const r={type:Number(t.charAt(0))};if(Oe[r.type]===void 0)throw new Error("unknown packet type "+r.type);if(r.type===Oe.BINARY_EVENT||r.type===Oe.BINARY_ACK){const a=n+1;for(;t.charAt(++n)!=="-"&&n!=t.length;);const o=t.substring(a,n);if(o!=Number(o)||t.charAt(n)!=="-")throw new Error("Illegal attachments");r.attachments=Number(o)}if(t.charAt(n+1)==="/"){const a=n+1;for(;++n&&!(t.charAt(n)===","||n===t.length););r.nsp=t.substring(a,n)}else r.nsp="/";const i=t.charAt(n+1);if(i!==""&&Number(i)==i){const a=n+1;for(;++n;){const o=t.charAt(n);if(o==null||Number(o)!=o){--n;break}if(n===t.length)break}r.id=Number(t.substring(a,n+1))}if(t.charAt(++n)){const a=this.tryParse(t.substr(n));if(Oj.isPayloadValid(r.type,a))r.data=a;else throw new Error("invalid payload")}return r}tryParse(t){try{return JSON.parse(t,this.reviver)}catch{return!1}}static isPayloadValid(t,n){switch(t){case Oe.CONNECT:return Sg(n);case Oe.DISCONNECT:return n===void 0;case Oe.CONNECT_ERROR:return typeof n=="string"||Sg(n);case Oe.EVENT:case Oe.BINARY_EVENT:return Array.isArray(n)&&(typeof n[0]=="number"||typeof n[0]=="string"&&N_.indexOf(n[0])===-1);case Oe.ACK:case Oe.BINARY_ACK:return Array.isArray(n)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}};class C_{constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){const n=E_(this.reconPack,this.buffers);return this.finishedReconstruction(),n}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}function Sg(e){return Object.prototype.toString.call(e)==="[object Object]"}const k_=Object.freeze(Object.defineProperty({__proto__:null,Decoder:A_,Encoder:__,get PacketType(){return Oe}},Symbol.toStringTag,{value:"Module"}));function Wn(e,t,n){return e.on(t,n),function(){e.off(t,n)}}const I_=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class Pj extends wt{constructor(t,n,r){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=n,r&&r.auth&&(this.auth=r.auth),this._opts=Object.assign({},r),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const t=this.io;this.subs=[Wn(t,"open",this.onopen.bind(this)),Wn(t,"packet",this.onpacket.bind(this)),Wn(t,"error",this.onerror.bind(this)),Wn(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...n){var r,i,a;if(I_.hasOwnProperty(t))throw new Error('"'+t.toString()+'" is a reserved event name');if(n.unshift(t),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(n),this;const o={type:Oe.EVENT,data:n};if(o.options={},o.options.compress=this.flags.compress!==!1,typeof n[n.length-1]=="function"){const d=this.ids++,p=n.pop();this._registerAckCallback(d,p),o.id=d}const l=(i=(r=this.io.engine)===null||r===void 0?void 0:r.transport)===null||i===void 0?void 0:i.writable,c=this.connected&&!(!((a=this.io.engine)===null||a===void 0)&&a._hasPingExpired());return this.flags.volatile&&!l||(c?(this.notifyOutgoingListeners(o),this.packet(o)):this.sendBuffer.push(o)),this.flags={},this}_registerAckCallback(t,n){var r;const i=(r=this.flags.timeout)!==null&&r!==void 0?r:this._opts.ackTimeout;if(i===void 0){this.acks[t]=n;return}const a=this.io.setTimeoutFn(()=>{delete this.acks[t];for(let l=0;l<this.sendBuffer.length;l++)this.sendBuffer[l].id===t&&this.sendBuffer.splice(l,1);n.call(this,new Error("operation has timed out"))},i),o=(...l)=>{this.io.clearTimeoutFn(a),n.apply(this,l)};o.withError=!0,this.acks[t]=o}emitWithAck(t,...n){return new Promise((r,i)=>{const a=(o,l)=>o?i(o):r(l);a.withError=!0,n.push(a),this.emit(t,...n)})}_addToQueue(t){let n;typeof t[t.length-1]=="function"&&(n=t.pop());const r={id:this._queueSeq++,tryCount:0,pending:!1,args:t,flags:Object.assign({fromQueue:!0},this.flags)};t.push((i,...a)=>(this._queue[0],i!==null?r.tryCount>this._opts.retries&&(this._queue.shift(),n&&n(i)):(this._queue.shift(),n&&n(null,...a)),r.pending=!1,this._drainQueue())),this._queue.push(r),this._drainQueue()}_drainQueue(t=!1){if(!this.connected||this._queue.length===0)return;const n=this._queue[0];n.pending&&!t||(n.pending=!0,n.tryCount++,this.flags=n.flags,this.emit.apply(this,n.args))}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){typeof this.auth=="function"?this.auth(t=>{this._sendConnectPacket(t)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(t){this.packet({type:Oe.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},t):t})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t,n){this.connected=!1,delete this.id,this.emitReserved("disconnect",t,n),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(t=>{if(!this.sendBuffer.some(r=>String(r.id)===t)){const r=this.acks[t];delete this.acks[t],r.withError&&r.call(this,new Error("socket has been disconnected"))}})}onpacket(t){if(t.nsp===this.nsp)switch(t.type){case Oe.CONNECT:t.data&&t.data.sid?this.onconnect(t.data.sid,t.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case Oe.EVENT:case Oe.BINARY_EVENT:this.onevent(t);break;case Oe.ACK:case Oe.BINARY_ACK:this.onack(t);break;case Oe.DISCONNECT:this.ondisconnect();break;case Oe.CONNECT_ERROR:this.destroy();const r=new Error(t.data.message);r.data=t.data.data,this.emitReserved("connect_error",r);break}}onevent(t){const n=t.data||[];t.id!=null&&n.push(this.ack(t.id)),this.connected?this.emitEvent(n):this.receiveBuffer.push(Object.freeze(n))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){const n=this._anyListeners.slice();for(const r of n)r.apply(this,t)}super.emit.apply(this,t),this._pid&&t.length&&typeof t[t.length-1]=="string"&&(this._lastOffset=t[t.length-1])}ack(t){const n=this;let r=!1;return function(...i){r||(r=!0,n.packet({type:Oe.ACK,id:t,data:i}))}}onack(t){const n=this.acks[t.id];typeof n=="function"&&(delete this.acks[t.id],n.withError&&t.data.unshift(null),n.apply(this,t.data))}onconnect(t,n){this.id=t,this.recovered=n&&this._pid===n,this._pid=n,this.connected=!0,this.emitBuffered(),this._drainQueue(!0),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach(t=>this.emitEvent(t)),this.receiveBuffer=[],this.sendBuffer.forEach(t=>{this.notifyOutgoingListeners(t),this.packet(t)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(t=>t()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:Oe.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}timeout(t){return this.flags.timeout=t,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){const n=this._anyListeners;for(let r=0;r<n.length;r++)if(t===n[r])return n.splice(r,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(t),this}prependAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(t),this}offAnyOutgoing(t){if(!this._anyOutgoingListeners)return this;if(t){const n=this._anyOutgoingListeners;for(let r=0;r<n.length;r++)if(t===n[r])return n.splice(r,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(t){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const n=this._anyOutgoingListeners.slice();for(const r of n)r.apply(this,t.data)}}}function Ea(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}Ea.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=Math.floor(t*10)&1?e+n:e-n}return Math.min(e,this.max)|0};Ea.prototype.reset=function(){this.attempts=0};Ea.prototype.setMin=function(e){this.ms=e};Ea.prototype.setMax=function(e){this.max=e};Ea.prototype.setJitter=function(e){this.jitter=e};class Th extends wt{constructor(t,n){var r;super(),this.nsps={},this.subs=[],t&&typeof t=="object"&&(n=t,t=void 0),n=n||{},n.path=n.path||"/socket.io",this.opts=n,pu(this,n),this.reconnection(n.reconnection!==!1),this.reconnectionAttempts(n.reconnectionAttempts||1/0),this.reconnectionDelay(n.reconnectionDelay||1e3),this.reconnectionDelayMax(n.reconnectionDelayMax||5e3),this.randomizationFactor((r=n.randomizationFactor)!==null&&r!==void 0?r:.5),this.backoff=new Ea({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(n.timeout==null?2e4:n.timeout),this._readyState="closed",this.uri=t;const i=n.parser||k_;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this._autoConnect=n.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(t){return arguments.length?(this._reconnection=!!t,t||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(t){return t===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var n;return t===void 0?this._reconnectionDelay:(this._reconnectionDelay=t,(n=this.backoff)===null||n===void 0||n.setMin(t),this)}randomizationFactor(t){var n;return t===void 0?this._randomizationFactor:(this._randomizationFactor=t,(n=this.backoff)===null||n===void 0||n.setJitter(t),this)}reconnectionDelayMax(t){var n;return t===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,(n=this.backoff)===null||n===void 0||n.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(t){if(~this._readyState.indexOf("open"))return this;this.engine=new y_(this.uri,this.opts);const n=this.engine,r=this;this._readyState="opening",this.skipReconnect=!1;const i=Wn(n,"open",function(){r.onopen(),t&&t()}),a=l=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",l),t?t(l):this.maybeReconnectOnOpen()},o=Wn(n,"error",a);if(this._timeout!==!1){const l=this._timeout,c=this.setTimeoutFn(()=>{i(),a(new Error("timeout")),n.close()},l);this.opts.autoUnref&&c.unref(),this.subs.push(()=>{this.clearTimeoutFn(c)})}return this.subs.push(i),this.subs.push(o),this}connect(t){return this.open(t)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const t=this.engine;this.subs.push(Wn(t,"ping",this.onping.bind(this)),Wn(t,"data",this.ondata.bind(this)),Wn(t,"error",this.onerror.bind(this)),Wn(t,"close",this.onclose.bind(this)),Wn(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){try{this.decoder.add(t)}catch(n){this.onclose("parse error",n)}}ondecoded(t){fu(()=>{this.emitReserved("packet",t)},this.setTimeoutFn)}onerror(t){this.emitReserved("error",t)}socket(t,n){let r=this.nsps[t];return r?this._autoConnect&&!r.active&&r.connect():(r=new Pj(this,t,n),this.nsps[t]=r),r}_destroy(t){const n=Object.keys(this.nsps);for(const r of n)if(this.nsps[r].active)return;this._close()}_packet(t){const n=this.encoder.encode(t);for(let r=0;r<n.length;r++)this.engine.write(n[r],t.options)}cleanup(){this.subs.forEach(t=>t()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(t,n){var r;this.cleanup(),(r=this.engine)===null||r===void 0||r.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t,n),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const n=this.backoff.duration();this._reconnecting=!0;const r=this.setTimeoutFn(()=>{t.skipReconnect||(this.emitReserved("reconnect_attempt",t.backoff.attempts),!t.skipReconnect&&t.open(i=>{i?(t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",i)):t.onreconnect()}))},n);this.opts.autoUnref&&r.unref(),this.subs.push(()=>{this.clearTimeoutFn(r)})}}onreconnect(){const t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}}const za={};function ic(e,t){typeof e=="object"&&(t=e,e=void 0),t=t||{};const n=v_(e,t.path||"/socket.io"),r=n.source,i=n.id,a=n.path,o=za[i]&&a in za[i].nsps,l=t.forceNew||t["force new connection"]||t.multiplex===!1||o;let c;return l?c=new Th(r,t):(za[i]||(za[i]=new Th(r,t)),c=za[i]),n.query&&!t.query&&(t.query=n.queryKey),c.socket(n.path,t)}Object.assign(ic,{Manager:Th,Socket:Pj,io:ic,connect:ic});const Lj=g.createContext(void 0);function R_({children:e}){const[t,n]=g.useState(null);return g.useEffect(()=>{const r=localStorage.getItem("token");if(!r)return;const a=ic("http://localhost:5000",{transports:["websocket"],auth:{token:r}});return n(a),a.on("connect",()=>{console.log(" Socket connected:",a.id)}),a.on("disconnect",()=>{console.log(" Socket disconnected")}),()=>{a.disconnect(),n(null)}},[]),s.jsx(Lj.Provider,{value:t,children:e})}const T_=()=>{const e=g.useContext(Lj);return e===void 0&&console.warn("useSocket used outside SocketProvider"),e},O_=Object.freeze({SUPER_ADMIN:"/super-admin",SYSTEM_ADMIN:"/system-admin",HOSPITAL_ADMIN:"/hospital-admin",SECURITY_ADMIN:"/security-admin",SECURITY_OFFICER:"/security-officer",HR_MANAGER:"/hr-manager",PAYROLL_OFFICER:"/payroll-officer",DEVELOPER:"/developer",DOCTOR:"/doctor",NURSE:"/nurse",LAB_TECH:"/lab-tech",PHARMACIST:"/pharmacy",PATIENT:"/patient",GUEST:"/guest",RADIOLOGIST:"/staff",THERAPIST:"/staff",RECEPTIONIST:"/staff"}),ws=e=>{if(!(e!=null&&e.role))return"/login";const t=Ge(e.role);return O_[t]||"/unauthorized"},P_=[{label:"Dashboard Overview",path:"/"},{label:"Profile",path:"/profile"},{label:"Analytics",path:"/analytics"},{label:"Reports",path:"/reports"},{label:"Inventory",path:"/inventory"},{label:"Payments",path:"/payments"},{label:"Payment Operations",path:"/payments/full"},{label:"Payment Settings",path:"/admin/payment-settings"},{label:"AI Assistant",path:"/ai/medical"},{label:"AI Triage",path:"/ai/triage"},{label:"AI Voice Dictation",path:"/ai/voice"},{label:"AI Document Extract",path:"/ai/extract"},{label:"AI Chatbot",path:"/ai/chatbot"}],L_={SUPER_ADMIN:[{label:"Super Admin Dashboard",path:"/super-admin"},{label:"Manage Hospitals",path:"/super-admin/hospitals"},{label:"System Settings",path:"/super-admin/settings"},{label:"Admin Controls",path:"/admin"},{label:"Audit Logs",path:"/admin/audit-logs"},{label:"Integrations",path:"/admin/realtime"},{label:"System Admin Dashboard",path:"/system-admin"},{label:"Developer Console",path:"/developer"}],SYSTEM_ADMIN:[{label:"System Admin Dashboard",path:"/system-admin"},{label:"ABAC Policies",path:"/system-admin/abac"},{label:"Mapping Studio",path:"/system-admin/mapping-studio"},{label:"NLP Analytics",path:"/system-admin/nlp-analytics"},{label:"Regulatory Reports",path:"/system-admin/regulatory-reports"},{label:"Clinical Intelligence",path:"/system-admin/clinical-intelligence"},{label:"Manage Hospitals",path:"/super-admin/hospitals"},{label:"Admin Controls",path:"/admin"},{label:"Audit Logs",path:"/admin/audit-logs"},{label:"Integrations",path:"/admin/realtime"}],HOSPITAL_ADMIN:[{label:"Hospital Admin",path:"/hospital-admin"},{label:"Register Staff",path:"/hospital-admin/register-staff"},{label:"Approvals",path:"/hospital-admin/approvals"},{label:"Staff Management",path:"/hospital-admin/staff"},{label:"My Requests",path:"/workforce/requests"},{label:"Notifications",path:"/admin/notifications"},{label:"Offline Sync",path:"/admin/crdt-patients"},{label:"Clinical Intelligence",path:"/system-admin/clinical-intelligence"}],DOCTOR:[{label:"Doctor Dashboard",path:"/doctor"},{label:"My Schedule",path:"/doctor/schedule"},{label:"My Patients",path:"/doctor/patients"},{label:"OPD Clinic",path:"/doctor/opd"},{label:"Inpatient Ward",path:"/doctor/ward"},{label:"Surgery / Procedures",path:"/doctor/surgery"},{label:"Lab Results",path:"/doctor/lab-results"},{label:"Prescriptions",path:"/doctor/prescriptions"},{label:"Medical Records",path:"/doctor/medical-records"},{label:"Referrals",path:"/doctor/referrals"},{label:"Performance",path:"/doctor/performance"},{label:"CME & Certifications",path:"/doctor/cme"},{label:"Leave Requests",path:"/doctor/leave"},{label:"Reports & Notes",path:"/doctor/reports-notes"},{label:"Doctor Settings",path:"/doctor/settings"},{label:"Appointments",path:"/doctor/appointments"},{label:"My Requests",path:"/workforce/requests"},{label:"Clinical Intelligence",path:"/system-admin/clinical-intelligence"}],NURSE:[{label:"Nurse Dashboard",path:"/nurse"},{label:"My Shift",path:"/nurse/shift"},{label:"Assigned Patients",path:"/nurse/patients"},{label:"Medication Administration",path:"/nurse/medication"},{label:"Incident Reports",path:"/nurse/incidents"},{label:"Vitals Entry",path:"/nurse/vitals"},{label:"Leave Requests",path:"/nurse/leave"},{label:"Performance",path:"/nurse/performance"},{label:"My Requests",path:"/workforce/requests"},{label:"Clinical Intelligence",path:"/system-admin/clinical-intelligence"}],LAB_TECH:[{label:"Lab Dashboard",path:"/lab-tech"},{label:"Test Queue",path:"/lab-tech/test-queue"},{label:"Equipment Logs",path:"/lab-tech/equipment"},{label:"Sample Tracking",path:"/lab-tech/samples"},{label:"Quality Control",path:"/lab-tech/qc"},{label:"Safety Checklist",path:"/lab-tech/safety"},{label:"Reports Archive",path:"/lab-tech/archive"},{label:"Lab Tests",path:"/labtech/labs"},{label:"My Requests",path:"/workforce/requests"}],PHARMACIST:[{label:"Pharmacy",path:"/pharmacy"},{label:"Prescription Queue",path:"/pharmacy/queue"},{label:"Inventory",path:"/pharmacy/inventory"},{label:"Controlled Drugs",path:"/pharmacy/controlled"},{label:"Expiry Alerts",path:"/pharmacy/expiry"},{label:"Supplier Orders",path:"/pharmacy/suppliers"},{label:"Pharmacy Reports",path:"/pharmacy/reports"},{label:"My Requests",path:"/workforce/requests"}],HR_MANAGER:[{label:"HR Manager",path:"/hr-manager"},{label:"My Requests",path:"/workforce/requests"},{label:"Clinical Intelligence",path:"/system-admin/clinical-intelligence"}],PAYROLL_OFFICER:[{label:"Payroll Officer",path:"/payroll-officer"},{label:"My Requests",path:"/workforce/requests"}],DEVELOPER:[{label:"Developer Console",path:"/developer"},{label:"Queue Replay",path:"/developer/queue-replay"},{label:"Webhook Retry",path:"/developer/webhook-retry"},{label:"Decision Cockpit",path:"/developer/decision-cockpit"},{label:"Provenance Verify",path:"/developer/provenance-verify"},{label:"AI Extraction History",path:"/developer/ai-extraction-history"},{label:"ABAC Policies",path:"/system-admin/abac"},{label:"Mapping Studio",path:"/system-admin/mapping-studio"},{label:"NLP Analytics",path:"/system-admin/nlp-analytics"},{label:"Regulatory Reports",path:"/system-admin/regulatory-reports"},{label:"Clinical Intelligence",path:"/system-admin/clinical-intelligence"},{label:"System Admin Dashboard",path:"/system-admin"},{label:"Super Admin Dashboard",path:"/super-admin"}],SECURITY_ADMIN:[{label:"Security Admin",path:"/security-admin"},{label:"My Requests",path:"/workforce/requests"}],SECURITY_OFFICER:[{label:"Security Officer",path:"/security-officer"},{label:"My Requests",path:"/workforce/requests"}],RADIOLOGIST:[{label:"My Requests",path:"/workforce/requests"}],THERAPIST:[{label:"My Requests",path:"/workforce/requests"}],RECEPTIONIST:[{label:"My Requests",path:"/workforce/requests"}],PATIENT:[{label:"Patient Dashboard",path:"/patient"},{label:"My Appointments",path:"/patient/appointments"},{label:"Medical Records",path:"/patient/medical-records"},{label:"Prescriptions",path:"/patient/prescriptions"},{label:"Lab Results",path:"/patient/lab-results"},{label:"Billing",path:"/patient/billing"},{label:"Insurance",path:"/patient/insurance"},{label:"Feedback",path:"/patient/feedback"}],GUEST:[{label:"Guest Home",path:"/guest"}]};function D_(e){const t=Ge((e==null?void 0:e.role)||""),r=[...L_[t]||[],...P_],i=new Set;return r.filter(a=>i.has(a.path)?!1:(i.add(a.path),!0))}const Dj=g.createContext(null),nd=["system","light","dark"];function M_(){return typeof window>"u"?"light":window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function Eg(e){const t=e==="system"?M_():e;document.documentElement.setAttribute("data-theme",t),document.documentElement.setAttribute("data-theme-mode",e)}function U_({children:e}){const[t,n]=g.useState(()=>localStorage.getItem("theme")||"system");g.useEffect(()=>{if(Eg(t),localStorage.setItem("theme",t),t!=="system")return;const i=window.matchMedia("(prefers-color-scheme: dark)"),a=()=>Eg("system");return i.addEventListener?(i.addEventListener("change",a),()=>i.removeEventListener("change",a)):(i.addListener(a),()=>i.removeListener(a))},[t]);const r=g.useMemo(()=>({theme:t,setTheme:n,cycleTheme:()=>{const i=nd.indexOf(t),a=nd[(i+1)%nd.length];n(a)}}),[t]);return s.jsx(Dj.Provider,{value:r,children:e})}function Mj(){const e=g.useContext(Dj);if(!e)throw new Error("useTheme must be used inside ThemeProvider");return e}const rd="http://localhost:5000";async function Tr(e,t={}){const r={...{credentials:"include",headers:{"Content-Type":"application/json"}},...t},i=localStorage.getItem("token"),a=localStorage.getItem("refreshToken"),o=e.includes("/api/auth/login")||e.includes("/api/auth/register")||e.includes("/api/auth/google");if(r.body&&typeof r.body=="object"&&!(r.body instanceof FormData)&&(r.body=JSON.stringify(r.body)),i&&!o){const c=localStorage.getItem("role_override"),u=localStorage.getItem("strict_impersonation")==="1";r.headers={...r.headers,Authorization:`Bearer ${i}`,...c?{"X-Afya-View-Role":c}:{},...c&&u?{"X-Afya-Strict-Impersonation":"1"}:{}}}let l=await fetch(rd+e,r);if(l.status===401&&a){const c=await fetch(rd+"/api/auth/refresh",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:a})});if(c.ok){const u=await c.json();u!=null&&u.accessToken&&(localStorage.setItem("token",u.accessToken),r.headers={...r.headers,Authorization:`Bearer ${u.accessToken}`}),u!=null&&u.refreshToken&&localStorage.setItem("refreshToken",u.refreshToken),l=await fetch(rd+e,r)}}return l}const ue={get:async e=>({data:await(await Tr(e)).json()}),post:async(e,t)=>({data:await(await Tr(e,{method:"POST",body:t})).json()}),put:async(e,t)=>({data:await(await Tr(e,{method:"PUT",body:t})).json()}),delete:async e=>({data:await(await Tr(e,{method:"DELETE"})).json()})},Hs=async(e,t={})=>(await ue.post("/api/actions/trigger",{action:e,meta:t})).data,Uj=g.createContext(null);function B_(e){if(!e)return;let t=document.querySelector("link[rel='icon']");t||(t=document.createElement("link"),t.rel="icon",document.head.appendChild(t)),t.href=e}function V_({children:e}){const[t,n]=g.useState(null),r="http://localhost:5000";g.useEffect(()=>{fetch(`${r}/api/system-settings`).then(a=>a.json()).then(a=>{n(a)}).catch(()=>n({}))},[]),g.useEffect(()=>{if(!t)return;const a=t.branding||{};a.favicon&&B_(a.favicon);const o=document.documentElement;a.logo&&o.style.setProperty("--brand-logo",`url(${a.logo})`),a.appIcon&&o.style.setProperty("--brand-icon",`url(${a.appIcon})`),a.loginBackground&&o.style.setProperty("--login-bg",`url(${a.loginBackground})`),a.homeBackground&&o.style.setProperty("--home-bg",`url(${a.homeBackground})`)},[t]);const i=g.useMemo(()=>({settings:t,setSettings:n}),[t]);return s.jsx(Uj.Provider,{value:i,children:e})}function mi(){const e=g.useContext(Uj);if(!e)throw new Error("useSystemSettings must be used inside SystemSettingsProvider");return e}const Fo=async()=>(await ue.get("/api/developer/overview")).data,Oh=async()=>(await ue.get("/api/developer/trust-status")).data,mp=async()=>(await ue.post("/api/developer/workflow-sla/run")).data,$_=async()=>(await ue.get("/api/developer/decision-cockpit")).data,F_=async({query:e}={})=>(await ue.get(`/api/notifications/list${e?`?${e}`:""}`)).data,Bj=async e=>(await ue.put(`/api/notifications/${e}/read`)).data,Vj=async e=>(await ue.put(`/api/notifications/${e}/unread`)).data,$j=async()=>(await ue.put("/api/notifications/read-all")).data,H_=async({category:e,read:t}={})=>{const n=new URLSearchParams;e&&e!=="ALL"&&n.set("category",e),(t==="true"||t==="false")&&n.set("read",t);const r=n.toString();return(await ue.get(`/api/notifications/list${r?`?${r}`:""}`)).data};function Er({name:e}){const t={menu:"",home:s.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",children:s.jsx("path",{d:"M4 11.5 12 5l8 6.5v7a1 1 0 0 1-1 1h-5v-5H10v5H5a1 1 0 0 1-1-1z",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinejoin:"round"})}),bell:s.jsxs("svg",{viewBox:"0 0 24 24","aria-hidden":"true",children:[s.jsx("path",{d:"M18 16H6l1.5-2V10a4.5 4.5 0 0 1 9 0v4z",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinejoin:"round"}),s.jsx("path",{d:"M10 18a2 2 0 0 0 4 0",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round"})]}),chat:s.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",children:s.jsx("path",{d:"M6 6h12a2 2 0 0 1 2 2v6a2 2 0 0 1-2 2H9l-4 3v-3H6a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2z",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinejoin:"round"})}),help:s.jsxs("svg",{viewBox:"0 0 24 24","aria-hidden":"true",children:[s.jsx("path",{d:"M9 9a3 3 0 1 1 3 3v2",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("circle",{cx:"12",cy:"17",r:"1",fill:"currentColor"}),s.jsx("circle",{cx:"12",cy:"12",r:"9",fill:"none",stroke:"currentColor",strokeWidth:"1.8"})]}),settings:s.jsxs("svg",{viewBox:"0 0 24 24","aria-hidden":"true",children:[s.jsx("path",{d:"M12 8.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 0 1 0-7z",fill:"none",stroke:"currentColor",strokeWidth:"1.8"}),s.jsx("path",{d:"M19 12a7 7 0 0 0-.1-1.2l2-1.5-2-3.5-2.4.8a7.4 7.4 0 0 0-2-1.2l-.4-2.5H10l-.4 2.5a7.4 7.4 0 0 0-2 1.2l-2.4-.8-2 3.5 2 1.5A7 7 0 0 0 5 12c0 .4 0 .8.1 1.2l-2 1.5 2 3.5 2.4-.8a7.4 7.4 0 0 0 2 1.2l.4 2.5h4l.4-2.5a7.4 7.4 0 0 0 2-1.2l2.4.8 2-3.5-2-1.5c.1-.4.1-.8.1-1.2z",fill:"none",stroke:"currentColor",strokeWidth:"1.3",strokeLinejoin:"round"})]}),sun:s.jsxs("svg",{viewBox:"0 0 24 24","aria-hidden":"true",children:[s.jsx("circle",{cx:"12",cy:"12",r:"4",fill:"none",stroke:"currentColor",strokeWidth:"1.8"}),s.jsx("path",{d:"M12 2v3M12 19v3M4.2 4.2l2.1 2.1M17.7 17.7l2.1 2.1M2 12h3M19 12h3M4.2 19.8l2.1-2.1M17.7 6.3l2.1-2.1",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round",fill:"none"})]}),calendar:s.jsxs("svg",{viewBox:"0 0 24 24","aria-hidden":"true",children:[s.jsx("rect",{x:"4",y:"5",width:"16",height:"15",rx:"2",fill:"none",stroke:"currentColor",strokeWidth:"1.8"}),s.jsx("path",{d:"M8 3v4M16 3v4M4 9h16",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round"})]}),emergency:s.jsxs("svg",{viewBox:"0 0 24 24","aria-hidden":"true",children:[s.jsx("path",{d:"M12 4 3 20h18L12 4z",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinejoin:"round"}),s.jsx("path",{d:"M12 10v4M12 17h.01",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round"})]})};return s.jsx("span",{className:"icon",children:t[e]||null})}function q_({onToggleSidebar:e}){var F,Z;const{user:t,logout:n,roleOverride:r,strictImpersonation:i}=Me(),a=Re(),o=hn(),{theme:l,cycleTheme:c}=Mj(),{settings:u}=mi(),[d,p]=g.useState(!1),[h,f]=g.useState(!1),[v,j]=g.useState([]),[_,m]=g.useState("ALL"),[y,b]=g.useState("ALL"),[N,A]=g.useState(""),[E,R]=g.useState(()=>{try{const Y=localStorage.getItem("workflow_sla_last_scan");return Y?JSON.parse(Y):null}catch{return null}}),[I,T]=g.useState(!1),L=15e3,B=(F=u==null?void 0:u.branding)==null?void 0:F.logo,W=g.useRef(null),z=(t==null?void 0:t.role)==="GUEST",P=(t==null?void 0:t.role)==="DOCTOR",V=t?ws(t):"/",K=g.useMemo(()=>D_(t),[t]),ce=g.useMemo(()=>{const Y=N.trim().toLowerCase();return Y?K.filter(ye=>ye.label.toLowerCase().includes(Y)).slice(0,8):[]},[N,K]),M=g.useMemo(()=>v.filter(Y=>!Y.read).length,[v]),X=!!r&&!!(t!=null&&t.actualRole)&&t.actualRole!==t.role,ae=["SUPER_ADMIN","SYSTEM_ADMIN","DEVELOPER"].includes(t==null?void 0:t.role),pe=g.useCallback(async()=>{var Y,ye,ge,Ke;if(ae)try{const Ae=await Fo(),Fe={pending:((ye=(Y=Ae==null?void 0:Ae.queues)==null?void 0:Y.workforce)==null?void 0:ye.totalPending)??0,breached:((Ke=(ge=Ae==null?void 0:Ae.queues)==null?void 0:ge.workforce)==null?void 0:Ke.breached)??0,updatedAt:new Date().toISOString(),lastScanAt:(E==null?void 0:E.lastScanAt)||null,escalationsL1:(E==null?void 0:E.escalationsL1)||0,escalationsL2:(E==null?void 0:E.escalationsL2)||0};R(Fe),localStorage.setItem("workflow_sla_last_scan",JSON.stringify(Fe))}catch{}},[ae,E==null?void 0:E.escalationsL1,E==null?void 0:E.escalationsL2,E==null?void 0:E.lastScanAt]),fe=g.useCallback(()=>{const Y=new URLSearchParams;_!=="ALL"&&Y.set("category",_),y==="READ"&&Y.set("read","true"),y==="UNREAD"&&Y.set("read","false");const ye=Y.toString();F_({query:ye}).then(ge=>{Array.isArray(ge)?j(ge):Array.isArray(ge==null?void 0:ge.items)?j(ge.items):j([])}).catch(()=>j([]))},[_,y]);g.useEffect(()=>{h&&fe()},[h,fe]),g.useEffect(()=>{fe();const Y=setInterval(fe,L);return()=>clearInterval(Y)},[fe]),g.useEffect(()=>{if(pe(),!ae)return;const Y=setInterval(pe,3e4);return()=>clearInterval(Y)},[ae,pe]);const Le=g.useCallback(async()=>{var Y,ye,ge,Ke;T(!0);try{const Ae=await mp(),Fe={pending:(E==null?void 0:E.pending)??0,breached:(E==null?void 0:E.breached)??0,updatedAt:new Date().toISOString(),lastScanAt:(Ae==null?void 0:Ae.ranAt)||new Date().toISOString(),escalationsL1:((ye=(Y=Ae==null?void 0:Ae.result)==null?void 0:Y.workforce)==null?void 0:ye.escalationsL1)??0,escalationsL2:((Ke=(ge=Ae==null?void 0:Ae.result)==null?void 0:ge.workforce)==null?void 0:Ke.escalationsL2)??0};R(Fe),localStorage.setItem("workflow_sla_last_scan",JSON.stringify(Fe)),await pe()}finally{T(!1)}},[pe,E==null?void 0:E.breached,E==null?void 0:E.pending]);return g.useEffect(()=>{p(!1),f(!1),A("")},[o.pathname]),g.useEffect(()=>{const Y=ye=>{d&&W.current&&!W.current.contains(ye.target)&&p(!1)};return document.addEventListener("mousedown",Y),()=>document.removeEventListener("mousedown",Y)},[d]),s.jsxs("header",{className:"navbar",children:[s.jsxs("div",{className:"navbar-left",children:[s.jsx("button",{className:"icon-btn",onClick:e,"aria-label":"Open navigator",title:"Navigator",children:s.jsx(Er,{name:"menu"})}),s.jsx("button",{className:"brand-btn",onClick:()=>a(z?"/guest":V),children:B?s.jsx("span",{className:"brand-logo",style:{backgroundImage:`url(${B})`}}):"AfyaLink HCM"}),s.jsxs("button",{className:"icon-btn ghost",onClick:()=>a(V),"aria-label":"Home",title:"Home",children:[s.jsx(Er,{name:"home"}),"Home"]})]}),s.jsx("div",{className:"navbar-center",children:s.jsxs("div",{className:"search-wrap",children:[s.jsx("input",{className:"search-input",placeholder:"Search people, tasks, reports, help",value:N,onChange:Y=>A(Y.target.value)}),s.jsx("button",{className:"search-btn",onClick:()=>A(""),"aria-label":"Clear search",title:"Clear",children:"Clear"}),ce.length>0&&s.jsx("div",{className:"search-results",children:ce.map(Y=>s.jsxs("button",{className:"search-result",onClick:()=>{a(Y.path),A("")},children:[s.jsx("span",{className:"result-title",children:Y.label}),s.jsx("span",{className:"result-path",children:Y.path})]},Y.path))})]})}),s.jsxs("div",{className:"navbar-right",children:[X&&s.jsxs("div",{className:"override-mode-wrap",children:[s.jsxs("span",{className:"override-mode-badge",title:`Actual role: ${t.actualRole}`,children:["Override Mode: ",i?"Strict":"Full Access","  Viewing as: ",t.role]}),s.jsx("button",{className:"override-help",type:"button","aria-label":"Override mode help",title:"Override mode help","data-tip":i?"Strict impersonation active: actions are limited to the selected role permissions.":"Override active: all actions execute with founder/developer full permissions.",children:"?"})]}),ae&&s.jsxs("div",{className:"sla-status-wrap",children:[s.jsxs("span",{className:`sla-status-chip ${((E==null?void 0:E.breached)||0)>0?"risk":"ok"}`,title:`Pending: ${(E==null?void 0:E.pending)??0}, Breached: ${(E==null?void 0:E.breached)??0}`,children:["SLA ",E!=null&&E.breached?`Breached ${E.breached}`:"Healthy"]}),s.jsx("button",{className:"icon-btn ghost",disabled:I,onClick:Le,title:E!=null&&E.lastScanAt?`Last scan: ${new Date(E.lastScanAt).toLocaleString()}`:"Run Workflow SLA Scan",children:I?"Scanning...":"Scan SLA"})]}),s.jsxs("div",{className:"profile-wrap",children:[s.jsxs("button",{className:"icon-btn ghost",title:"Notifications",onClick:async()=>{await Hs("OPEN_NOTIFICATIONS"),f(Y=>!Y)},children:[s.jsx(Er,{name:"bell"}),"Alerts",M>0&&s.jsx("span",{className:"notif-badge",children:M>99?"99+":M})]}),h&&s.jsxs("div",{className:"notif-menu",children:[s.jsxs("div",{className:"notif-head",children:[s.jsx("span",{children:"Notifications"}),s.jsx("button",{className:"notif-close",onClick:()=>f(!1),"aria-label":"Close notifications",children:""})]}),ae&&s.jsxs("div",{className:"sla-mini",children:[s.jsxs("div",{className:"sla-mini-row",children:[s.jsx("strong",{children:"SLA Control"}),s.jsx("span",{className:E!=null&&E.breached?"text-danger":"",children:E!=null&&E.breached?`${E.breached} breached`:"No breaches"})]}),s.jsxs("div",{className:"sla-mini-meta",children:["Last scan:"," ",E!=null&&E.lastScanAt?new Date(E.lastScanAt).toLocaleString():"Never"]}),s.jsxs("div",{className:"sla-mini-actions",children:[s.jsx("button",{className:"btn-secondary",onClick:()=>{f(!1),a("/hospital-admin/approvals?view=breached#pending")},children:"Open Breaches"}),s.jsx("button",{className:"btn-secondary",onClick:()=>{f(!1),a("/hospital-admin/approvals#sla")},children:"SLA Policies"}),s.jsx("button",{className:"btn-secondary",disabled:I,onClick:Le,children:I?"Scanning...":"Scan Now"})]})]}),s.jsxs("div",{className:"notif-filters",children:[s.jsxs("select",{value:_,onChange:Y=>m(Y.target.value),children:[s.jsx("option",{value:"ALL",children:"All Categories"}),s.jsx("option",{value:"WORKFORCE",children:"Workforce"}),s.jsx("option",{value:"SECURITY",children:"Security"}),s.jsx("option",{value:"BILLING",children:"Billing"}),s.jsx("option",{value:"SYSTEM",children:"System"}),s.jsx("option",{value:"INTEGRATION",children:"Integration"}),s.jsx("option",{value:"AI",children:"AI"})]}),s.jsxs("select",{value:y,onChange:Y=>b(Y.target.value),children:[s.jsx("option",{value:"ALL",children:"All Status"}),s.jsx("option",{value:"UNREAD",children:"Unread"}),s.jsx("option",{value:"READ",children:"Read"})]}),s.jsx("button",{className:"btn-secondary",onClick:async()=>{await $j(),j(Y=>Y.map(ye=>({...ye,read:!0})))},children:"Mark all read"})]}),s.jsxs("div",{className:"notif-list",children:[v.slice(0,6).map(Y=>s.jsxs("div",{className:"notif-item",children:[s.jsxs("div",{className:"notif-title",children:[Y.title||"Notification",!Y.read&&s.jsx("span",{className:"badge-dot",children:"!"})]}),s.jsx("div",{className:"notif-body",children:Y.body||"-"}),s.jsx("div",{className:"notif-actions",children:s.jsx("button",{className:"btn-secondary",onClick:async()=>{Y.read?(await Vj(Y._id),j(ye=>ye.map(ge=>ge._id===Y._id?{...ge,read:!1}:ge))):(await Bj(Y._id),j(ye=>ye.map(ge=>ge._id===Y._id?{...ge,read:!0}:ge)))},children:Y.read?"Mark unread":"Mark read"})})]},Y._id)),v.length===0&&s.jsx("div",{className:"muted",children:"No notifications"})]}),s.jsx("button",{className:"notif-link",onClick:()=>{f(!1),a("/admin/notifications")},children:"View All Notifications"})]})]}),P&&s.jsxs("button",{className:"icon-btn ghost",title:"Quick Calendar",onClick:()=>a("/doctor/schedule"),children:[s.jsx(Er,{name:"calendar"}),"Calendar"]}),P&&s.jsxs("button",{className:"icon-btn danger-soft",title:"Emergency Alert",onClick:async()=>{await Hs("EMERGENCY_ALERT"),a("/doctor/ward")},children:[s.jsx(Er,{name:"emergency"}),"Emergency"]}),s.jsxs("button",{className:"icon-btn ghost",title:"Messages",onClick:async()=>{await Hs("OPEN_MESSAGES"),a("/ai/chatbot")},children:[s.jsx(Er,{name:"chat"}),"Messages"]}),s.jsxs("button",{className:"icon-btn ghost",title:"Help",onClick:async()=>{await Hs("OPEN_HELP"),a("/reports")},children:[s.jsx(Er,{name:"help"}),"Help"]}),s.jsxs("button",{className:"icon-btn ghost",title:"Theme",onClick:async()=>{await Hs("TOGGLE_THEME"),c()},children:[s.jsx(Er,{name:"sun"}),l==="system"?"System":l==="dark"?"Dark":"Light"]}),s.jsxs("button",{className:"icon-btn ghost",title:"Settings",onClick:async()=>{await Hs("OPEN_SETTINGS"),a("/profile")},children:[s.jsx(Er,{name:"settings"}),"Settings"]}),s.jsxs("div",{className:"profile-wrap",ref:W,children:[s.jsxs("button",{className:"profile-btn",onClick:()=>p(Y=>!Y),children:[s.jsx("span",{className:"avatar",children:((Z=t==null?void 0:t.name)==null?void 0:Z[0])||"U"}),s.jsxs("span",{className:"profile-meta",children:[s.jsx("span",{className:"profile-name",children:(t==null?void 0:t.name)||"User"}),s.jsx("span",{className:"profile-role",children:(t==null?void 0:t.role)||"User"})]})]}),d&&s.jsxs("div",{className:"profile-menu",children:[s.jsxs("div",{className:"profile-menu-head",children:[s.jsx("span",{children:"Profile"}),s.jsx("button",{className:"notif-close",onClick:()=>p(!1),"aria-label":"Close profile menu",children:""})]}),s.jsx("button",{onClick:()=>a("/profile"),children:"My Profile"}),s.jsx("button",{onClick:()=>a("/profile"),children:"Preferences"}),s.jsx("button",{onClick:()=>a("/reports"),children:"About AfyaLink"}),z?s.jsx("button",{onClick:()=>a("/register"),children:"Upgrade"}):s.jsx("button",{className:"danger",onClick:n,children:"Sign Out"})]})]})]})]})}const sd={appointments:{read:["SUPER_ADMIN","DEVELOPER","HOSPITAL_ADMIN","DOCTOR","NURSE"],create:["DOCTOR","HOSPITAL_ADMIN"],update:["DOCTOR","HOSPITAL_ADMIN"],delete:["HOSPITAL_ADMIN"]},pharmacy:{read:["PHARMACIST","HOSPITAL_ADMIN"],dispense:["PHARMACIST"],manage:["HOSPITAL_ADMIN"]},inventory:{read:["PHARMACIST","HOSPITAL_ADMIN","SUPER_ADMIN","DEVELOPER","SYSTEM_ADMIN"],update:["PHARMACIST","HOSPITAL_ADMIN"]},billing:{read:["HOSPITAL_ADMIN","ACCOUNTANT"],create:["ACCOUNTANT"]},reports:{read:["SUPER_ADMIN","DEVELOPER","HOSPITAL_ADMIN"]},audit:{read:["SUPER_ADMIN","DEVELOPER","HOSPITAL_ADMIN"]}},z_=()=>{const{user:e}=Me();return{can:(n,r)=>{var c,u;if(!e)return!1;const i=Ge(e.role),a=Ge(e.actualRole);return!(typeof window<"u"&&((c=window.localStorage)==null?void 0:c.getItem("strict_impersonation"))==="1")&&["SUPER_ADMIN","DEVELOPER"].includes(a)?!0:(((u=sd==null?void 0:sd[n])==null?void 0:u[r])||[]).includes(i)}}},W_=async()=>(await ue.get("/api/menu")).data;function An({name:e}){var i,a;const{settings:t}=mi(),n={home:"",admin:"",hr:"",payroll:"",doctor:"",nurse:"",lab:"",pharmacy:"",staff:"",security:"",settings:"",analytics:"",reports:"",notifications:"",requests:"",inventory:"",ai:"",appointments:""},r=(a=(i=t==null?void 0:t.branding)==null?void 0:i.sidebarIcons)==null?void 0:a[e];return s.jsx("span",{className:"nav-icon","aria-hidden":"true",children:r?s.jsx("img",{className:"nav-icon-img",src:r,alt:""}):n[e]||""})}function G_({open:e=!0,onClose:t}){var j,_;const{user:n,logout:r}=Me(),{can:i}=z_(),{theme:a,setTheme:o}=Mj(),{settings:l}=mi(),c=Re(),[u,d]=g.useState([]),[p,h]=g.useState(!1);if(g.useEffect(()=>{!n||!localStorage.getItem("token")||W_().then(y=>{d(y.menu||[]),h(!0)}).catch(()=>{d([]),h(!0)})},[n]),!n)return null;ws(n);const f=Ge(n.role),v=!["SUPER_ADMIN","SYSTEM_ADMIN","GUEST","PATIENT"].includes(f);return n.role==="GUEST"?s.jsxs("aside",{className:`sidebar ${e?"":"collapsed"}`,onWheel:m=>m.stopPropagation(),children:[s.jsxs("div",{className:"sidebar-header sticky",children:[s.jsx("div",{className:"brand-mark",children:(j=l==null?void 0:l.branding)!=null&&j.logo?s.jsx("span",{className:"brand-logo",style:{backgroundImage:`url(${l.branding.logo})`}}):"AfyaLink"}),s.jsx("div",{className:"brand-sub",children:"Demo Workspace"})]}),s.jsx("div",{className:"sidebar-scroll",children:s.jsx("nav",{children:s.jsxs("ul",{children:[s.jsx("li",{children:s.jsxs("button",{className:"nav-btn",onClick:()=>{c("/guest"),t==null||t()},children:[s.jsx(An,{name:"home"}),"Demo Home"]})}),s.jsxs(Lt,{title:"Demo",children:[i("ai","chat")&&s.jsx(Q,{to:"/ai/chatbot",icon:"ai",onSelect:t,children:"AI Chatbot"}),i("ai","medical")&&s.jsx(Q,{to:"/ai/medical",icon:"ai",onSelect:t,children:"AI Assistant"})]})]})})}),s.jsxs("div",{className:"sidebar-footer sticky-footer",children:[s.jsxs("div",{className:"footer-actions",children:[s.jsxs("button",{className:"nav-btn",onClick:()=>{c("/reports"),t==null||t()},children:[s.jsx(An,{name:"reports"}),"Help"]}),s.jsxs("button",{className:"nav-btn",onClick:()=>{c("/profile"),t==null||t()},children:[s.jsx(An,{name:"settings"}),"Settings"]}),s.jsxs("button",{className:"nav-btn",onClick:()=>{r(),t==null||t()},children:[s.jsx(An,{name:"security"}),"Sign Out"]})]}),s.jsx("div",{children:"AfyaLink  Demo Mode"})]})]}):s.jsxs("aside",{className:`sidebar ${e?"":"collapsed"}`,onWheel:m=>m.stopPropagation(),children:[s.jsxs("div",{className:"sidebar-header sticky",children:[s.jsx("div",{className:"brand-mark",children:(_=l==null?void 0:l.branding)!=null&&_.logo?s.jsx("span",{className:"brand-logo",style:{backgroundImage:`url(${l.branding.logo})`}}):"AfyaLink"}),s.jsxs("div",{className:"brand-sub",children:[n.role," Workspace"]})]}),s.jsx("div",{className:"sidebar-scroll",children:s.jsx("nav",{children:s.jsxs("ul",{children:[p&&u.length>0&&u.map(m=>s.jsx(Lt,{title:m.section,children:m.items.map((y,b)=>y.path?s.jsx(Q,{to:y.path,icon:y.icon||"admin",onSelect:t,children:y.label},y.path||`${m.section}-${b}`):s.jsx("li",{className:"nav-static",children:s.jsxs("span",{className:"nav-btn",children:[s.jsx(An,{name:y.icon||"admin"}),y.label]})},`${m.section}-${b}`))},m.section)),p&&u.length===0&&s.jsxs(s.Fragment,{children:[["SUPER_ADMIN","DEVELOPER"].includes(f)&&s.jsxs(Lt,{title:"All Dashboards",children:[s.jsx(Q,{to:"/super-admin",icon:"admin",onSelect:t,children:"Super Admin"}),s.jsx(Q,{to:"/system-admin",icon:"admin",onSelect:t,children:"System Admin"}),s.jsx(Q,{to:"/hospital-admin",icon:"admin",onSelect:t,children:"Hospital Admin"}),s.jsx(Q,{to:"/hr-manager",icon:"hr",onSelect:t,children:"HR Manager"}),s.jsx(Q,{to:"/payroll-officer",icon:"payroll",onSelect:t,children:"Payroll Officer"}),s.jsx(Q,{to:"/doctor",icon:"doctor",onSelect:t,children:"Doctor"}),s.jsx(Q,{to:"/nurse",icon:"nurse",onSelect:t,children:"Nurse"}),s.jsx(Q,{to:"/lab-tech",icon:"lab",onSelect:t,children:"Lab Tech"}),s.jsx(Q,{to:"/pharmacy",icon:"pharmacy",onSelect:t,children:"Pharmacist"}),s.jsx(Q,{to:"/staff",icon:"staff",onSelect:t,children:"Staff (Radiology/Therapy/Reception)"}),s.jsx(Q,{to:"/security-admin",icon:"security",onSelect:t,children:"Security Admin"}),s.jsx(Q,{to:"/security-officer",icon:"security",onSelect:t,children:"Security Officer"}),s.jsx(Q,{to:"/developer",icon:"settings",onSelect:t,children:"Developer Console"}),s.jsx(Q,{to:"/developer/queue-replay",icon:"settings",onSelect:t,children:"Queue Replay"}),s.jsx(Q,{to:"/developer/webhook-retry",icon:"settings",onSelect:t,children:"Webhook Retry"}),s.jsx(Q,{to:"/developer/decision-cockpit",icon:"analytics",onSelect:t,children:"Decision Cockpit"}),s.jsx(Q,{to:"/developer/provenance-verify",icon:"security",onSelect:t,children:"Provenance Verify"}),s.jsx(Q,{to:"/developer/ai-extraction-history",icon:"ai",onSelect:t,children:"AI Extraction History"})]}),s.jsxs(Lt,{title:"Home",children:[s.jsx(Q,{to:"/analytics",icon:"analytics",onSelect:t,children:"Insights"}),s.jsx(Q,{to:"/reports",icon:"reports",onSelect:t,children:"Reports"}),f==="SYSTEM_ADMIN"&&s.jsx(Q,{to:"/system-admin",icon:"admin",onSelect:t,children:"System Admin"}),["SYSTEM_ADMIN","SUPER_ADMIN","DEVELOPER"].includes(Ge(n.role))&&s.jsx(Q,{to:"/system-admin/abac",icon:"security",onSelect:t,children:"ABAC Policies"}),["SYSTEM_ADMIN","SUPER_ADMIN","DEVELOPER"].includes(Ge(n.role))&&s.jsx(Q,{to:"/system-admin/mapping-studio",icon:"settings",onSelect:t,children:"Mapping Studio"}),["SYSTEM_ADMIN","SUPER_ADMIN","DEVELOPER","HOSPITAL_ADMIN","HR_MANAGER","PAYROLL_OFFICER"].includes(Ge(n.role))&&s.jsx(Q,{to:"/system-admin/nlp-analytics",icon:"analytics",onSelect:t,children:"NLP Analytics"}),["SYSTEM_ADMIN","SUPER_ADMIN","DEVELOPER","HOSPITAL_ADMIN","HR_MANAGER","DOCTOR","NURSE"].includes(Ge(n.role))&&s.jsx(Q,{to:"/system-admin/clinical-intelligence",icon:"ai",onSelect:t,children:"Clinical Intelligence"}),["SYSTEM_ADMIN","SUPER_ADMIN","DEVELOPER","HOSPITAL_ADMIN"].includes(Ge(n.role))&&s.jsx(Q,{to:"/system-admin/regulatory-reports",icon:"reports",onSelect:t,children:"Regulatory Reports"}),f==="DEVELOPER"&&s.jsx(Q,{to:"/developer",icon:"settings",onSelect:t,children:"Developer Console"}),["SUPER_ADMIN","SYSTEM_ADMIN"].includes(Ge(n.role))&&s.jsx(Q,{to:"/super-admin/hospitals",icon:"admin",onSelect:t,children:"Manage Hospitals"})]}),s.jsxs(Lt,{title:"Human Resources",children:[s.jsx(Q,{to:"/hospital-admin",icon:"admin",onSelect:t,children:"Hospital Admin"}),s.jsx(Q,{to:"/hospital-admin/register-staff",icon:"staff",onSelect:t,children:"Register Staff"}),s.jsx(Q,{to:"/hospital-admin/approvals",icon:"notifications",onSelect:t,children:"Approvals"}),s.jsx(Q,{to:"/hospital-admin/staff",icon:"staff",onSelect:t,children:"Staff Management"}),v&&s.jsx(Q,{to:"/workforce/requests",icon:"requests",onSelect:t,children:"My Requests"}),s.jsx(Q,{to:"/staff",icon:"staff",onSelect:t,children:"Staff Workspace"}),s.jsx(Q,{to:"/hr-manager",icon:"hr",onSelect:t,children:"HR Manager"}),i("inventory","read")&&s.jsx(Q,{to:"/inventory",icon:"inventory",onSelect:t,children:"Inventory"}),i("pharmacy","read")&&s.jsx(Q,{to:"/pharmacy",icon:"pharmacy",onSelect:t,children:"Pharmacy"})]}),s.jsxs(Lt,{title:"Talent",children:[s.jsx(Q,{to:"/admin/create-admin",icon:"admin",onSelect:t,children:"Admin Access"}),s.jsx(Q,{to:"/admin/audit-logs",icon:"admin",onSelect:t,children:"Audit Logs"}),s.jsx(Q,{to:"/admin/notifications",icon:"notifications",onSelect:t,children:"Notifications"})]}),s.jsxs(Lt,{title:"Workforce",children:[s.jsx(Q,{to:"/doctor",icon:"doctor",onSelect:t,children:"Clinician Dashboard"}),s.jsx(Q,{to:"/nurse",icon:"nurse",onSelect:t,children:"Nursing Dashboard"}),s.jsx(Q,{to:"/lab-tech",icon:"lab",onSelect:t,children:"Lab Dashboard"}),s.jsx(Q,{to:"/labtech/labs",icon:"lab",onSelect:t,children:"Lab Tests"}),s.jsx(Q,{to:"/doctor/appointments",icon:"appointments",onSelect:t,children:"Appointments"})]}),f==="DOCTOR"&&s.jsxs(Lt,{title:"Doctor Workspace",children:[s.jsx(Q,{to:"/doctor/schedule",icon:"appointments",onSelect:t,children:"My Schedule"}),s.jsx(Q,{to:"/doctor/patients",icon:"doctor",onSelect:t,children:"My Patients"}),s.jsx(Q,{to:"/doctor/opd",icon:"doctor",onSelect:t,children:"OPD Clinic"}),s.jsx(Q,{to:"/doctor/ward",icon:"staff",onSelect:t,children:"Inpatient Ward"}),s.jsx(Q,{to:"/doctor/surgery",icon:"reports",onSelect:t,children:"Surgery / Procedures"}),s.jsx(Q,{to:"/doctor/lab-results",icon:"lab",onSelect:t,children:"Lab Results"}),s.jsx(Q,{to:"/doctor/prescriptions",icon:"pharmacy",onSelect:t,children:"Prescriptions"}),s.jsx(Q,{to:"/doctor/medical-records",icon:"reports",onSelect:t,children:"Medical Records"}),s.jsx(Q,{to:"/doctor/referrals",icon:"reports",onSelect:t,children:"Referrals"}),s.jsx(Q,{to:"/doctor/performance",icon:"analytics",onSelect:t,children:"Performance"}),s.jsx(Q,{to:"/doctor/cme",icon:"doctor",onSelect:t,children:"CME & Certifications"}),s.jsx(Q,{to:"/doctor/leave",icon:"requests",onSelect:t,children:"Leave Requests"}),s.jsx(Q,{to:"/doctor/reports-notes",icon:"reports",onSelect:t,children:"Reports & Notes"}),s.jsx(Q,{to:"/doctor/settings",icon:"settings",onSelect:t,children:"Settings"})]}),f==="NURSE"&&s.jsxs(Lt,{title:"Nurse Workspace",children:[s.jsx(Q,{to:"/nurse/shift",icon:"nurse",onSelect:t,children:"My Shift"}),s.jsx(Q,{to:"/nurse/patients",icon:"staff",onSelect:t,children:"Assigned Patients"}),s.jsx(Q,{to:"/nurse/medication",icon:"nurse",onSelect:t,children:"Medication Administration"}),s.jsx(Q,{to:"/nurse/incidents",icon:"notifications",onSelect:t,children:"Incident Reports"}),s.jsx(Q,{to:"/nurse/vitals",icon:"reports",onSelect:t,children:"Vitals Entry"}),s.jsx(Q,{to:"/nurse/leave",icon:"requests",onSelect:t,children:"Leave Requests"}),s.jsx(Q,{to:"/nurse/performance",icon:"analytics",onSelect:t,children:"Performance"})]}),f==="LAB_TECH"&&s.jsxs(Lt,{title:"Lab Workspace",children:[s.jsx(Q,{to:"/lab-tech/test-queue",icon:"lab",onSelect:t,children:"Test Queue"}),s.jsx(Q,{to:"/lab-tech/equipment",icon:"lab",onSelect:t,children:"Equipment Logs"}),s.jsx(Q,{to:"/lab-tech/samples",icon:"lab",onSelect:t,children:"Sample Tracking"}),s.jsx(Q,{to:"/lab-tech/qc",icon:"analytics",onSelect:t,children:"Quality Control"}),s.jsx(Q,{to:"/lab-tech/safety",icon:"security",onSelect:t,children:"Safety Checklist"}),s.jsx(Q,{to:"/lab-tech/archive",icon:"reports",onSelect:t,children:"Reports Archive"})]}),f==="PHARMACIST"&&s.jsxs(Lt,{title:"Pharmacy Workspace",children:[s.jsx(Q,{to:"/pharmacy/queue",icon:"pharmacy",onSelect:t,children:"Prescription Queue"}),s.jsx(Q,{to:"/pharmacy/inventory",icon:"inventory",onSelect:t,children:"Inventory"}),s.jsx(Q,{to:"/pharmacy/controlled",icon:"security",onSelect:t,children:"Controlled Drugs"}),s.jsx(Q,{to:"/pharmacy/expiry",icon:"notifications",onSelect:t,children:"Expiry Alerts"}),s.jsx(Q,{to:"/pharmacy/suppliers",icon:"reports",onSelect:t,children:"Supplier Orders"}),s.jsx(Q,{to:"/pharmacy/reports",icon:"reports",onSelect:t,children:"Reports"})]}),f==="PATIENT"&&s.jsxs(Lt,{title:"Patient Workspace",children:[s.jsx(Q,{to:"/patient/appointments",icon:"appointments",onSelect:t,children:"My Appointments"}),s.jsx(Q,{to:"/patient/medical-records",icon:"reports",onSelect:t,children:"Medical Records"}),s.jsx(Q,{to:"/patient/prescriptions",icon:"pharmacy",onSelect:t,children:"Prescriptions"}),s.jsx(Q,{to:"/patient/lab-results",icon:"lab",onSelect:t,children:"Lab Results"}),s.jsx(Q,{to:"/patient/billing",icon:"payroll",onSelect:t,children:"Billing"}),s.jsx(Q,{to:"/patient/insurance",icon:"reports",onSelect:t,children:"Insurance"}),s.jsx(Q,{to:"/patient/feedback",icon:"notifications",onSelect:t,children:"Feedback"})]}),s.jsxs(Lt,{title:"Payroll & Finance",children:[s.jsx(Q,{to:"/payments",icon:"payroll",onSelect:t,children:"Payroll & Payments"}),s.jsx(Q,{to:"/payments/full",icon:"payroll",onSelect:t,children:"Payment Operations"}),Ge(n.role)==="SUPER_ADMIN"&&s.jsx(Q,{to:"/admin/payment-settings",icon:"payroll",onSelect:t,children:"Payment Settings"}),s.jsx(Q,{to:"/payroll-officer",icon:"payroll",onSelect:t,children:"Payroll Officer"})]}),s.jsxs(Lt,{title:"AI & Automation",children:[s.jsx(Q,{to:"/ai/medical",icon:"ai",onSelect:t,children:"Clinical Assistant"}),s.jsx(Q,{to:"/ai/triage",icon:"ai",onSelect:t,children:"Triage"}),s.jsx(Q,{to:"/ai/voice",icon:"ai",onSelect:t,children:"Voice Dictation"}),s.jsx(Q,{to:"/ai/extract",icon:"ai",onSelect:t,children:"NeuroEdge Extract"}),s.jsx(Q,{to:"/ai/chatbot",icon:"ai",onSelect:t,children:"Support Chat"}),s.jsx(Q,{to:"/ai/ws",icon:"ai",onSelect:t,children:"Live AI Chat"})]}),s.jsxs(Lt,{title:"Security & Setup",children:[s.jsx(Q,{to:"/security-admin",icon:"security",onSelect:t,children:"Security Admin"}),s.jsx(Q,{to:"/security-officer",icon:"security",onSelect:t,children:"Security Officer"}),s.jsx(Q,{to:"/admin/realtime",icon:"settings",onSelect:t,children:"Integrations"}),s.jsx(Q,{to:"/admin/crdt-patients",icon:"settings",onSelect:t,children:"Offline Sync"})]}),s.jsx(Lt,{title:"Quick Actions",children:Y_(Ge(n.role)).map(m=>s.jsx(Q,{to:m.path,icon:"home",onSelect:t,children:m.label},m.path))}),s.jsxs(Lt,{title:"Settings",children:[["SUPER_ADMIN","DEVELOPER"].includes(Ge(n.role))&&s.jsx(Q,{to:"/super-admin/settings",icon:"settings",onSelect:t,children:"System Settings"}),s.jsx(Q,{to:"/profile",icon:"settings",onSelect:t,children:"Account Settings"}),s.jsx(Q,{to:"/reports",icon:"reports",onSelect:t,children:"Help & Policies"}),s.jsx(Q,{to:"/admin/audit-logs",icon:"admin",onSelect:t,children:"Activity Log"}),s.jsxs("li",{className:"theme-row",children:[s.jsxs("button",{className:`nav-btn ${a==="light"?"active":""}`,onClick:()=>o("light"),children:[s.jsx(An,{name:"settings"}),"Light"]}),s.jsxs("button",{className:`nav-btn ${a==="dark"?"active":""}`,onClick:()=>o("dark"),children:[s.jsx(An,{name:"settings"}),"Dark"]}),s.jsxs("button",{className:`nav-btn ${a==="system"?"active":""}`,onClick:()=>o("system"),children:[s.jsx(An,{name:"settings"}),"System"]})]})]})]})]})})}),s.jsxs("div",{className:"sidebar-footer sticky-footer",children:[s.jsxs("div",{className:"footer-actions",children:[s.jsxs("button",{className:"nav-btn",onClick:()=>{c("/reports"),t==null||t()},children:[s.jsx(An,{name:"reports"}),"Help"]}),s.jsxs("button",{className:"nav-btn",onClick:()=>{c("/profile"),t==null||t()},children:[s.jsx(An,{name:"settings"}),"Settings"]}),s.jsxs("button",{className:"nav-btn",onClick:()=>{r(),t==null||t()},children:[s.jsx(An,{name:"security"}),"Sign Out"]})]}),s.jsx("div",{children:"AfyaLink  Secure"})]})]})}function Lt({title:e,children:t}){return s.jsxs(s.Fragment,{children:[s.jsx("li",{className:"section-title",children:e}),t]})}function Q({to:e,children:t,icon:n,onSelect:r}){const i=Re();return s.jsx("li",{children:s.jsxs("button",{className:"nav-btn",onClick:()=>{i(e),r==null||r()},children:[s.jsx(An,{name:n}),t]})})}function Y_(e){const t=[{label:"Request Leave",path:"/workforce/requests#leave"},{label:"Request Overtime",path:"/workforce/requests#overtime"},{label:"Request Shift",path:"/workforce/requests#shift"}],n=[{label:"View Notifications",path:"/admin/notifications"},{label:"Open Reports",path:"/reports"}],r={SUPER_ADMIN:[{label:"Manage Hospitals",path:"/super-admin/hospitals"},{label:"Create Admin",path:"/admin/create-admin"},{label:"Audit Logs",path:"/admin/audit-logs"},{label:"SLA Policies",path:"/hospital-admin/approvals#sla"},{label:"Queue Insights",path:"/hospital-admin/approvals"}],SYSTEM_ADMIN:[{label:"Manage Hospitals",path:"/super-admin/hospitals"},{label:"Audit Logs",path:"/admin/audit-logs"},{label:"SLA Policies",path:"/hospital-admin/approvals#sla"},{label:"Queue Insights",path:"/hospital-admin/approvals"}],HOSPITAL_ADMIN:[{label:"Open Approvals",path:"/hospital-admin"},{label:"Inventory Review",path:"/inventory"},{label:"SLA Policies",path:"/hospital-admin/approvals#sla"}],HR_MANAGER:[{label:"Recruitment Pipeline",path:"/hr-manager"},{label:"Performance Reviews",path:"/hr-manager"}],PAYROLL_OFFICER:[{label:"Run Payroll",path:"/payroll-officer"},{label:"Payment Operations",path:"/payments/full"}],DOCTOR:[{label:"Start Consult",path:"/doctor"},{label:"Appointments",path:"/doctor/appointments"}],NURSE:[{label:"Start Round",path:"/nurse"},{label:"Patient Tasks",path:"/nurse"}],LAB_TECH:[{label:"Lab Queue",path:"/lab-tech"},{label:"Lab Tests",path:"/labtech/labs"}],PHARMACIST:[{label:"Dispense Queue",path:"/pharmacy"},{label:"Inventory",path:"/inventory"}],RADIOLOGIST:[],THERAPIST:[],RECEPTIONIST:[],DEVELOPER:[{label:"Integration Console",path:"/developer"},{label:"SLA Policies",path:"/hospital-admin/approvals#sla"},{label:"Queue Insights",path:"/hospital-admin/approvals"}],PATIENT:[{label:"Book Appointment",path:"/patient"},{label:"Payments",path:"/payments"}]},i=["HOSPITAL_ADMIN","HR_MANAGER","PAYROLL_OFFICER","DOCTOR","NURSE","LAB_TECH","PHARMACIST","RADIOLOGIST","THERAPIST","RECEPTIONIST","SECURITY_ADMIN","SECURITY_OFFICER"].includes(e);return[...r[e]||[],...i?t:[],...n]}function K_(){const{settings:e}=mi(),t=e==null?void 0:e.ai;return!(t!=null&&t.enabled)||!(t!=null&&t.url)?null:s.jsxs("button",{className:"ai-float",onClick:()=>window.open(t.url,"_blank"),title:t.name||"NeuroEdge",children:[s.jsx("span",{className:"ai-float-badge",children:t.name||"NeuroEdge"}),s.jsx("span",{className:"ai-float-sub",children:t.greeting||"Ask AI"})]})}function J_(){const{user:e}=Me(),[t,n]=g.useState(!1);g.useEffect(()=>{if(!(e!=null&&e.id))return;const i=`tour_seen_${e.id}`;localStorage.getItem(i)==="true"||n(!0)},[e==null?void 0:e.id]);const r=()=>{e!=null&&e.id&&localStorage.setItem(`tour_seen_${e.id}`,"true"),n(!1)};return t?s.jsx("div",{className:"tour-backdrop",role:"dialog","aria-modal":"true",children:s.jsxs("div",{className:"tour-modal",children:[s.jsx("button",{className:"tour-close",onClick:r,"aria-label":"Close",children:""}),s.jsx("h3",{children:"Welcome to AfyaLink HRMS"}),s.jsx("p",{className:"muted",children:"Heres a quick guide to get you started. You can revisit this anytime from Help."}),s.jsxs("ul",{className:"tour-list",children:[s.jsx("li",{children:"Use the navigator to switch dashboards and modules."}),s.jsx("li",{children:"Search across people, tasks, and reports from the top bar."}),s.jsx("li",{children:"Complete your verification in Profile for full access."}),s.jsx("li",{children:"Check alerts for approvals, requests, and system notices."})]}),s.jsxs("div",{className:"tour-actions",children:[s.jsx("button",{className:"btn-secondary",onClick:r,children:"Skip"}),s.jsx("button",{className:"btn-primary",onClick:r,children:"Start"})]})]})}):null}function Q_(e,...t){var o;if(!e)return{allowed:!1,reason:"UNAUTHENTICATED"};if(!t.length)return{allowed:!0};const n=Ge(e.role),r=Ge(e.actualRole),i=typeof window<"u"&&((o=window.localStorage)==null?void 0:o.getItem("strict_impersonation"))==="1",a=t.map(l=>Ge(l));return!i&&["SUPER_ADMIN","DEVELOPER"].includes(r)?{allowed:!0}:["SUPER_ADMIN","DEVELOPER"].includes(n)?{allowed:!0}:a.includes(n)?{allowed:!0}:{allowed:!1,reason:"FORBIDDEN"}}function oe({roles:e=[],children:t}){const{user:n,loading:r}=Me(),i=hn();return r?null:n?Q_(n,...e).allowed?t:s.jsx(vo,{to:"/unauthorized",replace:!0}):s.jsx(vo,{to:"/login",state:{from:i},replace:!0})}function Z_({children:e}){const{user:t,loading:n}=Me(),r=hn(),i=Re();return g.useEffect(()=>{if(n||!t)return;const a=ws(t);r.pathname==="/"&&i(a,{replace:!0})},[t,n,r.pathname,i]),e}function Bc({label:e="Password",value:t,onChange:n,placeholder:r="",showStrength:i=!1}){const[a,o]=g.useState(!1),l=t.length>=12?"strong":t.length>=8?"medium":t.length>0?"weak":"";return s.jsxs("div",{children:[s.jsx("label",{children:e}),s.jsxs("div",{style:{position:"relative"},children:[s.jsx("input",{type:a?"text":"password",value:t,placeholder:r,onChange:n,required:!0}),s.jsx("span",{onClick:()=>o(!a),style:{position:"absolute",right:14,top:12,cursor:"pointer",userSelect:"none"},children:a?"":""})]}),i&&t&&s.jsxs("div",{className:`pw-strength ${l}`,children:["Password strength: ",s.jsx("b",{children:l})]})]})}function Fj(){const{login:e}=Me(),t=Re(),[n,r]=g.useState(null),i=async a=>{try{if(r(null),!(a!=null&&a.credential))throw new Error("Missing Google credential");const o=await le("/api/auth/google",{method:"POST",body:{credential:a.credential}}),l=o.accessToken||o.token;await e(null,{directToken:!0,token:l,refreshToken:o.refreshToken,user:o.user}),t(ws(o.user),{replace:!0})}catch(o){r(o.message||"Google authentication failed")}};return{GoogleButton:()=>s.jsx(LN,{onSuccess:i,onError:()=>r("Google authentication failed")}),error:n,clearError:()=>r(null)}}function X_(){var N;const{login:e}=Me(),{settings:t}=mi(),n=Re(),r=hn(),{GoogleButton:i,error:a,clearError:o}=Fj(),[l,c]=g.useState(""),[u,d]=g.useState(""),[p,h]=g.useState(!1),[f,v]=g.useState(""),[j,_]=g.useState(""),[m,y]=g.useState(!1);g.useEffect(()=>{new URLSearchParams(r.search).get("verify")&&_("Account created. Verify your email from Profile inside the app.")},[r.search]),g.useEffect(()=>{const A=localStorage.getItem("remember_email");A&&(c(A),h(!0))},[]);const b=async A=>{A.preventDefault(),v(""),_(""),y(!0),o==null||o();try{p?localStorage.setItem("remember_email",l):localStorage.removeItem("remember_email");const E=await e(l.trim(),u);if(E!=null&&E.requires2FA){n("/2fa",{state:{userId:E.userId,email:l}});return}if(!(E!=null&&E.user))throw new Error("Invalid credentials");if(!E.user.emailVerified&&!E.user.phoneVerified){_("Account not verified. Complete verification in Profile."),n("/profile",{replace:!0});return}n(ws(E.user),{replace:!0})}catch(E){v(E.message||"Invalid credentials")}finally{y(!1)}};return s.jsx("div",{className:"auth-bg",children:s.jsxs("form",{className:"auth-card",onSubmit:b,children:[((N=t==null?void 0:t.branding)==null?void 0:N.logo)&&s.jsx("div",{className:"brand-logo",style:{backgroundImage:`url(${t.branding.logo})`,margin:"0 auto 10px"}}),s.jsx("h1",{children:"Welcome back"}),s.jsx("p",{className:"subtitle",children:"Sign in to AfyaLink HRMS"}),f&&s.jsx("div",{className:"auth-error",children:f}),j&&s.jsx("div",{className:"auth-info",children:j}),a&&s.jsx("div",{className:"auth-error",children:a}),s.jsx("label",{children:"Email or phone"}),s.jsx("input",{type:"text",value:l,onChange:A=>c(A.target.value),required:!0}),s.jsx(Bc,{label:"Password",value:u,onChange:A=>d(A.target.value),required:!0}),s.jsxs("div",{className:"auth-row",children:[s.jsxs("label",{className:"remember",children:[s.jsx("input",{type:"checkbox",checked:p,onChange:A=>h(A.target.checked)}),"Remember me"]}),s.jsx(ui,{to:"/forgot-password",className:"forgot-link",children:"Forgot password?"})]}),s.jsx("button",{disabled:m,children:m?"Signing in...":"Sign in"}),s.jsx("div",{className:"divider",children:"or"}),s.jsx("div",{onClick:()=>o==null?void 0:o(),children:s.jsx(i,{})}),s.jsxs("div",{className:"auth-footer",children:[s.jsx("span",{children:"Dont have an account?"}),s.jsx(ui,{to:"/register",children:"Create account"})]})]})})}function eA(){const e=Re(),{login:t}=Me(),{GoogleButton:n,error:r}=Fj(),[i,a]=g.useState({name:"",email:"",phone:"",nationalIdNumber:"",nationalIdCountry:"",password:"",confirmPassword:""}),[o,l]=g.useState(!1),[c,u]=g.useState(""),[d,p]=g.useState(""),h=v=>{a({...i,[v.target.name]:v.target.value}),u(""),p("")},f=async v=>{if(v.preventDefault(),i.password!==i.confirmPassword){u("Passwords do not match");return}try{l(!0),u(""),p("");const j=await le("/api/auth/register",{method:"POST",body:{name:i.name.trim(),email:i.email?i.email.toLowerCase().trim():void 0,phone:i.phone?i.phone.trim():void 0,nationalIdNumber:i.nationalIdNumber||void 0,nationalIdCountry:i.nationalIdCountry||void 0,password:i.password}});j.accessToken&&j.user?(await t(null,{directToken:!0,token:j.accessToken,user:j.user}),p("Account created! Verify your email from Profile inside the app."),e(ws(j.user),{replace:!0})):(p(j.phoneOtpSent?"Registration successful. An OTP was sent to your phone. Verify to activate your account.":j.msg||"Registration successful. Verify your email from Profile inside the app."),e("/login"))}catch(j){const _=j.message||"Registration failed";u(_)}finally{l(!1)}};return s.jsx("div",{className:"auth-bg",children:s.jsxs("form",{className:"auth-card",onSubmit:f,children:[s.jsx("h1",{children:"Create your account"}),s.jsx("p",{className:"subtitle",children:"Join AfyaLink HRMS"}),c&&s.jsx("div",{className:"auth-error",children:c}),d&&s.jsx("div",{className:"auth-info",children:d}),r&&s.jsx("div",{className:"auth-error",children:r}),s.jsx("label",{children:"Full Name"}),s.jsx("input",{name:"name",value:i.name,onChange:h,required:!0}),s.jsx("label",{children:"Email address (optional)"}),s.jsx("input",{type:"email",name:"email",value:i.email,onChange:h}),s.jsx("label",{children:"Phone number (optional)"}),s.jsx("input",{name:"phone",value:i.phone,onChange:h}),s.jsx("label",{children:"National ID Number"}),s.jsx("input",{name:"nationalIdNumber",value:i.nationalIdNumber,onChange:h}),s.jsx("label",{children:"National ID Country"}),s.jsx("input",{name:"nationalIdCountry",value:i.nationalIdCountry,onChange:h,placeholder:"e.g. KE, US, NG"}),s.jsx(Bc,{label:"Password",value:i.password,onChange:v=>a({...i,password:v.target.value}),showStrength:!0,required:!0}),s.jsx(Bc,{label:"Confirm password",value:i.confirmPassword,onChange:v=>a({...i,confirmPassword:v.target.value}),required:!0}),s.jsx("div",{className:"muted",style:{marginBottom:10},children:"Unverified accounts may be deleted after the verification deadline."}),s.jsx("button",{disabled:o,children:o?"Creating account...":"Create account"}),s.jsx("div",{className:"divider",children:"or"}),s.jsx(n,{}),s.jsxs("div",{className:"auth-footer",children:[s.jsx("span",{children:"Already have an account?"}),s.jsx(ui,{to:"/login",children:"Login"})]})]})})}function tA(){const[e]=pj(),[t,n]=g.useState("verifying"),[r,i]=g.useState(0),[a,o]=g.useState(!1),[l,c]=g.useState(""),u=e.get("token");g.useEffect(()=>{if(!u){n("invalid");return}le(`/api/auth/verify-email?token=${u}`).then(()=>n("success")).catch(()=>n("error"))},[u]),g.useEffect(()=>{if(r<=0)return;const p=setInterval(()=>i(h=>h-1),1e3);return()=>clearInterval(p)},[r]);const d=async()=>{try{o(!0);const p=await le("/api/auth/resend-verification",{method:"POST",body:{email:l}});i(p.retryAfter||60)}catch{alert("Failed to resend verification email")}finally{o(!1)}};return s.jsxs("div",{className:"verify-page",children:[t==="verifying"&&s.jsxs("div",{className:"card pulse",children:[s.jsx("h1",{children:"Verifying"}),s.jsx("p",{children:"Please wait"})]}),t==="success"&&s.jsxs("div",{className:"card success pop",children:[s.jsx("h1",{children:" Email Verified"}),s.jsx("p",{children:"Your account is now active."}),s.jsx(ui,{to:"/login",className:"btn",children:"Go to Login"})]}),t==="invalid"&&s.jsxs("div",{className:"card error shake",children:[s.jsx("h1",{children:" Invalid Link"}),s.jsx("p",{children:"This verification link is invalid."})]}),t==="error"&&s.jsxs("div",{className:"card error shake",children:[s.jsx("h1",{children:" Verification Failed"}),s.jsx("p",{children:"Link expired or already used."}),s.jsx("input",{type:"email",placeholder:"Enter your email",value:l,onChange:p=>c(p.target.value),style:{marginTop:12}}),s.jsx("button",{onClick:d,disabled:a||r>0||!l,className:"btn secondary",children:r>0?`Resend in ${r}s`:a?"Sending":"Resend verification email"})]})]})}function nA(){return s.jsx("div",{className:"auth-bg",children:s.jsxs("div",{className:"auth-card",children:[s.jsx("h1",{children:" Email Verified"}),s.jsx("p",{className:"subtitle",children:"Your email has been successfully verified. You can now log in to your account."}),s.jsx(ui,{to:"/login",children:s.jsx("button",{children:"Go to login"})})]})})}function Ng(){return s.jsxs("div",{style:{padding:40},children:[s.jsx("h1",{children:"403  Unauthorized"}),s.jsx("p",{children:"You do not have permission to access this page."})]})}function rA(){const[e,t]=g.useState(""),[n,r]=g.useState(""),[i,a]=g.useState(""),[o,l]=g.useState(!1),c=async u=>{u.preventDefault(),l(!0),r(""),a("");try{await le("/api/auth/forgot-password",{method:"POST",body:{email:e}}),r("If the email exists, a reset link has been sent.")}catch(d){a(d.message||"Something went wrong")}finally{l(!1)}};return s.jsx("div",{className:"auth-bg",children:s.jsxs("form",{className:"auth-card",onSubmit:c,children:[s.jsx("h1",{children:"Forgot password"}),s.jsx("p",{className:"subtitle",children:"Enter your email and well send you a reset link"}),i&&s.jsx("div",{className:"auth-error",children:i}),n&&s.jsx("div",{className:"auth-info",children:n}),s.jsx("label",{children:"Email address"}),s.jsx("input",{type:"email",required:!0,value:e,onChange:u=>t(u.target.value),placeholder:"you@example.com"}),s.jsx("button",{disabled:o,children:o?"Sending...":"Send reset link"})]})})}function sA(){const[e]=pj(),t=Re(),n=e.get("token"),[r,i]=g.useState(""),[a,o]=g.useState(""),[l,c]=g.useState(""),[u,d]=g.useState(!1);g.useEffect(()=>{n||o("Invalid or expired reset link")},[n]);const p=async h=>{if(h.preventDefault(),o(""),c(""),d(!0),!n){o("Invalid or expired reset link"),d(!1);return}try{await le("/api/auth/reset-password",{method:"POST",body:{token:n,password:r}}),c("Password reset successful. Redirecting to login..."),setTimeout(()=>t("/login"),2e3)}catch(f){o(f.message||"Reset link expired or invalid")}finally{d(!1)}};return s.jsx("div",{className:"auth-bg",children:s.jsxs("form",{className:"auth-card",onSubmit:p,children:[s.jsx("h1",{children:"Reset password"}),a&&s.jsx("div",{className:"auth-error",children:a}),l&&s.jsx("div",{className:"auth-info",children:l}),s.jsx(Bc,{label:"New password",value:r,onChange:h=>i(h.target.value),showStrength:!0,required:!0}),s.jsx("button",{disabled:u||!!a,children:u?"Resetting...":"Reset password"})]})})}function iA(){var p;const e=Re(),t=hn(),{complete2FA:n}=Me(),r=((p=t.state)==null?void 0:p.userId)||localStorage.getItem("2fa_user"),[i,a]=g.useState(""),[o,l]=g.useState(""),[c,u]=g.useState(!1);if(g.useEffect(()=>{r||e("/login",{replace:!0})},[r,e]),!r)return null;const d=async h=>{if(h.preventDefault(),i.length===6){l(""),u(!0);try{const f=await le("/api/auth/2fa/verify",{method:"POST",body:{userId:r,otp:i}});n(f.accessToken,f.refreshToken),e("/",{replace:!0})}catch(f){l(f.message||"Verification failed")}finally{u(!1)}}};return s.jsxs("div",{className:"auth-card",children:[s.jsx("h2",{children:" Two-Factor Authentication"}),s.jsx("p",{children:"Enter the 6-digit code sent to your email"}),o&&s.jsx("p",{className:"error",children:o}),s.jsxs("form",{onSubmit:d,children:[s.jsx("input",{type:"text",inputMode:"numeric",maxLength:"6",placeholder:"123456",value:i,onChange:h=>a(h.target.value.replace(/\D/g,"")),required:!0}),s.jsx("button",{disabled:c||i.length!==6,children:c?"Verifying...":"Verify"})]}),s.jsx("style",{children:`
        .auth-card {
          max-width: 420px;
          margin: 80px auto;
          padding: 32px;
          border-radius: 16px;
          background: white;
          text-align: center;
          box-shadow: 0 10px 25px rgba(0,0,0,0.08);
        }
        input {
          width: 100%;
          padding: 14px;
          margin: 20px 0;
          font-size: 20px;
          text-align: center;
          letter-spacing: 8px;
          border-radius: 10px;
          border: 1px solid #ddd;
        }
        button {
          width: 100%;
          padding: 14px;
          background: #2563eb;
          color: white;
          border: none;
          border-radius: 10px;
          font-weight: 600;
          cursor: pointer;
        }
        button:disabled {
          opacity: 0.6;
          cursor: not-allowed;
        }
        .error {
          color: #dc2626;
          margin-top: 12px;
        }
      `})]})}function aA(){const e=Re(),[t,n]=g.useState(null),[r,i]=g.useState(""),[a,o]=g.useState(!1),[l,c]=g.useState(!1),[u,d]=g.useState(""),[p,h]=g.useState(""),f=async()=>{try{const y=await le("/api/auth/session-risk");n(y||null)}catch(y){n(null),h((y==null?void 0:y.message)||"Failed to load session risk")}};g.useEffect(()=>{f()},[]);const v=async()=>{c(!0),h(""),d("");try{await le("/api/auth/step-up/request",{method:"POST"}),d("Step-up code sent. Check your email or phone.")}catch(y){h((y==null?void 0:y.message)||"Failed to request step-up code")}finally{c(!1)}},j=async y=>{y.preventDefault(),o(!0),h(""),d("");try{const b=await le("/api/auth/step-up/verify",{method:"POST",body:{otp:r.trim()}});b!=null&&b.accessToken&&localStorage.setItem("token",b.accessToken),d("Session unlocked successfully."),setTimeout(()=>e(-1),600)}catch(b){b instanceof yj?h(b.message):h("Failed to verify step-up code")}finally{o(!1)}},_=(t==null?void 0:t.risk)||{},m=(t==null?void 0:t.restriction)||null;return s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"Session Security Check"}),s.jsx("p",{className:"muted",children:"Complete a step-up verification to continue sensitive actions."})]}),s.jsxs("div",{className:"welcome-actions",children:[s.jsx("button",{className:"btn-secondary",onClick:f,children:"Refresh Risk"}),s.jsx("button",{className:"btn-primary",onClick:v,disabled:l,children:l?"Sending...":"Send Step-up Code"})]})]}),s.jsx("section",{className:"section",children:s.jsxs("div",{className:"grid info-grid",children:[s.jsxs("div",{className:"card",children:[s.jsx("strong",{children:"Risk Level:"})," ",_.level||""]}),s.jsxs("div",{className:"card",children:[s.jsx("strong",{children:"Risk Score:"})," ",_.score??""]}),s.jsxs("div",{className:"card",children:[s.jsx("strong",{children:"Step-up Required:"})," ",t!=null&&t.requiresStepUp?"Yes":"No"]}),s.jsxs("div",{className:"card",children:[s.jsx("strong",{children:"Step-up Verified At:"})," ",(t==null?void 0:t.stepUpVerifiedAt)||"Not yet"]})]})}),m&&s.jsx("section",{className:"section",children:s.jsxs("div",{className:"card",children:[s.jsx("strong",{children:"Restriction Active"}),s.jsxs("div",{className:"muted",children:["Reason: ",m.reason||"RISK_RESTRICTION_ACTIVE"]}),s.jsxs("div",{className:"muted",children:["Until: ",m.until||"Auto-expiry pending"]})]})}),s.jsx("section",{className:"section",children:s.jsxs("form",{className:"card",onSubmit:j,children:[s.jsx("h3",{children:"Verify Step-up Code"}),s.jsx("input",{type:"text",value:r,onChange:y=>i(y.target.value),placeholder:"Enter 6-digit code",maxLength:8,required:!0}),s.jsx("div",{className:"welcome-actions",style:{marginTop:12},children:s.jsx("button",{className:"btn-primary",type:"submit",disabled:a,children:a?"Verifying...":"Verify & Unlock"})}),u&&s.jsx("p",{className:"auth-info",children:u}),p&&s.jsx("p",{className:"auth-error",children:p})]})})]})}function oA(){const e=Re();return s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"AfyaLink Guest Portal"}),s.jsx("p",{className:"muted",children:"Public access for appointments, doctor directory, services and pre-registration."})]}),s.jsxs("div",{className:"welcome-actions",children:[s.jsx("button",{className:"btn-primary",onClick:()=>e("/register"),children:"Book Appointment"}),s.jsx("button",{className:"btn-secondary",onClick:()=>e("/login"),children:"Sign In"})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Guest Services"}),s.jsxs("div",{className:"panel-grid",children:[s.jsx("div",{className:"panel",children:"Search Doctor"}),s.jsx("div",{className:"panel",children:"Appointment Booking Form"}),s.jsx("div",{className:"panel",children:"Hospital Services"}),s.jsx("div",{className:"panel",children:"Contact & Support"}),s.jsx("div",{className:"panel",children:"Pre-Registration"})]})]})]})}const Rl="verifyCooldownUntil";function lA(){const{user:e,canRoleOverride:t,roleOverride:n,strictImpersonation:r,setRoleOverride:i,setStrictImpersonation:a}=Me(),o=Re(),[l,c]=g.useState(""),u=["SUPER_ADMIN","SYSTEM_ADMIN","HOSPITAL_ADMIN","DEVELOPER","DOCTOR","NURSE","LAB_TECH","PHARMACIST","RADIOLOGIST","THERAPIST","RECEPTIONIST","SECURITY_OFFICER","SECURITY_ADMIN","HR_MANAGER","PAYROLL_OFFICER","PATIENT","GUEST"],[d,p]=g.useState(!0),[h,f]=g.useState(""),[v,j]=g.useState(!1),[_,m]=g.useState(!0),[y,b]=g.useState(null),[N,A]=g.useState(!1),[E,R]=g.useState(""),[I,T]=g.useState(0),[L,B]=g.useState(""),[W,z]=g.useState(!1),[P,V]=g.useState(""),[K,ce]=g.useState(""),[M,X]=g.useState(!1),[ae,pe]=g.useState(""),[fe,Le]=g.useState(""),[F,Z]=g.useState(!1),[Y,ye]=g.useState(""),[ge,Ke]=g.useState(""),[Ae,Fe]=g.useState(""),[ne,me]=g.useState(!1),[se,be]=g.useState(""),[De,mt]=g.useState(!1),[Pt,we]=g.useState(""),[Ie,st]=g.useState({gender:"",dateOfBirth:"",nationality:"",address:"",emergencyName:"",emergencyRelationship:"",emergencyPhone:""}),[ve,Ue]=g.useState({employeeId:"",department:"",reportingManager:"",employmentType:"",hireDate:"",contractStart:"",contractEnd:"",workLocation:"",branch:""}),[Se,it]=g.useState({specialization:"",subSpecialization:"",cmeCredits:"",researchPublications:"",testAuthorizationLevel:"",certifications:"",educationHistory:""}),[xe,St]=g.useState({bankName:"",bankAccountName:"",bankAccountNumber:"",bankBranch:"",taxId:"",pensionInfo:"",salaryStructure:"",allowances:"",deductions:""}),[Jt,fn]=g.useState({status:"ACTIVE",accessExpiresAt:""}),[Ht,Un]=g.useState(""),[Qt,En]=g.useState(""),[je,Ee]=g.useState(""),[dt,gt]=g.useState(!1),[kt,Et]=g.useState(""),[Te,Nt]=g.useState("");g.useEffect(()=>{tr(),pn()},[]),g.useEffect(()=>{c(n||(e==null?void 0:e.actualRole)||(e==null?void 0:e.role)||"")},[n,e==null?void 0:e.actualRole,e==null?void 0:e.role]);const tr=()=>{const q=Number(localStorage.getItem(Rl));if(!q)return;const Rt=Math.ceil((q-Date.now())/1e3);Rt>0?T(Rt):localStorage.removeItem(Rl)};g.useEffect(()=>{if(I<=0)return;const q=setInterval(()=>{T(Rt=>Rt<=1?(localStorage.removeItem(Rl),0):Rt-1)},1e3);return()=>clearInterval(q)},[I]);const pn=async()=>{var q,Rt,vi,xi,ji,bi,wi,Si,Ei,Ni,_i,Os,Ps,Ls,Ds,Ms,qr,Vn,zr,Nn,Us,nr,wr,Bs,Vs,Sr,k,U,x,C;try{const S=await le("/api/2fa/status");j(!!(S!=null&&S.enabled));const w=await le("/api/profile");m(!!(w!=null&&w.emailVerified)),z(!!(w!=null&&w.phoneVerified)),B((w==null?void 0:w.phone)||""),pe((w==null?void 0:w.nationalIdNumber)||""),Le((w==null?void 0:w.nationalIdCountry)||""),Ke((w==null?void 0:w.licenseNumber)||""),Fe(w!=null&&w.licenseExpiry?w.licenseExpiry.slice(0,10):""),b((w==null?void 0:w.verificationWarning)||null),st({gender:(w==null?void 0:w.gender)||"",dateOfBirth:w!=null&&w.dateOfBirth?w.dateOfBirth.slice(0,10):"",nationality:(w==null?void 0:w.nationality)||"",address:(w==null?void 0:w.address)||"",emergencyName:((q=w==null?void 0:w.emergencyContact)==null?void 0:q.name)||"",emergencyRelationship:((Rt=w==null?void 0:w.emergencyContact)==null?void 0:Rt.relationship)||"",emergencyPhone:((vi=w==null?void 0:w.emergencyContact)==null?void 0:vi.phone)||""}),Ue({employeeId:((xi=w==null?void 0:w.employment)==null?void 0:xi.employeeId)||"",department:((ji=w==null?void 0:w.employment)==null?void 0:ji.department)||"",reportingManager:((bi=w==null?void 0:w.employment)==null?void 0:bi.reportingManager)||"",employmentType:((wi=w==null?void 0:w.employment)==null?void 0:wi.employmentType)||"",hireDate:(Si=w==null?void 0:w.employment)!=null&&Si.hireDate?w.employment.hireDate.slice(0,10):"",contractStart:(Ei=w==null?void 0:w.employment)!=null&&Ei.contractStart?w.employment.contractStart.slice(0,10):"",contractEnd:(Ni=w==null?void 0:w.employment)!=null&&Ni.contractEnd?w.employment.contractEnd.slice(0,10):"",workLocation:((_i=w==null?void 0:w.employment)==null?void 0:_i.workLocation)||"",branch:((Os=w==null?void 0:w.employment)==null?void 0:Os.branch)||""}),it({specialization:((Ps=w==null?void 0:w.credentials)==null?void 0:Ps.specialization)||"",subSpecialization:((Ls=w==null?void 0:w.credentials)==null?void 0:Ls.subSpecialization)||"",cmeCredits:((Ds=w==null?void 0:w.credentials)==null?void 0:Ds.cmeCredits)??"",researchPublications:((Ms=w==null?void 0:w.credentials)==null?void 0:Ms.researchPublications)??"",testAuthorizationLevel:((qr=w==null?void 0:w.credentials)==null?void 0:qr.testAuthorizationLevel)||"",certifications:(((Vn=w==null?void 0:w.credentials)==null?void 0:Vn.certifications)||[]).join(", "),educationHistory:(((zr=w==null?void 0:w.credentials)==null?void 0:zr.educationHistory)||[]).join(", ")}),St({bankName:((Nn=w==null?void 0:w.financial)==null?void 0:Nn.bankName)||"",bankAccountName:((Us=w==null?void 0:w.financial)==null?void 0:Us.bankAccountName)||"",bankAccountNumber:((nr=w==null?void 0:w.financial)==null?void 0:nr.bankAccountNumber)||"",bankBranch:((wr=w==null?void 0:w.financial)==null?void 0:wr.bankBranch)||"",taxId:((Bs=w==null?void 0:w.financial)==null?void 0:Bs.taxId)||"",pensionInfo:((Vs=w==null?void 0:w.financial)==null?void 0:Vs.pensionInfo)||"",salaryStructure:((Sr=w==null?void 0:w.financial)==null?void 0:Sr.salaryStructure)||"",allowances:((k=w==null?void 0:w.financial)==null?void 0:k.allowances)??"",deductions:((U=w==null?void 0:w.financial)==null?void 0:U.deductions)??""}),fn({status:((x=w==null?void 0:w.systemProfile)==null?void 0:x.status)||"ACTIVE",accessExpiresAt:(C=w==null?void 0:w.systemProfile)!=null&&C.accessExpiresAt?w.systemProfile.accessExpiresAt.slice(0,10):""})}catch{f("Unable to load security settings")}finally{p(!1)}},Cs=async()=>{mt(!0),we("");try{await le("/api/profile",{method:"PUT",body:{gender:Ie.gender||void 0,dateOfBirth:Ie.dateOfBirth||void 0,nationality:Ie.nationality||void 0,address:Ie.address||void 0,emergencyContact:{name:Ie.emergencyName||void 0,relationship:Ie.emergencyRelationship||void 0,phone:Ie.emergencyPhone||void 0},employment:{employeeId:ve.employeeId||void 0,department:ve.department||void 0,reportingManager:ve.reportingManager||void 0,employmentType:ve.employmentType||void 0,hireDate:ve.hireDate||void 0,contractStart:ve.contractStart||void 0,contractEnd:ve.contractEnd||void 0,workLocation:ve.workLocation||void 0,branch:ve.branch||void 0},credentials:{specialization:Se.specialization||void 0,subSpecialization:Se.subSpecialization||void 0,cmeCredits:Se.cmeCredits===""?void 0:Number(Se.cmeCredits),researchPublications:Se.researchPublications===""?void 0:Number(Se.researchPublications),testAuthorizationLevel:Se.testAuthorizationLevel||void 0,certifications:Se.certifications?Se.certifications.split(",").map(q=>q.trim()).filter(Boolean):[],educationHistory:Se.educationHistory?Se.educationHistory.split(",").map(q=>q.trim()).filter(Boolean):[]},financial:{bankName:xe.bankName||void 0,bankAccountName:xe.bankAccountName||void 0,bankAccountNumber:xe.bankAccountNumber||void 0,bankBranch:xe.bankBranch||void 0,taxId:xe.taxId||void 0,pensionInfo:xe.pensionInfo||void 0,salaryStructure:xe.salaryStructure||void 0,allowances:xe.allowances===""?void 0:Number(xe.allowances),deductions:xe.deductions===""?void 0:Number(xe.deductions)},systemProfile:{status:Jt.status||void 0,accessExpiresAt:Jt.accessExpiresAt||void 0}}}),we("Profile details updated.")}catch(q){we(q.message||"Failed to update profile details")}finally{mt(!1)}},yt=async()=>{try{const q=!v;await le("/api/2fa/toggle",{method:"POST",body:{enabled:q}}),j(q)}catch{f("Failed to update 2FA setting")}},Bn=async()=>{try{A(!0),R("");const q=await le("/api/auth/resend-verification",{method:"POST",body:{email:e==null?void 0:e.email}}),Rt=(q==null?void 0:q.retryAfter)||60;localStorage.setItem(Rl,Date.now()+Rt*1e3),T(Rt),R(" Verification email sent. Check your inbox.")}catch{R(" Failed to send verification email")}finally{A(!1)}},It=()=>{if(_||W||!y)return null;const q={"14d":"Your profile will be deleted in 14 days.","3d":"Your profile will be deleted in 3 days.","2h":"Your profile will be deleted in 2 hours.",EXPIRED:"Your account has expired and will be deleted."};return s.jsxs("div",{className:"card warning-card",children:[s.jsx("h3",{children:" Verification Required"}),s.jsx("p",{children:q[y.type]}),y.type!=="EXPIRED"&&(e==null?void 0:e.email)&&s.jsx("button",{className:"primary",disabled:N||I>0,onClick:Bn,children:N?"Sending...":I>0?`Resend in ${I}s`:"Verify Account"}),E&&s.jsx("p",{style:{marginTop:8},children:E})]})},ks=async()=>{Z(!0),ye("");try{await le("/api/profile",{method:"PUT",body:{nationalIdNumber:ae||void 0,nationalIdCountry:fe||void 0}}),ye("National ID updated")}catch(q){ye(q.message||"Failed to update National ID")}finally{Z(!1)}},Is=async()=>{me(!0),be("");try{await le("/api/profile",{method:"PUT",body:{licenseNumber:ge||void 0,licenseExpiry:Ae||void 0}}),be("License updated")}catch(q){be(q.message||"Failed to update license")}finally{me(!1)}},La=async()=>{X(!0),ce("");try{await le("/api/auth/phone/request-otp",{method:"POST",body:{phone:L.trim()}}),z(!1),ce("OTP sent to your phone.")}catch(q){ce(q.message||"Failed to send OTP")}finally{X(!1)}},Rs=async()=>{X(!0),ce("");try{await le("/api/auth/phone/verify",{method:"POST",body:{otp:P.trim()}}),z(!0),V(""),ce("Phone verified successfully.")}catch(q){ce(q.message||"Invalid OTP")}finally{X(!1)}},Da=async q=>{if(q.preventDefault(),Et(""),Nt(""),Qt!==je){Nt("Passwords do not match");return}gt(!0);try{const Rt=await le("/api/auth/change-password",{method:"POST",body:{currentPassword:Ht,newPassword:Qt}});Et("Password changed successfully"),Un(""),En(""),Ee("")}catch(Rt){Nt(Rt.message||"Password change failed")}finally{gt(!1)}},Ts={SUPER_ADMIN:["System configuration and permission matrix ownership","API key management and integration governance","Global audit and backup oversight"],SYSTEM_ADMIN:["Server operations and error diagnostics","Database and feature-toggle control","Integration reliability monitoring"],HOSPITAL_ADMIN:["Department and staffing operations","Shift, leave and approval oversight","Budget and branch execution control"],SECURITY_ADMIN:["Incident escalation and clearance governance","Visitor and surveillance compliance management","Emergency response coordination"],SECURITY_OFFICER:["Shift assignment and gate operations","Visitor verification and QR scanning","Incident reporting execution"],HR_MANAGER:["Recruitment and onboarding workflows","Performance and disciplinary tracking","Training and succession planning"],PAYROLL_OFFICER:["Payroll processing and payslip generation","Tax, pension, deductions and audit trail","Overtime and shift differential reconciliation"],DEVELOPER:["API logs, webhook diagnostics and feature flags","Performance tracing and release validation","Integration and automation reliability"],DOCTOR:["Medical license and specialization details","Clinical schedule and patient workload context","CME credits and publications tracking"],NURSE:["Ward/department assignment and shift readiness","Clinical workload and overtime visibility","Incident and quality reporting continuity"],LAB_TECH:["Test authorization level and assignment scope","Lab workflow accountability and compliance","Safety and equipment audit readiness"],PHARMACIST:["License and controlled-drug accountability","Inventory and dispensing governance","Expiry and interaction safety controls"],PATIENT:["Verified identity and emergency contact","Clinical and billing communication readiness","Secure self-service profile completeness"],GUEST:["Pre-registration and contact readiness","Limited-access appointment flow data","Upgrade eligibility details"],RADIOLOGIST:["Imaging authorization and reporting scope","Diagnostic workflow credential completeness","PACS and compliance readiness"],THERAPIST:["Treatment plan and session documentation profile","Progress tracking role context","Department and scheduling completeness"],RECEPTIONIST:["Patient intake and scheduling role context","Queue and billing initiation responsibility","Front-desk operational readiness"]};return d?s.jsx("p",{children:"Loading..."}):s.jsxs("div",{className:"profile-container",children:[t&&s.jsxs("div",{className:"card",children:[s.jsx("h3",{children:"Role View Switcher"}),s.jsxs("p",{children:["Use this to switch and test account types. Your actual account stays ",s.jsx("strong",{children:(e==null?void 0:e.actualRole)||(e==null?void 0:e.role)}),"."]}),s.jsxs("label",{className:"profile-inline-check",style:{marginBottom:12},children:[s.jsx("input",{type:"checkbox",checked:!!r,onChange:q=>a(q.target.checked)}),s.jsx("span",{children:"Lock to exact role permissions (strict impersonation)"})]}),s.jsx("p",{className:"muted",style:{marginTop:0},children:r?"Strict mode: access is limited to the switched role.":"Full access mode: founder/developer elevated permissions remain active while viewing another role."}),s.jsxs("div",{className:"profile-row",children:[s.jsx("select",{value:l,onChange:q=>c(q.target.value),children:u.map(q=>s.jsx("option",{value:q,children:q},q))}),s.jsx("button",{className:"primary",onClick:()=>{i(l),o(ws({role:l}))},children:"Switch Role View"}),s.jsx("button",{className:"secondary",onClick:()=>{const q=(e==null?void 0:e.actualRole)||(e==null?void 0:e.role);i(""),c(q),o(ws({role:q}))},children:"Reset to My Role"})]})]}),It(),s.jsxs("div",{className:"card",children:[s.jsx("h3",{children:"Verification Status"}),s.jsxs("div",{className:"grid",children:[s.jsxs("div",{children:[s.jsx("strong",{children:"Email:"})," ",_?"Verified":"Not verified"]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Phone:"})," ",W?"Verified":"Not verified"]})]})]}),s.jsxs("div",{className:"card",children:[s.jsx("h3",{children:"Phone & National ID"}),s.jsx("p",{children:W?"Your phone number is verified.":"Verify your phone number to keep your account active."}),s.jsx("label",{children:"Phone number"}),s.jsx("input",{value:L,onChange:q=>B(q.target.value),placeholder:"+1 555 123 4567"}),s.jsxs("div",{className:"profile-row",children:[s.jsx("button",{className:"primary",onClick:La,disabled:M||!L.trim(),children:M?"Sending...":"Send OTP"}),s.jsx("input",{value:P,onChange:q=>V(q.target.value),placeholder:"Enter OTP",style:{maxWidth:180}}),s.jsx("button",{className:"success",onClick:Rs,disabled:M||!P.trim(),children:M?"Verifying...":"Verify"})]}),K&&s.jsx("p",{style:{marginTop:8},children:K}),s.jsx("hr",{style:{margin:"18px 0"}}),s.jsx("label",{children:"National ID Number"}),s.jsx("input",{value:ae,onChange:q=>pe(q.target.value)}),s.jsx("label",{children:"National ID Country"}),s.jsx("input",{value:fe,onChange:q=>Le(q.target.value),placeholder:"e.g. KE, US, NG"}),s.jsx("button",{className:"primary",onClick:ks,disabled:F,style:{marginTop:8},children:F?"Saving...":"Save National ID"}),Y&&s.jsx("p",{style:{marginTop:8},children:Y}),s.jsx("hr",{style:{margin:"18px 0"}}),s.jsx("label",{children:"Professional License Number"}),s.jsx("input",{value:ge,onChange:q=>Ke(q.target.value),placeholder:"e.g. KMPDC-123456"}),s.jsx("label",{children:"License Expiry Date"}),s.jsx("input",{type:"date",value:Ae,onChange:q=>Fe(q.target.value)}),s.jsx("button",{className:"primary",onClick:Is,disabled:ne,style:{marginTop:8},children:ne?"Saving...":"Save License"}),se&&s.jsx("p",{style:{marginTop:8},children:se})]}),s.jsxs("div",{className:"card",children:[s.jsx("h3",{children:"Basic Information"}),s.jsx("label",{children:"Gender"}),s.jsxs("select",{value:Ie.gender,onChange:q=>st({...Ie,gender:q.target.value}),children:[s.jsx("option",{value:"",children:"Select"}),s.jsx("option",{value:"MALE",children:"Male"}),s.jsx("option",{value:"FEMALE",children:"Female"}),s.jsx("option",{value:"OTHER",children:"Other"}),s.jsx("option",{value:"PREFER_NOT_TO_SAY",children:"Prefer not to say"})]}),s.jsx("label",{children:"Date of Birth"}),s.jsx("input",{type:"date",value:Ie.dateOfBirth,onChange:q=>st({...Ie,dateOfBirth:q.target.value})}),s.jsx("label",{children:"Nationality"}),s.jsx("input",{value:Ie.nationality,onChange:q=>st({...Ie,nationality:q.target.value})}),s.jsx("label",{children:"Address"}),s.jsx("input",{value:Ie.address,onChange:q=>st({...Ie,address:q.target.value})}),s.jsx("label",{children:"Emergency Contact Name"}),s.jsx("input",{value:Ie.emergencyName,onChange:q=>st({...Ie,emergencyName:q.target.value})}),s.jsx("label",{children:"Emergency Contact Relationship"}),s.jsx("input",{value:Ie.emergencyRelationship,onChange:q=>st({...Ie,emergencyRelationship:q.target.value})}),s.jsx("label",{children:"Emergency Contact Phone"}),s.jsx("input",{value:Ie.emergencyPhone,onChange:q=>st({...Ie,emergencyPhone:q.target.value})})]}),s.jsxs("div",{className:"card",children:[s.jsx("h3",{children:"Employment Information"}),s.jsx("label",{children:"Employee ID"}),s.jsx("input",{value:ve.employeeId,onChange:q=>Ue({...ve,employeeId:q.target.value})}),s.jsx("label",{children:"Department"}),s.jsx("input",{value:ve.department,onChange:q=>Ue({...ve,department:q.target.value})}),s.jsx("label",{children:"Reporting Manager"}),s.jsx("input",{value:ve.reportingManager,onChange:q=>Ue({...ve,reportingManager:q.target.value})}),s.jsx("label",{children:"Employment Type"}),s.jsxs("select",{value:ve.employmentType,onChange:q=>Ue({...ve,employmentType:q.target.value}),children:[s.jsx("option",{value:"",children:"Select"}),s.jsx("option",{value:"FULL_TIME",children:"Full-time"}),s.jsx("option",{value:"LOCUM",children:"Locum"}),s.jsx("option",{value:"CONTRACT",children:"Contract"}),s.jsx("option",{value:"PART_TIME",children:"Part-time"}),s.jsx("option",{value:"INTERN",children:"Intern"})]}),s.jsx("label",{children:"Hire Date"}),s.jsx("input",{type:"date",value:ve.hireDate,onChange:q=>Ue({...ve,hireDate:q.target.value})}),s.jsx("label",{children:"Contract Start"}),s.jsx("input",{type:"date",value:ve.contractStart,onChange:q=>Ue({...ve,contractStart:q.target.value})}),s.jsx("label",{children:"Contract End"}),s.jsx("input",{type:"date",value:ve.contractEnd,onChange:q=>Ue({...ve,contractEnd:q.target.value})}),s.jsx("label",{children:"Work Location"}),s.jsx("input",{value:ve.workLocation,onChange:q=>Ue({...ve,workLocation:q.target.value})}),s.jsx("label",{children:"Branch"}),s.jsx("input",{value:ve.branch,onChange:q=>Ue({...ve,branch:q.target.value})})]}),s.jsxs("div",{className:"card",children:[s.jsx("h3",{children:"Credentials & Professional Data"}),s.jsx("label",{children:"Specialization"}),s.jsx("input",{value:Se.specialization,onChange:q=>it({...Se,specialization:q.target.value})}),s.jsx("label",{children:"Sub-specialization"}),s.jsx("input",{value:Se.subSpecialization,onChange:q=>it({...Se,subSpecialization:q.target.value})}),s.jsx("label",{children:"Certifications (comma-separated)"}),s.jsx("input",{value:Se.certifications,onChange:q=>it({...Se,certifications:q.target.value})}),s.jsx("label",{children:"Education History (comma-separated)"}),s.jsx("input",{value:Se.educationHistory,onChange:q=>it({...Se,educationHistory:q.target.value})}),s.jsx("label",{children:"CME Credits"}),s.jsx("input",{type:"number",value:Se.cmeCredits,onChange:q=>it({...Se,cmeCredits:q.target.value})}),s.jsx("label",{children:"Research Publications"}),s.jsx("input",{type:"number",value:Se.researchPublications,onChange:q=>it({...Se,researchPublications:q.target.value})}),s.jsx("label",{children:"Test Authorization Level"}),s.jsx("input",{value:Se.testAuthorizationLevel,onChange:q=>it({...Se,testAuthorizationLevel:q.target.value})})]}),s.jsxs("div",{className:"card",children:[s.jsx("h3",{children:"Financial Information"}),s.jsx("label",{children:"Bank Name"}),s.jsx("input",{value:xe.bankName,onChange:q=>St({...xe,bankName:q.target.value})}),s.jsx("label",{children:"Bank Account Name"}),s.jsx("input",{value:xe.bankAccountName,onChange:q=>St({...xe,bankAccountName:q.target.value})}),s.jsx("label",{children:"Bank Account Number"}),s.jsx("input",{value:xe.bankAccountNumber,onChange:q=>St({...xe,bankAccountNumber:q.target.value})}),s.jsx("label",{children:"Bank Branch"}),s.jsx("input",{value:xe.bankBranch,onChange:q=>St({...xe,bankBranch:q.target.value})}),s.jsx("label",{children:"Tax ID"}),s.jsx("input",{value:xe.taxId,onChange:q=>St({...xe,taxId:q.target.value})}),s.jsx("label",{children:"Pension Info"}),s.jsx("input",{value:xe.pensionInfo,onChange:q=>St({...xe,pensionInfo:q.target.value})}),s.jsx("label",{children:"Salary Structure"}),s.jsx("input",{value:xe.salaryStructure,onChange:q=>St({...xe,salaryStructure:q.target.value})}),s.jsx("label",{children:"Allowances"}),s.jsx("input",{type:"number",value:xe.allowances,onChange:q=>St({...xe,allowances:q.target.value})}),s.jsx("label",{children:"Deductions"}),s.jsx("input",{type:"number",value:xe.deductions,onChange:q=>St({...xe,deductions:q.target.value})})]}),s.jsxs("div",{className:"card",children:[s.jsx("h3",{children:"System Data"}),s.jsx("label",{children:"Status"}),s.jsxs("select",{value:Jt.status,onChange:q=>fn({...Jt,status:q.target.value}),children:[s.jsx("option",{value:"ACTIVE",children:"Active"}),s.jsx("option",{value:"SUSPENDED",children:"Suspended"}),s.jsx("option",{value:"ON_LEAVE",children:"On Leave"})]}),s.jsx("label",{children:"Access Expiration"}),s.jsx("input",{type:"date",value:Jt.accessExpiresAt,onChange:q=>fn({...Jt,accessExpiresAt:q.target.value})}),s.jsx("button",{className:"primary",onClick:Cs,disabled:De,style:{marginTop:8},children:De?"Saving...":"Save Full Profile"}),Pt&&s.jsx("p",{style:{marginTop:8},children:Pt})]}),s.jsxs("div",{className:"card",children:[s.jsxs("h3",{children:["Role-Specific Profile Checklist (",e==null?void 0:e.role,")"]}),s.jsx("ul",{children:(Ts[e==null?void 0:e.role]||Ts.GUEST).map(q=>s.jsx("li",{children:q},q))})]}),s.jsxs("div",{className:"card",children:[s.jsx("h3",{children:"Two-Factor Authentication (2FA)"}),s.jsx("p",{children:v?"2FA is enabled. Youll be asked for a code at login.":"2FA is disabled. Your account uses password only."}),s.jsx("button",{className:v?"danger":"success",onClick:yt,children:v?"Disable 2FA":"Enable 2FA"})]}),s.jsxs("div",{className:"card",style:{marginTop:24},children:[s.jsx("h3",{children:"Change Password"}),Te&&s.jsx("div",{className:"auth-error",children:Te}),kt&&s.jsx("div",{className:"auth-success",children:kt}),s.jsxs("form",{onSubmit:Da,children:[s.jsx("label",{children:"Current password"}),s.jsx("input",{type:"password",value:Ht,onChange:q=>Un(q.target.value),required:!0}),s.jsx("label",{children:"New password"}),s.jsx("input",{type:"password",value:Qt,onChange:q=>En(q.target.value),required:!0}),s.jsx("label",{children:"Confirm new password"}),s.jsx("input",{type:"password",value:je,onChange:q=>Ee(q.target.value),required:!0}),s.jsx("button",{disabled:dt,style:{marginTop:8},children:dt?"Updating...":"Change password"})]})]}),h&&s.jsx("p",{style:{color:"red",marginTop:16},children:h})]})}const cA=()=>le("/api/analytics/revenue/daily"),uA=()=>le("/api/analytics/doctors/utilization"),dA=()=>le("/api/analytics/pharmacy/profit");function hA(){const[e,t]=g.useState([]),[n,r]=g.useState([]),[i,a]=g.useState([]),[o,l]=g.useState("");g.useEffect(()=>{Promise.all([cA(),uA(),dA()]).then(([h,f,v])=>{t(Array.isArray(h)?h:[]),r(Array.isArray(f)?f:[]),a(Array.isArray(v)?v:[])}).catch(()=>l("Failed to load analytics"))},[]);const c=g.useMemo(()=>e.reduce((h,f)=>h+(f.total||0),0),[e]),u=g.useMemo(()=>Math.max(1,...e.map(h=>h.total||0)),[e]),d=g.useMemo(()=>Math.max(1,...n.map(h=>h.count||0)),[n]),p=g.useMemo(()=>Math.max(1,...i.map(h=>h.profit||0)),[i]);return s.jsxs("div",{className:"dashboard",children:[s.jsx("div",{className:"welcome-panel",children:s.jsxs("div",{children:[s.jsx("h2",{children:"Analytics"}),s.jsx("p",{className:"muted",children:"Live metrics and operational insights."})]})}),o&&s.jsx("div",{className:"card",children:o}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Revenue (Last 30 Days)"}),s.jsxs("div",{className:"grid info-grid",children:[s.jsxs("div",{className:"card",children:[s.jsx("div",{className:"card-title",children:"Total Revenue"}),s.jsxs("div",{className:"card-value",children:["KES ",c.toLocaleString()]})]}),s.jsxs("div",{className:"card",children:[s.jsx("div",{className:"card-title",children:"Days Tracked"}),s.jsx("div",{className:"card-value",children:e.length})]})]}),s.jsx("div",{className:"card chart-card",children:e.length===0?s.jsx("div",{className:"muted",children:"No revenue data yet."}):s.jsx("div",{className:"simple-chart",children:e.slice(-14).map(h=>{var f;return s.jsxs("div",{className:"bar-row",children:[s.jsx("span",{className:"bar-label",children:h._id}),s.jsx("div",{className:"bar-track",children:s.jsx("div",{className:"bar-fill",style:{width:`${h.total/u*100}%`}})}),s.jsxs("span",{className:"bar-value",children:["KES ",(f=h.total)==null?void 0:f.toLocaleString()]})]},h._id)})})})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Doctor Utilization (Top 10)"}),s.jsx("div",{className:"card chart-card",children:n.length===0?s.jsx("div",{className:"muted",children:"No utilization data yet."}):s.jsx("div",{className:"simple-chart",children:n.slice(0,10).map((h,f)=>{var v;return s.jsxs("div",{className:"bar-row",children:[s.jsx("span",{className:"bar-label",children:(((v=h.doctor)==null?void 0:v.name)||"Doctor").split(" ")[0]}),s.jsx("div",{className:"bar-track",children:s.jsx("div",{className:"bar-fill blue",style:{width:`${h.count/d*100}%`}})}),s.jsx("span",{className:"bar-value",children:h.count})]},h._id||f)})})})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Pharmacy Profit (Top Items)"}),s.jsx("div",{className:"card chart-card",children:i.length===0?s.jsx("div",{className:"muted",children:"No pharmacy profit data yet."}):s.jsx("div",{className:"simple-chart",children:i.slice(0,10).map((h,f)=>{var v;return s.jsxs("div",{className:"bar-row",children:[s.jsx("span",{className:"bar-label",children:h._id||"Item"}),s.jsx("div",{className:"bar-track",children:s.jsx("div",{className:"bar-fill green",style:{width:`${h.profit/p*100}%`}})}),s.jsxs("span",{className:"bar-value",children:["KES ",(v=h.profit)==null?void 0:v.toLocaleString()]})]},h._id||f)})})})]})]})}const Hj=(e={})=>{const t=new URLSearchParams;e.limit&&t.set("limit",String(e.limit)),e.cursor!==void 0&&e.cursor!==null&&t.set("cursor",e.cursor),e.cursorMode&&t.set("cursorMode","1");const n=t.toString();return n?`?${n}`:""},_g=(e={})=>le(`/api/reports${Hj(e)}`),Ag=(e={})=>le(`/api/reports/mine${Hj(e)}`),fA=e=>le("/api/reports",{method:"POST",body:e}),pA=e=>le(`/api/reports/${e}`,{method:"DELETE"});function mA(){const{user:e}=Me(),t=(e==null?void 0:e.role)||"",n=["SUPER_ADMIN","SYSTEM_ADMIN","HOSPITAL_ADMIN"].includes(t),r=["DOCTOR"].includes(t),i=["DOCTOR","PATIENT"].includes(t),[a,o]=g.useState([]),[l,c]=g.useState([]),[u,d]=g.useState(null),[p,h]=g.useState(null),[f,v]=g.useState(!1),[j,_]=g.useState(!1),[m,y]=g.useState(!1),[b,N]=g.useState(n?"all":"mine"),[A,E]=g.useState(""),[R,I]=g.useState({title:"",content:"",patient:""});g.useEffect(()=>{n&&_g({cursorMode:!0,limit:25}).then(P=>{const V=Array.isArray(P)?P:Array.isArray(P==null?void 0:P.items)?P.items:[];o(V),d((P==null?void 0:P.nextCursor)||null),v(!!(P!=null&&P.hasMore))}).catch(()=>{o([]),d(null),v(!1)}),i&&Ag({cursorMode:!0,limit:25}).then(P=>{const V=Array.isArray(P)?P:Array.isArray(P==null?void 0:P.items)?P.items:[];c(V),h((P==null?void 0:P.nextCursor)||null),_(!!(P!=null&&P.hasMore))}).catch(()=>{c([]),h(null),_(!1)})},[n,i]);const T=g.useMemo(()=>b==="all"?a:l,[b,a,l]),L=b==="all"?f:j,B=async()=>{if(E(""),!R.title||!R.content){E("Title and content are required.");return}try{const P={title:R.title,content:R.content,...R.patient?{patient:R.patient}:{}},V=await fA(P);I({title:"",content:"",patient:""}),c(K=>[V,...K])}catch(P){E(P.message||"Failed to create report")}},W=async P=>{try{await pA(P),o(V=>V.filter(K=>K._id!==P)),c(V=>V.filter(K=>K._id!==P))}catch(V){E(V.message||"Failed to delete report")}},z=async()=>{y(!0),E("");try{if(b==="all"){const P=await _g({cursorMode:!0,limit:25,cursor:u}),V=Array.isArray(P==null?void 0:P.items)?P.items:[];o(K=>[...K,...V]),d((P==null?void 0:P.nextCursor)||null),v(!!(P!=null&&P.hasMore))}else{const P=await Ag({cursorMode:!0,limit:25,cursor:p}),V=Array.isArray(P==null?void 0:P.items)?P.items:[];c(K=>[...K,...V]),h((P==null?void 0:P.nextCursor)||null),_(!!(P!=null&&P.hasMore))}}catch(P){E(P.message||"Failed to load more reports")}finally{y(!1)}};return s.jsxs("div",{className:"dashboard",children:[s.jsx("div",{className:"welcome-panel",children:s.jsxs("div",{children:[s.jsx("h2",{children:"Reports"}),s.jsx("p",{className:"muted",children:"Clinical and operational reporting."})]})}),A&&s.jsx("div",{className:"card",children:A}),s.jsx("section",{className:"section",children:s.jsxs("div",{className:"action-list",children:[n&&s.jsx("button",{className:`action-pill ${b==="all"?"active":""}`,onClick:()=>N("all"),children:"All Reports"}),i&&s.jsx("button",{className:`action-pill ${b==="mine"?"active":""}`,onClick:()=>N("mine"),children:"My Reports"})]})}),r&&s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Create Report"}),s.jsxs("div",{className:"card form",children:[s.jsx("label",{children:"Title"}),s.jsx("input",{value:R.title,onChange:P=>I(V=>({...V,title:P.target.value}))}),s.jsx("label",{children:"Patient ID (optional)"}),s.jsx("input",{value:R.patient,onChange:P=>I(V=>({...V,patient:P.target.value}))}),s.jsx("label",{children:"Content"}),s.jsx("textarea",{rows:5,value:R.content,onChange:P=>I(V=>({...V,content:P.target.value}))}),s.jsx("button",{className:"btn-primary",onClick:B,children:"Create Report"})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:b==="all"?"All Reports":"My Reports"}),s.jsxs("div",{className:"card",children:[T.length===0?s.jsx("div",{className:"muted",children:"No reports found."}):s.jsx("div",{className:"report-list",children:T.map(P=>s.jsxs("div",{className:"report-item",children:[s.jsxs("div",{children:[s.jsx("div",{className:"report-title",children:P.title||"Untitled"}),s.jsx("div",{className:"muted",children:P.createdAt?new Date(P.createdAt).toLocaleString():""}),P.content&&s.jsx("div",{className:"report-content",children:String(P.content).slice(0,200)})]}),n&&s.jsx("button",{className:"btn-secondary",onClick:()=>W(P._id),children:"Delete"})]},P._id))}),L&&s.jsx("div",{style:{marginTop:12},children:s.jsx("button",{className:"btn-secondary",disabled:m,onClick:z,children:m?"Loading...":"Load more"})})]})]})]})}async function gA({q:e,page:t=1,limit:n=25}={}){const r=new URLSearchParams({q:e,page:t,limit:n}).toString();return le(`/api/inventory/list?${r}`)}function yA(){const[e,t]=g.useState([]),[n,r]=g.useState(""),[i,a]=g.useState(1),[o,l]=g.useState(0),[c,u]=g.useState(!1),[d,p]=g.useState("");g.useEffect(()=>{let f=!0;return u(!0),p(""),gA({q:n,page:i,limit:25}).then(v=>{f&&(t(v.items||[]),l(v.total||0))}).catch(()=>{f&&p("Failed to load inventory.")}).finally(()=>{f&&u(!1)}),()=>{f=!1}},[n,i]);const h=Math.max(1,Math.ceil(o/25));return s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"Inventory"}),s.jsx("p",{className:"muted",children:"Track stock levels across pharmacy items. Use search to filter."})]}),s.jsx("div",{className:"welcome-actions",children:s.jsx("input",{className:"input",placeholder:"Search inventory",value:n,onChange:f=>{a(1),r(f.target.value)}})})]}),d&&s.jsx("div",{className:"card",children:d}),s.jsx("div",{className:"card",children:c?s.jsx("div",{className:"muted",children:"Loading inventory..."}):s.jsxs("table",{className:"table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Item"}),s.jsx("th",{children:"SKU"}),s.jsx("th",{children:"Unit"}),s.jsx("th",{children:"Total Qty"}),s.jsx("th",{children:"Min Stock"})]})}),s.jsxs("tbody",{children:[e.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:"5",className:"muted",children:"No inventory items yet."})}),e.map(f=>s.jsxs("tr",{children:[s.jsx("td",{children:f.name}),s.jsx("td",{children:f.sku||""}),s.jsx("td",{children:f.unit||""}),s.jsx("td",{children:f.totalQuantity??0}),s.jsx("td",{children:f.minStock??0})]},f._id))]})]})}),s.jsxs("div",{className:"table-footer",children:[s.jsx("button",{className:"btn-secondary",disabled:i<=1,onClick:()=>a(f=>Math.max(1,f-1)),children:"Prev"}),s.jsxs("span",{className:"muted",children:["Page ",i," of ",h]}),s.jsx("button",{className:"btn-secondary",disabled:i>=h,onClick:()=>a(f=>Math.min(h,f+1)),children:"Next"})]})]})}const vA={CREATED:"#64748b",INSURANCE_PENDING:"#f59e0b",INSURANCE_APPROVED:"#16a34a",INSURANCE_REJECTED:"#dc2626",TRIAGE_PENDING:"#0ea5e9",CONSULTATION:"#0ea5e9",LAB_PENDING:"#8b5cf6",LAB_COMPLETED:"#22c55e",PRESCRIPTION_READY:"#3b82f6",PHARMACY_PENDING:"#3b82f6",DISPENSED:"#16a34a",PAYMENT_PENDING:"#f97316",PAID:"#22c55e",COMPLETED:"#15803d",CANCELLED:"#6b7280"};function ac({state:e}){if(!e)return null;const t=vA[e]||"#334155";return s.jsx("span",{style:{background:t,color:"white",padding:"4px 10px",borderRadius:999,fontSize:12,fontWeight:600,textTransform:"uppercase",letterSpacing:.4},children:e.replace(/_/g," ")})}function xA({sla:e}){if(!e)return null;const t=Math.floor(e.elapsedMs/6e4),n=e.breached;return s.jsxs("div",{style:{padding:"6px 10px",borderRadius:8,background:n?"#fee2e2":"#ecfeff",color:n?"#b91c1c":"#0369a1",fontSize:13,fontWeight:600,marginBottom:6},children:[" ",e.name,": ",t," min",n&&"  SLA BREACHED"]})}function jA({encounterId:e}){var d;const[t,n]=g.useState(null),[r,i]=g.useState(!0),[a,o]=g.useState("");g.useEffect(()=>{e&&l()},[e]);async function l(){i(!0),o("");try{const p=await le(`/api/workflows/${e}/timeline`);n(p)}catch(p){o(p.message||"Failed to load workflow timeline")}finally{i(!1)}}if(!e)return null;if(r)return s.jsx("div",{className:"card",children:"Loading workflow"});if(a)return s.jsx("div",{className:"card",style:{color:"red"},children:a});const{workflow:c,audit:u}=t;return s.jsxs("div",{className:"card premium-card",children:[s.jsx("h3",{style:{marginBottom:12},children:"Workflow Timeline"}),s.jsxs("div",{style:{marginBottom:16},children:[s.jsx("strong",{children:"Current State:"})," ",s.jsx(ac,{state:c.state})]}),s.jsxs("div",{style:{marginBottom:20},children:[s.jsx("strong",{children:"Allowed Actions:"}),s.jsx("div",{style:{marginTop:8},children:c.allowedTransitions.length===0?s.jsx("em",{style:{opacity:.7},children:"No actions allowed"}):c.allowedTransitions.map(p=>s.jsx(ac,{state:p},p))})]}),((d=t.sla)==null?void 0:d.length)>0&&s.jsxs(s.Fragment,{children:[s.jsx("h4",{children:"SLA Timers"}),t.sla.map(p=>s.jsx(xA,{sla:p},p.name))]}),s.jsx("h4",{children:"Workflow History"}),c.history.length===0?s.jsx("em",{children:"No workflow transitions recorded."}):s.jsx("ul",{className:"timeline",children:c.history.map((p,h)=>s.jsxs("li",{className:"timeline-item",style:{marginBottom:12},children:[s.jsx(ac,{state:p.state}),s.jsx("div",{style:{fontSize:13,opacity:.8},children:new Date(p.at).toLocaleString()}),s.jsxs("div",{style:{fontSize:13},children:["By: ",p.by||"system"]})]},h))}),(u==null?void 0:u.length)>0&&s.jsxs(s.Fragment,{children:[s.jsx("h4",{style:{marginTop:24},children:"Audit Trail"}),s.jsx("ul",{className:"timeline audit",children:u.map(p=>s.jsxs("li",{className:"timeline-item",style:{marginBottom:12},children:[s.jsx("strong",{children:p.action}),s.jsx("div",{style:{fontSize:13,opacity:.8},children:new Date(p.at).toLocaleString()}),s.jsxs("div",{style:{fontSize:13},children:["Role: ",p.actorRole]})]},p.id))})]})]})}function bA(){const{user:e}=Me(),[t,n]=g.useState([]),[r,i]=g.useState(!1),[a,o]=g.useState("");g.useEffect(()=>{e&&l()},[e]);async function l(){try{const d=await le("/api/billing/list");n(d||[])}catch{o("Failed to load transactions")}}async function c(d){var h,f,v;if(!((f=(h=d.workflow)==null?void 0:h.allowedTransitions)==null?void 0:f.includes("PAID"))){o("Payment not allowed at this stage");return}i(!0),o("");try{const j=await le("/api/payments/stripe/create-intent",{method:"POST",body:{amount:d.amount,transactionId:d._id}});o(`Stripe Payment Intent created.
Client Secret:
`+(((v=j==null?void 0:j.data)==null?void 0:v.clientSecret)||(j==null?void 0:j.clientSecret)||""))}catch(j){o(j.message)}finally{i(!1)}}async function u(d){var h,f;if(!((f=(h=d.workflow)==null?void 0:h.allowedTransitions)==null?void 0:f.includes("PAID"))){o("Payment not allowed at this stage");return}if(!d.phone){o("Missing phone number on transaction");return}i(!0),o("");try{const v=await le("/api/payments/mpesa/stk",{method:"POST",body:{amount:d.amount,phone:d.phone,transactionId:d._id}});o("M-Pesa STK Push sent. Await confirmation.")}catch(v){o(v.message)}finally{i(!1)}}return e?s.jsxs("div",{className:"card premium-card",children:[s.jsx("h2",{children:"Payments"}),a&&s.jsx("pre",{style:{background:"#f3f4f6",padding:12,whiteSpace:"pre-wrap"},children:a}),s.jsxs("table",{className:"table premium-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Patient"}),s.jsx("th",{children:"Amount"}),s.jsx("th",{children:"Status"}),s.jsx("th",{children:"Actions"}),s.jsx("th",{children:"Workflow"})]})}),s.jsx("tbody",{children:t.length?t.map(d=>{var h,f,v,j;const p=(f=(h=d.workflow)==null?void 0:h.allowedTransitions)==null?void 0:f.includes("PAID");return s.jsxs("tr",{children:[s.jsx("td",{children:((v=d.patient)==null?void 0:v.name)||""}),s.jsxs("td",{children:[d.amount," ",d.currency]}),s.jsx("td",{children:s.jsx(ac,{state:(j=d.workflow)==null?void 0:j.state})}),s.jsxs("td",{children:[s.jsx("button",{disabled:r||!p,onClick:()=>c(d),children:"Stripe"}),s.jsx("button",{disabled:r||!p,onClick:()=>u(d),style:{marginLeft:8},children:"M-Pesa"})]}),s.jsx("td",{style:{minWidth:280},children:s.jsx(jA,{encounterId:d.encounter})})]},d._id)}):s.jsx("tr",{children:s.jsx("td",{colSpan:"5",style:{textAlign:"center"},children:"No pending payments"})})})]})]}):s.jsx("div",{children:"Please log in"})}const Vc="http://localhost:5000";function wA(){const[e,t]=g.useState(100);async function n(){const a=await(await fetch(`${Vc}/payments/stripe/create-intent`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount:Number(e)})})).json();if(a.error){alert(a.error);return}alert("Client secret: "+a.clientSecret+`
(Use Stripe.js on frontend to complete payment)`)}async function r(){const a=await(await fetch(`${Vc}/payments/mpesa/stk`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount:Number(e),phone:"2547XXXXXXXX"})})).json();alert(JSON.stringify(a,null,2))}return s.jsxs("div",{children:[s.jsx("h2",{children:"Payments"}),s.jsxs("div",{children:[s.jsx("label",{children:"Amount: "}),s.jsx("input",{type:"number",value:e,onChange:i=>t(i.target.value)})]}),s.jsx("button",{onClick:n,children:"Pay with Stripe (create intent)"}),s.jsx("button",{onClick:r,children:"Pay with M-Pesa (STK push)"})]})}function qj(){const e=T_(),{user:t}=Me(),[n,r]=g.useState([]),[i,a]=g.useState("");g.useEffect(()=>{if(!(!e||!t))return e.emit("ai:join"),e.on("ai:status",l=>{r(c=>[...c,{from:"sys",text:l}])}),e.on("ai:chunk",l=>{r(c=>[...c,{from:"ai",text:l}])}),e.on("ai:done",l=>{r(c=>[...c,{from:"ai",text:JSON.stringify(l)}])}),e.on("disconnect",()=>{r(l=>[...l,{from:"sys",text:"Disconnected"}])}),()=>{e.off("ai:status"),e.off("ai:chunk"),e.off("ai:done")}},[e,t]);const o=()=>{!i.trim()||!e||(e.emit("ai:message",{type:"diagnose",symptoms:i}),r(l=>[...l,{from:"user",text:i}]),a(""))};return s.jsxs("div",{children:[s.jsx("div",{style:{maxHeight:320,overflowY:"auto",border:"1px solid #eee",padding:8},children:n.map((l,c)=>s.jsxs("div",{style:{margin:6,background:l.from==="ai"?"#eef":l.from==="user"?"#dfd":"#eee",padding:8,borderRadius:6},children:[s.jsxs("b",{children:[l.from,":"]})," ",l.text]},c))}),s.jsxs("div",{style:{marginTop:8,display:"flex",gap:8},children:[s.jsx("input",{value:i,onChange:l=>a(l.target.value),style:{flex:1},placeholder:"Describe symptoms..."}),s.jsx("button",{onClick:o,children:"Ask AI"})]})]})}function SA(){const{user:e}=Me(),t=localStorage.getItem("token");return s.jsxs("div",{className:"dashboard",children:[s.jsx("div",{className:"welcome-panel",children:s.jsxs("div",{children:[s.jsx("h2",{children:"Medical Assistant"}),s.jsxs("p",{className:"muted",children:["Real-time clinical assistant chat for ",(e==null?void 0:e.name)||"current user","."]})]})}),s.jsx("section",{className:"section",children:s.jsx("div",{className:"card",children:s.jsx(qj,{token:t})})})]})}async function EA(e){return le("/api/triage/classify",{method:"POST",body:{symptoms:e}})}async function NA(e){return le("/api/triage/classify",{method:"POST",body:{symptoms:e}})}async function _A(e){return le("/api/triage/transcribe",{method:"POST",body:{audioBase64:e}})}function AA(){const[e,t]=g.useState(""),[n,r]=g.useState(null),[i,a]=g.useState(!1),[o,l]=g.useState("");async function c(){if(e.trim()){a(!0),l("");try{const u=await NA(e.trim());r(u)}catch(u){l(u.message||"Failed to classify triage")}finally{a(!1)}}}return s.jsxs("div",{className:"dashboard",children:[s.jsx("div",{className:"welcome-panel",children:s.jsxs("div",{children:[s.jsx("h2",{children:"AI Triage"}),s.jsx("p",{className:"muted",children:"Submit symptom details to get a triage priority and guidance."})]})}),s.jsx("section",{className:"section",children:s.jsxs("div",{className:"card",children:[s.jsx("label",{children:"Symptoms / Case Summary"}),s.jsx("textarea",{rows:6,value:e,onChange:u=>t(u.target.value),placeholder:"e.g. chest pain for 2 hours, shortness of breath..."}),s.jsx("div",{className:"welcome-actions",children:s.jsx("button",{className:"btn-primary",onClick:c,disabled:i,children:i?"Analyzing...":"Run Triage"})}),o&&s.jsx("p",{className:"error-text",children:o})]})}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Triage Output"}),s.jsxs("div",{className:"card",children:[!n&&s.jsx("p",{className:"muted",children:"No triage result yet."}),n&&s.jsxs(s.Fragment,{children:[s.jsxs("p",{children:["Priority: ",s.jsx("strong",{children:n.priority||"unknown"})]}),s.jsx("pre",{style:{whiteSpace:"pre-wrap",margin:0},children:JSON.stringify(n.out||n,null,2)})]})]})]})]})}function CA(){const[e,t]=g.useState(""),[n,r]=g.useState(""),[i,a]=g.useState(!1),[o,l]=g.useState("");async function c(){if(e.trim()){a(!0),l("");try{const u=await _A(e.trim());r((u==null?void 0:u.text)||JSON.stringify(u,null,2))}catch(u){l(u.message||"Failed to transcribe audio")}finally{a(!1)}}}return s.jsxs("div",{className:"dashboard",children:[s.jsx("div",{className:"welcome-panel",children:s.jsxs("div",{children:[s.jsx("h2",{children:"Voice Dictation"}),s.jsx("p",{className:"muted",children:"Paste base64 audio payload to transcribe through your AI provider."})]})}),s.jsx("section",{className:"section",children:s.jsxs("div",{className:"card",children:[s.jsx("label",{children:"Audio (base64)"}),s.jsx("textarea",{rows:6,value:e,onChange:u=>t(u.target.value),placeholder:"Base64 audio payload"}),s.jsx("div",{className:"welcome-actions",children:s.jsx("button",{className:"btn-primary",onClick:c,disabled:i,children:i?"Transcribing...":"Transcribe"})}),o&&s.jsx("p",{className:"error-text",children:o})]})}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Transcript"}),s.jsx("div",{className:"card",children:n?s.jsx("pre",{style:{whiteSpace:"pre-wrap",margin:0},children:n}):s.jsx("p",{className:"muted",children:"No transcript yet."})})]})]})}function kA(){var h,f;const{settings:e}=mi(),[t,n]=g.useState(""),[r,i]=g.useState(""),[a,o]=g.useState(!1),[l,c]=g.useState(""),u=((h=e==null?void 0:e.ai)==null?void 0:h.name)||"NeuroEdge",d=((f=e==null?void 0:e.ai)==null?void 0:f.url)||"";async function p(){var v;if(t.trim()){o(!0),c("");try{const j=await EA(t.trim());i(((v=j==null?void 0:j.out)==null?void 0:v.text)||JSON.stringify((j==null?void 0:j.out)||j,null,2))}catch(j){c(j.message||"Failed to get AI response")}finally{o(!1)}}}return s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsxs("h2",{children:[u," Assistant"]}),s.jsx("p",{className:"muted",children:"Ask clinical support questions. Responses are logged through the backend."})]}),s.jsx("div",{className:"welcome-actions",children:d&&s.jsx("a",{className:"btn-secondary",href:d,target:"_blank",rel:"noreferrer",children:"Open Full AI Workspace"})})]}),s.jsx("section",{className:"section",children:s.jsxs("div",{className:"card",children:[s.jsx("label",{children:"Message"}),s.jsx("textarea",{rows:5,value:t,onChange:v=>n(v.target.value),placeholder:"Describe symptoms, context, or question"}),s.jsx("div",{className:"welcome-actions",children:s.jsx("button",{className:"btn-primary",onClick:p,disabled:a,children:a?"Thinking...":"Send"})}),l&&s.jsx("p",{className:"error-text",children:l})]})}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Response"}),s.jsx("div",{className:"card",children:r?s.jsx("pre",{style:{whiteSpace:"pre-wrap",margin:0},children:r}):s.jsx("p",{className:"muted",children:"No response yet."})})]})]})}const IA=async e=>{const t=new FormData;return t.append("file",e),(await ue.post("/api/ai/extract",t)).data};function RA(){const[e,t]=g.useState(null),[n,r]=g.useState(!1),[i,a]=g.useState(""),[o,l]=g.useState(null),c=async()=>{if(e){r(!0),a("");try{const u=await IA(e);l(u||null)}catch(u){a((u==null?void 0:u.message)||"Failed to extract document"),l(null)}finally{r(!1)}}};return s.jsxs("div",{className:"dashboard",children:[s.jsx("div",{className:"welcome-panel",children:s.jsxs("div",{children:[s.jsx("h2",{children:"NeuroEdge Extract"}),s.jsx("p",{className:"muted",children:"Upload PDF/text/image files to extract raw content and structured fields."})]})}),s.jsx("section",{className:"section",children:s.jsxs("div",{className:"card",children:[s.jsx("label",{children:"Upload file"}),s.jsx("input",{type:"file",accept:".pdf,.txt,.csv,.png,.jpg,.jpeg,.webp,.tiff,.bmp",onChange:u=>{var d;return t(((d=u.target.files)==null?void 0:d[0])||null)}}),s.jsx("div",{className:"welcome-actions",children:s.jsx("button",{className:"btn-primary",onClick:c,disabled:!e||n,children:n?"Extracting...":"Extract"})}),i&&s.jsx("p",{className:"error-text",children:i})]})}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Extraction Output"}),s.jsx("div",{className:"card",children:o?s.jsx("pre",{style:{whiteSpace:"pre-wrap",margin:0},children:JSON.stringify(o,null,2)}):s.jsx("p",{className:"muted",children:"No extraction result yet."})})]})]})}const TA=e=>e.startsWith("/api/")?e:`/api${e.startsWith("/")?"":"/"}${e}`,qe=async(e,t,n)=>({data:await le(TA(t),{method:e,body:n})}),OA=e=>qe("POST","/auth/login",e),PA=e=>qe("POST","/auth/register",e),LA=async()=>(localStorage.removeItem("token"),localStorage.removeItem("refreshToken"),localStorage.removeItem("user"),{ok:!0}),DA=()=>qe("GET","/auth/me"),MA=()=>qe("GET","/users"),UA=e=>qe("GET",`/users/${e}`),BA=(e,t)=>qe("PUT",`/users/${e}`,t),VA=e=>qe("DELETE",`/users/${e}`),$A=()=>qe("GET","/hospitals"),FA=e=>qe("GET",`/hospitals/${e}`),HA=e=>qe("POST","/hospitals",e),qA=(e,t)=>qe("PUT",`/hospitals/${e}`,t),zA=()=>qe("GET","/patients"),WA=e=>qe("GET",`/patients/${e}`),GA=e=>qe("POST","/patients",e),YA=(e,t)=>qe("PUT",`/patients/${e}`,t),KA=()=>qe("GET","/appointments"),JA=e=>qe("POST","/appointments",e),QA=(e,t)=>qe("PUT",`/appointments/${e}`,t),ZA=e=>qe("DELETE",`/appointments/${e}`),XA=()=>qe("GET","/labs"),e1=e=>qe("POST","/labs",e),t1=(e,t)=>qe("PUT",`/labs/${e}`,t),n1=()=>qe("GET","/financials"),r1=e=>qe("POST","/financials",e),s1=(e,t)=>qe("PUT",`/financials/${e}`,t),i1=()=>qe("GET","/transfers"),a1=e=>qe("POST","/transfers",e),o1=()=>qe("GET","/notifications"),l1=e=>qe("POST","/ai",e),c1=e=>qe("POST","/ml",e),u1=(e,t)=>qe("PATCH",e,t),is={login:OA,register:PA,logout:LA,getProfile:DA,getUsers:MA,getUserById:UA,updateUser:BA,deleteUser:VA,getHospitals:$A,getHospitalById:FA,createHospital:HA,updateHospital:qA,getPatients:zA,getPatientById:WA,createPatient:GA,updatePatient:YA,getAppointments:KA,createAppointment:JA,updateAppointment:QA,deleteAppointment:ZA,getLabTests:XA,createLabTest:e1,updateLabTest:t1,getFinancials:n1,createFinancial:r1,updateFinancial:s1,getTransfers:i1,createTransfer:a1,getNotifications:o1,runAI:l1,runML:c1,patch:u1};function d1(){const[e,t]=g.useState([]),[n,r]=g.useState({patient:"",doctor:"",scheduledAt:"",durationMins:30});g.useEffect(()=>i(),[]);const i=()=>is.get("/appointments").then(c=>{const u=c.data;t(Array.isArray(u)?u:Array.isArray(u==null?void 0:u.items)?u.items:[])}).catch(()=>{}),a=async()=>{if(!n.patient||!n.scheduledAt){alert("patient and date required");return}await is.post("/appointments",n),r({patient:"",doctor:"",scheduledAt:"",durationMins:30}),i()},o=async c=>{await is.delete("/appointments/"+c),i()},l=async c=>{await is.patch("/appointments/"+c,{status:"Completed"}),i()};return s.jsxs("div",{children:[s.jsx("h3",{children:"Appointments"}),s.jsxs("div",{style:{display:"flex",gap:12},children:[s.jsxs("div",{style:{flex:1},children:[s.jsx("input",{placeholder:"Patient ID",value:n.patient,onChange:c=>r({...n,patient:c.target.value})}),s.jsx("input",{placeholder:"Doctor ID",value:n.doctor,onChange:c=>r({...n,doctor:c.target.value})}),s.jsx("input",{type:"datetime-local",value:n.scheduledAt,onChange:c=>r({...n,scheduledAt:c.target.value})}),s.jsx("input",{type:"number",value:n.durationMins,onChange:c=>r({...n,durationMins:parseInt(c.target.value||30)})}),s.jsx("button",{onClick:a,children:"Create"})]}),s.jsx("div",{style:{flex:2},children:s.jsxs("table",{children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Patient"}),s.jsx("th",{children:"Doctor"}),s.jsx("th",{children:"When"}),s.jsx("th",{children:"Actions"})]})}),s.jsx("tbody",{children:e.map(c=>{var u,d;return s.jsxs("tr",{children:[s.jsx("td",{children:((u=c.patient)==null?void 0:u.firstName)||c.patient}),s.jsx("td",{children:((d=c.doctor)==null?void 0:d.name)||c.doctor}),s.jsx("td",{children:new Date(c.scheduledAt).toLocaleString()}),s.jsxs("td",{children:[s.jsx("button",{onClick:()=>l(c._id),children:"Complete"}),s.jsx("button",{onClick:()=>o(c._id),children:"Delete"})]})]},c._id)})})]})})]})]})}function Mn({title:e,subtitle:t,kpis:n=[],panels:r=[],actions:i=[]}){const a=Re();return s.jsxs("div",{className:"dashboard doctor-workspace",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:e}),s.jsx("p",{className:"muted",children:t})]}),s.jsx("div",{className:"welcome-actions",children:i.map(o=>s.jsx("button",{className:o.variant==="primary"?"btn-primary":"btn-secondary",onClick:()=>o.onClick?o.onClick(a):o.path?a(o.path):null,children:o.label},o.label))})]}),n.length>0&&s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Key Metrics"}),s.jsx("div",{className:"grid info-grid",children:n.map(o=>s.jsxs("div",{className:"card stat",children:[s.jsx("div",{className:"card-title",children:o.title}),s.jsx("div",{className:"card-value",children:o.value}),o.subtitle&&s.jsx("div",{className:"card-sub",children:o.subtitle})]},o.title))})]}),r.length>0&&s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Workspace"}),s.jsx("div",{className:"panel-grid",children:r.map(o=>s.jsxs("div",{className:"panel doctor-panel",children:[s.jsx("h4",{children:o.title}),s.jsx("p",{className:"muted",children:o.body})]},o.title))})]})]})}function h1(){return s.jsx(Mn,{title:"My Schedule",subtitle:"Daily, weekly and monthly clinical planning with shift overlays and surgery blocks.",actions:[{label:"Day View",variant:"primary"},{label:"Week View"},{label:"Month View"}],kpis:[{title:"Today Blocks",value:"Live"},{title:"Recurring Clinics",value:"Enabled"},{title:"Telemedicine",value:"Enabled"},{title:"Multi-Branch",value:"Ready"}],panels:[{title:"Calendar Grid",body:"Color-coded OPD, surgery, ward rounds and leave overlays."},{title:"Shift Overlay",body:"On-call and regular shift windows overlaid on appointments."},{title:"Reschedule",body:"Drag and reschedule with automatic conflict checks."},{title:"Surgery Blocks",body:"Reserve and manage procedure slots."}]})}function f1(){const e=Re(),[t,n]=g.useState(""),[r,i]=g.useState("ALL"),[a,o]=g.useState("ALL"),[l,c]=g.useState([]);g.useEffect(()=>{const d=t.trim(),p=d?`/api/patients?q=${encodeURIComponent(d)}&limit=100`:"/api/patients?limit=100";le(p).then(h=>{const f=Array.isArray(h==null?void 0:h.items)?h.items:Array.isArray(h)?h:[];c(f)}).catch(()=>c([]))},[t]);const u=g.useMemo(()=>l.filter(d=>{const p=String(d.status||"ACTIVE").toUpperCase(),h=String(d.riskLevel||"MEDIUM").toUpperCase();return(a==="ALL"||p===a)&&(r==="ALL"||h===r)}),[l,r,a]);return s.jsxs("div",{className:"dashboard doctor-workspace",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"My Patients"}),s.jsx("p",{className:"muted",children:"Search and manage inpatient, outpatient and follow-up cases."})]}),s.jsxs("div",{className:"welcome-actions",children:[s.jsx("input",{className:"search-input",placeholder:"Search patient name or ID",value:t,onChange:d=>n(d.target.value)}),s.jsxs("select",{value:a,onChange:d=>o(d.target.value),children:[s.jsx("option",{value:"ALL",children:"All Status"}),s.jsx("option",{value:"ACTIVE",children:"Active"}),s.jsx("option",{value:"CRITICAL",children:"Critical"}),s.jsx("option",{value:"FOLLOW_UP",children:"Follow-up"})]}),s.jsxs("select",{value:r,onChange:d=>i(d.target.value),children:[s.jsx("option",{value:"ALL",children:"All Risk"}),s.jsx("option",{value:"HIGH",children:"High"}),s.jsx("option",{value:"MEDIUM",children:"Medium"}),s.jsx("option",{value:"LOW",children:"Low"})]})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Patient Table"}),s.jsx("div",{className:"table-wrap",children:s.jsxs("table",{className:"doctor-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Patient ID"}),s.jsx("th",{children:"Name"}),s.jsx("th",{children:"Age"}),s.jsx("th",{children:"Diagnosis"}),s.jsx("th",{children:"Admission Type"}),s.jsx("th",{children:"Status"}),s.jsx("th",{children:"Risk Level"}),s.jsx("th",{children:"Last Visit"}),s.jsx("th",{children:"Actions"})]})}),s.jsxs("tbody",{children:[u.map(d=>{var p;return s.jsxs("tr",{children:[s.jsx("td",{children:d.nationalId||((p=d._id)==null?void 0:p.slice(-8))||"-"}),s.jsx("td",{children:[d.firstName,d.lastName].filter(Boolean).join(" ")||"-"}),s.jsx("td",{children:d.age??"-"}),s.jsx("td",{children:d.primaryDiagnosis||"-"}),s.jsx("td",{children:d.admissionType||"Outpatient"}),s.jsx("td",{children:d.status||"ACTIVE"}),s.jsx("td",{children:d.riskLevel||"MEDIUM"}),s.jsx("td",{children:d.updatedAt?new Date(d.updatedAt).toLocaleDateString():"-"}),s.jsx("td",{children:s.jsxs("div",{className:"doctor-actions-row",children:[s.jsx("button",{className:"btn-secondary",onClick:()=>e(`/doctor/medical-records?patientId=${d._id}`),children:"Open Record"}),s.jsx("button",{className:"btn-secondary",onClick:()=>e(`/doctor/reports-notes?patientId=${d._id}`),children:"Add Note"}),s.jsx("button",{className:"btn-secondary",onClick:()=>e(`/doctor/prescriptions?patientId=${d._id}`),children:"Prescribe"}),s.jsx("button",{className:"btn-secondary",onClick:()=>e(`/doctor/referrals?patientId=${d._id}`),children:"Refer"})]})})]},d._id)}),u.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:"9",className:"muted",children:"No patients found."})})]})]})})]})]})}function p1(){return s.jsx(Mn,{title:"OPD Clinic Workspace",subtitle:"Consultation screen for diagnosis, notes, coding, treatment and follow-up.",actions:[{label:"Open Consultation",variant:"primary"},{label:"Print Summary"},{label:"Send to Pharmacy"}],panels:[{title:"Patient Summary",body:"Vitals, allergies and insurance context."},{title:"Clinical Notes",body:"Auto-save notes editor with diagnosis and ICD coding."},{title:"Orders & Referrals",body:"Lab orders, prescriptions, specialist referrals and follow-up."},{title:"Consultation Actions",body:"Save & close, print summary and route to pharmacy."}]})}function m1(){return s.jsx(Mn,{title:"Inpatient Ward",subtitle:"Bed assignments, daily progress, medication chart visibility and discharge workflow.",actions:[{label:"Open Ward List",variant:"primary"},{label:"Generate Discharge"}],panels:[{title:"Assigned Beds",body:"Current inpatient allocation by ward and risk level."},{title:"Progress Notes",body:"Daily care progression and treatment milestones."},{title:"Nursing Notes",body:"Cross-functional clinical visibility with nurse inputs."},{title:"Mortality Review",body:"Outcome and review logs for governance."}]})}function g1(){return s.jsx(Mn,{title:"Surgery & Procedures",subtitle:"Pre-op to post-op documentation, checklists, outcomes and complications.",actions:[{label:"Open Surgery Calendar",variant:"primary"},{label:"Log Procedure"}],panels:[{title:"Surgery Calendar",body:"Procedure schedule by theater and team."},{title:"Pre-op Checklist",body:"Consent, readiness and anesthetic checks."},{title:"Procedure Notes",body:"Structured operative documentation."},{title:"Outcome Tracking",body:"Post-op outcomes and complication reports."}]})}function y1(){const[e,t]=g.useState([]);return g.useEffect(()=>{le("/api/lab",{method:"GET"}).then(n=>t(Array.isArray(n==null?void 0:n.items)?n.items:Array.isArray(n)?n:[])).catch(()=>t([]))},[]),s.jsxs("div",{className:"dashboard doctor-workspace",children:[s.jsx("div",{className:"welcome-panel",children:s.jsxs("div",{children:[s.jsx("h2",{children:"Lab Results"}),s.jsx("p",{className:"muted",children:"Pending, completed and abnormal results with signature workflow."})]})}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Result Queue"}),s.jsx("div",{className:"table-wrap",children:s.jsxs("table",{className:"doctor-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Encounter"}),s.jsx("th",{children:"Status"}),s.jsx("th",{children:"Updated"}),s.jsx("th",{children:"Action"})]})}),s.jsxs("tbody",{children:[e.map(n=>s.jsxs("tr",{children:[s.jsx("td",{children:n.encounter||"-"}),s.jsx("td",{children:n.status||"-"}),s.jsx("td",{children:n.updatedAt?new Date(n.updatedAt).toLocaleString():"-"}),s.jsx("td",{children:s.jsx("button",{className:"btn-secondary",children:"Open"})})]},n._id)),e.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:"4",className:"muted",children:"No lab results found."})})]})]})})]})]})}function v1(){return s.jsx(Mn,{title:"Prescriptions",subtitle:"Drug search, interaction warnings, dosage guidance and secure e-prescription export.",actions:[{label:"Create Prescription",variant:"primary"},{label:"Interaction Check"}],panels:[{title:"Medication Builder",body:"Search, dose, route, duration and refill controls."},{title:"Interaction Warnings",body:"Safety checks and allergy conflict alerts."},{title:"Controlled Drugs",body:"Controlled medication tracking and review logs."},{title:"Export",body:"Signed e-prescription output for pharmacy workflow."}]})}function x1(){return s.jsx(Mn,{title:"Medical Records",subtitle:"Longitudinal patient history across visits, surgeries, labs, radiology and attachments.",actions:[{label:"Open Patient Timeline",variant:"primary"},{label:"Upload Attachment"}],panels:[{title:"Visit History",body:"Past consultations and clinical notes timeline."},{title:"Clinical History",body:"Surgeries, immunizations and chronic history."},{title:"Diagnostics",body:"Lab and radiology history with trend support."},{title:"Attachments",body:"Secure PDFs and imaging artifacts."}]})}function j1(){return s.jsx(Mn,{title:"Referrals",subtitle:"Internal and external referrals with specialist transfer status tracking.",actions:[{label:"New Internal Referral",variant:"primary"},{label:"New External Referral"}],panels:[{title:"Internal Referrals",body:"Intra-hospital specialist handoffs."},{title:"External Referrals",body:"Cross-facility referral generation and tracking."},{title:"Transfer Status",body:"Pending, accepted, completed and declined states."}]})}function b1(){return s.jsx(Mn,{title:"Performance",subtitle:"Operational and quality indicators aligned with HR performance evaluation.",actions:[{label:"View Monthly KPIs",variant:"primary"},{label:"Export Metrics"}],kpis:[{title:"Patient Load",value:"Live"},{title:"Surgery Count",value:"Live"},{title:"Complication Rate",value:"Live"},{title:"Attendance",value:"Live"},{title:"Overtime",value:"Live"},{title:"Leave Balance",value:"Live"}],panels:[{title:"Clinical Outcomes",body:"Outcome and complication trend snapshots."},{title:"Experience",body:"Patient satisfaction and service metrics."}]})}function w1(){return s.jsx(Mn,{title:"CME & Certifications",subtitle:"License expiry, CME tracking, certificate vault and compliance reminders.",actions:[{label:"Upload Certificate",variant:"primary"},{label:"View Training Calendar"}],panels:[{title:"License Status",body:"License number and expiry countdown."},{title:"CME Credits",body:"Credits earned and upcoming requirement targets."},{title:"Compliance Alerts",body:"Expiring credentials and mandatory training reminders."}]})}function S1(){const e=Re();return s.jsx(Mn,{title:"Leave Requests",subtitle:"Manage leave balance, request submissions, approvals and shift impact.",actions:[{label:"Open My Requests",variant:"primary",onClick:()=>e("/workforce/requests#leave")},{label:"Request Overtime",onClick:()=>e("/workforce/requests#overtime")},{label:"Request Shift",onClick:()=>e("/workforce/requests#shift")}],panels:[{title:"Leave Balance",body:"Current available leave and planned allocations."},{title:"Approval Status",body:"Pending, approved and rejected history."},{title:"Shift Impact",body:"Coverage and continuity preview before submission."}]})}function E1(){return s.jsx(Mn,{title:"Reports & Notes",subtitle:"Case archive, research notes, exports and publication tracking.",actions:[{label:"Open Reports",variant:"primary",path:"/reports"},{label:"New Note"}],panels:[{title:"Case Notes",body:"Structured archive of clinical notes."},{title:"Research Notes",body:"Research and academic note workspace."},{title:"Exports",body:"Downloadable report and performance data exports."}]})}function N1(){return s.jsx(Mn,{title:"Doctor Settings",subtitle:"Profile, availability, notifications, signature and account security controls.",actions:[{label:"Open Profile",variant:"primary",path:"/profile"},{label:"Notification Preferences"}],panels:[{title:"Availability",body:"Clinic windows and scheduling preferences."},{title:"Digital Signature",body:"Upload and manage document signature identity."},{title:"Security",body:"2FA, session and account protection options."},{title:"Theme",body:"Light, dark and system display mode preferences."}]})}function zj(){const[e,t]=g.useState([]),[n,r]=g.useState({patient:"",testType:""});g.useEffect(()=>i(),[]);const i=()=>is.get("/labs").then(c=>t(c.data)).catch(()=>{}),a=async()=>{if(!n.patient||!n.testType)return alert("patient and test required");await is.post("/labs",n),r({patient:"",testType:""}),i()},o=async c=>{const u={values:{Hb:10+Math.round(Math.random()*5),WBC:5+Math.round(Math.random()*8)}};await is.post("/labs/"+c+"/result",{result:u,status:"Completed"}),i()},l=async c=>{await is.delete("/labs/"+c),i()};return s.jsxs("div",{children:[s.jsx("h3",{children:"Lab Tests"}),s.jsxs("div",{style:{display:"flex",gap:12},children:[s.jsxs("div",{style:{flex:1},children:[s.jsx("input",{placeholder:"Patient ID",value:n.patient,onChange:c=>r({...n,patient:c.target.value})}),s.jsx("input",{placeholder:"Test type",value:n.testType,onChange:c=>r({...n,testType:c.target.value})}),s.jsx("button",{onClick:a,children:"Order"})]}),s.jsx("div",{style:{flex:2},children:s.jsxs("table",{children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Patient"}),s.jsx("th",{children:"Test"}),s.jsx("th",{children:"Status"}),s.jsx("th",{children:"Actions"})]})}),s.jsx("tbody",{children:e.map(c=>{var u;return s.jsxs("tr",{children:[s.jsx("td",{children:((u=c.patient)==null?void 0:u.firstName)||c.patient}),s.jsx("td",{children:c.testType}),s.jsx("td",{children:c.status}),s.jsxs("td",{children:[s.jsx("button",{onClick:()=>o(c._id),children:"Upload Result"}),s.jsx("button",{onClick:()=>l(c._id),children:"Delete"})]})]},c._id)})})]})})]})]})}function rt({title:e,subtitle:t,actions:n=[],kpis:r=[],panels:i=[],children:a}){const o=Re();return s.jsxs("div",{className:"dashboard doctor-workspace",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:e}),s.jsx("p",{className:"muted",children:t})]}),s.jsx("div",{className:"welcome-actions",children:n.map(l=>s.jsx("button",{className:l.variant==="primary"?"btn-primary":"btn-secondary",onClick:()=>l.onClick?l.onClick(o):l.path?o(l.path):null,children:l.label},l.label))})]}),r.length>0&&s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Summary"}),s.jsx("div",{className:"grid info-grid",children:r.map(l=>s.jsxs("div",{className:"card stat",children:[s.jsx("div",{className:"card-title",children:l.title}),s.jsx("div",{className:"card-value",children:l.value}),l.subtitle&&s.jsx("div",{className:"card-sub",children:l.subtitle})]},l.title))})]}),i.length>0&&s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Workspace"}),s.jsx("div",{className:"panel-grid",children:i.map(l=>s.jsxs("div",{className:"panel doctor-panel",children:[s.jsx("h4",{children:l.title}),s.jsx("p",{className:"muted",children:l.body})]},l.title))})]}),a]})}function _1(){return s.jsx(rt,{title:"My Shift",subtitle:"Current shift details, handover notes and real-time ward responsibilities.",actions:[{label:"Start Round",variant:"primary"},{label:"Handover Notes"}],panels:[{title:"Shift Window",body:"Current shift block and assigned zone."},{title:"Handover",body:"Incoming and outgoing shift notes."},{title:"Coverage",body:"Staff coverage snapshot for your unit."}]})}function A1(){const[e,t]=g.useState([]);return g.useEffect(()=>{le("/api/patients?limit=50").then(n=>t(Array.isArray(n==null?void 0:n.items)?n.items:[])).catch(()=>t([]))},[]),s.jsxs("div",{className:"dashboard doctor-workspace",children:[s.jsx("div",{className:"welcome-panel",children:s.jsxs("div",{children:[s.jsx("h2",{children:"Assigned Patients"}),s.jsx("p",{className:"muted",children:"Patient list with quick actions for bedside workflow."})]})}),s.jsx("section",{className:"section",children:s.jsx("div",{className:"table-wrap",children:s.jsxs("table",{className:"doctor-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Name"}),s.jsx("th",{children:"Ward"}),s.jsx("th",{children:"Status"}),s.jsx("th",{children:"Risk"}),s.jsx("th",{children:"Action"})]})}),s.jsxs("tbody",{children:[e.map(n=>s.jsxs("tr",{children:[s.jsx("td",{children:[n.firstName,n.lastName].filter(Boolean).join(" ")||"-"}),s.jsx("td",{children:n.ward||"-"}),s.jsx("td",{children:n.status||"ACTIVE"}),s.jsx("td",{children:n.riskLevel||"MEDIUM"}),s.jsx("td",{children:s.jsx("button",{className:"btn-secondary",children:"Open"})})]},n._id)),e.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:"5",className:"muted",children:"No assigned patients found."})})]})]})})})]})}function C1(){return s.jsx(rt,{title:"Medication Administration",subtitle:"Due medications, verification checks and administration logs.",actions:[{label:"Open MAR",variant:"primary"},{label:"Drug Interaction Check"}],panels:[{title:"Due Medications",body:"Upcoming medication tasks by time."},{title:"Verification",body:"Patient, dose and route verification controls."},{title:"Administration Log",body:"Time-stamped medication administration records."}]})}function k1(){return s.jsx(rt,{title:"Incident Reports",subtitle:"Create, track and escalate safety incidents from nursing operations.",actions:[{label:"New Incident",variant:"primary"},{label:"Open Incident Queue"}],panels:[{title:"Quick Form",body:"Capture severity, event details and affected patient."},{title:"Escalations",body:"High-risk cases routed to security/admin."},{title:"History",body:"Review previously filed incidents and status."}]})}function I1(){return s.jsx(rt,{title:"Vitals Entry",subtitle:"Record patient vitals and flag abnormal trends for review.",actions:[{label:"New Vitals Record",variant:"primary"},{label:"Trend View"}],panels:[{title:"Vitals Form",body:"BP, pulse, temperature, SpO2 and pain scale inputs."},{title:"Trend Graphs",body:"Historical progression for quick deterioration detection."},{title:"Alerts",body:"Abnormal values push real-time alerts to care team."}]})}function R1(){return s.jsx(rt,{title:"Leave Requests",subtitle:"Leave balance, submission workflow and shift coverage impact preview.",actions:[{label:"Request Leave",variant:"primary",path:"/workforce/requests#leave"},{label:"Request Overtime",path:"/workforce/requests#overtime"}],panels:[{title:"Balance",body:"Current leave and carry-over totals."},{title:"Request History",body:"Approved, rejected and pending requests."},{title:"Coverage",body:"Shift impact preview before submit."}]})}function T1(){return s.jsx(rt,{title:"Performance",subtitle:"Attendance, task completion and supervisor feedback metrics.",kpis:[{title:"Attendance",value:"Live"},{title:"Task Completion",value:"Live"},{title:"Supervisor Feedback",value:"Live"}],panels:[{title:"Shift Score",body:"Shift punctuality and completion summary."},{title:"Care Quality",body:"Clinical task quality and incident ratio."}]})}function O1(){return s.jsx(zj,{})}function P1(){return s.jsx(rt,{title:"Equipment Logs",subtitle:"Track machine uptime, calibration and maintenance events.",actions:[{label:"New Log",variant:"primary"},{label:"Maintenance Calendar"}],panels:[{title:"Uptime",body:"Device uptime and downtime events."},{title:"Calibration",body:"Calibration due dates and completion records."},{title:"Maintenance",body:"Scheduled and emergency maintenance logs."}]})}function L1(){return s.jsx(rt,{title:"Sample Tracking",subtitle:"Monitor sample lifecycle from collection to result release.",actions:[{label:"Track Sample",variant:"primary"},{label:"Flag Delay"}],panels:[{title:"Collection",body:"Collected sample inventory and timestamps."},{title:"Processing",body:"In-lab progress state and queue slot."},{title:"Release",body:"Result-ready and signed-off status."}]})}function D1(){return s.jsx(rt,{title:"Quality Control",subtitle:"QC runs, deviations and corrective action tracking.",actions:[{label:"Run QC",variant:"primary"},{label:"Deviation Log"}],panels:[{title:"QC Runs",body:"Daily and batch QC checkpoints."},{title:"Deviations",body:"Abnormal QC outcomes and escalation."},{title:"Corrective Actions",body:"Action ownership and closure tracking."}]})}function M1(){return s.jsx(rt,{title:"Safety Checklist",subtitle:"Lab biosafety compliance checks and hazard readiness.",actions:[{label:"Start Checklist",variant:"primary"},{label:"Report Hazard"}],panels:[{title:"PPE",body:"Protective gear compliance checks."},{title:"Biohazard",body:"Containment and disposal controls."},{title:"Safety Audits",body:"Audit history and corrective tasks."}]})}function U1(){return s.jsx(rt,{title:"Reports Archive",subtitle:"Historical lab reports and export-ready records.",actions:[{label:"Open Reports",variant:"primary",path:"/reports"},{label:"Export Archive"}],panels:[{title:"Completed Reports",body:"Finalized reports by date and type."},{title:"Urgent Flags",body:"Priority report history and turnaround."}]})}function B1(){return s.jsx(rt,{title:"Prescription Queue",subtitle:"Pending and active prescriptions awaiting dispensing workflow.",actions:[{label:"Open Queue",variant:"primary"},{label:"Verify Interactions"}],panels:[{title:"Pending",body:"Newly created prescriptions awaiting validation."},{title:"In Progress",body:"Prescriptions currently being dispensed."},{title:"Completed",body:"Dispensed and closed prescriptions."}]})}function V1(){const e=Re();return s.jsx(rt,{title:"Inventory",subtitle:"Stock visibility, reorder thresholds and replenishment management.",actions:[{label:"Open Inventory",variant:"primary",onClick:()=>e("/inventory")},{label:"Reorder Planner"}],panels:[{title:"Stock Levels",body:"Current quantity by item and category."},{title:"Low Stock",body:"Items below configured safety threshold."},{title:"Reorder",body:"Supplier reorder planning and execution."}]})}function $1(){return s.jsx(rt,{title:"Controlled Drugs",subtitle:"Controlled medication ledger, issue/return logs and compliance checks.",actions:[{label:"Open Controlled Log",variant:"primary"},{label:"Audit Export"}],panels:[{title:"Dispense Log",body:"Controlled drug issue records."},{title:"Stock Checks",body:"Count reconciliation and discrepancy flags."},{title:"Compliance",body:"Regulatory controls and audit artifacts."}]})}function F1(){return s.jsx(rt,{title:"Expiry Alerts",subtitle:"Medication expiry surveillance and near-expiry action workflow.",actions:[{label:"Review Alerts",variant:"primary"},{label:"Quarantine Batch"}],panels:[{title:"Near Expiry",body:"Batches approaching expiry."},{title:"Expired",body:"Expired items requiring disposal records."},{title:"Actions",body:"Return, quarantine and replacement actions."}]})}function H1(){return s.jsx(rt,{title:"Supplier Orders",subtitle:"Purchase order workflow, supplier lead times and delivery tracking.",actions:[{label:"Create PO",variant:"primary"},{label:"Track Deliveries"}],panels:[{title:"Open Orders",body:"Purchase orders awaiting fulfillment."},{title:"Deliveries",body:"Incoming shipment and receiving logs."},{title:"Supplier Performance",body:"Lead-time and reliability metrics."}]})}function q1(){return s.jsx(rt,{title:"Pharmacy Reports",subtitle:"Dispense volumes, controlled logs and inventory audit reports.",actions:[{label:"Open Reports",variant:"primary",path:"/reports"},{label:"Export CSV"}],panels:[{title:"Dispense Trends",body:"Daily and monthly dispensing analysis."},{title:"Controlled Audit",body:"Controlled drug variance and audit trail."},{title:"Inventory Reports",body:"Consumption and procurement reports."}]})}function z1(){return s.jsx(rt,{title:"My Appointments",subtitle:"Upcoming, completed and rescheduled appointment history.",actions:[{label:"Book Appointment",variant:"primary"},{label:"Reschedule"}],panels:[{title:"Upcoming",body:"Upcoming appointments and reminders."},{title:"History",body:"Completed visit history timeline."},{title:"Follow-up",body:"Required follow-up and action items."}]})}function W1(){return s.jsx(rt,{title:"Medical Records",subtitle:"Personal longitudinal records across visits, procedures, labs and files.",actions:[{label:"Open Timeline",variant:"primary"},{label:"Download Record"}],panels:[{title:"Visits",body:"Consultation and admission history."},{title:"Procedures",body:"Procedure and treatment history."},{title:"Attachments",body:"Uploaded reports and supporting documents."}]})}function G1(){return s.jsx(rt,{title:"Prescriptions",subtitle:"Active and historical prescriptions with refill and dosage guidance.",actions:[{label:"Active Prescriptions",variant:"primary"},{label:"Refill Request"}],panels:[{title:"Current Meds",body:"Currently active medications and dosage."},{title:"History",body:"Historical prescription records."},{title:"Refills",body:"Refill workflow and status tracking."}]})}function Y1(){return s.jsx(rt,{title:"Lab Results",subtitle:"View completed labs, flagged values and trend history.",actions:[{label:"View Results",variant:"primary"},{label:"Download PDF"}],panels:[{title:"Completed",body:"Completed test result archive."},{title:"Flagged",body:"Abnormal values requiring review."},{title:"Trends",body:"Historic result trends over time."}]})}function K1(){return s.jsx(rt,{title:"Billing",subtitle:"Invoices, outstanding balances, receipts and payment history.",actions:[{label:"Open Payments",variant:"primary",path:"/payments"},{label:"Download Receipt"}],panels:[{title:"Outstanding",body:"Pending invoices and due dates."},{title:"Paid",body:"Paid invoices and transaction history."},{title:"Receipts",body:"Receipt archive and exports."}]})}function J1(){return s.jsx(rt,{title:"Insurance",subtitle:"Coverage details, authorization status and claim references.",actions:[{label:"View Coverage",variant:"primary"},{label:"Claims History"}],panels:[{title:"Coverage",body:"Policy and coverage summary."},{title:"Authorizations",body:"Encounter authorization status."},{title:"Claims",body:"Claim outcomes and references."}]})}function Q1(){return s.jsx(rt,{title:"Feedback",subtitle:"Submit service feedback and track responses.",actions:[{label:"Submit Feedback",variant:"primary"},{label:"View Responses"}],panels:[{title:"New Feedback",body:"Capture care and service feedback."},{title:"History",body:"Past submissions and status."},{title:"Messages",body:"Response thread from support teams."}]})}function Z1(){const[e,t]=g.useState("hospital-a"),[n,r]=g.useState(""),[i,a]=g.useState(""),[o,l]=g.useState(null);async function c(){const p=await(await fetch(`${Vc}/webhooks/${e}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({hl7:n})})).json();l(p)}async function u(){let d={};try{d=JSON.parse(i)}catch{alert("Invalid JSON");return}const h=await(await fetch(`${Vc}/webhooks/${e}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({resource:d})})).json();l(h)}return s.jsxs("div",{children:[s.jsx("h2",{children:"Real-Time Integrations (Webhooks)"}),s.jsxs("div",{style:{display:"flex",gap:12},children:[s.jsxs("div",{style:{flex:1},children:[s.jsx("h4",{children:"Send HL7 Message"}),s.jsx("input",{value:e,onChange:d=>t(d.target.value)}),s.jsx("textarea",{value:n,onChange:d=>r(d.target.value),rows:8,style:{width:"100%"},placeholder:"Paste raw HL7 message here (\\r delimited)"}),s.jsx("button",{onClick:c,children:"Send HL7"})]}),s.jsxs("div",{style:{flex:1},children:[s.jsx("h4",{children:"Send FHIR Patient Resource"}),s.jsx("textarea",{value:i,onChange:d=>a(d.target.value),rows:8,style:{width:"100%"},placeholder:"Paste FHIR Patient JSON here"}),s.jsx("button",{onClick:u,children:"Send FHIR"})]})]}),s.jsxs("div",{style:{marginTop:12},children:[s.jsx("h4",{children:"Response"}),s.jsx("pre",{children:JSON.stringify(o,null,2)})]})]})}var Wj={exports:{}},Ph={exports:{}},Cg=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof window.msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto);if(Cg){var kg=new Uint8Array(16);Ph.exports=function(){return Cg(kg),kg}}else{var Ig=new Array(16);Ph.exports=function(){for(var t=0,n;t<16;t++)t&3||(n=Math.random()*4294967296),Ig[t]=n>>>((t&3)<<3)&255;return Ig}}var Gj=Ph.exports,Yj=[];for(var Tl=0;Tl<256;++Tl)Yj[Tl]=(Tl+256).toString(16).substr(1);function X1(e,t){var n=t||0,r=Yj;return[r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]]].join("")}var Kj=X1,eC=Gj,tC=Kj,Rg,id,ad=0,od=0;function nC(e,t,n){var r=t&&n||0,i=t||[];e=e||{};var a=e.node||Rg,o=e.clockseq!==void 0?e.clockseq:id;if(a==null||o==null){var l=eC();a==null&&(a=Rg=[l[0]|1,l[1],l[2],l[3],l[4],l[5]]),o==null&&(o=id=(l[6]<<8|l[7])&16383)}var c=e.msecs!==void 0?e.msecs:new Date().getTime(),u=e.nsecs!==void 0?e.nsecs:od+1,d=c-ad+(u-od)/1e4;if(d<0&&e.clockseq===void 0&&(o=o+1&16383),(d<0||c>ad)&&e.nsecs===void 0&&(u=0),u>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");ad=c,od=u,id=o,c+=122192928e5;var p=((c&268435455)*1e4+u)%4294967296;i[r++]=p>>>24&255,i[r++]=p>>>16&255,i[r++]=p>>>8&255,i[r++]=p&255;var h=c/4294967296*1e4&268435455;i[r++]=h>>>8&255,i[r++]=h&255,i[r++]=h>>>24&15|16,i[r++]=h>>>16&255,i[r++]=o>>>8|128,i[r++]=o&255;for(var f=0;f<6;++f)i[r+f]=a[f];return t||tC(i)}var rC=nC,sC=Gj,iC=Kj;function aC(e,t,n){var r=t&&n||0;typeof e=="string"&&(t=e==="binary"?new Array(16):null,e=null),e=e||{};var i=e.random||(e.rng||sC)();if(i[6]=i[6]&15|64,i[8]=i[8]&63|128,t)for(var a=0;a<16;++a)t[r+a]=i[a];return t||iC(i)}var oC=aC,lC=rC,Jj=oC,gp=Jj;gp.v1=lC;gp.v4=Jj;var cC=gp;const{v4:uC}=cC;function Qj(){return uC().replace(/-/g,"")}let yp=Qj;function vp(){return yp()}vp.setFactory=e=>{yp=e};vp.reset=()=>{yp=Qj};var xp=vp;const dC=Symbol("_options"),hC=Symbol("_cache"),fC=Symbol("_state"),pC=Symbol("_objectId"),mC=Symbol("_conflicts"),gC=Symbol("_change"),yC=Symbol("_elemIds");var As={OPTIONS:dC,CACHE:hC,STATE:fC,OBJECT_ID:pC,CONFLICTS:mC,CHANGE:gC,ELEM_IDS:yC};function Zj(e){return typeof e=="object"&&e!==null}function vC(e){if(!Zj(e))return{};let t={};for(let n of Object.keys(e))t[n]=e[n];return t}function xC(e){const t=/^(\d+)@(.*)$/.exec(e||"");if(!t)throw new RangeError(`Not a valid opId: ${e}`);return{counter:parseInt(t[1],10),actorId:t[2]}}function jC(e,t){if(!(e instanceof Uint8Array)||!(t instanceof Uint8Array))throw new TypeError("equalBytes can only compare Uint8Arrays");if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.byteLength;n++)if(e[n]!==t[n])return!1;return!0}function bC(e){const t=new Array(e);for(let n=0;n<e;n++)t[n]=null;return t}var xr={isObject:Zj,copyObject:vC,parseOpId:xC,equalBytes:jC,createArrayOfNulls:bC};const{OBJECT_ID:qs}=As,{isObject:wC}=xr;let jp=class{constructor(t){if(typeof t=="string"){const n=[...t].map(r=>({value:r}));return ro(void 0,n)}else if(Array.isArray(t)){const n=t.map(r=>({value:r}));return ro(void 0,n)}else{if(t===void 0)return ro(void 0,[]);throw new TypeError(`Unsupported initial value for Text: ${t}`)}}get length(){return this.elems.length}get(t){const n=this.elems[t].value;if(this.context&&wC(n)){const r=n[qs],i=this.path.concat([{key:t,objectId:r}]);return this.context.instantiateObject(i,r)}else return n}getElemId(t){return this.elems[t].elemId}[Symbol.iterator](){let t=this.elems,n=-1;return{next(){return n+=1,n<t.length?{done:!1,value:t[n].value}:{done:!0}}}}toString(){let t="";for(const n of this.elems)typeof n.value=="string"&&(t+=n.value);return t}toSpans(){let t=[],n="";for(const r of this.elems)typeof r.value=="string"?n+=r.value:(n.length>0&&(t.push(n),n=""),t.push(r.value));return n.length>0&&t.push(n),t}toJSON(){return this.toString()}getWriteable(t,n){if(!this[qs])throw new RangeError("getWriteable() requires the objectId to be set");const r=ro(this[qs],this.elems);return r.context=t,r.path=n,r}set(t,n){if(this.context)this.context.setListIndex(this.path,t,n);else if(!this[qs])this.elems[t].value=n;else throw new TypeError("Automerge.Text object cannot be modified outside of a change block");return this}insertAt(t,...n){if(this.context)this.context.splice(this.path,t,0,n);else if(!this[qs])this.elems.splice(t,0,...n.map(r=>({value:r})));else throw new TypeError("Automerge.Text object cannot be modified outside of a change block");return this}deleteAt(t,n=1){if(this.context)this.context.splice(this.path,t,n,[]);else if(!this[qs])this.elems.splice(t,n);else throw new TypeError("Automerge.Text object cannot be modified outside of a change block");return this}};for(let e of["concat","every","filter","find","findIndex","forEach","includes","indexOf","join","lastIndexOf","map","reduce","reduceRight","slice","some","toLocaleString"])jp.prototype[e]=function(...t){return[...this][e](...t)};function ro(e,t){const n=Object.create(jp.prototype);return n[qs]=e,n.elems=t,n}var mu={Text:jp,instantiateText:ro};const{OBJECT_ID:zs,CONFLICTS:SC}=As,{isObject:$c,copyObject:Tg}=xr;function ld(e,t,n){for(let r of e)if(t[r]!==n[r]){if(typeof t[r]=="number"&&typeof n[r]=="number")return t[r]-n[r];{const i=""+t[r],a=""+n[r];if(i===a)continue;return i<a?-1:1}}return 0}let bp=class{constructor(){this.entries=Object.freeze({}),this.opIds=Object.freeze({}),Object.freeze(this)}byId(t){return this.entries[t]}get ids(){return Object.keys(this.entries).filter(t=>{const n=this.entries[t];return $c(n)&&n.id===t})}get count(){return this.ids.length}get rows(){return this.ids.map(t=>this.byId(t))}filter(t,n){return this.rows.filter(t,n)}find(t,n){return this.rows.find(t,n)}map(t,n){return this.rows.map(t,n)}sort(t){if(typeof t=="function")return this.rows.sort(t);if(typeof t=="string")return this.rows.sort((n,r)=>ld([t],n,r));if(Array.isArray(t))return this.rows.sort((n,r)=>ld(t,n,r));if(t===void 0)return this.rows.sort((n,r)=>ld(["id"],n,r));throw new TypeError(`Unsupported sorting argument: ${t}`)}[Symbol.iterator](){let t=this.rows,n=-1;return{next(){return n+=1,n<t.length?{done:!1,value:t[n]}:{done:!0}}}}_clone(){if(!this[zs])throw new RangeError("clone() requires the objectId to be set");return Xj(this[zs],Tg(this.entries),Tg(this.opIds))}_set(t,n,r){if(Object.isFrozen(this.entries))throw new Error("A table can only be modified in a change function");$c(n)&&!Array.isArray(n)&&Object.defineProperty(n,"id",{value:t,enumerable:!0}),this.entries[t]=n,this.opIds[t]=r}remove(t){if(Object.isFrozen(this.entries))throw new Error("A table can only be modified in a change function");delete this.entries[t],delete this.opIds[t]}_freeze(){Object.freeze(this.entries),Object.freeze(this.opIds),Object.freeze(this)}getWriteable(t,n){if(!this[zs])throw new RangeError("getWriteable() requires the objectId to be set");const r=Object.create(EC.prototype);return r[zs]=this[zs],r.context=t,r.entries=this.entries,r.opIds=this.opIds,r.path=n,r}toJSON(){const t={};for(let n of this.ids)t[n]=this.byId(n);return t}};class EC extends bp{byId(t){if($c(this.entries[t])&&this.entries[t].id===t){const n=this.entries[t][zs],r=this.path.concat([{key:t,objectId:n}]);return this.context.instantiateObject(r,n,["id"])}}add(t){return this.context.addTableRow(this.path,t)}remove(t){if($c(this.entries[t])&&this.entries[t].id===t)this.context.deleteTableRow(this.path,t,this.opIds[t]);else throw new RangeError(`There is no row with ID ${t} in this table`)}}function Xj(e,t,n){const r=Object.create(bp.prototype);if(!e)throw new RangeError("instantiateTable requires an objectId to be given");return r[zs]=e,r[SC]=Object.freeze({}),r.entries=t||{},r.opIds=n||{},r}var gu={Table:bp,instantiateTable:Xj};let eb=class{constructor(t){this.value=t||0,Object.freeze(this)}valueOf(){return this.value}toString(){return this.valueOf().toString()}toJSON(){return this.value}};class NC extends eb{increment(t){return t=typeof t=="number"?t:1,this.context.increment(this.path,this.key,t),this.value+=t,this.value}decrement(t){return this.increment(typeof t=="number"?-t:-1)}}function _C(e,t,n,r,i){const a=Object.create(NC.prototype);return a.value=e,a.context=t,a.path=n,a.objectId=r,a.key=i,a}var wp={Counter:eb,getWriteableCounter:_C};const{isObject:AC,copyObject:Og,parseOpId:Fc}=xr,{OBJECT_ID:Ho,CONFLICTS:ni,ELEM_IDS:oc}=As,{instantiateText:CC}=mu,{instantiateTable:kC}=gu,{Counter:IC}=wp;function Mr(e,t,n){return e.objectId?(t&&t[Ho]!==e.objectId&&(t=void 0),nb(e,t,n)):e.datatype==="timestamp"?new Date(e.value):e.datatype==="counter"?new IC(e.value):e.value}function RC(e,t){const n=/^(\d+)@(.*)$/,r=n.test(e)?Fc(e):{counter:0,actorId:e},i=n.test(t)?Fc(t):{counter:0,actorId:t};return r.counter<i.counter?-1:r.counter>i.counter?1:r.actorId<i.actorId?-1:r.actorId>i.actorId?1:0}function TC(e,t,n,r){if(e)for(let i of Object.keys(e)){const a={},o=Object.keys(e[i]).sort(RC).reverse();for(let l of o){const c=e[i][l];n[i]&&n[i][l]?a[l]=Mr(c,n[i][l],r):a[l]=Mr(c,void 0,r)}o.length===0?(delete t[i],delete n[i]):(t[i]=a[o[0]],n[i]=a)}}function tb(e,t){const n=Og(e),r=Og(e?e[ni]:void 0);return Object.defineProperty(n,Ho,{value:t}),Object.defineProperty(n,ni,{value:r}),n}function OC(e,t,n){const r=e.objectId;n[r]||(n[r]=tb(t,r));const i=n[r];return TC(e.props,i,i[ni],n),i}function PC(e,t,n){const r=e.objectId;n[r]||(n[r]=t?t._clone():kC(r));const i=n[r];for(let a of Object.keys(e.props||{})){const o=Object.keys(e.props[a]);if(o.length===0)i.remove(a);else if(o.length===1){const l=e.props[a][o[0]];i._set(a,Mr(l,i.byId(a),n),o[0])}else throw new RangeError("Conflicts are not supported on properties of a table")}return i}function LC(e,t){const n=e?e.slice():[],r=e&&e[ni]?e[ni].slice():[],i=e&&e[oc]?e[oc].slice():[];return Object.defineProperty(n,Ho,{value:t}),Object.defineProperty(n,ni,{value:r}),Object.defineProperty(n,oc,{value:i}),n}function DC(e,t,n){const r=e.objectId;n[r]||(n[r]=LC(t,r));const i=n[r],a=i[ni],o=i[oc];for(let l=0;l<e.edits.length;l++){const c=e.edits[l];if(c.action==="insert"||c.action==="update"){const u=a[c.index]&&a[c.index][c.opId];let d=Mr(c.value,u,n),p={[c.opId]:d};for(;l<e.edits.length-1&&e.edits[l+1].index===c.index&&e.edits[l+1].action==="update";){l++;const h=e.edits[l],f=a[h.index]&&a[h.index][h.opId];d=Mr(h.value,f,n),p[h.opId]=d}c.action==="insert"?(i.splice(c.index,0,d),a.splice(c.index,0,p),o.splice(c.index,0,c.elemId)):(i[c.index]=d,a[c.index]=p)}else if(c.action==="multi-insert"){const u=Fc(c.elemId),d=[],p=[],h=[],f=c.datatype;c.values.forEach((v,j)=>{const _=`${u.counter+j}@${u.actorId}`;v=Mr({value:v,datatype:f},void 0,n),p.push(v),h.push({[_]:{value:v,datatype:f,type:"value"}}),d.push(_)}),i.splice(c.index,0,...p),a.splice(c.index,0,...h),o.splice(c.index,0,...d)}else c.action==="remove"&&(i.splice(c.index,c.count),a.splice(c.index,c.count),o.splice(c.index,c.count))}return i}function MC(e,t,n){const r=e.objectId;let i;n[r]?i=n[r].elems:t?i=t.elems.slice():i=[];for(const a of e.edits)if(a.action==="insert"){const o=Mr(a.value,void 0,n),l={elemId:a.elemId,pred:[a.opId],value:o};i.splice(a.index,0,l)}else if(a.action==="multi-insert"){const o=Fc(a.elemId),l=a.datatype,c=a.values.map((u,d)=>{u=Mr({datatype:l,value:u},void 0,n);const p=`${o.counter+d}@${o.actorId}`;return{elemId:p,pred:[p],value:u}});i.splice(a.index,0,...c)}else if(a.action==="update"){const o=i[a.index].elemId,l=Mr(a.value,i[a.index].value,n);i[a.index]={elemId:o,pred:[a.opId],value:l}}else a.action==="remove"&&i.splice(a.index,a.count);return n[r]=CC(r,i),n[r]}function nb(e,t,n){if(AC(t)&&(!e.props||Object.keys(e.props).length===0)&&(!e.edits||e.edits.length===0)&&!n[e.objectId])return t;if(e.type==="map")return OC(e,t,n);if(e.type==="table")return PC(e,t,n);if(e.type==="list")return DC(e,t,n);if(e.type==="text")return MC(e,t,n);throw new TypeError(`Unknown object type: ${e.type}`)}function UC(e){if(e[Ho]!=="_root")throw new RangeError(`Not the root object: ${e[Ho]}`);return tb(e,"_root")}var rb={interpretPatch:nb,cloneRootObject:UC};const{OBJECT_ID:ri,CHANGE:Hc,STATE:BC}=As,{createArrayOfNulls:VC}=xr,{Text:$C}=mu,{Table:FC}=gu;function cr(e){if(typeof e=="string"&&/^[0-9]+$/.test(e)&&(e=parseInt(e,10)),typeof e!="number")throw new TypeError("A list index must be a number, but you passed "+JSON.stringify(e));if(e<0||isNaN(e)||e===1/0||e===-1/0)throw new RangeError("A list index must be positive, but you passed "+e);return e}function HC(e,t,n){const r={deleteAt(i,a){return e.splice(n,cr(i),a||1,[]),this},fill(i,a,o){let l=e.getObject(t);for(let c=cr(a||0);c<cr(o||l.length);c++)e.setListIndex(n,c,i);return this},indexOf(i,a=0){const o=i[ri];if(o){const l=e.getObject(t);for(let c=a;c<l.length;c++)if(l[c][ri]===o)return c;return-1}else return e.getObject(t).indexOf(i,a)},insertAt(i,...a){return e.splice(n,cr(i),0,a),this},pop(){let i=e.getObject(t);if(i.length==0)return;const a=e.getObjectField(n,t,i.length-1);return e.splice(n,i.length-1,1,[]),a},push(...i){let a=e.getObject(t);return e.splice(n,a.length,0,i),e.getObject(t).length},shift(){if(e.getObject(t).length==0)return;const a=e.getObjectField(n,t,0);return e.splice(n,0,1,[]),a},splice(i,a,...o){let l=e.getObject(t);i=cr(i),(a===void 0||a>l.length-i)&&(a=l.length-i);const c=[];for(let u=0;u<a;u++)c.push(e.getObjectField(n,t,i+u));return e.splice(n,i,a,o),c},unshift(...i){return e.splice(n,0,0,i),e.getObject(t).length}};for(let i of["entries","keys","values"]){let a=e.getObject(t);r[i]=()=>a[i]()}for(let i of["concat","every","filter","find","findIndex","forEach","includes","join","lastIndexOf","map","reduce","reduceRight","slice","some","toLocaleString","toString"])r[i]=(...a)=>e.getObject(t).map((l,c)=>e.getObjectField(n,t,c))[i](...a);return r}const qC={get(e,t){const{context:n,objectId:r,path:i}=e;return t===ri?r:t===Hc?n:t===BC?{actorId:n.actorId}:n.getObjectField(i,r,t)},set(e,t,n){const{context:r,path:i,readonly:a}=e;if(Array.isArray(a)&&a.indexOf(t)>=0)throw new RangeError(`Object property "${t}" cannot be modified`);return r.setMapKey(i,t,n),!0},deleteProperty(e,t){const{context:n,path:r,readonly:i}=e;if(Array.isArray(i)&&i.indexOf(t)>=0)throw new RangeError(`Object property "${t}" cannot be modified`);return n.deleteMapKey(r,t),!0},has(e,t){const{context:n,objectId:r}=e;return[ri,Hc].includes(t)||t in n.getObject(r)},getOwnPropertyDescriptor(e,t){const{context:n,objectId:r}=e,i=n.getObject(r);if(t in i)return{configurable:!0,enumerable:!0,value:n.getObjectField(r,t)}},ownKeys(e){const{context:t,objectId:n}=e;return Object.keys(t.getObject(n))}},zC={get(e,t){const[n,r,i]=e;return t===Symbol.iterator?n.getObject(r)[Symbol.iterator]:t===ri?r:t===Hc?n:t==="length"?n.getObject(r).length:typeof t=="string"&&/^[0-9]+$/.test(t)?n.getObjectField(i,r,cr(t)):HC(n,r,i)[t]},set(e,t,n){const[r,i,a]=e;if(t==="length"){if(typeof n!="number")throw new RangeError("Invalid array length");const o=r.getObject(i).length;o>n?r.splice(a,n,o-n,[]):r.splice(a,o,0,VC(n-o))}else r.setListIndex(a,cr(t),n);return!0},deleteProperty(e,t){const[n,,r]=e;return n.splice(r,cr(t),1,[]),!0},has(e,t){const[n,r]=e;return typeof t=="string"&&/^[0-9]+$/.test(t)?cr(t)<n.getObject(r).length:["length",ri,Hc].includes(t)},getOwnPropertyDescriptor(e,t){const[n,r]=e,i=n.getObject(r);if(t==="length")return{writable:!0,value:i.length};if(t===ri)return{configurable:!1,enumerable:!1,value:r};if(typeof t=="string"&&/^[0-9]+$/.test(t)){const a=cr(t);if(a<i.length)return{configurable:!0,enumerable:!0,value:n.getObjectField(r,a)}}},ownKeys(e){const[t,n]=e,r=t.getObject(n);let i=["length"];for(let a of Object.keys(r))i.push(a);return i}};function sb(e,t,n,r){return new Proxy({context:e,objectId:t,path:n,readonly:r},qC)}function WC(e,t,n){return new Proxy([e,t,n],zC)}function GC(e,t,n){const r=this.getObject(t);return Array.isArray(r)?WC(this,t,e):r instanceof $C||r instanceof FC?r.getWriteable(this,e):sb(this,t,e,n)}function YC(e){return e.instantiateObject=GC,sb(e,"_root",[])}var KC={rootObjectProxy:YC};let JC=class{constructor(t){if(!(Number.isInteger(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER))throw new RangeError(`Value ${t} cannot be a uint`);this.value=t,Object.freeze(this)}},QC=class{constructor(t){if(!(Number.isInteger(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=0))throw new RangeError(`Value ${t} cannot be a uint`);this.value=t,Object.freeze(this)}},ZC=class{constructor(t){if(typeof t!="number")throw new RangeError(`Value ${t} cannot be a float64`);this.value=t||0,Object.freeze(this)}};var ib={Int:JC,Uint:QC,Float64:ZC};const{CACHE:XC,OBJECT_ID:Ol,CONFLICTS:Ks,ELEM_IDS:Pg,STATE:ek}=As,{interpretPatch:tk}=rb,{Text:so}=mu,{Table:io}=gu,{Counter:Gr,getWriteableCounter:nk}=wp,{Int:cd,Uint:ud,Float64:dd}=ib,{isObject:Wa,parseOpId:Lg,createArrayOfNulls:rk}=xr,sk=xp;let ik=class{constructor(t,n,r){this.actorId=n,this.nextOpNum=t[ek].maxOp+1,this.cache=t[XC],this.updated={},this.ops=[],this.applyPatch=r||tk}addOp(t){this.ops.push(t),t.action==="set"&&t.values?this.nextOpNum+=t.values.length:t.action==="del"&&t.multiOp?this.nextOpNum+=t.multiOp:this.nextOpNum+=1}nextOpId(){return`${this.nextOpNum}@${this.actorId}`}getValueDescription(t){if(!["object","boolean","number","string"].includes(typeof t))throw new TypeError(`Unsupported type of value: ${typeof t}`);if(Wa(t)){if(t instanceof Date)return{type:"value",value:t.getTime(),datatype:"timestamp"};if(t instanceof cd)return{type:"value",value:t.value,datatype:"int"};if(t instanceof ud)return{type:"value",value:t.value,datatype:"uint"};if(t instanceof dd)return{type:"value",value:t.value,datatype:"float64"};if(t instanceof Gr)return{type:"value",value:t.value,datatype:"counter"};{const n=t[Ol],r=this.getObjectType(n);if(!n)throw new RangeError(`Object ${JSON.stringify(t)} has no objectId`);return r==="list"||r==="text"?{objectId:n,type:r,edits:[]}:{objectId:n,type:r,props:{}}}}else return typeof t=="number"?Number.isInteger(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER?{type:"value",value:t,datatype:"int"}:{type:"value",value:t,datatype:"float64"}:{type:"value",value:t}}getValuesDescriptions(t,n,r){if(n instanceof io){const i=n.byId(r),a=n.opIds[r];return i?{[a]:this.getValueDescription(i)}:{}}else if(n instanceof so){const i=n.get(r),a=n.getElemId(r);return i?{[a]:this.getValueDescription(i)}:{}}else{const i=n[Ks][r],a={};if(!i)throw new RangeError(`No children at key ${r} of path ${JSON.stringify(t)}`);for(let o of Object.keys(i))a[o]=this.getValueDescription(i[o]);return a}}getPropertyValue(t,n,r){return t instanceof io?t.byId(n):t instanceof so?t.get(n):t[Ks][n][r]}getSubpatch(t,n){if(n.length==0)return t;let r=t,i=this.getObject("_root");for(let a of n){let o=this.getValuesDescriptions(n,i,a.key);if(r.props)r.props[a.key]||(r.props[a.key]=o);else if(r.edits)for(const c of Object.keys(o))r.edits.push({action:"update",index:a.key,opId:c,value:o[c]});let l=null;for(let c of Object.keys(o))o[c].objectId===a.objectId&&(l=c);if(!l)throw new RangeError(`Cannot find path object with objectId ${a.objectId}`);r=o[l],i=this.getPropertyValue(i,a.key,l)}return r}getObject(t){const n=this.updated[t]||this.cache[t];if(!n)throw new RangeError(`Target object does not exist: ${t}`);return n}getObjectType(t){if(t==="_root")return"map";const n=this.getObject(t);return n instanceof so?"text":n instanceof io?"table":Array.isArray(n)?"list":"map"}getObjectField(t,n,r){if(!["string","number"].includes(typeof r))return;const i=this.getObject(n);if(i[r]instanceof Gr)return nk(i[r].value,this,t,n,r);if(Wa(i[r])){const a=i[r][Ol],o=t.concat([{key:r,objectId:a}]);return this.instantiateObject(o,a)}else return i[r]}createNestedObjects(t,n,r,i,a,o){if(r[Ol])throw new RangeError("Cannot create a reference to an existing document object");const l=this.nextOpId();if(r instanceof so){this.addOp(o?{action:"makeText",obj:t,elemId:o,insert:i,pred:a}:{action:"makeText",obj:t,key:n,insert:i,pred:a});const c={objectId:l,type:"text",edits:[]};return this.insertListItems(c,0,[...r],!0),c}else if(r instanceof io){if(r.count>0)throw new RangeError("Assigning a non-empty Table object is not supported");return this.addOp(o?{action:"makeTable",obj:t,elemId:o,insert:i,pred:a}:{action:"makeTable",obj:t,key:n,insert:i,pred:a}),{objectId:l,type:"table",props:{}}}else if(Array.isArray(r)){this.addOp(o?{action:"makeList",obj:t,elemId:o,insert:i,pred:a}:{action:"makeList",obj:t,key:n,insert:i,pred:a});const c={objectId:l,type:"list",edits:[]};return this.insertListItems(c,0,r,!0),c}else{this.addOp(o?{action:"makeMap",obj:t,elemId:o,insert:i,pred:a}:{action:"makeMap",obj:t,key:n,insert:i,pred:a});let c={};for(let u of Object.keys(r).sort()){const d=this.nextOpId(),p=this.setValue(l,u,r[u],!1,[]);c[u]={[d]:p}}return{objectId:l,type:"map",props:c}}}setValue(t,n,r,i,a,o){if(!t)throw new RangeError("setValue needs an objectId");if(n==="")throw new RangeError("The key of a map entry must not be an empty string");if(Wa(r)&&!(r instanceof Date)&&!(r instanceof Gr)&&!(r instanceof cd)&&!(r instanceof ud)&&!(r instanceof dd))return this.createNestedObjects(t,n,r,i,a,o);{const l=this.getValueDescription(r),c={action:"set",obj:t,insert:i,value:l.value,pred:a};return o?c.elemId=o:c.key=n,l.datatype&&(c.datatype=l.datatype),this.addOp(c),l}}applyAtPath(t,n){let r={objectId:"_root",type:"map",props:{}};n(this.getSubpatch(r,t)),this.applyPatch(r,this.cache._root,this.updated)}setMapKey(t,n,r){if(typeof n!="string")throw new RangeError(`The key of a map entry must be a string, not ${typeof n}`);const i=t.length===0?"_root":t[t.length-1].objectId,a=this.getObject(i);if(a[n]instanceof Gr)throw new RangeError("Cannot overwrite a Counter object; use .increment() or .decrement() to change its value.");(a[n]!==r||Object.keys(a[Ks][n]||{}).length>1||r===void 0)&&this.applyAtPath(t,o=>{const l=Ga(a,n),c=this.nextOpId(),u=this.setValue(i,n,r,!1,l);o.props[n]={[c]:u}})}deleteMapKey(t,n){const r=t.length===0?"_root":t[t.length-1].objectId,i=this.getObject(r);if(i[n]!==void 0){const a=Ga(i,n);this.addOp({action:"del",obj:r,key:n,insert:!1,pred:a}),this.applyAtPath(t,o=>{o.props[n]={}})}}insertListItems(t,n,r,i){const a=i?[]:this.getObject(t.objectId);if(n<0||n>a.length)throw new RangeError(`List index ${n} is out of bounds for list of length ${a.length}`);if(r.length===0)return;let o=Pl(a,n,!0);const l=r.every(d=>typeof d=="string"||typeof d=="number"||typeof d=="boolean"||d===null||Wa(d)&&(d instanceof Date||d instanceof Gr||d instanceof cd||d instanceof ud||d instanceof dd)),c=l?r.map(d=>this.getValueDescription(d)):[],u=c.every(d=>d.datatype===c[0].datatype);if(l&&u&&r.length>1){const d=this.nextOpId(),p=c[0].datatype,h=c.map(j=>j.value),f={action:"set",obj:t.objectId,elemId:o,insert:!0,values:h,pred:[]},v={action:"multi-insert",elemId:d,index:n,values:h};p&&(f.datatype=p,v.datatype=p),this.addOp(f),t.edits.push(v)}else for(let d=0;d<r.length;d++){let p=this.nextOpId();const h=this.setValue(t.objectId,n+d,r[d],!0,[],o);o=p,t.edits.push({action:"insert",index:n+d,elemId:o,opId:o,value:h})}}setListIndex(t,n,r){const i=t.length===0?"_root":t[t.length-1].objectId,a=this.getObject(i);if(n>=a.length){const o=rk(n-a.length);return o.push(r),this.splice(t,a.length,0,o)}if(a[n]instanceof Gr)throw new RangeError("Cannot overwrite a Counter object; use .increment() or .decrement() to change its value.");(a[n]!==r||Object.keys(a[Ks][n]||{}).length>1||r===void 0)&&this.applyAtPath(t,o=>{const l=Ga(a,n),c=this.nextOpId(),u=this.setValue(i,n,r,!1,l,Pl(a,n));o.edits.push({action:"update",index:n,opId:c,value:u})})}splice(t,n,r,i){const a=t.length===0?"_root":t[t.length-1].objectId;let o=this.getObject(a);if(n<0||r<0||n>o.length-r)throw new RangeError(`${r} deletions starting at index ${n} are out of bounds for list of length ${o.length}`);if(r===0&&i.length===0)return;let l={diffs:{objectId:"_root",type:"map",props:{}}},c=this.getSubpatch(l.diffs,t);if(r>0){let u,d,p;for(let h=0;h<r;h++){if(this.getObjectField(t,a,n+h)instanceof Gr)throw new TypeError("Unsupported operation: deleting a counter from a list");const f=Pl(o,n+h),v=Lg(f),j=Ga(o,n+h),_=j.length===1?Lg(j[0]):void 0;u&&d&&p&&_&&d.actorId===v.actorId&&d.counter+1===v.counter&&p.actorId===_.actorId&&p.counter+1===_.counter?u.multiOp=(u.multiOp||1)+1:(u&&this.addOp(u),u={action:"del",obj:a,elemId:f,insert:!1,pred:j}),d=v,p=_}this.addOp(u),c.edits.push({action:"remove",index:n,count:r})}i.length>0&&this.insertListItems(c,n,i,!1),this.applyPatch(l.diffs,this.cache._root,this.updated)}addTableRow(t,n){if(!Wa(n)||Array.isArray(n))throw new TypeError("A table row must be an object");if(n[Ol])throw new TypeError("Cannot reuse an existing object as table row");if(n.id)throw new TypeError('A table row must not have an "id" property; it is generated automatically');const r=sk(),i=this.setValue(t[t.length-1].objectId,r,n,!1,[]);return this.applyAtPath(t,a=>{a.props[r]={[i.objectId]:i}}),r}deleteTableRow(t,n,r){const i=t[t.length-1].objectId;this.getObject(i).byId(n)&&(this.addOp({action:"del",obj:i,key:n,insert:!1,pred:[r]}),this.applyAtPath(t,o=>{o.props[n]={}}))}increment(t,n,r){const i=t.length===0?"_root":t[t.length-1].objectId,a=this.getObject(i);if(!(a[n]instanceof Gr))throw new TypeError("Only counter values can be incremented");const o=this.getObjectType(i),l=a[n].value+r,c=this.nextOpId(),u=Ga(a,n);if(o==="list"||o==="text"){const d=Pl(a,n,!1);this.addOp({action:"inc",obj:i,elemId:d,value:r,insert:!1,pred:u})}else this.addOp({action:"inc",obj:i,key:n,value:r,insert:!1,pred:u});this.applyAtPath(t,d=>{o==="list"||o==="text"?d.edits.push({action:"update",index:n,opId:c,value:{value:l,datatype:"counter"}}):d.props[n]={[c]:{value:l,datatype:"counter"}}})}};function Ga(e,t){return e instanceof io?[e.opIds[t]]:e instanceof so?e.elems[t].pred:e[Ks]?e[Ks][t]?Object.keys(e[Ks][t]):[]:[]}function Pl(e,t,n=!1){if(n){if(t===0)return"_head";t-=1}if(e[Pg])return e[Pg][t];if(e.getElemId)return e.getElemId(t);throw new RangeError(`Cannot find elemId at list index ${t}`)}var ak={Context:ik};const{OBJECT_ID:ok,CONFLICTS:Zt}=As;let lk=class{constructor(){this.observers={}}patchCallback(t,n,r,i,a){this._objectUpdate(t.diffs,n,r,i,a)}_objectUpdate(t,n,r,i,a){if(t.objectId){if(this.observers[t.objectId])for(let o of this.observers[t.objectId])o(t,n,r,i,a);if(t.type==="map"&&t.props)for(const o of Object.keys(t.props))for(const l of Object.keys(t.props[o]))this._objectUpdate(t.props[o][l],n&&n[Zt]&&n[Zt][o]&&n[Zt][o][l],r&&r[Zt]&&r[Zt][o]&&r[Zt][o][l],i,a);else if(t.type==="table"&&t.props)for(const o of Object.keys(t.props))for(const l of Object.keys(t.props[o]))this._objectUpdate(t.props[o][l],n&&n.byId(o),r&&r.byId(o),i,a);else if(t.type==="list"&&t.edits){let o=0;for(const l of t.edits)l.action==="insert"?(o-=1,this._objectUpdate(l.value,void 0,r&&r[Zt]&&r[Zt][l.index]&&r[Zt][l.index][l.elemId],i,a)):l.action==="multi-insert"?o-=l.values.length:l.action==="update"?this._objectUpdate(l.value,n&&n[Zt]&&n[Zt][l.index+o]&&n[Zt][l.index+o][l.opId],r&&r[Zt]&&r[Zt][l.index]&&r[Zt][l.index][l.opId],i,a):l.action==="remove"&&(o+=l.count)}else if(t.type==="text"&&t.edits){let o=0;for(const l of t.edits)l.action==="insert"?(o-=1,this._objectUpdate(l.value,void 0,r&&r.get(l.index),i,a)):l.action==="multi-insert"?o-=l.values.length:l.action==="update"?this._objectUpdate(l.value,n&&n.get(l.index+o),r&&r.get(l.index),i,a):l.action==="remove"&&(o+=l.count)}}}observe(t,n){const r=t[ok];if(!r)throw new TypeError("The observed object must be part of an Automerge document");this.observers[r]||(this.observers[r]=[]),this.observers[r].push(n)}};var ck={Observable:lk};const{OPTIONS:dr,CACHE:Wi,STATE:mr,OBJECT_ID:Na,CONFLICTS:Gi,CHANGE:ab,ELEM_IDS:uk}=As,{isObject:Sp,copyObject:Lh}=xr,dk=xp,{interpretPatch:hk,cloneRootObject:fk}=rb,{rootObjectProxy:pk}=KC,{Context:ob}=ak,{Text:Ep}=mu,{Table:lb}=gu,{Counter:mk}=wp,{Float64:gk,Int:yk,Uint:vk}=ib,{Observable:xk}=ck;function cb(e){if(typeof e!="string")throw new TypeError(`Unsupported type of actorId: ${typeof e}`);if(!/^[0-9a-f]+$/.test(e))throw new RangeError("actorId must consist only of lowercase hex digits");if(e.length%2!==0)throw new RangeError("actorId must consist of an even number of digits")}function yu(e,t,n){let r=t._root;if(r||(r=fk(e[Wi]._root),t._root=r),Object.defineProperty(r,dr,{value:e[dr]}),Object.defineProperty(r,Wi,{value:t}),Object.defineProperty(r,mr,{value:n}),e[dr].freeze)for(let i of Object.keys(t))t[i]instanceof lb?t[i]._freeze():t[i]instanceof Ep?(Object.freeze(t[i].elems),Object.freeze(t[i])):(Object.freeze(t[i]),Object.freeze(t[i][Gi]));for(let i of Object.keys(e[Wi]))t[i]||(t[i]=e[Wi][i]);return e[dr].freeze&&Object.freeze(t),r}function ub(e,t,n){const r=_a(e);if(!r)throw new Error("Actor ID must be initialized with setActorId() before making a change");const i=Lh(e[mr]);i.seq+=1;const a={actor:r,seq:i.seq,startOp:i.maxOp+1,deps:i.deps,time:n&&typeof n.time=="number"?n.time:Math.round(new Date().getTime()/1e3),message:n&&typeof n.message=="string"?n.message:"",ops:t.ops};if(e[dr].backend){const[o,l,c]=e[dr].backend.applyLocalChange(i.backendState,a);i.backendState=o,i.lastLocalChange=c;const u=Dh(e,l,i),d=n&&n.patchCallback||e[dr].patchCallback;return d&&d(l,e,u,!0,[c]),[u,a]}else{const o={actor:r,seq:a.seq,before:e};return i.requests=i.requests.concat([o]),i.maxOp=i.maxOp+jk(a.ops),i.deps=[],[yu(e,t?t.updated:{},i),a]}}function jk(e){let t=0;for(const n of e)n.action==="set"&&n.values?t+=n.values.length:t+=1;return t}function bk(e){return e[mr]&&e[mr].lastLocalChange?e[mr].lastLocalChange:null}function Dh(e,t,n,r){const i=_a(e),a={};hk(t.diffs,e,a);{if(!t.clock)throw new RangeError("patch is missing clock field");t.clock[i]&&t.clock[i]>n.seq&&(n.seq=t.clock[i]),n.clock=t.clock,n.deps=t.deps,n.maxOp=Math.max(n.maxOp,t.maxOp)}return yu(e,a,n)}function db(e){if(typeof e=="string")e={actorId:e};else if(typeof e>"u")e={};else if(!Sp(e))throw new TypeError(`Unsupported value for init() options: ${e}`);if(e.deferActorId||(e.actorId===void 0&&(e.actorId=dk()),cb(e.actorId)),e.observable){const i=e.patchCallback,a=e.observable;e.patchCallback=(o,l,c,u,d)=>{i&&i(o,l,c,u,d),a.patchCallback(o,l,c,u,d)}}const t={},n={_root:t},r={seq:0,maxOp:0,requests:[],clock:{},deps:[]};return e.backend&&(r.backendState=e.backend.init(),r.lastLocalChange=null),Object.defineProperty(t,Na,{value:"_root"}),Object.defineProperty(t,dr,{value:Object.freeze(e)}),Object.defineProperty(t,Gi,{value:Object.freeze({})}),Object.defineProperty(t,Wi,{value:Object.freeze(n)}),Object.defineProperty(t,mr,{value:Object.freeze(r)}),Object.freeze(t)}function wk(e,t){return hb(db(t),"Initialization",n=>Object.assign(n,e))}function hb(e,t,n){if(e[Na]!=="_root")throw new TypeError("The first argument to Automerge.change must be the document root");if(e[ab])throw new TypeError("Calls to Automerge.change cannot be nested");if(typeof t=="function"&&n===void 0&&([t,n]=[n,t]),typeof t=="string"&&(t={message:t}),t!==void 0&&!Sp(t))throw new TypeError("Unsupported type of options");const r=_a(e);if(!r)throw new Error("Actor ID must be initialized with setActorId() before making a change");const i=new ob(e,r);return n(pk(i)),Object.keys(i.updated).length===0?[e,null]:ub(e,i,t)}function Sk(e,t){if(e[Na]!=="_root")throw new TypeError("The first argument to Automerge.emptyChange must be the document root");if(typeof t=="string"&&(t={message:t}),t!==void 0&&!Sp(t))throw new TypeError("Unsupported type of options");const n=_a(e);if(!n)throw new Error("Actor ID must be initialized with setActorId() before making a change");return ub(e,new ob(e,n),t)}function Ek(e,t,n=void 0){if(e[Na]!=="_root")throw new TypeError("The first argument to Frontend.applyPatch must be the document root");const r=Lh(e[mr]);if(e[dr].backend){if(!n)throw new RangeError("applyPatch must be called with the updated backend state");return r.backendState=n,Dh(e,t,r)}let i;if(r.requests.length>0)if(i=r.requests[0].before,t.actor===_a(e)){if(r.requests[0].seq!==t.seq)throw new RangeError(`Mismatched sequence number: patch ${t.seq} does not match next request ${r.requests[0].seq}`);r.requests=r.requests.slice(1)}else r.requests=r.requests.slice();else i=e,r.requests=[];let a=Dh(i,t,r);return r.requests.length===0?a:(r.requests[0]=Lh(r.requests[0]),r.requests[0].before=a,yu(e,{},r))}function Nk(e){return e[Na]}function _k(e,t){if(e[ab])throw new TypeError("Cannot use getObjectById in a change callback");return e[Wi][t]}function _a(e){return e[mr].actorId||e[dr].actorId}function Ak(e,t){cb(t);const n=Object.assign({},e[mr],{actorId:t});return yu(e,{},n)}function Ck(e,t){if(e[Gi]&&e[Gi][t]&&Object.keys(e[Gi][t]).length>1)return e[Gi][t]}function kk(e,t=null,n="first"){if(e[Na]!=="_root"){const r=Array.isArray(e)?". Note: Automerge.applyChanges now returns an array.":"";throw t?new TypeError(`The ${n} argument to Automerge.${t} must be the document root${r}`):new TypeError(`Argument is not an Automerge document root${r}`)}return e[mr].backendState}function Ik(e){return e instanceof Ep?e.elems.map(t=>t.elemId):e[uk]}var Rk={init:db,from:wk,change:hb,emptyChange:Sk,applyPatch:Ek,getObjectId:Nk,getObjectById:_k,getActorId:_a,setActorId:Ak,getConflicts:Ck,getLastLocalChange:bk,getBackendState:kk,getElementIds:Ik,Text:Ep,Table:lb,Counter:mk,Observable:xk,Float64:gk,Int:yk,Uint:vk},jr={},Aa={},br={},Ca={};const Tk=4,Dg=0,Mg=1,Ok=2;function ka(e){let t=e.length;for(;--t>=0;)e[t]=0}const Pk=0,fb=1,Lk=2,Dk=3,Mk=258,Np=29,sl=256,qo=sl+1+Np,ta=30,_p=19,pb=2*qo+1,Js=15,hd=16,Uk=7,Ap=256,mb=16,gb=17,yb=18,Mh=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),lc=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),Bk=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),vb=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Vk=512,Ir=new Array((qo+2)*2);ka(Ir);const xo=new Array(ta*2);ka(xo);const zo=new Array(Vk);ka(zo);const Wo=new Array(Mk-Dk+1);ka(Wo);const Cp=new Array(Np);ka(Cp);const qc=new Array(ta);ka(qc);function fd(e,t,n,r,i){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=r,this.max_length=i,this.has_stree=e&&e.length}let xb,jb,bb;function pd(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}const wb=e=>e<256?zo[e]:zo[256+(e>>>7)],Go=(e,t)=>{e.pending_buf[e.pending++]=t&255,e.pending_buf[e.pending++]=t>>>8&255},on=(e,t,n)=>{e.bi_valid>hd-n?(e.bi_buf|=t<<e.bi_valid&65535,Go(e,e.bi_buf),e.bi_buf=t>>hd-e.bi_valid,e.bi_valid+=n-hd):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)},ur=(e,t,n)=>{on(e,n[t*2],n[t*2+1])},Sb=(e,t)=>{let n=0;do n|=e&1,e>>>=1,n<<=1;while(--t>0);return n>>>1},$k=e=>{e.bi_valid===16?(Go(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=e.bi_buf&255,e.bi_buf>>=8,e.bi_valid-=8)},Fk=(e,t)=>{const n=t.dyn_tree,r=t.max_code,i=t.stat_desc.static_tree,a=t.stat_desc.has_stree,o=t.stat_desc.extra_bits,l=t.stat_desc.extra_base,c=t.stat_desc.max_length;let u,d,p,h,f,v,j=0;for(h=0;h<=Js;h++)e.bl_count[h]=0;for(n[e.heap[e.heap_max]*2+1]=0,u=e.heap_max+1;u<pb;u++)d=e.heap[u],h=n[n[d*2+1]*2+1]+1,h>c&&(h=c,j++),n[d*2+1]=h,!(d>r)&&(e.bl_count[h]++,f=0,d>=l&&(f=o[d-l]),v=n[d*2],e.opt_len+=v*(h+f),a&&(e.static_len+=v*(i[d*2+1]+f)));if(j!==0){do{for(h=c-1;e.bl_count[h]===0;)h--;e.bl_count[h]--,e.bl_count[h+1]+=2,e.bl_count[c]--,j-=2}while(j>0);for(h=c;h!==0;h--)for(d=e.bl_count[h];d!==0;)p=e.heap[--u],!(p>r)&&(n[p*2+1]!==h&&(e.opt_len+=(h-n[p*2+1])*n[p*2],n[p*2+1]=h),d--)}},Eb=(e,t,n)=>{const r=new Array(Js+1);let i=0,a,o;for(a=1;a<=Js;a++)i=i+n[a-1]<<1,r[a]=i;for(o=0;o<=t;o++){let l=e[o*2+1];l!==0&&(e[o*2]=Sb(r[l]++,l))}},Hk=()=>{let e,t,n,r,i;const a=new Array(Js+1);for(n=0,r=0;r<Np-1;r++)for(Cp[r]=n,e=0;e<1<<Mh[r];e++)Wo[n++]=r;for(Wo[n-1]=r,i=0,r=0;r<16;r++)for(qc[r]=i,e=0;e<1<<lc[r];e++)zo[i++]=r;for(i>>=7;r<ta;r++)for(qc[r]=i<<7,e=0;e<1<<lc[r]-7;e++)zo[256+i++]=r;for(t=0;t<=Js;t++)a[t]=0;for(e=0;e<=143;)Ir[e*2+1]=8,e++,a[8]++;for(;e<=255;)Ir[e*2+1]=9,e++,a[9]++;for(;e<=279;)Ir[e*2+1]=7,e++,a[7]++;for(;e<=287;)Ir[e*2+1]=8,e++,a[8]++;for(Eb(Ir,qo+1,a),e=0;e<ta;e++)xo[e*2+1]=5,xo[e*2]=Sb(e,5);xb=new fd(Ir,Mh,sl+1,qo,Js),jb=new fd(xo,lc,0,ta,Js),bb=new fd(new Array(0),Bk,0,_p,Uk)},Nb=e=>{let t;for(t=0;t<qo;t++)e.dyn_ltree[t*2]=0;for(t=0;t<ta;t++)e.dyn_dtree[t*2]=0;for(t=0;t<_p;t++)e.bl_tree[t*2]=0;e.dyn_ltree[Ap*2]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},_b=e=>{e.bi_valid>8?Go(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},Ug=(e,t,n,r)=>{const i=t*2,a=n*2;return e[i]<e[a]||e[i]===e[a]&&r[t]<=r[n]},md=(e,t,n)=>{const r=e.heap[n];let i=n<<1;for(;i<=e.heap_len&&(i<e.heap_len&&Ug(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!Ug(t,r,e.heap[i],e.depth));)e.heap[n]=e.heap[i],n=i,i<<=1;e.heap[n]=r},Bg=(e,t,n)=>{let r,i,a=0,o,l;if(e.sym_next!==0)do r=e.pending_buf[e.sym_buf+a++]&255,r+=(e.pending_buf[e.sym_buf+a++]&255)<<8,i=e.pending_buf[e.sym_buf+a++],r===0?ur(e,i,t):(o=Wo[i],ur(e,o+sl+1,t),l=Mh[o],l!==0&&(i-=Cp[o],on(e,i,l)),r--,o=wb(r),ur(e,o,n),l=lc[o],l!==0&&(r-=qc[o],on(e,r,l)));while(a<e.sym_next);ur(e,Ap,t)},Uh=(e,t)=>{const n=t.dyn_tree,r=t.stat_desc.static_tree,i=t.stat_desc.has_stree,a=t.stat_desc.elems;let o,l,c=-1,u;for(e.heap_len=0,e.heap_max=pb,o=0;o<a;o++)n[o*2]!==0?(e.heap[++e.heap_len]=c=o,e.depth[o]=0):n[o*2+1]=0;for(;e.heap_len<2;)u=e.heap[++e.heap_len]=c<2?++c:0,n[u*2]=1,e.depth[u]=0,e.opt_len--,i&&(e.static_len-=r[u*2+1]);for(t.max_code=c,o=e.heap_len>>1;o>=1;o--)md(e,n,o);u=a;do o=e.heap[1],e.heap[1]=e.heap[e.heap_len--],md(e,n,1),l=e.heap[1],e.heap[--e.heap_max]=o,e.heap[--e.heap_max]=l,n[u*2]=n[o*2]+n[l*2],e.depth[u]=(e.depth[o]>=e.depth[l]?e.depth[o]:e.depth[l])+1,n[o*2+1]=n[l*2+1]=u,e.heap[1]=u++,md(e,n,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],Fk(e,t),Eb(n,c,e.bl_count)},Vg=(e,t,n)=>{let r,i=-1,a,o=t[0*2+1],l=0,c=7,u=4;for(o===0&&(c=138,u=3),t[(n+1)*2+1]=65535,r=0;r<=n;r++)a=o,o=t[(r+1)*2+1],!(++l<c&&a===o)&&(l<u?e.bl_tree[a*2]+=l:a!==0?(a!==i&&e.bl_tree[a*2]++,e.bl_tree[mb*2]++):l<=10?e.bl_tree[gb*2]++:e.bl_tree[yb*2]++,l=0,i=a,o===0?(c=138,u=3):a===o?(c=6,u=3):(c=7,u=4))},$g=(e,t,n)=>{let r,i=-1,a,o=t[0*2+1],l=0,c=7,u=4;for(o===0&&(c=138,u=3),r=0;r<=n;r++)if(a=o,o=t[(r+1)*2+1],!(++l<c&&a===o)){if(l<u)do ur(e,a,e.bl_tree);while(--l!==0);else a!==0?(a!==i&&(ur(e,a,e.bl_tree),l--),ur(e,mb,e.bl_tree),on(e,l-3,2)):l<=10?(ur(e,gb,e.bl_tree),on(e,l-3,3)):(ur(e,yb,e.bl_tree),on(e,l-11,7));l=0,i=a,o===0?(c=138,u=3):a===o?(c=6,u=3):(c=7,u=4)}},qk=e=>{let t;for(Vg(e,e.dyn_ltree,e.l_desc.max_code),Vg(e,e.dyn_dtree,e.d_desc.max_code),Uh(e,e.bl_desc),t=_p-1;t>=3&&e.bl_tree[vb[t]*2+1]===0;t--);return e.opt_len+=3*(t+1)+5+5+4,t},zk=(e,t,n,r)=>{let i;for(on(e,t-257,5),on(e,n-1,5),on(e,r-4,4),i=0;i<r;i++)on(e,e.bl_tree[vb[i]*2+1],3);$g(e,e.dyn_ltree,t-1),$g(e,e.dyn_dtree,n-1)},Wk=e=>{let t=4093624447,n;for(n=0;n<=31;n++,t>>>=1)if(t&1&&e.dyn_ltree[n*2]!==0)return Dg;if(e.dyn_ltree[9*2]!==0||e.dyn_ltree[10*2]!==0||e.dyn_ltree[13*2]!==0)return Mg;for(n=32;n<sl;n++)if(e.dyn_ltree[n*2]!==0)return Mg;return Dg};let Fg=!1;const Gk=e=>{Fg||(Hk(),Fg=!0),e.l_desc=new pd(e.dyn_ltree,xb),e.d_desc=new pd(e.dyn_dtree,jb),e.bl_desc=new pd(e.bl_tree,bb),e.bi_buf=0,e.bi_valid=0,Nb(e)},Ab=(e,t,n,r)=>{on(e,(Pk<<1)+(r?1:0),3),_b(e),Go(e,n),Go(e,~n),n&&e.pending_buf.set(e.window.subarray(t,t+n),e.pending),e.pending+=n},Yk=e=>{on(e,fb<<1,3),ur(e,Ap,Ir),$k(e)},Kk=(e,t,n,r)=>{let i,a,o=0;e.level>0?(e.strm.data_type===Ok&&(e.strm.data_type=Wk(e)),Uh(e,e.l_desc),Uh(e,e.d_desc),o=qk(e),i=e.opt_len+3+7>>>3,a=e.static_len+3+7>>>3,a<=i&&(i=a)):i=a=n+5,n+4<=i&&t!==-1?Ab(e,t,n,r):e.strategy===Tk||a===i?(on(e,(fb<<1)+(r?1:0),3),Bg(e,Ir,xo)):(on(e,(Lk<<1)+(r?1:0),3),zk(e,e.l_desc.max_code+1,e.d_desc.max_code+1,o+1),Bg(e,e.dyn_ltree,e.dyn_dtree)),Nb(e),r&&_b(e)},Jk=(e,t,n)=>(e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=n,t===0?e.dyn_ltree[n*2]++:(e.matches++,t--,e.dyn_ltree[(Wo[n]+sl+1)*2]++,e.dyn_dtree[wb(t)*2]++),e.sym_next===e.sym_end);Ca._tr_init=Gk;Ca._tr_stored_block=Ab;Ca._tr_flush_block=Kk;Ca._tr_tally=Jk;Ca._tr_align=Yk;const Qk=(e,t,n,r)=>{let i=e&65535|0,a=e>>>16&65535|0,o=0;for(;n!==0;){o=n>2e3?2e3:n,n-=o;do i=i+t[r++]|0,a=a+i|0;while(--o);i%=65521,a%=65521}return i|a<<16|0};var Cb=Qk;const Zk=()=>{let e,t=[];for(var n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=e&1?3988292384^e>>>1:e>>>1;t[n]=e}return t},Xk=new Uint32Array(Zk()),eI=(e,t,n,r)=>{const i=Xk,a=r+n;e^=-1;for(let o=r;o<a;o++)e=e>>>8^i[(e^t[o])&255];return e^-1};var kb=eI,kp={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},gi={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:tI,_tr_stored_block:Bh,_tr_flush_block:nI,_tr_tally:ys,_tr_align:rI}=Ca,Ib=Cb,Yr=kb,sI=kp,{Z_NO_FLUSH:vs,Z_PARTIAL_FLUSH:iI,Z_FULL_FLUSH:aI,Z_FINISH:Rn,Z_BLOCK:Hg,Z_OK:Mt,Z_STREAM_END:qg,Z_STREAM_ERROR:gr,Z_DATA_ERROR:oI,Z_BUF_ERROR:gd,Z_DEFAULT_COMPRESSION:lI,Z_FILTERED:cI,Z_HUFFMAN_ONLY:Ll,Z_RLE:uI,Z_FIXED:dI,Z_DEFAULT_STRATEGY:hI,Z_UNKNOWN:fI,Z_DEFLATED:vu}=gi,pI=9,mI=15,gI=8,yI=29,vI=256,Vh=vI+1+yI,xI=30,jI=19,bI=2*Vh+1,wI=15,Pe=3,as=258,yr=as+Pe+1,SI=32,fa=42,Ip=57,$h=69,Fh=73,Hh=91,qh=103,Qs=113,ao=666,en=1,Ia=2,di=3,Ra=4,EI=3,Zs=(e,t)=>(e.msg=sI[t],t),zg=e=>e*2-(e>4?9:0),Xr=e=>{let t=e.length;for(;--t>=0;)e[t]=0},NI=e=>{let t,n,r,i=e.w_size;t=e.hash_size,r=t;do n=e.head[--r],e.head[r]=n>=i?n-i:0;while(--t);t=i,r=t;do n=e.prev[--r],e.prev[r]=n>=i?n-i:0;while(--t)};let _I=(e,t,n)=>(t<<e.hash_shift^n)&e.hash_mask,xs=_I;const gn=e=>{const t=e.state;let n=t.pending;n>e.avail_out&&(n=e.avail_out),n!==0&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+n),e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,t.pending===0&&(t.pending_out=0))},xn=(e,t)=>{nI(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,gn(e.strm)},He=(e,t)=>{e.pending_buf[e.pending++]=t},Ya=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=t&255},zh=(e,t,n,r)=>{let i=e.avail_in;return i>r&&(i=r),i===0?0:(e.avail_in-=i,t.set(e.input.subarray(e.next_in,e.next_in+i),n),e.state.wrap===1?e.adler=Ib(e.adler,t,i,n):e.state.wrap===2&&(e.adler=Yr(e.adler,t,i,n)),e.next_in+=i,e.total_in+=i,i)},Rb=(e,t)=>{let n=e.max_chain_length,r=e.strstart,i,a,o=e.prev_length,l=e.nice_match;const c=e.strstart>e.w_size-yr?e.strstart-(e.w_size-yr):0,u=e.window,d=e.w_mask,p=e.prev,h=e.strstart+as;let f=u[r+o-1],v=u[r+o];e.prev_length>=e.good_match&&(n>>=2),l>e.lookahead&&(l=e.lookahead);do if(i=t,!(u[i+o]!==v||u[i+o-1]!==f||u[i]!==u[r]||u[++i]!==u[r+1])){r+=2,i++;do;while(u[++r]===u[++i]&&u[++r]===u[++i]&&u[++r]===u[++i]&&u[++r]===u[++i]&&u[++r]===u[++i]&&u[++r]===u[++i]&&u[++r]===u[++i]&&u[++r]===u[++i]&&r<h);if(a=as-(h-r),r=h-as,a>o){if(e.match_start=t,o=a,a>=l)break;f=u[r+o-1],v=u[r+o]}}while((t=p[t&d])>c&&--n!==0);return o<=e.lookahead?o:e.lookahead},pa=e=>{const t=e.w_size;let n,r,i;do{if(r=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-yr)&&(e.window.set(e.window.subarray(t,t+t-r),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,e.insert>e.strstart&&(e.insert=e.strstart),NI(e),r+=t),e.strm.avail_in===0)break;if(n=zh(e.strm,e.window,e.strstart+e.lookahead,r),e.lookahead+=n,e.lookahead+e.insert>=Pe)for(i=e.strstart-e.insert,e.ins_h=e.window[i],e.ins_h=xs(e,e.ins_h,e.window[i+1]);e.insert&&(e.ins_h=xs(e,e.ins_h,e.window[i+Pe-1]),e.prev[i&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=i,i++,e.insert--,!(e.lookahead+e.insert<Pe)););}while(e.lookahead<yr&&e.strm.avail_in!==0)},Tb=(e,t)=>{let n=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,r,i,a,o=0,l=e.strm.avail_in;do{if(r=65535,a=e.bi_valid+42>>3,e.strm.avail_out<a||(a=e.strm.avail_out-a,i=e.strstart-e.block_start,r>i+e.strm.avail_in&&(r=i+e.strm.avail_in),r>a&&(r=a),r<n&&(r===0&&t!==Rn||t===vs||r!==i+e.strm.avail_in)))break;o=t===Rn&&r===i+e.strm.avail_in?1:0,Bh(e,0,0,o),e.pending_buf[e.pending-4]=r,e.pending_buf[e.pending-3]=r>>8,e.pending_buf[e.pending-2]=~r,e.pending_buf[e.pending-1]=~r>>8,gn(e.strm),i&&(i>r&&(i=r),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+i),e.strm.next_out),e.strm.next_out+=i,e.strm.avail_out-=i,e.strm.total_out+=i,e.block_start+=i,r-=i),r&&(zh(e.strm,e.strm.output,e.strm.next_out,r),e.strm.next_out+=r,e.strm.avail_out-=r,e.strm.total_out+=r)}while(o===0);return l-=e.strm.avail_in,l&&(l>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=l&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-l,e.strm.next_in),e.strstart),e.strstart+=l,e.insert+=l>e.w_size-e.insert?e.w_size-e.insert:l),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),o?Ra:t!==vs&&t!==Rn&&e.strm.avail_in===0&&e.strstart===e.block_start?Ia:(a=e.window_size-e.strstart,e.strm.avail_in>a&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,a+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),a>e.strm.avail_in&&(a=e.strm.avail_in),a&&(zh(e.strm,e.window,e.strstart,a),e.strstart+=a,e.insert+=a>e.w_size-e.insert?e.w_size-e.insert:a),e.high_water<e.strstart&&(e.high_water=e.strstart),a=e.bi_valid+42>>3,a=e.pending_buf_size-a>65535?65535:e.pending_buf_size-a,n=a>e.w_size?e.w_size:a,i=e.strstart-e.block_start,(i>=n||(i||t===Rn)&&t!==vs&&e.strm.avail_in===0&&i<=a)&&(r=i>a?a:i,o=t===Rn&&e.strm.avail_in===0&&r===i?1:0,Bh(e,e.block_start,r,o),e.block_start+=r,gn(e.strm)),o?di:en)},yd=(e,t)=>{let n,r;for(;;){if(e.lookahead<yr){if(pa(e),e.lookahead<yr&&t===vs)return en;if(e.lookahead===0)break}if(n=0,e.lookahead>=Pe&&(e.ins_h=xs(e,e.ins_h,e.window[e.strstart+Pe-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),n!==0&&e.strstart-n<=e.w_size-yr&&(e.match_length=Rb(e,n)),e.match_length>=Pe)if(r=ys(e,e.strstart-e.match_start,e.match_length-Pe),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=Pe){e.match_length--;do e.strstart++,e.ins_h=xs(e,e.ins_h,e.window[e.strstart+Pe-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(--e.match_length!==0);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=xs(e,e.ins_h,e.window[e.strstart+1]);else r=ys(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(r&&(xn(e,!1),e.strm.avail_out===0))return en}return e.insert=e.strstart<Pe-1?e.strstart:Pe-1,t===Rn?(xn(e,!0),e.strm.avail_out===0?di:Ra):e.sym_next&&(xn(e,!1),e.strm.avail_out===0)?en:Ia},Ri=(e,t)=>{let n,r,i;for(;;){if(e.lookahead<yr){if(pa(e),e.lookahead<yr&&t===vs)return en;if(e.lookahead===0)break}if(n=0,e.lookahead>=Pe&&(e.ins_h=xs(e,e.ins_h,e.window[e.strstart+Pe-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=Pe-1,n!==0&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-yr&&(e.match_length=Rb(e,n),e.match_length<=5&&(e.strategy===cI||e.match_length===Pe&&e.strstart-e.match_start>4096)&&(e.match_length=Pe-1)),e.prev_length>=Pe&&e.match_length<=e.prev_length){i=e.strstart+e.lookahead-Pe,r=ys(e,e.strstart-1-e.prev_match,e.prev_length-Pe),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=i&&(e.ins_h=xs(e,e.ins_h,e.window[e.strstart+Pe-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(--e.prev_length!==0);if(e.match_available=0,e.match_length=Pe-1,e.strstart++,r&&(xn(e,!1),e.strm.avail_out===0))return en}else if(e.match_available){if(r=ys(e,0,e.window[e.strstart-1]),r&&xn(e,!1),e.strstart++,e.lookahead--,e.strm.avail_out===0)return en}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(r=ys(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<Pe-1?e.strstart:Pe-1,t===Rn?(xn(e,!0),e.strm.avail_out===0?di:Ra):e.sym_next&&(xn(e,!1),e.strm.avail_out===0)?en:Ia},AI=(e,t)=>{let n,r,i,a;const o=e.window;for(;;){if(e.lookahead<=as){if(pa(e),e.lookahead<=as&&t===vs)return en;if(e.lookahead===0)break}if(e.match_length=0,e.lookahead>=Pe&&e.strstart>0&&(i=e.strstart-1,r=o[i],r===o[++i]&&r===o[++i]&&r===o[++i])){a=e.strstart+as;do;while(r===o[++i]&&r===o[++i]&&r===o[++i]&&r===o[++i]&&r===o[++i]&&r===o[++i]&&r===o[++i]&&r===o[++i]&&i<a);e.match_length=as-(a-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=Pe?(n=ys(e,1,e.match_length-Pe),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=ys(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(xn(e,!1),e.strm.avail_out===0))return en}return e.insert=0,t===Rn?(xn(e,!0),e.strm.avail_out===0?di:Ra):e.sym_next&&(xn(e,!1),e.strm.avail_out===0)?en:Ia},CI=(e,t)=>{let n;for(;;){if(e.lookahead===0&&(pa(e),e.lookahead===0)){if(t===vs)return en;break}if(e.match_length=0,n=ys(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(xn(e,!1),e.strm.avail_out===0))return en}return e.insert=0,t===Rn?(xn(e,!0),e.strm.avail_out===0?di:Ra):e.sym_next&&(xn(e,!1),e.strm.avail_out===0)?en:Ia};function ir(e,t,n,r,i){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=r,this.func=i}const oo=[new ir(0,0,0,0,Tb),new ir(4,4,8,4,yd),new ir(4,5,16,8,yd),new ir(4,6,32,32,yd),new ir(4,4,16,16,Ri),new ir(8,16,32,32,Ri),new ir(8,16,128,128,Ri),new ir(8,32,128,256,Ri),new ir(32,128,258,1024,Ri),new ir(32,258,258,4096,Ri)],kI=e=>{e.window_size=2*e.w_size,Xr(e.head),e.max_lazy_match=oo[e.level].max_lazy,e.good_match=oo[e.level].good_length,e.nice_match=oo[e.level].nice_length,e.max_chain_length=oo[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=Pe-1,e.match_available=0,e.ins_h=0};function II(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=vu,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(bI*2),this.dyn_dtree=new Uint16Array((2*xI+1)*2),this.bl_tree=new Uint16Array((2*jI+1)*2),Xr(this.dyn_ltree),Xr(this.dyn_dtree),Xr(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(wI+1),this.heap=new Uint16Array(2*Vh+1),Xr(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*Vh+1),Xr(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const il=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.status!==fa&&t.status!==Ip&&t.status!==$h&&t.status!==Fh&&t.status!==Hh&&t.status!==qh&&t.status!==Qs&&t.status!==ao?1:0},Ob=e=>{if(il(e))return Zs(e,gr);e.total_in=e.total_out=0,e.data_type=fI;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap===2?Ip:t.wrap?fa:Qs,e.adler=t.wrap===2?0:1,t.last_flush=-2,tI(t),Mt},Pb=e=>{const t=Ob(e);return t===Mt&&kI(e.state),t},RI=(e,t)=>il(e)||e.state.wrap!==2?gr:(e.state.gzhead=t,Mt),Lb=(e,t,n,r,i,a)=>{if(!e)return gr;let o=1;if(t===lI&&(t=6),r<0?(o=0,r=-r):r>15&&(o=2,r-=16),i<1||i>pI||n!==vu||r<8||r>15||t<0||t>9||a<0||a>dI||r===8&&o!==1)return Zs(e,gr);r===8&&(r=9);const l=new II;return e.state=l,l.strm=e,l.status=fa,l.wrap=o,l.gzhead=null,l.w_bits=r,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=i+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+Pe-1)/Pe),l.window=new Uint8Array(l.w_size*2),l.head=new Uint16Array(l.hash_size),l.prev=new Uint16Array(l.w_size),l.lit_bufsize=1<<i+6,l.pending_buf_size=l.lit_bufsize*4,l.pending_buf=new Uint8Array(l.pending_buf_size),l.sym_buf=l.lit_bufsize,l.sym_end=(l.lit_bufsize-1)*3,l.level=t,l.strategy=a,l.method=n,Pb(e)},TI=(e,t)=>Lb(e,t,vu,mI,gI,hI),OI=(e,t)=>{if(il(e)||t>Hg||t<0)return e?Zs(e,gr):gr;const n=e.state;if(!e.output||e.avail_in!==0&&!e.input||n.status===ao&&t!==Rn)return Zs(e,e.avail_out===0?gd:gr);const r=n.last_flush;if(n.last_flush=t,n.pending!==0){if(gn(e),e.avail_out===0)return n.last_flush=-1,Mt}else if(e.avail_in===0&&zg(t)<=zg(r)&&t!==Rn)return Zs(e,gd);if(n.status===ao&&e.avail_in!==0)return Zs(e,gd);if(n.status===fa&&n.wrap===0&&(n.status=Qs),n.status===fa){let i=vu+(n.w_bits-8<<4)<<8,a=-1;if(n.strategy>=Ll||n.level<2?a=0:n.level<6?a=1:n.level===6?a=2:a=3,i|=a<<6,n.strstart!==0&&(i|=SI),i+=31-i%31,Ya(n,i),n.strstart!==0&&(Ya(n,e.adler>>>16),Ya(n,e.adler&65535)),e.adler=1,n.status=Qs,gn(e),n.pending!==0)return n.last_flush=-1,Mt}if(n.status===Ip){if(e.adler=0,He(n,31),He(n,139),He(n,8),n.gzhead)He(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),He(n,n.gzhead.time&255),He(n,n.gzhead.time>>8&255),He(n,n.gzhead.time>>16&255),He(n,n.gzhead.time>>24&255),He(n,n.level===9?2:n.strategy>=Ll||n.level<2?4:0),He(n,n.gzhead.os&255),n.gzhead.extra&&n.gzhead.extra.length&&(He(n,n.gzhead.extra.length&255),He(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(e.adler=Yr(e.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=$h;else if(He(n,0),He(n,0),He(n,0),He(n,0),He(n,0),He(n,n.level===9?2:n.strategy>=Ll||n.level<2?4:0),He(n,EI),n.status=Qs,gn(e),n.pending!==0)return n.last_flush=-1,Mt}if(n.status===$h){if(n.gzhead.extra){let i=n.pending,a=(n.gzhead.extra.length&65535)-n.gzindex;for(;n.pending+a>n.pending_buf_size;){let l=n.pending_buf_size-n.pending;if(n.pending_buf.set(n.gzhead.extra.subarray(n.gzindex,n.gzindex+l),n.pending),n.pending=n.pending_buf_size,n.gzhead.hcrc&&n.pending>i&&(e.adler=Yr(e.adler,n.pending_buf,n.pending-i,i)),n.gzindex+=l,gn(e),n.pending!==0)return n.last_flush=-1,Mt;i=0,a-=l}let o=new Uint8Array(n.gzhead.extra);n.pending_buf.set(o.subarray(n.gzindex,n.gzindex+a),n.pending),n.pending+=a,n.gzhead.hcrc&&n.pending>i&&(e.adler=Yr(e.adler,n.pending_buf,n.pending-i,i)),n.gzindex=0}n.status=Fh}if(n.status===Fh){if(n.gzhead.name){let i=n.pending,a;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>i&&(e.adler=Yr(e.adler,n.pending_buf,n.pending-i,i)),gn(e),n.pending!==0)return n.last_flush=-1,Mt;i=0}n.gzindex<n.gzhead.name.length?a=n.gzhead.name.charCodeAt(n.gzindex++)&255:a=0,He(n,a)}while(a!==0);n.gzhead.hcrc&&n.pending>i&&(e.adler=Yr(e.adler,n.pending_buf,n.pending-i,i)),n.gzindex=0}n.status=Hh}if(n.status===Hh){if(n.gzhead.comment){let i=n.pending,a;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>i&&(e.adler=Yr(e.adler,n.pending_buf,n.pending-i,i)),gn(e),n.pending!==0)return n.last_flush=-1,Mt;i=0}n.gzindex<n.gzhead.comment.length?a=n.gzhead.comment.charCodeAt(n.gzindex++)&255:a=0,He(n,a)}while(a!==0);n.gzhead.hcrc&&n.pending>i&&(e.adler=Yr(e.adler,n.pending_buf,n.pending-i,i))}n.status=qh}if(n.status===qh){if(n.gzhead.hcrc){if(n.pending+2>n.pending_buf_size&&(gn(e),n.pending!==0))return n.last_flush=-1,Mt;He(n,e.adler&255),He(n,e.adler>>8&255),e.adler=0}if(n.status=Qs,gn(e),n.pending!==0)return n.last_flush=-1,Mt}if(e.avail_in!==0||n.lookahead!==0||t!==vs&&n.status!==ao){let i=n.level===0?Tb(n,t):n.strategy===Ll?CI(n,t):n.strategy===uI?AI(n,t):oo[n.level].func(n,t);if((i===di||i===Ra)&&(n.status=ao),i===en||i===di)return e.avail_out===0&&(n.last_flush=-1),Mt;if(i===Ia&&(t===iI?rI(n):t!==Hg&&(Bh(n,0,0,!1),t===aI&&(Xr(n.head),n.lookahead===0&&(n.strstart=0,n.block_start=0,n.insert=0))),gn(e),e.avail_out===0))return n.last_flush=-1,Mt}return t!==Rn?Mt:n.wrap<=0?qg:(n.wrap===2?(He(n,e.adler&255),He(n,e.adler>>8&255),He(n,e.adler>>16&255),He(n,e.adler>>24&255),He(n,e.total_in&255),He(n,e.total_in>>8&255),He(n,e.total_in>>16&255),He(n,e.total_in>>24&255)):(Ya(n,e.adler>>>16),Ya(n,e.adler&65535)),gn(e),n.wrap>0&&(n.wrap=-n.wrap),n.pending!==0?Mt:qg)},PI=e=>{if(il(e))return gr;const t=e.state.status;return e.state=null,t===Qs?Zs(e,oI):Mt},LI=(e,t)=>{let n=t.length;if(il(e))return gr;const r=e.state,i=r.wrap;if(i===2||i===1&&r.status!==fa||r.lookahead)return gr;if(i===1&&(e.adler=Ib(e.adler,t,n,0)),r.wrap=0,n>=r.w_size){i===0&&(Xr(r.head),r.strstart=0,r.block_start=0,r.insert=0);let c=new Uint8Array(r.w_size);c.set(t.subarray(n-r.w_size,n),0),t=c,n=r.w_size}const a=e.avail_in,o=e.next_in,l=e.input;for(e.avail_in=n,e.next_in=0,e.input=t,pa(r);r.lookahead>=Pe;){let c=r.strstart,u=r.lookahead-(Pe-1);do r.ins_h=xs(r,r.ins_h,r.window[c+Pe-1]),r.prev[c&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=c,c++;while(--u);r.strstart=c,r.lookahead=Pe-1,pa(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=Pe-1,r.match_available=0,e.next_in=o,e.input=l,e.avail_in=a,r.wrap=i,Mt};br.deflateInit=TI;br.deflateInit2=Lb;br.deflateReset=Pb;br.deflateResetKeep=Ob;br.deflateSetHeader=RI;br.deflate=OI;br.deflateEnd=PI;br.deflateSetDictionary=LI;br.deflateInfo="pako deflate (from Nodeca project)";var xu={};const DI=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);xu.assign=function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const n=t.shift();if(n){if(typeof n!="object")throw new TypeError(n+"must be non-object");for(const r in n)DI(n,r)&&(e[r]=n[r])}}return e};xu.flattenChunks=e=>{let t=0;for(let r=0,i=e.length;r<i;r++)t+=e[r].length;const n=new Uint8Array(t);for(let r=0,i=0,a=e.length;r<a;r++){let o=e[r];n.set(o,i),i+=o.length}return n};var al={};let Db=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{Db=!1}const Yo=new Uint8Array(256);for(let e=0;e<256;e++)Yo[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;Yo[254]=Yo[254]=1;al.string2buf=e=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(e);let t,n,r,i,a,o=e.length,l=0;for(i=0;i<o;i++)n=e.charCodeAt(i),(n&64512)===55296&&i+1<o&&(r=e.charCodeAt(i+1),(r&64512)===56320&&(n=65536+(n-55296<<10)+(r-56320),i++)),l+=n<128?1:n<2048?2:n<65536?3:4;for(t=new Uint8Array(l),a=0,i=0;a<l;i++)n=e.charCodeAt(i),(n&64512)===55296&&i+1<o&&(r=e.charCodeAt(i+1),(r&64512)===56320&&(n=65536+(n-55296<<10)+(r-56320),i++)),n<128?t[a++]=n:n<2048?(t[a++]=192|n>>>6,t[a++]=128|n&63):n<65536?(t[a++]=224|n>>>12,t[a++]=128|n>>>6&63,t[a++]=128|n&63):(t[a++]=240|n>>>18,t[a++]=128|n>>>12&63,t[a++]=128|n>>>6&63,t[a++]=128|n&63);return t};const MI=(e,t)=>{if(t<65534&&e.subarray&&Db)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let n="";for(let r=0;r<t;r++)n+=String.fromCharCode(e[r]);return n};al.buf2string=(e,t)=>{const n=t||e.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(e.subarray(0,t));let r,i;const a=new Array(n*2);for(i=0,r=0;r<n;){let o=e[r++];if(o<128){a[i++]=o;continue}let l=Yo[o];if(l>4){a[i++]=65533,r+=l-1;continue}for(o&=l===2?31:l===3?15:7;l>1&&r<n;)o=o<<6|e[r++]&63,l--;if(l>1){a[i++]=65533;continue}o<65536?a[i++]=o:(o-=65536,a[i++]=55296|o>>10&1023,a[i++]=56320|o&1023)}return MI(a,i)};al.utf8border=(e,t)=>{t=t||e.length,t>e.length&&(t=e.length);let n=t-1;for(;n>=0&&(e[n]&192)===128;)n--;return n<0||n===0?t:n+Yo[e[n]]>t?n:t};function UI(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var Mb=UI;const jo=br,Ub=xu,Bb=al,Wh=kp,BI=Mb,Vb=Object.prototype.toString,{Z_NO_FLUSH:VI,Z_SYNC_FLUSH:$I,Z_FULL_FLUSH:FI,Z_FINISH:HI,Z_OK:zc,Z_STREAM_END:qI,Z_DEFAULT_COMPRESSION:zI,Z_DEFAULT_STRATEGY:WI,Z_DEFLATED:GI}=gi;function ol(e){this.options=Ub.assign({level:zI,method:GI,chunkSize:16384,windowBits:15,memLevel:8,strategy:WI},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new BI,this.strm.avail_out=0;let n=jo.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(n!==zc)throw new Error(Wh[n]);if(t.header&&jo.deflateSetHeader(this.strm,t.header),t.dictionary){let r;if(typeof t.dictionary=="string"?r=Bb.string2buf(t.dictionary):Vb.call(t.dictionary)==="[object ArrayBuffer]"?r=new Uint8Array(t.dictionary):r=t.dictionary,n=jo.deflateSetDictionary(this.strm,r),n!==zc)throw new Error(Wh[n]);this._dict_set=!0}}ol.prototype.push=function(e,t){const n=this.strm,r=this.options.chunkSize;let i,a;if(this.ended)return!1;for(t===~~t?a=t:a=t===!0?HI:VI,typeof e=="string"?n.input=Bb.string2buf(e):Vb.call(e)==="[object ArrayBuffer]"?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;){if(n.avail_out===0&&(n.output=new Uint8Array(r),n.next_out=0,n.avail_out=r),(a===$I||a===FI)&&n.avail_out<=6){this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;continue}if(i=jo.deflate(n,a),i===qI)return n.next_out>0&&this.onData(n.output.subarray(0,n.next_out)),i=jo.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===zc;if(n.avail_out===0){this.onData(n.output);continue}if(a>0&&n.next_out>0){this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;continue}if(n.avail_in===0)break}return!0};ol.prototype.onData=function(e){this.chunks.push(e)};ol.prototype.onEnd=function(e){e===zc&&(this.result=Ub.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function Rp(e,t){const n=new ol(t);if(n.push(e,!0),n.err)throw n.msg||Wh[n.err];return n.result}function YI(e,t){return t=t||{},t.raw=!0,Rp(e,t)}function KI(e,t){return t=t||{},t.gzip=!0,Rp(e,t)}Aa.Deflate=ol;Aa.deflate=Rp;Aa.deflateRaw=YI;Aa.gzip=KI;Aa.constants=gi;var Ta={},er={};const Dl=16209,JI=16191;var QI=function(t,n){let r,i,a,o,l,c,u,d,p,h,f,v,j,_,m,y,b,N,A,E,R,I,T,L;const B=t.state;r=t.next_in,T=t.input,i=r+(t.avail_in-5),a=t.next_out,L=t.output,o=a-(n-t.avail_out),l=a+(t.avail_out-257),c=B.dmax,u=B.wsize,d=B.whave,p=B.wnext,h=B.window,f=B.hold,v=B.bits,j=B.lencode,_=B.distcode,m=(1<<B.lenbits)-1,y=(1<<B.distbits)-1;e:do{v<15&&(f+=T[r++]<<v,v+=8,f+=T[r++]<<v,v+=8),b=j[f&m];t:for(;;){if(N=b>>>24,f>>>=N,v-=N,N=b>>>16&255,N===0)L[a++]=b&65535;else if(N&16){A=b&65535,N&=15,N&&(v<N&&(f+=T[r++]<<v,v+=8),A+=f&(1<<N)-1,f>>>=N,v-=N),v<15&&(f+=T[r++]<<v,v+=8,f+=T[r++]<<v,v+=8),b=_[f&y];n:for(;;){if(N=b>>>24,f>>>=N,v-=N,N=b>>>16&255,N&16){if(E=b&65535,N&=15,v<N&&(f+=T[r++]<<v,v+=8,v<N&&(f+=T[r++]<<v,v+=8)),E+=f&(1<<N)-1,E>c){t.msg="invalid distance too far back",B.mode=Dl;break e}if(f>>>=N,v-=N,N=a-o,E>N){if(N=E-N,N>d&&B.sane){t.msg="invalid distance too far back",B.mode=Dl;break e}if(R=0,I=h,p===0){if(R+=u-N,N<A){A-=N;do L[a++]=h[R++];while(--N);R=a-E,I=L}}else if(p<N){if(R+=u+p-N,N-=p,N<A){A-=N;do L[a++]=h[R++];while(--N);if(R=0,p<A){N=p,A-=N;do L[a++]=h[R++];while(--N);R=a-E,I=L}}}else if(R+=p-N,N<A){A-=N;do L[a++]=h[R++];while(--N);R=a-E,I=L}for(;A>2;)L[a++]=I[R++],L[a++]=I[R++],L[a++]=I[R++],A-=3;A&&(L[a++]=I[R++],A>1&&(L[a++]=I[R++]))}else{R=a-E;do L[a++]=L[R++],L[a++]=L[R++],L[a++]=L[R++],A-=3;while(A>2);A&&(L[a++]=L[R++],A>1&&(L[a++]=L[R++]))}}else if(N&64){t.msg="invalid distance code",B.mode=Dl;break e}else{b=_[(b&65535)+(f&(1<<N)-1)];continue n}break}}else if(N&64)if(N&32){B.mode=JI;break e}else{t.msg="invalid literal/length code",B.mode=Dl;break e}else{b=j[(b&65535)+(f&(1<<N)-1)];continue t}break}}while(r<i&&a<l);A=v>>3,r-=A,v-=A<<3,f&=(1<<v)-1,t.next_in=r,t.next_out=a,t.avail_in=r<i?5+(i-r):5-(r-i),t.avail_out=a<l?257+(l-a):257-(a-l),B.hold=f,B.bits=v};const Ti=15,Wg=852,Gg=592,Yg=0,vd=1,Kg=2,ZI=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),XI=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),eR=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),tR=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),nR=(e,t,n,r,i,a,o,l)=>{const c=l.bits;let u=0,d=0,p=0,h=0,f=0,v=0,j=0,_=0,m=0,y=0,b,N,A,E,R,I=null,T;const L=new Uint16Array(Ti+1),B=new Uint16Array(Ti+1);let W=null,z,P,V;for(u=0;u<=Ti;u++)L[u]=0;for(d=0;d<r;d++)L[t[n+d]]++;for(f=c,h=Ti;h>=1&&L[h]===0;h--);if(f>h&&(f=h),h===0)return i[a++]=1<<24|64<<16|0,i[a++]=1<<24|64<<16|0,l.bits=1,0;for(p=1;p<h&&L[p]===0;p++);for(f<p&&(f=p),_=1,u=1;u<=Ti;u++)if(_<<=1,_-=L[u],_<0)return-1;if(_>0&&(e===Yg||h!==1))return-1;for(B[1]=0,u=1;u<Ti;u++)B[u+1]=B[u]+L[u];for(d=0;d<r;d++)t[n+d]!==0&&(o[B[t[n+d]]++]=d);if(e===Yg?(I=W=o,T=20):e===vd?(I=ZI,W=XI,T=257):(I=eR,W=tR,T=0),y=0,d=0,u=p,R=a,v=f,j=0,A=-1,m=1<<f,E=m-1,e===vd&&m>Wg||e===Kg&&m>Gg)return 1;for(;;){z=u-j,o[d]+1<T?(P=0,V=o[d]):o[d]>=T?(P=W[o[d]-T],V=I[o[d]-T]):(P=96,V=0),b=1<<u-j,N=1<<v,p=N;do N-=b,i[R+(y>>j)+N]=z<<24|P<<16|V|0;while(N!==0);for(b=1<<u-1;y&b;)b>>=1;if(b!==0?(y&=b-1,y+=b):y=0,d++,--L[u]===0){if(u===h)break;u=t[n+o[d]]}if(u>f&&(y&E)!==A){for(j===0&&(j=f),R+=p,v=u-j,_=1<<v;v+j<h&&(_-=L[v+j],!(_<=0));)v++,_<<=1;if(m+=1<<v,e===vd&&m>Wg||e===Kg&&m>Gg)return 1;A=y&E,i[A]=f<<24|v<<16|R-a|0}}return y!==0&&(i[R+y]=u-j<<24|64<<16|0),l.bits=f,0};var rR=nR;const Gh=Cb,ar=kb,sR=QI,bo=rR,iR=0,$b=1,Fb=2,{Z_FINISH:Jg,Z_BLOCK:aR,Z_TREES:Ml,Z_OK:hi,Z_STREAM_END:oR,Z_NEED_DICT:lR,Z_STREAM_ERROR:Dn,Z_DATA_ERROR:Hb,Z_MEM_ERROR:qb,Z_BUF_ERROR:cR,Z_DEFLATED:Qg}=gi,ju=16180,Zg=16181,Xg=16182,ey=16183,ty=16184,ny=16185,ry=16186,sy=16187,iy=16188,ay=16189,Wc=16190,Nr=16191,xd=16192,oy=16193,jd=16194,ly=16195,cy=16196,uy=16197,dy=16198,Ul=16199,Bl=16200,hy=16201,fy=16202,py=16203,my=16204,gy=16205,bd=16206,yy=16207,vy=16208,tt=16209,zb=16210,Wb=16211,uR=852,dR=592,hR=15,fR=hR,xy=e=>(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24);function pR(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const yi=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<ju||t.mode>Wb?1:0},Gb=e=>{if(yi(e))return Dn;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=t.wrap&1),t.mode=ju,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(uR),t.distcode=t.distdyn=new Int32Array(dR),t.sane=1,t.back=-1,hi},Yb=e=>{if(yi(e))return Dn;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,Gb(e)},Kb=(e,t)=>{let n;if(yi(e))return Dn;const r=e.state;return t<0?(n=0,t=-t):(n=(t>>4)+5,t<48&&(t&=15)),t&&(t<8||t>15)?Dn:(r.window!==null&&r.wbits!==t&&(r.window=null),r.wrap=n,r.wbits=t,Yb(e))},Jb=(e,t)=>{if(!e)return Dn;const n=new pR;e.state=n,n.strm=e,n.window=null,n.mode=ju;const r=Kb(e,t);return r!==hi&&(e.state=null),r},mR=e=>Jb(e,fR);let jy=!0,wd,Sd;const gR=e=>{if(jy){wd=new Int32Array(512),Sd=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(bo($b,e.lens,0,288,wd,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;bo(Fb,e.lens,0,32,Sd,0,e.work,{bits:5}),jy=!1}e.lencode=wd,e.lenbits=9,e.distcode=Sd,e.distbits=5},Qb=(e,t,n,r)=>{let i;const a=e.state;return a.window===null&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new Uint8Array(a.wsize)),r>=a.wsize?(a.window.set(t.subarray(n-a.wsize,n),0),a.wnext=0,a.whave=a.wsize):(i=a.wsize-a.wnext,i>r&&(i=r),a.window.set(t.subarray(n-r,n-r+i),a.wnext),r-=i,r?(a.window.set(t.subarray(n-r,n),0),a.wnext=r,a.whave=a.wsize):(a.wnext+=i,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=i))),0},yR=(e,t)=>{let n,r,i,a,o,l,c,u,d,p,h,f,v,j,_=0,m,y,b,N,A,E,R,I;const T=new Uint8Array(4);let L,B;const W=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(yi(e)||!e.output||!e.input&&e.avail_in!==0)return Dn;n=e.state,n.mode===Nr&&(n.mode=xd),o=e.next_out,i=e.output,c=e.avail_out,a=e.next_in,r=e.input,l=e.avail_in,u=n.hold,d=n.bits,p=l,h=c,I=hi;e:for(;;)switch(n.mode){case ju:if(n.wrap===0){n.mode=xd;break}for(;d<16;){if(l===0)break e;l--,u+=r[a++]<<d,d+=8}if(n.wrap&2&&u===35615){n.wbits===0&&(n.wbits=15),n.check=0,T[0]=u&255,T[1]=u>>>8&255,n.check=ar(n.check,T,2,0),u=0,d=0,n.mode=Zg;break}if(n.head&&(n.head.done=!1),!(n.wrap&1)||(((u&255)<<8)+(u>>8))%31){e.msg="incorrect header check",n.mode=tt;break}if((u&15)!==Qg){e.msg="unknown compression method",n.mode=tt;break}if(u>>>=4,d-=4,R=(u&15)+8,n.wbits===0&&(n.wbits=R),R>15||R>n.wbits){e.msg="invalid window size",n.mode=tt;break}n.dmax=1<<n.wbits,n.flags=0,e.adler=n.check=1,n.mode=u&512?ay:Nr,u=0,d=0;break;case Zg:for(;d<16;){if(l===0)break e;l--,u+=r[a++]<<d,d+=8}if(n.flags=u,(n.flags&255)!==Qg){e.msg="unknown compression method",n.mode=tt;break}if(n.flags&57344){e.msg="unknown header flags set",n.mode=tt;break}n.head&&(n.head.text=u>>8&1),n.flags&512&&n.wrap&4&&(T[0]=u&255,T[1]=u>>>8&255,n.check=ar(n.check,T,2,0)),u=0,d=0,n.mode=Xg;case Xg:for(;d<32;){if(l===0)break e;l--,u+=r[a++]<<d,d+=8}n.head&&(n.head.time=u),n.flags&512&&n.wrap&4&&(T[0]=u&255,T[1]=u>>>8&255,T[2]=u>>>16&255,T[3]=u>>>24&255,n.check=ar(n.check,T,4,0)),u=0,d=0,n.mode=ey;case ey:for(;d<16;){if(l===0)break e;l--,u+=r[a++]<<d,d+=8}n.head&&(n.head.xflags=u&255,n.head.os=u>>8),n.flags&512&&n.wrap&4&&(T[0]=u&255,T[1]=u>>>8&255,n.check=ar(n.check,T,2,0)),u=0,d=0,n.mode=ty;case ty:if(n.flags&1024){for(;d<16;){if(l===0)break e;l--,u+=r[a++]<<d,d+=8}n.length=u,n.head&&(n.head.extra_len=u),n.flags&512&&n.wrap&4&&(T[0]=u&255,T[1]=u>>>8&255,n.check=ar(n.check,T,2,0)),u=0,d=0}else n.head&&(n.head.extra=null);n.mode=ny;case ny:if(n.flags&1024&&(f=n.length,f>l&&(f=l),f&&(n.head&&(R=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(r.subarray(a,a+f),R)),n.flags&512&&n.wrap&4&&(n.check=ar(n.check,r,f,a)),l-=f,a+=f,n.length-=f),n.length))break e;n.length=0,n.mode=ry;case ry:if(n.flags&2048){if(l===0)break e;f=0;do R=r[a+f++],n.head&&R&&n.length<65536&&(n.head.name+=String.fromCharCode(R));while(R&&f<l);if(n.flags&512&&n.wrap&4&&(n.check=ar(n.check,r,f,a)),l-=f,a+=f,R)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=sy;case sy:if(n.flags&4096){if(l===0)break e;f=0;do R=r[a+f++],n.head&&R&&n.length<65536&&(n.head.comment+=String.fromCharCode(R));while(R&&f<l);if(n.flags&512&&n.wrap&4&&(n.check=ar(n.check,r,f,a)),l-=f,a+=f,R)break e}else n.head&&(n.head.comment=null);n.mode=iy;case iy:if(n.flags&512){for(;d<16;){if(l===0)break e;l--,u+=r[a++]<<d,d+=8}if(n.wrap&4&&u!==(n.check&65535)){e.msg="header crc mismatch",n.mode=tt;break}u=0,d=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=Nr;break;case ay:for(;d<32;){if(l===0)break e;l--,u+=r[a++]<<d,d+=8}e.adler=n.check=xy(u),u=0,d=0,n.mode=Wc;case Wc:if(n.havedict===0)return e.next_out=o,e.avail_out=c,e.next_in=a,e.avail_in=l,n.hold=u,n.bits=d,lR;e.adler=n.check=1,n.mode=Nr;case Nr:if(t===aR||t===Ml)break e;case xd:if(n.last){u>>>=d&7,d-=d&7,n.mode=bd;break}for(;d<3;){if(l===0)break e;l--,u+=r[a++]<<d,d+=8}switch(n.last=u&1,u>>>=1,d-=1,u&3){case 0:n.mode=oy;break;case 1:if(gR(n),n.mode=Ul,t===Ml){u>>>=2,d-=2;break e}break;case 2:n.mode=cy;break;case 3:e.msg="invalid block type",n.mode=tt}u>>>=2,d-=2;break;case oy:for(u>>>=d&7,d-=d&7;d<32;){if(l===0)break e;l--,u+=r[a++]<<d,d+=8}if((u&65535)!==(u>>>16^65535)){e.msg="invalid stored block lengths",n.mode=tt;break}if(n.length=u&65535,u=0,d=0,n.mode=jd,t===Ml)break e;case jd:n.mode=ly;case ly:if(f=n.length,f){if(f>l&&(f=l),f>c&&(f=c),f===0)break e;i.set(r.subarray(a,a+f),o),l-=f,a+=f,c-=f,o+=f,n.length-=f;break}n.mode=Nr;break;case cy:for(;d<14;){if(l===0)break e;l--,u+=r[a++]<<d,d+=8}if(n.nlen=(u&31)+257,u>>>=5,d-=5,n.ndist=(u&31)+1,u>>>=5,d-=5,n.ncode=(u&15)+4,u>>>=4,d-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=tt;break}n.have=0,n.mode=uy;case uy:for(;n.have<n.ncode;){for(;d<3;){if(l===0)break e;l--,u+=r[a++]<<d,d+=8}n.lens[W[n.have++]]=u&7,u>>>=3,d-=3}for(;n.have<19;)n.lens[W[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,L={bits:n.lenbits},I=bo(iR,n.lens,0,19,n.lencode,0,n.work,L),n.lenbits=L.bits,I){e.msg="invalid code lengths set",n.mode=tt;break}n.have=0,n.mode=dy;case dy:for(;n.have<n.nlen+n.ndist;){for(;_=n.lencode[u&(1<<n.lenbits)-1],m=_>>>24,y=_>>>16&255,b=_&65535,!(m<=d);){if(l===0)break e;l--,u+=r[a++]<<d,d+=8}if(b<16)u>>>=m,d-=m,n.lens[n.have++]=b;else{if(b===16){for(B=m+2;d<B;){if(l===0)break e;l--,u+=r[a++]<<d,d+=8}if(u>>>=m,d-=m,n.have===0){e.msg="invalid bit length repeat",n.mode=tt;break}R=n.lens[n.have-1],f=3+(u&3),u>>>=2,d-=2}else if(b===17){for(B=m+3;d<B;){if(l===0)break e;l--,u+=r[a++]<<d,d+=8}u>>>=m,d-=m,R=0,f=3+(u&7),u>>>=3,d-=3}else{for(B=m+7;d<B;){if(l===0)break e;l--,u+=r[a++]<<d,d+=8}u>>>=m,d-=m,R=0,f=11+(u&127),u>>>=7,d-=7}if(n.have+f>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=tt;break}for(;f--;)n.lens[n.have++]=R}}if(n.mode===tt)break;if(n.lens[256]===0){e.msg="invalid code -- missing end-of-block",n.mode=tt;break}if(n.lenbits=9,L={bits:n.lenbits},I=bo($b,n.lens,0,n.nlen,n.lencode,0,n.work,L),n.lenbits=L.bits,I){e.msg="invalid literal/lengths set",n.mode=tt;break}if(n.distbits=6,n.distcode=n.distdyn,L={bits:n.distbits},I=bo(Fb,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,L),n.distbits=L.bits,I){e.msg="invalid distances set",n.mode=tt;break}if(n.mode=Ul,t===Ml)break e;case Ul:n.mode=Bl;case Bl:if(l>=6&&c>=258){e.next_out=o,e.avail_out=c,e.next_in=a,e.avail_in=l,n.hold=u,n.bits=d,sR(e,h),o=e.next_out,i=e.output,c=e.avail_out,a=e.next_in,r=e.input,l=e.avail_in,u=n.hold,d=n.bits,n.mode===Nr&&(n.back=-1);break}for(n.back=0;_=n.lencode[u&(1<<n.lenbits)-1],m=_>>>24,y=_>>>16&255,b=_&65535,!(m<=d);){if(l===0)break e;l--,u+=r[a++]<<d,d+=8}if(y&&!(y&240)){for(N=m,A=y,E=b;_=n.lencode[E+((u&(1<<N+A)-1)>>N)],m=_>>>24,y=_>>>16&255,b=_&65535,!(N+m<=d);){if(l===0)break e;l--,u+=r[a++]<<d,d+=8}u>>>=N,d-=N,n.back+=N}if(u>>>=m,d-=m,n.back+=m,n.length=b,y===0){n.mode=gy;break}if(y&32){n.back=-1,n.mode=Nr;break}if(y&64){e.msg="invalid literal/length code",n.mode=tt;break}n.extra=y&15,n.mode=hy;case hy:if(n.extra){for(B=n.extra;d<B;){if(l===0)break e;l--,u+=r[a++]<<d,d+=8}n.length+=u&(1<<n.extra)-1,u>>>=n.extra,d-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=fy;case fy:for(;_=n.distcode[u&(1<<n.distbits)-1],m=_>>>24,y=_>>>16&255,b=_&65535,!(m<=d);){if(l===0)break e;l--,u+=r[a++]<<d,d+=8}if(!(y&240)){for(N=m,A=y,E=b;_=n.distcode[E+((u&(1<<N+A)-1)>>N)],m=_>>>24,y=_>>>16&255,b=_&65535,!(N+m<=d);){if(l===0)break e;l--,u+=r[a++]<<d,d+=8}u>>>=N,d-=N,n.back+=N}if(u>>>=m,d-=m,n.back+=m,y&64){e.msg="invalid distance code",n.mode=tt;break}n.offset=b,n.extra=y&15,n.mode=py;case py:if(n.extra){for(B=n.extra;d<B;){if(l===0)break e;l--,u+=r[a++]<<d,d+=8}n.offset+=u&(1<<n.extra)-1,u>>>=n.extra,d-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=tt;break}n.mode=my;case my:if(c===0)break e;if(f=h-c,n.offset>f){if(f=n.offset-f,f>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=tt;break}f>n.wnext?(f-=n.wnext,v=n.wsize-f):v=n.wnext-f,f>n.length&&(f=n.length),j=n.window}else j=i,v=o-n.offset,f=n.length;f>c&&(f=c),c-=f,n.length-=f;do i[o++]=j[v++];while(--f);n.length===0&&(n.mode=Bl);break;case gy:if(c===0)break e;i[o++]=n.length,c--,n.mode=Bl;break;case bd:if(n.wrap){for(;d<32;){if(l===0)break e;l--,u|=r[a++]<<d,d+=8}if(h-=c,e.total_out+=h,n.total+=h,n.wrap&4&&h&&(e.adler=n.check=n.flags?ar(n.check,i,h,o-h):Gh(n.check,i,h,o-h)),h=c,n.wrap&4&&(n.flags?u:xy(u))!==n.check){e.msg="incorrect data check",n.mode=tt;break}u=0,d=0}n.mode=yy;case yy:if(n.wrap&&n.flags){for(;d<32;){if(l===0)break e;l--,u+=r[a++]<<d,d+=8}if(n.wrap&4&&u!==(n.total&4294967295)){e.msg="incorrect length check",n.mode=tt;break}u=0,d=0}n.mode=vy;case vy:I=oR;break e;case tt:I=Hb;break e;case zb:return qb;case Wb:default:return Dn}return e.next_out=o,e.avail_out=c,e.next_in=a,e.avail_in=l,n.hold=u,n.bits=d,(n.wsize||h!==e.avail_out&&n.mode<tt&&(n.mode<bd||t!==Jg))&&Qb(e,e.output,e.next_out,h-e.avail_out),p-=e.avail_in,h-=e.avail_out,e.total_in+=p,e.total_out+=h,n.total+=h,n.wrap&4&&h&&(e.adler=n.check=n.flags?ar(n.check,i,h,e.next_out-h):Gh(n.check,i,h,e.next_out-h)),e.data_type=n.bits+(n.last?64:0)+(n.mode===Nr?128:0)+(n.mode===Ul||n.mode===jd?256:0),(p===0&&h===0||t===Jg)&&I===hi&&(I=cR),I},vR=e=>{if(yi(e))return Dn;let t=e.state;return t.window&&(t.window=null),e.state=null,hi},xR=(e,t)=>{if(yi(e))return Dn;const n=e.state;return n.wrap&2?(n.head=t,t.done=!1,hi):Dn},jR=(e,t)=>{const n=t.length;let r,i,a;return yi(e)||(r=e.state,r.wrap!==0&&r.mode!==Wc)?Dn:r.mode===Wc&&(i=1,i=Gh(i,t,n,0),i!==r.check)?Hb:(a=Qb(e,t,n,n),a?(r.mode=zb,qb):(r.havedict=1,hi))};er.inflateReset=Yb;er.inflateReset2=Kb;er.inflateResetKeep=Gb;er.inflateInit=mR;er.inflateInit2=Jb;er.inflate=yR;er.inflateEnd=vR;er.inflateGetHeader=xR;er.inflateSetDictionary=jR;er.inflateInfo="pako inflate (from Nodeca project)";function bR(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var wR=bR;const Rr=er,Zb=xu,Yh=al,Kh=kp,SR=Mb,ER=wR,Xb=Object.prototype.toString,{Z_NO_FLUSH:NR,Z_FINISH:_R,Z_OK:Ko,Z_STREAM_END:Ed,Z_NEED_DICT:Nd,Z_STREAM_ERROR:AR,Z_DATA_ERROR:by,Z_MEM_ERROR:CR}=gi;function ll(e){this.options=Zb.assign({chunkSize:1024*64,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(e&&e.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15||(t.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new SR,this.strm.avail_out=0;let n=Rr.inflateInit2(this.strm,t.windowBits);if(n!==Ko)throw new Error(Kh[n]);if(this.header=new ER,Rr.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=Yh.string2buf(t.dictionary):Xb.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(n=Rr.inflateSetDictionary(this.strm,t.dictionary),n!==Ko)))throw new Error(Kh[n])}ll.prototype.push=function(e,t){const n=this.strm,r=this.options.chunkSize,i=this.options.dictionary;let a,o,l;if(this.ended)return!1;for(t===~~t?o=t:o=t===!0?_R:NR,Xb.call(e)==="[object ArrayBuffer]"?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;){for(n.avail_out===0&&(n.output=new Uint8Array(r),n.next_out=0,n.avail_out=r),a=Rr.inflate(n,o),a===Nd&&i&&(a=Rr.inflateSetDictionary(n,i),a===Ko?a=Rr.inflate(n,o):a===by&&(a=Nd));n.avail_in>0&&a===Ed&&n.state.wrap>0&&e[n.next_in]!==0;)Rr.inflateReset(n),a=Rr.inflate(n,o);switch(a){case AR:case by:case Nd:case CR:return this.onEnd(a),this.ended=!0,!1}if(l=n.avail_out,n.next_out&&(n.avail_out===0||a===Ed))if(this.options.to==="string"){let c=Yh.utf8border(n.output,n.next_out),u=n.next_out-c,d=Yh.buf2string(n.output,c);n.next_out=u,n.avail_out=r-u,u&&n.output.set(n.output.subarray(c,c+u),0),this.onData(d)}else this.onData(n.output.length===n.next_out?n.output:n.output.subarray(0,n.next_out));if(!(a===Ko&&l===0)){if(a===Ed)return a=Rr.inflateEnd(this.strm),this.onEnd(a),this.ended=!0,!0;if(n.avail_in===0)break}}return!0};ll.prototype.onData=function(e){this.chunks.push(e)};ll.prototype.onEnd=function(e){e===Ko&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=Zb.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function Tp(e,t){const n=new ll(t);if(n.push(e),n.err)throw n.msg||Kh[n.err];return n.result}function kR(e,t){return t=t||{},t.raw=!0,Tp(e,t)}Ta.Inflate=ll;Ta.inflate=Tp;Ta.inflateRaw=kR;Ta.ungzip=Tp;Ta.constants=gi;const{Deflate:IR,deflate:RR,deflateRaw:TR,gzip:OR}=Aa,{Inflate:PR,inflate:LR,inflateRaw:DR,ungzip:MR}=Ta,UR=gi;jr.Deflate=IR;jr.deflate=RR;jr.deflateRaw=TR;jr.gzip=OR;jr.Inflate=PR;jr.inflate=LR;jr.inflateRaw=DR;jr.ungzip=MR;jr.constants=UR;const BR=new TextEncoder,VR=new TextDecoder("utf-8");function wy(e){return BR.encode(e)}function Jh(e){return VR.decode(e)}function e0(e){if(typeof e!="string")throw new TypeError("value is not a string");if(!/^([0-9a-f][0-9a-f])*$/.test(e))throw new RangeError("value is not hexadecimal");return e===""?new Uint8Array(0):new Uint8Array(e.match(/../g).map(t=>parseInt(t,16)))}const Sy=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],t0=new Array(256);for(let e=0;e<256;e++)t0[e]=`${Sy[e>>>4&15]}${Sy[e&15]}`;function n0(e){let t="",n=e.byteLength;for(let r=0;r<n;r++)t+=t0[e[r]];return t}let Op=class{constructor(){this.buf=new Uint8Array(16),this.offset=0}get buffer(){return this.finish(),this.buf.subarray(0,this.offset)}grow(t=0){let n=this.buf.byteLength*4;for(;n<t;)n*=2;const r=new Uint8Array(n);return r.set(this.buf,0),this.buf=r,this}appendByte(t){this.offset>=this.buf.byteLength&&this.grow(),this.buf[this.offset]=t,this.offset+=1}appendUint32(t){if(!Number.isInteger(t))throw new RangeError("value is not an integer");if(t<0||t>4294967295)throw new RangeError("number out of range");const n=Math.max(1,Math.ceil((32-Math.clz32(t))/7));this.offset+n>this.buf.byteLength&&this.grow();for(let r=0;r<n;r++)this.buf[this.offset+r]=t&127|(r===n-1?0:128),t>>>=7;return this.offset+=n,n}appendInt32(t){if(!Number.isInteger(t))throw new RangeError("value is not an integer");if(t<-2147483648||t>2147483647)throw new RangeError("number out of range");const n=Math.ceil((33-Math.clz32(t>=0?t:-t-1))/7);this.offset+n>this.buf.byteLength&&this.grow();for(let r=0;r<n;r++)this.buf[this.offset+r]=t&127|(r===n-1?0:128),t>>=7;return this.offset+=n,n}appendUint53(t){if(!Number.isInteger(t))throw new RangeError("value is not an integer");if(t<0||t>Number.MAX_SAFE_INTEGER)throw new RangeError("number out of range");const n=Math.floor(t/4294967296),r=(t&4294967295)>>>0;return this.appendUint64(n,r)}appendInt53(t){if(!Number.isInteger(t))throw new RangeError("value is not an integer");if(t<Number.MIN_SAFE_INTEGER||t>Number.MAX_SAFE_INTEGER)throw new RangeError("number out of range");const n=Math.floor(t/4294967296),r=(t&4294967295)>>>0;return this.appendInt64(n,r)}appendUint64(t,n){if(!Number.isInteger(t)||!Number.isInteger(n))throw new RangeError("value is not an integer");if(t<0||t>4294967295||n<0||n>4294967295)throw new RangeError("number out of range");if(t===0)return this.appendUint32(n);const r=Math.ceil((64-Math.clz32(t))/7);this.offset+r>this.buf.byteLength&&this.grow();for(let i=0;i<4;i++)this.buf[this.offset+i]=n&127|128,n>>>=7;this.buf[this.offset+4]=n&15|(t&7)<<4|(r===5?0:128),t>>>=3;for(let i=5;i<r;i++)this.buf[this.offset+i]=t&127|(i===r-1?0:128),t>>>=7;return this.offset+=r,r}appendInt64(t,n){if(!Number.isInteger(t)||!Number.isInteger(n))throw new RangeError("value is not an integer");if(t<-2147483648||t>2147483647||n<-2147483648||n>4294967295)throw new RangeError("number out of range");if(n>>>=0,t===0&&n<=2147483647)return this.appendInt32(n);if(t===-1&&n>=2147483648)return this.appendInt32(n-4294967296);const r=Math.ceil((65-Math.clz32(t>=0?t:-t-1))/7);this.offset+r>this.buf.byteLength&&this.grow();for(let i=0;i<4;i++)this.buf[this.offset+i]=n&127|128,n>>>=7;this.buf[this.offset+4]=n&15|(t&7)<<4|(r===5?0:128),t>>=3;for(let i=5;i<r;i++)this.buf[this.offset+i]=t&127|(i===r-1?0:128),t>>=7;return this.offset+=r,r}appendRawBytes(t){return this.offset+t.byteLength>this.buf.byteLength&&this.grow(this.offset+t.byteLength),this.buf.set(t,this.offset),this.offset+=t.byteLength,t.byteLength}appendRawString(t){if(typeof t!="string")throw new TypeError("value is not a string");return this.appendRawBytes(wy(t))}appendPrefixedBytes(t){return this.appendUint53(t.byteLength),this.appendRawBytes(t),this}appendPrefixedString(t){if(typeof t!="string")throw new TypeError("value is not a string");return this.appendPrefixedBytes(wy(t)),this}appendHexString(t){return this.appendPrefixedBytes(e0(t)),this}finish(){}},Pp=class{constructor(t){if(!(t instanceof Uint8Array))throw new TypeError(`Not a byte array: ${t}`);this.buf=t,this.offset=0}get done(){return this.offset===this.buf.byteLength}reset(){this.offset=0}skip(t){if(this.offset+t>this.buf.byteLength)throw new RangeError("cannot skip beyond end of buffer");this.offset+=t}readByte(){return this.offset+=1,this.buf[this.offset-1]}readUint32(){let t=0,n=0;for(;this.offset<this.buf.byteLength;){const r=this.buf[this.offset];if(n===28&&r&240)throw new RangeError("number out of range");if(t=(t|(r&127)<<n)>>>0,n+=7,this.offset++,!(r&128))return t}throw new RangeError("buffer ended with incomplete number")}readInt32(){let t=0,n=0;for(;this.offset<this.buf.byteLength;){const r=this.buf[this.offset];if(n===28&&r&128||n===28&&!(r&64)&&r&56||n===28&&r&64&&(r&56)!==56)throw new RangeError("number out of range");if(t|=(r&127)<<n,n+=7,this.offset++,!(r&128))return!(r&64)||n>28?t:t|-1<<n}throw new RangeError("buffer ended with incomplete number")}readUint53(){const{low32:t,high32:n}=this.readUint64();if(n<0||n>2097151)throw new RangeError("number out of range");return n*4294967296+t}readInt53(){const{low32:t,high32:n}=this.readInt64();if(n<-2097152||n===-2097152&&t===0||n>2097151)throw new RangeError("number out of range");return n*4294967296+t}readUint64(){let t=0,n=0,r=0;for(;this.offset<this.buf.byteLength&&r<=28;){const i=this.buf[this.offset];if(t=(t|(i&127)<<r)>>>0,r===28&&(n=(i&112)>>>4),r+=7,this.offset++,!(i&128))return{high32:n,low32:t}}for(r=3;this.offset<this.buf.byteLength;){const i=this.buf[this.offset];if(r===31&&i&254)throw new RangeError("number out of range");if(n=(n|(i&127)<<r)>>>0,r+=7,this.offset++,!(i&128))return{high32:n,low32:t}}throw new RangeError("buffer ended with incomplete number")}readInt64(){let t=0,n=0,r=0;for(;this.offset<this.buf.byteLength&&r<=28;){const i=this.buf[this.offset];if(t=(t|(i&127)<<r)>>>0,r===28&&(n=(i&112)>>>4),r+=7,this.offset++,!(i&128))return i&64&&(r<32&&(t=(t|-1<<r)>>>0),n|=-1<<Math.max(r-32,0)),{high32:n,low32:t}}for(r=3;this.offset<this.buf.byteLength;){const i=this.buf[this.offset];if(r===31&&i!==0&&i!==127)throw new RangeError("number out of range");if(n|=(i&127)<<r,r+=7,this.offset++,!(i&128))return i&64&&r<32&&(n|=-1<<r),{high32:n,low32:t}}throw new RangeError("buffer ended with incomplete number")}readRawBytes(t){const n=this.offset;if(n+t>this.buf.byteLength)throw new RangeError("subarray exceeds buffer size");return this.offset+=t,this.buf.subarray(n,this.offset)}readRawString(t){return Jh(this.readRawBytes(t))}readPrefixedBytes(){return this.readRawBytes(this.readUint53())}readPrefixedString(){return Jh(this.readPrefixedBytes())}readHexString(){return n0(this.readPrefixedBytes())}},r0=class extends Op{constructor(t){super(),this.type=t,this.state="empty",this.lastValue=void 0,this.count=0,this.literal=[]}appendValue(t,n=1){this._appendValue(t,n)}_appendValue(t,n=1){n<=0||(this.state==="empty"?(this.state=t===null?"nulls":n===1?"loneValue":"repetition",this.lastValue=t,this.count=n):this.state==="loneValue"?t===null?(this.flush(),this.state="nulls",this.count=n):t===this.lastValue?(this.state="repetition",this.count=1+n):n>1?(this.flush(),this.state="repetition",this.count=n,this.lastValue=t):(this.state="literal",this.literal=[this.lastValue],this.lastValue=t):this.state==="repetition"?t===null?(this.flush(),this.state="nulls",this.count=n):t===this.lastValue?this.count+=n:n>1?(this.flush(),this.state="repetition",this.count=n,this.lastValue=t):(this.flush(),this.state="loneValue",this.lastValue=t):this.state==="literal"?t===null?(this.literal.push(this.lastValue),this.flush(),this.state="nulls",this.count=n):t===this.lastValue?(this.flush(),this.state="repetition",this.count=1+n):n>1?(this.literal.push(this.lastValue),this.flush(),this.state="repetition",this.count=n,this.lastValue=t):(this.literal.push(this.lastValue),this.lastValue=t):this.state==="nulls"&&(t===null?this.count+=n:n>1?(this.flush(),this.state="repetition",this.count=n,this.lastValue=t):(this.flush(),this.state="loneValue",this.lastValue=t)))}copyFrom(t,n={}){const{count:r,sumValues:i,sumShift:a}=n;if(!(t instanceof Lp)||t.type!==this.type)throw new TypeError("incompatible type of decoder");let o=typeof r=="number"?r:Number.MAX_SAFE_INTEGER,l=0,c=0;if(r&&o>0&&t.done)throw new RangeError(`cannot copy ${r} values`);if(o===0||t.done)return i?{nonNullValues:l,sum:c}:{nonNullValues:l};let u=t.readValue();if(u===null){const p=Math.min(t.count+1,o);if(o-=p,t.count-=p-1,this.appendValue(null,p),r&&o>0&&t.done)throw new RangeError(`cannot copy ${r} values`);if(o===0||t.done)return i?{nonNullValues:l,sum:c}:{nonNullValues:l};if(u=t.readValue(),u===null)throw new RangeError("null run must be followed by non-null value")}if(this.appendValue(u),o--,l++,i&&(c+=a?u>>>a:u),r&&o>0&&t.done)throw new RangeError(`cannot copy ${r} values`);if(o===0||t.done)return i?{nonNullValues:l,sum:c}:{nonNullValues:l};let d=t.count>0;for(;o>0&&!t.done;){d||t.readRecord();const p=Math.min(t.count,o);if(t.count-=p,t.state==="literal"){l+=p;for(let h=0;h<p;h++){if(t.done)throw new RangeError("incomplete literal");const f=t.readRawValue();if(f===t.lastValue)throw new RangeError("Repetition of values is not allowed in literal");t.lastValue=f,this._appendValue(f),i&&(c+=a?f>>>a:f)}}else if(t.state==="repetition"){l+=p,i&&(c+=p*(a?t.lastValue>>>a:t.lastValue));const h=t.lastValue;if(this._appendValue(h),p>1){if(this._appendValue(h),this.state!=="repetition")throw new RangeError(`Unexpected state ${this.state}`);this.count+=p-2}}else if(t.state==="nulls"){if(this._appendValue(null),this.state!=="nulls")throw new RangeError(`Unexpected state ${this.state}`);this.count+=p-1}d=!1,o-=p}if(r&&o>0&&t.done)throw new RangeError(`cannot copy ${r} values`);return i?{nonNullValues:l,sum:c}:{nonNullValues:l}}flush(){if(this.state==="loneValue")this.appendInt32(-1),this.appendRawValue(this.lastValue);else if(this.state==="repetition")this.appendInt53(this.count),this.appendRawValue(this.lastValue);else if(this.state==="literal"){this.appendInt53(-this.literal.length);for(let t of this.literal)this.appendRawValue(t)}else this.state==="nulls"&&(this.appendInt32(0),this.appendUint53(this.count));this.state="empty"}appendRawValue(t){if(this.type==="int")this.appendInt53(t);else if(this.type==="uint")this.appendUint53(t);else if(this.type==="utf8")this.appendPrefixedString(t);else throw new RangeError(`Unknown RLEEncoder datatype: ${this.type}`)}finish(){this.state==="literal"&&this.literal.push(this.lastValue),(this.state!=="nulls"||this.offset>0)&&this.flush()}},Lp=class extends Pp{constructor(t,n){super(n),this.type=t,this.lastValue=void 0,this.count=0,this.state=void 0}get done(){return this.count===0&&this.offset===this.buf.byteLength}reset(){this.offset=0,this.lastValue=void 0,this.count=0,this.state=void 0}readValue(){if(this.done)return null;if(this.count===0&&this.readRecord(),this.count-=1,this.state==="literal"){const t=this.readRawValue();if(t===this.lastValue)throw new RangeError("Repetition of values is not allowed in literal");return this.lastValue=t,t}else return this.lastValue}skipValues(t){for(;t>0&&!this.done;){this.count===0&&(this.count=this.readInt53(),this.count>0?(this.lastValue=this.count<=t?this.skipRawValues(1):this.readRawValue(),this.state="repetition"):this.count<0?(this.count=-this.count,this.state="literal"):(this.count=this.readUint53(),this.lastValue=null,this.state="nulls"));const n=Math.min(t,this.count);this.state==="literal"&&this.skipRawValues(n),t-=n,this.count-=n}}readRecord(){if(this.count=this.readInt53(),this.count>1){const t=this.readRawValue();if((this.state==="repetition"||this.state==="literal")&&this.lastValue===t)throw new RangeError("Successive repetitions with the same value are not allowed");this.state="repetition",this.lastValue=t}else{if(this.count===1)throw new RangeError("Repetition count of 1 is not allowed, use a literal instead");if(this.count<0){if(this.count=-this.count,this.state==="literal")throw new RangeError("Successive literals are not allowed");this.state="literal"}else{if(this.state==="nulls")throw new RangeError("Successive null runs are not allowed");if(this.count=this.readUint53(),this.count===0)throw new RangeError("Zero-length null runs are not allowed");this.lastValue=null,this.state="nulls"}}}readRawValue(){if(this.type==="int")return this.readInt53();if(this.type==="uint")return this.readUint53();if(this.type==="utf8")return this.readPrefixedString();throw new RangeError(`Unknown RLEDecoder datatype: ${this.type}`)}skipRawValues(t){if(this.type==="utf8")for(let n=0;n<t;n++)this.skip(this.readUint53());else{for(;t>0&&this.offset<this.buf.byteLength;)this.buf[this.offset]&128||t--,this.offset++;if(t>0)throw new RangeError("cannot skip beyond end of buffer")}}},$R=class extends r0{constructor(){super("int"),this.absoluteValue=0}appendValue(t,n=1){n<=0||(typeof t=="number"?(super.appendValue(t-this.absoluteValue,1),this.absoluteValue=t,n>1&&super.appendValue(0,n-1)):super.appendValue(t,n))}copyFrom(t,n={}){if(n.sumValues)throw new RangeError("unsupported options for DeltaEncoder.copyFrom()");if(!(t instanceof s0))throw new TypeError("incompatible type of decoder");let r=n.count;if(r>0&&t.done)throw new RangeError(`cannot copy ${r} values`);if(r===0||t.done)return;let i=t.readValue(),a=0;if(this.appendValue(i),i===null){if(a=t.count+1,r!==void 0&&r<a&&(a=r),t.count-=a-1,this.count+=a-1,r>a&&t.done)throw new RangeError(`cannot copy ${r} values`);if(r===a||t.done)return;t.count===0&&this.appendValue(t.readValue())}r!==void 0&&(r-=a+1);const{nonNullValues:o,sum:l}=super.copyFrom(t,{count:r,sumValues:!0});o>0&&(this.absoluteValue=l,t.absoluteValue=l)}},s0=class extends Lp{constructor(t){super("int",t),this.absoluteValue=0}reset(){this.offset=0,this.lastValue=void 0,this.count=0,this.state=void 0,this.absoluteValue=0}readValue(){const t=super.readValue();return t===null?null:(this.absoluteValue+=t,this.absoluteValue)}skipValues(t){for(;t>0&&!this.done;){this.count===0&&this.readRecord();const n=Math.min(t,this.count);if(this.state==="literal")for(let r=0;r<n;r++)this.lastValue=this.readRawValue(),this.absoluteValue+=this.lastValue;else this.state==="repetition"&&(this.absoluteValue+=n*this.lastValue);t-=n,this.count-=n}}},FR=class extends Op{constructor(){super(),this.lastValue=!1,this.count=0}appendValue(t,n=1){if(t!==!1&&t!==!0)throw new RangeError(`Unsupported value for BooleanEncoder: ${t}`);n<=0||(this.lastValue===t?this.count+=n:(this.appendUint53(this.count),this.lastValue=t,this.count=n))}copyFrom(t,n={}){if(!(t instanceof i0))throw new TypeError("incompatible type of decoder");const{count:r}=n;let i=typeof r=="number"?r:Number.MAX_SAFE_INTEGER;if(r&&i>0&&t.done)throw new RangeError(`cannot copy ${r} values`);if(i===0||t.done)return;this.appendValue(t.readValue()),i--;const a=Math.min(t.count,i);for(this.count+=a,t.count-=a,i-=a;i>0&&!t.done;){if(t.count=t.readUint53(),t.count===0)throw new RangeError("Zero-length runs are not allowed");t.lastValue=!t.lastValue,this.appendUint53(this.count);const o=Math.min(t.count,i);this.count=o,this.lastValue=t.lastValue,t.count-=o,i-=o}if(r&&i>0&&t.done)throw new RangeError(`cannot copy ${r} values`)}finish(){this.count>0&&(this.appendUint53(this.count),this.count=0)}},i0=class extends Pp{constructor(t){super(t),this.lastValue=!0,this.firstRun=!0,this.count=0}get done(){return this.count===0&&this.offset===this.buf.byteLength}reset(){this.offset=0,this.lastValue=!0,this.firstRun=!0,this.count=0}readValue(){if(this.done)return!1;for(;this.count===0;){if(this.count=this.readUint53(),this.lastValue=!this.lastValue,this.count===0&&!this.firstRun)throw new RangeError("Zero-length runs are not allowed");this.firstRun=!1}return this.count-=1,this.lastValue}skipValues(t){for(;t>0&&!this.done;){if(this.count===0){if(this.count=this.readUint53(),this.lastValue=!this.lastValue,this.count===0&&!this.firstRun)throw new RangeError("Zero-length runs are not allowed");this.firstRun=!1}this.count<t?(t-=this.count,this.count=0):(this.count-=t,t=0)}}};var a0={utf8ToString:Jh,hexStringToBytes:e0,bytesToHexString:n0,Encoder:Op,Decoder:Pp,RLEEncoder:r0,RLEDecoder:Lp,DeltaEncoder:$R,DeltaDecoder:s0,BooleanEncoder:FR,BooleanDecoder:i0},o0={exports:{}};(function(e){(function(t,n){var r={};n(r);var i=r.default;for(var a in r)i[a]=r[a];e.exports=i})(Qa,function(t){t.__esModule=!0,t.digestLength=32,t.blockSize=64;var n=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function r(h,f,v,j,_){for(var m,y,b,N,A,E,R,I,T,L,B,W,z;_>=64;){for(m=f[0],y=f[1],b=f[2],N=f[3],A=f[4],E=f[5],R=f[6],I=f[7],L=0;L<16;L++)B=j+L*4,h[L]=(v[B]&255)<<24|(v[B+1]&255)<<16|(v[B+2]&255)<<8|v[B+3]&255;for(L=16;L<64;L++)T=h[L-2],W=(T>>>17|T<<15)^(T>>>19|T<<13)^T>>>10,T=h[L-15],z=(T>>>7|T<<25)^(T>>>18|T<<14)^T>>>3,h[L]=(W+h[L-7]|0)+(z+h[L-16]|0);for(L=0;L<64;L++)W=(((A>>>6|A<<26)^(A>>>11|A<<21)^(A>>>25|A<<7))+(A&E^~A&R)|0)+(I+(n[L]+h[L]|0)|0)|0,z=((m>>>2|m<<30)^(m>>>13|m<<19)^(m>>>22|m<<10))+(m&y^m&b^y&b)|0,I=R,R=E,E=A,A=N+W|0,N=b,b=y,y=m,m=W+z|0;f[0]+=m,f[1]+=y,f[2]+=b,f[3]+=N,f[4]+=A,f[5]+=E,f[6]+=R,f[7]+=I,j+=64,_-=64}return j}var i=function(){function h(){this.digestLength=t.digestLength,this.blockSize=t.blockSize,this.state=new Int32Array(8),this.temp=new Int32Array(64),this.buffer=new Uint8Array(128),this.bufferLength=0,this.bytesHashed=0,this.finished=!1,this.reset()}return h.prototype.reset=function(){return this.state[0]=1779033703,this.state[1]=3144134277,this.state[2]=1013904242,this.state[3]=2773480762,this.state[4]=1359893119,this.state[5]=2600822924,this.state[6]=528734635,this.state[7]=1541459225,this.bufferLength=0,this.bytesHashed=0,this.finished=!1,this},h.prototype.clean=function(){for(var f=0;f<this.buffer.length;f++)this.buffer[f]=0;for(var f=0;f<this.temp.length;f++)this.temp[f]=0;this.reset()},h.prototype.update=function(f,v){if(v===void 0&&(v=f.length),this.finished)throw new Error("SHA256: can't update because hash was finished.");var j=0;if(this.bytesHashed+=v,this.bufferLength>0){for(;this.bufferLength<64&&v>0;)this.buffer[this.bufferLength++]=f[j++],v--;this.bufferLength===64&&(r(this.temp,this.state,this.buffer,0,64),this.bufferLength=0)}for(v>=64&&(j=r(this.temp,this.state,f,j,v),v%=64);v>0;)this.buffer[this.bufferLength++]=f[j++],v--;return this},h.prototype.finish=function(f){if(!this.finished){var v=this.bytesHashed,j=this.bufferLength,_=v/536870912|0,m=v<<3,y=v%64<56?64:128;this.buffer[j]=128;for(var b=j+1;b<y-8;b++)this.buffer[b]=0;this.buffer[y-8]=_>>>24&255,this.buffer[y-7]=_>>>16&255,this.buffer[y-6]=_>>>8&255,this.buffer[y-5]=_>>>0&255,this.buffer[y-4]=m>>>24&255,this.buffer[y-3]=m>>>16&255,this.buffer[y-2]=m>>>8&255,this.buffer[y-1]=m>>>0&255,r(this.temp,this.state,this.buffer,0,y),this.finished=!0}for(var b=0;b<8;b++)f[b*4+0]=this.state[b]>>>24&255,f[b*4+1]=this.state[b]>>>16&255,f[b*4+2]=this.state[b]>>>8&255,f[b*4+3]=this.state[b]>>>0&255;return this},h.prototype.digest=function(){var f=new Uint8Array(this.digestLength);return this.finish(f),f},h.prototype._saveState=function(f){for(var v=0;v<this.state.length;v++)f[v]=this.state[v]},h.prototype._restoreState=function(f,v){for(var j=0;j<this.state.length;j++)this.state[j]=f[j];this.bytesHashed=v,this.finished=!1,this.bufferLength=0},h}();t.Hash=i;var a=function(){function h(f){this.inner=new i,this.outer=new i,this.blockSize=this.inner.blockSize,this.digestLength=this.inner.digestLength;var v=new Uint8Array(this.blockSize);if(f.length>this.blockSize)new i().update(f).finish(v).clean();else for(var j=0;j<f.length;j++)v[j]=f[j];for(var j=0;j<v.length;j++)v[j]^=54;this.inner.update(v);for(var j=0;j<v.length;j++)v[j]^=106;this.outer.update(v),this.istate=new Uint32Array(8),this.ostate=new Uint32Array(8),this.inner._saveState(this.istate),this.outer._saveState(this.ostate);for(var j=0;j<v.length;j++)v[j]=0}return h.prototype.reset=function(){return this.inner._restoreState(this.istate,this.inner.blockSize),this.outer._restoreState(this.ostate,this.outer.blockSize),this},h.prototype.clean=function(){for(var f=0;f<this.istate.length;f++)this.ostate[f]=this.istate[f]=0;this.inner.clean(),this.outer.clean()},h.prototype.update=function(f){return this.inner.update(f),this},h.prototype.finish=function(f){return this.outer.finished?this.outer.finish(f):(this.inner.finish(f),this.outer.update(f,this.digestLength).finish(f)),this},h.prototype.digest=function(){var f=new Uint8Array(this.digestLength);return this.finish(f),f},h}();t.HMAC=a;function o(h){var f=new i().update(h),v=f.digest();return f.clean(),v}t.hash=o,t.default=o;function l(h,f){var v=new a(h).update(f),j=v.digest();return v.clean(),j}t.hmac=l;function c(h,f,v,j){var _=j[0];if(_===0)throw new Error("hkdf: cannot expand more");f.reset(),_>1&&f.update(h),v&&f.update(v),f.update(j),f.finish(h),j[0]++}var u=new Uint8Array(t.digestLength);function d(h,f,v,j){f===void 0&&(f=u),j===void 0&&(j=32);for(var _=new Uint8Array([1]),m=l(f,h),y=new a(m),b=new Uint8Array(y.digestLength),N=b.length,A=new Uint8Array(j),E=0;E<j;E++)N===b.length&&(c(b,y,v,_),N=0),A[E]=b[N++];return y.clean(),b.fill(0),_.fill(0),A}t.hkdf=d;function p(h,f,v,j){for(var _=new a(h),m=_.digestLength,y=new Uint8Array(4),b=new Uint8Array(m),N=new Uint8Array(m),A=new Uint8Array(j),E=0;E*m<j;E++){var R=E+1;y[0]=R>>>24&255,y[1]=R>>>16&255,y[2]=R>>>8&255,y[3]=R>>>0&255,_.reset(),_.update(f),_.update(y),_.finish(N);for(var I=0;I<m;I++)b[I]=N[I];for(var I=2;I<=v;I++){_.reset(),_.update(N).finish(N);for(var T=0;T<m;T++)b[T]^=N[T]}for(var I=0;I<m&&E*m+I<j;I++)A[E*m+I]=b[I]}for(var E=0;E<m;E++)b[E]=N[E]=0;for(var E=0;E<4;E++)y[E]=0;return _.clean(),A}t.pbkdf2=p})})(o0);var HR=o0.exports;const bu=jr,{copyObject:Ey,parseOpId:Lr,equalBytes:Ny}=xr,{utf8ToString:qR,hexStringToBytes:l0,bytesToHexString:wu,Encoder:ma,Decoder:ln,RLEEncoder:Fn,RLEDecoder:_y,DeltaEncoder:cc,DeltaDecoder:zR,BooleanEncoder:c0,BooleanDecoder:WR}=a0,{Hash:u0}=HR,Yi=new Uint8Array([133,111,74,131]),Dp=0,Oa=1,cl=2,d0=256,_e={GROUP_CARD:0,ACTOR_ID:1,INT_RLE:2,INT_DELTA:3,BOOLEAN:4,STRING_RLE:5,VALUE_LEN:6,VALUE_RAW:7},Jo=8,Ye={NULL:0,FALSE:1,TRUE:2,LEB128_UINT:3,LEB128_INT:4,IEEE754:5,UTF8:6,BYTES:7,COUNTER:8,TIMESTAMP:9,MIN_UNKNOWN:10,MAX_UNKNOWN:15},wo=["makeMap","set","makeList","del","makeText","inc","makeTable","link"],GR={makeMap:"map",makeList:"list",makeText:"text",makeTable:"table"},h0=[{columnName:"objActor",columnId:0|_e.ACTOR_ID},{columnName:"objCtr",columnId:0|_e.INT_RLE},{columnName:"keyActor",columnId:16|_e.ACTOR_ID},{columnName:"keyCtr",columnId:16|_e.INT_DELTA},{columnName:"keyStr",columnId:16|_e.STRING_RLE},{columnName:"idActor",columnId:32|_e.ACTOR_ID},{columnName:"idCtr",columnId:32|_e.INT_DELTA},{columnName:"insert",columnId:48|_e.BOOLEAN},{columnName:"action",columnId:64|_e.INT_RLE},{columnName:"valLen",columnId:80|_e.VALUE_LEN},{columnName:"valRaw",columnId:80|_e.VALUE_RAW},{columnName:"chldActor",columnId:96|_e.ACTOR_ID},{columnName:"chldCtr",columnId:96|_e.INT_DELTA}],Mp=h0.concat([{columnName:"predNum",columnId:112|_e.GROUP_CARD},{columnName:"predActor",columnId:112|_e.ACTOR_ID},{columnName:"predCtr",columnId:112|_e.INT_DELTA}]),f0=h0.concat([{columnName:"succNum",columnId:128|_e.GROUP_CARD},{columnName:"succActor",columnId:128|_e.ACTOR_ID},{columnName:"succCtr",columnId:128|_e.INT_DELTA}]),p0=[{columnName:"actor",columnId:0|_e.ACTOR_ID},{columnName:"seq",columnId:0|_e.INT_DELTA},{columnName:"maxOp",columnId:16|_e.INT_DELTA},{columnName:"time",columnId:32|_e.INT_DELTA},{columnName:"message",columnId:48|_e.STRING_RLE},{columnName:"depsNum",columnId:64|_e.GROUP_CARD},{columnName:"depsIndex",columnId:64|_e.INT_DELTA},{columnName:"extraLen",columnId:80|_e.VALUE_LEN},{columnName:"extraRaw",columnId:80|_e.VALUE_RAW}];function Vl(e,t){if(!e||!e.actorId)return e;const n=e.counter,r=t.indexOf(e.actorId);if(r<0)throw new RangeError("missing actorId");return{counter:n,actorNum:r,actorId:e.actorId}}function m0(e,t){return e.counter<t.counter?-1:e.counter>t.counter?1:e.actorId<t.actorId?-1:e.actorId>t.actorId?1:0}function YR(e,t){const n={},r=[];for(let a of e)a=Ey(a),n[a.actor]=!0,a.ops=nT(a.ops,a.startOp,a.actor),a.ops=a.ops.map(o=>{o=Ey(o),o.obj!=="_root"&&(o.obj=Lr(o.obj)),o.elemId&&o.elemId!=="_head"&&(o.elemId=Lr(o.elemId)),o.child&&(o.child=Lr(o.child)),o.pred&&(o.pred=o.pred.map(Lr)),o.obj.actorId&&(n[o.obj.actorId]=!0),o.elemId&&o.elemId.actorId&&(n[o.elemId.actorId]=!0),o.child&&o.child.actorId&&(n[o.child.actorId]=!0);for(let l of o.pred)n[l.actorId]=!0;return o}),r.push(a);let i=Object.keys(n).sort();i=[e[0].actor].concat(i.filter(a=>a!==e[0].actor));for(let a of r){a.actorNum=i.indexOf(a.actor);for(let o=0;o<a.ops.length;o++){let l=a.ops[o];l.id={counter:a.startOp+o,actorNum:a.actorNum,actorId:a.actor},l.obj=Vl(l.obj,i),l.elemId=Vl(l.elemId,i),l.child=Vl(l.child,i),l.pred=l.pred.map(c=>Vl(c,i))}}return{changes:r,actorIds:i}}function KR(e,t){if(e.obj==="_root")t.objActor.appendValue(null),t.objCtr.appendValue(null);else if(e.obj.actorNum>=0&&e.obj.counter>0)t.objActor.appendValue(e.obj.actorNum),t.objCtr.appendValue(e.obj.counter);else throw new RangeError(`Unexpected objectId reference: ${JSON.stringify(e.obj)}`)}function JR(e,t){if(e.key)t.keyActor.appendValue(null),t.keyCtr.appendValue(null),t.keyStr.appendValue(e.key);else if(e.elemId==="_head"&&e.insert)t.keyActor.appendValue(null),t.keyCtr.appendValue(0),t.keyStr.appendValue(null);else if(e.elemId&&e.elemId.actorNum>=0&&e.elemId.counter>0)t.keyActor.appendValue(e.elemId.actorNum),t.keyCtr.appendValue(e.elemId.counter),t.keyStr.appendValue(null);else throw new RangeError(`Unexpected operation key: ${JSON.stringify(e)}`)}function QR(e,t){const n=wo.indexOf(e.action);if(n>=0)t.action.appendValue(n);else if(typeof e.action=="number")t.action.appendValue(e.action);else throw new RangeError(`Unexpected operation action: ${e.action}`)}function ZR(e){switch(e.datatype){case"counter":return[Ye.COUNTER,e.value];case"timestamp":return[Ye.TIMESTAMP,e.value];case"uint":return[Ye.LEB128_UINT,e.value];case"int":return[Ye.LEB128_INT,e.value];case"float64":{const t=new ArrayBuffer(8);return new DataView(t).setFloat64(0,e.value,!0),[Ye.IEEE754,new Uint8Array(t)]}default:if(Number.isInteger(e.value)&&e.value<=Number.MAX_SAFE_INTEGER&&e.value>=Number.MIN_SAFE_INTEGER)return[Ye.LEB128_INT,e.value];{const t=new ArrayBuffer(8);return new DataView(t).setFloat64(0,e.value,!0),[Ye.IEEE754,new Uint8Array(t)]}}}function XR(e,t){if(e.action!=="set"&&e.action!=="inc"||e.value===null)t.valLen.appendValue(Ye.NULL);else if(e.value===!1)t.valLen.appendValue(Ye.FALSE);else if(e.value===!0)t.valLen.appendValue(Ye.TRUE);else if(typeof e.value=="string"){const n=t.valRaw.appendRawString(e.value);t.valLen.appendValue(n<<4|Ye.UTF8)}else if(ArrayBuffer.isView(e.value)){const n=t.valRaw.appendRawBytes(new Uint8Array(e.value.buffer));t.valLen.appendValue(n<<4|Ye.BYTES)}else if(typeof e.value=="number"){let[n,r]=ZR(e),i;n===Ye.LEB128_UINT?i=t.valRaw.appendUint53(r):n===Ye.IEEE754?i=t.valRaw.appendRawBytes(r):i=t.valRaw.appendInt53(r),t.valLen.appendValue(i<<4|n)}else if(typeof e.datatype=="number"&&e.datatype>=Ye.MIN_UNKNOWN&&e.datatype<=Ye.MAX_UNKNOWN&&e.value instanceof Uint8Array){const n=t.valRaw.appendRawBytes(e.value);t.valLen.appendValue(n<<4|e.datatype)}else throw e.datatype?new RangeError(`Unknown datatype ${e.datatype} for value ${e.value}`):new RangeError(`Unsupported value in operation: ${e.value}`)}function g0(e,t){if(e===Ye.NULL)return{value:null};if(e===Ye.FALSE)return{value:!1};if(e===Ye.TRUE)return{value:!0};if(e%16===Ye.UTF8)return{value:qR(t)};if(e%16===Ye.LEB128_UINT)return{value:new ln(t).readUint53(),datatype:"uint"};if(e%16===Ye.LEB128_INT)return{value:new ln(t).readInt53(),datatype:"int"};if(e%16===Ye.IEEE754){const n=new DataView(t.buffer,t.byteOffset,t.byteLength);if(t.byteLength===8)return{value:n.getFloat64(0,!0),datatype:"float64"};throw new RangeError(`Invalid length for floating point number: ${t.byteLength}`)}else return e%16===Ye.COUNTER?{value:new ln(t).readInt53(),datatype:"counter"}:e%16===Ye.TIMESTAMP?{value:new ln(t).readInt53(),datatype:"timestamp"}:{value:t,datatype:e%16}}function Ay(e,t,n,r){const{columnId:i,columnName:a,decoder:o}=e[t];if(i%8===_e.VALUE_LEN&&t+1<e.length&&e[t+1].columnId===i+1){const l=o.readValue(),c=e[t+1].decoder.readRawBytes(l>>4),{value:u,datatype:d}=g0(l,c);return r[a]=u,d&&(r[a+"_datatype"]=d),2}else if(i%8===_e.ACTOR_ID){const l=o.readValue();if(l===null)r[a]=null;else{if(!n[l])throw new RangeError(`No actor index ${l}`);r[a]=n[l]}}else r[a]=o.readValue();return 1}function eT(e,t){const n={objActor:new Fn("uint"),objCtr:new Fn("uint"),keyActor:new Fn("uint"),keyCtr:new cc,keyStr:new Fn("utf8"),insert:new c0,action:new Fn("uint"),valLen:new Fn("uint"),valRaw:new ma,chldActor:new Fn("uint"),chldCtr:new cc};n.predNum=new Fn("uint"),n.predCtr=new cc,n.predActor=new Fn("uint");for(let i of e){KR(i,n),JR(i,n),n.insert.appendValue(!!i.insert),QR(i,n),XR(i,n),i.child&&i.child.counter?(n.chldActor.appendValue(i.child.actorNum),n.chldCtr.appendValue(i.child.counter)):(n.chldActor.appendValue(null),n.chldCtr.appendValue(null));{n.predNum.appendValue(i.pred.length),i.pred.sort(m0);for(let a=0;a<i.pred.length;a++)n.predActor.appendValue(i.pred[a].actorNum),n.predCtr.appendValue(i.pred[a].counter)}}let r=[];for(let{columnName:i,columnId:a}of Mp)n[i]&&r.push({columnId:a,columnName:i,encoder:n[i]});return r.sort((i,a)=>i.columnId-a.columnId)}function tT(e,t){return t===void 0?typeof e=="string"||typeof e=="boolean"||e===null:typeof e=="number"}function nT(e,t,n){let r=t,i=[];for(const a of e)if(a.action==="set"&&a.values&&a.insert){if(a.pred.length!==0)throw new RangeError("multi-insert pred must be empty");let o=a.elemId;const l=a.datatype;for(const c of a.values){if(!tT(c,l))throw new RangeError(`Decode failed: bad value/datatype association (${c},${l})`);i.push({action:"set",obj:a.obj,elemId:o,datatype:l,value:c,pred:[],insert:!0}),o=`${r}@${n}`,r+=1}}else if(a.action==="del"&&a.multiOp>1){if(a.pred.length!==1)throw new RangeError("multiOp deletion must have exactly one pred");const o=Lr(a.elemId),l=Lr(a.pred[0]);for(let c=0;c<a.multiOp;c++){const u=`${o.counter+c}@${o.actorId}`,d=[`${l.counter+c}@${l.actorId}`];i.push({action:"del",obj:a.obj,elemId:u,pred:d}),r+=1}}else i.push(a),r+=1;return i}function y0(e,t){const n=[];for(let r of e){const i=r.objCtr===null?"_root":`${r.objCtr}@${r.objActor}`,a=r.keyStr?void 0:r.keyCtr===0?"_head":`${r.keyCtr}@${r.keyActor}`,o=wo[r.action]||r.action,l=a?{obj:i,elemId:a,action:o}:{obj:i,key:r.keyStr,action:o};if(l.insert=!!r.insert,(wo[r.action]==="set"||wo[r.action]==="inc")&&(l.value=r.valLen,r.valLen_datatype&&(l.datatype=r.valLen_datatype)),!!r.chldCtr!=!!r.chldActor)throw new RangeError(`Mismatched child columns: ${r.chldCtr} and ${r.chldActor}`);r.chldCtr!==null&&(l.child=`${r.chldCtr}@${r.chldActor}`),t?(l.id=`${r.idCtr}@${r.idActor}`,l.succ=r.succNum.map(c=>`${c.succCtr}@${c.succActor}`),Cy(r.succNum.map(c=>({counter:c.succCtr,actorId:c.succActor})))):(l.pred=r.predNum.map(c=>`${c.predCtr}@${c.predActor}`),Cy(r.predNum.map(c=>({counter:c.predCtr,actorId:c.predActor})))),n.push(l)}return n}function Cy(e){let t=null;for(let n of e){if(t&&m0(t,n)!==-1)throw new RangeError("operation IDs are not in ascending order");t=n}}function rT(e){return(e&7)===_e.INT_DELTA?new cc:(e&7)===_e.BOOLEAN?new c0:(e&7)===_e.STRING_RLE?new Fn("utf8"):(e&7)===_e.VALUE_RAW?new ma:new Fn("uint")}function uc(e,t){return(e&7)===_e.INT_DELTA?new zR(t):(e&7)===_e.BOOLEAN?new WR(t):(e&7)===_e.STRING_RLE?new _y("utf8",t):(e&7)===_e.VALUE_RAW?new ln(t):new _y("uint",t)}function v0(e,t){const n=new Uint8Array(0);let r=[],i=0,a=0;for(;i<e.length||a<t.length;)if(i===e.length||a<t.length&&t[a].columnId<e[i].columnId){const{columnId:o,columnName:l}=t[a];r.push({columnId:o,columnName:l,decoder:uc(o,n)}),a++}else if(a===t.length||e[i].columnId<t[a].columnId){const{columnId:o,buffer:l}=e[i];r.push({columnId:o,decoder:uc(o,l)}),i++}else{const{columnId:o,buffer:l}=e[i],{columnName:c}=t[a];r.push({columnId:o,columnName:c,decoder:uc(o,l)}),i++,a++}return r}function Qh(e,t,n){e=v0(e,n);let r=[];for(;e.some(i=>!i.decoder.done);){let i={},a=0;for(;a<e.length;){const o=e[a].columnId;let l=o>>4,c=1;for(;a+c<e.length&&e[a+c].columnId>>4===l;)c++;if(o%8===_e.GROUP_CARD){const u=[],d=e[a].decoder.readValue();for(let p=0;p<d;p++){let h={};for(let f=1;f<c;f++)Ay(e,a+f,t,h);u.push(h)}i[e[a].columnName]=u,a+=c}else a+=Ay(e,a,t,i)}r.push(i)}return r}function Zh(e){const t=(-1^Jo)>>>0;let n=-1,r=[],i=e.readUint53();for(let a=0;a<i;a++){const o=e.readUint53(),l=e.readUint53();if((o&t)<=(n&t))throw new RangeError("Columns must be in ascending order");n=o,r.push({columnId:o,bufferLen:l})}return r}function Xh(e,t){const n=t.filter(r=>r.encoder.buffer.byteLength>0);e.appendUint53(n.length);for(let r of n)e.appendUint53(r.columnId),e.appendUint53(r.encoder.buffer.byteLength)}function x0(e){const t=e.readUint53(),n=[];for(let o=0;o<t;o++)n.push(wu(e.readRawBytes(32)));let r={actor:e.readHexString(),seq:e.readUint53(),startOp:e.readUint53(),time:e.readInt53(),message:e.readPrefixedString(),deps:n};const i=[r.actor],a=e.readUint53();for(let o=0;o<a;o++)i.push(e.readHexString());return r.actorIds=i,r}function j0(e,t){const r=Yi.byteLength+4+1+5,i=new ma;i.appendRawBytes(new Uint8Array(r)),t(i);const a=i.buffer,o=new ma;o.appendByte(e),o.appendUint53(a.byteLength-r);const l=o.buffer,c=new u0;c.update(l),c.update(a.subarray(r));const u=c.digest(),d=u.subarray(0,4);return a.set(Yi,r-l.byteLength-4-Yi.byteLength),a.set(d,r-l.byteLength-4),a.set(l,r-l.byteLength),{hash:u,bytes:a.subarray(r-l.byteLength-4-Yi.byteLength)}}function Pa(e,t){if(!Ny(e.readRawBytes(Yi.byteLength),Yi))throw new RangeError("Data does not begin with magic bytes 85 6f 4a 83");const n=e.readRawBytes(4),r=e.offset,i=e.readByte(),a=e.readUint53(),o={chunkType:i,chunkLength:a,chunkData:e.readRawBytes(a)};if(t){const l=new u0;l.update(e.buf.subarray(r,e.offset));const c=l.digest();if(!Ny(c.subarray(0,4),n))throw new RangeError("checksum does not match data");o.hash=wu(c)}return o}function b0(e){const{changes:t,actorIds:n}=YR([e]),r=t[0],{hash:i,bytes:a}=j0(Oa,l=>{if(!Array.isArray(r.deps))throw new TypeError("deps is not an array");l.appendUint53(r.deps.length);for(let u of r.deps.slice().sort())l.appendRawBytes(l0(u));l.appendHexString(r.actor),l.appendUint53(r.seq),l.appendUint53(r.startOp),l.appendInt53(r.time),l.appendPrefixedString(r.message||""),l.appendUint53(n.length-1);for(let u of n.slice(1))l.appendHexString(u);const c=eT(r.ops);Xh(l,c);for(let u of c)l.appendRawBytes(u.encoder.buffer);r.extraBytes&&l.appendRawBytes(r.extraBytes)}),o=wu(i);if(e.hash&&e.hash!==o)throw new RangeError(`Change hash does not match encoding: ${e.hash} != ${o}`);return a.byteLength>=d0?iT(a):a}function w0(e){e[8]===cl&&(e=S0(e));const t=new ln(e),n=Pa(t,!0),r=new ln(n.chunkData);if(!t.done)throw new RangeError("Encoded change has trailing data");if(n.chunkType!==Oa)throw new RangeError(`Unexpected chunk type: ${n.chunkType}`);const i=x0(r),a=Zh(r);for(let o=0;o<a.length;o++){if(a[o].columnId&Jo)throw new RangeError("change must not contain deflated columns");a[o].buffer=r.readRawBytes(a[o].bufferLen)}if(!r.done){const o=r.buf.byteLength-r.offset;i.extraBytes=r.readRawBytes(o)}return i.columns=a,i.hash=n.hash,i}function Up(e){const t=w0(e);return t.ops=y0(Qh(t.columns,t.actorIds,Mp),!1),delete t.actorIds,delete t.columns,t}function sT(e,t){e[8]===cl&&(e=S0(e));const n=Pa(new ln(e),t);if(n.chunkType!==Oa)throw new RangeError("Buffer chunk type is not a change");const r=x0(new ln(n.chunkData));return r.change=e,t&&(r.hash=n.hash),r}function iT(e){const t=Pa(new ln(e),!1);if(t.chunkType!==Oa)throw new RangeError(`Unexpected chunk type: ${t.chunkType}`);const n=bu.deflateRaw(t.chunkData),r=new ma;return r.appendRawBytes(e.subarray(0,8)),r.appendByte(cl),r.appendUint53(n.byteLength),r.appendRawBytes(n),r.buffer}function S0(e){const t=Pa(new ln(e),!1);if(t.chunkType!==cl)throw new RangeError(`Unexpected chunk type: ${t.chunkType}`);const n=bu.inflateRaw(t.chunkData),r=new ma;return r.appendRawBytes(e.subarray(0,8)),r.appendByte(Oa),r.appendUint53(n.byteLength),r.appendRawBytes(n),r.buffer}function aT(e){let t=new ln(e),n=[],r=0;for(;!t.done;)Pa(t,!1),n.push(e.subarray(r,t.offset)),r=t.offset;return n}function oT(e){let t=[];for(let n of e)for(let r of aT(n))r[8]===Dp?t=t.concat(hT(r)):(r[8]===Oa||r[8]===cl)&&t.push(Up(r));return t}function lT(e,t){if(e===t)return 0;if(e==="_root")return-1;if(t==="_root")return 1;const n=Lr(e),r=Lr(t);return n.counter<r.counter?-1:n.counter>r.counter?1:n.actorId<r.actorId?-1:n.actorId>r.actorId?1:0}function cT(e,t){let n={};for(let i of e){if(i.ops=[],n[i.actor]||(n[i.actor]=[]),i.seq!==n[i.actor].length+1)throw new RangeError(`Expected seq = ${n[i.actor].length+1}, got ${i.seq}`);if(i.seq>1&&n[i.actor][i.seq-2].maxOp>i.maxOp)throw new RangeError("maxOp must increase monotonically per actor");n[i.actor].push(i)}let r={};for(let i of t){if(i.action==="del")throw new RangeError("document should not contain del operations");i.pred=r[i.id]?r[i.id].pred:[],r[i.id]=i;for(let a of i.succ){if(!r[a])if(i.elemId){const o=i.insert?i.id:i.elemId;r[a]={id:a,action:"del",obj:i.obj,elemId:o,pred:[]}}else r[a]={id:a,action:"del",obj:i.obj,key:i.key,pred:[]};r[a].pred.push(i.id)}delete i.succ}for(let i of Object.values(r))i.action==="del"&&t.push(i);for(let i of t){const{counter:a,actorId:o}=Lr(i.id),l=n[o];let c=0,u=l.length;for(;c<u;){const d=Math.floor((c+u)/2);l[d].maxOp<a?c=d+1:u=d}if(c>=l.length)throw new RangeError(`Operation ID ${i.id} outside of allowed range`);l[c].ops.push(i)}for(let i of e){i.ops.sort((a,o)=>lT(a.id,o.id)),i.startOp=i.maxOp-i.ops.length+1,delete i.maxOp;for(let a=0;a<i.ops.length;a++){const o=i.ops[a],l=`${i.startOp+a}@${i.actor}`;if(o.id!==l)throw new RangeError(`Expected opId ${l}, got ${o.id}`);delete o.id}}}function uT(e,t){let n={};for(let o=0;o<e.length;o++){let l=e[o];l.deps=[];for(let c of l.depsNum.map(u=>u.depsIndex)){if(!e[c]||!e[c].hash)throw new RangeError(`No hash for index ${c} while processing index ${o}`);const u=e[c].hash;l.deps.push(u),n[u]&&delete n[u]}if(l.deps.sort(),delete l.depsNum,l.extraLen_datatype!==Ye.BYTES)throw new RangeError(`Bad datatype for extra bytes: ${Ye.BYTES}`);l.extraBytes=l.extraLen,delete l.extraLen_datatype,e[o]=Up(b0(l)),n[e[o].hash]=!0}const r=Object.keys(n).sort();let i=r.length===t.length,a=0;for(;i&&a<r.length;)i=r[a]===t[a],a++;if(!i)throw new RangeError(`Mismatched heads hashes: expected ${t.join(", ")}, got ${r.join(", ")}`)}function dT(e){const{changesColumns:t,opsColumns:n,actorIds:r,heads:i,headsIndexes:a,extraBytes:o}=e;for(let l of t)ky(l);for(let l of n)ky(l);return j0(Dp,l=>{l.appendUint53(r.length);for(let c of r)l.appendHexString(c);l.appendUint53(i.length);for(let c of i.sort())l.appendRawBytes(l0(c));Xh(l,t),Xh(l,n);for(let c of t)l.appendRawBytes(c.encoder.buffer);for(let c of n)l.appendRawBytes(c.encoder.buffer);for(let c of a)l.appendUint53(c);o&&l.appendRawBytes(o)}).bytes}function E0(e){const t=new ln(e),n=Pa(t,!0),r=new ln(n.chunkData);if(!t.done)throw new RangeError("Encoded document has trailing data");if(n.chunkType!==Dp)throw new RangeError(`Unexpected chunk type: ${n.chunkType}`);const i=[],a=r.readUint53();for(let h=0;h<a;h++)i.push(r.readHexString());const o=[],l=[],c=r.readUint53();for(let h=0;h<c;h++)o.push(wu(r.readRawBytes(32)));const u=Zh(r),d=Zh(r);for(let h=0;h<u.length;h++)u[h].buffer=r.readRawBytes(u[h].bufferLen),Iy(u[h]);for(let h=0;h<d.length;h++)d[h].buffer=r.readRawBytes(d[h].bufferLen),Iy(d[h]);if(!r.done)for(let h=0;h<c;h++)l.push(r.readUint53());const p=r.readRawBytes(r.buf.byteLength-r.offset);return{changesColumns:u,opsColumns:d,actorIds:i,heads:o,headsIndexes:l,extraBytes:p}}function hT(e){const{changesColumns:t,opsColumns:n,actorIds:r,heads:i}=E0(e),a=Qh(t,r,p0),o=y0(Qh(n,r,f0),!0);return cT(a,o),uT(a,i),a}function ky(e){e.encoder.buffer.byteLength>=d0&&(e.encoder={buffer:bu.deflateRaw(e.encoder.buffer)},e.columnId|=Jo)}function Iy(e){e.columnId&Jo&&(e.buffer=bu.inflateRaw(e.buffer),e.columnId^=Jo)}var Su={COLUMN_TYPE:_e,VALUE_TYPE:Ye,ACTIONS:wo,OBJECT_TYPE:GR,DOC_OPS_COLUMNS:f0,CHANGE_COLUMNS:Mp,DOCUMENT_COLUMNS:p0,encoderByColumnId:rT,decoderByColumnId:uc,makeDecoders:v0,decodeValue:g0,encodeChange:b0,decodeChangeColumns:w0,decodeChange:Up,decodeChangeMeta:sT,decodeChanges:oT,encodeDocumentHeader:dT,decodeDocumentHeader:E0};const{parseOpId:Gc,copyObject:Yc}=xr,{COLUMN_TYPE:Vt,VALUE_TYPE:ef,ACTIONS:Ar,OBJECT_TYPE:Ry,DOC_OPS_COLUMNS:Ty,CHANGE_COLUMNS:ze,DOCUMENT_COLUMNS:Hn,encoderByColumnId:ga,decoderByColumnId:Bp,makeDecoders:Qo,decodeValue:$l,encodeChange:fT,decodeChangeColumns:pT,decodeChangeMeta:mT,decodeChanges:gT,decodeDocumentHeader:yT,encodeDocumentHeader:vT}=Su,Eu=600,xT=10,N0=7,_0=Math.floor(xT*Eu/8),pt=0,lt=1,Ut=2,Bt=3,Ce=4,Wt=5,Ze=6,Gt=7,jt=8,es=9,Xs=10,ts=13,na=14,ra=15,Yn=13,tf=14,sa=15,Oy=ze.filter(e=>["predNum","predActor","predCtr"].includes(e.columnName)).map(e=>e.columnId);function nf(e,t,n){if(t.length===1)e[t[0]]=n;else{let r=Object.assign({},e[t[0]]);nf(r,t.slice(1),n),e[t[0]]=r}}function Py(e,t,n,r){for(let P of t)P.decoder.reset();const{objActor:i,objCtr:a,keyActor:o,keyCtr:l,keyStr:c,idActor:u,idCtr:d,insert:p}=e,[h,f,,,v,j,_,m,y,,,,,b]=t.map(P=>P.decoder);let N=0,A=0,E=!1,R=null,I=null,T=null,L=null,B=null,W=null,z=0;if(a!==null&&!r)for(;(!f.done||!h.done||!y.done)&&(I=f.readValue(),R=n[h.readValue()],y.skipValues(1),I===null||!R||I<a||I===a&&R<i);)N+=1;if((I!==a||R!==i)&&!r)return{found:!0,skipCount:N,visibleCount:A};if(c!==null){for(v.skipValues(N);!v.done;){const P=h.readValue();if(R=P===null?null:n[P],I=f.readValue(),B=v.readValue(),B!==null&&B<c&&I===a&&R===i)N+=1;else break}return{found:!0,skipCount:N,visibleCount:A}}if(_.skipValues(N),j.skipValues(N),m.skipValues(N),b.skipValues(N),L=_.readValue(),T=n[j.readValue()],W=m.readValue(),z=b.readValue(),p){if(!r&&l!==null&&l>0&&o!==null){for(N+=1;!_.done&&!j.done&&(L!==l||T!==o)&&(W&&(E=!1),z===0&&!E&&(A+=1,E=!0),L=_.readValue(),T=n[j.readValue()],I=f.readValue(),R=n[h.readValue()],W=m.readValue(),z=b.readValue(),I===a&&R===i);)N+=1;if(I!==a||R!==i||L!==l||T!==o||!W)return{found:!1,skipCount:N,visibleCount:A};if(W&&(E=!1),z===0&&!E&&(A+=1,E=!0),_.done||j.done)return{found:!0,skipCount:N,visibleCount:A};L=_.readValue(),T=n[j.readValue()],I=f.readValue(),R=n[h.readValue()],W=m.readValue(),z=b.readValue()}for(;(!W||L>d||L===d&&T>u)&&I===a&&R===i&&(N+=1,W&&(E=!1),z===0&&!E&&(A+=1,E=!0),!_.done&&!j.done);)L=_.readValue(),T=n[j.readValue()],I=f.readValue(),R=n[h.readValue()],W=m.readValue(),z=b.readValue()}else if(l!==null&&l>0&&o!==null){for(;(!W||L!==l||T!==o)&&I===a&&R===i&&(N+=1,W&&(E=!1),z===0&&!E&&(A+=1,E=!0),!_.done&&!j.done);)L=_.readValue(),T=n[j.readValue()],I=f.readValue(),R=n[h.readValue()],W=m.readValue(),z=b.readValue();if(I!==a||R!==i||L!==l||T!==o||!W)return{found:!1,skipCount:N,visibleCount:A}}return{found:!0,skipCount:N,visibleCount:A}}function Ly(e,t,n,r){const i=e.blocks[t],a=e.blocks[t+1];return i.lastObjectActor!==n||i.lastObjectCtr!==r||i.numVisible===void 0?0:i.lastVisibleActor===a.firstVisibleActor&&i.lastVisibleActor!==void 0&&i.lastVisibleCtr===a.firstVisibleCtr&&i.lastVisibleCtr!==void 0?i.numVisible-1:i.numVisible}function A0(e,t){const{objActor:n,objActorNum:r,objCtr:i,keyActor:a,keyCtr:o,keyStr:l}=t;let c=0,u=0;if(i!==null)for(;c<e.blocks.length-1;){const d=e.blocks[c].lastObjectActor===void 0?void 0:e.actorIds[e.blocks[c].lastObjectActor],p=e.blocks[c].lastObjectCtr;if(p===null||p<i||p===i&&d<n)c++;else break}if(l!==null){for(;c<e.blocks.length-1;){const{lastObjectActor:p,lastObjectCtr:h,lastKey:f}=e.blocks[c];if(i===h&&r===p&&f!==void 0&&f<l)c++;else break}const{skipCount:d}=Py(t,e.blocks[c].columns,e.actorIds,!1);return{blockIndex:c,skipCount:d,visibleCount:0}}else{const d=o===null||o===0||a===null,p=a===null?null:e.actorIds.indexOf(a);let h=!1;for(;;){if(!d&&!h)for(;c<e.blocks.length-1&&e.blocks[c].lastObjectActor===r&&e.blocks[c].lastObjectCtr===i&&!jT(e.blocks[c].bloom,p,o);){if(e.blocks[c].lastObjectCtr>i)throw new RangeError(`Reference element not found: ${o}@${a}`);u+=Ly(e,c,r,i),c++}const{found:f,skipCount:v,visibleCount:j}=Py(t,e.blocks[c].columns,e.actorIds,h);if(c===e.blocks.length-1||e.blocks[c].lastObjectActor!==r||e.blocks[c].lastObjectCtr!==i){if(f)return{blockIndex:c,skipCount:v,visibleCount:u+j};throw new RangeError(`Reference element not found: ${o}@${a}`)}else if(f&&v<e.blocks[c].numOps)return{blockIndex:c,skipCount:v,visibleCount:u+j};h=f&&t.insert,u+=Ly(e,c,r,i),c++}}}function C0(e,t,n){let r=8*e.byteLength,i=n%r,a=t%r,o=((n^t)*16777619>>>0)%r;for(let l=0;l<N0;l++)e[i>>>3]|=1<<(i&7),i=(i+a)%r,a=(a+o)%r}function jT(e,t,n){let r=8*e.byteLength,i=n%r,a=t%r,o=((n^t)*16777619>>>0)%r;for(let l=0;l<N0;l++){if(!(e[i>>>3]&1<<(i&7)))return!1;i=(i+a)%r,a=(a+o)%r}return!0}function k0(e){e.bloom=new Uint8Array(_0),e.numOps=0,e.lastKey=void 0,e.numVisible=void 0,e.lastObjectActor=void 0,e.lastObjectCtr=void 0,e.firstVisibleActor=void 0,e.firstVisibleCtr=void 0,e.lastVisibleActor=void 0,e.lastVisibleCtr=void 0;for(let d of e.columns)d.decoder.reset();const[t,n,r,i,a,o,l,c,,,,,,u]=e.columns.map(d=>d.decoder);for(;!l.done;){e.numOps+=1;const d=t.readValue(),p=n.readValue(),h=r.readValue(),f=i.readValue(),v=a.readValue(),j=o.readValue(),_=l.readValue(),m=c.readValue(),y=u.readValue();if((e.lastObjectActor!==d||e.lastObjectCtr!==p)&&(e.numVisible=0,e.lastObjectActor=d,e.lastObjectCtr=p),v!==null)e.lastKey=v;else if(m||f!==null){e.lastKey=void 0;const b=m?j:h,N=m?_:f;C0(e.bloom,b,N),y===0&&(e.firstVisibleActor===void 0&&(e.firstVisibleActor=b),e.firstVisibleCtr===void 0&&(e.firstVisibleCtr=N),(e.lastVisibleActor!==b||e.lastVisibleCtr!==N)&&(e.numVisible+=1,e.lastVisibleActor=b,e.lastVisibleCtr=N))}}}function _d(e,t,n,r){if(t[Ce]!==null)e.lastObjectCtr===t[lt]&&e.lastObjectActor===t[pt]&&(e.lastKey===void 0||e.lastKey<t[Ce])&&(e.lastKey=t[Ce]);else{const i=t[Gt]?t[Wt]:t[Ut],a=t[Gt]?t[Ze]:t[Bt];C0(e.bloom,i,a),(t[Yn]===0||r)&&(e.firstVisibleActor===void 0&&(e.firstVisibleActor=i),e.firstVisibleCtr===void 0&&(e.firstVisibleCtr=a),e.lastVisibleActor=i,e.lastVisibleCtr=a)}(e.lastObjectCtr===void 0||t[pt]!==null&&t[lt]!==null&&(e.lastObjectCtr===null||e.lastObjectCtr<t[lt]||e.lastObjectCtr===t[lt]&&n[e.lastObjectActor]<n[t[pt]]))&&(e.lastObjectActor=t[pt],e.lastObjectCtr=t[lt],e.lastKey=t[Ce]!==null?t[Ce]:void 0,e.numVisible=0)}function I0(e){for(let i of e.columns)i.decoder.reset();const t=Math.ceil(e.numOps/(.8*Eu));let n=[],r=0;for(let i=1;i<=t;i++){const a=Math.ceil(i*e.numOps/t)-r,o=e.columns.map(u=>({columnId:u.columnId,encoder:ga(u.columnId)}));ya(o,e.columns,a);const c={columns:o.map(u=>{const d=Bp(u.columnId,u.encoder.buffer);return{columnId:u.columnId,decoder:d}})};k0(c),n.push(c),r+=a}return n}function bT(e){const t=e[0].columns.map(n=>({columnId:n.columnId,encoder:ga(n.columnId)}));for(let n of e){for(let r of n.columns)r.decoder.reset();ya(t,n.columns,n.numOps)}return t}function ya(e,t,n){if(n===0)return;let r=0,i=-1,a=0,o=-1,l=0;for(let c of e){for(;r<t.length&&t[r].columnId<c.columnId;)r++;let u=null;r<t.length&&t[r].columnId===c.columnId&&t[r].decoder.buf.byteLength>0&&(u=t[r].decoder);const d=c.columnId>>4===i?a:n;if(c.columnId%8===Vt.GROUP_CARD)i=c.columnId>>4,u?a=c.encoder.copyFrom(u,{count:n,sumValues:!0}).sum:(c.encoder.appendValue(0,n),a=0);else if(c.columnId%8===Vt.VALUE_LEN)if(u){if(r+1===t.length||t[r+1].columnId!==c.columnId+1)throw new RangeError("VALUE_LEN column without accompanying VALUE_RAW column");o=c.columnId+1,l=c.encoder.copyFrom(u,{count:d,sumValues:!0,sumShift:4}).sum}else c.encoder.appendValue(null,d),o=c.columnId+1,l=0;else if(c.columnId%8===Vt.VALUE_RAW){if(c.columnId!==o)throw new RangeError("VALUE_RAW column without accompanying VALUE_LEN column");l>0&&c.encoder.appendRawBytes(u.readRawBytes(l))}else if(u)c.encoder.copyFrom(u,{count:d});else{const p=c.columnId%8===Vt.BOOLEAN?!1:null;c.encoder.appendValue(p,d)}}}function rf(e,t){let n=[],r,i=-1,a=0,o=-1,l=0;for(let c of e){if(c.columnId%8===Vt.VALUE_RAW){if(c.columnId!==o)throw new RangeError("unexpected VALUE_RAW column");r=c.decoder.readRawBytes(l)}else if(c.columnId%8===Vt.GROUP_CARD)i=c.columnId>>4,a=c.decoder.readValue()||0,r=a;else if(c.columnId>>4===i){r=[],c.columnId%8===Vt.VALUE_LEN&&(o=c.columnId+1,l=0);for(let u=0;u<a;u++){let d=c.decoder.readValue();c.columnId%8===Vt.ACTOR_ID&&t&&typeof d=="number"&&(d=t[d]),c.columnId%8===Vt.VALUE_LEN&&(l+=r>>>4),r.push(d)}}else r=c.decoder.readValue(),c.columnId%8===Vt.ACTOR_ID&&t&&typeof r=="number"&&(r=t[r]),c.columnId%8===Vt.VALUE_LEN&&(o=c.columnId+1,l=r>>>4);n.push(r)}return n}function dc(e,t,n){let r=0,i=-1,a=0;for(let o of e){for(;r<t.length&&t[r].columnId<o.columnId;)r++;if(r<t.length&&t[r].columnId===o.columnId){const l=n[r];if(o.columnId%8===Vt.GROUP_CARD)i=o.columnId>>4,a=l,o.encoder.appendValue(l);else if(o.columnId>>4===i){if(!Array.isArray(l)||l.length!==a)throw new RangeError("bad group value");for(let c of l)o.encoder.appendValue(c)}else o.columnId%8===Vt.VALUE_RAW?l&&o.encoder.appendRawBytes(l):o.encoder.appendValue(l)}else if(o.columnId%8===Vt.GROUP_CARD)i=o.columnId>>4,a=0,o.encoder.appendValue(0);else if(o.columnId%8!==Vt.VALUE_RAW){const l=o.columnId>>4===i?a:1;let c=null;o.columnId%8===Vt.BOOLEAN&&(c=!1),o.columnId%8===Vt.VALUE_LEN&&(c=0),o.encoder.appendValue(c,l)}}}function sf(e,t){let n=e.blocks[t];if(n.columns[jt].decoder.done){if(t===e.blocks.length-1)return{docOp:null,blockIndex:t};t+=1,n=e.blocks[t];for(let r of n.columns)r.decoder.reset();return{docOp:rf(n.columns),blockIndex:t}}else return{docOp:rf(n.columns),blockIndex:t}}function R0(e,t){for(;t.changeIndex<t.changes.length-1&&(!t.columns||t.columns[jt].decoder.done);){t.changeIndex+=1;const r=t.changes[t.changeIndex];t.columns=Qo(r.columns,ze),t.opCtr=r.startOp,t.columns[jt].decoder.done&&(r.maxOp=r.startOp-1),NT(e,t.columns);const{actorIds:i,actorTable:a}=_T(e.actorIds,r);e.actorIds=i,t.actorTable=a,t.actorIndex=e.actorIds.indexOf(r.actorIds[0])}if(t.columns[jt].decoder.done){t.done=!0,t.nextOp=null;return}t.nextOp=rf(t.columns,t.actorTable),t.nextOp[Wt]=t.actorIndex,t.nextOp[Ze]=t.opCtr,t.changes[t.changeIndex].maxOp=t.opCtr,t.opCtr>e.maxOp&&(e.maxOp=t.opCtr),t.opCtr+=1;const n=t.nextOp;if(n[lt]===null&&n[pt]!==null||n[lt]!==null&&n[pt]===null)throw new RangeError(`Mismatched object reference: (${n[lt]}, ${n[pt]})`);if(n[Bt]===null&&n[Ut]!==null||n[Bt]===0&&n[Ut]!==null||n[Bt]>0&&n[Ut]===null)throw new RangeError(`Mismatched operation key: (${n[Bt]}, ${n[Ut]})`)}function ia(e,t){return t==="list"||t==="text"?{objectId:e,type:t,edits:[]}:{objectId:e,type:t,props:{}}}function Dy(e,t,n=1){const r=Gc(e),i=Gc(t);return r.actorId===i.actorId&&r.counter+n===i.counter}function Zo(e,t){if(e.length===0){e.push(t);return}let n=e[e.length-1];n.action==="insert"&&t.action==="insert"&&n.index===t.index-1&&n.value.type==="value"&&t.value.type==="value"&&n.elemId===n.opId&&t.elemId===t.opId&&Dy(n.elemId,t.elemId,1)&&n.value.datatype===t.value.datatype&&typeof n.value.value==typeof t.value.value?(n.action="multi-insert",t.value.datatype&&(n.datatype=t.value.datatype),n.values=[n.value.value,t.value.value],delete n.value,delete n.opId):n.action==="multi-insert"&&t.action==="insert"&&n.index+n.values.length===t.index&&t.value.type==="value"&&t.elemId===t.opId&&Dy(n.elemId,t.elemId,n.values.length)&&n.datatype===t.value.datatype&&typeof n.values[0]==typeof t.value.value?n.values.push(t.value.value):n.action==="remove"&&t.action==="remove"&&n.index===t.index?n.count+=t.count:e.push(t)}function af(e,t,n,r,i,a){let o=!1;if(a)for(;!o&&e.length>0;){const l=e[e.length-1];if((l.action==="insert"||l.action==="update")&&l.index===t)e.pop(),o=l.action==="insert";else if(l.action==="multi-insert"&&l.index+l.values.length-1===t)l.values.pop(),o=!0;else break}o?Zo(e,{action:"insert",index:t,elemId:n,opId:r,value:i}):Zo(e,{action:"update",index:t,opId:r,value:i})}function wT(e,t,n){let r=[];for(;e.length>0;){let a=e[e.length-1];if(a.action==="insert"){if(a.index!==t)throw new RangeError("last edit has unexpected index");r.unshift(e.pop());break}else if(a.action==="update"){if(a.index!==t)throw new RangeError("last edit has unexpected index");r.unshift(e.pop())}else throw new RangeError("last edit has unexpected action")}let i=!0;for(let a of r)af(e,t,n,a.opId,a.value,i),i=!1}function of(e,t,n,r,i,a,o,l){const c=!t,u=r[jt]<Ar.length?Ry[Ar[r[jt]]]:null,d=`${r[Ze]}@${i.actorIds[r[Wt]]}`,p=r[Gt]?r[Wt]:r[Ut],h=r[Gt]?r[Ze]:r[Bt],f=r[Ce]?r[Ce]:`${h}@${i.actorIds[p]}`;r[jt]%2===0&&!i.objectMeta[d]&&(i.objectMeta[d]={parentObj:n,parentKey:f,opId:d,type:u,children:{}},nf(i.objectMeta,[n,"children",f,d],{objectId:d,type:u,props:{}}));const v=!a[f];a[f]||(a[f]={visibleOps:[],hasChild:!1});const j=l!==void 0&&r[Yn]>0;j||(a[f].visibleOps.push(r),a[f].hasChild=a[f].hasChild||r[jt]%2===0);const _=i.objectMeta[n].children[f];if(a[f].hasChild||_&&Object.keys(_).length>0){let N={};for(let A of a[f].visibleOps){const E=`${A[Ze]}@${i.actorIds[A[Wt]]}`;if(Ar[A[jt]]==="set")N[E]=Object.assign({type:"value"},$l(A[es],A[Xs]));else if(A[jt]%2===0){const R=A[jt]<Ar.length?Ry[Ar[A[jt]]]:null;N[E]=ia(E,R)}}nf(i.objectMeta,[n,"children",f],N)}let m,y;if(j&&Ar[r[jt]]==="set"&&(r[es]&15)===ef.COUNTER){a[f]||(a[f]={visibleOps:[],hasChild:!1}),a[f].counterStates||(a[f].counterStates={});let N=a[f].counterStates,A={opId:d,value:$l(r[es],r[Xs]).value,succs:{}};for(let E=0;E<r[Yn];E++){const R=`${r[sa][E]}@${i.actorIds[r[tf][E]]}`;N[R]=A,A.succs[R]=!0}}else if(Ar[r[jt]]==="inc"){if(!a[f]||!a[f].counterStates||!a[f].counterStates[d])throw new RangeError(`increment operation ${d} for unknown counter`);let N=a[f].counterStates[d];N.value+=$l(r[es],r[Xs]).value,delete N.succs[d],Object.keys(N.succs).length===0&&(m=N.opId,y={type:"value",datatype:"counter",value:N.value})}else j||(Ar[r[jt]]==="set"?(m=d,y=Object.assign({type:"value"},$l(r[es],r[Xs]))):r[jt]%2===0&&(e[d]||(e[d]=ia(d,u)),m=d,y=e[d]));e[n]||(e[n]=ia(n,i.objectMeta[n].type));const b=e[n];if(r[Ce]===null)if(l===0&&!c&&a[f].action==="insert"&&(a[f].action="update",wT(b.edits,o,f),t&&t.lastObjectActor===r[pt]&&t.lastObjectCtr===r[lt]&&(t.numVisible-=1)),y)if(!a[f].action&&(l===void 0||c))a[f].action="insert",Zo(b.edits,{action:"insert",index:o,elemId:f,opId:m,value:y}),t&&t.lastObjectActor===r[pt]&&t.lastObjectCtr===r[lt]&&(t.numVisible+=1);else if(a[f].action==="remove"){let N=b.edits[b.edits.length-1];if(N.action!=="remove")throw new RangeError("last edit has unexpected type");N.count>1?N.count-=1:b.edits.pop(),a[f].action="update",af(b.edits,o,f,m,y,!0),t&&t.lastObjectActor===r[pt]&&t.lastObjectCtr===r[lt]&&(t.numVisible+=1)}else af(b.edits,o,f,m,y,!a[f].action),a[f].action||(a[f].action="update");else l===0&&!a[f].action&&(a[f].action="remove",Zo(b.edits,{action:"remove",index:o,count:1}),t&&t.lastObjectActor===r[pt]&&t.lastObjectCtr===r[lt]&&(t.numVisible-=1));else(y||!c)&&((v||!b.props[r[Ce]])&&(b.props[r[Ce]]={}),y&&(b.props[r[Ce]][m]=y))}function ST(e,t,n,r,i,a,o){const l=r.nextOp,c=l[Gt],u=l[pt],d=l[lt],p=u===null?"_root":`${d}@${i.actorIds[u]}`,h=r.actorIndex,f=i.actorIds[h];let v=!1,j=!1,_={},m;({docOp:m,blockIndex:o}=sf(i,o));let y=m===null?0:1,b=m===null?0:m[Yn],N=null,A=[],E=[],R=[],I=null;for(r.objectIds.add(p);;){if(A.length===0){v=!1;let P=r.nextOp;for(;!r.done&&P[Wt]===h&&P[Gt]===c&&P[pt]===l[pt]&&P[lt]===l[lt];){const V=A.length>0?A[A.length-1]:null;let K=!1;for(let ce=0;ce<P[ts];ce++)for(let M of A)P[na][ce]===M[Wt]&&P[ra][ce]===M[Ze]&&(K=!0);if(P!==l){if(!(c&&V!==null&&P[Ce]===null&&P[Ut]===V[Wt]&&P[Bt]===V[Ze])){if(!(!c&&V!==null&&P[Ce]!==null&&P[Ce]===V[Ce]&&!K)){if(!(!c&&V!==null&&P[Ce]===null&&V[Ce]===null&&P[Ut]===V[Ut]&&P[Bt]===V[Bt]&&!K)){if(!(!c&&V===null&&P[Ce]===null&&m&&m[Gt]&&m[Ce]===null&&m[Wt]===P[Ut]&&m[Ze]===P[Bt])){if(!(!c&&V===null&&P[Ce]!==null&&I!==null&&I<P[Ce]))break}}}}}I=P!==null?P[Ce]:null,A.push(r.nextOp),E.push(r.columns),R.push(new Array(r.nextOp[ts])),R0(i,r),P=r.nextOp}}A.length>0&&(N=A[0]);const T=m&&m[pt]===N[pt]&&m[lt]===N[lt],L=m&&m[Ce]!==null&&m[Ce]===N[Ce],B=m&&m[Ce]===null&&N[Ce]===null&&(!m[Gt]&&m[Ut]===N[Ut]&&m[Bt]===N[Bt]||m[Gt]&&m[Wt]===N[Ut]&&m[Ze]===N[Bt]);if(A.length===0&&!(T&&(L||B)))break;let W=!1,z=0;if(c||!T||m[Ce]===null&&N[Ce]!==null||m[Ce]!==null&&N[Ce]!==null&&N[Ce]<m[Ce]){if(z=A.length,!T&&!v&&N[Ce]===null&&!N[Gt])throw new RangeError(`could not find list element with ID: ${N[Bt]}@${i.actorIds[N[Ut]]}`)}else if(L||B||v){for(let P=0;P<A.length;P++){const V=A[P];for(let K=0;K<V[ts];K++)if(V[na][K]===m[Wt]&&V[ra][K]===m[Ze]){let ce=0;for(;ce<m[Yn]&&(m[sa][ce]<V[Ze]||m[sa][ce]===V[Ze]&&i.actorIds[m[tf][ce]]<f);)ce++;m[sa].splice(ce,0,V[Ze]),m[tf].splice(ce,0,h),m[Yn]++,R[P][K]=!0;break}}if(B&&(v=!0),v&&!B)z=A.length;else if(A.length===0||m[Ze]<N[Ze]||m[Ze]===N[Ze]&&i.actorIds[m[Wt]]<f){W=!0,of(e,t,p,m,i,_,a,b);for(let P=A.length-1;P>=0;P--){let V=!0;for(let K=0;K<A[P][ts];K++)R[P][K]||(V=!1);Ar[A[P][jt]]==="del"&&V&&(A.splice(P,1),E.splice(P,1),R.splice(P,1))}}else{if(m[Ze]===N[Ze]&&i.actorIds[m[Wt]]===f)throw new RangeError(`duplicate operation ID: ${N[Ze]}@${f}`);z=1}}else W=!0;if(W&&(dc(n,i.blocks[o].columns,m),_d(t,m,i.actorIds,!1),m[Gt]&&j&&(j=!1,a++),m[Yn]===0&&(j=!0),t.numOps++,{docOp:m,blockIndex:o}=sf(i,o),m!==null&&(y++,b=m[Yn])),z>0){for(let P=0;P<z;P++){let V=A[P];for(let K=0;K<V[ts];K++)if(!R[P][K])throw new RangeError(`no matching operation for pred: ${V[ra][K]}@${i.actorIds[V[na][K]]}`);dc(n,E[P],V),_d(t,V,i.actorIds,!0),of(e,t,p,V,i,_,a),V[Gt]?(j=!1,a++):j=!0}z===A.length?(A.length=0,E.length=0,R.length=0):(A.splice(0,z),E.splice(0,z),R.splice(0,z)),t.numOps+=z}}return m&&(dc(n,i.blocks[o].columns,m),t.numOps++,_d(t,m,i.actorIds,!1)),{docOpsConsumed:y,blockIndex:o}}function ET(e,t,n){const[r,i,a,o,l,c,u,d]=t.nextOp,p=r===null?null:n.actorIds[r],h=a===null?null:n.actorIds[a],f={objActor:p,objActorNum:r,objCtr:i,keyActor:h,keyCtr:o,keyStr:l,idActor:n.actorIds[c],idCtr:u,insert:d},{blockIndex:v,skipCount:j,visibleCount:_}=A0(n,f),m=n.blocks[v];for(let T of m.columns)T.decoder.reset();const y=j===0||m.firstVisibleActor===void 0||!d&&m.firstVisibleActor===a&&m.firstVisibleCtr===o,b={columns:void 0,bloom:new Uint8Array(m.bloom),numOps:j,lastKey:m.lastKey,numVisible:m.numVisible,lastObjectActor:m.lastObjectActor,lastObjectCtr:m.lastObjectCtr,firstVisibleActor:y?void 0:m.firstVisibleActor,firstVisibleCtr:y?void 0:m.firstVisibleCtr,lastVisibleActor:void 0,lastVisibleCtr:void 0},N=m.columns.map(T=>({columnId:T.columnId,encoder:ga(T.columnId)}));ya(N,m.columns,j);const{blockIndex:A,docOpsConsumed:E}=ST(e,b,N,t,n,_,v),R=n.blocks[A];let I=-j-E;for(let T=v;T<=A;T++)I+=n.blocks[T].numOps;ya(N,R.columns,I),b.numOps+=I;for(let T of R.columns)if(!T.decoder.done)throw new RangeError(`excess ops in column ${T.columnId}`);if(b.columns=N.map(T=>{const L=Bp(T.columnId,T.encoder.buffer);return{columnId:T.columnId,decoder:L}}),v===A&&b.numOps<=Eu)I>0&&m.lastVisibleActor!==void 0&&m.lastVisibleCtr!==void 0&&(b.lastVisibleActor=m.lastVisibleActor,b.lastVisibleCtr=m.lastVisibleCtr),n.blocks[v]=b;else{const T=I0(b);n.blocks.splice(v,A-v+1,...T)}}function NT(e,t){if(t[pt].columnId!==ze[pt].columnId||ze[pt].columnName!=="objActor"||t[lt].columnId!==ze[lt].columnId||ze[lt].columnName!=="objCtr"||t[Ut].columnId!==ze[Ut].columnId||ze[Ut].columnName!=="keyActor"||t[Bt].columnId!==ze[Bt].columnId||ze[Bt].columnName!=="keyCtr"||t[Ce].columnId!==ze[Ce].columnId||ze[Ce].columnName!=="keyStr"||t[Wt].columnId!==ze[Wt].columnId||ze[Wt].columnName!=="idActor"||t[Ze].columnId!==ze[Ze].columnId||ze[Ze].columnName!=="idCtr"||t[Gt].columnId!==ze[Gt].columnId||ze[Gt].columnName!=="insert"||t[jt].columnId!==ze[jt].columnId||ze[jt].columnName!=="action"||t[es].columnId!==ze[es].columnId||ze[es].columnName!=="valLen"||t[Xs].columnId!==ze[Xs].columnId||ze[Xs].columnName!=="valRaw"||t[ts].columnId!==ze[ts].columnId||ze[ts].columnName!=="predNum"||t[na].columnId!==ze[na].columnId||ze[na].columnName!=="predActor"||t[ra].columnId!==ze[ra].columnId||ze[ra].columnName!=="predCtr")throw new RangeError("unexpected columnId");const n=e.blocks[0].columns;if(!t.every(r=>Oy.includes(r.columnId)||n.find(i=>i.columnId===r.columnId))){let r=n.map(i=>({columnId:i.columnId}));for(let i of t){const{columnId:a}=i;!Oy.includes(a)&&!n.find(o=>o.columnId===a)&&r.push({columnId:a})}r.sort((i,a)=>i.columnId-a.columnId);for(let i=0;i<e.blocks.length;i++){let a=Yc(e.blocks[i]);a.columns=Qo(a.columns.map(o=>({columnId:o.columnId,buffer:o.decoder.buf})),r),e.blocks[i]=a}}}function _T(e,t){if(e.indexOf(t.actorIds[0])<0){if(t.seq!==1)throw new RangeError(`Seq ${t.seq} is the first change for actor ${t.actorIds[0]}`);e=e.concat([t.actorIds[0]])}const n=[];for(let r of t.actorIds){const i=e.indexOf(r);if(i<0)throw new RangeError(`actorId ${r} is not known to document`);n.push(i)}return{actorIds:e,actorTable:n}}function AT(e,t,n){for(let r of t){let i=n.objectMeta[r],a=null,o=!1;for(;;){const l=a&&Object.keys(i.children[a.parentKey]).length>0;if(e[r]||(e[r]=ia(r,i.type)),a&&l)if(i.type==="list"||i.type==="text"){for(let c of e[r].edits)c.opId&&i.children[a.parentKey][c.opId]&&(o=!0);if(!o){const c=Gc(r),u=Gc(a.parentKey),d={objActor:c.actorId,objCtr:c.counter,keyActor:u.actorId,keyCtr:u.counter,objActorNum:n.actorIds.indexOf(c.actorId),keyActorNum:n.actorIds.indexOf(u.actorId),keyStr:null,insert:!1},{visibleCount:p}=A0(n,d);for(let[h,f]of Object.entries(i.children[a.parentKey])){let v=f;f.objectId&&(e[f.objectId]||(e[f.objectId]=ia(f.objectId,f.type)),v=e[f.objectId]);const j={action:"update",index:p,opId:h,value:v};Zo(e[r].edits,j)}}}else{e[r].props[a.parentKey]||(e[r].props[a.parentKey]={});let c=e[r].props[a.parentKey];for(let[u,d]of Object.entries(i.children[a.parentKey]))c[u]?o=!0:d.objectId?(e[d.objectId]||(e[d.objectId]=ia(d.objectId,d.type)),c[u]=e[d.objectId]):c[u]=d}if(o||!i.parentObj||a&&!l)break;a=i,r=i.parentObj,i=n.objectMeta[r]}}return e}function CT(e,t,n,r,i){let a=new Set(n.heads),o=new Set,l=Yc(n.clock),c=[],u=[];for(let d of t){if(n.changeIndexByHash[d.hash]!==void 0||o.has(d.hash))continue;const p=(l[d.actor]||0)+1;let h=!0;for(let f of d.deps){const v=n.changeIndexByHash[f];(v===void 0||v===-1)&&!o.has(f)&&(h=!1)}if(!h)u.push(d);else if(d.seq<p){if(i)throw new RangeError(`Reuse of sequence number ${d.seq} for actor ${d.actor}`);return[[],t]}else{if(d.seq>p)throw new RangeError(`Skipped sequence number ${p} for actor ${d.actor}`);l[d.actor]=d.seq,o.add(d.hash);for(let f of d.deps)a.delete(f);a.add(d.hash),c.push(d)}}if(c.length>0){let d={changes:c,changeIndex:-1,objectIds:r};for(R0(n,d);!d.done;)ET(e,d,n);n.heads=[...a].sort(),n.clock=l}return[c,u]}function My(e){for(let d of e.blocks[0].columns)d.decoder.reset();let t={},n=null,r=0,i={_root:{objectId:"_root",type:"map",props:{}}},a=null,o=null,l="_root",c=!1,u=0;for(;{docOp:n,blockIndex:r}=sf(e,r),n!==null;){(n[pt]!==a||n[lt]!==o)&&(l=`${n[lt]}@${e.actorIds[n[pt]]}`,a=n[pt],o=n[lt],t={},u=0,c=!1),n[Gt]&&c&&(c=!1,u++),n[Yn]===0&&(c=!0),n[Ze]>e.maxOp&&(e.maxOp=n[Ze]);for(let d=0;d<n[Yn];d++)n[sa][d]>e.maxOp&&(e.maxOp=n[sa][d]);of(i,null,l,n,e,t,u,n[Yn])}return i._root}function kT(e){const t=Qo(e.changesColumns,Hn),n=t[0].decoder,r=t[1].decoder,i=t[5].decoder,a=t[6].decoder;if(t[0].columnId!==Hn[0].columnId||Hn[0].columnName!=="actor"||t[1].columnId!==Hn[1].columnId||Hn[1].columnName!=="seq"||t[5].columnId!==Hn[5].columnId||Hn[5].columnName!=="depsNum"||t[6].columnId!==Hn[6].columnId||Hn[6].columnName!=="depsIndex")throw new RangeError("unexpected columnId");let o=0,l={},c=[],u=new Set;for(;!n.done;){const h=n.readValue(),f=r.readValue(),v=i.readValue(),j=e.actorIds[h];if(f!==1&&f!==l[j]+1)throw new RangeError(`Expected seq ${l[j]+1}, got ${f} for actor ${j}`);c.push(h),l[j]=f,u.add(o);for(let _=0;_<v;_++)u.delete(a.readValue());o++}const d=[...u].map(h=>e.actorIds[c[h]]).sort();for(let h of t)h.decoder.reset();const p=t.map(h=>({columnId:h.columnId,encoder:ga(h.columnId)}));return ya(p,t,o),{clock:l,headActors:d,encoders:p,numChanges:o}}function IT(e,t,n,r){dc(e,Hn,[n.indexOf(t.actor),t.seq,t.maxOp,t.time,t.message,t.deps.length,t.deps.map(i=>r[i]),t.extraBytes?t.extraBytes.byteLength<<4|ef.BYTES:ef.BYTES,t.extraBytes])}let RT=class T0{constructor(t){if(this.maxOp=0,this.haveHashGraph=!1,this.changes=[],this.changeIndexByHash={},this.dependenciesByHash={},this.dependentsByHash={},this.hashesByActor={},this.actorIds=[],this.heads=[],this.clock={},this.queue=[],this.objectMeta={_root:{parentObj:null,parentKey:null,opId:null,type:"map",children:{}}},t){const n=yT(t),{clock:r,headActors:i,encoders:a,numChanges:o}=kT(n);if(this.binaryDoc=t,this.changes=new Array(o),this.actorIds=n.actorIds,this.heads=n.heads,this.clock=r,this.changesEncoders=a,this.extraBytes=n.extraBytes,n.heads.length===1&&i.length===1&&(this.hashesByActor[i[0]]=[],this.hashesByActor[i[0]][r[i[0]]-1]=n.heads[0]),n.heads.length===n.headsIndexes.length)for(let c=0;c<n.heads.length;c++)this.changeIndexByHash[n.heads[c]]=n.headsIndexes[c];else if(n.heads.length===1)this.changeIndexByHash[n.heads[0]]=o-1;else for(let c of n.heads)this.changeIndexByHash[c]=-1;this.blocks=[{columns:Qo(n.opsColumns,Ty)}],k0(this.blocks[0]),this.blocks[0].numOps>Eu&&(this.blocks=I0(this.blocks[0]));let l={blocks:this.blocks,actorIds:this.actorIds,objectMeta:this.objectMeta,maxOp:0};this.initPatch=My(l),this.maxOp=l.maxOp}else this.haveHashGraph=!0,this.changesEncoders=Hn.map(n=>({columnId:n.columnId,encoder:ga(n.columnId)})),this.blocks=[{columns:Qo([],Ty),bloom:new Uint8Array(_0),numOps:0,lastKey:void 0,numVisible:void 0,lastObjectActor:void 0,lastObjectCtr:void 0,firstVisibleActor:void 0,firstVisibleCtr:void 0,lastVisibleActor:void 0,lastVisibleCtr:void 0}]}clone(){let t=new T0;return t.maxOp=this.maxOp,t.haveHashGraph=this.haveHashGraph,t.changes=this.changes.slice(),t.changeIndexByHash=Yc(this.changeIndexByHash),t.dependenciesByHash=Yc(this.dependenciesByHash),t.dependentsByHash=Object.entries(this.dependentsByHash).reduce((n,[r,i])=>(n[r]=i.slice(),n),{}),t.hashesByActor=Object.entries(this.hashesByActor).reduce((n,[r,i])=>(n[r]=i.slice(),n),{}),t.actorIds=this.actorIds,t.heads=this.heads,t.clock=this.clock,t.blocks=this.blocks,t.objectMeta=this.objectMeta,t.queue=this.queue,t}applyChanges(t,n=!1){let r=t.map(d=>{const p=pT(d);return p.buffer=d,p}),i={_root:{objectId:"_root",type:"map",props:{}}},a={maxOp:this.maxOp,changeIndexByHash:this.changeIndexByHash,actorIds:this.actorIds,heads:this.heads,clock:this.clock,blocks:this.blocks.slice(),objectMeta:Object.assign({},this.objectMeta)},o=this.queue.length===0?r:r.concat(this.queue),l=[],c=new Set;for(;;){const[d,p]=CT(i,o,a,c,this.haveHashGraph);o=p;for(let h=0;h<d.length;h++)a.changeIndexByHash[d[h].hash]=this.changes.length+l.length+h;if(d.length>0&&(l=l.concat(d)),o.length===0)break;if(d.length===0){if(this.haveHashGraph)break;this.computeHashGraph(),a.changeIndexByHash=this.changeIndexByHash}}AT(i,c,a);for(let d of l){this.changes.push(d.buffer),this.hashesByActor[d.actor]||(this.hashesByActor[d.actor]=[]),this.hashesByActor[d.actor][d.seq-1]=d.hash,this.changeIndexByHash[d.hash]=this.changes.length-1,this.dependenciesByHash[d.hash]=d.deps,this.dependentsByHash[d.hash]=[];for(let p of d.deps)this.dependentsByHash[p]||(this.dependentsByHash[p]=[]),this.dependentsByHash[p].push(d.hash);IT(this.changesEncoders,d,a.actorIds,this.changeIndexByHash)}this.maxOp=a.maxOp,this.actorIds=a.actorIds,this.heads=a.heads,this.clock=a.clock,this.blocks=a.blocks,this.objectMeta=a.objectMeta,this.queue=o,this.binaryDoc=null,this.initPatch=null;let u={maxOp:this.maxOp,clock:this.clock,deps:this.heads,pendingChanges:this.queue.length,diffs:i._root};return n&&r.length===1&&(u.actor=r[0].actor,u.seq=r[0].seq),u}computeHashGraph(){const t=this.save();this.haveHashGraph=!0,this.changes=[],this.changeIndexByHash={},this.dependenciesByHash={},this.dependentsByHash={},this.hashesByActor={},this.clock={};for(let n of gT([t])){const r=fT(n);this.changes.push(r),this.changeIndexByHash[n.hash]=this.changes.length-1,this.dependenciesByHash[n.hash]=n.deps,this.dependentsByHash[n.hash]=[];for(let a of n.deps)this.dependentsByHash[a].push(n.hash);n.seq===1&&(this.hashesByActor[n.actor]=[]),this.hashesByActor[n.actor].push(n.hash);const i=(this.clock[n.actor]||0)+1;if(n.seq!==i)throw new RangeError(`Expected seq ${i}, got seq ${n.seq} from actor ${n.actor}`);this.clock[n.actor]=n.seq}}getChanges(t){if(this.haveHashGraph||this.computeHashGraph(),t.length===0)return this.changes.slice();let n=[],r={},i=[];for(let a of t){r[a]=!0;const o=this.dependentsByHash[a];if(!o)throw new RangeError(`hash not found: ${a}`);n.push(...o)}for(;n.length>0;){const a=n.pop();if(r[a]=!0,i.push(a),!this.dependenciesByHash[a].every(o=>r[o]))break;n.push(...this.dependentsByHash[a])}if(n.length===0&&this.heads.every(a=>r[a]))return i.map(a=>this.changes[this.changeIndexByHash[a]]);for(n=t.slice(),r={};n.length>0;){const a=n.pop();if(!r[a]){const o=this.dependenciesByHash[a];if(!o)throw new RangeError(`hash not found: ${a}`);n.push(...o),r[a]=!0}}return this.changes.filter(a=>!r[mT(a,!0).hash])}getChangesAdded(t){this.haveHashGraph||this.computeHashGraph();let n=this.heads.slice(),r={},i=[];for(;n.length>0;){const a=n.pop();!r[a]&&t.changeIndexByHash[a]===void 0&&(r[a]=!0,i.push(a),n.push(...this.dependenciesByHash[a]))}return i.reverse().map(a=>this.changes[this.changeIndexByHash[a]])}getChangeByHash(t){return this.haveHashGraph||this.computeHashGraph(),this.changes[this.changeIndexByHash[t]]}getMissingDeps(t=[]){this.haveHashGraph||this.computeHashGraph();let n=new Set(t),r=new Set;for(let a of this.queue){r.add(a.hash);for(let o of a.deps)n.add(o)}let i=[];for(let a of n)this.changeIndexByHash[a]===void 0&&!r.has(a)&&i.push(a);return i.sort()}save(){if(this.binaryDoc)return this.binaryDoc;const t=this.changesEncoders.map(r=>({columnId:r.columnId,encoder:ga(r.columnId)})),n=this.changesEncoders.map(r=>{const i=Bp(r.columnId,r.encoder.buffer);return{columnId:r.columnId,decoder:i}});return ya(t,n,this.changes.length),this.binaryDoc=vT({changesColumns:this.changesEncoders,opsColumns:bT(this.blocks),actorIds:this.actorIds,heads:this.heads,headsIndexes:this.heads.map(r=>this.changeIndexByHash[r]),extraBytes:this.extraBytes}),this.changesEncoders=t,this.binaryDoc}getPatch(){const t={_root:{parentObj:null,parentKey:null,opId:null,type:"map",children:{}}},n={blocks:this.blocks,actorIds:this.actorIds,objectMeta:t,maxOp:0},r=this.initPatch?this.initPatch:My(n);return{maxOp:this.maxOp,clock:this.clock,deps:this.heads,pendingChanges:this.queue.length,diffs:r}}};var TT={BackendDoc:RT};function OT(e){if(e.frozen)throw new Error("Attempting to use an outdated Automerge document that has already been updated. Please use the latest document state, or call Automerge.clone() if you really need to use this old document state.");return e.state}var PT={backendState:OT};const{encodeChange:LT}=Su,{BackendDoc:O0}=TT,{backendState:Xn}=PT;function DT(){return{state:new O0,heads:[]}}function MT(e){return{state:Xn(e).clone(),heads:e.heads}}function UT(e){e.state=null,e.frozen=!0}function BT(e,t){const n=Xn(e),r=n.applyChanges(t);return e.frozen=!0,[{state:n,heads:n.heads},r]}function Uy(e,t,n){if(e.hashesByActor[t]&&e.hashesByActor[t][n]||!e.haveHashGraph&&(e.computeHashGraph(),e.hashesByActor[t]&&e.hashesByActor[t][n]))return e.hashesByActor[t][n];throw new RangeError(`Unknown change: actorId = ${t}, seq = ${n+1}`)}function VT(e,t){const n=Xn(e);if(t.seq<=n.clock[t.actor])throw new RangeError("Change request has already been applied");if(t.seq>1){const o=Uy(n,t.actor,t.seq-2);if(!o)throw new RangeError(`Cannot find hash of localChange before seq=${t.seq}`);let l={[o]:!0};for(let c of t.deps)l[c]=!0;t.deps=Object.keys(l).sort()}const r=LT(t),i=n.applyChanges([r],!0);e.frozen=!0;const a=Uy(n,t.actor,t.seq-1);return i.deps=i.deps.filter(o=>o!==a),[{state:n,heads:n.heads},i,r]}function $T(e){return Xn(e).save()}function FT(e){const t=new O0(e);return{state:t,heads:t.heads}}function HT(e,t){const n=Xn(e);return n.applyChanges(t),e.frozen=!0,{state:n,heads:n.heads}}function qT(e){return Xn(e).getPatch()}function zT(e){return e.heads}function WT(e){return P0(e,[])}function P0(e,t){if(!Array.isArray(t))throw new TypeError("Pass an array of hashes to Backend.getChanges()");return Xn(e).getChanges(t)}function GT(e,t){return Xn(t).getChangesAdded(Xn(e))}function YT(e,t){return Xn(e).getChangeByHash(t)}function KT(e,t=[]){return Xn(e).getMissingDeps(t)}var L0={init:DT,clone:MT,free:UT,applyChanges:BT,applyLocalChange:VT,save:$T,load:FT,loadChanges:HT,getPatch:qT,getHeads:zT,getAllChanges:WT,getChanges:P0,getChangesAdded:GT,getChangeByHash:YT,getMissingDeps:KT};const Kn=L0,{hexStringToBytes:D0,bytesToHexString:JT,Encoder:Vp,Decoder:$p}=a0,{decodeChangeMeta:Kc}=Su,{copyObject:QT}=xr,M0=32,U0=66,B0=67,ZT=10,XT=7;class V0{constructor(t){if(Array.isArray(t)){this.numEntries=t.length,this.numBitsPerEntry=ZT,this.numProbes=XT,this.bits=new Uint8Array(Math.ceil(this.numEntries*this.numBitsPerEntry/8));for(let n of t)this.addHash(n)}else if(t instanceof Uint8Array)if(t.byteLength===0)this.numEntries=0,this.numBitsPerEntry=0,this.numProbes=0,this.bits=t;else{const n=new $p(t);this.numEntries=n.readUint32(),this.numBitsPerEntry=n.readUint32(),this.numProbes=n.readUint32(),this.bits=n.readRawBytes(Math.ceil(this.numEntries*this.numBitsPerEntry/8))}else throw new TypeError("invalid argument")}get bytes(){if(this.numEntries===0)return new Uint8Array(0);const t=new Vp;return t.appendUint32(this.numEntries),t.appendUint32(this.numBitsPerEntry),t.appendUint32(this.numProbes),t.appendRawBytes(this.bits),t.buffer}getProbes(t){const n=D0(t),r=8*this.bits.byteLength;if(n.byteLength!==32)throw new RangeError(`Not a 256-bit hash: ${t}`);let i=((n[0]|n[1]<<8|n[2]<<16|n[3]<<24)>>>0)%r,a=((n[4]|n[5]<<8|n[6]<<16|n[7]<<24)>>>0)%r,o=((n[8]|n[9]<<8|n[10]<<16|n[11]<<24)>>>0)%r;const l=[i];for(let c=1;c<this.numProbes;c++)i=(i+a)%r,a=(a+o)%r,l.push(i);return l}addHash(t){for(let n of this.getProbes(t))this.bits[n>>>3]|=1<<(n&7)}containsHash(t){if(this.numEntries===0)return!1;for(let n of this.getProbes(t))if(!(this.bits[n>>>3]&1<<(n&7)))return!1;return!0}}function hc(e,t){if(!Array.isArray(t))throw new TypeError("hashes must be an array");e.appendUint32(t.length);for(let n=0;n<t.length;n++){if(n>0&&t[n-1]>=t[n])throw new RangeError("hashes must be sorted");const r=D0(t[n]);if(r.byteLength!==M0)throw new TypeError("heads hashes must be 256 bits");e.appendRawBytes(r)}}function fc(e){let t=e.readUint32(),n=[];for(let r=0;r<t;r++)n.push(JT(e.readRawBytes(M0)));return n}function lf(e){const t=new Vp;t.appendByte(U0),hc(t,e.heads),hc(t,e.need),t.appendUint32(e.have.length);for(let n of e.have)hc(t,n.lastSync),t.appendPrefixedBytes(n.bloom);t.appendUint32(e.changes.length);for(let n of e.changes)t.appendPrefixedBytes(n);return t.buffer}function $0(e){const t=new $p(e),n=t.readByte();if(n!==U0)throw new RangeError(`Unexpected message type: ${n}`);const r=fc(t),i=fc(t),a=t.readUint32();let o={heads:r,need:i,have:[],changes:[]};for(let c=0;c<a;c++){const u=fc(t),d=t.readPrefixedBytes(t);o.have.push({lastSync:u,bloom:d})}const l=t.readUint32();for(let c=0;c<l;c++){const u=t.readPrefixedBytes();o.changes.push(u)}return o}function eO(e){const t=new Vp;return t.appendByte(B0),hc(t,e.sharedHeads),t.buffer}function tO(e){const t=new $p(e),n=t.readByte();if(n!==B0)throw new RangeError(`Unexpected record type: ${n}`);const r=fc(t);return Object.assign(F0(),{sharedHeads:r})}function nO(e,t){const r=Kn.getChanges(e,t).map(i=>Kc(i,!0).hash);return{lastSync:t,bloom:new V0(r).bytes}}function rO(e,t,n){if(t.length===0)return n.map(p=>Kn.getChangeByHash(e,p)).filter(p=>p!==void 0);let r={},i=[];for(let p of t){for(let h of p.lastSync)r[h]=!0;i.push(new V0(p.bloom))}const a=Kn.getChanges(e,Object.keys(r)).map(p=>Kc(p,!0));let o={},l={},c={};for(let p of a){o[p.hash]=!0;for(let h of p.deps)l[h]||(l[h]=[]),l[h].push(p.hash);i.every(h=>!h.containsHash(p.hash))&&(c[p.hash]=!0)}let u=Object.keys(c);for(;u.length>0;){const p=u.pop();if(l[p])for(let h of l[p])c[h]||(c[h]=!0,u.push(h))}let d=[];for(let p of n)if(c[p]=!0,!o[p]){const h=Kn.getChangeByHash(e,p);h&&d.push(h)}for(let p of a)c[p.hash]&&d.push(p.change);return d}function F0(){return{sharedHeads:[],lastSentHeads:[],theirHeads:null,theirNeed:null,theirHave:null,sentHashes:{}}}function cf(e,t){return e.length===t.length&&e.every((n,r)=>n===t[r])}function sO(e,t){if(!e)throw new Error("generateSyncMessage called with no Automerge document");if(!t)throw new Error("generateSyncMessage requires a syncState, which can be created with initSyncState()");let{sharedHeads:n,lastSentHeads:r,theirHeads:i,theirNeed:a,theirHave:o,sentHashes:l}=t;const c=Kn.getHeads(e),u=Kn.getMissingDeps(e,i||[]);let d=[];if((!i||u.every(j=>i.includes(j)))&&(d=[nO(e,n)]),o&&o.length>0&&!o[0].lastSync.every(_=>Kn.getChangeByHash(e,_))){const _={heads:c,need:[],have:[{lastSync:[],bloom:new Uint8Array(0)}],changes:[]};return[t,lf(_)]}let p=Array.isArray(o)&&Array.isArray(a)?rO(e,o,a):[];const h=Array.isArray(r)&&cf(c,r),f=Array.isArray(i)&&cf(c,i);if(h&&f&&p.length===0)return[t,null];p=p.filter(j=>!l[Kc(j,!0).hash]);const v={heads:c,have:d,need:u,changes:p};if(p.length>0){l=QT(l);for(const j of p)l[Kc(j,!0).hash]=!0}return t=Object.assign({},t,{lastSentHeads:c,sentHashes:l}),[t,lf(v)]}function iO(e,t,n){const r=t.filter(o=>!e.includes(o)),i=n.filter(o=>t.includes(o));return[...new Set([...r,...i])].sort()}function aO(e,t,n){if(!e)throw new Error("generateSyncMessage called with no Automerge document");if(!t)throw new Error("generateSyncMessage requires a syncState, which can be created with initSyncState()");let{sharedHeads:r,lastSentHeads:i,sentHashes:a}=t,o=null;const l=$0(n),c=Kn.getHeads(e);l.changes.length>0&&([e,o]=Kn.applyChanges(e,l.changes),r=iO(c,Kn.getHeads(e),r)),l.changes.length===0&&cf(l.heads,c)&&(i=l.heads);const u=l.heads.filter(p=>Kn.getChangeByHash(e,p));u.length===l.heads.length?(r=l.heads,l.heads.length===0&&(i=[],a=[])):r=[...new Set(u.concat(r))].sort();const d={sharedHeads:r,lastSentHeads:i,theirHave:l.have,theirHeads:l.heads,theirNeed:l.need,sentHashes:a};return[e,d,o]}var oO={receiveSyncMessage:aO,generateSyncMessage:sO,encodeSyncMessage:lf,decodeSyncMessage:$0,initSyncState:F0,encodeSyncState:eO,decodeSyncState:tO};const{init:lO,clone:cO,free:uO,applyChanges:dO,applyLocalChange:hO,save:fO,load:pO,loadChanges:mO,getPatch:gO,getHeads:yO,getAllChanges:vO,getChanges:xO,getChangesAdded:jO,getChangeByHash:bO,getMissingDeps:wO}=L0,{receiveSyncMessage:SO,generateSyncMessage:EO,encodeSyncMessage:NO,decodeSyncMessage:_O,encodeSyncState:AO,decodeSyncState:CO,initSyncState:kO}=oO;var IO={init:lO,clone:cO,free:uO,applyChanges:dO,applyLocalChange:hO,save:fO,load:pO,loadChanges:mO,getPatch:gO,getHeads:yO,getAllChanges:vO,getChanges:xO,getChangesAdded:jO,getChangeByHash:bO,getMissingDeps:wO,receiveSyncMessage:SO,generateSyncMessage:EO,encodeSyncMessage:NO,decodeSyncMessage:_O,encodeSyncState:AO,decodeSyncState:CO,initSyncState:kO};(function(e){const t=xp,n=Rk,{OPTIONS:r}=As,{encodeChange:i,decodeChange:a}=Su,{isObject:o}=xr;let l=IO;function c(B){if(typeof B=="string")B={actorId:B};else if(typeof B>"u")B={};else if(!o(B))throw new TypeError(`Unsupported options for init(): ${B}`);return n.init(Object.assign({backend:l},B))}function u(B,W){const z={message:"Initialization"};return d(c(W),z,P=>Object.assign(P,B))}function d(B,W,z){const[P]=n.change(B,W,z);return P}function p(B,W){const[z]=n.emptyChange(B,W);return z}function h(B,W={}){const z=l.clone(n.getBackendState(B,"clone"));return b(c(W),l.getPatch(z),z,[],W)}function f(B){l.free(n.getBackendState(B,"free"))}function v(B,W={}){const z=l.load(B);return b(c(W),l.getPatch(z),z,[B],W)}function j(B){return l.save(n.getBackendState(B,"save"))}function _(B,W){const z=n.getBackendState(B,"merge"),P=n.getBackendState(W,"merge","second"),V=l.getChangesAdded(z,P),[K]=N(B,V);return K}function m(B,W){const z=n.getBackendState(B,"getChanges"),P=n.getBackendState(W,"getChanges","second");return l.getChanges(P,l.getHeads(z))}function y(B){return l.getAllChanges(n.getBackendState(B,"getAllChanges"))}function b(B,W,z,P,V){const K=n.applyPatch(B,W,z),ce=V.patchCallback||B[r].patchCallback;return ce&&ce(W,B,K,!1,P),K}function N(B,W,z={}){const P=n.getBackendState(B,"applyChanges"),[V,K]=l.applyChanges(P,W);return[b(B,K,V,W,z),K]}function A(B,W){if(!o(B)||!o(W))return B===W;const z=Object.keys(B).sort(),P=Object.keys(W).sort();if(z.length!==P.length)return!1;for(let V=0;V<z.length;V++)if(z[V]!==P[V]||!A(B[z[V]],W[P[V]]))return!1;return!0}function E(B){const W=n.getActorId(B),z=y(B);return z.map((P,V)=>({get change(){return a(P)},get snapshot(){const K=l.loadChanges(l.init(),z.slice(0,V+1));return n.applyPatch(c(W),l.getPatch(K),K)}}))}function R(B,W){const z=n.getBackendState(B,"generateSyncMessage");return l.generateSyncMessage(z,W)}function I(B,W,z){const P=n.getBackendState(B,"receiveSyncMessage"),[V,K,ce]=l.receiveSyncMessage(P,W,z);if(!ce)return[B,K,ce];let M=null;return B[r].patchCallback&&(M=l.decodeSyncMessage(z).changes),[b(B,ce,V,M,{}),K,ce]}function T(){return l.initSyncState()}function L(B){l=B}e.exports={init:c,from:u,change:d,emptyChange:p,clone:h,free:f,load:v,save:j,merge:_,getChanges:m,getAllChanges:y,applyChanges:N,encodeChange:i,decodeChange:a,equals:A,getHistory:E,uuid:t,Frontend:n,setDefaultBackend:L,generateSyncMessage:R,receiveSyncMessage:I,initSyncState:T,get Backend(){return l}};for(let B of["getObjectId","getObjectById","getActorId","setActorId","getConflicts","getLastLocalChange","Text","Table","Counter","Observable","Int","Uint","Float64"])e.exports[B]=n[B]})(Wj);var RO=Wj.exports;const si=df(RO);function Fl(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var H0={exports:{}};/*!
    localForage -- Offline Storage, Improved
    Version 1.10.0
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/(function(e,t){(function(n){e.exports=n()})(function(){return function n(r,i,a){function o(u,d){if(!i[u]){if(!r[u]){var p=typeof Fl=="function"&&Fl;if(!d&&p)return p(u,!0);if(l)return l(u,!0);var h=new Error("Cannot find module '"+u+"'");throw h.code="MODULE_NOT_FOUND",h}var f=i[u]={exports:{}};r[u][0].call(f.exports,function(v){var j=r[u][1][v];return o(j||v)},f,f.exports,n,r,i,a)}return i[u].exports}for(var l=typeof Fl=="function"&&Fl,c=0;c<a.length;c++)o(a[c]);return o}({1:[function(n,r,i){(function(a){var o=a.MutationObserver||a.WebKitMutationObserver,l;if(o){var c=0,u=new o(v),d=a.document.createTextNode("");u.observe(d,{characterData:!0}),l=function(){d.data=c=++c%2}}else if(!a.setImmediate&&typeof a.MessageChannel<"u"){var p=new a.MessageChannel;p.port1.onmessage=v,l=function(){p.port2.postMessage(0)}}else"document"in a&&"onreadystatechange"in a.document.createElement("script")?l=function(){var _=a.document.createElement("script");_.onreadystatechange=function(){v(),_.onreadystatechange=null,_.parentNode.removeChild(_),_=null},a.document.documentElement.appendChild(_)}:l=function(){setTimeout(v,0)};var h,f=[];function v(){h=!0;for(var _,m,y=f.length;y;){for(m=f,f=[],_=-1;++_<y;)m[_]();y=f.length}h=!1}r.exports=j;function j(_){f.push(_)===1&&!h&&l()}}).call(this,typeof Qa<"u"?Qa:typeof self<"u"?self:typeof window<"u"?window:{})},{}],2:[function(n,r,i){var a=n(1);function o(){}var l={},c=["REJECTED"],u=["FULFILLED"],d=["PENDING"];r.exports=p;function p(A){if(typeof A!="function")throw new TypeError("resolver must be a function");this.state=d,this.queue=[],this.outcome=void 0,A!==o&&j(this,A)}p.prototype.catch=function(A){return this.then(null,A)},p.prototype.then=function(A,E){if(typeof A!="function"&&this.state===u||typeof E!="function"&&this.state===c)return this;var R=new this.constructor(o);if(this.state!==d){var I=this.state===u?A:E;f(R,I,this.outcome)}else this.queue.push(new h(R,A,E));return R};function h(A,E,R){this.promise=A,typeof E=="function"&&(this.onFulfilled=E,this.callFulfilled=this.otherCallFulfilled),typeof R=="function"&&(this.onRejected=R,this.callRejected=this.otherCallRejected)}h.prototype.callFulfilled=function(A){l.resolve(this.promise,A)},h.prototype.otherCallFulfilled=function(A){f(this.promise,this.onFulfilled,A)},h.prototype.callRejected=function(A){l.reject(this.promise,A)},h.prototype.otherCallRejected=function(A){f(this.promise,this.onRejected,A)};function f(A,E,R){a(function(){var I;try{I=E(R)}catch(T){return l.reject(A,T)}I===A?l.reject(A,new TypeError("Cannot resolve promise with itself")):l.resolve(A,I)})}l.resolve=function(A,E){var R=_(v,E);if(R.status==="error")return l.reject(A,R.value);var I=R.value;if(I)j(A,I);else{A.state=u,A.outcome=E;for(var T=-1,L=A.queue.length;++T<L;)A.queue[T].callFulfilled(E)}return A},l.reject=function(A,E){A.state=c,A.outcome=E;for(var R=-1,I=A.queue.length;++R<I;)A.queue[R].callRejected(E);return A};function v(A){var E=A&&A.then;if(A&&(typeof A=="object"||typeof A=="function")&&typeof E=="function")return function(){E.apply(A,arguments)}}function j(A,E){var R=!1;function I(W){R||(R=!0,l.reject(A,W))}function T(W){R||(R=!0,l.resolve(A,W))}function L(){E(T,I)}var B=_(L);B.status==="error"&&I(B.value)}function _(A,E){var R={};try{R.value=A(E),R.status="success"}catch(I){R.status="error",R.value=I}return R}p.resolve=m;function m(A){return A instanceof this?A:l.resolve(new this(o),A)}p.reject=y;function y(A){var E=new this(o);return l.reject(E,A)}p.all=b;function b(A){var E=this;if(Object.prototype.toString.call(A)!=="[object Array]")return this.reject(new TypeError("must be an array"));var R=A.length,I=!1;if(!R)return this.resolve([]);for(var T=new Array(R),L=0,B=-1,W=new this(o);++B<R;)z(A[B],B);return W;function z(P,V){E.resolve(P).then(K,function(ce){I||(I=!0,l.reject(W,ce))});function K(ce){T[V]=ce,++L===R&&!I&&(I=!0,l.resolve(W,T))}}}p.race=N;function N(A){var E=this;if(Object.prototype.toString.call(A)!=="[object Array]")return this.reject(new TypeError("must be an array"));var R=A.length,I=!1;if(!R)return this.resolve([]);for(var T=-1,L=new this(o);++T<R;)B(A[T]);return L;function B(W){E.resolve(W).then(function(z){I||(I=!0,l.resolve(L,z))},function(z){I||(I=!0,l.reject(L,z))})}}},{1:1}],3:[function(n,r,i){(function(a){typeof a.Promise!="function"&&(a.Promise=n(2))}).call(this,typeof Qa<"u"?Qa:typeof self<"u"?self:typeof window<"u"?window:{})},{2:2}],4:[function(n,r,i){var a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(x){return typeof x}:function(x){return x&&typeof Symbol=="function"&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":typeof x};function o(x,C){if(!(x instanceof C))throw new TypeError("Cannot call a class as a function")}function l(){try{if(typeof indexedDB<"u")return indexedDB;if(typeof webkitIndexedDB<"u")return webkitIndexedDB;if(typeof mozIndexedDB<"u")return mozIndexedDB;if(typeof OIndexedDB<"u")return OIndexedDB;if(typeof msIndexedDB<"u")return msIndexedDB}catch{return}}var c=l();function u(){try{if(!c||!c.open)return!1;var x=typeof openDatabase<"u"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),C=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!x||C)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch{return!1}}function d(x,C){x=x||[],C=C||{};try{return new Blob(x,C)}catch(O){if(O.name!=="TypeError")throw O;for(var S=typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder,w=new S,D=0;D<x.length;D+=1)w.append(x[D]);return w.getBlob(C.type)}}typeof Promise>"u"&&n(3);var p=Promise;function h(x,C){C&&x.then(function(S){C(null,S)},function(S){C(S)})}function f(x,C,S){typeof C=="function"&&x.then(C),typeof S=="function"&&x.catch(S)}function v(x){return typeof x!="string"&&(console.warn(x+" used as a key, but it is not a string."),x=String(x)),x}function j(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var _="local-forage-detect-blob-support",m=void 0,y={},b=Object.prototype.toString,N="readonly",A="readwrite";function E(x){for(var C=x.length,S=new ArrayBuffer(C),w=new Uint8Array(S),D=0;D<C;D++)w[D]=x.charCodeAt(D);return S}function R(x){return new p(function(C){var S=x.transaction(_,A),w=d([""]);S.objectStore(_).put(w,"key"),S.onabort=function(D){D.preventDefault(),D.stopPropagation(),C(!1)},S.oncomplete=function(){var D=navigator.userAgent.match(/Chrome\/(\d+)/),O=navigator.userAgent.match(/Edge\//);C(O||!D||parseInt(D[1],10)>=43)}}).catch(function(){return!1})}function I(x){return typeof m=="boolean"?p.resolve(m):R(x).then(function(C){return m=C,m})}function T(x){var C=y[x.name],S={};S.promise=new p(function(w,D){S.resolve=w,S.reject=D}),C.deferredOperations.push(S),C.dbReady?C.dbReady=C.dbReady.then(function(){return S.promise}):C.dbReady=S.promise}function L(x){var C=y[x.name],S=C.deferredOperations.pop();if(S)return S.resolve(),S.promise}function B(x,C){var S=y[x.name],w=S.deferredOperations.pop();if(w)return w.reject(C),w.promise}function W(x,C){return new p(function(S,w){if(y[x.name]=y[x.name]||fe(),x.db)if(C)T(x),x.db.close();else return S(x.db);var D=[x.name];C&&D.push(x.version);var O=c.open.apply(c,D);C&&(O.onupgradeneeded=function($){var H=O.result;try{H.createObjectStore(x.storeName),$.oldVersion<=1&&H.createObjectStore(_)}catch(G){if(G.name==="ConstraintError")console.warn('The database "'+x.name+'" has been upgraded from version '+$.oldVersion+" to version "+$.newVersion+', but the storage "'+x.storeName+'" already exists.');else throw G}}),O.onerror=function($){$.preventDefault(),w(O.error)},O.onsuccess=function(){var $=O.result;$.onversionchange=function(H){H.target.close()},S($),L(x)}})}function z(x){return W(x,!1)}function P(x){return W(x,!0)}function V(x,C){if(!x.db)return!0;var S=!x.db.objectStoreNames.contains(x.storeName),w=x.version<x.db.version,D=x.version>x.db.version;if(w&&(x.version!==C&&console.warn('The database "'+x.name+`" can't be downgraded from version `+x.db.version+" to version "+x.version+"."),x.version=x.db.version),D||S){if(S){var O=x.db.version+1;O>x.version&&(x.version=O)}return!0}return!1}function K(x){return new p(function(C,S){var w=new FileReader;w.onerror=S,w.onloadend=function(D){var O=btoa(D.target.result||"");C({__local_forage_encoded_blob:!0,data:O,type:x.type})},w.readAsBinaryString(x)})}function ce(x){var C=E(atob(x.data));return d([C],{type:x.type})}function M(x){return x&&x.__local_forage_encoded_blob}function X(x){var C=this,S=C._initReady().then(function(){var w=y[C._dbInfo.name];if(w&&w.dbReady)return w.dbReady});return f(S,x,x),S}function ae(x){T(x);for(var C=y[x.name],S=C.forages,w=0;w<S.length;w++){var D=S[w];D._dbInfo.db&&(D._dbInfo.db.close(),D._dbInfo.db=null)}return x.db=null,z(x).then(function(O){return x.db=O,V(x)?P(x):O}).then(function(O){x.db=C.db=O;for(var $=0;$<S.length;$++)S[$]._dbInfo.db=O}).catch(function(O){throw B(x,O),O})}function pe(x,C,S,w){w===void 0&&(w=1);try{var D=x.db.transaction(x.storeName,C);S(null,D)}catch(O){if(w>0&&(!x.db||O.name==="InvalidStateError"||O.name==="NotFoundError"))return p.resolve().then(function(){if(!x.db||O.name==="NotFoundError"&&!x.db.objectStoreNames.contains(x.storeName)&&x.version<=x.db.version)return x.db&&(x.version=x.db.version+1),P(x)}).then(function(){return ae(x).then(function(){pe(x,C,S,w-1)})}).catch(S);S(O)}}function fe(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function Le(x){var C=this,S={db:null};if(x)for(var w in x)S[w]=x[w];var D=y[S.name];D||(D=fe(),y[S.name]=D),D.forages.push(C),C._initReady||(C._initReady=C.ready,C.ready=X);var O=[];function $(){return p.resolve()}for(var H=0;H<D.forages.length;H++){var G=D.forages[H];G!==C&&O.push(G._initReady().catch($))}var re=D.forages.slice(0);return p.all(O).then(function(){return S.db=D.db,z(S)}).then(function(ie){return S.db=ie,V(S,C._defaultConfig.version)?P(S):ie}).then(function(ie){S.db=D.db=ie,C._dbInfo=S;for(var he=0;he<re.length;he++){var Ne=re[he];Ne!==C&&(Ne._dbInfo.db=S.db,Ne._dbInfo.version=S.version)}})}function F(x,C){var S=this;x=v(x);var w=new p(function(D,O){S.ready().then(function(){pe(S._dbInfo,N,function($,H){if($)return O($);try{var G=H.objectStore(S._dbInfo.storeName),re=G.get(x);re.onsuccess=function(){var ie=re.result;ie===void 0&&(ie=null),M(ie)&&(ie=ce(ie)),D(ie)},re.onerror=function(){O(re.error)}}catch(ie){O(ie)}})}).catch(O)});return h(w,C),w}function Z(x,C){var S=this,w=new p(function(D,O){S.ready().then(function(){pe(S._dbInfo,N,function($,H){if($)return O($);try{var G=H.objectStore(S._dbInfo.storeName),re=G.openCursor(),ie=1;re.onsuccess=function(){var he=re.result;if(he){var Ne=he.value;M(Ne)&&(Ne=ce(Ne));var Be=x(Ne,he.key,ie++);Be!==void 0?D(Be):he.continue()}else D()},re.onerror=function(){O(re.error)}}catch(he){O(he)}})}).catch(O)});return h(w,C),w}function Y(x,C,S){var w=this;x=v(x);var D=new p(function(O,$){var H;w.ready().then(function(){return H=w._dbInfo,b.call(C)==="[object Blob]"?I(H.db).then(function(G){return G?C:K(C)}):C}).then(function(G){pe(w._dbInfo,A,function(re,ie){if(re)return $(re);try{var he=ie.objectStore(w._dbInfo.storeName);G===null&&(G=void 0);var Ne=he.put(G,x);ie.oncomplete=function(){G===void 0&&(G=null),O(G)},ie.onabort=ie.onerror=function(){var Be=Ne.error?Ne.error:Ne.transaction.error;$(Be)}}catch(Be){$(Be)}})}).catch($)});return h(D,S),D}function ye(x,C){var S=this;x=v(x);var w=new p(function(D,O){S.ready().then(function(){pe(S._dbInfo,A,function($,H){if($)return O($);try{var G=H.objectStore(S._dbInfo.storeName),re=G.delete(x);H.oncomplete=function(){D()},H.onerror=function(){O(re.error)},H.onabort=function(){var ie=re.error?re.error:re.transaction.error;O(ie)}}catch(ie){O(ie)}})}).catch(O)});return h(w,C),w}function ge(x){var C=this,S=new p(function(w,D){C.ready().then(function(){pe(C._dbInfo,A,function(O,$){if(O)return D(O);try{var H=$.objectStore(C._dbInfo.storeName),G=H.clear();$.oncomplete=function(){w()},$.onabort=$.onerror=function(){var re=G.error?G.error:G.transaction.error;D(re)}}catch(re){D(re)}})}).catch(D)});return h(S,x),S}function Ke(x){var C=this,S=new p(function(w,D){C.ready().then(function(){pe(C._dbInfo,N,function(O,$){if(O)return D(O);try{var H=$.objectStore(C._dbInfo.storeName),G=H.count();G.onsuccess=function(){w(G.result)},G.onerror=function(){D(G.error)}}catch(re){D(re)}})}).catch(D)});return h(S,x),S}function Ae(x,C){var S=this,w=new p(function(D,O){if(x<0){D(null);return}S.ready().then(function(){pe(S._dbInfo,N,function($,H){if($)return O($);try{var G=H.objectStore(S._dbInfo.storeName),re=!1,ie=G.openKeyCursor();ie.onsuccess=function(){var he=ie.result;if(!he){D(null);return}x===0||re?D(he.key):(re=!0,he.advance(x))},ie.onerror=function(){O(ie.error)}}catch(he){O(he)}})}).catch(O)});return h(w,C),w}function Fe(x){var C=this,S=new p(function(w,D){C.ready().then(function(){pe(C._dbInfo,N,function(O,$){if(O)return D(O);try{var H=$.objectStore(C._dbInfo.storeName),G=H.openKeyCursor(),re=[];G.onsuccess=function(){var ie=G.result;if(!ie){w(re);return}re.push(ie.key),ie.continue()},G.onerror=function(){D(G.error)}}catch(ie){D(ie)}})}).catch(D)});return h(S,x),S}function ne(x,C){C=j.apply(this,arguments);var S=this.config();x=typeof x!="function"&&x||{},x.name||(x.name=x.name||S.name,x.storeName=x.storeName||S.storeName);var w=this,D;if(!x.name)D=p.reject("Invalid arguments");else{var O=x.name===S.name&&w._dbInfo.db,$=O?p.resolve(w._dbInfo.db):z(x).then(function(H){var G=y[x.name],re=G.forages;G.db=H;for(var ie=0;ie<re.length;ie++)re[ie]._dbInfo.db=H;return H});x.storeName?D=$.then(function(H){if(H.objectStoreNames.contains(x.storeName)){var G=H.version+1;T(x);var re=y[x.name],ie=re.forages;H.close();for(var he=0;he<ie.length;he++){var Ne=ie[he];Ne._dbInfo.db=null,Ne._dbInfo.version=G}var Be=new p(function($e,at){var et=c.open(x.name,G);et.onerror=function(_t){var _n=et.result;_n.close(),at(_t)},et.onupgradeneeded=function(){var _t=et.result;_t.deleteObjectStore(x.storeName)},et.onsuccess=function(){var _t=et.result;_t.close(),$e(_t)}});return Be.then(function($e){re.db=$e;for(var at=0;at<ie.length;at++){var et=ie[at];et._dbInfo.db=$e,L(et._dbInfo)}}).catch(function($e){throw(B(x,$e)||p.resolve()).catch(function(){}),$e})}}):D=$.then(function(H){T(x);var G=y[x.name],re=G.forages;H.close();for(var ie=0;ie<re.length;ie++){var he=re[ie];he._dbInfo.db=null}var Ne=new p(function(Be,$e){var at=c.deleteDatabase(x.name);at.onerror=function(){var et=at.result;et&&et.close(),$e(at.error)},at.onblocked=function(){console.warn('dropInstance blocked for database "'+x.name+'" until all open connections are closed')},at.onsuccess=function(){var et=at.result;et&&et.close(),Be(et)}});return Ne.then(function(Be){G.db=Be;for(var $e=0;$e<re.length;$e++){var at=re[$e];L(at._dbInfo)}}).catch(function(Be){throw(B(x,Be)||p.resolve()).catch(function(){}),Be})})}return h(D,C),D}var me={_driver:"asyncStorage",_initStorage:Le,_support:u(),iterate:Z,getItem:F,setItem:Y,removeItem:ye,clear:ge,length:Ke,key:Ae,keys:Fe,dropInstance:ne};function se(){return typeof openDatabase=="function"}var be="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",De="~~local_forage_type~",mt=/^~~local_forage_type~([^~]+)~/,Pt="__lfsc__:",we=Pt.length,Ie="arbf",st="blob",ve="si08",Ue="ui08",Se="uic8",it="si16",xe="si32",St="ur16",Jt="ui32",fn="fl32",Ht="fl64",Un=we+Ie.length,Qt=Object.prototype.toString;function En(x){var C=x.length*.75,S=x.length,w,D=0,O,$,H,G;x[x.length-1]==="="&&(C--,x[x.length-2]==="="&&C--);var re=new ArrayBuffer(C),ie=new Uint8Array(re);for(w=0;w<S;w+=4)O=be.indexOf(x[w]),$=be.indexOf(x[w+1]),H=be.indexOf(x[w+2]),G=be.indexOf(x[w+3]),ie[D++]=O<<2|$>>4,ie[D++]=($&15)<<4|H>>2,ie[D++]=(H&3)<<6|G&63;return re}function je(x){var C=new Uint8Array(x),S="",w;for(w=0;w<C.length;w+=3)S+=be[C[w]>>2],S+=be[(C[w]&3)<<4|C[w+1]>>4],S+=be[(C[w+1]&15)<<2|C[w+2]>>6],S+=be[C[w+2]&63];return C.length%3===2?S=S.substring(0,S.length-1)+"=":C.length%3===1&&(S=S.substring(0,S.length-2)+"=="),S}function Ee(x,C){var S="";if(x&&(S=Qt.call(x)),x&&(S==="[object ArrayBuffer]"||x.buffer&&Qt.call(x.buffer)==="[object ArrayBuffer]")){var w,D=Pt;x instanceof ArrayBuffer?(w=x,D+=Ie):(w=x.buffer,S==="[object Int8Array]"?D+=ve:S==="[object Uint8Array]"?D+=Ue:S==="[object Uint8ClampedArray]"?D+=Se:S==="[object Int16Array]"?D+=it:S==="[object Uint16Array]"?D+=St:S==="[object Int32Array]"?D+=xe:S==="[object Uint32Array]"?D+=Jt:S==="[object Float32Array]"?D+=fn:S==="[object Float64Array]"?D+=Ht:C(new Error("Failed to get type for BinaryArray"))),C(D+je(w))}else if(S==="[object Blob]"){var O=new FileReader;O.onload=function(){var $=De+x.type+"~"+je(this.result);C(Pt+st+$)},O.readAsArrayBuffer(x)}else try{C(JSON.stringify(x))}catch($){console.error("Couldn't convert value into a JSON string: ",x),C(null,$)}}function dt(x){if(x.substring(0,we)!==Pt)return JSON.parse(x);var C=x.substring(Un),S=x.substring(we,Un),w;if(S===st&&mt.test(C)){var D=C.match(mt);w=D[1],C=C.substring(D[0].length)}var O=En(C);switch(S){case Ie:return O;case st:return d([O],{type:w});case ve:return new Int8Array(O);case Ue:return new Uint8Array(O);case Se:return new Uint8ClampedArray(O);case it:return new Int16Array(O);case St:return new Uint16Array(O);case xe:return new Int32Array(O);case Jt:return new Uint32Array(O);case fn:return new Float32Array(O);case Ht:return new Float64Array(O);default:throw new Error("Unkown type: "+S)}}var gt={serialize:Ee,deserialize:dt,stringToBuffer:En,bufferToString:je};function kt(x,C,S,w){x.executeSql("CREATE TABLE IF NOT EXISTS "+C.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],S,w)}function Et(x){var C=this,S={db:null};if(x)for(var w in x)S[w]=typeof x[w]!="string"?x[w].toString():x[w];var D=new p(function(O,$){try{S.db=openDatabase(S.name,String(S.version),S.description,S.size)}catch(H){return $(H)}S.db.transaction(function(H){kt(H,S,function(){C._dbInfo=S,O()},function(G,re){$(re)})},$)});return S.serializer=gt,D}function Te(x,C,S,w,D,O){x.executeSql(S,w,D,function($,H){H.code===H.SYNTAX_ERR?$.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[C.storeName],function(G,re){re.rows.length?O(G,H):kt(G,C,function(){G.executeSql(S,w,D,O)},O)},O):O($,H)},O)}function Nt(x,C){var S=this;x=v(x);var w=new p(function(D,O){S.ready().then(function(){var $=S._dbInfo;$.db.transaction(function(H){Te(H,$,"SELECT * FROM "+$.storeName+" WHERE key = ? LIMIT 1",[x],function(G,re){var ie=re.rows.length?re.rows.item(0).value:null;ie&&(ie=$.serializer.deserialize(ie)),D(ie)},function(G,re){O(re)})})}).catch(O)});return h(w,C),w}function tr(x,C){var S=this,w=new p(function(D,O){S.ready().then(function(){var $=S._dbInfo;$.db.transaction(function(H){Te(H,$,"SELECT * FROM "+$.storeName,[],function(G,re){for(var ie=re.rows,he=ie.length,Ne=0;Ne<he;Ne++){var Be=ie.item(Ne),$e=Be.value;if($e&&($e=$.serializer.deserialize($e)),$e=x($e,Be.key,Ne+1),$e!==void 0){D($e);return}}D()},function(G,re){O(re)})})}).catch(O)});return h(w,C),w}function pn(x,C,S,w){var D=this;x=v(x);var O=new p(function($,H){D.ready().then(function(){C===void 0&&(C=null);var G=C,re=D._dbInfo;re.serializer.serialize(C,function(ie,he){he?H(he):re.db.transaction(function(Ne){Te(Ne,re,"INSERT OR REPLACE INTO "+re.storeName+" (key, value) VALUES (?, ?)",[x,ie],function(){$(G)},function(Be,$e){H($e)})},function(Ne){if(Ne.code===Ne.QUOTA_ERR){if(w>0){$(pn.apply(D,[x,G,S,w-1]));return}H(Ne)}})})}).catch(H)});return h(O,S),O}function Cs(x,C,S){return pn.apply(this,[x,C,S,1])}function yt(x,C){var S=this;x=v(x);var w=new p(function(D,O){S.ready().then(function(){var $=S._dbInfo;$.db.transaction(function(H){Te(H,$,"DELETE FROM "+$.storeName+" WHERE key = ?",[x],function(){D()},function(G,re){O(re)})})}).catch(O)});return h(w,C),w}function Bn(x){var C=this,S=new p(function(w,D){C.ready().then(function(){var O=C._dbInfo;O.db.transaction(function($){Te($,O,"DELETE FROM "+O.storeName,[],function(){w()},function(H,G){D(G)})})}).catch(D)});return h(S,x),S}function It(x){var C=this,S=new p(function(w,D){C.ready().then(function(){var O=C._dbInfo;O.db.transaction(function($){Te($,O,"SELECT COUNT(key) as c FROM "+O.storeName,[],function(H,G){var re=G.rows.item(0).c;w(re)},function(H,G){D(G)})})}).catch(D)});return h(S,x),S}function ks(x,C){var S=this,w=new p(function(D,O){S.ready().then(function(){var $=S._dbInfo;$.db.transaction(function(H){Te(H,$,"SELECT key FROM "+$.storeName+" WHERE id = ? LIMIT 1",[x+1],function(G,re){var ie=re.rows.length?re.rows.item(0).key:null;D(ie)},function(G,re){O(re)})})}).catch(O)});return h(w,C),w}function Is(x){var C=this,S=new p(function(w,D){C.ready().then(function(){var O=C._dbInfo;O.db.transaction(function($){Te($,O,"SELECT key FROM "+O.storeName,[],function(H,G){for(var re=[],ie=0;ie<G.rows.length;ie++)re.push(G.rows.item(ie).key);w(re)},function(H,G){D(G)})})}).catch(D)});return h(S,x),S}function La(x){return new p(function(C,S){x.transaction(function(w){w.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(D,O){for(var $=[],H=0;H<O.rows.length;H++)$.push(O.rows.item(H).name);C({db:x,storeNames:$})},function(D,O){S(O)})},function(w){S(w)})})}function Rs(x,C){C=j.apply(this,arguments);var S=this.config();x=typeof x!="function"&&x||{},x.name||(x.name=x.name||S.name,x.storeName=x.storeName||S.storeName);var w=this,D;return x.name?D=new p(function(O){var $;x.name===S.name?$=w._dbInfo.db:$=openDatabase(x.name,"","",0),x.storeName?O({db:$,storeNames:[x.storeName]}):O(La($))}).then(function(O){return new p(function($,H){O.db.transaction(function(G){function re(Be){return new p(function($e,at){G.executeSql("DROP TABLE IF EXISTS "+Be,[],function(){$e()},function(et,_t){at(_t)})})}for(var ie=[],he=0,Ne=O.storeNames.length;he<Ne;he++)ie.push(re(O.storeNames[he]));p.all(ie).then(function(){$()}).catch(function(Be){H(Be)})},function(G){H(G)})})}):D=p.reject("Invalid arguments"),h(D,C),D}var Da={_driver:"webSQLStorage",_initStorage:Et,_support:se(),iterate:tr,getItem:Nt,setItem:Cs,removeItem:yt,clear:Bn,length:It,key:ks,keys:Is,dropInstance:Rs};function Ts(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}function q(x,C){var S=x.name+"/";return x.storeName!==C.storeName&&(S+=x.storeName+"/"),S}function Rt(){var x="_localforage_support_test";try{return localStorage.setItem(x,!0),localStorage.removeItem(x),!1}catch{return!0}}function vi(){return!Rt()||localStorage.length>0}function xi(x){var C=this,S={};if(x)for(var w in x)S[w]=x[w];return S.keyPrefix=q(x,C._defaultConfig),vi()?(C._dbInfo=S,S.serializer=gt,p.resolve()):p.reject()}function ji(x){var C=this,S=C.ready().then(function(){for(var w=C._dbInfo.keyPrefix,D=localStorage.length-1;D>=0;D--){var O=localStorage.key(D);O.indexOf(w)===0&&localStorage.removeItem(O)}});return h(S,x),S}function bi(x,C){var S=this;x=v(x);var w=S.ready().then(function(){var D=S._dbInfo,O=localStorage.getItem(D.keyPrefix+x);return O&&(O=D.serializer.deserialize(O)),O});return h(w,C),w}function wi(x,C){var S=this,w=S.ready().then(function(){for(var D=S._dbInfo,O=D.keyPrefix,$=O.length,H=localStorage.length,G=1,re=0;re<H;re++){var ie=localStorage.key(re);if(ie.indexOf(O)===0){var he=localStorage.getItem(ie);if(he&&(he=D.serializer.deserialize(he)),he=x(he,ie.substring($),G++),he!==void 0)return he}}});return h(w,C),w}function Si(x,C){var S=this,w=S.ready().then(function(){var D=S._dbInfo,O;try{O=localStorage.key(x)}catch{O=null}return O&&(O=O.substring(D.keyPrefix.length)),O});return h(w,C),w}function Ei(x){var C=this,S=C.ready().then(function(){for(var w=C._dbInfo,D=localStorage.length,O=[],$=0;$<D;$++){var H=localStorage.key($);H.indexOf(w.keyPrefix)===0&&O.push(H.substring(w.keyPrefix.length))}return O});return h(S,x),S}function Ni(x){var C=this,S=C.keys().then(function(w){return w.length});return h(S,x),S}function _i(x,C){var S=this;x=v(x);var w=S.ready().then(function(){var D=S._dbInfo;localStorage.removeItem(D.keyPrefix+x)});return h(w,C),w}function Os(x,C,S){var w=this;x=v(x);var D=w.ready().then(function(){C===void 0&&(C=null);var O=C;return new p(function($,H){var G=w._dbInfo;G.serializer.serialize(C,function(re,ie){if(ie)H(ie);else try{localStorage.setItem(G.keyPrefix+x,re),$(O)}catch(he){(he.name==="QuotaExceededError"||he.name==="NS_ERROR_DOM_QUOTA_REACHED")&&H(he),H(he)}})})});return h(D,S),D}function Ps(x,C){if(C=j.apply(this,arguments),x=typeof x!="function"&&x||{},!x.name){var S=this.config();x.name=x.name||S.name,x.storeName=x.storeName||S.storeName}var w=this,D;return x.name?D=new p(function(O){x.storeName?O(q(x,w._defaultConfig)):O(x.name+"/")}).then(function(O){for(var $=localStorage.length-1;$>=0;$--){var H=localStorage.key($);H.indexOf(O)===0&&localStorage.removeItem(H)}}):D=p.reject("Invalid arguments"),h(D,C),D}var Ls={_driver:"localStorageWrapper",_initStorage:xi,_support:Ts(),iterate:wi,getItem:bi,setItem:Os,removeItem:_i,clear:ji,length:Ni,key:Si,keys:Ei,dropInstance:Ps},Ds=function(C,S){return C===S||typeof C=="number"&&typeof S=="number"&&isNaN(C)&&isNaN(S)},Ms=function(C,S){for(var w=C.length,D=0;D<w;){if(Ds(C[D],S))return!0;D++}return!1},qr=Array.isArray||function(x){return Object.prototype.toString.call(x)==="[object Array]"},Vn={},zr={},Nn={INDEXEDDB:me,WEBSQL:Da,LOCALSTORAGE:Ls},Us=[Nn.INDEXEDDB._driver,Nn.WEBSQL._driver,Nn.LOCALSTORAGE._driver],nr=["dropInstance"],wr=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(nr),Bs={description:"",driver:Us.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function Vs(x,C){x[C]=function(){var S=arguments;return x.ready().then(function(){return x[C].apply(x,S)})}}function Sr(){for(var x=1;x<arguments.length;x++){var C=arguments[x];if(C)for(var S in C)C.hasOwnProperty(S)&&(qr(C[S])?arguments[0][S]=C[S].slice():arguments[0][S]=C[S])}return arguments[0]}var k=function(){function x(C){o(this,x);for(var S in Nn)if(Nn.hasOwnProperty(S)){var w=Nn[S],D=w._driver;this[S]=D,Vn[D]||this.defineDriver(w)}this._defaultConfig=Sr({},Bs),this._config=Sr({},this._defaultConfig,C),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return x.prototype.config=function(S){if((typeof S>"u"?"undefined":a(S))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var w in S){if(w==="storeName"&&(S[w]=S[w].replace(/\W/g,"_")),w==="version"&&typeof S[w]!="number")return new Error("Database version must be a number.");this._config[w]=S[w]}return"driver"in S&&S.driver?this.setDriver(this._config.driver):!0}else return typeof S=="string"?this._config[S]:this._config},x.prototype.defineDriver=function(S,w,D){var O=new p(function($,H){try{var G=S._driver,re=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!S._driver){H(re);return}for(var ie=wr.concat("_initStorage"),he=0,Ne=ie.length;he<Ne;he++){var Be=ie[he],$e=!Ms(nr,Be);if(($e||S[Be])&&typeof S[Be]!="function"){H(re);return}}var at=function(){for(var _n=function(Nu){return function(){var mn=new Error("Method "+Nu+" is not implemented by the current driver"),ht=p.reject(mn);return h(ht,arguments[arguments.length-1]),ht}},rr=0,ul=nr.length;rr<ul;rr++){var Ai=nr[rr];S[Ai]||(S[Ai]=_n(Ai))}};at();var et=function(_n){Vn[G]&&console.info("Redefining LocalForage driver: "+G),Vn[G]=S,zr[G]=_n,$()};"_support"in S?S._support&&typeof S._support=="function"?S._support().then(et,H):et(!!S._support):et(!0)}catch(_t){H(_t)}});return f(O,w,D),O},x.prototype.driver=function(){return this._driver||null},x.prototype.getDriver=function(S,w,D){var O=Vn[S]?p.resolve(Vn[S]):p.reject(new Error("Driver not found."));return f(O,w,D),O},x.prototype.getSerializer=function(S){var w=p.resolve(gt);return f(w,S),w},x.prototype.ready=function(S){var w=this,D=w._driverSet.then(function(){return w._ready===null&&(w._ready=w._initDriver()),w._ready});return f(D,S,S),D},x.prototype.setDriver=function(S,w,D){var O=this;qr(S)||(S=[S]);var $=this._getSupportedDrivers(S);function H(){O._config.driver=O.driver()}function G(he){return O._extend(he),H(),O._ready=O._initStorage(O._config),O._ready}function re(he){return function(){var Ne=0;function Be(){for(;Ne<he.length;){var $e=he[Ne];return Ne++,O._dbInfo=null,O._ready=null,O.getDriver($e).then(G).catch(Be)}H();var at=new Error("No available storage method found.");return O._driverSet=p.reject(at),O._driverSet}return Be()}}var ie=this._driverSet!==null?this._driverSet.catch(function(){return p.resolve()}):p.resolve();return this._driverSet=ie.then(function(){var he=$[0];return O._dbInfo=null,O._ready=null,O.getDriver(he).then(function(Ne){O._driver=Ne._driver,H(),O._wrapLibraryMethodsWithReady(),O._initDriver=re($)})}).catch(function(){H();var he=new Error("No available storage method found.");return O._driverSet=p.reject(he),O._driverSet}),f(this._driverSet,w,D),this._driverSet},x.prototype.supports=function(S){return!!zr[S]},x.prototype._extend=function(S){Sr(this,S)},x.prototype._getSupportedDrivers=function(S){for(var w=[],D=0,O=S.length;D<O;D++){var $=S[D];this.supports($)&&w.push($)}return w},x.prototype._wrapLibraryMethodsWithReady=function(){for(var S=0,w=wr.length;S<w;S++)Vs(this,wr[S])},x.prototype.createInstance=function(S){return new x(S)},x}(),U=new k;r.exports=U},{3:3}]},{},[4])(4)})})(H0);var TO=H0.exports;const Fp=df(TO);Fp.config({name:"AfyaLinkCRDT"});async function OO(e){const t=await Fp.getItem("doc:"+e);let n;if(t&&t.bin)try{n=si.load(Uint8Array.from(atob(t.bin),r=>r.charCodeAt(0)))}catch(r){console.error("load local doc fail",r),n=si.init()}else n=si.init();return{doc:n,docId:e}}async function Hp(e,t){const n=si.save(t),r=btoa(String.fromCharCode(...new Uint8Array(n)));return await Fp.setItem("doc:"+e,{bin:r,ts:Date.now()}),!0}async function PO(e,t){const n=si.change(e.doc,t);return await Hp(e.docId,n),e.doc=n,e}async function LO(e,t){const r=si.getAllChanges(e.doc).map(a=>btoa(String.fromCharCode(...new Uint8Array(a))));return!!(await fetch(t+"/api/crdt/"+e.docId+"/changes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({changes:r}),credentials:"include"})).ok}async function DO(e,t){const n=await fetch(t+"/api/crdt/"+e,{credentials:"include"});if(!n.ok)throw new Error("pull failed");const r=await n.json();if(!r.bin)return null;const i=Uint8Array.from(atob(r.bin),o=>o.charCodeAt(0)),a=si.load(i);return await Hp(e,a),a}const Hl={initDoc:OO,changeDoc:PO,saveLocal:Hp,syncToServer:LO,pullFromServer:DO},By="http://localhost:5000";function MO(){const[e,t]=g.useState(null),[n,r]=g.useState("");g.useEffect(()=>{async function o(){const l=await Hl.initDoc("patients_demo");if(t(l),l.doc&&l.doc.patients){const c=Object.keys(l.doc.patients);c.length&&r(l.doc.patients[c[0]].firstName||"")}}o()},[]);async function i(){const o=await Hl.changeDoc(e,l=>{l.patients||(l.patients={});const c="p_"+Date.now();l.patients[c]={firstName:"New",lastName:"",createdAt:Date.now()}});t(o)}async function a(){await Hl.syncToServer(e,By);const o=await Hl.pullFromServer("patients_demo",By);o&&alert("Pulled server doc with patients: "+(o.patients?Object.keys(o.patients).length:0))}return s.jsxs("div",{children:[s.jsx("h2",{children:"CRDT Patient Editor (demo)"}),s.jsx("button",{onClick:i,children:"Add Patient"}),s.jsx("button",{onClick:a,children:"Sync Now"}),s.jsxs("div",{children:["First name sample: ",n]})]})}function UO(){const[e,t]=g.useState([]),[n,r]=g.useState(!1),[i,a]=g.useState("ALL"),[o,l]=g.useState("ALL");return g.useEffect(()=>{r(!0),H_({category:i,read:o==="ALL"?void 0:o==="READ"?"true":"false"}).then(u=>{Array.isArray(u)?t(u):Array.isArray(u==null?void 0:u.items)?t(u.items):t([])}).catch(()=>t([])).finally(()=>r(!1))},[i,o]),s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"Notifications"}),s.jsx("p",{className:"muted",children:"Recent workflow and system updates."})]}),s.jsxs("div",{className:"welcome-actions",children:[s.jsxs("select",{value:i,onChange:c=>a(c.target.value),children:[s.jsx("option",{value:"ALL",children:"All Categories"}),s.jsx("option",{value:"WORKFORCE",children:"Workforce"}),s.jsx("option",{value:"SECURITY",children:"Security"}),s.jsx("option",{value:"BILLING",children:"Billing"}),s.jsx("option",{value:"SYSTEM",children:"System"}),s.jsx("option",{value:"INTEGRATION",children:"Integration"}),s.jsx("option",{value:"AI",children:"AI"})]}),s.jsxs("select",{value:o,onChange:c=>l(c.target.value),children:[s.jsx("option",{value:"ALL",children:"All Status"}),s.jsx("option",{value:"UNREAD",children:"Unread"}),s.jsx("option",{value:"READ",children:"Read"})]}),s.jsx("button",{className:"btn-secondary",onClick:async()=>{await $j(),t(c=>c.map(u=>({...u,read:!0})))},children:"Mark all read"})]})]}),s.jsx("section",{className:"section",children:s.jsxs("div",{className:"card",children:[n&&s.jsx("p",{children:"Loading..."}),!n&&s.jsxs("table",{className:"table lite",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Time"}),s.jsx("th",{children:"Title"}),s.jsx("th",{children:"Category"}),s.jsx("th",{children:"Message"}),s.jsx("th",{children:"Actions"})]})}),s.jsxs("tbody",{children:[e.map(c=>s.jsxs("tr",{children:[s.jsx("td",{children:new Date(c.createdAt).toLocaleString()}),s.jsxs("td",{children:[c.title||"Notification",!c.read&&s.jsx("span",{className:"badge-dot",style:{marginLeft:8},children:"!"})]}),s.jsx("td",{children:c.category||"SYSTEM"}),s.jsx("td",{children:c.body||"-"}),s.jsx("td",{children:s.jsx("button",{className:"btn-secondary",onClick:async()=>{c.read?(await Vj(c._id),t(u=>u.map(d=>d._id===c._id?{...d,read:!1}:d))):(await Bj(c._id),t(u=>u.map(d=>d._id===c._id?{...d,read:!0}:d)))},children:c.read?"Mark unread":"Mark read"})})]},c._id)),e.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:"5",children:"No notifications yet"})})]})]})]})})]})}function BO(){const[e,t]=g.useState({}),[n,r]=g.useState({stripePublishable:"",stripeSecret:"",mpesaConsumerKey:"",mpesaConsumerSecret:"",mpesaShortcode:"",flutterSecret:"",mode:"test",adminPassword:"",otp:""}),[i,a]=g.useState("edit");g.useEffect(()=>{o()},[]);async function o(){const h=await(await Tr("/api/payment-settings/get")).json();t(h)}async function l(){if(!n.adminPassword||n.adminPassword.length<8){alert("Admin password required and must be >=8 chars");return}const p={stripe:{publishable:n.stripePublishable,secret:n.stripeSecret},mpesa:{consumerKey:n.mpesaConsumerKey,consumerSecret:n.mpesaConsumerSecret,shortcode:n.mpesaShortcode},flutterwave:{secret:n.flutterSecret},mode:n.mode,adminPassword:n.adminPassword},f=await(await Tr("/api/payment-settings/save",{method:"POST",body:p})).json();alert(JSON.stringify(f))}async function c(){const h=await(await Tr("/api/payment-settings/reveal/request",{method:"POST"})).json();h.ok&&a("otp_requested"),alert(h.message||JSON.stringify(h))}async function u(){const h=await(await Tr("/api/payment-settings/reveal/verify",{method:"POST",body:{code:n.otp,adminPassword:n.adminPassword}})).json();h.ok?(alert("Secrets revealed: "+JSON.stringify(h.secrets)),a("edit")):alert(JSON.stringify(h))}async function d(){const p=prompt("Enter OLD admin password"),h=prompt("Enter NEW admin password (store it safely)");if(!p||!h)return;const v=await(await Tr("/api/payment-settings/rotate-password",{method:"POST",body:{oldPassword:p,newPassword:h}})).json();alert(JSON.stringify(v))}return s.jsxs("div",{children:[s.jsx("h2",{children:"Payment Settings"}),s.jsxs("div",{children:[s.jsx("label",{children:"Stripe Publishable"}),s.jsx("input",{value:n.stripePublishable,onChange:p=>r(h=>({...h,stripePublishable:p.target.value}))})]}),s.jsxs("div",{children:[s.jsx("label",{children:"Stripe Secret"}),s.jsx("input",{value:n.stripeSecret,onChange:p=>r(h=>({...h,stripeSecret:p.target.value}))})]}),s.jsxs("div",{children:[s.jsx("label",{children:"MPESA Consumer Key"}),s.jsx("input",{value:n.mpesaConsumerKey,onChange:p=>r(h=>({...h,mpesaConsumerKey:p.target.value}))})]}),s.jsxs("div",{children:[s.jsx("label",{children:"MPESA Consumer Secret"}),s.jsx("input",{value:n.mpesaConsumerSecret,onChange:p=>r(h=>({...h,mpesaConsumerSecret:p.target.value}))})]}),s.jsxs("div",{children:[s.jsx("label",{children:"MPESA Shortcode"}),s.jsx("input",{value:n.mpesaShortcode,onChange:p=>r(h=>({...h,mpesaShortcode:p.target.value}))})]}),s.jsxs("div",{children:[s.jsx("label",{children:"Flutter Secret"}),s.jsx("input",{value:n.flutterSecret,onChange:p=>r(h=>({...h,flutterSecret:p.target.value}))})]}),s.jsxs("div",{children:[s.jsx("label",{children:"Admin Password (required to encrypt)"}),s.jsx("input",{type:"password",value:n.adminPassword,onChange:p=>r(h=>({...h,adminPassword:p.target.value}))})]}),s.jsxs("div",{style:{marginTop:12},children:[s.jsx("button",{onClick:l,children:"Save Settings (Encrypted)"})," ",s.jsx("button",{onClick:c,children:"Request 2FA"})," ",s.jsx("button",{onClick:d,children:"Rotate Admin Password"})]}),i==="otp_requested"&&s.jsxs("div",{style:{marginTop:12},children:[s.jsx("label",{children:"Enter OTP"}),s.jsx("input",{value:n.otp,onChange:p=>r(h=>({...h,otp:p.target.value}))}),s.jsx("button",{onClick:u,children:"Verify & Reveal"})]}),s.jsxs("div",{style:{marginTop:12},children:[s.jsx("h4",{children:"Metadata"}),s.jsx("pre",{children:JSON.stringify(e,null,2)})]})]})}function VO({points:e=[]}){const t=(e||[]).map(u=>Number(u)).filter(u=>Number.isFinite(u));if(t.length<2)return null;const n=120,r=28,i=Math.min(...t),o=Math.max(...t)-i||1,l=n/Math.max(1,t.length-1),c=t.map((u,d)=>{const p=d*l,h=r-(u-i)/o*(r-4)-2;return`${p},${h}`}).join(" ");return s.jsx("svg",{width:n,height:r,viewBox:`0 0 ${n} ${r}`,"aria-hidden":"true",children:s.jsx("polyline",{fill:"none",stroke:"var(--app-accent-2, #2563eb)",strokeWidth:"2",points:c})})}const te=({title:e,value:t,subtitle:n,trend:r,status:i="neutral",why:a="",badge:o="",onBadgeClick:l=null})=>s.jsxs("div",{className:`card stat stat-${i}`,children:[s.jsxs("div",{className:"card-title-row",children:[s.jsx("div",{className:"card-title",children:e}),o?typeof l=="function"?s.jsx("button",{type:"button",className:`stat-badge stat-badge-${i}`,onClick:l,children:o}):s.jsx("span",{className:`stat-badge stat-badge-${i}`,children:o}):null]}),s.jsx("div",{className:"card-value",children:t}),a?s.jsxs("div",{className:"card-why",title:a,children:["Why: ",a]}):null,Array.isArray(r)&&r.length>1&&s.jsx("div",{style:{marginTop:6},children:s.jsx(VO,{points:r})}),n&&s.jsx("div",{className:"card-sub",children:n})]}),$O=()=>le("/api/dashboard/doctor"),FO=()=>le("/api/dashboard/nurse"),HO=()=>le("/api/dashboard/hr"),qO=()=>le("/api/dashboard/payroll"),zO=()=>le("/api/dashboard/staff"),WO=()=>le("/api/dashboard/lab-tech"),GO=()=>le("/api/dashboard/security-admin"),YO=()=>le("/api/dashboard/security-officer"),KO=()=>le("/api/dashboard/hospital-admin"),JO=()=>le("/api/dashboard/patient"),QO=()=>le("/api/dashboard/super-admin"),qp=async e=>le("/api/ml/staffing/forecast",{method:"POST",body:e}),zp=async e=>le("/api/ml/burnout/score",{method:"POST",body:e}),q0=async e=>le("/api/ml/causal/impact",{method:"POST",body:e}),z0=async e=>le("/api/ml/digital-twin/simulate",{method:"POST",body:e});function ZO(){const{user:e}=Me(),t=Re(),[n,r]=g.useState(null),[i,a]=g.useState([]),[o,l]=g.useState([]),[c,u]=g.useState(null),[d,p]=g.useState([]),h=_=>{const m=Number(_||0);return m>=75?"risk":m>=45?"warn":"good"},f=_=>_==="risk"?"ALERT":_==="warn"?"WATCH":"OK",v=async()=>{try{const _=await zp({hoursPerWeek:56,nightShifts:7,consecutiveDays:7,overtimeHours:14,leaveBalanceDays:6,incidentsIn30d:1});u(_||null),p(m=>[...m,Number((_==null?void 0:_.score)||0)].slice(-12))}catch{u(null)}};g.useEffect(()=>{$O().then(m=>r(m)).catch(()=>r(null)),le("/api/appointments?limit=8&cursorMode=1").then(m=>a(Array.isArray(m==null?void 0:m.items)?m.items:[])).catch(()=>a([])),le("/api/notifications?limit=8").then(m=>{const y=Array.isArray(m==null?void 0:m.items)?m.items:Array.isArray(m)?m:[];l(y.slice(0,8))}).catch(()=>l([])),v();const _=setInterval(v,45e3);return()=>clearInterval(_)},[]);const j=g.useMemo(()=>[{title:"Todays Appointments",value:(n==null?void 0:n.appointmentsToday)??""},{title:"Inpatients Assigned",value:(n==null?void 0:n.activeEncounters)??""},{title:"Surgeries Scheduled",value:(n==null?void 0:n.upcomingAppointments)??""},{title:"Pending Lab Results",value:(n==null?void 0:n.pendingLabResults)??""},{title:"License Expiry (Days)",value:(n==null?void 0:n.licenseExpiryDays)??""}],[n]);return s.jsxs("div",{className:"dashboard doctor-workspace",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"Doctor Clinical Workspace"}),s.jsxs("p",{className:"muted",children:["Welcome, Dr. ",(e==null?void 0:e.name)||"Clinician",". Zero-click access to todays patients and critical alerts."]})]}),s.jsxs("div",{className:"welcome-actions",children:[s.jsx("button",{className:"btn-primary",onClick:()=>t("/doctor/patients"),children:"Todays Patients"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/doctor/opd"),children:"Start Consultation"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/doctor/schedule"),children:"Open Schedule"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/doctor/leave"),children:"Leave Requests"})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Clinical KPIs"}),s.jsx("div",{className:"grid info-grid",children:j.map(_=>s.jsx(te,{title:_.title,value:_.value},_.title))})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"AI Wellbeing Signal"}),s.jsxs("div",{className:"grid info-grid",children:[s.jsx(te,{title:"Burnout Risk Score",value:(c==null?void 0:c.score)??"",trend:d,subtitle:"Auto-refresh 45s",status:h(c==null?void 0:c.score),badge:f(h(c==null?void 0:c.score)),why:`Score ${(c==null?void 0:c.score)??0}; keep below 45 to remain in low-risk band.`,onBadgeClick:()=>t("/doctor/leave")}),s.jsx(te,{title:"Risk Band",value:(c==null?void 0:c.band)??""}),s.jsx(te,{title:"Recommendations",value:Array.isArray(c==null?void 0:c.recommendations)?c.recommendations.length:""})]}),s.jsx("div",{className:"welcome-actions",children:s.jsx("button",{className:"btn-secondary",onClick:()=>t("/system-admin/clinical-intelligence"),children:"Open Clinical Intelligence"})})]}),s.jsxs("section",{className:"section doctor-main-grid",children:[s.jsxs("div",{className:"card doctor-schedule-card",children:[s.jsx("h3",{children:"Todays Schedule"}),s.jsx("div",{className:"table-wrap",children:s.jsxs("table",{className:"doctor-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Time"}),s.jsx("th",{children:"Type"}),s.jsx("th",{children:"Patient"}),s.jsx("th",{children:"Status"}),s.jsx("th",{children:"Actions"})]})}),s.jsxs("tbody",{children:[i.map(_=>{var m,y;return s.jsxs("tr",{children:[s.jsx("td",{children:_.scheduledAt?new Date(_.scheduledAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"-"}),s.jsx("td",{children:_.type||"OPD"}),s.jsx("td",{children:((m=_.patient)==null?void 0:m.name)||((y=_.patient)==null?void 0:y.firstName)||"-"}),s.jsx("td",{children:_.status||"Scheduled"}),s.jsx("td",{children:s.jsxs("div",{className:"doctor-actions-row",children:[s.jsx("button",{className:"btn-secondary",onClick:()=>t("/doctor/medical-records"),children:"Open Record"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/doctor/opd"),children:"Start Consultation"})]})})]},_._id)}),i.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:"5",className:"muted",children:"No appointments loaded."})})]})]})})]}),s.jsxs("div",{className:"card doctor-alerts-card",children:[s.jsx("h3",{children:"Alerts Panel"}),s.jsxs("div",{className:"alert-stack",children:[o.map(_=>s.jsx("button",{className:"verify-banner",onClick:()=>t("/admin/notifications"),children:s.jsx("span",{children:_.title||"Clinical Alert"})},_._id)),o.length===0&&s.jsx("div",{className:"muted",children:"No active alerts."})]})]})]})]})}function XO(){const{user:e}=Me(),t=Re(),[n,r]=g.useState(null);return g.useEffect(()=>{JO().then(r).catch(()=>r(null))},[]),s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"Patient Self-Service Portal"}),s.jsx("p",{className:"muted",children:"Appointments, records, lab results, billing and insurance in one place."})]}),s.jsxs("div",{className:"welcome-actions",children:[s.jsx("button",{className:"btn-primary",onClick:()=>t("/patient"),children:"My Appointments"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/payments"),children:"Billing"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/profile"),children:"Profile"})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Top Summary"}),s.jsxs("div",{className:"grid info-grid",children:[s.jsx(te,{title:"Upcoming Appointment",value:(n==null?void 0:n.upcomingAppointments)??""}),s.jsx(te,{title:"Outstanding Bill",value:(n==null?void 0:n.unpaidInvoices)??""}),s.jsx(te,{title:"Active Prescription",value:(n==null?void 0:n.prescriptionsActive)??""}),s.jsx(te,{title:"Lab Results",value:(n==null?void 0:n.labResults)??""})]})]}),s.jsxs("section",{className:"section doctor-main-grid",children:[s.jsxs("div",{className:"card doctor-schedule-card",children:[s.jsx("h3",{children:"Health Timeline"}),s.jsxs("div",{className:"panel-grid",children:[s.jsx("button",{className:"action-link",onClick:()=>t("/patient"),children:"Medical Records"}),s.jsx("button",{className:"action-link",onClick:()=>t("/patient"),children:"Prescriptions"}),s.jsx("button",{className:"action-link",onClick:()=>t("/patient"),children:"Lab Results"}),s.jsx("button",{className:"action-link",onClick:()=>t("/patient"),children:"Insurance"})]})]}),s.jsxs("div",{className:"card doctor-alerts-card",children:[s.jsx("h3",{children:"Notifications"}),s.jsxs("div",{className:"alert-stack",children:[s.jsx("button",{className:"btn-secondary",onClick:()=>t("/admin/notifications"),children:"Messages"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/patient"),children:"Feedback"})]})]})]})]})}function eP(){var i,a;const{user:e}=Me(),t=Re(),[n,r]=g.useState(null);return g.useEffect(()=>{FO().then(r).catch(()=>r(null))},[]),s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"Nurse Clinical Operations"}),s.jsx("p",{className:"muted",children:"Shift execution, patient assignment, medication administration and incident logging."})]}),s.jsxs("div",{className:"welcome-actions",children:[s.jsx("button",{className:"btn-primary",onClick:()=>t("/nurse"),children:"My Shift"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/nurse"),children:"Assigned Patients"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/workforce/requests#leave"),children:"Leave Requests"})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Nursing Snapshot"}),s.jsxs("div",{className:"grid info-grid",children:[s.jsx(te,{title:"Shift Info",value:"Active"}),s.jsx(te,{title:"Assigned Patients",value:(n==null?void 0:n.patientsTotal)??""}),s.jsx(te,{title:"Medication Due Alerts",value:(n==null?void 0:n.pendingLabOrders)??""}),s.jsx(te,{title:"Pending Requests",value:((i=n==null?void 0:n.pendingRequests)==null?void 0:i.total)??""})]})]}),s.jsxs("section",{className:"section doctor-main-grid",children:[s.jsxs("div",{className:"card doctor-schedule-card",children:[s.jsx("h3",{children:"Center Workspace"}),s.jsxs("div",{className:"panel-grid",children:[s.jsx("button",{className:"action-link",onClick:()=>t("/nurse"),children:"Patient Task List"}),s.jsx("button",{className:"action-link",onClick:()=>t("/nurse"),children:"Medication Administration"}),s.jsx("button",{className:"action-link",onClick:()=>t("/nurse"),children:"Vitals Entry"}),s.jsx("button",{className:"action-link",onClick:()=>t("/nurse"),children:"Incident Reports"})]})]}),s.jsxs("div",{className:"card doctor-alerts-card",children:[s.jsx("h3",{children:"Right Panel"}),s.jsxs("div",{className:"alert-stack",children:[s.jsxs("div",{className:"action-pill",children:["Critical Alerts: ",(n==null?void 0:n.appointmentsToday)??""]}),s.jsxs("div",{className:"action-pill",children:["Leave Pending: ",((a=n==null?void 0:n.pendingRequests)==null?void 0:a.leave)??""]}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/workforce/requests"),children:"Open My Requests"})]})]})]})]})}function tP(){const{user:e}=Me(),t=Re(),[n,r]=g.useState(null);return g.useEffect(()=>{WO().then(r).catch(()=>r(null))},[]),s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"Lab Technician Diagnostics"}),s.jsx("p",{className:"muted",children:"Test queue, sample tracking, quality control and equipment readiness."})]}),s.jsxs("div",{className:"welcome-actions",children:[s.jsx("button",{className:"btn-primary",onClick:()=>t("/labtech/labs"),children:"Test Queue"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/lab-tech"),children:"Equipment Logs"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/reports"),children:"Reports Archive"})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Lab Metrics"}),s.jsxs("div",{className:"grid info-grid",children:[s.jsx(te,{title:"Pending Tests",value:(n==null?void 0:n.pendingOrders)??""}),s.jsx(te,{title:"Completed Today",value:(n==null?void 0:n.completedToday)??""}),s.jsx(te,{title:"Abnormal Results",value:(n==null?void 0:n.overdueOrders)??""}),s.jsx(te,{title:"Orders Today",value:(n==null?void 0:n.ordersToday)??""})]})]}),s.jsxs("section",{className:"section doctor-main-grid",children:[s.jsxs("div",{className:"card doctor-schedule-card",children:[s.jsx("h3",{children:"Center Workspace"}),s.jsxs("div",{className:"panel-grid",children:[s.jsx("button",{className:"action-link",onClick:()=>t("/labtech/labs"),children:"Test Processing Table"}),s.jsx("button",{className:"action-link",onClick:()=>t("/lab-tech"),children:"Sample Tracking"}),s.jsx("button",{className:"action-link",onClick:()=>t("/lab-tech"),children:"Quality Control"}),s.jsx("button",{className:"action-link",onClick:()=>t("/lab-tech"),children:"Safety Checklist"})]})]}),s.jsxs("div",{className:"card doctor-alerts-card",children:[s.jsx("h3",{children:"Right Insights"}),s.jsxs("div",{className:"alert-stack",children:[s.jsx("div",{className:"action-pill",children:"Equipment Status: Live"}),s.jsxs("div",{className:"action-pill",children:["Urgent Flagged: ",(n==null?void 0:n.overdueOrders)??""]})]})]})]})]})}function nP(){const e=Re(),[t,n]=g.useState([]);g.useEffect(()=>{le("/api/pharmacy?limit=25").then(i=>n(Array.isArray(i==null?void 0:i.items)?i.items:Array.isArray(i)?i:[])).catch(()=>n([]))},[]);const r=t.filter(i=>Number((i==null?void 0:i.qty)||0)<=Number((i==null?void 0:i.minStock)||0)).length;return s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"Pharmacy Control Center"}),s.jsx("p",{className:"muted",children:"Prescription queue, inventory, controlled drugs and expiry monitoring."})]}),s.jsxs("div",{className:"welcome-actions",children:[s.jsx("button",{className:"btn-primary",onClick:()=>e("/pharmacy"),children:"Prescription Queue"}),s.jsx("button",{className:"btn-secondary",onClick:()=>e("/inventory"),children:"Inventory"}),s.jsx("button",{className:"btn-secondary",onClick:()=>e("/reports"),children:"Reports"})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Pharmacy Snapshot"}),s.jsxs("div",{className:"grid info-grid",children:[s.jsx(te,{title:"Pending Prescriptions",value:t.length}),s.jsx(te,{title:"Low Stock Alerts",value:r}),s.jsx(te,{title:"Expiring Drugs",value:"Live"}),s.jsx(te,{title:"Controlled Drugs",value:"Tracked"})]})]}),s.jsxs("section",{className:"section doctor-main-grid",children:[s.jsxs("div",{className:"card doctor-schedule-card",children:[s.jsx("h3",{children:"Dispensing Queue"}),s.jsx("div",{className:"table-wrap",children:s.jsxs("table",{className:"doctor-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Drug"}),s.jsx("th",{children:"Qty"}),s.jsx("th",{children:"Min"}),s.jsx("th",{children:"Status"})]})}),s.jsxs("tbody",{children:[t.slice(0,10).map(i=>s.jsxs("tr",{children:[s.jsx("td",{children:i.name||"-"}),s.jsx("td",{children:i.qty??"-"}),s.jsx("td",{children:i.minStock??"-"}),s.jsx("td",{children:Number(i.qty||0)<=Number(i.minStock||0)?"Low":"OK"})]},i._id)),t.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:"4",className:"muted",children:"No inventory data."})})]})]})})]}),s.jsxs("div",{className:"card doctor-alerts-card",children:[s.jsx("h3",{children:"Interaction Alerts"}),s.jsxs("div",{className:"alert-stack",children:[s.jsx("div",{className:"action-pill",children:"Drug interaction checks active"}),s.jsx("button",{className:"btn-secondary",onClick:()=>e("/reports"),children:"Open Safety Reports"})]})]})]})]})}function rP(){var o,l,c,u;const{user:e}=Me(),t=Re(),[n,r]=g.useState(null),[i,a]=g.useState(null);return g.useEffect(()=>{QO().then(r).catch(()=>r(null)),Fo().then(a).catch(()=>a(null))},[]),s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"Super Admin Control Center"}),s.jsx("p",{className:"muted",children:"Global governance for hospitals, workforce, payroll, security and platform health."})]}),s.jsxs("div",{className:"welcome-actions",children:[s.jsx("button",{className:"btn-primary",onClick:()=>t("/super-admin/hospitals"),children:"Hospitals"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/admin/create-admin"),children:"Role Management"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/payments/full"),children:"Global Payroll"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/super-admin/settings"),children:"System Settings"})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Global Snapshot"}),s.jsxs("div",{className:"grid info-grid",children:[s.jsx(te,{title:"Total Hospitals",value:(n==null?void 0:n.totalHospitals)??""}),s.jsx(te,{title:"Total Staff",value:(n==null?void 0:n.totalUsers)??""}),s.jsx(te,{title:"Active Patients",value:(n==null?void 0:n.totalPatients)??""}),s.jsx(te,{title:"Payroll This Month",value:(n==null?void 0:n.paymentsThisMonth)??""}),s.jsx(te,{title:"Workforce Pending",value:((l=(o=i==null?void 0:i.queues)==null?void 0:o.workforce)==null?void 0:l.totalPending)??""}),s.jsx(te,{title:"Workforce Breached",value:((u=(c=i==null?void 0:i.queues)==null?void 0:c.workforce)==null?void 0:u.breached)??""})]})]}),s.jsxs("section",{className:"section doctor-main-grid",children:[s.jsxs("div",{className:"card doctor-schedule-card",children:[s.jsx("h3",{children:"Global Admin Workspace"}),s.jsxs("div",{className:"panel-grid",children:[s.jsx("button",{className:"action-link",onClick:async()=>{await Hs("REVENUE_OVERVIEW"),t("/payments/full")},children:"Revenue Graph"}),s.jsx("button",{className:"action-link",onClick:()=>t("/analytics"),children:"Workforce Distribution"}),s.jsx("button",{className:"action-link",onClick:()=>t("/reports"),children:"Compliance Alerts"}),s.jsx("button",{className:"action-link",onClick:()=>t("/admin/audit-logs"),children:"Audit Logs"}),s.jsx("button",{className:"action-link",onClick:()=>t("/security-admin"),children:"Security Incidents"}),s.jsx("button",{className:"action-link",onClick:()=>t("/system-admin"),children:"System Status Monitor"})]})]}),s.jsxs("div",{className:"card doctor-alerts-card",children:[s.jsx("h3",{children:"Right Insights Panel"}),s.jsxs("div",{className:"alert-stack",children:[s.jsxs("div",{className:"action-pill",children:["Active Sessions: ",(n==null?void 0:n.activeHospitals)??""]}),s.jsxs("div",{className:"action-pill",children:["Pending Requests: ",(n==null?void 0:n.pendingRequests)??""]}),s.jsxs("div",{className:"action-pill",children:["Invoices: ",(n==null?void 0:n.invoicesThisMonth)??""]}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/admin/notifications"),children:"Open Alerts"})]})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"System Administration"}),s.jsxs("div",{className:"action-list",children:[s.jsx("button",{className:"action-link",onClick:()=>t("/admin/realtime"),children:"Integration Hub"}),s.jsx("button",{className:"action-link",onClick:()=>t("/admin/crdt-patients"),children:"Offline Sync"}),s.jsx("button",{className:"action-link",onClick:()=>t("/admin/audit-logs"),children:"Audit Trails"}),s.jsx("button",{className:"action-link",onClick:()=>t("/reports"),children:"Regulatory Reports"})]})]})]})}const sP=async e=>(await ue.post("/api/hospitals",e)).data,W0=async()=>(await ue.get("/api/super-admin/hospitals")).data,G0=async e=>(await ue.post("/api/super-admin/register-hospital-admin",e)).data,Y0=async e=>(await ue.post("/api/super-admin/register-system-admin",e)).data,K0=async e=>(await ue.post("/api/super-admin/register-developer",e)).data;function iP(){const{user:e}=Me(),[t,n]=g.useState([]),[r,i]=g.useState(""),[a,o]=g.useState(1),l=10,[c,u]=g.useState(!1),[d,p]=g.useState(null),[h,f]=g.useState({name:"",address:"",contact:"",code:""}),[v,j]=g.useState({name:"",email:"",password:"",hospitalId:""}),[_,m]=g.useState({name:"",email:"",password:""}),[y,b]=g.useState({name:"",email:"",password:""}),N=async()=>{try{const V=await W0(),K=Array.isArray(V)?V:V.hospitals||[];n(K)}catch{n([])}};g.useEffect(()=>{N()},[]);const A=(e==null?void 0:e.role)==="SUPER_ADMIN",E=(e==null?void 0:e.role)==="SYSTEM_ADMIN";if(!A&&!E)return s.jsx("p",{children:" Access denied"});const R=async V=>{var K,ce;V.preventDefault(),u(!0),p(null);try{await sP(h),p(" Hospital created"),f({name:"",address:"",contact:"",code:""}),await N()}catch(M){p(((ce=(K=M.response)==null?void 0:K.data)==null?void 0:ce.msg)||"Failed to create hospital")}finally{u(!1)}},I=async V=>{var K,ce;V.preventDefault(),u(!0),p(null);try{await G0(v),p(" Hospital admin created"),j({name:"",email:"",password:"",hospitalId:""}),await N()}catch(M){p(((ce=(K=M.response)==null?void 0:K.data)==null?void 0:ce.msg)||"Failed to create hospital admin")}finally{u(!1)}},T=async V=>{var K,ce;V.preventDefault(),u(!0),p(null);try{await Y0(_),p(" System admin created"),m({name:"",email:"",password:""})}catch(M){p(((ce=(K=M.response)==null?void 0:K.data)==null?void 0:ce.msg)||"Failed to create system admin")}finally{u(!1)}},L=async V=>{var K,ce;V.preventDefault(),u(!0),p(null);try{await K0(y),p(" Developer created"),b({name:"",email:"",password:""})}catch(M){p(((ce=(K=M.response)==null?void 0:K.data)==null?void 0:ce.msg)||"Failed to create developer")}finally{u(!1)}},B=t.filter(V=>{var ce,M;const K=r.trim().toLowerCase();return K?((ce=V.name)==null?void 0:ce.toLowerCase().includes(K))||((M=V.code)==null?void 0:M.toLowerCase().includes(K)):!0}),W=Math.max(1,Math.ceil(B.length/l)),z=Math.min(a,W),P=B.slice((z-1)*l,z*l);return s.jsxs("div",{className:"dashboard",children:[s.jsx("div",{className:"welcome-panel",children:s.jsxs("div",{children:[s.jsx("h2",{children:"Hospitals & Admins"}),s.jsx("p",{className:"muted",children:"Create hospitals, assign hospital admins, and delegate system admins to scale onboarding."})]})}),d&&s.jsx("div",{className:"card",children:d}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Create Hospital"}),s.jsxs("form",{className:"card form",onSubmit:R,children:[s.jsx("input",{placeholder:"Hospital name",value:h.name,onChange:V=>f({...h,name:V.target.value}),required:!0}),s.jsx("input",{placeholder:"Address",value:h.address,onChange:V=>f({...h,address:V.target.value})}),s.jsx("input",{placeholder:"Contact",value:h.contact,onChange:V=>f({...h,contact:V.target.value})}),s.jsx("input",{placeholder:"Optional code",value:h.code,onChange:V=>f({...h,code:V.target.value})}),s.jsx("button",{disabled:c,children:c?"Creating...":"Create Hospital"})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Register Hospital Admin"}),s.jsxs("form",{className:"card form",onSubmit:I,children:[s.jsx("input",{placeholder:"Full name",value:v.name,onChange:V=>j({...v,name:V.target.value}),required:!0}),s.jsx("input",{placeholder:"Email address",type:"email",value:v.email,onChange:V=>j({...v,email:V.target.value}),required:!0}),s.jsx("input",{placeholder:"Temporary password",type:"password",value:v.password,onChange:V=>j({...v,password:V.target.value}),required:!0}),s.jsxs("select",{value:v.hospitalId,onChange:V=>j({...v,hospitalId:V.target.value}),required:!0,children:[s.jsx("option",{value:"",children:"Select hospital"}),t.map(V=>s.jsx("option",{value:V._id,children:V.name},V._id))]}),s.jsx("button",{disabled:c,children:c?"Creating...":"Create Hospital Admin"})]})]}),A&&s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Register System Admin"}),s.jsxs("form",{className:"card form",onSubmit:T,children:[s.jsx("input",{placeholder:"Full name",value:_.name,onChange:V=>m({..._,name:V.target.value}),required:!0}),s.jsx("input",{placeholder:"Email address",type:"email",value:_.email,onChange:V=>m({..._,email:V.target.value}),required:!0}),s.jsx("input",{placeholder:"Temporary password",type:"password",value:_.password,onChange:V=>m({..._,password:V.target.value}),required:!0}),s.jsx("button",{disabled:c,children:c?"Creating...":"Create System Admin"})]})]}),A&&s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Register Developer"}),s.jsxs("form",{className:"card form",onSubmit:L,children:[s.jsx("input",{placeholder:"Full name",value:y.name,onChange:V=>b({...y,name:V.target.value}),required:!0}),s.jsx("input",{placeholder:"Email address",type:"email",value:y.email,onChange:V=>b({...y,email:V.target.value}),required:!0}),s.jsx("input",{placeholder:"Temporary password",type:"password",value:y.password,onChange:V=>b({...y,password:V.target.value}),required:!0}),s.jsx("button",{disabled:c,children:c?"Creating...":"Create Developer"})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Hospitals"}),s.jsxs("div",{className:"card",children:[s.jsx("div",{className:"search-wrap",style:{marginBottom:12},children:s.jsx("input",{className:"search-input",placeholder:"Search hospitals",value:r,onChange:V=>{i(V.target.value),o(1)}})}),s.jsxs("table",{className:"table lite",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Name"}),s.jsx("th",{children:"Code"}),s.jsx("th",{children:"Admins"}),s.jsx("th",{children:"Status"})]})}),s.jsxs("tbody",{children:[P.map(V=>s.jsxs("tr",{children:[s.jsx("td",{children:V.name}),s.jsx("td",{children:V.code||"-"}),s.jsx("td",{children:(V.admins||[]).map(K=>`${K.name} (${K.email})`).join(", ")||"None"}),s.jsx("td",{children:V.active===!1?"Inactive":"Active"})]},V._id)),P.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:"4",children:"No hospitals yet"})})]})]}),s.jsxs("div",{className:"action-list",style:{marginTop:12},children:[s.jsx("button",{className:"btn-secondary",onClick:()=>o(V=>Math.max(1,V-1)),disabled:z===1,children:"Prev"}),s.jsxs("span",{className:"muted",children:["Page ",z," of ",W]}),s.jsx("button",{className:"btn-secondary",onClick:()=>o(V=>Math.min(W,V+1)),disabled:z===W,children:"Next"})]})]})]})]})}const aP=async()=>(await ue.get("/api/system-settings")).data,oP=async e=>(await ue.put("/api/system-settings",e)).data;function Vy(e){return new Promise((t,n)=>{const r=new FileReader;r.onload=()=>t(r.result),r.onerror=n,r.readAsDataURL(e)})}function lP(){const{user:e}=Me(),{settings:t,setSettings:n}=mi(),[r,i]=g.useState({branding:{appIcon:"",favicon:"",logo:"",loginBackground:"",homeBackground:"",sidebarIcons:{}},ai:{enabled:!1,name:"NeuroEdge",url:"",greeting:"Hi, how can I help?"}}),[a,o]=g.useState(!1),[l,c]=g.useState(null);if(!["SUPER_ADMIN","DEVELOPER"].includes(e==null?void 0:e.role))return s.jsx("p",{children:" Access denied"});g.useEffect(()=>{aP().then(f=>{const v={branding:{...r.branding,...f.branding||{}},ai:{...r.ai,...f.ai||{}}};i(v)}).catch(()=>{})},[]);const u=async()=>{var f,v;o(!0),c(null);try{const j=await oP(r);c(" Settings saved"),j.settings&&n(j.settings)}catch(j){c(((v=(f=j.response)==null?void 0:f.data)==null?void 0:v.message)||"Failed to save settings")}finally{o(!1)}},d=async(f,v)=>{if(!v)return;const j=await Vy(v);i(_=>({..._,branding:{..._.branding,[f]:j}}))},p=async(f,v)=>{if(!v)return;const j=await Vy(v);i(_=>({..._,branding:{..._.branding,sidebarIcons:{..._.branding.sidebarIcons||{},[f]:j}}}))},h=[{key:"home",label:"Home"},{key:"admin",label:"Admin"},{key:"hr",label:"HR"},{key:"payroll",label:"Payroll"},{key:"doctor",label:"Doctor"},{key:"nurse",label:"Nurse"},{key:"lab",label:"Lab"},{key:"pharmacy",label:"Pharmacy"},{key:"staff",label:"Staff"},{key:"security",label:"Security"},{key:"settings",label:"Settings"},{key:"analytics",label:"Analytics"},{key:"reports",label:"Reports"},{key:"notifications",label:"Notifications"},{key:"requests",label:"Requests"},{key:"inventory",label:"Inventory"},{key:"ai",label:"AI"},{key:"appointments",label:"Appointments"}];return s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"System Settings"}),s.jsx("p",{className:"muted",children:"Branding, payments, and AI configuration."})]}),s.jsx("div",{className:"welcome-actions",children:s.jsx("button",{className:"btn-primary",onClick:u,disabled:a,children:a?"Saving...":"Save Settings"})})]}),l&&s.jsx("div",{className:"card",children:l}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Branding Assets"}),s.jsxs("div",{className:"card form",children:[s.jsx("label",{children:"Main App Icon"}),s.jsx("input",{type:"file",accept:"image/*",onChange:f=>{var v;return d("appIcon",(v=f.target.files)==null?void 0:v[0])}}),s.jsx("label",{children:"Favicon (.ico or png)"}),s.jsx("input",{type:"file",accept:"image/*",onChange:f=>{var v;return d("favicon",(v=f.target.files)==null?void 0:v[0])}}),s.jsx("label",{children:"Logo (Navbar/Sidebar)"}),s.jsx("input",{type:"file",accept:"image/*",onChange:f=>{var v;return d("logo",(v=f.target.files)==null?void 0:v[0])}}),s.jsx("label",{children:"Login Background Image"}),s.jsx("input",{type:"file",accept:"image/*",onChange:f=>{var v;return d("loginBackground",(v=f.target.files)==null?void 0:v[0])}}),s.jsx("label",{children:"Home Background Image"}),s.jsx("input",{type:"file",accept:"image/*",onChange:f=>{var v;return d("homeBackground",(v=f.target.files)==null?void 0:v[0])}})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Sidebar Icons"}),s.jsx("div",{className:"card form",children:h.map(f=>{var v;return s.jsxs("div",{className:"icon-upload-row",children:[s.jsxs("label",{children:[f.label," Icon"]}),s.jsx("input",{type:"file",accept:"image/*",onChange:j=>{var _;return p(f.key,(_=j.target.files)==null?void 0:_[0])}}),((v=r.branding.sidebarIcons)==null?void 0:v[f.key])&&s.jsx("img",{src:r.branding.sidebarIcons[f.key],alt:`${f.label} icon`,className:"icon-preview"})]},f.key)})})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Payments"}),s.jsxs("div",{className:"card",children:[s.jsx("p",{className:"muted",children:"Use the Payment Settings page to set Stripe, Mpesa, Flutterwave, and card settings."}),s.jsx("a",{className:"action-link",href:"/admin/payment-settings",children:"Open Payment Settings"})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"NeuroEdge AI"}),s.jsxs("div",{className:"card form",children:[s.jsxs("label",{children:[s.jsx("input",{type:"checkbox",checked:r.ai.enabled,onChange:f=>i(v=>({...v,ai:{...v.ai,enabled:f.target.checked}}))}),"Enable Floating AI"]}),s.jsx("label",{children:"AI Name"}),s.jsx("input",{value:r.ai.name,onChange:f=>i(v=>({...v,ai:{...v.ai,name:f.target.value}}))}),s.jsx("label",{children:"AI URL"}),s.jsx("input",{placeholder:"https://neuroedge.ai/chat",value:r.ai.url,onChange:f=>i(v=>({...v,ai:{...v.ai,url:f.target.value}}))}),s.jsx("label",{children:"Greeting"}),s.jsx("input",{value:r.ai.greeting,onChange:f=>i(v=>({...v,ai:{...v.ai,greeting:f.target.value}}))})]})]})]})}function cP(){var h,f,v,j,_,m,y,b,N,A;const{user:e}=Me(),t=Re(),[n,r]=g.useState(null),[i,a]=g.useState(null),[o,l]=g.useState({requiredDoctors:[],requiredNurses:[],doctorGap:[],nurseGap:[]}),c=(E,R)=>{l(I=>({...I,[E]:[...I[E]||[],Number(R||0)].slice(-12)}))},u=E=>{const R=Number(E||0);return R<=0?"good":R<=3?"warn":"risk"},d=E=>E==="risk"?"ALERT":E==="warn"?"WATCH":"OK",p=async()=>{var E,R,I,T;try{const L=await qp({beds:180,occupancyRate:.76,avgPatientsPerDoctor:12,avgPatientsPerNurse:5,horizonDays:7});a(L||null),c("requiredDoctors",((E=L==null?void 0:L.forecast)==null?void 0:E.requiredDoctors)||0),c("requiredNurses",((R=L==null?void 0:L.forecast)==null?void 0:R.requiredNurses)||0),c("doctorGap",((I=L==null?void 0:L.forecast)==null?void 0:I.doctorGap)||0),c("nurseGap",((T=L==null?void 0:L.forecast)==null?void 0:T.nurseGap)||0)}catch{a(null)}};return g.useEffect(()=>{KO().then(r).catch(()=>r(null)),p();const E=setInterval(p,45e3);return()=>clearInterval(E)},[]),s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"Hospital Admin Operations"}),s.jsx("p",{className:"muted",children:"Branch-level staffing, approvals, bed flow, attendance and alerts."})]}),s.jsxs("div",{className:"welcome-actions",children:[s.jsx("button",{className:"btn-primary",onClick:()=>t("/hospital-admin/staff"),children:"Staff Directory"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/hospital-admin/approvals"),children:"Leave Approvals"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/hospital-admin/register-staff"),children:"Recruitment Requests"})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Top Metrics"}),s.jsxs("div",{className:"grid info-grid",children:[s.jsx(te,{title:"Staff Count",value:(n==null?void 0:n.totalStaff)??""}),s.jsx(te,{title:"Bed Occupancy",value:(n==null?void 0:n.patientsTotal)??""}),s.jsx(te,{title:"Shift Coverage %",value:(n==null?void 0:n.openShifts)??""}),s.jsx(te,{title:"Department Alerts",value:(n==null?void 0:n.pendingRequests)??""})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"AI Staffing Risk"}),s.jsxs("div",{className:"grid info-grid",children:[s.jsx(te,{title:"Required Doctors",value:((h=i==null?void 0:i.forecast)==null?void 0:h.requiredDoctors)??"",trend:o.requiredDoctors,subtitle:"Auto-refresh 45s"}),s.jsx(te,{title:"Required Nurses",value:((f=i==null?void 0:i.forecast)==null?void 0:f.requiredNurses)??"",trend:o.requiredNurses,subtitle:"Auto-refresh 45s"}),s.jsx(te,{title:"Doctor Gap",value:((v=i==null?void 0:i.forecast)==null?void 0:v.doctorGap)??"",trend:o.doctorGap,subtitle:"Auto-refresh 45s",status:u((j=i==null?void 0:i.forecast)==null?void 0:j.doctorGap),badge:d(u((_=i==null?void 0:i.forecast)==null?void 0:_.doctorGap)),why:`Gap ${((m=i==null?void 0:i.forecast)==null?void 0:m.doctorGap)??0}; >3 requires urgent staffing intervention.`,onBadgeClick:()=>t("/hospital-admin/register-staff?role=doctor")}),s.jsx(te,{title:"Nurse Gap",value:((y=i==null?void 0:i.forecast)==null?void 0:y.nurseGap)??"",trend:o.nurseGap,subtitle:"Auto-refresh 45s",status:u((b=i==null?void 0:i.forecast)==null?void 0:b.nurseGap),badge:d(u((N=i==null?void 0:i.forecast)==null?void 0:N.nurseGap)),why:`Gap ${((A=i==null?void 0:i.forecast)==null?void 0:A.nurseGap)??0}; >3 requires urgent staffing intervention.`,onBadgeClick:()=>t("/hospital-admin/register-staff?role=nurse")})]})]}),s.jsxs("section",{className:"section doctor-main-grid",children:[s.jsxs("div",{className:"card doctor-schedule-card",children:[s.jsx("h3",{children:"Center Workspace"}),s.jsxs("div",{className:"panel-grid",children:[s.jsx("button",{className:"action-link",onClick:()=>t("/workforce/requests#shift"),children:"Shift Calendar"}),s.jsx("button",{className:"action-link",onClick:()=>t("/reports"),children:"Attendance Heatmap"}),s.jsx("button",{className:"action-link",onClick:()=>t("/hospital-admin/staff"),children:"Staff Directory"}),s.jsx("button",{className:"action-link",onClick:()=>t("/reports"),children:"Budget Overview"})]})]}),s.jsxs("div",{className:"card doctor-alerts-card",children:[s.jsx("h3",{children:"Right Panel"}),s.jsxs("div",{className:"alert-stack",children:[s.jsxs("div",{className:"action-pill",children:["Pending Approvals: ",(n==null?void 0:n.pendingRequests)??""]}),s.jsxs("div",{className:"action-pill",children:["Critical Alerts: ",(n==null?void 0:n.appointmentsToday)??""]}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/admin/notifications"),children:"Announcements"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/security-admin"),children:"Incident Reports"})]})]})]})]})}function uP(){const{user:e}=Me(),t=hn(),[n,r]=g.useState({name:"",email:"",password:"",role:"doctor"}),[i,a]=g.useState(!1),[o,l]=g.useState(null);if(xa.useEffect(()=>{const u=new URLSearchParams(t.search),d=String(u.get("role")||"").toLowerCase();new Set(["doctor","nurse","lab_tech","pharmacist","radiologist","therapist","receptionist","security_officer","hr_manager","payroll_officer"]).has(d)&&r(h=>({...h,role:d}))},[t.search]),(e==null?void 0:e.role)!=="HOSPITAL_ADMIN")return s.jsx("p",{children:" Access denied"});const c=async u=>{var d,p,h;u.preventDefault(),a(!0),l(null);try{const f=await ue.post("/api/hospital-admin/register-staff",n);l(((d=f.data)==null?void 0:d.msg)||" Staff registered"),r({name:"",email:"",password:"",role:"doctor"})}catch(f){l(((h=(p=f.response)==null?void 0:p.data)==null?void 0:h.msg)||"Failed to register staff")}finally{a(!1)}};return s.jsxs("div",{className:"dashboard",children:[s.jsx("div",{className:"welcome-panel",children:s.jsxs("div",{children:[s.jsx("h2",{children:"Register Hospital Staff"}),s.jsx("p",{className:"muted",children:"Add staff members to your hospital workforce."})]})}),o&&s.jsx("div",{className:"card",children:o}),s.jsxs("form",{className:"card form",onSubmit:c,children:[s.jsx("input",{placeholder:"Full name",value:n.name,required:!0,onChange:u=>r({...n,name:u.target.value})}),s.jsx("input",{placeholder:"Email address",type:"email",value:n.email,required:!0,onChange:u=>r({...n,email:u.target.value})}),s.jsx("input",{placeholder:"Temporary password",type:"password",value:n.password,required:!0,onChange:u=>r({...n,password:u.target.value})}),s.jsxs("select",{value:n.role,onChange:u=>r({...n,role:u.target.value}),children:[s.jsx("option",{value:"doctor",children:"Doctor"}),s.jsx("option",{value:"nurse",children:"Nurse"}),s.jsx("option",{value:"lab_tech",children:"Lab Tech"}),s.jsx("option",{value:"pharmacist",children:"Pharmacist"}),s.jsx("option",{value:"radiologist",children:"Radiologist"}),s.jsx("option",{value:"therapist",children:"Therapist"}),s.jsx("option",{value:"receptionist",children:"Receptionist"}),s.jsx("option",{value:"security_officer",children:"Security Officer"}),s.jsx("option",{value:"hr_manager",children:"HR Manager"}),s.jsx("option",{value:"payroll_officer",children:"Payroll Officer"})]}),s.jsx("button",{disabled:i,children:i?"Creating...":"Register Staff"})]})]})}const Wp=(e,t={})=>{const n=new URLSearchParams;e&&n.set("status",e),t.limit&&n.set("limit",String(t.limit)),t.cursor!==void 0&&t.cursor!==null&&n.set("cursor",t.cursor),t.cursorMode&&n.set("cursorMode","1");const r=n.toString();return r?`?${r}`:""},dP=(e,t)=>ue.get(`/api/workforce/leave/my${Wp(e,t)}`),hP=e=>ue.post("/api/workforce/leave",e),fP=e=>ue.post(`/api/workforce/leave/${e}/approve`),pP=(e,t)=>ue.post(`/api/workforce/leave/${e}/reject`,{reason:t}),mP=(e,t)=>ue.get(`/api/workforce/overtime/my${Wp(e,t)}`),gP=e=>ue.post("/api/workforce/overtime",e),yP=e=>ue.post(`/api/workforce/overtime/${e}/approve`),vP=(e,t)=>ue.post(`/api/workforce/overtime/${e}/reject`,{reason:t}),Oi=(e,t,n={})=>{const r=new URLSearchParams;r.set("kind",String(e||"").toUpperCase()),r.set("status",t),n.limit&&r.set("limit",String(n.limit)),n.cursor!==void 0&&n.cursor!==null&&r.set("cursor",n.cursor),n.cursorMode&&r.set("cursorMode","1");const i=r.toString();return ue.get(`/api/workforce/pending${i?`?${i}`:""}`)},xP=(e,t)=>ue.get(`/api/workforce/shifts/my${Wp(e,t)}`),jP=e=>ue.post("/api/workforce/shifts",e),bP=e=>ue.post(`/api/workforce/shifts/${e}/approve`),wP=(e,t)=>ue.post(`/api/workforce/shifts/${e}/reject`,{reason:t}),SP=()=>ue.get("/api/workforce/sla/policies"),EP=(e,t)=>ue.put(`/api/workforce/sla/policies/${e}`,t),NP=()=>ue.get("/api/workforce/queue-insights"),_P=()=>ue.get("/api/workforce/automation/policies"),AP=(e={})=>{const t=new URLSearchParams;e.includeInactive&&t.set("includeInactive","1");const n=t.toString();return ue.get(`/api/workforce/automation/presets${n?`?${n}`:""}`)},CP=e=>ue.post("/api/workforce/automation/presets/apply-all",{presetKey:e}),kP=e=>ue.post("/api/workforce/automation/presets",e),IP=e=>ue.delete(`/api/workforce/automation/presets/${encodeURIComponent(String(e||"").toUpperCase())}`),RP=e=>ue.post(`/api/workforce/automation/presets/${encodeURIComponent(String(e||"").toUpperCase())}/reactivate`),TP=(e={})=>{const t=new URLSearchParams;e.limit&&t.set("limit",String(e.limit));const n=t.toString();return ue.get(`/api/workforce/automation/presets/history${n?`?${n}`:""}`)},OP=(e,t)=>ue.put(`/api/workforce/automation/policies/${e}`,t),PP=e=>ue.post("/api/workforce/automation/simulate",e),LP=(e={})=>{const t=new URLSearchParams;e.requestType&&t.set("requestType",String(e.requestType).toUpperCase()),e.limit&&t.set("limit",String(e.limit));const n=t.toString();return ue.get(`/api/workforce/automation/preview${n?`?${n}`:""}`)},DP=()=>ue.post("/api/workforce/automation/sweep"),MP=new Set(["HOSPITAL_ADMIN","SUPER_ADMIN","SYSTEM_ADMIN","DEVELOPER","HR_MANAGER","PAYROLL_OFFICER"]),UP=new Set(["SUPER_ADMIN","SYSTEM_ADMIN","DEVELOPER"]),Ad="approvals_triage_prefs",Ka="approvals_query_cache_v1",BP=15*60*1e3;function _r(e){return e!=null&&e.slaDueAt?e.status==="PENDING"&&new Date(e.slaDueAt).getTime()<Date.now():!1}function VP(){var Os,Ps,Ls,Ds,Ms,qr,Vn,zr,Nn,Us,nr,wr,Bs,Vs,Sr;const{user:e}=Me(),t=hn(),[n,r]=g.useState([]),[i,a]=g.useState([]),[o,l]=g.useState([]),[c,u]=g.useState(null),[d,p]=g.useState(null),[h,f]=g.useState(null),[v,j]=g.useState(!1),[_,m]=g.useState(!1),[y,b]=g.useState(!1),[N,A]=g.useState(!1),[E,R]=g.useState(""),[I,T]=g.useState(null),[L,B]=g.useState([]),[W,z]=g.useState({}),[P,V]=g.useState([]),[K,ce]=g.useState([]),[M,X]=g.useState(!1),[ae,pe]=g.useState([]),[fe,Le]=g.useState({key:"",name:"",description:"",config:{active:!0,autoApprove:!1,requireSecondApprover:!0,fallbackRole:"AUTO",escalationAfterMinutes:120,conditions:{priorityAgeMultiplier:1,priorityWeightCap:5}}}),[F,Z]=g.useState({}),[Y,ye]=g.useState(!1),[ge,Ke]=g.useState(!1),[Ae,Fe]=g.useState(!1),[ne,me]=g.useState(null),[se,be]=g.useState(null),[De,mt]=g.useState(!1),[Pt,we]=g.useState(null),[Ie,st]=g.useState("ALL"),[ve,Ue]=g.useState("ALL"),[Se,it]=g.useState(0),[xe,St]=g.useState(!0),[Jt,fn]=g.useState(!1),[Ht,Un]=g.useState(""),[Qt,En]=g.useState(""),je=g.useRef(null),[Ee,dt]=g.useState(!1),[gt,kt]=g.useState("Live  now"),Et=g.useRef(!1),Te=e==null?void 0:e.role;if(!MP.has(Te))return s.jsx("p",{children:"Access denied"});const Nt=`${Te||"UNKNOWN"}:${(e==null?void 0:e._id)||(e==null?void 0:e.id)||(e==null?void 0:e.email)||"anon"}`,tr=UP.has(Te),pn=k=>Array.isArray(k)?{items:k,nextCursor:null,hasMore:!1}:{items:Array.isArray(k==null?void 0:k.items)?k.items:[],nextCursor:(k==null?void 0:k.nextCursor)||null,hasMore:!!(k!=null&&k.hasMore)},Cs=(k,U)=>{var C;const x=(C=K.find(S=>String((S==null?void 0:S.key)||"").toUpperCase()===String(U||"").toUpperCase()))==null?void 0:C.config;x&&Z(S=>{var O,$;const w=S[k]||{},D=w.conditions||{};return{...S,[k]:{...w,active:!0,autoApprove:x.autoApprove,requireSecondApprover:x.requireSecondApprover,fallbackRole:x.fallbackRole,escalationAfterMinutes:x.escalationAfterMinutes,conditions:{...D,priorityAgeMultiplier:Number(((O=x.conditions)==null?void 0:O.priorityAgeMultiplier)??1),priorityWeightCap:Number((($=x.conditions)==null?void 0:$.priorityWeightCap)??5)}}}})},yt=async({append:k=!1}={})=>{var U,x,C,S,w,D;k?A(!0):ye(!0),we(null);try{const O=ve==="ALL"?["LEAVE","OVERTIME","SHIFT"]:[ve],$=O.includes("LEAVE")&&(!k||v&&!!c),H=O.includes("OVERTIME")&&(!k||_&&!!d),G=O.includes("SHIFT")&&(!k||y&&!!h),[re,ie,he,Ne,Be,$e,at,et]=await Promise.all([$?Oi("LEAVE","PENDING",{cursorMode:!0,limit:25,cursor:k?c:void 0}):Promise.resolve(null),H?Oi("OVERTIME","PENDING",{cursorMode:!0,limit:25,cursor:k?d:void 0}):Promise.resolve(null),G?Oi("SHIFT","PENDING",{cursorMode:!0,limit:25,cursor:k?h:void 0}):Promise.resolve(null),k?Promise.resolve({data:I}):NP(),k?Promise.resolve({data:{items:L}}):SP(),k?Promise.resolve({data:{items:P}}):_P(),k?Promise.resolve({data:{items:K}}):AP({includeInactive:M}),k?Promise.resolve({data:{items:ae}}):TP({limit:50})]),_t=$?pn(re.data):{items:[],nextCursor:null,hasMore:!1},_n=H?pn(ie.data):{items:[],nextCursor:null,hasMore:!1},rr=G?pn(he.data):{items:[],nextCursor:null,hasMore:!1};k?($?(r(mn=>[...mn,..._t.items]),u(_t.nextCursor),j(_t.hasMore)):j(!1),H?(a(mn=>[...mn,..._n.items]),p(_n.nextCursor),m(_n.hasMore)):m(!1),G?(l(mn=>[...mn,...rr.items]),f(rr.nextCursor),b(rr.hasMore)):b(!1)):(r(_t.items),a(_n.items),l(rr.items),u(_t.nextCursor),p(_n.nextCursor),f(rr.nextCursor),j(_t.hasMore),m(_n.hasMore),b(rr.hasMore)),T(Ne.data||null);const ul=Array.isArray((U=Be.data)==null?void 0:U.items)?Be.data.items:[];k||(kt("Live  now"),B(ul),z(ul.reduce((mn,ht)=>(mn[ht.requestType]={targetMinutes:ht.targetMinutes,escalationMinutes:ht.escalationMinutes,active:ht.active!==!1},mn),{})));const Ai=Array.isArray((x=$e.data)==null?void 0:x.items)?$e.data.items:[],Gp=Array.isArray((C=at.data)==null?void 0:C.items)?at.data.items:[],Nu=Array.isArray((S=et.data)==null?void 0:S.items)?et.data.items:[];k||(V(Ai),ce(Gp),pe(Nu),Z(Ai.reduce((mn,ht)=>{var Yp,Kp,Jp,Qp,Zp,Xp;return mn[ht.requestType]={active:ht.active!==!1,autoApprove:ht.autoApprove===!0,requireSecondApprover:ht.requireSecondApprover===!0,fallbackRole:ht.fallbackRole||"HOSPITAL_ADMIN",escalationAfterMinutes:Number(ht.escalationAfterMinutes||120),conditions:{maxLeaveDays:Number(((Yp=ht.conditions)==null?void 0:Yp.maxLeaveDays)||0),maxOvertimeHours:Number(((Kp=ht.conditions)==null?void 0:Kp.maxOvertimeHours)||0),priorityAgeMultiplier:Number(((Jp=ht.conditions)==null?void 0:Jp.priorityAgeMultiplier)??1),priorityWeightCap:Number(((Qp=ht.conditions)==null?void 0:Qp.priorityWeightCap)??5),allowedShiftTypes:Array.isArray((Zp=ht.conditions)==null?void 0:Zp.allowedShiftTypes)?ht.conditions.allowedShiftTypes.join(","):"",fallbackCandidates:Array.isArray((Xp=ht.conditions)==null?void 0:Xp.fallbackCandidates)?ht.conditions.fallbackCandidates.join(","):""}},mn},{})))}catch(O){we(((D=(w=O==null?void 0:O.response)==null?void 0:w.data)==null?void 0:D.message)||"Failed to load approvals")}finally{k?A(!1):ye(!1)}};g.useEffect(()=>{try{const k=localStorage.getItem(Ka);if(!k){kt("Live  now"),dt(!0);return}const U=JSON.parse(k),x=U==null?void 0:U[Nt];if(!x||typeof x!="object"){kt("Live  now"),dt(!0);return}const C=Date.now()-new Date(x.updatedAt||0).getTime();if(!Number.isFinite(C)||C<0||C>BP){kt("Live  now"),dt(!0);return}const S=Math.max(0,Math.floor(C/6e4));x.queueKindFilter&&Ue(x.queueKindFilter),Array.isArray(x.leave)&&r(x.leave),Array.isArray(x.overtime)&&a(x.overtime),Array.isArray(x.shifts)&&l(x.shifts),(typeof x.leaveCursor=="string"||x.leaveCursor===null)&&u(x.leaveCursor),(typeof x.overtimeCursor=="string"||x.overtimeCursor===null)&&p(x.overtimeCursor),(typeof x.shiftCursor=="string"||x.shiftCursor===null)&&f(x.shiftCursor),typeof x.hasMoreLeave=="boolean"&&j(x.hasMoreLeave),typeof x.hasMoreOvertime=="boolean"&&m(x.hasMoreOvertime),typeof x.hasMoreShift=="boolean"&&b(x.hasMoreShift),x.queue&&typeof x.queue=="object"&&T(x.queue),kt(`Cached  ${S}m ago`),Et.current=!0}catch{}finally{dt(!0)}},[Nt]),g.useEffect(()=>{if(Ee){if(Et.current){Et.current=!1;return}yt({append:!1})}},[Ee,ve,M]),g.useEffect(()=>{const k=new URLSearchParams(t.search),U=String(k.get("view")||"").toLowerCase();k.has("view")&&st(U==="breached"?"BREACHED":"ALL");const C=String(k.get("kind")||"").toUpperCase();["LEAVE","OVERTIME","SHIFT"].includes(C)?Ue(C):k.has("kind")&&Ue("ALL");const S=window.location.hash;if(!S)return;const w=document.getElementById(S.replace("#",""));w&&setTimeout(()=>w.scrollIntoView({behavior:"smooth"}),120)},[t.search]),g.useEffect(()=>{try{const k=localStorage.getItem(Ad);if(!k)return;const U=JSON.parse(k),x=U==null?void 0:U[Nt];if(!x||typeof x!="object")return;(x.viewMode==="ALL"||x.viewMode==="BREACHED")&&st(x.viewMode),typeof x.autoAdvance=="boolean"&&St(x.autoAdvance),typeof x.filter=="string"&&En(x.filter)}catch{}},[Nt]),g.useEffect(()=>{try{const k=localStorage.getItem(Ad),U=k?JSON.parse(k):{};U[Nt]={viewMode:Ie,autoAdvance:xe,filter:Qt,updatedAt:new Date().toISOString()},localStorage.setItem(Ad,JSON.stringify(U))}catch{}},[Nt,Ie,xe,Qt]),g.useEffect(()=>{if(Ee)try{const k=localStorage.getItem(Ka),U=k?JSON.parse(k):{};U[Nt]={queueKindFilter:ve,leave:n,overtime:i,shifts:o,leaveCursor:c,overtimeCursor:d,shiftCursor:h,hasMoreLeave:v,hasMoreOvertime:_,hasMoreShift:y,queue:I,updatedAt:new Date().toISOString()},localStorage.setItem(Ka,JSON.stringify(U))}catch{}},[Ee,Nt,ve,n,i,o,c,d,h,v,_,y,I]);const Bn=g.useMemo(()=>[...n.map(k=>({...k,kind:"LEAVE"})),...i.map(k=>({...k,kind:"OVERTIME"})),...o.map(k=>({...k,kind:"SHIFT"}))].filter(k=>Ie==="BREACHED"?_r(k):!0).filter(k=>ve==="ALL"?!0:k.kind===ve).filter(k=>{var O,$;const U=Qt.trim().toLowerCase();if(!U)return!0;const x=String(((O=k.requester)==null?void 0:O.name)||"").toLowerCase(),C=String((($=k.requester)==null?void 0:$.role)||"").toLowerCase(),S=String(k.kind||"").toLowerCase(),w=String(k.type||k.shiftType||"").toLowerCase(),D=String(k.reason||"").toLowerCase();return x.includes(U)||C.includes(U)||S.includes(U)||w.includes(U)||D.includes(U)}).sort((k,U)=>{const x=_r(k)?1:0,C=_r(U)?1:0;if(x!==C)return C-x;const S=k.slaDueAt?new Date(k.slaDueAt).getTime():Number.MAX_SAFE_INTEGER,w=U.slaDueAt?new Date(U.slaDueAt).getTime():Number.MAX_SAFE_INTEGER;return S!==w?S-w:new Date(U.createdAt).getTime()-new Date(k.createdAt).getTime()}),[n,i,o,Ie,ve,Qt]),It=g.useMemo(()=>Bn.filter(k=>_r(k)),[Bn]),ks=g.useMemo(()=>{const k={LEAVE:0,OVERTIME:0,SHIFT:0};for(const U of Bn)Object.prototype.hasOwnProperty.call(k,U.kind)&&(k[U.kind]+=1);return k},[Bn]),Is=async k=>{var U,x;try{if(R(k),k==="LEAVE"){if(!v||!c)return;const C=await Oi("LEAVE","PENDING",{cursorMode:!0,limit:25,cursor:c}),S=pn(C.data);r(w=>[...w,...S.items]),u(S.nextCursor),j(S.hasMore)}if(k==="OVERTIME"){if(!_||!d)return;const C=await Oi("OVERTIME","PENDING",{cursorMode:!0,limit:25,cursor:d}),S=pn(C.data);a(w=>[...w,...S.items]),p(S.nextCursor),m(S.hasMore)}if(k==="SHIFT"){if(!y||!h)return;const C=await Oi("SHIFT","PENDING",{cursorMode:!0,limit:25,cursor:h}),S=pn(C.data);l(w=>[...w,...S.items]),f(S.nextCursor),b(S.hasMore)}}catch(C){we(((x=(U=C==null?void 0:C.response)==null?void 0:U.data)==null?void 0:x.message)||`Failed to load more ${k} requests`)}finally{R("")}},La=async()=>{try{const k=localStorage.getItem(Ka),U=k?JSON.parse(k):{};delete U[Nt],localStorage.setItem(Ka,JSON.stringify(U))}catch{}Ue("ALL"),st("ALL"),En(""),r([]),a([]),l([]),u(null),p(null),f(null),j(!1),m(!1),b(!1),await yt({append:!1}),kt("Live  now"),we("View reset and reloaded from server")},Rs=()=>{if(!It.length)return;const k=Se%It.length,U=It[k],x=`${U.kind}-${U._id}`;Un(x);const C=`breach-row-${x}`,S=document.getElementById(C);S&&S.scrollIntoView({behavior:"smooth",block:"center"}),it(w=>(w+1)%It.length)};g.useEffect(()=>{Jt&&(fn(!1),setTimeout(()=>{Rs()},120))},[Jt,Bn]),g.useEffect(()=>{if(!Ht)return;It.some(U=>`${U.kind}-${U._id}`===Ht)||Un("")},[Ht,It]);const Da=()=>{if(!It.length)return null;if(Ht){const k=It.find(U=>`${U.kind}-${U._id}`===Ht);if(k)return k}return It[0]},Ts=async(k,U,x=!1)=>{var C,S;try{k==="LEAVE"&&await fP(U),k==="OVERTIME"&&await yP(U),k==="SHIFT"&&await bP(U),await yt({append:!1}),xe&&x&&fn(!0),we(`${k} request approved`)}catch(w){we(((S=(C=w==null?void 0:w.response)==null?void 0:C.data)==null?void 0:S.message)||`Failed to approve ${k} request`)}},q=async(k,U,x=!1)=>{var S,w;const C=prompt("Rejection reason")||"Rejected";try{k==="LEAVE"&&await pP(U,C),k==="OVERTIME"&&await vP(U,C),k==="SHIFT"&&await wP(U,C),await yt({append:!1}),xe&&x&&fn(!0),we(`${k} request rejected`)}catch(D){we(((w=(S=D==null?void 0:D.response)==null?void 0:S.data)==null?void 0:w.message)||`Failed to reject ${k} request`)}},Rt=async k=>{var x,C;const U=W[k];if(U){Ke(!0);try{await EP(k,{targetMinutes:Number(U.targetMinutes),escalationMinutes:Number(U.escalationMinutes),active:!!U.active}),await yt({append:!1}),we(`${k} SLA policy updated`)}catch(S){we(((C=(x=S==null?void 0:S.response)==null?void 0:x.data)==null?void 0:C.message)||`Failed to update ${k} policy`)}finally{Ke(!1)}}},vi=async k=>{var x,C,S,w,D,O,$,H;const U=F[k];if(U){Fe(!0);try{await OP(k,{active:!!U.active,autoApprove:!!U.autoApprove,requireSecondApprover:!!U.requireSecondApprover,fallbackRole:String(U.fallbackRole||"").toUpperCase(),escalationAfterMinutes:Number(U.escalationAfterMinutes||120),conditions:{maxLeaveDays:Number(((x=U.conditions)==null?void 0:x.maxLeaveDays)||0),maxOvertimeHours:Number(((C=U.conditions)==null?void 0:C.maxOvertimeHours)||0),priorityAgeMultiplier:Number(((S=U.conditions)==null?void 0:S.priorityAgeMultiplier)??1),priorityWeightCap:Number(((w=U.conditions)==null?void 0:w.priorityWeightCap)??5),allowedShiftTypes:String(((D=U.conditions)==null?void 0:D.allowedShiftTypes)||"").split(",").map(G=>G.trim().toUpperCase()).filter(Boolean),fallbackCandidates:String(((O=U.conditions)==null?void 0:O.fallbackCandidates)||"").split(",").map(G=>G.trim().toUpperCase()).filter(Boolean)}}),await yt(),we(`${k} automation policy updated`)}catch(G){we(((H=($=G==null?void 0:G.response)==null?void 0:$.data)==null?void 0:H.message)||`Failed to update ${k} automation`)}finally{Fe(!1)}}},xi=async()=>{var k,U,x,C;try{const S=await DP(),w=((U=(k=S==null?void 0:S.data)==null?void 0:k.escalated)==null?void 0:U.total)??0;we(`Automation sweep completed. Escalated: ${w}`),await yt()}catch(S){we(((C=(x=S==null?void 0:S.response)==null?void 0:x.data)==null?void 0:C.message)||"Automation sweep failed")}},ji=async k=>{var U,x;if(k){Fe(!0);try{await CP(k),await yt({append:!1}),we(`Applied ${k} preset to all request types`)}catch(C){we(((x=(U=C==null?void 0:C.response)==null?void 0:U.data)==null?void 0:x.message)||"Failed to apply preset to all")}finally{Fe(!1)}}},bi=async()=>{var k,U;Fe(!0);try{await kP(fe),await yt({append:!1}),we(`Custom preset ${fe.key||fe.name} saved`)}catch(x){we(((U=(k=x==null?void 0:x.response)==null?void 0:k.data)==null?void 0:U.message)||"Failed to save custom preset")}finally{Fe(!1)}},wi=k=>{var x,C;if(!k)return;const U=k.config||{};Le({key:String(k.key||"").toUpperCase(),name:k.name||"",description:k.description||"",config:{active:U.active!==!1,autoApprove:U.autoApprove===!0,requireSecondApprover:U.requireSecondApprover!==!1,fallbackRole:U.fallbackRole||"AUTO",escalationAfterMinutes:Number(U.escalationAfterMinutes||120),conditions:{priorityAgeMultiplier:Number(((x=U.conditions)==null?void 0:x.priorityAgeMultiplier)??1),priorityWeightCap:Number(((C=U.conditions)==null?void 0:C.priorityWeightCap)??5)}}})},Si=async k=>{var U,x;if(k){Fe(!0);try{await IP(k),await yt({append:!1}),we(`Custom preset ${k} deactivated`)}catch(C){we(((x=(U=C==null?void 0:C.response)==null?void 0:U.data)==null?void 0:x.message)||"Failed to deactivate custom preset")}finally{Fe(!1)}}},Ei=async k=>{var U,x;if(k){Fe(!0);try{await RP(k),await yt({append:!1}),we(`Custom preset ${k} reactivated`)}catch(C){we(((x=(U=C==null?void 0:C.response)==null?void 0:U.data)==null?void 0:x.message)||"Failed to reactivate custom preset")}finally{Fe(!1)}}},Ni=async()=>{var k,U;mt(!0);try{const x=await LP({limit:100});be((x==null?void 0:x.data)||null),we("Escalation preview generated")}catch(x){we(((U=(k=x==null?void 0:x.response)==null?void 0:k.data)==null?void 0:U.message)||"Escalation preview failed")}finally{mt(!1)}},_i=async k=>{var C,S,w,D,O;const U=F[k];if(!U)return;const x=k==="LEAVE"?{startDate:new Date().toISOString(),endDate:new Date().toISOString()}:k==="OVERTIME"?{hours:Number(((C=U.conditions)==null?void 0:C.maxOvertimeHours)||1)}:{shiftType:((w=String(((S=U.conditions)==null?void 0:S.allowedShiftTypes)||"DAY").split(",")[0])==null?void 0:w.trim())||"DAY"};try{const $=await PP({requestType:k,sample:x});me({requestType:k,...$.data}),we(`${k} simulation ran`)}catch($){we(((O=(D=$==null?void 0:$.response)==null?void 0:D.data)==null?void 0:O.message)||"Simulation failed")}};return g.useEffect(()=>{const k=x=>{if(!x)return!1;const C=String(x.tagName||"").toLowerCase();return C==="input"||C==="textarea"||C==="select"||x.isContentEditable},U=async x=>{var w;if(k(x.target))return;const C=String(x.key||"").toLowerCase();if(!["j","a","r","u","f"].includes(C))return;if(x.preventDefault(),C==="f"){(w=je.current)==null||w.focus();return}if(C==="u"){st(D=>D==="BREACHED"?"ALL":"BREACHED");return}if(C==="j"){Rs();return}const S=Da();if(S){if(C==="a"){await Ts(S.kind,S._id,!0);return}C==="r"&&await q(S.kind,S._id,!0)}};return window.addEventListener("keydown",U),()=>window.removeEventListener("keydown",U)},[It,Ht,xe,Se]),s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"Workforce Approvals"}),s.jsx("p",{className:"muted",children:"Leave, overtime and shift approvals with SLA monitoring."})]}),s.jsxs("div",{className:"welcome-actions",children:[s.jsx("span",{className:"triage-shortcuts",children:"Shortcuts: J next  A approve  R reject  U breached only  F filter"}),s.jsx("input",{ref:je,className:"triage-filter-input",placeholder:"Filter staff, role, type, reason...",value:Qt,onChange:k=>En(k.target.value)}),s.jsxs("button",{className:`btn-secondary ${xe?"active":""}`,onClick:()=>St(k=>!k),title:"When enabled, approving/rejecting a breached item moves focus to the next breached item.",children:["Auto-Advance: ",xe?"On":"Off"]}),s.jsxs("button",{className:"btn-secondary",onClick:Rs,disabled:!It.length,title:It.length?"Jump to next overdue request":"No breached rows",children:["Jump to Next Breached ",It.length?`(${It.length})`:""]}),s.jsx("button",{className:"btn-secondary",onClick:()=>st(k=>k==="BREACHED"?"ALL":"BREACHED"),children:Ie==="BREACHED"?"Show All":"Show Breached Only"}),s.jsxs("select",{value:ve,onChange:k=>Ue(k.target.value),title:"Filter pending table by request type",children:[s.jsx("option",{value:"ALL",children:"All Queues"}),s.jsx("option",{value:"LEAVE",children:"Leave"}),s.jsx("option",{value:"OVERTIME",children:"Overtime"}),s.jsx("option",{value:"SHIFT",children:"Shift"})]}),s.jsx("button",{className:"btn-secondary",onClick:()=>yt({append:!1}),disabled:Y,children:"Refresh"}),s.jsx("button",{className:"btn-secondary",onClick:La,disabled:Y,children:"Reset View"}),s.jsx("span",{className:"muted",children:gt})]})]}),Pt&&s.jsx("div",{className:"card",children:Pt}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Queue Insights"}),s.jsxs("div",{className:"grid info-grid",children:[s.jsxs("div",{className:"card stat",children:[s.jsx("div",{className:"card-title",children:"Pending"}),s.jsx("div",{className:"card-value",children:((Os=I==null?void 0:I.totals)==null?void 0:Os.pending)??""})]}),s.jsxs("div",{className:"card stat",children:[s.jsx("div",{className:"card-title",children:"Breached"}),s.jsx("div",{className:"card-value",children:((Ps=I==null?void 0:I.totals)==null?void 0:Ps.breached)??""})]}),s.jsxs("div",{className:"card stat",children:[s.jsx("div",{className:"card-title",children:"L2 Pending"}),s.jsx("div",{className:"card-value",children:((Ls=I==null?void 0:I.totals)==null?void 0:Ls.l2Pending)??""})]}),s.jsxs("div",{className:"card stat",children:[s.jsx("div",{className:"card-title",children:"Approved"}),s.jsx("div",{className:"card-value",children:((Ds=I==null?void 0:I.totals)==null?void 0:Ds.approved)??""})]}),s.jsxs("div",{className:"card stat",children:[s.jsx("div",{className:"card-title",children:"Rejected"}),s.jsx("div",{className:"card-value",children:((Ms=I==null?void 0:I.totals)==null?void 0:Ms.rejected)??""})]})]})]}),s.jsxs("section",{className:"section",id:"sla",children:[s.jsx("h3",{children:"SLA Policies"}),s.jsx("div",{className:"card",children:s.jsxs("table",{className:"table lite",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Request Type"}),s.jsx("th",{children:"Target (mins)"}),s.jsx("th",{children:"Escalation (mins)"}),s.jsx("th",{children:"Active"}),s.jsx("th",{children:"Action"})]})}),s.jsxs("tbody",{children:[L.map(k=>{const U=W[k.requestType]||{};return s.jsxs("tr",{children:[s.jsx("td",{children:k.requestType}),s.jsx("td",{children:s.jsx("input",{type:"number",min:"1",value:U.targetMinutes??"",onChange:x=>z(C=>({...C,[k.requestType]:{...C[k.requestType],targetMinutes:x.target.value}}))})}),s.jsx("td",{children:s.jsx("input",{type:"number",min:"1",value:U.escalationMinutes??"",onChange:x=>z(C=>({...C,[k.requestType]:{...C[k.requestType],escalationMinutes:x.target.value}}))})}),s.jsx("td",{children:s.jsx("input",{type:"checkbox",checked:!!U.active,onChange:x=>z(C=>({...C,[k.requestType]:{...C[k.requestType],active:x.target.checked}}))})}),s.jsx("td",{children:s.jsx("button",{className:"btn-secondary",disabled:ge,onClick:()=>Rt(k.requestType),children:"Save"})})]},k.requestType)}),L.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:"5",children:"No SLA policies loaded"})})]})]})})]}),s.jsxs("section",{className:"section",id:"automation",children:[s.jsx("h3",{children:"Automation Policies"}),s.jsxs("div",{className:"card",children:[s.jsxs("div",{className:"welcome-actions",style:{marginBottom:10},children:[s.jsx("button",{className:"btn-secondary",onClick:xi,children:"Run Escalation Sweep"}),s.jsx("button",{className:"btn-secondary",onClick:Ni,disabled:De,children:De?"Previewing...":"Preview Escalation Plan"}),K.map(k=>s.jsxs("button",{className:"btn-secondary",disabled:Ae,title:`${k.description||""}${k.version?` | v${k.version}`:""}`,onClick:()=>ji(k.key),children:["Apply ",k.name||k.key," to all"]},`preset-all-${k.key}`)),s.jsx("button",{className:"btn-secondary",onClick:()=>X(k=>!k),children:M?"Hide Inactive Presets":"Show Inactive Presets"})]}),s.jsxs("div",{className:"card",style:{marginBottom:10},children:[s.jsx("strong",{children:"Preset Catalog"}),s.jsx("div",{className:"table-wrap",style:{marginTop:10},children:s.jsxs("table",{className:"table lite",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Key"}),s.jsx("th",{children:"Name"}),s.jsx("th",{children:"Source"}),s.jsx("th",{children:"Version"}),s.jsx("th",{children:"Actions"})]})}),s.jsxs("tbody",{children:[K.map(k=>{const U=k.source==="CUSTOM";return s.jsxs("tr",{children:[s.jsx("td",{children:k.key}),s.jsx("td",{children:k.name||"-"}),s.jsx("td",{children:k.source||"SYSTEM"}),s.jsx("td",{children:k.version||1}),s.jsxs("td",{children:[s.jsx("button",{className:"btn-secondary",onClick:()=>wi(k),children:"Clone to Form"}),U&&k.active!==!1&&tr&&s.jsx("button",{className:"btn-danger",disabled:Ae,onClick:()=>Si(k.key),children:"Deactivate"}),U&&k.active===!1&&tr&&s.jsx("button",{className:"btn-secondary",disabled:Ae,onClick:()=>Ei(k.key),children:"Reactivate"})]})]},`preset-row-${k.key}`)}),K.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:"5",children:"No presets available"})})]})]})})]}),s.jsxs("div",{className:"card",style:{marginBottom:10},children:[s.jsx("strong",{children:"Create/Update Custom Preset"}),s.jsxs("div",{className:"grid info-grid",style:{marginTop:10},children:[s.jsxs("label",{children:["Key",s.jsx("input",{type:"text",placeholder:"e.g. NIGHT_SHIFT_RUSH",value:fe.key,onChange:k=>Le(U=>({...U,key:k.target.value.toUpperCase().replace(/[^A-Z0-9_]/g,"")}))})]}),s.jsxs("label",{children:["Name",s.jsx("input",{type:"text",placeholder:"Human readable name",value:fe.name,onChange:k=>Le(U=>({...U,name:k.target.value}))})]}),s.jsxs("label",{children:["Description",s.jsx("input",{type:"text",placeholder:"When to use this preset",value:fe.description,onChange:k=>Le(U=>({...U,description:k.target.value}))})]}),s.jsxs("label",{children:["Escalate After (min)",s.jsx("input",{type:"number",min:"5",max:"10080",value:fe.config.escalationAfterMinutes,onChange:k=>Le(U=>({...U,config:{...U.config,escalationAfterMinutes:k.target.value}}))})]}),s.jsxs("label",{children:["Fallback Role",s.jsxs("select",{value:fe.config.fallbackRole,onChange:k=>Le(U=>({...U,config:{...U.config,fallbackRole:k.target.value}})),children:[s.jsx("option",{value:"AUTO",children:"AUTO"}),s.jsx("option",{value:"HOSPITAL_ADMIN",children:"HOSPITAL_ADMIN"}),s.jsx("option",{value:"HR_MANAGER",children:"HR_MANAGER"}),s.jsx("option",{value:"PAYROLL_OFFICER",children:"PAYROLL_OFFICER"}),s.jsx("option",{value:"SYSTEM_ADMIN",children:"SYSTEM_ADMIN"}),s.jsx("option",{value:"SUPER_ADMIN",children:"SUPER_ADMIN"})]})]}),s.jsxs("label",{children:["Priority Age Multiplier",s.jsx("input",{type:"number",min:"0.1",max:"10",step:"0.1",value:fe.config.conditions.priorityAgeMultiplier,onChange:k=>Le(U=>({...U,config:{...U.config,conditions:{...U.config.conditions,priorityAgeMultiplier:k.target.value}}}))})]}),s.jsxs("label",{children:["Priority Weight Cap",s.jsx("input",{type:"number",min:"1",max:"20",step:"0.1",value:fe.config.conditions.priorityWeightCap,onChange:k=>Le(U=>({...U,config:{...U.config,conditions:{...U.config.conditions,priorityWeightCap:k.target.value}}}))})]}),s.jsxs("label",{children:[s.jsx("input",{type:"checkbox",checked:!!fe.config.autoApprove,onChange:k=>Le(U=>({...U,config:{...U.config,autoApprove:k.target.checked}}))}),"Auto-Approve"]}),s.jsxs("label",{children:[s.jsx("input",{type:"checkbox",checked:!!fe.config.requireSecondApprover,onChange:k=>Le(U=>({...U,config:{...U.config,requireSecondApprover:k.target.checked}}))}),"Require 2nd Approver"]})]}),s.jsxs("div",{className:"welcome-actions",style:{marginTop:10},children:[s.jsx("button",{className:"btn-secondary",disabled:Ae,onClick:bi,children:"Save Custom Preset"}),s.jsx("button",{className:"btn-secondary",onClick:()=>Le({key:"",name:"",description:"",config:{active:!0,autoApprove:!1,requireSecondApprover:!0,fallbackRole:"AUTO",escalationAfterMinutes:120,conditions:{priorityAgeMultiplier:1,priorityWeightCap:5}}}),children:"Reset Form"})]})]}),s.jsxs("div",{className:"card",style:{marginBottom:10},children:[s.jsx("strong",{children:"Preset Usage History"}),s.jsx("div",{className:"table-wrap",style:{marginTop:10},children:s.jsxs("table",{className:"table lite",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Time"}),s.jsx("th",{children:"Action"}),s.jsx("th",{children:"Preset"}),s.jsx("th",{children:"Actor"}),s.jsx("th",{children:"Role"})]})}),s.jsxs("tbody",{children:[ae.map(k=>{var U,x,C;return s.jsxs("tr",{children:[s.jsx("td",{children:k.createdAt?new Date(k.createdAt).toLocaleString():"-"}),s.jsx("td",{children:k.action}),s.jsx("td",{children:k.presetKey||"-"}),s.jsx("td",{children:((U=k.actor)==null?void 0:U.name)||((x=k.actor)==null?void 0:x.email)||"-"}),s.jsx("td",{children:((C=k.actor)==null?void 0:C.role)||"-"})]},`preset-history-${k.id}`)}),ae.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:"5",children:"No preset usage history yet"})})]})]})})]}),se&&s.jsxs("div",{className:"card",style:{marginBottom:10},children:[s.jsxs("strong",{children:["Escalation Preview  Candidates: ",((qr=se==null?void 0:se.totals)==null?void 0:qr.totalCandidates)??0]}),s.jsxs("div",{className:"muted",style:{marginTop:6},children:["Generated:"," ",se!=null&&se.generatedAt?new Date(se.generatedAt).toLocaleString():"-"]}),s.jsx("div",{className:"grid info-grid",style:{marginTop:10},children:((se==null?void 0:se.previews)||[]).map(k=>s.jsxs("div",{className:"card stat",children:[s.jsx("div",{className:"card-title",children:k.requestType}),s.jsx("div",{className:"card-value",children:k.totalCandidates||0}),s.jsx("div",{className:"muted",children:k.eligible?`Fallback: ${k.fallbackRole||"-"} (${k.fallbackMode||"FIXED"})`:`Ineligible: ${k.reason||"N/A"}`}),k.eligible&&s.jsxs("div",{className:"muted",children:["Weighted demand: ",k.weightedCandidates??0]}),k.eligible&&k.priorityTuning&&s.jsxs("div",{className:"muted",children:["Tuning: age x",k.priorityTuning.priorityAgeMultiplier??1,", cap"," ",k.priorityTuning.priorityWeightCap??5]}),Array.isArray(k.roleForecast)&&k.roleForecast.length>0&&s.jsx("div",{className:"muted",style:{marginTop:8},children:k.roleForecast.map(U=>s.jsxs("div",{children:[U.role,": now ",U.currentPendingAssignments," (+age ",U.currentAvgPendingAgeMinutes,"m)"," "," / +",U.projectedAssignments," (w ",U.projectedWeightedAssignments,") "," ",U.projectedAvgPendingPerUser,"/user, pressure ",U.projectedPriorityPressure]},`${k.requestType}-${U.role}`))})]},`preview-${k.requestType}`))})]}),s.jsxs("table",{className:"table lite",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Request Type"}),s.jsx("th",{children:"Policy Active"}),s.jsx("th",{children:"Auto-Approve"}),s.jsx("th",{children:"2nd Approver"}),s.jsx("th",{children:"Fallback Role"}),s.jsx("th",{children:"Escalate After (min)"}),s.jsx("th",{children:"Max Leave Days"}),s.jsx("th",{children:"Max Overtime Hours"}),s.jsx("th",{children:"Priority Age Multiplier"}),s.jsx("th",{children:"Priority Weight Cap"}),s.jsx("th",{children:"Allowed Shift Types (comma)"}),s.jsx("th",{children:"Fallback Candidates (comma roles)"}),s.jsx("th",{children:"Action"})]})}),s.jsxs("tbody",{children:[P.map(k=>{var x,C,S,w,D,O;const U=F[k.requestType]||{};return s.jsxs("tr",{children:[s.jsx("td",{children:k.requestType}),s.jsx("td",{children:s.jsx("input",{type:"checkbox",checked:!!U.active,onChange:$=>Z(H=>({...H,[k.requestType]:{...H[k.requestType],active:$.target.checked}}))})}),s.jsx("td",{children:s.jsx("input",{type:"checkbox",checked:!!U.autoApprove,onChange:$=>Z(H=>({...H,[k.requestType]:{...H[k.requestType],autoApprove:$.target.checked}}))})}),s.jsx("td",{children:s.jsx("input",{type:"checkbox",checked:!!U.requireSecondApprover,onChange:$=>Z(H=>({...H,[k.requestType]:{...H[k.requestType],requireSecondApprover:$.target.checked}}))})}),s.jsx("td",{children:s.jsxs("select",{value:U.fallbackRole||"HOSPITAL_ADMIN",onChange:$=>Z(H=>({...H,[k.requestType]:{...H[k.requestType],fallbackRole:$.target.value}})),children:[s.jsx("option",{value:"AUTO",children:"AUTO (workload-aware)"}),s.jsx("option",{value:"HOSPITAL_ADMIN",children:"HOSPITAL_ADMIN"}),s.jsx("option",{value:"HR_MANAGER",children:"HR_MANAGER"}),s.jsx("option",{value:"PAYROLL_OFFICER",children:"PAYROLL_OFFICER"}),s.jsx("option",{value:"SYSTEM_ADMIN",children:"SYSTEM_ADMIN"}),s.jsx("option",{value:"SUPER_ADMIN",children:"SUPER_ADMIN"})]})}),s.jsx("td",{children:s.jsx("input",{type:"number",min:"5",max:"10080",value:U.escalationAfterMinutes??120,onChange:$=>Z(H=>({...H,[k.requestType]:{...H[k.requestType],escalationAfterMinutes:$.target.value}}))})}),s.jsx("td",{children:s.jsx("input",{type:"number",min:"0",max:"60",value:((x=U.conditions)==null?void 0:x.maxLeaveDays)??0,onChange:$=>Z(H=>{var G;return{...H,[k.requestType]:{...H[k.requestType],conditions:{...((G=H[k.requestType])==null?void 0:G.conditions)||{},maxLeaveDays:$.target.value}}}})})}),s.jsx("td",{children:s.jsx("input",{type:"number",min:"0",max:"24",value:((C=U.conditions)==null?void 0:C.maxOvertimeHours)??0,onChange:$=>Z(H=>{var G;return{...H,[k.requestType]:{...H[k.requestType],conditions:{...((G=H[k.requestType])==null?void 0:G.conditions)||{},maxOvertimeHours:$.target.value}}}})})}),s.jsx("td",{children:s.jsx("input",{type:"number",min:"0.1",max:"10",step:"0.1",value:((S=U.conditions)==null?void 0:S.priorityAgeMultiplier)??1,onChange:$=>Z(H=>{var G;return{...H,[k.requestType]:{...H[k.requestType],conditions:{...((G=H[k.requestType])==null?void 0:G.conditions)||{},priorityAgeMultiplier:$.target.value}}}})})}),s.jsx("td",{children:s.jsx("input",{type:"number",min:"1",max:"20",step:"0.1",value:((w=U.conditions)==null?void 0:w.priorityWeightCap)??5,onChange:$=>Z(H=>{var G;return{...H,[k.requestType]:{...H[k.requestType],conditions:{...((G=H[k.requestType])==null?void 0:G.conditions)||{},priorityWeightCap:$.target.value}}}})})}),s.jsx("td",{children:s.jsx("input",{type:"text",value:((D=U.conditions)==null?void 0:D.allowedShiftTypes)??"",onChange:$=>Z(H=>{var G;return{...H,[k.requestType]:{...H[k.requestType],conditions:{...((G=H[k.requestType])==null?void 0:G.conditions)||{},allowedShiftTypes:$.target.value}}}})})}),s.jsx("td",{children:s.jsx("input",{type:"text",value:((O=U.conditions)==null?void 0:O.fallbackCandidates)??"",onChange:$=>Z(H=>{var G;return{...H,[k.requestType]:{...H[k.requestType],conditions:{...((G=H[k.requestType])==null?void 0:G.conditions)||{},fallbackCandidates:$.target.value}}}})})}),s.jsxs("td",{children:[s.jsx("div",{className:"action-list",style:{marginBottom:8},children:K.map($=>s.jsx("button",{className:"btn-secondary",title:`${$.description||""}${$.version?` | v${$.version}`:""}`,onClick:()=>Cs(k.requestType,$.key),children:$.name||$.key},`preset-row-${k.requestType}-${$.key}`))}),s.jsx("button",{className:"btn-secondary",disabled:Ae,onClick:()=>vi(k.requestType),children:"Save"}),s.jsx("button",{className:"btn-secondary",onClick:()=>_i(k.requestType),children:"Simulate"})]})]},`auto-${k.requestType}`)}),P.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:"13",children:"No automation policies loaded"})})]})]}),ne&&s.jsxs("div",{className:"card",style:{marginTop:10},children:[s.jsxs("strong",{children:["Simulation (",ne.requestType,")"]}),s.jsxs("div",{className:"muted",children:["Auto-Approve: ",(Vn=ne==null?void 0:ne.decision)!=null&&Vn.autoApprove?"Yes":"No"," | Requires 2nd Approver: ",(zr=ne==null?void 0:ne.decision)!=null&&zr.requiresSecondApprover?"Yes":"No"," | Fallback: ",((Nn=ne==null?void 0:ne.decision)==null?void 0:Nn.fallbackRole)||"-"]})]})]})]}),s.jsxs("section",{className:"section",id:"pending",children:[s.jsx("h3",{children:"Pending Requests"}),s.jsxs("div",{className:"card",children:[s.jsxs("div",{className:"action-list",style:{marginBottom:12},children:[s.jsx("button",{className:`action-pill ${ve==="ALL"?"active":""}`,onClick:()=>Ue("ALL"),children:"All"}),s.jsx("button",{className:`action-pill ${ve==="LEAVE"?"active":""}`,onClick:()=>Ue("LEAVE"),children:"Leave"}),s.jsx("button",{className:`action-pill ${ve==="OVERTIME"?"active":""}`,onClick:()=>Ue("OVERTIME"),children:"Overtime"}),s.jsx("button",{className:`action-pill ${ve==="SHIFT"?"active":""}`,onClick:()=>Ue("SHIFT"),children:"Shift"})]}),s.jsxs("div",{className:"action-list",style:{marginBottom:12},children:[s.jsxs("span",{className:"muted",children:["Leave: ",ks.LEAVE,((nr=(Us=I==null?void 0:I.queues)==null?void 0:Us.leave)==null?void 0:nr.pending)!=null?` / total ${I.queues.leave.pending}`:""]}),s.jsx("button",{className:"btn-secondary",disabled:!v||E==="LEAVE",onClick:()=>Is("LEAVE"),children:E==="LEAVE"?"Loading...":"Load more Leave"}),s.jsxs("span",{className:"muted",children:["Overtime: ",ks.OVERTIME,((Bs=(wr=I==null?void 0:I.queues)==null?void 0:wr.overtime)==null?void 0:Bs.pending)!=null?` / total ${I.queues.overtime.pending}`:""]}),s.jsx("button",{className:"btn-secondary",disabled:!_||E==="OVERTIME",onClick:()=>Is("OVERTIME"),children:E==="OVERTIME"?"Loading...":"Load more Overtime"}),s.jsxs("span",{className:"muted",children:["Shift: ",ks.SHIFT,((Sr=(Vs=I==null?void 0:I.queues)==null?void 0:Vs.shift)==null?void 0:Sr.pending)!=null?` / total ${I.queues.shift.pending}`:""]}),s.jsx("button",{className:"btn-secondary",disabled:!y||E==="SHIFT",onClick:()=>Is("SHIFT"),children:E==="SHIFT"?"Loading...":"Load more Shift"}),s.jsx("button",{className:"btn-secondary",disabled:N,onClick:()=>yt({append:!0}),children:N?"Loading...":"Load more All"})]}),s.jsxs("table",{className:"table lite",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Staff"}),s.jsx("th",{children:"Role"}),s.jsx("th",{children:"Type"}),s.jsx("th",{children:"Category"}),s.jsx("th",{children:"Requested"}),s.jsx("th",{children:"SLA Due"}),s.jsx("th",{children:"Stage"}),s.jsx("th",{children:"Reason"}),s.jsx("th",{children:"Actions"})]})}),s.jsxs("tbody",{children:[Bn.map(k=>{var U,x;return s.jsxs("tr",{id:`breach-row-${k.kind}-${k._id}`,className:[_r(k)?"breached-row":"",Ht===`${k.kind}-${k._id}`?"breached-row-active":""].join(" ").trim(),children:[s.jsx("td",{children:((U=k.requester)==null?void 0:U.name)||"-"}),s.jsx("td",{children:((x=k.requester)==null?void 0:x.role)||"-"}),s.jsx("td",{children:k.kind}),s.jsx("td",{children:k.type||k.shiftType||`${k.hours||"-"} hrs`}),s.jsx("td",{children:new Date(k.createdAt).toLocaleDateString()}),s.jsxs("td",{className:_r(k)?"text-danger":"",children:[k.slaDueAt?new Date(k.slaDueAt).toLocaleString():"-",_r(k)&&s.jsx("span",{className:"breach-pill",children:"BREACHED"})]}),s.jsx("td",{children:k.approvalStage||"L1_PENDING"}),s.jsx("td",{children:k.reason||"-"}),s.jsxs("td",{children:[s.jsx("button",{className:"btn-secondary",onClick:()=>Ts(k.kind,k._id,_r(k)),children:"Approve"}),s.jsx("button",{className:"btn-secondary",onClick:()=>q(k.kind,k._id,_r(k)),children:"Reject"})]})]},`${k.kind}-${k._id}`)}),Bn.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:"9",children:"No pending approvals"})})]})]})]})]})]})}function $P(){const{user:e}=Me(),[t,n]=g.useState([]),[r,i]=g.useState(!1),[a,o]=g.useState(null);if((e==null?void 0:e.role)!=="HOSPITAL_ADMIN"&&(e==null?void 0:e.role)!=="SUPER_ADMIN")return s.jsx("p",{children:" Access denied"});const l=async()=>{i(!0),o(null);try{const h=((await ue.get("/api/users")).data||[]).filter(f=>["HOSPITAL_ADMIN","DOCTOR","NURSE","LAB_TECH","PHARMACIST","RADIOLOGIST","THERAPIST","RECEPTIONIST","SECURITY_OFFICER","HR_MANAGER","PAYROLL_OFFICER"].includes(f.role));n(h)}catch{o("Failed to load staff")}finally{i(!1)}};g.useEffect(()=>{l()},[]);const c=async d=>{await ue.patch(`/api/users/${d}`,{active:!1}),l()},u=async(d,p)=>{await ue.patch(`/api/users/${d}`,{role:p}),l()};return s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"Staff Management"}),s.jsx("p",{className:"muted",children:"Approve roles, deactivate accounts."})]}),s.jsx("div",{className:"welcome-actions",children:s.jsx("button",{className:"btn-secondary",onClick:l,disabled:r,children:"Refresh"})})]}),a&&s.jsx("div",{className:"card",children:a}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Staff"}),s.jsx("div",{className:"card",children:s.jsxs("table",{className:"table lite",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Name"}),s.jsx("th",{children:"Email"}),s.jsx("th",{children:"Role"}),s.jsx("th",{children:"Status"}),s.jsx("th",{children:"Actions"})]})}),s.jsxs("tbody",{children:[t.map(d=>s.jsxs("tr",{children:[s.jsx("td",{children:d.name}),s.jsx("td",{children:d.email}),s.jsx("td",{children:s.jsxs("select",{value:d.role,onChange:p=>u(d._id,p.target.value),children:[s.jsx("option",{value:"HOSPITAL_ADMIN",children:"Hospital Admin"}),s.jsx("option",{value:"DOCTOR",children:"Doctor"}),s.jsx("option",{value:"NURSE",children:"Nurse"}),s.jsx("option",{value:"LAB_TECH",children:"Lab Tech"}),s.jsx("option",{value:"PHARMACIST",children:"Pharmacist"}),s.jsx("option",{value:"RADIOLOGIST",children:"Radiologist"}),s.jsx("option",{value:"THERAPIST",children:"Therapist"}),s.jsx("option",{value:"RECEPTIONIST",children:"Receptionist"}),s.jsx("option",{value:"SECURITY_OFFICER",children:"Security Officer"}),s.jsx("option",{value:"HR_MANAGER",children:"HR Manager"}),s.jsx("option",{value:"PAYROLL_OFFICER",children:"Payroll Officer"})]})}),s.jsx("td",{children:d.active===!1?"Inactive":"Active"}),s.jsx("td",{children:s.jsx("button",{className:"btn-secondary",onClick:()=>c(d._id),disabled:d.active===!1,children:"Deactivate"})})]},d._id)),t.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:"5",children:"No staff found"})})]})]})})]})]})}function FP(){const{user:e}=Me(),t=Re(),[n,r]=g.useState(null);return g.useEffect(()=>{YO().then(r).catch(()=>r(null))},[]),s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"Security Officer Field Console"}),s.jsx("p",{className:"muted",children:"Current shift execution, visitor flow, gate scanning and incident response."})]}),s.jsxs("div",{className:"welcome-actions",children:[s.jsx("button",{className:"btn-primary",onClick:()=>t("/security-officer"),children:"My Shift"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/security-officer"),children:"Visitor Check-In"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/security-officer"),children:"Emergency Alert"})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Shift & Zone"}),s.jsxs("div",{className:"grid info-grid",children:[s.jsx(te,{title:"Current Shift",value:"Active"}),s.jsx(te,{title:"Assigned Zone",value:(e==null?void 0:e.hospital)||"Main"}),s.jsx(te,{title:"Open Incidents",value:(n==null?void 0:n.openIncidents)??""}),s.jsx(te,{title:"Incidents Today",value:(n==null?void 0:n.incidentsToday)??""})]})]}),s.jsxs("section",{className:"section doctor-main-grid",children:[s.jsxs("div",{className:"card doctor-schedule-card",children:[s.jsx("h3",{children:"Center Operations"}),s.jsxs("div",{className:"panel-grid",children:[s.jsx("button",{className:"action-link",onClick:()=>t("/security-officer"),children:"QR Scanner Panel"}),s.jsx("button",{className:"action-link",onClick:()=>t("/security-officer"),children:"Visitor Log Table"}),s.jsx("button",{className:"action-link",onClick:()=>t("/security-officer"),children:"Patrol Logs"})]})]}),s.jsxs("div",{className:"card doctor-alerts-card",children:[s.jsx("h3",{children:"Right Actions"}),s.jsxs("div",{className:"alert-stack",children:[s.jsx("button",{className:"btn-secondary",onClick:()=>t("/security-officer"),children:"Incident Quick Form"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/security-officer"),children:"Alert Button"})]})]})]})]})}function HP(){const{user:e}=Me(),t=Re(),[n,r]=g.useState(null);return g.useEffect(()=>{GO().then(r).catch(()=>r(null))},[]),s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"Security Governance Dashboard"}),s.jsx("p",{className:"muted",children:"Access control, visitor management, incident response and device authorization."})]}),s.jsxs("div",{className:"welcome-actions",children:[s.jsx("button",{className:"btn-primary",onClick:()=>t("/security-admin"),children:"Access Logs"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/admin/notifications"),children:"Suspicious Alerts"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/reports"),children:"Compliance Reports"})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Security Snapshot"}),s.jsxs("div",{className:"grid info-grid",children:[s.jsx(te,{title:"Active Access Points",value:(n==null?void 0:n.officersActive)??""}),s.jsx(te,{title:"Open Incidents",value:(n==null?void 0:n.openIncidents)??""}),s.jsx(te,{title:"Escalated Incidents",value:(n==null?void 0:n.escalatedIncidents)??""}),s.jsx(te,{title:"Incidents Today",value:(n==null?void 0:n.incidentsToday)??""})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Security Control Panels"}),s.jsxs("div",{className:"panel-grid",children:[s.jsx("button",{className:"action-link",onClick:()=>t("/security-admin"),children:"Clearance Levels"}),s.jsx("button",{className:"action-link",onClick:()=>t("/security-admin"),children:"Visitor Management"}),s.jsx("button",{className:"action-link",onClick:()=>t("/security-admin"),children:"Device Authorization"}),s.jsx("button",{className:"action-link",onClick:()=>t("/security-admin"),children:"Emergency Protocols"}),s.jsx("button",{className:"action-link",onClick:()=>t("/security-admin"),children:"Blacklist Database"})]})]})]})}function qP(){const{user:e}=Me(),t=Re(),[n,r]=g.useState(null);g.useEffect(()=>{zO().then(r).catch(()=>r(null))},[]);const i=g.useMemo(()=>String((e==null?void 0:e.role)||"").toUpperCase(),[e==null?void 0:e.role]),a=i==="RADIOLOGIST"?"Radiologist Workspace":i==="THERAPIST"?"Therapist Workspace":i==="RECEPTIONIST"?"Receptionist Workspace":"Staff Workspace",o=i==="RADIOLOGIST"?["Imaging Queue","Scan Viewer","Report Editor","Equipment Logs","AI Assistance Overlay"]:i==="THERAPIST"?["Session Schedule","Patient Notes","Treatment Plans","Progress Tracking","Follow-up Planner"]:["Appointment Scheduling","Patient Check-In","Billing Initiation","Queue Management","Visitor Log"];return s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:a}),s.jsx("p",{className:"muted",children:"Role-specific operational dashboard with requests, queues and alerts."})]}),s.jsxs("div",{className:"welcome-actions",children:[s.jsx("button",{className:"btn-primary",onClick:()=>t("/staff"),children:"Open Workspace"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/workforce/requests"),children:"My Requests"})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Daily Summary"}),s.jsxs("div",{className:"grid info-grid",children:[s.jsx(te,{title:"My Pending Requests",value:(n==null?void 0:n.myPendingRequests)??""}),s.jsx(te,{title:"Hospital Pending Requests",value:(n==null?void 0:n.hospitalPendingRequests)??""}),s.jsx(te,{title:"Unread Notifications",value:(n==null?void 0:n.notificationsUnread)??""}),s.jsx(te,{title:"Appointments Today",value:(n==null?void 0:n.appointmentsToday)??""})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Role Workspace"}),s.jsx("div",{className:"panel-grid",children:o.map(l=>s.jsx("div",{className:"panel",children:l},l))})]})]})}function zP(){var j,_;const{user:e}=Me(),t=Re(),[n,r]=g.useState(null),[i,a]=g.useState(null),[o,l]=g.useState(null),[c,u]=g.useState({burnoutScore:[],projectedKpi:[],projectedChange:[]}),d=(m,y)=>{u(b=>({...b,[m]:[...b[m]||[],Number(y||0)].slice(-12)}))},p=m=>{const y=Number(m||0);return y>=75?"risk":y>=45?"warn":"good"},h=m=>{const y=Number(m||0);return y<0?"risk":y<3?"warn":"good"},f=m=>m==="risk"?"ALERT":m==="warn"?"WATCH":"OK",v=async()=>{try{const[m,y]=await Promise.all([zp({hoursPerWeek:50,nightShifts:4,consecutiveDays:6,overtimeHours:10,leaveBalanceDays:9,incidentsIn30d:1}),q0({baseline:100,interventions:[{name:"Shift rebalance",effectPct:6,confidence:.75},{name:"Fast-track hiring",effectPct:8,confidence:.65}]})]);a(m||null),l(y||null),d("burnoutScore",(m==null?void 0:m.score)||0),d("projectedKpi",(y==null?void 0:y.projected)||0),d("projectedChange",(y==null?void 0:y.changePct)||0)}catch{a(null),l(null)}};return g.useEffect(()=>{HO().then(r).catch(()=>r(null)),v();const m=setInterval(v,45e3);return()=>clearInterval(m)},[]),s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"HR Manager Command Center"}),s.jsx("p",{className:"muted",children:"Recruitment, onboarding, contracts, performance and workforce analytics."})]}),s.jsxs("div",{className:"welcome-actions",children:[s.jsx("button",{className:"btn-primary",onClick:()=>t("/hospital-admin/register-staff"),children:"Recruitment Pipeline"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/hospital-admin/staff"),children:"Employee Profiles"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/workforce/requests"),children:"Leave Management"})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Top HR KPIs"}),s.jsxs("div",{className:"grid info-grid",children:[s.jsx(te,{title:"Open Positions",value:(n==null?void 0:n.newHires)??""}),s.jsx(te,{title:"Leave Pending",value:((j=n==null?void 0:n.pendingRequests)==null?void 0:j.leave)??""}),s.jsx(te,{title:"Turnover %",value:(n==null?void 0:n.inactiveStaff)??""}),s.jsx(te,{title:"Compliance Alerts",value:(n==null?void 0:n.missingLicenses)??""})]})]}),s.jsxs("section",{className:"section doctor-main-grid",children:[s.jsxs("div",{className:"card doctor-schedule-card",children:[s.jsx("h3",{children:"Center Workspace"}),s.jsxs("div",{className:"panel-grid",children:[s.jsx("button",{className:"action-link",onClick:()=>t("/hospital-admin/register-staff"),children:"Recruitment Kanban"}),s.jsx("button",{className:"action-link",onClick:()=>t("/hospital-admin/staff"),children:"Contracts"}),s.jsx("button",{className:"action-link",onClick:()=>t("/hr-manager"),children:"Performance Reviews"}),s.jsx("button",{className:"action-link",onClick:()=>t("/hr-manager"),children:"Training & Certifications"}),s.jsx("button",{className:"action-link",onClick:()=>t("/hr-manager"),children:"Succession Planning"})]})]}),s.jsxs("div",{className:"card doctor-alerts-card",children:[s.jsx("h3",{children:"Right Insights"}),s.jsxs("div",{className:"alert-stack",children:[s.jsxs("div",{className:"action-pill",children:["Pending Requests: ",((_=n==null?void 0:n.pendingRequests)==null?void 0:_.total)??""]}),s.jsxs("div",{className:"action-pill",children:["Incomplete Staff: ",(n==null?void 0:n.incompleteStaff)??""]}),s.jsxs("div",{className:"action-pill",children:["Inactive Staff: ",(n==null?void 0:n.inactiveStaff)??""]})]})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"AI Workforce Intelligence"}),s.jsxs("div",{className:"grid info-grid",children:[s.jsx(te,{title:"Burnout Score",value:(i==null?void 0:i.score)??"",trend:c.burnoutScore,subtitle:"Auto-refresh 45s",status:p(i==null?void 0:i.score),badge:f(p(i==null?void 0:i.score)),why:`Burnout score ${(i==null?void 0:i.score)??0}; >=75 high risk, 45-74 medium.`,onBadgeClick:()=>t("/workforce/requests?status=PENDING")}),s.jsx(te,{title:"Burnout Band",value:(i==null?void 0:i.band)??""}),s.jsx(te,{title:"Projected KPI",value:(o==null?void 0:o.projected)??"",trend:c.projectedKpi,subtitle:"Auto-refresh 45s",status:h(o==null?void 0:o.changePct),badge:f(h(o==null?void 0:o.changePct)),why:`Projected KPI is ${(o==null?void 0:o.projected)??0}; negative expected change means risk.`,onBadgeClick:()=>t("/hospital-admin/register-staff")}),s.jsx(te,{title:"Projected Change %",value:(o==null?void 0:o.changePct)??"",trend:c.projectedChange,subtitle:"Auto-refresh 45s",status:h(o==null?void 0:o.changePct),badge:f(h(o==null?void 0:o.changePct)),why:`Change ${(o==null?void 0:o.changePct)??0}%; <0 is risk, 0-3 is watch.`,onBadgeClick:()=>t("/hospital-admin/register-staff")})]})]})]})}function WP(){const{user:e}=Me(),t=Re(),[n,r]=g.useState(null);return g.useEffect(()=>{qO().then(r).catch(()=>r(null))},[]),s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"Payroll Officer Engine"}),s.jsx("p",{className:"muted",children:"Run payroll, manage deductions, taxes, loans and audit-ready payroll history."})]}),s.jsxs("div",{className:"welcome-actions",children:[s.jsx("button",{className:"btn-primary",onClick:()=>t("/payments/full"),children:"Run Payroll"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/reports"),children:"Tax Reports"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/workforce/requests#overtime"),children:"Overtime"})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Payroll Status"}),s.jsxs("div",{className:"grid info-grid",children:[s.jsx(te,{title:"Current Payroll Status",value:(n==null?void 0:n.invoicesThisMonth)??""}),s.jsx(te,{title:"Total Gross",value:(n==null?void 0:n.totalThisMonth)??""}),s.jsx(te,{title:"Total Deductions",value:(n==null?void 0:n.unpaidInvoices)??""}),s.jsx(te,{title:"Net Pay Summary",value:(n==null?void 0:n.paidThisMonth)??""})]})]}),s.jsxs("section",{className:"section doctor-main-grid",children:[s.jsxs("div",{className:"card doctor-schedule-card",children:[s.jsx("h3",{children:"Payroll Table"}),s.jsxs("div",{className:"panel-grid",children:[s.jsx("button",{className:"action-link",onClick:()=>t("/payments/full"),children:"Overtime Management"}),s.jsx("button",{className:"action-link",onClick:()=>t("/payments/full"),children:"Allowances & Deductions"}),s.jsx("button",{className:"action-link",onClick:()=>t("/reports"),children:"Loan Management"}),s.jsx("button",{className:"action-link",onClick:()=>t("/payments/full"),children:"Generate Payslips"})]})]}),s.jsxs("div",{className:"card doctor-alerts-card",children:[s.jsx("h3",{children:"Right Insights"}),s.jsxs("div",{className:"alert-stack",children:[s.jsxs("div",{className:"action-pill",children:["Pending Approvals: ",(n==null?void 0:n.pendingApprovals)??""]}),s.jsxs("div",{className:"action-pill",children:["Overdue Payroll: ",(n==null?void 0:n.overduePayroll)??""]}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/reports"),children:"Audit Trail"})]})]})]})]})}function GP(){var p,h,f,v,j,_,m,y,b,N,A,E;const e=Re(),[t,n]=g.useState(null),[r,i]=g.useState(null),[a,o]=g.useState(!1),[l,c]=g.useState(null),u=async()=>{try{const[R,I]=await Promise.all([Fo(),Oh()]);n(R||null),i((I==null?void 0:I.trust)||null)}catch{n(null),i(null)}};g.useEffect(()=>{u()},[]);const d=async()=>{var R,I,T,L,B,W;o(!0),c(null);try{const z=await mp(),P=((I=(R=z==null?void 0:z.result)==null?void 0:R.workforce)==null?void 0:I.escalationsL1)??0,V=((L=(T=z==null?void 0:z.result)==null?void 0:T.workforce)==null?void 0:L.escalationsL2)??0;c(`Workflow SLA scan completed (L1: ${P}, L2: ${V})`),localStorage.setItem("workflow_sla_last_scan",JSON.stringify({lastScanAt:(z==null?void 0:z.ranAt)||new Date().toISOString(),escalationsL1:P,escalationsL2:V,updatedAt:new Date().toISOString()})),await u()}catch(z){c(((W=(B=z==null?void 0:z.response)==null?void 0:B.data)==null?void 0:W.message)||"Failed to run workflow SLA scan")}finally{o(!1)}};return s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"Developer Engineering Console"}),s.jsx("p",{className:"muted",children:"API observability, queue health, trust controls and SLA operations."})]}),s.jsxs("div",{className:"welcome-actions",children:[s.jsx("button",{className:"btn-primary",onClick:d,disabled:a,children:a?"Running SLA Scan...":"Run Workflow SLA Scan"}),s.jsx("button",{className:"btn-secondary",onClick:u,children:"Refresh Metrics"}),s.jsx("button",{className:"btn-secondary",onClick:()=>e("/developer/queue-replay"),children:"Queue Replay"}),s.jsx("button",{className:"btn-secondary",onClick:()=>e("/developer/decision-cockpit"),children:"Decision Cockpit"})]})]}),l&&s.jsx("div",{className:"card",children:l}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Queue Metrics"}),s.jsxs("div",{className:"grid info-grid",children:[s.jsx(te,{title:"Integration Waiting",value:((h=(p=t==null?void 0:t.queues)==null?void 0:p.integration)==null?void 0:h.waiting)??""}),s.jsx(te,{title:"DLQ Failed",value:((v=(f=t==null?void 0:t.queues)==null?void 0:f.dlq)==null?void 0:v.failed)??""}),s.jsx(te,{title:"Webhook Waiting",value:((_=(j=t==null?void 0:t.queues)==null?void 0:j.webhook)==null?void 0:_.waiting)??""}),s.jsx(te,{title:"Notification Waiting",value:((y=(m=t==null?void 0:t.queues)==null?void 0:m.notifications)==null?void 0:y.waiting)??""}),s.jsx(te,{title:"Workforce Pending",value:((N=(b=t==null?void 0:t.queues)==null?void 0:b.workforce)==null?void 0:N.totalPending)??""}),s.jsx(te,{title:"Workforce Breached",value:((E=(A=t==null?void 0:t.queues)==null?void 0:A.workforce)==null?void 0:E.breached)??""})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Trust Foundation"}),s.jsxs("div",{className:"grid info-grid",children:[s.jsx(te,{title:"Ledger Writes (24h)",value:(r==null?void 0:r.ledgerWrites24h)??""}),s.jsx(te,{title:"Policy Denials (24h)",value:(r==null?void 0:r.policyDenials24h)??""}),s.jsx(te,{title:"Consent Denials (24h)",value:(r==null?void 0:r.consentDenials24h)??""}),s.jsx(te,{title:"Risk Step-Ups (24h)",value:(r==null?void 0:r.highRiskStepUps24h)??""}),s.jsx(te,{title:"Active Consents",value:(r==null?void 0:r.activeConsents)??""})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Engineering Tools"}),s.jsxs("div",{className:"panel-grid",children:[s.jsx("button",{className:"action-link",onClick:()=>e("/developer/webhook-retry"),children:"Webhook Retry"}),s.jsx("button",{className:"action-link",onClick:()=>e("/developer/queue-replay"),children:"Job Queue Replay"}),s.jsx("button",{className:"action-link",onClick:()=>e("/developer/decision-cockpit"),children:"Decision Cockpit"}),s.jsx("button",{className:"action-link",onClick:()=>e("/system-admin/clinical-intelligence"),children:"Clinical Intelligence"}),s.jsx("button",{className:"action-link",onClick:()=>e("/developer/provenance-verify"),children:"Provenance Verify"}),s.jsx("button",{className:"action-link",onClick:()=>e("/ai/extract"),children:"NeuroEdge Extract"}),s.jsx("button",{className:"action-link",onClick:()=>e("/admin/realtime"),children:"Integration Monitor"}),s.jsx("button",{className:"action-link",onClick:()=>e("/admin/audit-logs"),children:"Audit Logs"}),s.jsx("button",{className:"action-link",onClick:()=>e("/super-admin/settings"),children:"Feature Flags"}),s.jsx("button",{className:"action-link",onClick:()=>e("/hospital-admin/approvals"),children:"Workforce Approvals"})]})]})]})}const $y=async()=>(await ue.get("/api/system-admin/metrics")).data,YP=async()=>{var t;return((t=(await ue.get("/api/system-admin/risk-policy")).data)==null?void 0:t.policy)||null},KP=async e=>{var n;return((n=(await ue.put("/api/system-admin/risk-policy",e)).data)==null?void 0:n.policy)||null},Fy=async(e={})=>{var i;const t=new URLSearchParams;e.domain&&t.set("domain",e.domain),e.resource&&t.set("resource",e.resource),e.action&&t.set("action",e.action),e.activeOnly&&t.set("activeOnly","1");const n=t.toString();return((i=(await ue.get(`/api/system-admin/abac-policies${n?`?${n}`:""}`)).data)==null?void 0:i.items)||[]},Hy=async e=>(await ue.post("/api/system-admin/abac-policies",e)).data,qy=async(e,t)=>(await ue.put(`/api/system-admin/abac-policies/${e}`,t)).data,JP=async e=>(await ue.delete(`/api/system-admin/abac-policies/${e}`)).data,QP=async e=>(await ue.post("/api/system-admin/abac-simulate",e)).data,ZP=async(e={})=>{var i;const t=new URLSearchParams;e.activeOnly&&t.set("activeOnly","1");const n=t.toString();return((i=(await ue.get(`/api/system-admin/abac-test-cases${n?`?${n}`:""}`)).data)==null?void 0:i.items)||[]},XP=async e=>(await ue.post("/api/system-admin/abac-test-cases",e)).data,eL=async e=>(await ue.delete(`/api/system-admin/abac-test-cases/${e}`)).data,tL=async e=>(await ue.post(`/api/system-admin/abac-test-cases/${e}/run`)).data,nL=async()=>(await ue.post("/api/system-admin/abac-test-cases/run-all")).data;function rL(){var L,B,W,z,P,V,K,ce,M,X,ae,pe,fe,Le,F,Z,Y,ye,ge,Ke,Ae,Fe,ne,me,se,be,De,mt,Pt,we,Ie,st,ve,Ue,Se,it,xe,St,Jt,fn,Ht,Un,Qt,En;const e=Re(),[t,n]=g.useState(null),[r,i]=g.useState(null),[a,o]=g.useState(null),[l,c]=g.useState(!1),[u,d]=g.useState(null),[p,h]=g.useState(null),[f,v]=g.useState(!1),[j,_]=g.useState(null),[m,y]=g.useState({doctorGap:[],nurseGap:[],underCapacity:[],pendingShifts:[]}),b=(je,Ee)=>{y(dt=>({...dt,[je]:[...dt[je]||[],Number(Ee||0)].slice(-12)}))},N=je=>{const Ee=Number(je||0);return Ee<=0?"good":Ee<=5?"warn":"risk"},A=(je,Ee=1,dt=3)=>{const gt=Number(je||0);return gt>=dt?"risk":gt>=Ee?"warn":"good"},E=je=>je==="risk"?"ALERT":je==="warn"?"WATCH":"OK",R=async()=>{var je,Ee,dt,gt,kt;try{const[Et,Te]=await Promise.all([qp({beds:300,occupancyRate:.8,avgPatientsPerDoctor:14,avgPatientsPerNurse:5,horizonDays:14}),z0({departments:[{name:"ICU",staff:22,demand:28,absenteeismRate:.06},{name:"Emergency",staff:36,demand:41,absenteeismRate:.05},{name:"Surgery",staff:18,demand:17,absenteeismRate:.04}]})]);_({forecast:Et,twin:Te});const Nt=Array.isArray((je=Te==null?void 0:Te.twin)==null?void 0:je.departments)?Te.twin.departments.filter(tr=>tr.status==="UNDER_CAPACITY").length:0;b("doctorGap",((Ee=Et==null?void 0:Et.forecast)==null?void 0:Ee.doctorGap)||0),b("nurseGap",((dt=Et==null?void 0:Et.forecast)==null?void 0:dt.nurseGap)||0),b("underCapacity",Nt),b("pendingShifts",((kt=(gt=Te==null?void 0:Te.twin)==null?void 0:gt.pendingRequests)==null?void 0:kt.shifts)||0)}catch{_(null)}};g.useEffect(()=>{Promise.all([$y(),Fo(),Oh()]).then(([Ee,dt,gt])=>{n(Ee||null),i(dt||null),o((gt==null?void 0:gt.trust)||null)}).catch(()=>{n(null),i(null),o(null)}),YP().then(Ee=>h(Ee||null)).catch(()=>h(null)),R();const je=setInterval(R,45e3);return()=>clearInterval(je)},[]);const I=async()=>{var je,Ee,dt,gt,kt,Et;c(!0),d(null);try{const Te=await mp(),Nt=((Ee=(je=Te==null?void 0:Te.result)==null?void 0:je.workforce)==null?void 0:Ee.escalationsL1)??0,tr=((gt=(dt=Te==null?void 0:Te.result)==null?void 0:dt.workforce)==null?void 0:gt.escalationsL2)??0;d(`SLA scan completed (L1: ${Nt}, L2: ${tr})`);const[pn,Cs,yt]=await Promise.all([$y(),Fo(),Oh()]);n(pn||null),i(Cs||null),o((yt==null?void 0:yt.trust)||null)}catch(Te){d(((Et=(kt=Te==null?void 0:Te.response)==null?void 0:kt.data)==null?void 0:Et.message)||"Failed to run SLA scan")}finally{c(!1)}},T=async()=>{if(p){v(!0),d(null);try{const je=await KP(p);h(je||p),d("Adaptive risk policy updated.")}catch(je){d((je==null?void 0:je.message)||"Failed to update risk policy")}finally{v(!1)}}};return s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"System Admin Technical Center"}),s.jsx("p",{className:"muted",children:"Operational reliability, queue health, integration stability and deployment visibility."})]}),s.jsxs("div",{className:"welcome-actions",children:[s.jsx("button",{className:"btn-primary",onClick:I,disabled:l,children:l?"Running SLA Scan...":"Run Workflow SLA Scan"}),s.jsx("button",{className:"btn-primary",onClick:()=>e("/developer"),children:"Server Metrics"}),s.jsx("button",{className:"btn-secondary",onClick:()=>e("/developer/queue-replay"),children:"Job Queue"}),s.jsx("button",{className:"btn-secondary",onClick:()=>e("/admin/realtime"),children:"Integration Monitor"})]})]}),u&&s.jsx("div",{className:"card",children:u}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"System Widgets"}),s.jsxs("div",{className:"grid info-grid",children:[s.jsx(te,{title:"CPU / Memory",value:((B=(L=r==null?void 0:r.queues)==null?void 0:L.integration)==null?void 0:B.active)??""}),s.jsx(te,{title:"Req / Min",value:((z=(W=r==null?void 0:r.queues)==null?void 0:W.integration)==null?void 0:z.completed)??""}),s.jsx(te,{title:"Failed Logins",value:((P=t==null?void 0:t.approvals)==null?void 0:P.total)??""}),s.jsx(te,{title:"Job Status",value:((K=(V=r==null?void 0:r.queues)==null?void 0:V.integration)==null?void 0:K.waiting)??""}),s.jsx(te,{title:"Microservices",value:(t==null?void 0:t.hospitals)??""}),s.jsx(te,{title:"Database Health",value:((M=(ce=r==null?void 0:r.queues)==null?void 0:ce.dlq)==null?void 0:M.failed)??""}),s.jsx(te,{title:"Workforce Breached",value:((ae=(X=r==null?void 0:r.queues)==null?void 0:X.workforce)==null?void 0:ae.breached)??""}),s.jsx(te,{title:"Policy Denials (24h)",value:(a==null?void 0:a.policyDenials24h)??""})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Technical Operations"}),s.jsxs("div",{className:"panel-grid",children:[s.jsx("button",{className:"action-link",onClick:()=>e("/developer"),children:"Error Logs"}),s.jsx("button",{className:"action-link",onClick:()=>e("/developer"),children:"API Logs"}),s.jsx("button",{className:"action-link",onClick:()=>e("/developer/queue-replay"),children:"Queue Monitor"}),s.jsx("button",{className:"action-link",onClick:()=>e("/developer/webhook-retry"),children:"Webhook Retry"}),s.jsx("button",{className:"action-link",onClick:()=>e("/system-admin/abac"),children:"ABAC Policies"}),s.jsx("button",{className:"action-link",onClick:()=>e("/system-admin/mapping-studio"),children:"Mapping Studio"}),s.jsx("button",{className:"action-link",onClick:()=>e("/system-admin/nlp-analytics"),children:"NLP Analytics"}),s.jsx("button",{className:"action-link",onClick:()=>e("/system-admin/clinical-intelligence"),children:"Clinical Intelligence"}),s.jsx("button",{className:"action-link",onClick:()=>e("/system-admin/regulatory-reports"),children:"Regulatory Reports"}),s.jsx("button",{className:"action-link",onClick:()=>e("/developer/ai-extraction-history"),children:"AI Extraction History"}),s.jsx("button",{className:"action-link",onClick:()=>e("/super-admin/settings"),children:"Feature Flags"}),s.jsx("button",{className:"action-link",onClick:()=>e("/admin/realtime"),children:"Integration Hub"})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"AI Intelligence Snapshot"}),s.jsxs("div",{className:"grid info-grid",children:[s.jsx(te,{title:"Doctor Gap",value:((fe=(pe=j==null?void 0:j.forecast)==null?void 0:pe.forecast)==null?void 0:fe.doctorGap)??"",trend:m.doctorGap,subtitle:"Auto-refresh 45s",status:N((F=(Le=j==null?void 0:j.forecast)==null?void 0:Le.forecast)==null?void 0:F.doctorGap),badge:E(N((Y=(Z=j==null?void 0:j.forecast)==null?void 0:Z.forecast)==null?void 0:Y.doctorGap)),why:`Gap is ${((ge=(ye=j==null?void 0:j.forecast)==null?void 0:ye.forecast)==null?void 0:ge.doctorGap)??0}; >5 means critical staffing risk.`,onBadgeClick:()=>e("/hospital-admin/register-staff?role=doctor")}),s.jsx(te,{title:"Nurse Gap",value:((Ae=(Ke=j==null?void 0:j.forecast)==null?void 0:Ke.forecast)==null?void 0:Ae.nurseGap)??"",trend:m.nurseGap,subtitle:"Auto-refresh 45s",status:N((ne=(Fe=j==null?void 0:j.forecast)==null?void 0:Fe.forecast)==null?void 0:ne.nurseGap),badge:E(N((se=(me=j==null?void 0:j.forecast)==null?void 0:me.forecast)==null?void 0:se.nurseGap)),why:`Gap is ${((De=(be=j==null?void 0:j.forecast)==null?void 0:be.forecast)==null?void 0:De.nurseGap)??0}; >5 means critical staffing risk.`,onBadgeClick:()=>e("/hospital-admin/register-staff?role=nurse")}),s.jsx(te,{title:"Under-Capacity Units",value:Array.isArray((Pt=(mt=j==null?void 0:j.twin)==null?void 0:mt.twin)==null?void 0:Pt.departments)?j.twin.twin.departments.filter(je=>je.status==="UNDER_CAPACITY").length:"",trend:m.underCapacity,subtitle:"Auto-refresh 45s",status:A(Array.isArray((Ie=(we=j==null?void 0:j.twin)==null?void 0:we.twin)==null?void 0:Ie.departments)?j.twin.twin.departments.filter(je=>je.status==="UNDER_CAPACITY").length:0,1,2),badge:E(A(Array.isArray((ve=(st=j==null?void 0:j.twin)==null?void 0:st.twin)==null?void 0:ve.departments)?j.twin.twin.departments.filter(je=>je.status==="UNDER_CAPACITY").length:0,1,2)),why:"Units with unmet demand are flagged. 2+ under-capacity units are critical.",onBadgeClick:()=>e("/system-admin/clinical-intelligence#digital-twin")}),s.jsx(te,{title:"Twin Pending Shifts",value:((it=(Se=(Ue=j==null?void 0:j.twin)==null?void 0:Ue.twin)==null?void 0:Se.pendingRequests)==null?void 0:it.shifts)??"",trend:m.pendingShifts,subtitle:"Auto-refresh 45s",status:A((Jt=(St=(xe=j==null?void 0:j.twin)==null?void 0:xe.twin)==null?void 0:St.pendingRequests)==null?void 0:Jt.shifts,5,15),badge:E(A((Un=(Ht=(fn=j==null?void 0:j.twin)==null?void 0:fn.twin)==null?void 0:Ht.pendingRequests)==null?void 0:Un.shifts,5,15)),why:"Pending shift requests above 15 indicate strong scheduling pressure.",onBadgeClick:()=>e("/hospital-admin/approvals?kind=SHIFT&view=all")})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Adaptive Risk Policy"}),s.jsx("div",{className:"card",children:p?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"grid info-grid",children:[s.jsxs("label",{className:"muted",children:["High Threshold",s.jsx("input",{type:"number",value:((Qt=p.thresholds)==null?void 0:Qt.high)??70,onChange:je=>h(Ee=>({...Ee,thresholds:{...(Ee==null?void 0:Ee.thresholds)||{},high:Number(je.target.value||70)}}))})]}),s.jsxs("label",{className:"muted",children:["Critical Threshold",s.jsx("input",{type:"number",value:((En=p.thresholds)==null?void 0:En.critical)??90,onChange:je=>h(Ee=>({...Ee,thresholds:{...(Ee==null?void 0:Ee.thresholds)||{},critical:Number(je.target.value||90)}}))})]}),s.jsxs("label",{className:"muted",children:["Restriction Minutes",s.jsx("input",{type:"number",value:p.restrictionMinutes??30,onChange:je=>h(Ee=>({...Ee,restrictionMinutes:Number(je.target.value||30)}))})]}),s.jsxs("label",{className:"muted",children:["Impossible Travel Window (min)",s.jsx("input",{type:"number",value:p.impossibleTravelWindowMinutes??90,onChange:je=>h(Ee=>({...Ee,impossibleTravelWindowMinutes:Number(je.target.value||90)}))})]})]}),s.jsxs("div",{className:"welcome-actions",style:{marginTop:12},children:[s.jsx("button",{className:"btn-primary",onClick:T,disabled:f,children:f?"Saving...":"Save Risk Policy"}),s.jsx("button",{className:"btn-secondary",onClick:()=>e("/step-up"),children:"Step-up Console"})]})]}):s.jsx("p",{className:"muted",children:"Risk policy unavailable."})})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Admin Controls"}),s.jsxs("div",{className:"action-list",children:[s.jsx("button",{className:"action-link",onClick:()=>e("/super-admin/hospitals"),children:"Hospitals"}),s.jsx("button",{className:"action-link",onClick:()=>e("/admin/create-admin"),children:"Role Overrides"}),s.jsx("button",{className:"action-link",onClick:()=>e("/admin/audit-logs"),children:"Audit Logs"}),s.jsx("button",{className:"action-link",onClick:()=>e("/admin/notifications"),children:"Alerts"})]})]})]})}const Cd={domain:"INTEROP",resource:"transfer_export",action:"read",effect:"ALLOW",roles:"DOCTOR,HOSPITAL_ADMIN,SYSTEM_ADMIN,SUPER_ADMIN,DEVELOPER",priority:100,active:!0,requireActiveConsent:!0,requireSameHospitalOrPrivileged:!0,requiredScopes:""},zy=e=>`${String(e.domain||"").toUpperCase()}::${String(e.resource||"").toLowerCase()}::${String(e.action||"").toLowerCase()}::${String(e.effect||"ALLOW").toUpperCase()}::${Number(e.priority||100)}`;function sL(){var ae,pe,fe,Le;const[e,t]=g.useState([]),[n,r]=g.useState(Cd),[i,a]=g.useState(null),[o,l]=g.useState(!1),[c,u]=g.useState(""),[d,p]=g.useState(!1),[h,f]=g.useState({domain:"INTEROP",resource:"transfer_export",action:"read",role:"DOCTOR",sameHospital:!1,hasActiveConsent:!1,sourceHospitalBypass:!1,allowedScopes:""}),[v,j]=g.useState(null),[_,m]=g.useState(!1),[y,b]=g.useState([]),[N,A]=g.useState(!1),[E,R]=g.useState(null),I=async()=>{l(!0);try{const[F,Z]=await Promise.all([Fy(),ZP()]);t(Array.isArray(F)?F:[]),b(Array.isArray(Z)?Z:[])}catch(F){u((F==null?void 0:F.message)||"Failed to load ABAC policies"),t([]),b([])}finally{l(!1)}};g.useEffect(()=>{I()},[]);const T=()=>({domain:n.domain,resource:n.resource,action:n.action,effect:n.effect,roles:String(n.roles||"").split(",").map(F=>F.trim().toUpperCase()).filter(Boolean),priority:Number(n.priority||100),active:!!n.active,conditions:{requireActiveConsent:!!n.requireActiveConsent,requireSameHospitalOrPrivileged:!!n.requireSameHospitalOrPrivileged,requiredScopes:String(n.requiredScopes||"").split(",").map(F=>F.trim().toLowerCase()).filter(Boolean)}}),L=async()=>{u("");try{const F=T();i?(await qy(i,F),u("ABAC policy updated")):(await Hy(F),u("ABAC policy created")),r(Cd),a(null),await I()}catch(F){u((F==null?void 0:F.message)||"Failed to save ABAC policy")}},B=F=>{var Z,Y,ye;a(F._id),r({domain:F.domain||"",resource:F.resource||"",action:F.action||"",effect:F.effect||"ALLOW",roles:Array.isArray(F.roles)?F.roles.join(","):"",priority:F.priority??100,active:F.active!==!1,requireActiveConsent:((Z=F.conditions)==null?void 0:Z.requireActiveConsent)===!0,requireSameHospitalOrPrivileged:((Y=F.conditions)==null?void 0:Y.requireSameHospitalOrPrivileged)===!0,requiredScopes:Array.isArray((ye=F.conditions)==null?void 0:ye.requiredScopes)?F.conditions.requiredScopes.join(","):""})},W=async F=>{try{await JP(F),u("ABAC policy deleted"),await I()}catch(Z){u((Z==null?void 0:Z.message)||"Failed to delete ABAC policy")}},z=()=>{const F=e.map(ge=>({domain:ge.domain,resource:ge.resource,action:ge.action,effect:ge.effect,roles:ge.roles||[],priority:ge.priority??100,active:ge.active!==!1,conditions:ge.conditions||{}})),Z=new Blob([JSON.stringify(F,null,2)],{type:"application/json"}),Y=URL.createObjectURL(Z),ye=document.createElement("a");ye.href=Y,ye.download="abac-policies.json",ye.click(),URL.revokeObjectURL(Y)},P=async F=>{var Z,Y,ye;if(F){p(!0),u("");try{const ge=await F.text(),Ke=JSON.parse(ge);if(!Array.isArray(Ke))throw new Error("JSON must be an array of policies");const Ae=await Fy(),Fe=new Map(Ae.map(se=>[zy(se),se]));let ne=0,me=0;for(const se of Ke){const be={domain:String(se.domain||"").toUpperCase(),resource:String(se.resource||"").toLowerCase(),action:String(se.action||"").toLowerCase(),effect:String(se.effect||"ALLOW").toUpperCase(),roles:Array.isArray(se.roles)?se.roles.map(mt=>String(mt||"").toUpperCase()).filter(Boolean):[],priority:Number(se.priority||100),active:se.active!==!1,conditions:{requireActiveConsent:((Z=se==null?void 0:se.conditions)==null?void 0:Z.requireActiveConsent)===!0,requireSameHospitalOrPrivileged:((Y=se==null?void 0:se.conditions)==null?void 0:Y.requireSameHospitalOrPrivileged)===!0,requiredScopes:Array.isArray((ye=se==null?void 0:se.conditions)==null?void 0:ye.requiredScopes)?se.conditions.requiredScopes.map(mt=>String(mt||"").toLowerCase()).filter(Boolean):[]}},De=Fe.get(zy(be));De!=null&&De._id?(await qy(De._id,be),me+=1):(await Hy(be),ne+=1)}u(`Import complete: ${ne} created, ${me} updated.`),await I()}catch(ge){u((ge==null?void 0:ge.message)||"Failed to import ABAC policies")}finally{p(!1)}}},V=async()=>{m(!0),j(null),u("");try{const F={domain:h.domain,resource:h.resource,action:h.action,role:h.role,sameHospital:h.sameHospital,hasActiveConsent:h.hasActiveConsent,sourceHospitalBypass:h.sourceHospitalBypass,allowedScopes:String(h.allowedScopes||"").split(",").map(Y=>Y.trim().toLowerCase()).filter(Boolean)},Z=await QP(F);j(Z)}catch(F){u((F==null?void 0:F.message)||"Failed to run ABAC simulation")}finally{m(!1)}},K=async()=>{u("");try{const F={name:`${h.domain}/${h.resource}/${h.action}/${h.role}`,input:{domain:h.domain,resource:h.resource,action:h.action,role:h.role,sameHospital:h.sameHospital,hasActiveConsent:h.hasActiveConsent,sourceHospitalBypass:h.sourceHospitalBypass,allowedScopes:String(h.allowedScopes||"").split(",").map(Z=>Z.trim().toLowerCase()).filter(Boolean)},expected:v!=null&&v.decision?{allowed:v.decision.allowed,reason:v.decision.reason||""}:{allowed:null,reason:""},active:!0};await XP(F),u("Simulation saved as ABAC test case."),await I()}catch(F){u((F==null?void 0:F.message)||"Failed to save test case")}},ce=async F=>{var Z;try{const Y=await tL(F);u(`Test ${(Y==null?void 0:Y.name)||F}: ${Y!=null&&Y.passed?"PASSED":"FAILED"} (${((Z=Y==null?void 0:Y.decision)==null?void 0:Z.reason)||"n/a"})`),await I()}catch(Y){u((Y==null?void 0:Y.message)||"Failed to run test case")}},M=async()=>{var F,Z;A(!0),R(null),u("");try{const Y=await nL();R((Y==null?void 0:Y.totals)||null),u(`ABAC test run complete: ${((F=Y==null?void 0:Y.totals)==null?void 0:F.passed)||0} passed, ${((Z=Y==null?void 0:Y.totals)==null?void 0:Z.failed)||0} failed.`),await I()}catch(Y){u((Y==null?void 0:Y.message)||"Failed to run all test cases")}finally{A(!1)}},X=async F=>{try{await eL(F),u("Test case deleted."),await I()}catch(Z){u((Z==null?void 0:Z.message)||"Failed to delete test case")}};return s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"ABAC Policy Engine"}),s.jsx("p",{className:"muted",children:"Manage zero-trust attribute-based rules across domains."})]}),s.jsxs("div",{className:"welcome-actions",children:[s.jsx("button",{className:"btn-secondary",onClick:I,disabled:o,children:"Refresh"}),s.jsx("button",{className:"btn-secondary",onClick:z,disabled:o||d,children:"Export JSON"}),s.jsxs("label",{className:"btn-secondary",style:{cursor:"pointer"},children:[d?"Importing...":"Import JSON",s.jsx("input",{type:"file",accept:"application/json",style:{display:"none"},onChange:F=>{var Z;return P((Z=F.target.files)==null?void 0:Z[0])},disabled:d})]})]})]}),c&&s.jsx("div",{className:"card",children:c}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:i?"Edit Policy":"Create Policy"}),s.jsxs("div",{className:"card",children:[s.jsxs("div",{className:"grid info-grid",children:[s.jsxs("label",{children:["Domain",s.jsx("input",{value:n.domain,onChange:F=>r(Z=>({...Z,domain:F.target.value.toUpperCase()}))})]}),s.jsxs("label",{children:["Resource",s.jsx("input",{value:n.resource,onChange:F=>r(Z=>({...Z,resource:F.target.value}))})]}),s.jsxs("label",{children:["Action",s.jsx("input",{value:n.action,onChange:F=>r(Z=>({...Z,action:F.target.value}))})]}),s.jsxs("label",{children:["Effect",s.jsxs("select",{value:n.effect,onChange:F=>r(Z=>({...Z,effect:F.target.value})),children:[s.jsx("option",{value:"ALLOW",children:"ALLOW"}),s.jsx("option",{value:"DENY",children:"DENY"})]})]}),s.jsxs("label",{children:["Roles (comma)",s.jsx("input",{value:n.roles,onChange:F=>r(Z=>({...Z,roles:F.target.value}))})]}),s.jsxs("label",{children:["Priority",s.jsx("input",{type:"number",value:n.priority,onChange:F=>r(Z=>({...Z,priority:F.target.value}))})]}),s.jsxs("label",{children:["Required Scopes (comma)",s.jsx("input",{value:n.requiredScopes,onChange:F=>r(Z=>({...Z,requiredScopes:F.target.value}))})]}),s.jsxs("label",{children:[s.jsx("input",{type:"checkbox",checked:n.active,onChange:F=>r(Z=>({...Z,active:F.target.checked}))})," Active"]}),s.jsxs("label",{children:[s.jsx("input",{type:"checkbox",checked:n.requireActiveConsent,onChange:F=>r(Z=>({...Z,requireActiveConsent:F.target.checked}))})," Require Active Consent"]}),s.jsxs("label",{children:[s.jsx("input",{type:"checkbox",checked:n.requireSameHospitalOrPrivileged,onChange:F=>r(Z=>({...Z,requireSameHospitalOrPrivileged:F.target.checked}))})," Require Same Hospital Or Privileged"]})]}),s.jsxs("div",{className:"welcome-actions",style:{marginTop:10},children:[s.jsx("button",{className:"btn-primary",onClick:L,children:i?"Update Policy":"Create Policy"}),s.jsx("button",{className:"btn-secondary",onClick:()=>{r(Cd),a(null)},children:"Reset"})]})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Policy List"}),s.jsx("div",{className:"card",children:s.jsxs("table",{className:"table lite",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Domain"}),s.jsx("th",{children:"Resource"}),s.jsx("th",{children:"Action"}),s.jsx("th",{children:"Effect"}),s.jsx("th",{children:"Priority"}),s.jsx("th",{children:"Active"}),s.jsx("th",{children:"Actions"})]})}),s.jsxs("tbody",{children:[e.map(F=>s.jsxs("tr",{children:[s.jsx("td",{children:F.domain}),s.jsx("td",{children:F.resource}),s.jsx("td",{children:F.action}),s.jsx("td",{children:F.effect}),s.jsx("td",{children:F.priority}),s.jsx("td",{children:F.active?"Yes":"No"}),s.jsxs("td",{children:[s.jsx("button",{className:"btn-secondary",onClick:()=>B(F),children:"Edit"}),s.jsx("button",{className:"btn-danger",onClick:()=>W(F._id),children:"Delete"})]})]},F._id)),e.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:"7",children:"No ABAC policies defined"})})]})]})})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Policy Simulator"}),s.jsxs("div",{className:"card",children:[s.jsxs("div",{className:"grid info-grid",children:[s.jsxs("label",{children:["Domain",s.jsx("input",{value:h.domain,onChange:F=>f(Z=>({...Z,domain:F.target.value.toUpperCase()}))})]}),s.jsxs("label",{children:["Resource",s.jsx("input",{value:h.resource,onChange:F=>f(Z=>({...Z,resource:F.target.value}))})]}),s.jsxs("label",{children:["Action",s.jsx("input",{value:h.action,onChange:F=>f(Z=>({...Z,action:F.target.value}))})]}),s.jsxs("label",{children:["Role",s.jsx("input",{value:h.role,onChange:F=>f(Z=>({...Z,role:F.target.value.toUpperCase()}))})]}),s.jsxs("label",{children:["Allowed scopes (comma)",s.jsx("input",{value:h.allowedScopes,onChange:F=>f(Z=>({...Z,allowedScopes:F.target.value}))})]}),s.jsxs("label",{children:[s.jsx("input",{type:"checkbox",checked:h.sameHospital,onChange:F=>f(Z=>({...Z,sameHospital:F.target.checked}))})," Same hospital"]}),s.jsxs("label",{children:[s.jsx("input",{type:"checkbox",checked:h.hasActiveConsent,onChange:F=>f(Z=>({...Z,hasActiveConsent:F.target.checked}))})," Active consent"]}),s.jsxs("label",{children:[s.jsx("input",{type:"checkbox",checked:h.sourceHospitalBypass,onChange:F=>f(Z=>({...Z,sourceHospitalBypass:F.target.checked}))})," Source hospital bypass"]})]}),s.jsxs("div",{className:"welcome-actions",style:{marginTop:10},children:[s.jsx("button",{className:"btn-primary",onClick:V,disabled:_,children:_?"Simulating...":"Run Simulation"}),s.jsx("button",{className:"btn-secondary",onClick:K,disabled:!h.domain||!h.resource||!h.action||!h.role,children:"Save as Test Case"})]}),v&&s.jsxs("div",{className:"card",style:{marginTop:12},children:[s.jsxs("p",{children:["Decision:"," ",s.jsx("strong",{style:{color:(ae=v==null?void 0:v.decision)!=null&&ae.allowed?"#127a4b":"#b42318"},children:(pe=v==null?void 0:v.decision)!=null&&pe.allowed?"ALLOW":"DENY"})," ","(",((fe=v==null?void 0:v.decision)==null?void 0:fe.reason)||"n/a",")"]}),s.jsxs("p",{className:"muted",children:["Matched Policy: ",((Le=v==null?void 0:v.matchedPolicy)==null?void 0:Le._id)||"None"]}),s.jsxs("details",{children:[s.jsxs("summary",{children:["Trace (",Array.isArray(v==null?void 0:v.trace)?v.trace.length:0,")"]}),s.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:JSON.stringify(v.trace||[],null,2)})]})]})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"ABAC Regression Test Cases"}),s.jsxs("div",{className:"card",children:[s.jsxs("div",{className:"welcome-actions",style:{marginBottom:10},children:[s.jsx("button",{className:"btn-primary",onClick:M,disabled:N,children:N?"Running All...":"Run All Active Tests"}),E&&s.jsxs("span",{className:"muted",children:["Total: ",E.active||0," | Passed: ",E.passed||0," | Failed:"," ",E.failed||0]})]}),s.jsxs("table",{className:"table lite",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Name"}),s.jsx("th",{children:"Input"}),s.jsx("th",{children:"Expected"}),s.jsx("th",{children:"Last Run"}),s.jsx("th",{children:"Actions"})]})}),s.jsxs("tbody",{children:[y.map(F=>{var Z,Y,ye,ge,Ke,Ae,Fe;return s.jsxs("tr",{children:[s.jsx("td",{children:F.name}),s.jsxs("td",{children:[(Z=F.input)==null?void 0:Z.domain,"/",(Y=F.input)==null?void 0:Y.resource,"/",(ye=F.input)==null?void 0:ye.action,"/",(ge=F.input)==null?void 0:ge.role]}),s.jsx("td",{children:typeof((Ke=F.expected)==null?void 0:Ke.allowed)=="boolean"?`${F.expected.allowed?"ALLOW":"DENY"}${(Ae=F.expected)!=null&&Ae.reason?` (${F.expected.reason})`:""}`:"Any"}),s.jsx("td",{children:F.lastRunAt?`${new Date(F.lastRunAt).toLocaleString()} - ${(Fe=F.lastRun)!=null&&Fe.passed?"PASS":"FAIL"}`:"Not run"}),s.jsxs("td",{children:[s.jsx("button",{className:"btn-secondary",onClick:()=>ce(F._id),children:"Run"}),s.jsx("button",{className:"btn-danger",onClick:()=>X(F._id),children:"Delete"})]})]},F._id)}),y.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:"5",children:"No ABAC test cases yet."})})]})]})]})]})]})}const iL=async()=>le("/api/mapping"),aL=async e=>le("/api/mapping",{method:"POST",body:e}),oL=async(e,t)=>le(`/api/mapping/${e}`,{method:"PUT",body:t}),lL=async e=>le(`/api/mapping/${e}`,{method:"DELETE"}),cL=async()=>le("/api/mapping/catalog/templates"),uL=async e=>le("/api/mapping/preview",{method:"POST",body:e}),dL=async e=>le("/api/mapping/sign",{method:"POST",body:e}),hL=async e=>le("/api/mapping/verify",{method:"POST",body:e}),kd={messageType:"ORM^O01",sourceSystem:"LIS",targetSystem:"EMR",mappingJson:JSON.stringify({"PID-5":"patient.name","PID-7":"patient.dateOfBirth","OBR-4":"order.testCode"},null,2)};function fL(){const[e,t]=g.useState([]),[n,r]=g.useState([]),[i,a]=g.useState(kd),[o,l]=g.useState(null),[c,u]=g.useState("HL7"),[d,p]=g.useState(`MSH|^~\\&|LIS|HOSP|EMR|HOSP|20260220||ORM^O01|123|P|2.3
PID|1||P001||Jane Doe||1988-02-02
OBR|1|||CBC^Panel`),[h,f]=g.useState(""),[v,j]=g.useState(null),[_,m]=g.useState(""),[y,b]=g.useState(""),[N,A]=g.useState(null),[E,R]=g.useState(""),[I,T]=g.useState(!1),L=g.useMemo(()=>{try{return JSON.parse(i.mappingJson||"{}")}catch{return null}},[i.mappingJson]),B=async()=>{T(!0),R("");try{const[M,X]=await Promise.all([iL(),cL()]);t(Array.isArray(M)?M:[]),r(Array.isArray(X==null?void 0:X.templates)?X.templates:[])}catch(M){R((M==null?void 0:M.message)||"Failed to load mapping studio"),t([]),r([])}finally{T(!1)}};g.useEffect(()=>{B()},[]);const W=async()=>{if(R(""),!L){R("Mapping JSON is invalid.");return}try{const M={messageType:i.messageType,sourceSystem:i.sourceSystem,targetSystem:i.targetSystem,mapping:L};o?(await oL(o,M),R("Mapping updated.")):(await aL(M),R("Mapping created.")),a(kd),l(null),await B()}catch(M){R((M==null?void 0:M.message)||"Failed to save mapping")}},z=M=>{l(M._id),a({messageType:M.messageType||"",sourceSystem:M.sourceSystem||"",targetSystem:M.targetSystem||"",mappingJson:JSON.stringify(M.mapping||{},null,2)})},P=async M=>{R("");try{await lL(M),R("Mapping deleted."),await B()}catch(X){R((X==null?void 0:X.message)||"Failed to delete mapping")}},V=async()=>{var M;R(""),j(null);try{const X={format:c,payload:c==="FHIR"?JSON.parse(d||"{}"):d,...h?{mappingId:h}:{mapping:L||{}}},ae=await uL(X);j(ae||null),(M=ae==null?void 0:ae.provenance)!=null&&M.signature&&b(ae.provenance.signature)}catch(X){R((X==null?void 0:X.message)||"Preview failed")}},K=async()=>{var M;R("");try{const X=JSON.parse(_||"{}"),ae=await dL({payload:X,context:{module:"mapping_studio_ui"}});b(((M=ae==null?void 0:ae.signature)==null?void 0:M.signature)||""),R("Payload signed.")}catch(X){R((X==null?void 0:X.message)||"Sign failed")}},ce=async()=>{R(""),A(null);try{const M=JSON.parse(_||"{}"),X=await hL({payload:M,signature:y});A((X==null?void 0:X.verification)||null)}catch(M){R((M==null?void 0:M.message)||"Verify failed")}};return s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"FHIR/HL7 Transformation Studio"}),s.jsx("p",{className:"muted",children:"Create mappings, preview transformations, and verify signed provenance."})]}),s.jsx("div",{className:"welcome-actions",children:s.jsx("button",{className:"btn-secondary",onClick:B,disabled:I,children:"Refresh"})})]}),E&&s.jsx("div",{className:"card",children:E}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:o?"Edit Mapping":"Create Mapping"}),s.jsxs("div",{className:"card",children:[s.jsxs("div",{className:"grid info-grid",children:[s.jsxs("label",{children:["Message Type",s.jsx("input",{value:i.messageType,onChange:M=>a(X=>({...X,messageType:M.target.value}))})]}),s.jsxs("label",{children:["Source System",s.jsx("input",{value:i.sourceSystem,onChange:M=>a(X=>({...X,sourceSystem:M.target.value}))})]}),s.jsxs("label",{children:["Target System",s.jsx("input",{value:i.targetSystem,onChange:M=>a(X=>({...X,targetSystem:M.target.value}))})]})]}),s.jsxs("label",{children:["Mapping JSON",s.jsx("textarea",{rows:10,value:i.mappingJson,onChange:M=>a(X=>({...X,mappingJson:M.target.value}))})]}),s.jsxs("div",{className:"welcome-actions",style:{marginTop:10},children:[s.jsx("button",{className:"btn-primary",onClick:W,children:o?"Update Mapping":"Save Mapping"}),s.jsx("button",{className:"btn-secondary",onClick:()=>{a(kd),l(null)},children:"Reset"})]})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Preview + Provenance"}),s.jsxs("div",{className:"card",children:[s.jsxs("div",{className:"grid info-grid",children:[s.jsxs("label",{children:["Format",s.jsxs("select",{value:c,onChange:M=>u(M.target.value),children:[s.jsx("option",{value:"HL7",children:"HL7"}),s.jsx("option",{value:"FHIR",children:"FHIR"})]})]}),s.jsxs("label",{children:["Use saved mapping",s.jsxs("select",{value:h,onChange:M=>f(M.target.value),children:[s.jsx("option",{value:"",children:"Current editor mapping"}),e.map(M=>s.jsxs("option",{value:M._id,children:[M.messageType," / ",M.sourceSystem,"  ",M.targetSystem]},M._id))]})]})]}),s.jsxs("label",{children:["Source payload (",c,")",s.jsx("textarea",{rows:8,value:d,onChange:M=>p(M.target.value)})]}),s.jsx("div",{className:"welcome-actions",style:{marginTop:10},children:s.jsx("button",{className:"btn-primary",onClick:V,children:"Preview Transform"})}),v&&s.jsxs("details",{style:{marginTop:10},open:!0,children:[s.jsx("summary",{children:"Preview Result"}),s.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:JSON.stringify(v,null,2)})]})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Signature Tools"}),s.jsxs("div",{className:"card",children:[s.jsxs("label",{children:["Payload JSON",s.jsx("textarea",{rows:6,value:_,onChange:M=>m(M.target.value)})]}),s.jsxs("label",{children:["Signature",s.jsx("input",{value:y,onChange:M=>b(M.target.value)})]}),s.jsxs("div",{className:"welcome-actions",style:{marginTop:10},children:[s.jsx("button",{className:"btn-secondary",onClick:K,children:"Sign Payload"}),s.jsx("button",{className:"btn-secondary",onClick:ce,children:"Verify Signature"})]}),N&&s.jsxs("div",{className:"card",style:{marginTop:10},children:["Verification: ",s.jsx("strong",{children:N.valid?"VALID":"INVALID"})," (",N.reason,")"]})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Saved Mappings"}),s.jsx("div",{className:"card",children:s.jsxs("table",{className:"table lite",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Type"}),s.jsx("th",{children:"Source"}),s.jsx("th",{children:"Target"}),s.jsx("th",{children:"Actions"})]})}),s.jsxs("tbody",{children:[e.map(M=>s.jsxs("tr",{children:[s.jsx("td",{children:M.messageType}),s.jsx("td",{children:M.sourceSystem}),s.jsx("td",{children:M.targetSystem}),s.jsxs("td",{children:[s.jsx("button",{className:"btn-secondary",onClick:()=>z(M),children:"Edit"}),s.jsx("button",{className:"btn-danger",onClick:()=>P(M._id),children:"Delete"})]})]},M._id)),e.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:"4",children:"No mappings found."})})]})]})})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Template Catalog"}),s.jsxs("div",{className:"panel-grid",children:[n.map(M=>s.jsxs("div",{className:"card",children:[s.jsx("strong",{children:M.title}),s.jsx("p",{className:"muted",children:M.format}),s.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:JSON.stringify(M.mapping,null,2)})]},M.id)),n.length===0&&s.jsx("div",{className:"card muted",children:"No templates."})]})]})]})}const pL=async e=>le("/api/analytics/nlp/query",{method:"POST",body:{query:e}}),mL=async()=>le("/api/reports/regulatory/auto");function gL(){const[e,t]=g.useState("Show pending approvals this week"),[n,r]=g.useState(null),[i,a]=g.useState(""),[o,l]=g.useState(!1),c=async()=>{l(!0),a(""),r(null);try{const u=await pL(e);r(u||null)}catch(u){a((u==null?void 0:u.message)||"Failed to run NLP analytics query")}finally{l(!1)}};return s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"NLP Analytics"}),s.jsx("p",{className:"muted",children:"Ask analytics questions in natural language and get actionable metrics."})]}),s.jsx("div",{className:"welcome-actions",children:s.jsx("button",{className:"btn-primary",onClick:c,disabled:o,children:o?"Running...":"Run Query"})})]}),i&&s.jsx("div",{className:"card",children:i}),s.jsx("section",{className:"section",children:s.jsxs("div",{className:"card",children:[s.jsxs("label",{children:["Query",s.jsx("input",{value:e,onChange:u=>t(u.target.value),placeholder:"e.g. show revenue for last 30 days"})]}),s.jsxs("div",{className:"welcome-actions",style:{marginTop:10},children:[s.jsx("button",{className:"btn-secondary",onClick:()=>t("Show revenue this month"),children:"Revenue"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("Show active staff"),children:"Staff"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("Show pending approvals"),children:"Approvals"})]})]})}),n&&s.jsx("section",{className:"section",children:s.jsxs("div",{className:"card",children:[s.jsx("h3",{children:"Interpretation"}),s.jsx("p",{children:n.interpretation}),s.jsx("h3",{children:"Metrics"}),s.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:JSON.stringify(n.metrics,null,2)}),s.jsx("h3",{children:"Suggested Follow-ups"}),s.jsx("ul",{children:(n.suggestedFollowUps||[]).map((u,d)=>s.jsx("li",{children:u},`s-${d}`))})]})})]})}function yL(){var l,c,u,d,p;const[e,t]=g.useState(null),[n,r]=g.useState(""),[i,a]=g.useState(!1),o=async()=>{a(!0),r("");try{const h=await mL();t((h==null?void 0:h.report)||null)}catch(h){r((h==null?void 0:h.message)||"Failed to generate regulatory auto report"),t(null)}finally{a(!1)}};return s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"Regulatory Auto Report"}),s.jsx("p",{className:"muted",children:"Generated compliance snapshot for workforce, approvals, and security events."})]}),s.jsx("div",{className:"welcome-actions",children:s.jsx("button",{className:"btn-primary",onClick:o,disabled:i,children:i?"Generating...":"Generate Report"})})]}),n&&s.jsx("div",{className:"card",children:n}),e&&s.jsxs(s.Fragment,{children:[s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Summary"}),s.jsxs("div",{className:"grid info-grid",children:[s.jsx(te,{title:"Staff Total",value:((l=e==null?void 0:e.workforce)==null?void 0:l.staffTotal)??""}),s.jsx(te,{title:"Inactive Staff",value:((c=e==null?void 0:e.workforce)==null?void 0:c.inactiveStaff)??""}),s.jsx(te,{title:"Pending Approvals",value:((u=e==null?void 0:e.approvals)==null?void 0:u.total)??""}),s.jsx(te,{title:"Export Events (30d)",value:((d=e==null?void 0:e.compliance)==null?void 0:d.exportEvents)??""}),s.jsx(te,{title:"ABAC Denials (30d)",value:((p=e==null?void 0:e.compliance)==null?void 0:p.abacDeniedEvents)??""})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Flags"}),s.jsxs("div",{className:"panel-grid",children:[(e.flags||[]).map(h=>s.jsx("div",{className:"card",children:h},h)),(e.flags||[]).length===0&&s.jsx("div",{className:"card muted",children:"No critical flags."})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Raw Report"}),s.jsx("div",{className:"card",children:s.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:JSON.stringify(e,null,2)})})]})]})]})}function vL(){const[e,t]=g.useState(""),[n,r]=g.useState(""),[i,a]=g.useState({beds:220,occupancyRate:.78,avgPatientsPerDoctor:14,avgPatientsPerNurse:5,horizonDays:14}),[o,l]=g.useState(null),[c,u]=g.useState({hoursPerWeek:52,nightShifts:6,consecutiveDays:7,overtimeHours:12,leaveBalanceDays:8,incidentsIn30d:1}),[d,p]=g.useState(null),[h,f]=g.useState({baseline:100,interventionsJson:JSON.stringify([{name:"Add ICU nurses",effectPct:8,confidence:.7},{name:"Shift rebalancing",effectPct:5,confidence:.8}],null,2)}),[v,j]=g.useState(null),[_,m]=g.useState({departmentsJson:JSON.stringify([{name:"ICU",staff:18,demand:24,absenteeismRate:.08},{name:"Emergency",staff:26,demand:30,absenteeismRate:.05},{name:"Pediatrics",staff:15,demand:12,absenteeismRate:.03}],null,2)}),[y,b]=g.useState(null),N=async()=>{r("forecast"),t("");try{const I=await qp(i);l(I||null)}catch(I){t((I==null?void 0:I.message)||"Failed to run staffing forecast")}finally{r("")}},A=async()=>{r("burnout"),t("");try{const I=await zp(c);p(I||null)}catch(I){t((I==null?void 0:I.message)||"Failed to run burnout scoring")}finally{r("")}},E=async()=>{r("causal"),t("");try{const I=JSON.parse(h.interventionsJson||"[]"),T=await q0({baseline:Number(h.baseline||0),interventions:I});j(T||null)}catch(I){t((I==null?void 0:I.message)||"Failed to run causal impact")}finally{r("")}},R=async()=>{r("twin"),t("");try{const I=JSON.parse(_.departmentsJson||"[]"),T=await z0({departments:I});b(T||null)}catch(I){t((I==null?void 0:I.message)||"Failed to run digital twin simulation")}finally{r("")}};return s.jsxs("div",{className:"dashboard",children:[s.jsx("div",{className:"welcome-panel",children:s.jsxs("div",{children:[s.jsx("h2",{children:"Clinical Intelligence Lab"}),s.jsx("p",{className:"muted",children:"AI staffing planner, burnout risk scoring, causal impact simulation, and hospital digital twin."})]})}),e&&s.jsx("div",{className:"card",children:e}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Staffing Forecast"}),s.jsxs("div",{className:"card",children:[s.jsxs("div",{className:"grid info-grid",children:[s.jsxs("label",{children:["Beds",s.jsx("input",{type:"number",value:i.beds,onChange:I=>a(T=>({...T,beds:Number(I.target.value||0)}))})]}),s.jsxs("label",{children:["Occupancy Rate",s.jsx("input",{type:"number",step:"0.01",value:i.occupancyRate,onChange:I=>a(T=>({...T,occupancyRate:Number(I.target.value||0)}))})]}),s.jsxs("label",{children:["Patients/Doctor",s.jsx("input",{type:"number",value:i.avgPatientsPerDoctor,onChange:I=>a(T=>({...T,avgPatientsPerDoctor:Number(I.target.value||1)}))})]}),s.jsxs("label",{children:["Patients/Nurse",s.jsx("input",{type:"number",value:i.avgPatientsPerNurse,onChange:I=>a(T=>({...T,avgPatientsPerNurse:Number(I.target.value||1)}))})]}),s.jsxs("label",{children:["Horizon Days",s.jsx("input",{type:"number",value:i.horizonDays,onChange:I=>a(T=>({...T,horizonDays:Number(I.target.value||1)}))})]})]}),s.jsx("div",{className:"welcome-actions",style:{marginTop:10},children:s.jsx("button",{className:"btn-primary",onClick:N,disabled:n==="forecast",children:n==="forecast"?"Running...":"Run Staffing Forecast"})}),o&&s.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:JSON.stringify(o,null,2)})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Burnout Risk Scoring"}),s.jsxs("div",{className:"card",children:[s.jsxs("div",{className:"grid info-grid",children:[s.jsxs("label",{children:["Hours/Week",s.jsx("input",{type:"number",value:c.hoursPerWeek,onChange:I=>u(T=>({...T,hoursPerWeek:Number(I.target.value||0)}))})]}),s.jsxs("label",{children:["Night Shifts",s.jsx("input",{type:"number",value:c.nightShifts,onChange:I=>u(T=>({...T,nightShifts:Number(I.target.value||0)}))})]}),s.jsxs("label",{children:["Consecutive Days",s.jsx("input",{type:"number",value:c.consecutiveDays,onChange:I=>u(T=>({...T,consecutiveDays:Number(I.target.value||0)}))})]}),s.jsxs("label",{children:["Overtime Hours",s.jsx("input",{type:"number",value:c.overtimeHours,onChange:I=>u(T=>({...T,overtimeHours:Number(I.target.value||0)}))})]}),s.jsxs("label",{children:["Leave Balance",s.jsx("input",{type:"number",value:c.leaveBalanceDays,onChange:I=>u(T=>({...T,leaveBalanceDays:Number(I.target.value||0)}))})]}),s.jsxs("label",{children:["Incidents 30d",s.jsx("input",{type:"number",value:c.incidentsIn30d,onChange:I=>u(T=>({...T,incidentsIn30d:Number(I.target.value||0)}))})]})]}),s.jsx("div",{className:"welcome-actions",style:{marginTop:10},children:s.jsx("button",{className:"btn-primary",onClick:A,disabled:n==="burnout",children:n==="burnout"?"Running...":"Run Burnout Scoring"})}),d&&s.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:JSON.stringify(d,null,2)})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Causal Impact Simulation"}),s.jsxs("div",{className:"card",children:[s.jsxs("label",{children:["Baseline Metric",s.jsx("input",{type:"number",value:h.baseline,onChange:I=>f(T=>({...T,baseline:Number(I.target.value||0)}))})]}),s.jsxs("label",{children:["Interventions JSON",s.jsx("textarea",{rows:7,value:h.interventionsJson,onChange:I=>f(T=>({...T,interventionsJson:I.target.value}))})]}),s.jsx("div",{className:"welcome-actions",style:{marginTop:10},children:s.jsx("button",{className:"btn-primary",onClick:E,disabled:n==="causal",children:n==="causal"?"Running...":"Run Causal Simulation"})}),v&&s.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:JSON.stringify(v,null,2)})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Digital Twin Simulation"}),s.jsxs("div",{className:"card",children:[s.jsxs("label",{children:["Departments JSON",s.jsx("textarea",{rows:8,value:_.departmentsJson,onChange:I=>m(T=>({...T,departmentsJson:I.target.value}))})]}),s.jsx("div",{className:"welcome-actions",style:{marginTop:10},children:s.jsx("button",{className:"btn-primary",onClick:R,disabled:n==="twin",children:n==="twin"?"Running...":"Run Digital Twin"})}),y&&s.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:JSON.stringify(y,null,2)})]})]})]})}const Ja="my_requests_query_cache_v1",xL=15*60*1e3;function jL(){const{user:e}=Me(),t=Re(),n=hn(),[r,i]=g.useState(!1),[a,o]=g.useState(null),[l,c]=g.useState([]),[u,d]=g.useState([]),[p,h]=g.useState([]),[f,v]=g.useState(null),[j,_]=g.useState(null),[m,y]=g.useState(null),[b,N]=g.useState(!1),[A,E]=g.useState(!1),[R,I]=g.useState(!1),[T,L]=g.useState("ALL"),[B,W]=g.useState(!1),[z,P]=g.useState("Live  now"),V=g.useRef(!1),[K,ce]=g.useState({type:"Annual",startDate:"",endDate:"",reason:""}),[M,X]=g.useState({hours:"",date:"",reason:""}),[ae,pe]=g.useState({shiftType:"Day",date:"",reason:""}),fe=`${(e==null?void 0:e.role)||"UNKNOWN"}:${(e==null?void 0:e._id)||(e==null?void 0:e.id)||(e==null?void 0:e.email)||"anon"}`,Le=ne=>Array.isArray(ne)?{items:ne,nextCursor:null,hasMore:!1}:{items:Array.isArray(ne==null?void 0:ne.items)?ne.items:[],nextCursor:(ne==null?void 0:ne.nextCursor)||null,hasMore:!!(ne!=null&&ne.hasMore)},F=async(ne="ALL",{append:me=!1}={})=>{var se,be;i(!0),o(null);try{const De=ne!=="ALL"?ne:void 0,mt=!me||b&&!!f,Pt=!me||A&&!!j,we=!me||R&&!!m,[Ie,st,ve]=await Promise.all([mt?dP(De,{limit:25,cursorMode:!0,cursor:me?f:void 0}):Promise.resolve(null),Pt?mP(De,{limit:25,cursorMode:!0,cursor:me?j:void 0}):Promise.resolve(null),we?xP(De,{limit:25,cursorMode:!0,cursor:me?m:void 0}):Promise.resolve(null)]),Ue=mt?Le(Ie.data):{items:[],nextCursor:null,hasMore:!1},Se=Pt?Le(st.data):{items:[],nextCursor:null,hasMore:!1},it=we?Le(ve.data):{items:[],nextCursor:null,hasMore:!1};me?(mt?(c(xe=>[...xe,...Ue.items]),v(Ue.nextCursor),N(Ue.hasMore)):N(!1),Pt?(d(xe=>[...xe,...Se.items]),_(Se.nextCursor),E(Se.hasMore)):E(!1),we?(h(xe=>[...xe,...it.items]),y(it.nextCursor),I(it.hasMore)):I(!1)):(c(Ue.items),d(Se.items),h(it.items),v(Ue.nextCursor),_(Se.nextCursor),y(it.nextCursor),N(Ue.hasMore),E(Se.hasMore),I(it.hasMore),P("Live  now"))}catch(De){o(((be=(se=De.response)==null?void 0:se.data)==null?void 0:be.message)||"Failed to load requests")}finally{i(!1)}};g.useEffect(()=>{try{const ne=localStorage.getItem(Ja);if(!ne){P("Live  now"),W(!0);return}const me=JSON.parse(ne),se=me==null?void 0:me[fe];if(!se||typeof se!="object"){P("Live  now"),W(!0);return}const be=Date.now()-new Date(se.updatedAt||0).getTime();if(!Number.isFinite(be)||be<0||be>xL){P("Live  now"),W(!0);return}const De=Math.max(0,Math.floor(be/6e4));se.statusFilter&&L(se.statusFilter),Array.isArray(se.leave)&&c(se.leave),Array.isArray(se.overtime)&&d(se.overtime),Array.isArray(se.shifts)&&h(se.shifts),(typeof se.leaveCursor=="string"||se.leaveCursor===null)&&v(se.leaveCursor),(typeof se.overtimeCursor=="string"||se.overtimeCursor===null)&&_(se.overtimeCursor),(typeof se.shiftCursor=="string"||se.shiftCursor===null)&&y(se.shiftCursor),typeof se.hasMoreLeave=="boolean"&&N(se.hasMoreLeave),typeof se.hasMoreOvertime=="boolean"&&E(se.hasMoreOvertime),typeof se.hasMoreShift=="boolean"&&I(se.hasMoreShift),P(`Cached  ${De}m ago`),V.current=!0}catch{}finally{W(!0)}},[fe]),g.useEffect(()=>{if(B){if(V.current){V.current=!1;return}F(T,{append:!1})}},[B,T]),g.useEffect(()=>{const ne=new URLSearchParams(n.search),me=String(ne.get("status")||"").toUpperCase();["PENDING","APPROVED","REJECTED"].includes(me)&&L(me);const se=window.location.hash;if(!se)return;const be=document.getElementById(se.replace("#",""));be&&setTimeout(()=>be.scrollIntoView({behavior:"smooth"}),150)},[n.search]),g.useEffect(()=>{if(B)try{const ne=localStorage.getItem(Ja),me=ne?JSON.parse(ne):{};me[fe]={statusFilter:T,leave:l,overtime:u,shifts:p,leaveCursor:f,overtimeCursor:j,shiftCursor:m,hasMoreLeave:b,hasMoreOvertime:A,hasMoreShift:R,updatedAt:new Date().toISOString()},localStorage.setItem(Ja,JSON.stringify(me))}catch{}},[B,fe,T,l,u,p,f,j,m,b,A,R]);const Z=g.useMemo(()=>[...l.map(me=>({...me,kind:"Leave"})),...u.map(me=>({...me,kind:"Overtime"})),...p.map(me=>({...me,kind:"Shift"}))].sort((me,se)=>new Date(se.createdAt)-new Date(me.createdAt)),[l,u,p]),Y=async ne=>{var me,se;ne.preventDefault(),i(!0),o(null);try{await hP({type:K.type,startDate:K.startDate,endDate:K.endDate,reason:K.reason}),ce({type:"Annual",startDate:"",endDate:"",reason:""}),await F(T,{append:!1}),o(" Leave request submitted")}catch(be){o(((se=(me=be.response)==null?void 0:me.data)==null?void 0:se.message)||"Failed to submit leave request")}finally{i(!1)}},ye=async ne=>{var me,se;ne.preventDefault(),i(!0),o(null);try{await gP({hours:Number(M.hours),date:M.date,reason:M.reason}),X({hours:"",date:"",reason:""}),await F(T,{append:!1}),o(" Overtime request submitted")}catch(be){o(((se=(me=be.response)==null?void 0:me.data)==null?void 0:se.message)||"Failed to submit overtime request")}finally{i(!1)}},ge=async ne=>{var me,se;ne.preventDefault(),i(!0),o(null);try{await jP({shiftType:ae.shiftType,date:ae.date,reason:ae.reason}),pe({shiftType:"Day",date:"",reason:""}),await F(T,{append:!1}),o(" Shift request submitted")}catch(be){o(((se=(me=be.response)==null?void 0:me.data)==null?void 0:se.message)||"Failed to submit shift request")}finally{i(!1)}},Ke=Z.filter(ne=>T==="ALL"?!0:ne.status===T),Ae=()=>{const me=[["Type","Category","Status","Requested","Details"],...Ke.map(De=>[De.kind,De.type||De.shiftType||`${De.hours} hrs`,De.status,De.createdAt?new Date(De.createdAt).toLocaleDateString():"-",De.reason||""])].map(De=>De.map(mt=>`"${String(mt).replace(/"/g,'""')}"`).join(",")).join(`
`),se=new Blob([me],{type:"text/csv"}),be=document.createElement("a");be.href=URL.createObjectURL(se),be.download="my-requests.csv",be.click()},Fe=async()=>{try{const ne=localStorage.getItem(Ja),me=ne?JSON.parse(ne):{};delete me[fe],localStorage.setItem(Ja,JSON.stringify(me))}catch{}L("ALL"),c([]),d([]),h([]),v(null),_(null),y(null),N(!1),E(!1),I(!1),await F("ALL",{append:!1}),P("Live  now"),o("View reset and reloaded from server")};return s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"My Requests"}),s.jsx("p",{className:"muted",children:"Submit leave, overtime, or shift requests and track approvals."})]}),s.jsxs("div",{className:"welcome-actions",children:[s.jsx("button",{className:"btn-secondary",onClick:()=>F(T,{append:!1}),disabled:r,children:"Refresh"}),s.jsx("button",{className:"btn-secondary",onClick:Fe,disabled:r,children:"Reset View"}),s.jsx("span",{className:"muted",children:z}),((e==null?void 0:e.role)==="HOSPITAL_ADMIN"||(e==null?void 0:e.role)==="SUPER_ADMIN")&&s.jsx("button",{className:"btn-primary",onClick:()=>t("/hospital-admin/approvals"),children:"View Approvals"})]})]}),a&&s.jsx("div",{className:"card",children:a}),s.jsxs("section",{className:"section",id:"leave",children:[s.jsx("h3",{children:"Leave Request"}),s.jsxs("form",{className:"card form",onSubmit:Y,children:[s.jsxs("select",{value:K.type,onChange:ne=>ce({...K,type:ne.target.value}),children:[s.jsx("option",{value:"Annual",children:"Annual"}),s.jsx("option",{value:"Sick",children:"Sick"}),s.jsx("option",{value:"Study",children:"Study"}),s.jsx("option",{value:"Maternity",children:"Maternity"}),s.jsx("option",{value:"Paternity",children:"Paternity"}),s.jsx("option",{value:"Compassionate",children:"Compassionate"})]}),s.jsx("input",{type:"date",value:K.startDate,onChange:ne=>ce({...K,startDate:ne.target.value}),required:!0}),s.jsx("input",{type:"date",value:K.endDate,onChange:ne=>ce({...K,endDate:ne.target.value}),required:!0}),s.jsx("input",{placeholder:"Reason (optional)",value:K.reason,onChange:ne=>ce({...K,reason:ne.target.value})}),s.jsx("button",{disabled:r,children:r?"Submitting...":"Submit Leave"})]})]}),s.jsxs("section",{className:"section",id:"overtime",children:[s.jsx("h3",{children:"Overtime Request"}),s.jsxs("form",{className:"card form",onSubmit:ye,children:[s.jsx("input",{type:"number",min:"1",placeholder:"Hours",value:M.hours,onChange:ne=>X({...M,hours:ne.target.value}),required:!0}),s.jsx("input",{type:"date",value:M.date,onChange:ne=>X({...M,date:ne.target.value}),required:!0}),s.jsx("input",{placeholder:"Reason (optional)",value:M.reason,onChange:ne=>X({...M,reason:ne.target.value})}),s.jsx("button",{disabled:r,children:r?"Submitting...":"Submit Overtime"})]})]}),s.jsxs("section",{className:"section",id:"shift",children:[s.jsx("h3",{children:"Shift Request"}),s.jsxs("form",{className:"card form",onSubmit:ge,children:[s.jsxs("select",{value:ae.shiftType,onChange:ne=>pe({...ae,shiftType:ne.target.value}),children:[s.jsx("option",{value:"Day",children:"Day Shift"}),s.jsx("option",{value:"Night",children:"Night Shift"}),s.jsx("option",{value:"On-Call",children:"On-Call"}),s.jsx("option",{value:"Weekend",children:"Weekend"})]}),s.jsx("input",{type:"date",value:ae.date,onChange:ne=>pe({...ae,date:ne.target.value}),required:!0}),s.jsx("input",{placeholder:"Reason (optional)",value:ae.reason,onChange:ne=>pe({...ae,reason:ne.target.value})}),s.jsx("button",{disabled:r,children:r?"Submitting...":"Submit Shift"})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"My Recent Requests"}),s.jsxs("div",{className:"card",children:[s.jsxs("div",{className:"action-list",style:{marginBottom:12},children:[s.jsxs("select",{value:T,onChange:ne=>L(ne.target.value),children:[s.jsx("option",{value:"ALL",children:"All Statuses"}),s.jsx("option",{value:"PENDING",children:"Pending"}),s.jsx("option",{value:"APPROVED",children:"Approved"}),s.jsx("option",{value:"REJECTED",children:"Rejected"})]}),s.jsx("button",{className:"btn-secondary",onClick:Ae,children:"Export CSV"})]}),s.jsxs("table",{className:"table lite",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Type"}),s.jsx("th",{children:"Category"}),s.jsx("th",{children:"Status"}),s.jsx("th",{children:"Requested"}),s.jsx("th",{children:"Details"})]})}),s.jsxs("tbody",{children:[Ke.map(ne=>s.jsxs("tr",{children:[s.jsx("td",{children:ne.kind}),s.jsx("td",{children:ne.type||ne.shiftType||`${ne.hours} hrs`}),s.jsx("td",{children:ne.status}),s.jsx("td",{children:ne.createdAt?new Date(ne.createdAt).toLocaleDateString():"-"}),s.jsx("td",{children:ne.reason||"-"})]},ne._id)),Ke.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:"5",children:"No requests yet"})})]})]}),(b||A||R)&&s.jsx("div",{style:{marginTop:12},children:s.jsx("button",{className:"btn-secondary",disabled:r,onClick:()=>F(T,{append:!0}),children:r?"Loading...":"Load more"})})]})]})]})}const J0=async()=>(await ue.get("/api/integrations/dlq-inspect")).data,uf=async e=>(await ue.post(`/api/integrations/dlq/${e}/retry`)).data,bL=async(e,t)=>(await ue.put(`/api/integrations/dlq-inspect/${e}`,{data:t})).data;function wL(){const[e,t]=g.useState([]),[n,r]=g.useState(!1),[i,a]=g.useState(null),[o,l]=g.useState(null),[c,u]=g.useState(""),d=async()=>{r(!0),a(null);try{const f=await J0();t(Array.isArray(f)?f:[])}catch{t([]),a("Failed to load DLQ items")}finally{r(!1)}};g.useEffect(()=>{d()},[]);const p=f=>{l(f),u(JSON.stringify(f.data||{},null,2))},h=async(f=!1)=>{if(o)try{const v=JSON.parse(c);await bL(o.id,v),f&&await uf(o.id),a(" Payload updated"),l(null),d()}catch{a("Invalid JSON payload")}};return s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"Queue Replay"}),s.jsx("p",{className:"muted",children:"Inspect deadletter queue entries and replay them into the integration queue."})]}),s.jsx("div",{className:"welcome-actions",children:s.jsx("button",{className:"btn-secondary",onClick:d,disabled:n,children:"Refresh"})})]}),i&&s.jsx("div",{className:"card",children:i}),s.jsx("section",{className:"section",children:s.jsx("div",{className:"card",children:s.jsxs("table",{className:"table lite",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"ID"}),s.jsx("th",{children:"Reason"}),s.jsx("th",{children:"Attempts"}),s.jsx("th",{children:"Queued"}),s.jsx("th",{children:"Actions"})]})}),s.jsxs("tbody",{children:[e.map(f=>s.jsxs("tr",{children:[s.jsx("td",{children:f.id}),s.jsx("td",{children:f.failedReason||"-"}),s.jsx("td",{children:f.attemptsMade||0}),s.jsx("td",{children:f.timestamp?new Date(f.timestamp).toLocaleString():"-"}),s.jsxs("td",{children:[s.jsx("button",{className:"btn-secondary",onClick:async()=>{await uf(f.id),d()},children:"Replay"}),s.jsx("button",{className:"btn-secondary",onClick:()=>p(f),children:"Edit"})]})]},f.id)),e.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:"5",children:"No DLQ items"})})]})]})})}),o&&s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Edit Payload"}),s.jsxs("div",{className:"card",children:[s.jsx("textarea",{rows:12,style:{width:"100%"},value:c,onChange:f=>u(f.target.value)}),s.jsxs("div",{className:"action-list",style:{marginTop:12},children:[s.jsx("button",{className:"btn-secondary",onClick:()=>h(!1),children:"Save"}),s.jsx("button",{className:"btn-primary",onClick:()=>h(!0),children:"Save & Replay"}),s.jsx("button",{className:"btn-secondary",onClick:()=>l(null),children:"Cancel"})]})]})]})]})}function SL(){const[e,t]=g.useState([]),[n,r]=g.useState(!1),[i,a]=g.useState(null),o=async()=>{r(!0),a(null);try{const l=await J0(),c=(Array.isArray(l)?l:[]).filter(u=>{var d,p;return((d=u==null?void 0:u.data)==null?void 0:d.connectorId)||((p=u==null?void 0:u.data)==null?void 0:p.payload)});t(c)}catch{t([]),a("Failed to load webhook retries")}finally{r(!1)}};return g.useEffect(()=>{o()},[]),s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"Webhook Retry"}),s.jsx("p",{className:"muted",children:"Retry failed webhook payloads from the integration DLQ."})]}),s.jsx("div",{className:"welcome-actions",children:s.jsx("button",{className:"btn-secondary",onClick:o,disabled:n,children:"Refresh"})})]}),i&&s.jsx("div",{className:"card",children:i}),s.jsx("section",{className:"section",children:s.jsx("div",{className:"card",children:s.jsxs("table",{className:"table lite",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"ID"}),s.jsx("th",{children:"Connector"}),s.jsx("th",{children:"Reason"}),s.jsx("th",{children:"Attempts"}),s.jsx("th",{children:"Actions"})]})}),s.jsxs("tbody",{children:[e.map(l=>{var c;return s.jsxs("tr",{children:[s.jsx("td",{children:l.id}),s.jsx("td",{children:((c=l==null?void 0:l.data)==null?void 0:c.connectorId)||"-"}),s.jsx("td",{children:l.failedReason||"-"}),s.jsx("td",{children:l.attemptsMade||0}),s.jsx("td",{children:s.jsx("button",{className:"btn-secondary",onClick:async()=>{await uf(l.id),o()},children:"Retry Webhook"})})]},l.id)}),e.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:"5",children:"No webhook retries queued"})})]})]})})})]})}function EL(){var a,o,l,c;const[e,t]=g.useState(null),[n,r]=g.useState(""),i=async()=>{r("");try{const u=await $_();t(u||null)}catch(u){r((u==null?void 0:u.message)||"Failed to load decision cockpit"),t(null)}};return g.useEffect(()=>{i()},[]),s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"Decision Cockpit"}),s.jsx("p",{className:"muted",children:"Operational anomalies, trust signals and next best actions."})]}),s.jsx("div",{className:"welcome-actions",children:s.jsx("button",{className:"btn-secondary",onClick:i,children:"Refresh"})})]}),n&&s.jsx("div",{className:"card",children:n}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Key Totals"}),s.jsxs("div",{className:"grid info-grid",children:[s.jsx(te,{title:"DLQ Failed",value:((a=e==null?void 0:e.totals)==null?void 0:a.dlqFailed)??""}),s.jsx(te,{title:"Workforce Pending",value:((o=e==null?void 0:e.totals)==null?void 0:o.workforcePending)??""}),s.jsx(te,{title:"ABAC Denials (24h)",value:((l=e==null?void 0:e.totals)==null?void 0:l.abacDenials24h)??""})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Anomalies"}),s.jsxs("div",{className:"panel-grid",children:[((e==null?void 0:e.anomalies)||[]).map(u=>s.jsxs("div",{className:"card",children:[s.jsx("strong",{children:u.title}),s.jsxs("p",{className:"muted",children:["Severity: ",u.severity," | Metric: ",u.metric]}),s.jsx("p",{children:u.why}),s.jsxs("p",{children:[s.jsx("strong",{children:"Action:"})," ",u.action]})]},u.id)),!((c=e==null?void 0:e.anomalies)!=null&&c.length)&&s.jsx("div",{className:"card muted",children:"No anomalies detected."})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Recommendations"}),s.jsx("div",{className:"panel-grid",children:((e==null?void 0:e.recommendations)||[]).map((u,d)=>{var p,h;return s.jsxs("div",{className:"card",children:[s.jsx("strong",{children:((h=(p=u.type)==null?void 0:p.toUpperCase)==null?void 0:h.call(p))||"RECOMMENDATION"}),s.jsx("p",{children:u.text})]},`rec-${d}`)})})]})]})}const NL=async(e={})=>{const t=new URLSearchParams;e.status&&t.set("status",e.status),e.limit&&t.set("limit",String(e.limit)),e.page&&t.set("page",String(e.page)),e.cursor&&t.set("cursor",e.cursor);const n=t.toString();return(await ue.get(`/api/transfers${n?`?${n}`:""}`)).data},_L=async({transferId:e,payload:t,signature:n})=>(await ue.post(`/api/transfers/${e}/provenance/verify`,{payload:t,signature:n})).data;function AL(){const[e,t]=g.useState([]),[n,r]=g.useState(""),[i,a]=g.useState("{}"),[o,l]=g.useState(""),[c,u]=g.useState(!1),[d,p]=g.useState(""),[h,f]=g.useState(null),v=async()=>{var _;try{const m=await NL({limit:50}),y=Array.isArray(m==null?void 0:m.items)?m.items:[];t(y),!n&&((_=y[0])!=null&&_._id)&&r(y[0]._id)}catch{t([])}};g.useEffect(()=>{v()},[]);const j=async()=>{u(!0),p(""),f(null);try{const _=JSON.parse(i||"{}"),m=await _L({transferId:n,payload:_,signature:o});f(m)}catch(_){p((_==null?void 0:_.message)||"Failed to verify provenance")}finally{u(!1)}};return s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"Transfer Provenance Verify"}),s.jsx("p",{className:"muted",children:"Verify signed transfer payload integrity for receiving hospitals."})]}),s.jsx("div",{className:"welcome-actions",children:s.jsx("button",{className:"btn-secondary",onClick:v,children:"Refresh Transfers"})})]}),d&&s.jsx("div",{className:"card",children:d}),s.jsx("section",{className:"section",children:s.jsxs("div",{className:"card",children:[s.jsx("label",{children:"Transfer"}),s.jsx("select",{value:n,onChange:_=>r(_.target.value),children:e.map(_=>s.jsxs("option",{value:_._id,children:[_._id,"  ",_.status]},_._id))}),s.jsx("label",{style:{marginTop:12},children:"Payload (JSON)"}),s.jsx("textarea",{rows:8,value:i,onChange:_=>a(_.target.value)}),s.jsx("label",{style:{marginTop:12},children:"Signature"}),s.jsx("input",{type:"text",value:o,onChange:_=>l(_.target.value),placeholder:"X-AfyaLink-Provenance signature"}),s.jsx("div",{className:"welcome-actions",children:s.jsx("button",{className:"btn-primary",onClick:j,disabled:c||!n||!o,children:c?"Verifying...":"Verify Signature"})})]})}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Verification Result"}),s.jsx("div",{className:"card",children:h?s.jsx("pre",{style:{whiteSpace:"pre-wrap",margin:0},children:JSON.stringify(h,null,2)}):s.jsx("p",{className:"muted",children:"No verification result yet."})})]})]})}const CL=async(e={})=>{const t=new URLSearchParams;e.action&&t.set("action",e.action),e.limit&&t.set("limit",String(e.limit)),e.hospital&&t.set("hospital",String(e.hospital));const n=t.toString();return(await ue.get(`/api/ai_admin/list${n?`?${n}`:""}`)).data},kL=["AI_DOCUMENT_EXTRACTED","AI_DOCUMENT_EXTRACTION_FAILED","AI_DIGITAL_TWIN_RUN"];function IL(){const[e,t]=g.useState([]),[n,r]=g.useState(!1),[i,a]=g.useState(""),[o,l]=g.useState({action:"AI_DOCUMENT_EXTRACTED",hospital:"",limit:100}),[c,u]=g.useState(""),d=async(h=o)=>{r(!0),a("");try{const f=await CL(h);t(Array.isArray(f==null?void 0:f.items)?f.items:[])}catch(f){a((f==null?void 0:f.message)||"Failed to load extraction history"),t([])}finally{r(!1)}};g.useEffect(()=>{d()},[]);const p=e.filter(h=>{var y,b,N,A,E;const f=String(c||"").trim().toLowerCase();if(!f)return!0;const v=`${((y=h.actor)==null?void 0:y.name)||""} ${((b=h.actor)==null?void 0:b.email)||""}`.toLowerCase(),j=String(((N=h.metadata)==null?void 0:N.filename)||"").toLowerCase(),_=String(((A=h.metadata)==null?void 0:A.mimeType)||"").toLowerCase(),m=String(((E=h.metadata)==null?void 0:E.provider)||"").toLowerCase();return v.includes(f)||j.includes(f)||_.includes(f)||m.includes(f)});return s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"AI Extraction History"}),s.jsx("p",{className:"muted",children:"Audit trail of NeuroEdge document extraction operations."})]}),s.jsx("div",{className:"welcome-actions",children:s.jsx("button",{className:"btn-secondary",onClick:d,disabled:n,children:"Refresh"})})]}),i&&s.jsx("div",{className:"card",children:i}),s.jsxs("section",{className:"section",children:[s.jsxs("div",{className:"card",style:{marginBottom:12},children:[s.jsxs("div",{className:"grid info-grid",children:[s.jsxs("label",{children:["Action",s.jsx("select",{value:o.action,onChange:h=>l(f=>({...f,action:h.target.value})),children:kL.map(h=>s.jsx("option",{value:h,children:h},h))})]}),s.jsxs("label",{children:["Hospital Id",s.jsx("input",{value:o.hospital,onChange:h=>l(f=>({...f,hospital:h.target.value})),placeholder:"Optional hospital id"})]}),s.jsxs("label",{children:["Limit",s.jsx("select",{value:o.limit,onChange:h=>l(f=>({...f,limit:Number(h.target.value)})),children:[25,50,100,200].map(h=>s.jsx("option",{value:h,children:h},h))})]}),s.jsxs("label",{children:["Search",s.jsx("input",{value:c,onChange:h=>u(h.target.value),placeholder:"actor, file, provider, mime"})]})]}),s.jsxs("div",{className:"welcome-actions",style:{marginTop:10},children:[s.jsx("button",{className:"btn-primary",onClick:()=>d(o),disabled:n,children:"Apply Filters"}),s.jsx("button",{className:"btn-secondary",onClick:()=>{const h={action:"AI_DOCUMENT_EXTRACTED",hospital:"",limit:100};l(h),u(""),d(h)},disabled:n,children:"Reset"})]})]}),s.jsx("div",{className:"card",children:s.jsxs("table",{className:"table lite",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Time"}),s.jsx("th",{children:"Actor"}),s.jsx("th",{children:"Role"}),s.jsx("th",{children:"Filename"}),s.jsx("th",{children:"MimeType"}),s.jsx("th",{children:"Size"}),s.jsx("th",{children:"Provider"}),s.jsx("th",{children:"Status"})]})}),s.jsxs("tbody",{children:[p.map(h=>{var f,v,j,_,m,y,b;return s.jsxs("tr",{children:[s.jsx("td",{children:h.createdAt?new Date(h.createdAt).toLocaleString():"-"}),s.jsx("td",{children:((f=h.actor)==null?void 0:f.name)||((v=h.actor)==null?void 0:v.email)||"-"}),s.jsx("td",{children:((j=h.actor)==null?void 0:j.role)||"-"}),s.jsx("td",{children:((_=h.metadata)==null?void 0:_.filename)||"-"}),s.jsx("td",{children:((m=h.metadata)==null?void 0:m.mimeType)||"-"}),s.jsx("td",{children:((y=h.metadata)==null?void 0:y.size)||"-"}),s.jsx("td",{children:((b=h.metadata)==null?void 0:b.provider)||"-"}),s.jsx("td",{children:h.success?"Success":h.error||"Failed"})]},h.id)}),p.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:"8",children:"No extraction logs found"})})]})]})})]})]})}function RL(){return s.jsxs("div",{style:{padding:24},children:[s.jsx("h1",{style:{fontSize:24,fontWeight:700,marginBottom:20},children:"Admin Tools"}),s.jsxs("div",{className:"grid",style:{marginBottom:24},children:[s.jsx(te,{title:"Audit Logs",value:"Live",subtitle:"Security events"}),s.jsx(te,{title:"Admin Accounts",value:"Manage",subtitle:"Create and review"}),s.jsx(te,{title:"System Access",value:"RBAC",subtitle:"Role governance"})]}),s.jsxs("div",{style:{display:"flex",gap:12},children:[s.jsx(ui,{to:"/admin/audit-logs",children:"Open Audit Logs"}),s.jsx(ui,{to:"/admin/create-admin",children:"Create Admin"})]})]})}async function TL(e={}){const t=new URLSearchParams(e).toString();return await le(`/api/audit?${t}`)}function OL(){const[e,t]=g.useState([]),[n,r]=g.useState({}),[i,a]=g.useState(!0),o=async()=>{a(!0);const c=await TL(n);t(c.data),a(!1)};g.useEffect(()=>{o()},[]);const l=()=>{const u=`time,actor,action,resource,success,ip
`+e.map(h=>{var f;return{time:new Date(h.createdAt).toISOString(),actor:(f=h.actorId)==null?void 0:f.email,action:h.action,resource:h.resource,success:h.success,ip:h.ip}}).map(h=>Object.values(h).join(",")).join(`
`),d=new Blob([u],{type:"text/csv"}),p=document.createElement("a");p.href=URL.createObjectURL(d),p.download="audit-logs.csv",p.click()};return s.jsxs("div",{className:"card",children:[s.jsx("h2",{children:" Audit Logs"}),s.jsxs("div",{className:"row",children:[s.jsx("input",{placeholder:"Action",onChange:c=>r({...n,action:c.target.value})}),s.jsx("input",{placeholder:"Resource",onChange:c=>r({...n,resource:c.target.value})}),s.jsx("button",{onClick:o,children:"Filter"}),s.jsx("button",{onClick:l,children:"Export CSV"})]}),i?s.jsx("p",{children:"Loading..."}):s.jsxs("table",{children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Time"}),s.jsx("th",{children:"Actor"}),s.jsx("th",{children:"Action"}),s.jsx("th",{children:"Resource"}),s.jsx("th",{children:"Success"}),s.jsx("th",{children:"IP"})]})}),s.jsx("tbody",{children:e.map(c=>{var u;return s.jsxs("tr",{children:[s.jsx("td",{children:new Date(c.createdAt).toLocaleString()}),s.jsx("td",{children:(u=c.actorId)==null?void 0:u.email}),s.jsx("td",{children:c.action}),s.jsx("td",{children:c.resource}),s.jsx("td",{children:c.success?"":""}),s.jsx("td",{children:c.ip})]},c._id)})})]})]})}function PL(){const{user:e}=Me(),[t,n]=g.useState([]),[r,i]=g.useState(""),[a,o]=g.useState({name:"",email:"",password:"",role:"HOSPITAL_ADMIN",hospitalId:""}),[l,c]=g.useState(!1),[u,d]=g.useState(null);if((e==null?void 0:e.role)!=="SUPER_ADMIN")return s.jsx("p",{children:" Access denied"});xa.useEffect(()=>{W0().then(f=>{const v=Array.isArray(f)?f:Array.isArray(f==null?void 0:f.hospitals)?f.hospitals:Array.isArray(f==null?void 0:f.items)?f.items:[];n(v)}).catch(()=>n([]))},[]);const p=g.useMemo(()=>{const f=r.trim().toLowerCase();return f?t.filter(v=>String((v==null?void 0:v.name)||"").toLowerCase().includes(f)):t},[t,r]),h=async f=>{var v;f.preventDefault(),c(!0),d(null);try{a.role==="SYSTEM_ADMIN"?(await Y0({name:a.name,email:a.email,password:a.password}),d(" System admin created")):a.role==="DEVELOPER"?(await K0({name:a.name,email:a.email,password:a.password}),d(" Developer created")):(await G0({name:a.name,email:a.email,password:a.password,hospitalId:a.hospitalId}),d(" Hospital admin created")),o({name:"",email:"",password:"",role:"HOSPITAL_ADMIN",hospitalId:""}),i("")}catch(j){d(((v=j==null?void 0:j.data)==null?void 0:v.msg)||(j==null?void 0:j.message)||"Failed to create admin")}finally{c(!1)}};return s.jsxs("div",{className:"card",children:[s.jsx("h2",{children:" Create Admin"}),s.jsxs("form",{onSubmit:h,className:"form",children:[s.jsx("input",{placeholder:"Full name",value:a.name,required:!0,onChange:f=>o({...a,name:f.target.value})}),s.jsx("input",{placeholder:"Email address",type:"email",value:a.email,required:!0,onChange:f=>o({...a,email:f.target.value})}),s.jsx("input",{placeholder:"Temporary password",type:"password",value:a.password,required:!0,onChange:f=>o({...a,password:f.target.value})}),s.jsxs("select",{value:a.role,onChange:f=>o({...a,role:f.target.value}),children:[s.jsx("option",{value:"HOSPITAL_ADMIN",children:"Hospital Admin"}),s.jsx("option",{value:"SYSTEM_ADMIN",children:"System Admin"}),s.jsx("option",{value:"DEVELOPER",children:"Developer"})]}),a.role==="HOSPITAL_ADMIN"&&s.jsxs(s.Fragment,{children:[s.jsx("input",{list:"hospital-options",placeholder:"Type hospital name",value:r,onChange:f=>{const v=f.target.value;i(v);const j=t.find(_=>String((_==null?void 0:_.name)||"").toLowerCase()===v.trim().toLowerCase());o({...a,hospitalId:(j==null?void 0:j._id)||""})},required:!0}),s.jsx("datalist",{id:"hospital-options",children:t.map(f=>s.jsx("option",{value:f.name},f._id))}),s.jsxs("select",{value:a.hospitalId,onChange:f=>{const v=f.target.value,j=t.find(_=>String(_._id)===String(v));o({...a,hospitalId:v}),j!=null&&j.name&&i(j.name)},required:!0,children:[s.jsx("option",{value:"",children:t.length?"Select hospital":"No hospitals available"}),p.map(f=>s.jsx("option",{value:f._id,children:f.name},f._id))]})]}),s.jsx("button",{disabled:l,children:l?"Creating...":"Create Admin"})]}),u&&s.jsx("p",{style:{marginTop:10},children:u})]})}function LL(){const{user:e}=Me(),t=Re(),[n,r]=g.useState(!1),[i,a]=g.useState([]),[o,l]=g.useState(null),[c,u]=g.useState(()=>{try{return JSON.parse(localStorage.getItem("dismissed_reminders")||"[]")}catch{return[]}}),d=h=>{switch(h){case"DOCTOR":return"/api/dashboard/doctor";case"NURSE":return"/api/dashboard/nurse";case"LAB_TECH":return"/api/dashboard/lab-tech";case"HR_MANAGER":return"/api/dashboard/hr";case"PAYROLL_OFFICER":return"/api/dashboard/payroll";case"HOSPITAL_ADMIN":return"/api/dashboard/hospital-admin";case"SECURITY_ADMIN":return"/api/dashboard/security-admin";case"SECURITY_OFFICER":return"/api/dashboard/security-officer";case"PATIENT":return"/api/dashboard/patient";case"SUPER_ADMIN":return"/api/dashboard/super-admin";case"RADIOLOGIST":case"THERAPIST":case"RECEPTIONIST":return"/api/dashboard/staff";default:return null}};g.useEffect(()=>{const h=f=>{const v=(f==null?void 0:f.detail)||{};l({code:v.code||"SESSION_SECURITY",message:v.message||"Additional verification is required."}),t("/step-up")};return window.addEventListener("afyalink:session-security",h),()=>{window.removeEventListener("afyalink:session-security",h)}},[t]),g.useEffect(()=>{let h=!0;if(!e)return;le("/api/auth/session-risk").then(j=>{var _;!h||!j||(j.restriction||j.requiresStepUp?(l({code:j.restriction?"SESSION_RESTRICTED":"STEP_UP_REQUIRED",message:((_=j.restriction)==null?void 0:_.reason)==="CRITICAL_LOGIN_RISK"?"Your session is temporarily restricted due to critical login risk. Verify step-up to unlock.":"Step-up verification is required for sensitive actions."}),a(m=>{var b;const y=(m||[]).filter(N=>N.id!=="session-stepup");return[{id:"session-stepup",text:((b=j.restriction)==null?void 0:b.reason)==="CRITICAL_LOGIN_RISK"?"Session restricted. Click to complete step-up verification.":"Sensitive actions require step-up verification. Click to verify.",action:()=>t("/step-up")},...y]})):l(null))}).catch(()=>{});const f=d(e==null?void 0:e.role),v=f?le(f):Promise.resolve(null);return Promise.all([le("/api/profile"),le("/api/2fa/status"),v]).then(([j,_,m])=>{var b,N,A;if(!h)return;const y=[];if(j!=null&&j.emailVerified||y.push({id:"email",text:((b=j==null?void 0:j.verificationWarning)==null?void 0:b.message)||"Your email is not verified. Click to verify in Profile.",action:()=>t("/profile")}),j!=null&&j.phoneVerified||y.push({id:"phone",text:"Verify your phone number to secure your account.",action:()=>t("/profile")}),(!(j!=null&&j.nationalIdNumber)||!(j!=null&&j.nationalIdCountry))&&y.push({id:"id",text:"Add your National ID details to complete your profile.",action:()=>t("/profile")}),_!=null&&_.enabled||y.push({id:"2fa",text:"Enable two-factor authentication for stronger security.",action:()=>t("/profile")}),m){const E=e==null?void 0:e.role;((N=m.pendingRequests)==null?void 0:N.total)>0&&y.push({id:"pending-requests",text:`You have ${m.pendingRequests.total} pending requests.`,action:()=>t(E==="HOSPITAL_ADMIN"?"/hospital-admin/approvals":"/workforce/requests")}),E==="HOSPITAL_ADMIN"&&m.pendingRequests>0&&y.push({id:"pending-approvals",text:`You have ${m.pendingRequests} approvals waiting.`,action:()=>t("/hospital-admin/approvals")}),E==="HR_MANAGER"&&((A=m.pendingRequests)==null?void 0:A.total)>0&&y.push({id:"hr-requests",text:`Workforce requests pending: ${m.pendingRequests.total}.`,action:()=>t("/hr-manager")}),E==="PAYROLL_OFFICER"&&m.pendingApprovals>0&&y.push({id:"payroll-approvals",text:`Payroll approvals pending: ${m.pendingApprovals}.`,action:()=>t("/payroll-officer")}),(E==="PAYROLL_OFFICER"||E==="HOSPITAL_ADMIN"||E==="SUPER_ADMIN")&&m.overduePayroll>0&&y.push({id:"overdue-payroll",text:`Overdue payroll items: ${m.overduePayroll}.`,action:()=>t(E==="PAYROLL_OFFICER"?"/payroll-officer":"/payments")}),E==="SUPER_ADMIN"&&m.pendingRequests>0&&y.push({id:"super-pending",text:`Global approvals pending: ${m.pendingRequests}.`,action:()=>t("/admin/notifications")}),(E==="HOSPITAL_ADMIN"||E==="HR_MANAGER"||E==="SUPER_ADMIN")&&m.incompleteStaff>0&&y.push({id:"incomplete-staff",text:`${m.incompleteStaff} staff records are incomplete.`,action:()=>t(E==="SUPER_ADMIN"?"/super-admin":E==="HR_MANAGER"?"/hr-manager":"/hospital-admin/staff")}),(E==="HOSPITAL_ADMIN"||E==="HR_MANAGER"||E==="SUPER_ADMIN")&&m.inactiveStaff>0&&y.push({id:"inactive-staff",text:`${m.inactiveStaff} staff accounts are inactive.`,action:()=>t(E==="SUPER_ADMIN"?"/super-admin":E==="HR_MANAGER"?"/hr-manager":"/hospital-admin/staff")}),(E==="HOSPITAL_ADMIN"||E==="HR_MANAGER"||E==="SUPER_ADMIN")&&m.missingLicenses>0&&y.push({id:"missing-licenses",text:`${m.missingLicenses} staff are missing license details.`,action:()=>t(E==="SUPER_ADMIN"?"/super-admin":E==="HR_MANAGER"?"/hr-manager":"/hospital-admin/staff")}),["RADIOLOGIST","THERAPIST","RECEPTIONIST"].includes(E)&&m.myPendingRequests>0&&y.push({id:"my-requests",text:`You have ${m.myPendingRequests} pending requests.`,action:()=>t("/workforce/requests")}),m.notificationsUnread>0&&y.push({id:"unread-notifs",text:`You have ${m.notificationsUnread} unread notifications.`,action:()=>t(["SUPER_ADMIN","SYSTEM_ADMIN","HOSPITAL_ADMIN"].includes(E)?"/admin/notifications":"/profile")}),E==="LAB_TECH"&&m.pendingOrders>0&&y.push({id:"lab-orders",text:`${m.pendingOrders} lab orders are pending.`,action:()=>t("/lab-tech")}),E==="NURSE"&&m.pendingLabOrders>0&&y.push({id:"lab-pending",text:`${m.pendingLabOrders} lab orders are pending.`,action:()=>t("/nurse")}),E==="DOCTOR"&&m.upcomingAppointments>0&&y.push({id:"doctor-appts",text:`${m.upcomingAppointments} upcoming appointments.`,action:()=>t("/doctor/appointments")}),E==="PATIENT"&&(m.upcomingAppointments>0&&y.push({id:"patient-appts",text:`${m.upcomingAppointments} upcoming appointments.`,action:()=>t("/patient")}),m.unpaidInvoices>0&&y.push({id:"patient-invoices",text:`${m.unpaidInvoices} unpaid invoices.`,action:()=>t("/payments")})),(E==="SECURITY_ADMIN"||E==="SECURITY_OFFICER")&&m.openIncidents>0&&y.push({id:"security-incidents",text:`${m.openIncidents} security incidents are open.`,action:()=>t(E==="SECURITY_ADMIN"?"/security-admin":"/security-officer")})}a(y)}).catch(()=>{}),()=>{h=!1}},[e==null?void 0:e.id]);const p=h=>{const f=Array.from(new Set([...c||[],h]));u(f),localStorage.setItem("dismissed_reminders",JSON.stringify(f))};return s.jsxs(s.Fragment,{children:[e&&s.jsx(q_,{onToggleSidebar:()=>r(h=>!h)}),e&&n&&s.jsx("button",{className:"sidebar-backdrop","aria-label":"Close navigator",onClick:()=>r(!1)}),s.jsxs("div",{className:`app-grid ${n?"":"sidebar-collapsed"}`,children:[e&&s.jsx(G_,{open:n,onClose:()=>r(!1)}),s.jsxs("main",{className:"main",children:[o&&s.jsxs("button",{className:"verify-banner",onClick:()=>t("/step-up"),children:[o.message,s.jsx("span",{className:"banner-close",role:"button","aria-label":"Dismiss notice",onClick:h=>{h.stopPropagation(),l(null)},children:""})]}),i.filter(h=>!c.includes(h.id)).map(h=>s.jsxs("button",{className:"verify-banner",onClick:h.action,children:[h.text,s.jsx("span",{className:"banner-close",role:"button","aria-label":"Dismiss reminder",onClick:f=>{f.stopPropagation(),p(h.id)},children:""})]},h.id)),s.jsx(fj,{})]})]}),e&&s.jsx(J_,{}),e&&s.jsx(K_,{})]})}function DL(){return s.jsx(R_,{children:s.jsxs(vN,{children:[s.jsx(J,{path:"/",element:s.jsx(vo,{to:"/login",replace:!0})}),s.jsx(J,{path:"/login",element:s.jsx(X_,{})}),s.jsx(J,{path:"/register",element:s.jsx(eA,{})}),s.jsx(J,{path:"/verify-email",element:s.jsx(tA,{})}),s.jsx(J,{path:"/verify-success",element:s.jsx(nA,{})}),s.jsx(J,{path:"/forgot-password",element:s.jsx(rA,{})}),s.jsx(J,{path:"/reset-password",element:s.jsx(sA,{})}),s.jsx(J,{path:"/2fa",element:s.jsx(iA,{})}),s.jsx(J,{path:"/step-up",element:s.jsx(aA,{})}),s.jsx(J,{path:"/unauthorized",element:s.jsx(Ng,{})}),s.jsx(J,{path:"/403",element:s.jsx(Ng,{})}),s.jsxs(J,{element:s.jsx(oe,{children:s.jsx(Z_,{children:s.jsx(LL,{})})}),children:[s.jsx(J,{path:"/patient",element:s.jsx(oe,{roles:["PATIENT","SUPER_ADMIN","DEVELOPER"],children:s.jsx(XO,{})})}),s.jsx(J,{path:"/patient/appointments",element:s.jsx(oe,{roles:["PATIENT","SUPER_ADMIN","DEVELOPER"],children:s.jsx(z1,{})})}),s.jsx(J,{path:"/patient/medical-records",element:s.jsx(oe,{roles:["PATIENT","SUPER_ADMIN","DEVELOPER"],children:s.jsx(W1,{})})}),s.jsx(J,{path:"/patient/prescriptions",element:s.jsx(oe,{roles:["PATIENT","SUPER_ADMIN","DEVELOPER"],children:s.jsx(G1,{})})}),s.jsx(J,{path:"/patient/lab-results",element:s.jsx(oe,{roles:["PATIENT","SUPER_ADMIN","DEVELOPER"],children:s.jsx(Y1,{})})}),s.jsx(J,{path:"/patient/billing",element:s.jsx(oe,{roles:["PATIENT","SUPER_ADMIN","DEVELOPER"],children:s.jsx(K1,{})})}),s.jsx(J,{path:"/patient/insurance",element:s.jsx(oe,{roles:["PATIENT","SUPER_ADMIN","DEVELOPER"],children:s.jsx(J1,{})})}),s.jsx(J,{path:"/patient/feedback",element:s.jsx(oe,{roles:["PATIENT","SUPER_ADMIN","DEVELOPER"],children:s.jsx(Q1,{})})}),s.jsx(J,{path:"/doctor",element:s.jsx(oe,{roles:["DOCTOR","SUPER_ADMIN","DEVELOPER"],children:s.jsx(ZO,{})})}),s.jsx(J,{path:"/nurse",element:s.jsx(oe,{roles:["NURSE","SUPER_ADMIN","DEVELOPER"],children:s.jsx(eP,{})})}),s.jsx(J,{path:"/nurse/shift",element:s.jsx(oe,{roles:["NURSE","SUPER_ADMIN","DEVELOPER"],children:s.jsx(_1,{})})}),s.jsx(J,{path:"/nurse/patients",element:s.jsx(oe,{roles:["NURSE","SUPER_ADMIN","DEVELOPER"],children:s.jsx(A1,{})})}),s.jsx(J,{path:"/nurse/medication",element:s.jsx(oe,{roles:["NURSE","SUPER_ADMIN","DEVELOPER"],children:s.jsx(C1,{})})}),s.jsx(J,{path:"/nurse/incidents",element:s.jsx(oe,{roles:["NURSE","SUPER_ADMIN","DEVELOPER"],children:s.jsx(k1,{})})}),s.jsx(J,{path:"/nurse/vitals",element:s.jsx(oe,{roles:["NURSE","SUPER_ADMIN","DEVELOPER"],children:s.jsx(I1,{})})}),s.jsx(J,{path:"/nurse/leave",element:s.jsx(oe,{roles:["NURSE","SUPER_ADMIN","DEVELOPER"],children:s.jsx(R1,{})})}),s.jsx(J,{path:"/nurse/performance",element:s.jsx(oe,{roles:["NURSE","SUPER_ADMIN","DEVELOPER"],children:s.jsx(T1,{})})}),s.jsx(J,{path:"/lab-tech",element:s.jsx(oe,{roles:["LAB_TECH","SUPER_ADMIN","DEVELOPER"],children:s.jsx(tP,{})})}),s.jsx(J,{path:"/lab-tech/test-queue",element:s.jsx(oe,{roles:["LAB_TECH","SUPER_ADMIN","DEVELOPER"],children:s.jsx(O1,{})})}),s.jsx(J,{path:"/lab-tech/equipment",element:s.jsx(oe,{roles:["LAB_TECH","SUPER_ADMIN","DEVELOPER"],children:s.jsx(P1,{})})}),s.jsx(J,{path:"/lab-tech/samples",element:s.jsx(oe,{roles:["LAB_TECH","SUPER_ADMIN","DEVELOPER"],children:s.jsx(L1,{})})}),s.jsx(J,{path:"/lab-tech/qc",element:s.jsx(oe,{roles:["LAB_TECH","SUPER_ADMIN","DEVELOPER"],children:s.jsx(D1,{})})}),s.jsx(J,{path:"/lab-tech/safety",element:s.jsx(oe,{roles:["LAB_TECH","SUPER_ADMIN","DEVELOPER"],children:s.jsx(M1,{})})}),s.jsx(J,{path:"/lab-tech/archive",element:s.jsx(oe,{roles:["LAB_TECH","SUPER_ADMIN","DEVELOPER"],children:s.jsx(U1,{})})}),s.jsx(J,{path:"/pharmacy",element:s.jsx(oe,{roles:["PHARMACIST","SUPER_ADMIN","DEVELOPER"],children:s.jsx(nP,{})})}),s.jsx(J,{path:"/pharmacy/queue",element:s.jsx(oe,{roles:["PHARMACIST","SUPER_ADMIN","DEVELOPER"],children:s.jsx(B1,{})})}),s.jsx(J,{path:"/pharmacy/inventory",element:s.jsx(oe,{roles:["PHARMACIST","SUPER_ADMIN","DEVELOPER"],children:s.jsx(V1,{})})}),s.jsx(J,{path:"/pharmacy/controlled",element:s.jsx(oe,{roles:["PHARMACIST","SUPER_ADMIN","DEVELOPER"],children:s.jsx($1,{})})}),s.jsx(J,{path:"/pharmacy/expiry",element:s.jsx(oe,{roles:["PHARMACIST","SUPER_ADMIN","DEVELOPER"],children:s.jsx(F1,{})})}),s.jsx(J,{path:"/pharmacy/suppliers",element:s.jsx(oe,{roles:["PHARMACIST","SUPER_ADMIN","DEVELOPER"],children:s.jsx(H1,{})})}),s.jsx(J,{path:"/pharmacy/reports",element:s.jsx(oe,{roles:["PHARMACIST","SUPER_ADMIN","DEVELOPER"],children:s.jsx(q1,{})})}),s.jsx(J,{path:"/staff",element:s.jsx(oe,{roles:["RADIOLOGIST","THERAPIST","RECEPTIONIST","SUPER_ADMIN","DEVELOPER"],children:s.jsx(qP,{})})}),s.jsx(J,{path:"/hr-manager",element:s.jsx(oe,{roles:["HR_MANAGER","SUPER_ADMIN","DEVELOPER"],children:s.jsx(zP,{})})}),s.jsx(J,{path:"/payroll-officer",element:s.jsx(oe,{roles:["PAYROLL_OFFICER","SUPER_ADMIN","DEVELOPER"],children:s.jsx(WP,{})})}),s.jsx(J,{path:"/developer",element:s.jsx(oe,{roles:["DEVELOPER"],children:s.jsx(GP,{})})}),s.jsx(J,{path:"/developer/queue-replay",element:s.jsx(oe,{roles:["DEVELOPER","SUPER_ADMIN"],children:s.jsx(wL,{})})}),s.jsx(J,{path:"/developer/webhook-retry",element:s.jsx(oe,{roles:["DEVELOPER","SUPER_ADMIN"],children:s.jsx(SL,{})})}),s.jsx(J,{path:"/developer/decision-cockpit",element:s.jsx(oe,{roles:["DEVELOPER","SUPER_ADMIN","SYSTEM_ADMIN"],children:s.jsx(EL,{})})}),s.jsx(J,{path:"/developer/provenance-verify",element:s.jsx(oe,{roles:["DEVELOPER","SUPER_ADMIN","SYSTEM_ADMIN"],children:s.jsx(AL,{})})}),s.jsx(J,{path:"/developer/ai-extraction-history",element:s.jsx(oe,{roles:["DEVELOPER","SUPER_ADMIN","SYSTEM_ADMIN"],children:s.jsx(IL,{})})}),s.jsx(J,{path:"/super-admin",element:s.jsx(oe,{roles:["SUPER_ADMIN"],children:s.jsx(rP,{})})}),s.jsx(J,{path:"/super-admin/hospitals",element:s.jsx(oe,{roles:["SUPER_ADMIN","SYSTEM_ADMIN"],children:s.jsx(iP,{})})}),s.jsx(J,{path:"/super-admin/settings",element:s.jsx(oe,{roles:["SUPER_ADMIN","DEVELOPER"],children:s.jsx(lP,{})})}),s.jsx(J,{path:"/system-admin",element:s.jsx(oe,{roles:["SYSTEM_ADMIN","SUPER_ADMIN","DEVELOPER"],children:s.jsx(rL,{})})}),s.jsx(J,{path:"/system-admin/abac",element:s.jsx(oe,{roles:["SYSTEM_ADMIN","SUPER_ADMIN","DEVELOPER"],children:s.jsx(sL,{})})}),s.jsx(J,{path:"/system-admin/mapping-studio",element:s.jsx(oe,{roles:["SYSTEM_ADMIN","SUPER_ADMIN","DEVELOPER"],children:s.jsx(fL,{})})}),s.jsx(J,{path:"/system-admin/nlp-analytics",element:s.jsx(oe,{roles:["SYSTEM_ADMIN","SUPER_ADMIN","DEVELOPER","HOSPITAL_ADMIN","HR_MANAGER","PAYROLL_OFFICER"],children:s.jsx(gL,{})})}),s.jsx(J,{path:"/system-admin/regulatory-reports",element:s.jsx(oe,{roles:["SYSTEM_ADMIN","SUPER_ADMIN","DEVELOPER","HOSPITAL_ADMIN"],children:s.jsx(yL,{})})}),s.jsx(J,{path:"/system-admin/clinical-intelligence",element:s.jsx(oe,{roles:["SYSTEM_ADMIN","SUPER_ADMIN","DEVELOPER","HOSPITAL_ADMIN","HR_MANAGER","DOCTOR","NURSE"],children:s.jsx(vL,{})})}),s.jsx(J,{path:"/hospital-admin",element:s.jsx(oe,{roles:["HOSPITAL_ADMIN","SUPER_ADMIN","DEVELOPER"],children:s.jsx(cP,{})})}),s.jsx(J,{path:"/hospital-admin/register-staff",element:s.jsx(oe,{roles:["HOSPITAL_ADMIN"],children:s.jsx(uP,{})})}),s.jsx(J,{path:"/hospital-admin/approvals",element:s.jsx(oe,{roles:["HOSPITAL_ADMIN","SUPER_ADMIN","SYSTEM_ADMIN","DEVELOPER"],children:s.jsx(VP,{})})}),s.jsx(J,{path:"/hospital-admin/staff",element:s.jsx(oe,{roles:["HOSPITAL_ADMIN","SUPER_ADMIN"],children:s.jsx($P,{})})}),s.jsx(J,{path:"/security-officer",element:s.jsx(oe,{roles:["SECURITY_OFFICER","SUPER_ADMIN","DEVELOPER"],children:s.jsx(FP,{})})}),s.jsx(J,{path:"/security-admin",element:s.jsx(oe,{roles:["SECURITY_ADMIN","SUPER_ADMIN","DEVELOPER"],children:s.jsx(HP,{})})}),s.jsx(J,{path:"/guest",element:s.jsx(oe,{roles:["GUEST"],children:s.jsx(oA,{})})}),s.jsxs(J,{path:"/admin",element:s.jsx(oe,{roles:["SUPER_ADMIN","SYSTEM_ADMIN","HOSPITAL_ADMIN"],children:s.jsx(fj,{})}),children:[s.jsx(J,{index:!0,element:s.jsx(RL,{})}),s.jsx(J,{path:"audit-logs",element:s.jsx(OL,{})}),s.jsx(J,{path:"realtime",element:s.jsx(Z1,{})}),s.jsx(J,{path:"crdt-patients",element:s.jsx(MO,{})}),s.jsx(J,{path:"notifications",element:s.jsx(UO,{})}),s.jsx(J,{path:"payment-settings",element:s.jsx(oe,{roles:["SUPER_ADMIN"],children:s.jsx(BO,{})})}),s.jsx(J,{path:"create-admin",element:s.jsx(oe,{roles:["SUPER_ADMIN"],children:s.jsx(PL,{})})})]}),s.jsx(J,{path:"/profile",element:s.jsx(lA,{})}),s.jsx(J,{path:"/analytics",element:s.jsx(hA,{})}),s.jsx(J,{path:"/reports",element:s.jsx(mA,{})}),s.jsx(J,{path:"/inventory",element:s.jsx(yA,{})}),s.jsx(J,{path:"/payments",element:s.jsx(bA,{})}),s.jsx(J,{path:"/payments/full",element:s.jsx(wA,{})}),s.jsx(J,{path:"/ai/medical",element:s.jsx(SA,{})}),s.jsx(J,{path:"/ai/triage",element:s.jsx(AA,{})}),s.jsx(J,{path:"/ai/voice",element:s.jsx(CA,{})}),s.jsx(J,{path:"/ai/chatbot",element:s.jsx(kA,{})}),s.jsx(J,{path:"/ai/extract",element:s.jsx(RA,{})}),s.jsx(J,{path:"/ai/ws",element:s.jsx(qj,{})}),s.jsx(J,{path:"/workforce/requests",element:s.jsx(oe,{roles:["HOSPITAL_ADMIN","HR_MANAGER","PAYROLL_OFFICER","DOCTOR","NURSE","LAB_TECH","PHARMACIST","RADIOLOGIST","THERAPIST","RECEPTIONIST","SECURITY_ADMIN","SECURITY_OFFICER"],children:s.jsx(jL,{})})}),s.jsx(J,{path:"/doctor/appointments",element:s.jsx(oe,{roles:["DOCTOR","SUPER_ADMIN","DEVELOPER"],children:s.jsx(d1,{})})}),s.jsx(J,{path:"/doctor/schedule",element:s.jsx(oe,{roles:["DOCTOR","SUPER_ADMIN","DEVELOPER"],children:s.jsx(h1,{})})}),s.jsx(J,{path:"/doctor/patients",element:s.jsx(oe,{roles:["DOCTOR","SUPER_ADMIN","DEVELOPER"],children:s.jsx(f1,{})})}),s.jsx(J,{path:"/doctor/opd",element:s.jsx(oe,{roles:["DOCTOR","SUPER_ADMIN","DEVELOPER"],children:s.jsx(p1,{})})}),s.jsx(J,{path:"/doctor/ward",element:s.jsx(oe,{roles:["DOCTOR","SUPER_ADMIN","DEVELOPER"],children:s.jsx(m1,{})})}),s.jsx(J,{path:"/doctor/surgery",element:s.jsx(oe,{roles:["DOCTOR","SUPER_ADMIN","DEVELOPER"],children:s.jsx(g1,{})})}),s.jsx(J,{path:"/doctor/lab-results",element:s.jsx(oe,{roles:["DOCTOR","SUPER_ADMIN","DEVELOPER"],children:s.jsx(y1,{})})}),s.jsx(J,{path:"/doctor/prescriptions",element:s.jsx(oe,{roles:["DOCTOR","SUPER_ADMIN","DEVELOPER"],children:s.jsx(v1,{})})}),s.jsx(J,{path:"/doctor/medical-records",element:s.jsx(oe,{roles:["DOCTOR","SUPER_ADMIN","DEVELOPER"],children:s.jsx(x1,{})})}),s.jsx(J,{path:"/doctor/referrals",element:s.jsx(oe,{roles:["DOCTOR","SUPER_ADMIN","DEVELOPER"],children:s.jsx(j1,{})})}),s.jsx(J,{path:"/doctor/performance",element:s.jsx(oe,{roles:["DOCTOR","SUPER_ADMIN","DEVELOPER"],children:s.jsx(b1,{})})}),s.jsx(J,{path:"/doctor/cme",element:s.jsx(oe,{roles:["DOCTOR","SUPER_ADMIN","DEVELOPER"],children:s.jsx(w1,{})})}),s.jsx(J,{path:"/doctor/leave",element:s.jsx(oe,{roles:["DOCTOR","SUPER_ADMIN","DEVELOPER"],children:s.jsx(S1,{})})}),s.jsx(J,{path:"/doctor/reports-notes",element:s.jsx(oe,{roles:["DOCTOR","SUPER_ADMIN","DEVELOPER"],children:s.jsx(E1,{})})}),s.jsx(J,{path:"/doctor/settings",element:s.jsx(oe,{roles:["DOCTOR","SUPER_ADMIN","DEVELOPER"],children:s.jsx(N1,{})})}),s.jsx(J,{path:"/labtech/labs",element:s.jsx(oe,{roles:["LAB_TECH"],children:s.jsx(zj,{})})}),s.jsx(J,{path:"/superadmin",element:s.jsx(vo,{to:"/super-admin",replace:!0})}),s.jsx(J,{path:"/hospitaladmin",element:s.jsx(vo,{to:"/hospital-admin",replace:!0})})]}),s.jsx(J,{path:"*",element:s.jsx("div",{children:"404  Page not found"})})]})})}const ML="269045019074-0238dca5sn2fq84dp96kilqmf24h24j3.apps.googleusercontent.com";Id.createRoot(document.getElementById("root")).render(s.jsx(xa.StrictMode,{children:s.jsx(RN,{clientId:ML,children:s.jsx(_N,{children:s.jsx(U_,{children:s.jsx(V_,{children:s.jsx(MN,{children:s.jsx(DL,{})})})})})})}));
