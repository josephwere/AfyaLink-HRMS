function Z0(e,t){for(var n=0;n<t.length;n++){const r=t[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in e)){const a=Object.getOwnPropertyDescriptor(r,i);a&&Object.defineProperty(e,i,a.get?a:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(i){if(i.ep)return;i.ep=!0;const a=n(i);fetch(i.href,a)}})();var Xa=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function df(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Gy={exports:{}},Jc={},Yy={exports:{}},ke={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var el=Symbol.for("react.element"),X0=Symbol.for("react.portal"),ew=Symbol.for("react.fragment"),tw=Symbol.for("react.strict_mode"),nw=Symbol.for("react.profiler"),rw=Symbol.for("react.provider"),sw=Symbol.for("react.context"),iw=Symbol.for("react.forward_ref"),aw=Symbol.for("react.suspense"),ow=Symbol.for("react.memo"),lw=Symbol.for("react.lazy"),em=Symbol.iterator;function cw(e){return e===null||typeof e!="object"?null:(e=em&&e[em]||e["@@iterator"],typeof e=="function"?e:null)}var Ky={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Jy=Object.assign,Qy={};function ja(e,t,n){this.props=e,this.context=t,this.refs=Qy,this.updater=n||Ky}ja.prototype.isReactComponent={};ja.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};ja.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Zy(){}Zy.prototype=ja.prototype;function hf(e,t,n){this.props=e,this.context=t,this.refs=Qy,this.updater=n||Ky}var ff=hf.prototype=new Zy;ff.constructor=hf;Jy(ff,ja.prototype);ff.isPureReactComponent=!0;var tm=Array.isArray,Xy=Object.prototype.hasOwnProperty,pf={current:null},ev={key:!0,ref:!0,__self:!0,__source:!0};function tv(e,t,n){var r,i={},a=null,o=null;if(t!=null)for(r in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(a=""+t.key),t)Xy.call(t,r)&&!ev.hasOwnProperty(r)&&(i[r]=t[r]);var l=arguments.length-2;if(l===1)i.children=n;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];i.children=c}if(e&&e.defaultProps)for(r in l=e.defaultProps,l)i[r]===void 0&&(i[r]=l[r]);return{$$typeof:el,type:e,key:a,ref:o,props:i,_owner:pf.current}}function uw(e,t){return{$$typeof:el,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function mf(e){return typeof e=="object"&&e!==null&&e.$$typeof===el}function dw(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var nm=/\/+/g;function _u(e,t){return typeof e=="object"&&e!==null&&e.key!=null?dw(""+e.key):t.toString(36)}function ql(e,t,n,r,i){var a=typeof e;(a==="undefined"||a==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(a){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case el:case X0:o=!0}}if(o)return o=e,i=i(o),e=r===""?"."+_u(o,0):r,tm(i)?(n="",e!=null&&(n=e.replace(nm,"$&/")+"/"),ql(i,t,n,"",function(u){return u})):i!=null&&(mf(i)&&(i=uw(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(nm,"$&/")+"/")+e)),t.push(i)),1;if(o=0,r=r===""?".":r+":",tm(e))for(var l=0;l<e.length;l++){a=e[l];var c=r+_u(a,l);o+=ql(a,t,n,c,i)}else if(c=cw(e),typeof c=="function")for(e=c.call(e),l=0;!(a=e.next()).done;)a=a.value,c=r+_u(a,l++),o+=ql(a,t,n,c,i);else if(a==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function hl(e,t,n){if(e==null)return e;var r=[],i=0;return ql(e,r,"","",function(a){return t.call(n,a,i++)}),r}function hw(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var nn={current:null},zl={transition:null},fw={ReactCurrentDispatcher:nn,ReactCurrentBatchConfig:zl,ReactCurrentOwner:pf};function nv(){throw Error("act(...) is not supported in production builds of React.")}ke.Children={map:hl,forEach:function(e,t,n){hl(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return hl(e,function(){t++}),t},toArray:function(e){return hl(e,function(t){return t})||[]},only:function(e){if(!mf(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};ke.Component=ja;ke.Fragment=ew;ke.Profiler=nw;ke.PureComponent=hf;ke.StrictMode=tw;ke.Suspense=aw;ke.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=fw;ke.act=nv;ke.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=Jy({},e.props),i=e.key,a=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(a=t.ref,o=pf.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)Xy.call(t,c)&&!ev.hasOwnProperty(c)&&(r[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:el,type:e.type,key:i,ref:a,props:r,_owner:o}};ke.createContext=function(e){return e={$$typeof:sw,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:rw,_context:e},e.Consumer=e};ke.createElement=tv;ke.createFactory=function(e){var t=tv.bind(null,e);return t.type=e,t};ke.createRef=function(){return{current:null}};ke.forwardRef=function(e){return{$$typeof:iw,render:e}};ke.isValidElement=mf;ke.lazy=function(e){return{$$typeof:lw,_payload:{_status:-1,_result:e},_init:hw}};ke.memo=function(e,t){return{$$typeof:ow,type:e,compare:t===void 0?null:t}};ke.startTransition=function(e){var t=zl.transition;zl.transition={};try{e()}finally{zl.transition=t}};ke.unstable_act=nv;ke.useCallback=function(e,t){return nn.current.useCallback(e,t)};ke.useContext=function(e){return nn.current.useContext(e)};ke.useDebugValue=function(){};ke.useDeferredValue=function(e){return nn.current.useDeferredValue(e)};ke.useEffect=function(e,t){return nn.current.useEffect(e,t)};ke.useId=function(){return nn.current.useId()};ke.useImperativeHandle=function(e,t,n){return nn.current.useImperativeHandle(e,t,n)};ke.useInsertionEffect=function(e,t){return nn.current.useInsertionEffect(e,t)};ke.useLayoutEffect=function(e,t){return nn.current.useLayoutEffect(e,t)};ke.useMemo=function(e,t){return nn.current.useMemo(e,t)};ke.useReducer=function(e,t,n){return nn.current.useReducer(e,t,n)};ke.useRef=function(e){return nn.current.useRef(e)};ke.useState=function(e){return nn.current.useState(e)};ke.useSyncExternalStore=function(e,t,n){return nn.current.useSyncExternalStore(e,t,n)};ke.useTransition=function(){return nn.current.useTransition()};ke.version="18.3.1";Yy.exports=ke;var m=Yy.exports;const ba=df(m),pw=Z0({__proto__:null,default:ba},[m]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mw=m,gw=Symbol.for("react.element"),yw=Symbol.for("react.fragment"),vw=Object.prototype.hasOwnProperty,xw=mw.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,jw={key:!0,ref:!0,__self:!0,__source:!0};function rv(e,t,n){var r,i={},a=null,o=null;n!==void 0&&(a=""+n),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(o=t.ref);for(r in t)vw.call(t,r)&&!jw.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)i[r]===void 0&&(i[r]=t[r]);return{$$typeof:gw,type:e,key:a,ref:o,props:i,_owner:xw.current}}Jc.Fragment=yw;Jc.jsx=rv;Jc.jsxs=rv;Gy.exports=Jc;var s=Gy.exports,Id={},sv={exports:{}},wn={},iv={exports:{}},av={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(M,X){var ae=M.length;M.push(X);e:for(;0<ae;){var pe=ae-1>>>1,fe=M[pe];if(0<i(fe,X))M[pe]=X,M[ae]=fe,ae=pe;else break e}}function n(M){return M.length===0?null:M[0]}function r(M){if(M.length===0)return null;var X=M[0],ae=M.pop();if(ae!==X){M[0]=ae;e:for(var pe=0,fe=M.length,De=fe>>>1;pe<De;){var F=2*(pe+1)-1,Z=M[F],Y=F+1,ye=M[Y];if(0>i(Z,ae))Y<fe&&0>i(ye,Z)?(M[pe]=ye,M[Y]=ae,pe=Y):(M[pe]=Z,M[F]=ae,pe=F);else if(Y<fe&&0>i(ye,ae))M[pe]=ye,M[Y]=ae,pe=Y;else break e}}return X}function i(M,X){var ae=M.sortIndex-X.sortIndex;return ae!==0?ae:M.id-X.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var c=[],u=[],d=1,p=null,h=3,f=!1,y=!1,j=!1,A=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(M){for(var X=n(u);X!==null;){if(X.callback===null)r(u);else if(X.startTime<=M)r(u),X.sortIndex=X.expirationTime,t(c,X);else break;X=n(u)}}function E(M){if(j=!1,w(M),!y)if(n(c)!==null)y=!0,K(_);else{var X=n(u);X!==null&&ce(E,X.startTime-M)}}function _(M,X){y=!1,j&&(j=!1,g(C),C=-1),f=!0;var ae=h;try{for(w(X),p=n(c);p!==null&&(!(p.expirationTime>X)||M&&!U());){var pe=p.callback;if(typeof pe=="function"){p.callback=null,h=p.priorityLevel;var fe=pe(p.expirationTime<=X);X=e.unstable_now(),typeof fe=="function"?p.callback=fe:p===n(c)&&r(c),w(X)}else r(c);p=n(c)}if(p!==null)var De=!0;else{var F=n(u);F!==null&&ce(E,F.startTime-X),De=!1}return De}finally{p=null,h=ae,f=!1}}var b=!1,R=null,C=-1,T=5,D=-1;function U(){return!(e.unstable_now()-D<T)}function W(){if(R!==null){var M=e.unstable_now();D=M;var X=!0;try{X=R(!0,M)}finally{X?q():(b=!1,R=null)}}else b=!1}var q;if(typeof x=="function")q=function(){x(W)};else if(typeof MessageChannel<"u"){var P=new MessageChannel,V=P.port2;P.port1.onmessage=W,q=function(){V.postMessage(null)}}else q=function(){A(W,0)};function K(M){R=M,b||(b=!0,q())}function ce(M,X){C=A(function(){M(e.unstable_now())},X)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(M){M.callback=null},e.unstable_continueExecution=function(){y||f||(y=!0,K(_))},e.unstable_forceFrameRate=function(M){0>M||125<M?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<M?Math.floor(1e3/M):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return n(c)},e.unstable_next=function(M){switch(h){case 1:case 2:case 3:var X=3;break;default:X=h}var ae=h;h=X;try{return M()}finally{h=ae}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(M,X){switch(M){case 1:case 2:case 3:case 4:case 5:break;default:M=3}var ae=h;h=M;try{return X()}finally{h=ae}},e.unstable_scheduleCallback=function(M,X,ae){var pe=e.unstable_now();switch(typeof ae=="object"&&ae!==null?(ae=ae.delay,ae=typeof ae=="number"&&0<ae?pe+ae:pe):ae=pe,M){case 1:var fe=-1;break;case 2:fe=250;break;case 5:fe=1073741823;break;case 4:fe=1e4;break;default:fe=5e3}return fe=ae+fe,M={id:d++,callback:X,priorityLevel:M,startTime:ae,expirationTime:fe,sortIndex:-1},ae>pe?(M.sortIndex=ae,t(u,M),n(c)===null&&M===n(u)&&(j?(g(C),C=-1):j=!0,ce(E,ae-pe))):(M.sortIndex=fe,t(c,M),y||f||(y=!0,K(_))),M},e.unstable_shouldYield=U,e.unstable_wrapCallback=function(M){var X=h;return function(){var ae=h;h=X;try{return M.apply(this,arguments)}finally{h=ae}}}})(av);iv.exports=av;var bw=iv.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ww=m,bn=bw;function ee(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var ov=new Set,Eo={};function gi(e,t){oa(e,t),oa(e+"Capture",t)}function oa(e,t){for(Eo[e]=t,e=0;e<t.length;e++)ov.add(t[e])}var Ur=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Rd=Object.prototype.hasOwnProperty,Sw=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,rm={},sm={};function Ew(e){return Rd.call(sm,e)?!0:Rd.call(rm,e)?!1:Sw.test(e)?sm[e]=!0:(rm[e]=!0,!1)}function Nw(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function _w(e,t,n,r){if(t===null||typeof t>"u"||Nw(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function rn(e,t,n,r,i,a,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=o}var Ft={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Ft[e]=new rn(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Ft[t]=new rn(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Ft[e]=new rn(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Ft[e]=new rn(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Ft[e]=new rn(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Ft[e]=new rn(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Ft[e]=new rn(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Ft[e]=new rn(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Ft[e]=new rn(e,5,!1,e.toLowerCase(),null,!1,!1)});var gf=/[\-:]([a-z])/g;function yf(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(gf,yf);Ft[t]=new rn(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(gf,yf);Ft[t]=new rn(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(gf,yf);Ft[t]=new rn(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Ft[e]=new rn(e,1,!1,e.toLowerCase(),null,!1,!1)});Ft.xlinkHref=new rn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Ft[e]=new rn(e,1,!1,e.toLowerCase(),null,!0,!0)});function vf(e,t,n,r){var i=Ft.hasOwnProperty(t)?Ft[t]:null;(i!==null?i.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(_w(t,n,i,r)&&(n=null),r||i===null?Ew(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=n===null?i.type===3?!1:"":n:(t=i.attributeName,r=i.attributeNamespace,n===null?e.removeAttribute(t):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var Fr=ww.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,fl=Symbol.for("react.element"),Li=Symbol.for("react.portal"),Di=Symbol.for("react.fragment"),xf=Symbol.for("react.strict_mode"),Td=Symbol.for("react.profiler"),lv=Symbol.for("react.provider"),cv=Symbol.for("react.context"),jf=Symbol.for("react.forward_ref"),Od=Symbol.for("react.suspense"),Pd=Symbol.for("react.suspense_list"),bf=Symbol.for("react.memo"),Qr=Symbol.for("react.lazy"),uv=Symbol.for("react.offscreen"),im=Symbol.iterator;function Ba(e){return e===null||typeof e!="object"?null:(e=im&&e[im]||e["@@iterator"],typeof e=="function"?e:null)}var ut=Object.assign,Au;function eo(e){if(Au===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Au=t&&t[1]||""}return`
`+Au+e}var Cu=!1;function ku(e,t){if(!e||Cu)return"";Cu=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var r=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){r=u}e.call(t.prototype)}else{try{throw Error()}catch(u){r=u}e()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),a=r.stack.split(`
`),o=i.length-1,l=a.length-1;1<=o&&0<=l&&i[o]!==a[l];)l--;for(;1<=o&&0<=l;o--,l--)if(i[o]!==a[l]){if(o!==1||l!==1)do if(o--,l--,0>l||i[o]!==a[l]){var c=`
`+i[o].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=o&&0<=l);break}}}finally{Cu=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?eo(e):""}function Aw(e){switch(e.tag){case 5:return eo(e.type);case 16:return eo("Lazy");case 13:return eo("Suspense");case 19:return eo("SuspenseList");case 0:case 2:case 15:return e=ku(e.type,!1),e;case 11:return e=ku(e.type.render,!1),e;case 1:return e=ku(e.type,!0),e;default:return""}}function Ld(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Di:return"Fragment";case Li:return"Portal";case Td:return"Profiler";case xf:return"StrictMode";case Od:return"Suspense";case Pd:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case cv:return(e.displayName||"Context")+".Consumer";case lv:return(e._context.displayName||"Context")+".Provider";case jf:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case bf:return t=e.displayName||null,t!==null?t:Ld(e.type)||"Memo";case Qr:t=e._payload,e=e._init;try{return Ld(e(t))}catch{}}return null}function Cw(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ld(t);case 8:return t===xf?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function ws(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function dv(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function kw(e){var t=dv(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,a=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,a.call(this,o)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function pl(e){e._valueTracker||(e._valueTracker=kw(e))}function hv(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=dv(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function pc(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Dd(e,t){var n=t.checked;return ut({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function am(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=ws(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function fv(e,t){t=t.checked,t!=null&&vf(e,"checked",t,!1)}function Md(e,t){fv(e,t);var n=ws(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Ud(e,t.type,n):t.hasOwnProperty("defaultValue")&&Ud(e,t.type,ws(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function om(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function Ud(e,t,n){(t!=="number"||pc(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var to=Array.isArray;function Ji(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+ws(n),t=null,i=0;i<e.length;i++){if(e[i].value===n){e[i].selected=!0,r&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function Bd(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(ee(91));return ut({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function lm(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(ee(92));if(to(n)){if(1<n.length)throw Error(ee(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:ws(n)}}function pv(e,t){var n=ws(t.value),r=ws(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function cm(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function mv(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Vd(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?mv(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var ml,gv=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,i){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(ml=ml||document.createElement("div"),ml.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ml.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function No(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var uo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Iw=["Webkit","ms","Moz","O"];Object.keys(uo).forEach(function(e){Iw.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),uo[t]=uo[e]})});function yv(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||uo.hasOwnProperty(e)&&uo[e]?(""+t).trim():t+"px"}function vv(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=yv(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}var Rw=ut({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function $d(e,t){if(t){if(Rw[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(ee(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(ee(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(ee(61))}if(t.style!=null&&typeof t.style!="object")throw Error(ee(62))}}function Fd(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Hd=null;function wf(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var qd=null,Qi=null,Zi=null;function um(e){if(e=rl(e)){if(typeof qd!="function")throw Error(ee(280));var t=e.stateNode;t&&(t=tu(t),qd(e.stateNode,e.type,t))}}function xv(e){Qi?Zi?Zi.push(e):Zi=[e]:Qi=e}function jv(){if(Qi){var e=Qi,t=Zi;if(Zi=Qi=null,um(e),t)for(e=0;e<t.length;e++)um(t[e])}}function bv(e,t){return e(t)}function wv(){}var Iu=!1;function Sv(e,t,n){if(Iu)return e(t,n);Iu=!0;try{return bv(e,t,n)}finally{Iu=!1,(Qi!==null||Zi!==null)&&(wv(),jv())}}function _o(e,t){var n=e.stateNode;if(n===null)return null;var r=tu(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(ee(231,t,typeof n));return n}var zd=!1;if(Ur)try{var Va={};Object.defineProperty(Va,"passive",{get:function(){zd=!0}}),window.addEventListener("test",Va,Va),window.removeEventListener("test",Va,Va)}catch{zd=!1}function Tw(e,t,n,r,i,a,o,l,c){var u=Array.prototype.slice.call(arguments,3);try{t.apply(n,u)}catch(d){this.onError(d)}}var ho=!1,mc=null,gc=!1,Wd=null,Ow={onError:function(e){ho=!0,mc=e}};function Pw(e,t,n,r,i,a,o,l,c){ho=!1,mc=null,Tw.apply(Ow,arguments)}function Lw(e,t,n,r,i,a,o,l,c){if(Pw.apply(this,arguments),ho){if(ho){var u=mc;ho=!1,mc=null}else throw Error(ee(198));gc||(gc=!0,Wd=u)}}function yi(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function Ev(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function dm(e){if(yi(e)!==e)throw Error(ee(188))}function Dw(e){var t=e.alternate;if(!t){if(t=yi(e),t===null)throw Error(ee(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(i===null)break;var a=i.alternate;if(a===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===n)return dm(i),e;if(a===r)return dm(i),t;a=a.sibling}throw Error(ee(188))}if(n.return!==r.return)n=i,r=a;else{for(var o=!1,l=i.child;l;){if(l===n){o=!0,n=i,r=a;break}if(l===r){o=!0,r=i,n=a;break}l=l.sibling}if(!o){for(l=a.child;l;){if(l===n){o=!0,n=a,r=i;break}if(l===r){o=!0,r=a,n=i;break}l=l.sibling}if(!o)throw Error(ee(189))}}if(n.alternate!==r)throw Error(ee(190))}if(n.tag!==3)throw Error(ee(188));return n.stateNode.current===n?e:t}function Nv(e){return e=Dw(e),e!==null?_v(e):null}function _v(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=_v(e);if(t!==null)return t;e=e.sibling}return null}var Av=bn.unstable_scheduleCallback,hm=bn.unstable_cancelCallback,Mw=bn.unstable_shouldYield,Uw=bn.unstable_requestPaint,vt=bn.unstable_now,Bw=bn.unstable_getCurrentPriorityLevel,Sf=bn.unstable_ImmediatePriority,Cv=bn.unstable_UserBlockingPriority,yc=bn.unstable_NormalPriority,Vw=bn.unstable_LowPriority,kv=bn.unstable_IdlePriority,Qc=null,hr=null;function $w(e){if(hr&&typeof hr.onCommitFiberRoot=="function")try{hr.onCommitFiberRoot(Qc,e,void 0,(e.current.flags&128)===128)}catch{}}var Jn=Math.clz32?Math.clz32:qw,Fw=Math.log,Hw=Math.LN2;function qw(e){return e>>>=0,e===0?32:31-(Fw(e)/Hw|0)|0}var gl=64,yl=4194304;function no(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function vc(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,i=e.suspendedLanes,a=e.pingedLanes,o=n&268435455;if(o!==0){var l=o&~i;l!==0?r=no(l):(a&=o,a!==0&&(r=no(a)))}else o=n&~i,o!==0?r=no(o):a!==0&&(r=no(a));if(r===0)return 0;if(t!==0&&t!==r&&!(t&i)&&(i=r&-r,a=t&-t,i>=a||i===16&&(a&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-Jn(t),i=1<<n,r|=e[n],t&=~i;return r}function zw(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ww(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,a=e.pendingLanes;0<a;){var o=31-Jn(a),l=1<<o,c=i[o];c===-1?(!(l&n)||l&r)&&(i[o]=zw(l,t)):c<=t&&(e.expiredLanes|=l),a&=~l}}function Gd(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Iv(){var e=gl;return gl<<=1,!(gl&4194240)&&(gl=64),e}function Ru(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function tl(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Jn(t),e[t]=n}function Gw(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-Jn(n),a=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~a}}function Ef(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-Jn(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var Ge=0;function Rv(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Tv,Nf,Ov,Pv,Lv,Yd=!1,vl=[],cs=null,us=null,ds=null,Ao=new Map,Co=new Map,Xr=[],Yw="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function fm(e,t){switch(e){case"focusin":case"focusout":cs=null;break;case"dragenter":case"dragleave":us=null;break;case"mouseover":case"mouseout":ds=null;break;case"pointerover":case"pointerout":Ao.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Co.delete(t.pointerId)}}function $a(e,t,n,r,i,a){return e===null||e.nativeEvent!==a?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:a,targetContainers:[i]},t!==null&&(t=rl(t),t!==null&&Nf(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function Kw(e,t,n,r,i){switch(t){case"focusin":return cs=$a(cs,e,t,n,r,i),!0;case"dragenter":return us=$a(us,e,t,n,r,i),!0;case"mouseover":return ds=$a(ds,e,t,n,r,i),!0;case"pointerover":var a=i.pointerId;return Ao.set(a,$a(Ao.get(a)||null,e,t,n,r,i)),!0;case"gotpointercapture":return a=i.pointerId,Co.set(a,$a(Co.get(a)||null,e,t,n,r,i)),!0}return!1}function Dv(e){var t=Ks(e.target);if(t!==null){var n=yi(t);if(n!==null){if(t=n.tag,t===13){if(t=Ev(n),t!==null){e.blockedOn=t,Lv(e.priority,function(){Ov(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Wl(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Kd(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);Hd=r,n.target.dispatchEvent(r),Hd=null}else return t=rl(n),t!==null&&Nf(t),e.blockedOn=n,!1;t.shift()}return!0}function pm(e,t,n){Wl(e)&&n.delete(t)}function Jw(){Yd=!1,cs!==null&&Wl(cs)&&(cs=null),us!==null&&Wl(us)&&(us=null),ds!==null&&Wl(ds)&&(ds=null),Ao.forEach(pm),Co.forEach(pm)}function Fa(e,t){e.blockedOn===t&&(e.blockedOn=null,Yd||(Yd=!0,bn.unstable_scheduleCallback(bn.unstable_NormalPriority,Jw)))}function ko(e){function t(i){return Fa(i,e)}if(0<vl.length){Fa(vl[0],e);for(var n=1;n<vl.length;n++){var r=vl[n];r.blockedOn===e&&(r.blockedOn=null)}}for(cs!==null&&Fa(cs,e),us!==null&&Fa(us,e),ds!==null&&Fa(ds,e),Ao.forEach(t),Co.forEach(t),n=0;n<Xr.length;n++)r=Xr[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<Xr.length&&(n=Xr[0],n.blockedOn===null);)Dv(n),n.blockedOn===null&&Xr.shift()}var Xi=Fr.ReactCurrentBatchConfig,xc=!0;function Qw(e,t,n,r){var i=Ge,a=Xi.transition;Xi.transition=null;try{Ge=1,_f(e,t,n,r)}finally{Ge=i,Xi.transition=a}}function Zw(e,t,n,r){var i=Ge,a=Xi.transition;Xi.transition=null;try{Ge=4,_f(e,t,n,r)}finally{Ge=i,Xi.transition=a}}function _f(e,t,n,r){if(xc){var i=Kd(e,t,n,r);if(i===null)$u(e,t,r,jc,n),fm(e,r);else if(Kw(i,e,t,n,r))r.stopPropagation();else if(fm(e,r),t&4&&-1<Yw.indexOf(e)){for(;i!==null;){var a=rl(i);if(a!==null&&Tv(a),a=Kd(e,t,n,r),a===null&&$u(e,t,r,jc,n),a===i)break;i=a}i!==null&&r.stopPropagation()}else $u(e,t,r,null,n)}}var jc=null;function Kd(e,t,n,r){if(jc=null,e=wf(r),e=Ks(e),e!==null)if(t=yi(e),t===null)e=null;else if(n=t.tag,n===13){if(e=Ev(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return jc=e,null}function Mv(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Bw()){case Sf:return 1;case Cv:return 4;case yc:case Vw:return 16;case kv:return 536870912;default:return 16}default:return 16}}var ss=null,Af=null,Gl=null;function Uv(){if(Gl)return Gl;var e,t=Af,n=t.length,r,i="value"in ss?ss.value:ss.textContent,a=i.length;for(e=0;e<n&&t[e]===i[e];e++);var o=n-e;for(r=1;r<=o&&t[n-r]===i[a-r];r++);return Gl=i.slice(e,1<r?1-r:void 0)}function Yl(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function xl(){return!0}function mm(){return!1}function Sn(e){function t(n,r,i,a,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=a,this.target=o,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(n=e[l],this[l]=n?n(a):a[l]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?xl:mm,this.isPropagationStopped=mm,this}return ut(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=xl)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=xl)},persist:function(){},isPersistent:xl}),t}var wa={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Cf=Sn(wa),nl=ut({},wa,{view:0,detail:0}),Xw=Sn(nl),Tu,Ou,Ha,Zc=ut({},nl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:kf,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Ha&&(Ha&&e.type==="mousemove"?(Tu=e.screenX-Ha.screenX,Ou=e.screenY-Ha.screenY):Ou=Tu=0,Ha=e),Tu)},movementY:function(e){return"movementY"in e?e.movementY:Ou}}),gm=Sn(Zc),eS=ut({},Zc,{dataTransfer:0}),tS=Sn(eS),nS=ut({},nl,{relatedTarget:0}),Pu=Sn(nS),rS=ut({},wa,{animationName:0,elapsedTime:0,pseudoElement:0}),sS=Sn(rS),iS=ut({},wa,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),aS=Sn(iS),oS=ut({},wa,{data:0}),ym=Sn(oS),lS={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},cS={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},uS={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function dS(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=uS[e])?!!t[e]:!1}function kf(){return dS}var hS=ut({},nl,{key:function(e){if(e.key){var t=lS[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Yl(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?cS[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:kf,charCode:function(e){return e.type==="keypress"?Yl(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Yl(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),fS=Sn(hS),pS=ut({},Zc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),vm=Sn(pS),mS=ut({},nl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:kf}),gS=Sn(mS),yS=ut({},wa,{propertyName:0,elapsedTime:0,pseudoElement:0}),vS=Sn(yS),xS=ut({},Zc,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),jS=Sn(xS),bS=[9,13,27,32],If=Ur&&"CompositionEvent"in window,fo=null;Ur&&"documentMode"in document&&(fo=document.documentMode);var wS=Ur&&"TextEvent"in window&&!fo,Bv=Ur&&(!If||fo&&8<fo&&11>=fo),xm=" ",jm=!1;function Vv(e,t){switch(e){case"keyup":return bS.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function $v(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Mi=!1;function SS(e,t){switch(e){case"compositionend":return $v(t);case"keypress":return t.which!==32?null:(jm=!0,xm);case"textInput":return e=t.data,e===xm&&jm?null:e;default:return null}}function ES(e,t){if(Mi)return e==="compositionend"||!If&&Vv(e,t)?(e=Uv(),Gl=Af=ss=null,Mi=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Bv&&t.locale!=="ko"?null:t.data;default:return null}}var NS={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function bm(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!NS[e.type]:t==="textarea"}function Fv(e,t,n,r){xv(r),t=bc(t,"onChange"),0<t.length&&(n=new Cf("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var po=null,Io=null;function _S(e){Xv(e,0)}function Xc(e){var t=Vi(e);if(hv(t))return e}function AS(e,t){if(e==="change")return t}var Hv=!1;if(Ur){var Lu;if(Ur){var Du="oninput"in document;if(!Du){var wm=document.createElement("div");wm.setAttribute("oninput","return;"),Du=typeof wm.oninput=="function"}Lu=Du}else Lu=!1;Hv=Lu&&(!document.documentMode||9<document.documentMode)}function Sm(){po&&(po.detachEvent("onpropertychange",qv),Io=po=null)}function qv(e){if(e.propertyName==="value"&&Xc(Io)){var t=[];Fv(t,Io,e,wf(e)),Sv(_S,t)}}function CS(e,t,n){e==="focusin"?(Sm(),po=t,Io=n,po.attachEvent("onpropertychange",qv)):e==="focusout"&&Sm()}function kS(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Xc(Io)}function IS(e,t){if(e==="click")return Xc(t)}function RS(e,t){if(e==="input"||e==="change")return Xc(t)}function TS(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Zn=typeof Object.is=="function"?Object.is:TS;function Ro(e,t){if(Zn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!Rd.call(t,i)||!Zn(e[i],t[i]))return!1}return!0}function Em(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Nm(e,t){var n=Em(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Em(n)}}function zv(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?zv(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Wv(){for(var e=window,t=pc();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=pc(e.document)}return t}function Rf(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function OS(e){var t=Wv(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&zv(n.ownerDocument.documentElement,n)){if(r!==null&&Rf(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=n.textContent.length,a=Math.min(r.start,i);r=r.end===void 0?a:Math.min(r.end,i),!e.extend&&a>r&&(i=r,r=a,a=i),i=Nm(n,a);var o=Nm(n,r);i&&o&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),a>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var PS=Ur&&"documentMode"in document&&11>=document.documentMode,Ui=null,Jd=null,mo=null,Qd=!1;function _m(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Qd||Ui==null||Ui!==pc(r)||(r=Ui,"selectionStart"in r&&Rf(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),mo&&Ro(mo,r)||(mo=r,r=bc(Jd,"onSelect"),0<r.length&&(t=new Cf("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=Ui)))}function jl(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Bi={animationend:jl("Animation","AnimationEnd"),animationiteration:jl("Animation","AnimationIteration"),animationstart:jl("Animation","AnimationStart"),transitionend:jl("Transition","TransitionEnd")},Mu={},Gv={};Ur&&(Gv=document.createElement("div").style,"AnimationEvent"in window||(delete Bi.animationend.animation,delete Bi.animationiteration.animation,delete Bi.animationstart.animation),"TransitionEvent"in window||delete Bi.transitionend.transition);function eu(e){if(Mu[e])return Mu[e];if(!Bi[e])return e;var t=Bi[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in Gv)return Mu[e]=t[n];return e}var Yv=eu("animationend"),Kv=eu("animationiteration"),Jv=eu("animationstart"),Qv=eu("transitionend"),Zv=new Map,Am="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ns(e,t){Zv.set(e,t),gi(t,[e])}for(var Uu=0;Uu<Am.length;Uu++){var Bu=Am[Uu],LS=Bu.toLowerCase(),DS=Bu[0].toUpperCase()+Bu.slice(1);Ns(LS,"on"+DS)}Ns(Yv,"onAnimationEnd");Ns(Kv,"onAnimationIteration");Ns(Jv,"onAnimationStart");Ns("dblclick","onDoubleClick");Ns("focusin","onFocus");Ns("focusout","onBlur");Ns(Qv,"onTransitionEnd");oa("onMouseEnter",["mouseout","mouseover"]);oa("onMouseLeave",["mouseout","mouseover"]);oa("onPointerEnter",["pointerout","pointerover"]);oa("onPointerLeave",["pointerout","pointerover"]);gi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));gi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));gi("onBeforeInput",["compositionend","keypress","textInput","paste"]);gi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));gi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));gi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ro="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),MS=new Set("cancel close invalid load scroll toggle".split(" ").concat(ro));function Cm(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,Lw(r,t,void 0,e),e.currentTarget=null}function Xv(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var a=void 0;if(t)for(var o=r.length-1;0<=o;o--){var l=r[o],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==a&&i.isPropagationStopped())break e;Cm(i,l,u),a=c}else for(o=0;o<r.length;o++){if(l=r[o],c=l.instance,u=l.currentTarget,l=l.listener,c!==a&&i.isPropagationStopped())break e;Cm(i,l,u),a=c}}}if(gc)throw e=Wd,gc=!1,Wd=null,e}function Qe(e,t){var n=t[nh];n===void 0&&(n=t[nh]=new Set);var r=e+"__bubble";n.has(r)||(ex(t,e,2,!1),n.add(r))}function Vu(e,t,n){var r=0;t&&(r|=4),ex(n,e,r,t)}var bl="_reactListening"+Math.random().toString(36).slice(2);function To(e){if(!e[bl]){e[bl]=!0,ov.forEach(function(n){n!=="selectionchange"&&(MS.has(n)||Vu(n,!1,e),Vu(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[bl]||(t[bl]=!0,Vu("selectionchange",!1,t))}}function ex(e,t,n,r){switch(Mv(t)){case 1:var i=Qw;break;case 4:i=Zw;break;default:i=_f}n=i.bind(null,t,n,e),i=void 0,!zd||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),r?i!==void 0?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):i!==void 0?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function $u(e,t,n,r,i){var a=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===i||l.nodeType===8&&l.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;o=o.return}for(;l!==null;){if(o=Ks(l),o===null)return;if(c=o.tag,c===5||c===6){r=a=o;continue e}l=l.parentNode}}r=r.return}Sv(function(){var u=a,d=wf(n),p=[];e:{var h=Zv.get(e);if(h!==void 0){var f=Cf,y=e;switch(e){case"keypress":if(Yl(n)===0)break e;case"keydown":case"keyup":f=fS;break;case"focusin":y="focus",f=Pu;break;case"focusout":y="blur",f=Pu;break;case"beforeblur":case"afterblur":f=Pu;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=gm;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=tS;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=gS;break;case Yv:case Kv:case Jv:f=sS;break;case Qv:f=vS;break;case"scroll":f=Xw;break;case"wheel":f=jS;break;case"copy":case"cut":case"paste":f=aS;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=vm}var j=(t&4)!==0,A=!j&&e==="scroll",g=j?h!==null?h+"Capture":null:h;j=[];for(var x=u,w;x!==null;){w=x;var E=w.stateNode;if(w.tag===5&&E!==null&&(w=E,g!==null&&(E=_o(x,g),E!=null&&j.push(Oo(x,E,w)))),A)break;x=x.return}0<j.length&&(h=new f(h,y,null,n,d),p.push({event:h,listeners:j}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",f=e==="mouseout"||e==="pointerout",h&&n!==Hd&&(y=n.relatedTarget||n.fromElement)&&(Ks(y)||y[Br]))break e;if((f||h)&&(h=d.window===d?d:(h=d.ownerDocument)?h.defaultView||h.parentWindow:window,f?(y=n.relatedTarget||n.toElement,f=u,y=y?Ks(y):null,y!==null&&(A=yi(y),y!==A||y.tag!==5&&y.tag!==6)&&(y=null)):(f=null,y=u),f!==y)){if(j=gm,E="onMouseLeave",g="onMouseEnter",x="mouse",(e==="pointerout"||e==="pointerover")&&(j=vm,E="onPointerLeave",g="onPointerEnter",x="pointer"),A=f==null?h:Vi(f),w=y==null?h:Vi(y),h=new j(E,x+"leave",f,n,d),h.target=A,h.relatedTarget=w,E=null,Ks(d)===u&&(j=new j(g,x+"enter",y,n,d),j.target=w,j.relatedTarget=A,E=j),A=E,f&&y)t:{for(j=f,g=y,x=0,w=j;w;w=Ri(w))x++;for(w=0,E=g;E;E=Ri(E))w++;for(;0<x-w;)j=Ri(j),x--;for(;0<w-x;)g=Ri(g),w--;for(;x--;){if(j===g||g!==null&&j===g.alternate)break t;j=Ri(j),g=Ri(g)}j=null}else j=null;f!==null&&km(p,h,f,j,!1),y!==null&&A!==null&&km(p,A,y,j,!0)}}e:{if(h=u?Vi(u):window,f=h.nodeName&&h.nodeName.toLowerCase(),f==="select"||f==="input"&&h.type==="file")var _=AS;else if(bm(h))if(Hv)_=RS;else{_=kS;var b=CS}else(f=h.nodeName)&&f.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(_=IS);if(_&&(_=_(e,u))){Fv(p,_,n,d);break e}b&&b(e,h,u),e==="focusout"&&(b=h._wrapperState)&&b.controlled&&h.type==="number"&&Ud(h,"number",h.value)}switch(b=u?Vi(u):window,e){case"focusin":(bm(b)||b.contentEditable==="true")&&(Ui=b,Jd=u,mo=null);break;case"focusout":mo=Jd=Ui=null;break;case"mousedown":Qd=!0;break;case"contextmenu":case"mouseup":case"dragend":Qd=!1,_m(p,n,d);break;case"selectionchange":if(PS)break;case"keydown":case"keyup":_m(p,n,d)}var R;if(If)e:{switch(e){case"compositionstart":var C="onCompositionStart";break e;case"compositionend":C="onCompositionEnd";break e;case"compositionupdate":C="onCompositionUpdate";break e}C=void 0}else Mi?Vv(e,n)&&(C="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(C="onCompositionStart");C&&(Bv&&n.locale!=="ko"&&(Mi||C!=="onCompositionStart"?C==="onCompositionEnd"&&Mi&&(R=Uv()):(ss=d,Af="value"in ss?ss.value:ss.textContent,Mi=!0)),b=bc(u,C),0<b.length&&(C=new ym(C,e,null,n,d),p.push({event:C,listeners:b}),R?C.data=R:(R=$v(n),R!==null&&(C.data=R)))),(R=wS?SS(e,n):ES(e,n))&&(u=bc(u,"onBeforeInput"),0<u.length&&(d=new ym("onBeforeInput","beforeinput",null,n,d),p.push({event:d,listeners:u}),d.data=R))}Xv(p,t)})}function Oo(e,t,n){return{instance:e,listener:t,currentTarget:n}}function bc(e,t){for(var n=t+"Capture",r=[];e!==null;){var i=e,a=i.stateNode;i.tag===5&&a!==null&&(i=a,a=_o(e,n),a!=null&&r.unshift(Oo(e,a,i)),a=_o(e,t),a!=null&&r.push(Oo(e,a,i))),e=e.return}return r}function Ri(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function km(e,t,n,r,i){for(var a=t._reactName,o=[];n!==null&&n!==r;){var l=n,c=l.alternate,u=l.stateNode;if(c!==null&&c===r)break;l.tag===5&&u!==null&&(l=u,i?(c=_o(n,a),c!=null&&o.unshift(Oo(n,c,l))):i||(c=_o(n,a),c!=null&&o.push(Oo(n,c,l)))),n=n.return}o.length!==0&&e.push({event:t,listeners:o})}var US=/\r\n?/g,BS=/\u0000|\uFFFD/g;function Im(e){return(typeof e=="string"?e:""+e).replace(US,`
`).replace(BS,"")}function wl(e,t,n){if(t=Im(t),Im(e)!==t&&n)throw Error(ee(425))}function wc(){}var Zd=null,Xd=null;function eh(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var th=typeof setTimeout=="function"?setTimeout:void 0,VS=typeof clearTimeout=="function"?clearTimeout:void 0,Rm=typeof Promise=="function"?Promise:void 0,$S=typeof queueMicrotask=="function"?queueMicrotask:typeof Rm<"u"?function(e){return Rm.resolve(null).then(e).catch(FS)}:th;function FS(e){setTimeout(function(){throw e})}function Fu(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){e.removeChild(i),ko(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);ko(t)}function hs(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Tm(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var Sa=Math.random().toString(36).slice(2),lr="__reactFiber$"+Sa,Po="__reactProps$"+Sa,Br="__reactContainer$"+Sa,nh="__reactEvents$"+Sa,HS="__reactListeners$"+Sa,qS="__reactHandles$"+Sa;function Ks(e){var t=e[lr];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Br]||n[lr]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=Tm(e);e!==null;){if(n=e[lr])return n;e=Tm(e)}return t}e=n,n=e.parentNode}return null}function rl(e){return e=e[lr]||e[Br],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Vi(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(ee(33))}function tu(e){return e[Po]||null}var rh=[],$i=-1;function _s(e){return{current:e}}function Xe(e){0>$i||(e.current=rh[$i],rh[$i]=null,$i--)}function Je(e,t){$i++,rh[$i]=e.current,e.current=t}var Ss={},Kt=_s(Ss),cn=_s(!1),li=Ss;function la(e,t){var n=e.type.contextTypes;if(!n)return Ss;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i={},a;for(a in n)i[a]=t[a];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function un(e){return e=e.childContextTypes,e!=null}function Sc(){Xe(cn),Xe(Kt)}function Om(e,t,n){if(Kt.current!==Ss)throw Error(ee(168));Je(Kt,t),Je(cn,n)}function tx(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in t))throw Error(ee(108,Cw(e)||"Unknown",i));return ut({},n,r)}function Ec(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ss,li=Kt.current,Je(Kt,e),Je(cn,cn.current),!0}function Pm(e,t,n){var r=e.stateNode;if(!r)throw Error(ee(169));n?(e=tx(e,t,li),r.__reactInternalMemoizedMergedChildContext=e,Xe(cn),Xe(Kt),Je(Kt,e)):Xe(cn),Je(cn,n)}var kr=null,nu=!1,Hu=!1;function nx(e){kr===null?kr=[e]:kr.push(e)}function zS(e){nu=!0,nx(e)}function As(){if(!Hu&&kr!==null){Hu=!0;var e=0,t=Ge;try{var n=kr;for(Ge=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}kr=null,nu=!1}catch(i){throw kr!==null&&(kr=kr.slice(e+1)),Av(Sf,As),i}finally{Ge=t,Hu=!1}}return null}var Fi=[],Hi=0,Nc=null,_c=0,Cn=[],kn=0,ci=null,Or=1,Pr="";function qs(e,t){Fi[Hi++]=_c,Fi[Hi++]=Nc,Nc=e,_c=t}function rx(e,t,n){Cn[kn++]=Or,Cn[kn++]=Pr,Cn[kn++]=ci,ci=e;var r=Or;e=Pr;var i=32-Jn(r)-1;r&=~(1<<i),n+=1;var a=32-Jn(t)+i;if(30<a){var o=i-i%5;a=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Or=1<<32-Jn(t)+i|n<<i|r,Pr=a+e}else Or=1<<a|n<<i|r,Pr=e}function Tf(e){e.return!==null&&(qs(e,1),rx(e,1,0))}function Of(e){for(;e===Nc;)Nc=Fi[--Hi],Fi[Hi]=null,_c=Fi[--Hi],Fi[Hi]=null;for(;e===ci;)ci=Cn[--kn],Cn[kn]=null,Pr=Cn[--kn],Cn[kn]=null,Or=Cn[--kn],Cn[kn]=null}var jn=null,vn=null,nt=!1,Gn=null;function sx(e,t){var n=Tn(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function Lm(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,jn=e,vn=hs(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,jn=e,vn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=ci!==null?{id:Or,overflow:Pr}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=Tn(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,jn=e,vn=null,!0):!1;default:return!1}}function sh(e){return(e.mode&1)!==0&&(e.flags&128)===0}function ih(e){if(nt){var t=vn;if(t){var n=t;if(!Lm(e,t)){if(sh(e))throw Error(ee(418));t=hs(n.nextSibling);var r=jn;t&&Lm(e,t)?sx(r,n):(e.flags=e.flags&-4097|2,nt=!1,jn=e)}}else{if(sh(e))throw Error(ee(418));e.flags=e.flags&-4097|2,nt=!1,jn=e}}}function Dm(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;jn=e}function Sl(e){if(e!==jn)return!1;if(!nt)return Dm(e),nt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!eh(e.type,e.memoizedProps)),t&&(t=vn)){if(sh(e))throw ix(),Error(ee(418));for(;t;)sx(e,t),t=hs(t.nextSibling)}if(Dm(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(ee(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){vn=hs(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}vn=null}}else vn=jn?hs(e.stateNode.nextSibling):null;return!0}function ix(){for(var e=vn;e;)e=hs(e.nextSibling)}function ca(){vn=jn=null,nt=!1}function Pf(e){Gn===null?Gn=[e]:Gn.push(e)}var WS=Fr.ReactCurrentBatchConfig;function qa(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ee(309));var r=n.stateNode}if(!r)throw Error(ee(147,e));var i=r,a=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===a?t.ref:(t=function(o){var l=i.refs;o===null?delete l[a]:l[a]=o},t._stringRef=a,t)}if(typeof e!="string")throw Error(ee(284));if(!n._owner)throw Error(ee(290,e))}return e}function El(e,t){throw e=Object.prototype.toString.call(t),Error(ee(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Mm(e){var t=e._init;return t(e._payload)}function ax(e){function t(g,x){if(e){var w=g.deletions;w===null?(g.deletions=[x],g.flags|=16):w.push(x)}}function n(g,x){if(!e)return null;for(;x!==null;)t(g,x),x=x.sibling;return null}function r(g,x){for(g=new Map;x!==null;)x.key!==null?g.set(x.key,x):g.set(x.index,x),x=x.sibling;return g}function i(g,x){return g=gs(g,x),g.index=0,g.sibling=null,g}function a(g,x,w){return g.index=w,e?(w=g.alternate,w!==null?(w=w.index,w<x?(g.flags|=2,x):w):(g.flags|=2,x)):(g.flags|=1048576,x)}function o(g){return e&&g.alternate===null&&(g.flags|=2),g}function l(g,x,w,E){return x===null||x.tag!==6?(x=Ju(w,g.mode,E),x.return=g,x):(x=i(x,w),x.return=g,x)}function c(g,x,w,E){var _=w.type;return _===Di?d(g,x,w.props.children,E,w.key):x!==null&&(x.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===Qr&&Mm(_)===x.type)?(E=i(x,w.props),E.ref=qa(g,x,w),E.return=g,E):(E=tc(w.type,w.key,w.props,null,g.mode,E),E.ref=qa(g,x,w),E.return=g,E)}function u(g,x,w,E){return x===null||x.tag!==4||x.stateNode.containerInfo!==w.containerInfo||x.stateNode.implementation!==w.implementation?(x=Qu(w,g.mode,E),x.return=g,x):(x=i(x,w.children||[]),x.return=g,x)}function d(g,x,w,E,_){return x===null||x.tag!==7?(x=si(w,g.mode,E,_),x.return=g,x):(x=i(x,w),x.return=g,x)}function p(g,x,w){if(typeof x=="string"&&x!==""||typeof x=="number")return x=Ju(""+x,g.mode,w),x.return=g,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case fl:return w=tc(x.type,x.key,x.props,null,g.mode,w),w.ref=qa(g,null,x),w.return=g,w;case Li:return x=Qu(x,g.mode,w),x.return=g,x;case Qr:var E=x._init;return p(g,E(x._payload),w)}if(to(x)||Ba(x))return x=si(x,g.mode,w,null),x.return=g,x;El(g,x)}return null}function h(g,x,w,E){var _=x!==null?x.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return _!==null?null:l(g,x,""+w,E);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case fl:return w.key===_?c(g,x,w,E):null;case Li:return w.key===_?u(g,x,w,E):null;case Qr:return _=w._init,h(g,x,_(w._payload),E)}if(to(w)||Ba(w))return _!==null?null:d(g,x,w,E,null);El(g,w)}return null}function f(g,x,w,E,_){if(typeof E=="string"&&E!==""||typeof E=="number")return g=g.get(w)||null,l(x,g,""+E,_);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case fl:return g=g.get(E.key===null?w:E.key)||null,c(x,g,E,_);case Li:return g=g.get(E.key===null?w:E.key)||null,u(x,g,E,_);case Qr:var b=E._init;return f(g,x,w,b(E._payload),_)}if(to(E)||Ba(E))return g=g.get(w)||null,d(x,g,E,_,null);El(x,E)}return null}function y(g,x,w,E){for(var _=null,b=null,R=x,C=x=0,T=null;R!==null&&C<w.length;C++){R.index>C?(T=R,R=null):T=R.sibling;var D=h(g,R,w[C],E);if(D===null){R===null&&(R=T);break}e&&R&&D.alternate===null&&t(g,R),x=a(D,x,C),b===null?_=D:b.sibling=D,b=D,R=T}if(C===w.length)return n(g,R),nt&&qs(g,C),_;if(R===null){for(;C<w.length;C++)R=p(g,w[C],E),R!==null&&(x=a(R,x,C),b===null?_=R:b.sibling=R,b=R);return nt&&qs(g,C),_}for(R=r(g,R);C<w.length;C++)T=f(R,g,C,w[C],E),T!==null&&(e&&T.alternate!==null&&R.delete(T.key===null?C:T.key),x=a(T,x,C),b===null?_=T:b.sibling=T,b=T);return e&&R.forEach(function(U){return t(g,U)}),nt&&qs(g,C),_}function j(g,x,w,E){var _=Ba(w);if(typeof _!="function")throw Error(ee(150));if(w=_.call(w),w==null)throw Error(ee(151));for(var b=_=null,R=x,C=x=0,T=null,D=w.next();R!==null&&!D.done;C++,D=w.next()){R.index>C?(T=R,R=null):T=R.sibling;var U=h(g,R,D.value,E);if(U===null){R===null&&(R=T);break}e&&R&&U.alternate===null&&t(g,R),x=a(U,x,C),b===null?_=U:b.sibling=U,b=U,R=T}if(D.done)return n(g,R),nt&&qs(g,C),_;if(R===null){for(;!D.done;C++,D=w.next())D=p(g,D.value,E),D!==null&&(x=a(D,x,C),b===null?_=D:b.sibling=D,b=D);return nt&&qs(g,C),_}for(R=r(g,R);!D.done;C++,D=w.next())D=f(R,g,C,D.value,E),D!==null&&(e&&D.alternate!==null&&R.delete(D.key===null?C:D.key),x=a(D,x,C),b===null?_=D:b.sibling=D,b=D);return e&&R.forEach(function(W){return t(g,W)}),nt&&qs(g,C),_}function A(g,x,w,E){if(typeof w=="object"&&w!==null&&w.type===Di&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case fl:e:{for(var _=w.key,b=x;b!==null;){if(b.key===_){if(_=w.type,_===Di){if(b.tag===7){n(g,b.sibling),x=i(b,w.props.children),x.return=g,g=x;break e}}else if(b.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===Qr&&Mm(_)===b.type){n(g,b.sibling),x=i(b,w.props),x.ref=qa(g,b,w),x.return=g,g=x;break e}n(g,b);break}else t(g,b);b=b.sibling}w.type===Di?(x=si(w.props.children,g.mode,E,w.key),x.return=g,g=x):(E=tc(w.type,w.key,w.props,null,g.mode,E),E.ref=qa(g,x,w),E.return=g,g=E)}return o(g);case Li:e:{for(b=w.key;x!==null;){if(x.key===b)if(x.tag===4&&x.stateNode.containerInfo===w.containerInfo&&x.stateNode.implementation===w.implementation){n(g,x.sibling),x=i(x,w.children||[]),x.return=g,g=x;break e}else{n(g,x);break}else t(g,x);x=x.sibling}x=Qu(w,g.mode,E),x.return=g,g=x}return o(g);case Qr:return b=w._init,A(g,x,b(w._payload),E)}if(to(w))return y(g,x,w,E);if(Ba(w))return j(g,x,w,E);El(g,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,x!==null&&x.tag===6?(n(g,x.sibling),x=i(x,w),x.return=g,g=x):(n(g,x),x=Ju(w,g.mode,E),x.return=g,g=x),o(g)):n(g,x)}return A}var ua=ax(!0),ox=ax(!1),Ac=_s(null),Cc=null,qi=null,Lf=null;function Df(){Lf=qi=Cc=null}function Mf(e){var t=Ac.current;Xe(Ac),e._currentValue=t}function ah(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function ea(e,t){Cc=e,Lf=qi=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(an=!0),e.firstContext=null)}function Pn(e){var t=e._currentValue;if(Lf!==e)if(e={context:e,memoizedValue:t,next:null},qi===null){if(Cc===null)throw Error(ee(308));qi=e,Cc.dependencies={lanes:0,firstContext:e}}else qi=qi.next=e;return t}var Js=null;function Uf(e){Js===null?Js=[e]:Js.push(e)}function lx(e,t,n,r){var i=t.interleaved;return i===null?(n.next=n,Uf(t)):(n.next=i.next,i.next=n),t.interleaved=n,Vr(e,r)}function Vr(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var Zr=!1;function Bf(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function cx(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Dr(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function fs(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,Ve&2){var i=r.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),r.pending=t,Vr(e,n)}return i=r.interleaved,i===null?(t.next=t,Uf(r)):(t.next=i.next,i.next=t),r.interleaved=t,Vr(e,n)}function Kl(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Ef(e,n)}}function Um(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,a=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};a===null?i=a=o:a=a.next=o,n=n.next}while(n!==null);a===null?i=a=t:a=a.next=t}else i=a=t;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function kc(e,t,n,r){var i=e.updateQueue;Zr=!1;var a=i.firstBaseUpdate,o=i.lastBaseUpdate,l=i.shared.pending;if(l!==null){i.shared.pending=null;var c=l,u=c.next;c.next=null,o===null?a=u:o.next=u,o=c;var d=e.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==o&&(l===null?d.firstBaseUpdate=u:l.next=u,d.lastBaseUpdate=c))}if(a!==null){var p=i.baseState;o=0,d=u=c=null,l=a;do{var h=l.lane,f=l.eventTime;if((r&h)===h){d!==null&&(d=d.next={eventTime:f,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var y=e,j=l;switch(h=t,f=n,j.tag){case 1:if(y=j.payload,typeof y=="function"){p=y.call(f,p,h);break e}p=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=j.payload,h=typeof y=="function"?y.call(f,p,h):y,h==null)break e;p=ut({},p,h);break e;case 2:Zr=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,h=i.effects,h===null?i.effects=[l]:h.push(l))}else f={eventTime:f,lane:h,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(u=d=f,c=p):d=d.next=f,o|=h;if(l=l.next,l===null){if(l=i.shared.pending,l===null)break;h=l,l=h.next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}while(!0);if(d===null&&(c=p),i.baseState=c,i.firstBaseUpdate=u,i.lastBaseUpdate=d,t=i.shared.interleaved,t!==null){i=t;do o|=i.lane,i=i.next;while(i!==t)}else a===null&&(i.shared.lanes=0);di|=o,e.lanes=o,e.memoizedState=p}}function Bm(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(ee(191,i));i.call(r)}}}var sl={},fr=_s(sl),Lo=_s(sl),Do=_s(sl);function Qs(e){if(e===sl)throw Error(ee(174));return e}function Vf(e,t){switch(Je(Do,t),Je(Lo,e),Je(fr,sl),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Vd(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Vd(t,e)}Xe(fr),Je(fr,t)}function da(){Xe(fr),Xe(Lo),Xe(Do)}function ux(e){Qs(Do.current);var t=Qs(fr.current),n=Vd(t,e.type);t!==n&&(Je(Lo,e),Je(fr,n))}function $f(e){Lo.current===e&&(Xe(fr),Xe(Lo))}var ot=_s(0);function Ic(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var qu=[];function Ff(){for(var e=0;e<qu.length;e++)qu[e]._workInProgressVersionPrimary=null;qu.length=0}var Jl=Fr.ReactCurrentDispatcher,zu=Fr.ReactCurrentBatchConfig,ui=0,ct=null,At=null,Tt=null,Rc=!1,go=!1,Mo=0,GS=0;function qt(){throw Error(ee(321))}function Hf(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Zn(e[n],t[n]))return!1;return!0}function qf(e,t,n,r,i,a){if(ui=a,ct=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Jl.current=e===null||e.memoizedState===null?QS:ZS,e=n(r,i),go){a=0;do{if(go=!1,Mo=0,25<=a)throw Error(ee(301));a+=1,Tt=At=null,t.updateQueue=null,Jl.current=XS,e=n(r,i)}while(go)}if(Jl.current=Tc,t=At!==null&&At.next!==null,ui=0,Tt=At=ct=null,Rc=!1,t)throw Error(ee(300));return e}function zf(){var e=Mo!==0;return Mo=0,e}function or(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Tt===null?ct.memoizedState=Tt=e:Tt=Tt.next=e,Tt}function Ln(){if(At===null){var e=ct.alternate;e=e!==null?e.memoizedState:null}else e=At.next;var t=Tt===null?ct.memoizedState:Tt.next;if(t!==null)Tt=t,At=e;else{if(e===null)throw Error(ee(310));At=e,e={memoizedState:At.memoizedState,baseState:At.baseState,baseQueue:At.baseQueue,queue:At.queue,next:null},Tt===null?ct.memoizedState=Tt=e:Tt=Tt.next=e}return Tt}function Uo(e,t){return typeof t=="function"?t(e):t}function Wu(e){var t=Ln(),n=t.queue;if(n===null)throw Error(ee(311));n.lastRenderedReducer=e;var r=At,i=r.baseQueue,a=n.pending;if(a!==null){if(i!==null){var o=i.next;i.next=a.next,a.next=o}r.baseQueue=i=a,n.pending=null}if(i!==null){a=i.next,r=r.baseState;var l=o=null,c=null,u=a;do{var d=u.lane;if((ui&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var p={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=p,o=r):c=c.next=p,ct.lanes|=d,di|=d}u=u.next}while(u!==null&&u!==a);c===null?o=r:c.next=l,Zn(r,t.memoizedState)||(an=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=c,n.lastRenderedState=r}if(e=n.interleaved,e!==null){i=e;do a=i.lane,ct.lanes|=a,di|=a,i=i.next;while(i!==e)}else i===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Gu(e){var t=Ln(),n=t.queue;if(n===null)throw Error(ee(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,a=t.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do a=e(a,o.action),o=o.next;while(o!==i);Zn(a,t.memoizedState)||(an=!0),t.memoizedState=a,t.baseQueue===null&&(t.baseState=a),n.lastRenderedState=a}return[a,r]}function dx(){}function hx(e,t){var n=ct,r=Ln(),i=t(),a=!Zn(r.memoizedState,i);if(a&&(r.memoizedState=i,an=!0),r=r.queue,Wf(mx.bind(null,n,r,e),[e]),r.getSnapshot!==t||a||Tt!==null&&Tt.memoizedState.tag&1){if(n.flags|=2048,Bo(9,px.bind(null,n,r,i,t),void 0,null),Ot===null)throw Error(ee(349));ui&30||fx(n,t,i)}return i}function fx(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=ct.updateQueue,t===null?(t={lastEffect:null,stores:null},ct.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function px(e,t,n,r){t.value=n,t.getSnapshot=r,gx(t)&&yx(e)}function mx(e,t,n){return n(function(){gx(t)&&yx(e)})}function gx(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Zn(e,n)}catch{return!0}}function yx(e){var t=Vr(e,1);t!==null&&Qn(t,e,1,-1)}function Vm(e){var t=or();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Uo,lastRenderedState:e},t.queue=e,e=e.dispatch=JS.bind(null,ct,e),[t.memoizedState,e]}function Bo(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=ct.updateQueue,t===null?(t={lastEffect:null,stores:null},ct.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function vx(){return Ln().memoizedState}function Ql(e,t,n,r){var i=or();ct.flags|=e,i.memoizedState=Bo(1|t,n,void 0,r===void 0?null:r)}function ru(e,t,n,r){var i=Ln();r=r===void 0?null:r;var a=void 0;if(At!==null){var o=At.memoizedState;if(a=o.destroy,r!==null&&Hf(r,o.deps)){i.memoizedState=Bo(t,n,a,r);return}}ct.flags|=e,i.memoizedState=Bo(1|t,n,a,r)}function $m(e,t){return Ql(8390656,8,e,t)}function Wf(e,t){return ru(2048,8,e,t)}function xx(e,t){return ru(4,2,e,t)}function jx(e,t){return ru(4,4,e,t)}function bx(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function wx(e,t,n){return n=n!=null?n.concat([e]):null,ru(4,4,bx.bind(null,t,e),n)}function Gf(){}function Sx(e,t){var n=Ln();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Hf(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Ex(e,t){var n=Ln();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Hf(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Nx(e,t,n){return ui&21?(Zn(n,t)||(n=Iv(),ct.lanes|=n,di|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,an=!0),e.memoizedState=n)}function YS(e,t){var n=Ge;Ge=n!==0&&4>n?n:4,e(!0);var r=zu.transition;zu.transition={};try{e(!1),t()}finally{Ge=n,zu.transition=r}}function _x(){return Ln().memoizedState}function KS(e,t,n){var r=ms(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Ax(e))Cx(t,n);else if(n=lx(e,t,n,r),n!==null){var i=tn();Qn(n,e,r,i),kx(n,t,r)}}function JS(e,t,n){var r=ms(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Ax(e))Cx(t,i);else{var a=e.alternate;if(e.lanes===0&&(a===null||a.lanes===0)&&(a=t.lastRenderedReducer,a!==null))try{var o=t.lastRenderedState,l=a(o,n);if(i.hasEagerState=!0,i.eagerState=l,Zn(l,o)){var c=t.interleaved;c===null?(i.next=i,Uf(t)):(i.next=c.next,c.next=i),t.interleaved=i;return}}catch{}finally{}n=lx(e,t,i,r),n!==null&&(i=tn(),Qn(n,e,r,i),kx(n,t,r))}}function Ax(e){var t=e.alternate;return e===ct||t!==null&&t===ct}function Cx(e,t){go=Rc=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function kx(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Ef(e,n)}}var Tc={readContext:Pn,useCallback:qt,useContext:qt,useEffect:qt,useImperativeHandle:qt,useInsertionEffect:qt,useLayoutEffect:qt,useMemo:qt,useReducer:qt,useRef:qt,useState:qt,useDebugValue:qt,useDeferredValue:qt,useTransition:qt,useMutableSource:qt,useSyncExternalStore:qt,useId:qt,unstable_isNewReconciler:!1},QS={readContext:Pn,useCallback:function(e,t){return or().memoizedState=[e,t===void 0?null:t],e},useContext:Pn,useEffect:$m,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,Ql(4194308,4,bx.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Ql(4194308,4,e,t)},useInsertionEffect:function(e,t){return Ql(4,2,e,t)},useMemo:function(e,t){var n=or();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=or();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=KS.bind(null,ct,e),[r.memoizedState,e]},useRef:function(e){var t=or();return e={current:e},t.memoizedState=e},useState:Vm,useDebugValue:Gf,useDeferredValue:function(e){return or().memoizedState=e},useTransition:function(){var e=Vm(!1),t=e[0];return e=YS.bind(null,e[1]),or().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=ct,i=or();if(nt){if(n===void 0)throw Error(ee(407));n=n()}else{if(n=t(),Ot===null)throw Error(ee(349));ui&30||fx(r,t,n)}i.memoizedState=n;var a={value:n,getSnapshot:t};return i.queue=a,$m(mx.bind(null,r,a,e),[e]),r.flags|=2048,Bo(9,px.bind(null,r,a,n,t),void 0,null),n},useId:function(){var e=or(),t=Ot.identifierPrefix;if(nt){var n=Pr,r=Or;n=(r&~(1<<32-Jn(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=Mo++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=GS++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},ZS={readContext:Pn,useCallback:Sx,useContext:Pn,useEffect:Wf,useImperativeHandle:wx,useInsertionEffect:xx,useLayoutEffect:jx,useMemo:Ex,useReducer:Wu,useRef:vx,useState:function(){return Wu(Uo)},useDebugValue:Gf,useDeferredValue:function(e){var t=Ln();return Nx(t,At.memoizedState,e)},useTransition:function(){var e=Wu(Uo)[0],t=Ln().memoizedState;return[e,t]},useMutableSource:dx,useSyncExternalStore:hx,useId:_x,unstable_isNewReconciler:!1},XS={readContext:Pn,useCallback:Sx,useContext:Pn,useEffect:Wf,useImperativeHandle:wx,useInsertionEffect:xx,useLayoutEffect:jx,useMemo:Ex,useReducer:Gu,useRef:vx,useState:function(){return Gu(Uo)},useDebugValue:Gf,useDeferredValue:function(e){var t=Ln();return At===null?t.memoizedState=e:Nx(t,At.memoizedState,e)},useTransition:function(){var e=Gu(Uo)[0],t=Ln().memoizedState;return[e,t]},useMutableSource:dx,useSyncExternalStore:hx,useId:_x,unstable_isNewReconciler:!1};function qn(e,t){if(e&&e.defaultProps){t=ut({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function oh(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:ut({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var su={isMounted:function(e){return(e=e._reactInternals)?yi(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=tn(),i=ms(e),a=Dr(r,i);a.payload=t,n!=null&&(a.callback=n),t=fs(e,a,i),t!==null&&(Qn(t,e,i,r),Kl(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=tn(),i=ms(e),a=Dr(r,i);a.tag=1,a.payload=t,n!=null&&(a.callback=n),t=fs(e,a,i),t!==null&&(Qn(t,e,i,r),Kl(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=tn(),r=ms(e),i=Dr(n,r);i.tag=2,t!=null&&(i.callback=t),t=fs(e,i,r),t!==null&&(Qn(t,e,r,n),Kl(t,e,r))}};function Fm(e,t,n,r,i,a,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,a,o):t.prototype&&t.prototype.isPureReactComponent?!Ro(n,r)||!Ro(i,a):!0}function Ix(e,t,n){var r=!1,i=Ss,a=t.contextType;return typeof a=="object"&&a!==null?a=Pn(a):(i=un(t)?li:Kt.current,r=t.contextTypes,a=(r=r!=null)?la(e,i):Ss),t=new t(n,a),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=su,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=a),t}function Hm(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&su.enqueueReplaceState(t,t.state,null)}function lh(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs={},Bf(e);var a=t.contextType;typeof a=="object"&&a!==null?i.context=Pn(a):(a=un(t)?li:Kt.current,i.context=la(e,a)),i.state=e.memoizedState,a=t.getDerivedStateFromProps,typeof a=="function"&&(oh(e,t,a,n),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&su.enqueueReplaceState(i,i.state,null),kc(e,n,i,r),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function ha(e,t){try{var n="",r=t;do n+=Aw(r),r=r.return;while(r);var i=n}catch(a){i=`
Error generating stack: `+a.message+`
`+a.stack}return{value:e,source:t,stack:i,digest:null}}function Yu(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function ch(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var eE=typeof WeakMap=="function"?WeakMap:Map;function Rx(e,t,n){n=Dr(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Pc||(Pc=!0,xh=r),ch(e,t)},n}function Tx(e,t,n){n=Dr(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){ch(e,t)}}var a=e.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(n.callback=function(){ch(e,t),typeof r!="function"&&(ps===null?ps=new Set([this]):ps.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),n}function qm(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new eE;var i=new Set;r.set(t,i)}else i=r.get(t),i===void 0&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=pE.bind(null,e,t,n),t.then(e,e))}function zm(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Wm(e,t,n,r,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=Dr(-1,1),t.tag=2,fs(n,t,1))),n.lanes|=1),e)}var tE=Fr.ReactCurrentOwner,an=!1;function Xt(e,t,n,r){t.child=e===null?ox(t,null,n,r):ua(t,e.child,n,r)}function Gm(e,t,n,r,i){n=n.render;var a=t.ref;return ea(t,i),r=qf(e,t,n,r,a,i),n=zf(),e!==null&&!an?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,$r(e,t,i)):(nt&&n&&Tf(t),t.flags|=1,Xt(e,t,r,i),t.child)}function Ym(e,t,n,r,i){if(e===null){var a=n.type;return typeof a=="function"&&!tp(a)&&a.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=a,Ox(e,t,a,r,i)):(e=tc(n.type,null,r,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(a=e.child,!(e.lanes&i)){var o=a.memoizedProps;if(n=n.compare,n=n!==null?n:Ro,n(o,r)&&e.ref===t.ref)return $r(e,t,i)}return t.flags|=1,e=gs(a,r),e.ref=t.ref,e.return=t,t.child=e}function Ox(e,t,n,r,i){if(e!==null){var a=e.memoizedProps;if(Ro(a,r)&&e.ref===t.ref)if(an=!1,t.pendingProps=r=a,(e.lanes&i)!==0)e.flags&131072&&(an=!0);else return t.lanes=e.lanes,$r(e,t,i)}return uh(e,t,n,r,i)}function Px(e,t,n){var r=t.pendingProps,i=r.children,a=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Je(Wi,yn),yn|=n;else{if(!(n&1073741824))return e=a!==null?a.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Je(Wi,yn),yn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=a!==null?a.baseLanes:n,Je(Wi,yn),yn|=r}else a!==null?(r=a.baseLanes|n,t.memoizedState=null):r=n,Je(Wi,yn),yn|=r;return Xt(e,t,i,n),t.child}function Lx(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function uh(e,t,n,r,i){var a=un(n)?li:Kt.current;return a=la(t,a),ea(t,i),n=qf(e,t,n,r,a,i),r=zf(),e!==null&&!an?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,$r(e,t,i)):(nt&&r&&Tf(t),t.flags|=1,Xt(e,t,n,i),t.child)}function Km(e,t,n,r,i){if(un(n)){var a=!0;Ec(t)}else a=!1;if(ea(t,i),t.stateNode===null)Zl(e,t),Ix(t,n,r),lh(t,n,r,i),r=!0;else if(e===null){var o=t.stateNode,l=t.memoizedProps;o.props=l;var c=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=Pn(u):(u=un(n)?li:Kt.current,u=la(t,u));var d=n.getDerivedStateFromProps,p=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";p||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||c!==u)&&Hm(t,o,r,u),Zr=!1;var h=t.memoizedState;o.state=h,kc(t,r,o,i),c=t.memoizedState,l!==r||h!==c||cn.current||Zr?(typeof d=="function"&&(oh(t,n,d,r),c=t.memoizedState),(l=Zr||Fm(t,n,l,r,h,c,u))?(p||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),o.props=r,o.state=c,o.context=u,r=l):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,cx(e,t),l=t.memoizedProps,u=t.type===t.elementType?l:qn(t.type,l),o.props=u,p=t.pendingProps,h=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=Pn(c):(c=un(n)?li:Kt.current,c=la(t,c));var f=n.getDerivedStateFromProps;(d=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==p||h!==c)&&Hm(t,o,r,c),Zr=!1,h=t.memoizedState,o.state=h,kc(t,r,o,i);var y=t.memoizedState;l!==p||h!==y||cn.current||Zr?(typeof f=="function"&&(oh(t,n,f,r),y=t.memoizedState),(u=Zr||Fm(t,n,u,r,h,y,c)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,y,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,y,c)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=y),o.props=r,o.state=y,o.context=c,r=u):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return dh(e,t,n,r,a,i)}function dh(e,t,n,r,i,a){Lx(e,t);var o=(t.flags&128)!==0;if(!r&&!o)return i&&Pm(t,n,!1),$r(e,t,a);r=t.stateNode,tE.current=t;var l=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&o?(t.child=ua(t,e.child,null,a),t.child=ua(t,null,l,a)):Xt(e,t,l,a),t.memoizedState=r.state,i&&Pm(t,n,!0),t.child}function Dx(e){var t=e.stateNode;t.pendingContext?Om(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Om(e,t.context,!1),Vf(e,t.containerInfo)}function Jm(e,t,n,r,i){return ca(),Pf(i),t.flags|=256,Xt(e,t,n,r),t.child}var hh={dehydrated:null,treeContext:null,retryLane:0};function fh(e){return{baseLanes:e,cachePool:null,transitions:null}}function Mx(e,t,n){var r=t.pendingProps,i=ot.current,a=!1,o=(t.flags&128)!==0,l;if((l=o)||(l=e!==null&&e.memoizedState===null?!1:(i&2)!==0),l?(a=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),Je(ot,i&1),e===null)return ih(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=r.children,e=r.fallback,a?(r=t.mode,a=t.child,o={mode:"hidden",children:o},!(r&1)&&a!==null?(a.childLanes=0,a.pendingProps=o):a=ou(o,r,0,null),e=si(e,r,n,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=fh(n),t.memoizedState=hh,e):Yf(t,o));if(i=e.memoizedState,i!==null&&(l=i.dehydrated,l!==null))return nE(e,t,o,r,l,i,n);if(a){a=r.fallback,o=t.mode,i=e.child,l=i.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&t.child!==i?(r=t.child,r.childLanes=0,r.pendingProps=c,t.deletions=null):(r=gs(i,c),r.subtreeFlags=i.subtreeFlags&14680064),l!==null?a=gs(l,a):(a=si(a,o,n,null),a.flags|=2),a.return=t,r.return=t,r.sibling=a,t.child=r,r=a,a=t.child,o=e.child.memoizedState,o=o===null?fh(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},a.memoizedState=o,a.childLanes=e.childLanes&~n,t.memoizedState=hh,r}return a=e.child,e=a.sibling,r=gs(a,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function Yf(e,t){return t=ou({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Nl(e,t,n,r){return r!==null&&Pf(r),ua(t,e.child,null,n),e=Yf(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function nE(e,t,n,r,i,a,o){if(n)return t.flags&256?(t.flags&=-257,r=Yu(Error(ee(422))),Nl(e,t,o,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(a=r.fallback,i=t.mode,r=ou({mode:"visible",children:r.children},i,0,null),a=si(a,i,o,null),a.flags|=2,r.return=t,a.return=t,r.sibling=a,t.child=r,t.mode&1&&ua(t,e.child,null,o),t.child.memoizedState=fh(o),t.memoizedState=hh,a);if(!(t.mode&1))return Nl(e,t,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var l=r.dgst;return r=l,a=Error(ee(419)),r=Yu(a,r,void 0),Nl(e,t,o,r)}if(l=(o&e.childLanes)!==0,an||l){if(r=Ot,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==a.retryLane&&(a.retryLane=i,Vr(e,i),Qn(r,e,i,-1))}return ep(),r=Yu(Error(ee(421))),Nl(e,t,o,r)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=mE.bind(null,e),i._reactRetry=t,null):(e=a.treeContext,vn=hs(i.nextSibling),jn=t,nt=!0,Gn=null,e!==null&&(Cn[kn++]=Or,Cn[kn++]=Pr,Cn[kn++]=ci,Or=e.id,Pr=e.overflow,ci=t),t=Yf(t,r.children),t.flags|=4096,t)}function Qm(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),ah(e.return,t,n)}function Ku(e,t,n,r,i){var a=e.memoizedState;a===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailMode=i)}function Ux(e,t,n){var r=t.pendingProps,i=r.revealOrder,a=r.tail;if(Xt(e,t,r.children,n),r=ot.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Qm(e,n,t);else if(e.tag===19)Qm(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Je(ot,r),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;n!==null;)e=n.alternate,e!==null&&Ic(e)===null&&(i=n),n=n.sibling;n=i,n===null?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),Ku(t,!1,i,n,a);break;case"backwards":for(n=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&Ic(e)===null){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}Ku(t,!0,n,null,a);break;case"together":Ku(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Zl(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function $r(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),di|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(ee(153));if(t.child!==null){for(e=t.child,n=gs(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=gs(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function rE(e,t,n){switch(t.tag){case 3:Dx(t),ca();break;case 5:ux(t);break;case 1:un(t.type)&&Ec(t);break;case 4:Vf(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;Je(Ac,r._currentValue),r._currentValue=i;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(Je(ot,ot.current&1),t.flags|=128,null):n&t.child.childLanes?Mx(e,t,n):(Je(ot,ot.current&1),e=$r(e,t,n),e!==null?e.sibling:null);Je(ot,ot.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return Ux(e,t,n);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Je(ot,ot.current),r)break;return null;case 22:case 23:return t.lanes=0,Px(e,t,n)}return $r(e,t,n)}var Bx,ph,Vx,$x;Bx=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};ph=function(){};Vx=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,Qs(fr.current);var a=null;switch(n){case"input":i=Dd(e,i),r=Dd(e,r),a=[];break;case"select":i=ut({},i,{value:void 0}),r=ut({},r,{value:void 0}),a=[];break;case"textarea":i=Bd(e,i),r=Bd(e,r),a=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=wc)}$d(n,r);var o;n=null;for(u in i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var l=i[u];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Eo.hasOwnProperty(u)?a||(a=[]):(a=a||[]).push(u,null));for(u in r){var c=r[u];if(l=i!=null?i[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(a||(a=[]),a.push(u,n)),n=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(a=a||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(a=a||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Eo.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&Qe("scroll",e),a||l===c||(a=[])):(a=a||[]).push(u,c))}n&&(a=a||[]).push("style",n);var u=a;(t.updateQueue=u)&&(t.flags|=4)}};$x=function(e,t,n,r){n!==r&&(t.flags|=4)};function za(e,t){if(!nt)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function zt(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function sE(e,t,n){var r=t.pendingProps;switch(Of(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return zt(t),null;case 1:return un(t.type)&&Sc(),zt(t),null;case 3:return r=t.stateNode,da(),Xe(cn),Xe(Kt),Ff(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(Sl(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Gn!==null&&(wh(Gn),Gn=null))),ph(e,t),zt(t),null;case 5:$f(t);var i=Qs(Do.current);if(n=t.type,e!==null&&t.stateNode!=null)Vx(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(ee(166));return zt(t),null}if(e=Qs(fr.current),Sl(t)){r=t.stateNode,n=t.type;var a=t.memoizedProps;switch(r[lr]=t,r[Po]=a,e=(t.mode&1)!==0,n){case"dialog":Qe("cancel",r),Qe("close",r);break;case"iframe":case"object":case"embed":Qe("load",r);break;case"video":case"audio":for(i=0;i<ro.length;i++)Qe(ro[i],r);break;case"source":Qe("error",r);break;case"img":case"image":case"link":Qe("error",r),Qe("load",r);break;case"details":Qe("toggle",r);break;case"input":am(r,a),Qe("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!a.multiple},Qe("invalid",r);break;case"textarea":lm(r,a),Qe("invalid",r)}$d(n,a),i=null;for(var o in a)if(a.hasOwnProperty(o)){var l=a[o];o==="children"?typeof l=="string"?r.textContent!==l&&(a.suppressHydrationWarning!==!0&&wl(r.textContent,l,e),i=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(a.suppressHydrationWarning!==!0&&wl(r.textContent,l,e),i=["children",""+l]):Eo.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Qe("scroll",r)}switch(n){case"input":pl(r),om(r,a,!0);break;case"textarea":pl(r),cm(r);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(r.onclick=wc)}r=i,t.updateQueue=r,r!==null&&(t.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=mv(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=o.createElement(n,{is:r.is}):(e=o.createElement(n),n==="select"&&(o=e,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):e=o.createElementNS(e,n),e[lr]=t,e[Po]=r,Bx(e,t,!1,!1),t.stateNode=e;e:{switch(o=Fd(n,r),n){case"dialog":Qe("cancel",e),Qe("close",e),i=r;break;case"iframe":case"object":case"embed":Qe("load",e),i=r;break;case"video":case"audio":for(i=0;i<ro.length;i++)Qe(ro[i],e);i=r;break;case"source":Qe("error",e),i=r;break;case"img":case"image":case"link":Qe("error",e),Qe("load",e),i=r;break;case"details":Qe("toggle",e),i=r;break;case"input":am(e,r),i=Dd(e,r),Qe("invalid",e);break;case"option":i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=ut({},r,{value:void 0}),Qe("invalid",e);break;case"textarea":lm(e,r),i=Bd(e,r),Qe("invalid",e);break;default:i=r}$d(n,i),l=i;for(a in l)if(l.hasOwnProperty(a)){var c=l[a];a==="style"?vv(e,c):a==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&gv(e,c)):a==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&No(e,c):typeof c=="number"&&No(e,""+c):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(Eo.hasOwnProperty(a)?c!=null&&a==="onScroll"&&Qe("scroll",e):c!=null&&vf(e,a,c,o))}switch(n){case"input":pl(e),om(e,r,!1);break;case"textarea":pl(e),cm(e);break;case"option":r.value!=null&&e.setAttribute("value",""+ws(r.value));break;case"select":e.multiple=!!r.multiple,a=r.value,a!=null?Ji(e,!!r.multiple,a,!1):r.defaultValue!=null&&Ji(e,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=wc)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return zt(t),null;case 6:if(e&&t.stateNode!=null)$x(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(ee(166));if(n=Qs(Do.current),Qs(fr.current),Sl(t)){if(r=t.stateNode,n=t.memoizedProps,r[lr]=t,(a=r.nodeValue!==n)&&(e=jn,e!==null))switch(e.tag){case 3:wl(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&wl(r.nodeValue,n,(e.mode&1)!==0)}a&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[lr]=t,t.stateNode=r}return zt(t),null;case 13:if(Xe(ot),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(nt&&vn!==null&&t.mode&1&&!(t.flags&128))ix(),ca(),t.flags|=98560,a=!1;else if(a=Sl(t),r!==null&&r.dehydrated!==null){if(e===null){if(!a)throw Error(ee(318));if(a=t.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(ee(317));a[lr]=t}else ca(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;zt(t),a=!1}else Gn!==null&&(wh(Gn),Gn=null),a=!0;if(!a)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||ot.current&1?Ct===0&&(Ct=3):ep())),t.updateQueue!==null&&(t.flags|=4),zt(t),null);case 4:return da(),ph(e,t),e===null&&To(t.stateNode.containerInfo),zt(t),null;case 10:return Mf(t.type._context),zt(t),null;case 17:return un(t.type)&&Sc(),zt(t),null;case 19:if(Xe(ot),a=t.memoizedState,a===null)return zt(t),null;if(r=(t.flags&128)!==0,o=a.rendering,o===null)if(r)za(a,!1);else{if(Ct!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=Ic(e),o!==null){for(t.flags|=128,za(a,!1),r=o.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)a=n,e=r,a.flags&=14680066,o=a.alternate,o===null?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=o.childLanes,a.lanes=o.lanes,a.child=o.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=o.memoizedProps,a.memoizedState=o.memoizedState,a.updateQueue=o.updateQueue,a.type=o.type,e=o.dependencies,a.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Je(ot,ot.current&1|2),t.child}e=e.sibling}a.tail!==null&&vt()>fa&&(t.flags|=128,r=!0,za(a,!1),t.lanes=4194304)}else{if(!r)if(e=Ic(o),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),za(a,!0),a.tail===null&&a.tailMode==="hidden"&&!o.alternate&&!nt)return zt(t),null}else 2*vt()-a.renderingStartTime>fa&&n!==1073741824&&(t.flags|=128,r=!0,za(a,!1),t.lanes=4194304);a.isBackwards?(o.sibling=t.child,t.child=o):(n=a.last,n!==null?n.sibling=o:t.child=o,a.last=o)}return a.tail!==null?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=vt(),t.sibling=null,n=ot.current,Je(ot,r?n&1|2:n&1),t):(zt(t),null);case 22:case 23:return Xf(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?yn&1073741824&&(zt(t),t.subtreeFlags&6&&(t.flags|=8192)):zt(t),null;case 24:return null;case 25:return null}throw Error(ee(156,t.tag))}function iE(e,t){switch(Of(t),t.tag){case 1:return un(t.type)&&Sc(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return da(),Xe(cn),Xe(Kt),Ff(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return $f(t),null;case 13:if(Xe(ot),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(ee(340));ca()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Xe(ot),null;case 4:return da(),null;case 10:return Mf(t.type._context),null;case 22:case 23:return Xf(),null;case 24:return null;default:return null}}var _l=!1,Yt=!1,aE=typeof WeakSet=="function"?WeakSet:Set,de=null;function zi(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){ft(e,t,r)}else n.current=null}function mh(e,t,n){try{n()}catch(r){ft(e,t,r)}}var Zm=!1;function oE(e,t){if(Zd=xc,e=Wv(),Rf(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,a=r.focusNode;r=r.focusOffset;try{n.nodeType,a.nodeType}catch{n=null;break e}var o=0,l=-1,c=-1,u=0,d=0,p=e,h=null;t:for(;;){for(var f;p!==n||i!==0&&p.nodeType!==3||(l=o+i),p!==a||r!==0&&p.nodeType!==3||(c=o+r),p.nodeType===3&&(o+=p.nodeValue.length),(f=p.firstChild)!==null;)h=p,p=f;for(;;){if(p===e)break t;if(h===n&&++u===i&&(l=o),h===a&&++d===r&&(c=o),(f=p.nextSibling)!==null)break;p=h,h=p.parentNode}p=f}n=l===-1||c===-1?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(Xd={focusedElem:e,selectionRange:n},xc=!1,de=t;de!==null;)if(t=de,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,de=e;else for(;de!==null;){t=de;try{var y=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var j=y.memoizedProps,A=y.memoizedState,g=t.stateNode,x=g.getSnapshotBeforeUpdate(t.elementType===t.type?j:qn(t.type,j),A);g.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var w=t.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ee(163))}}catch(E){ft(t,t.return,E)}if(e=t.sibling,e!==null){e.return=t.return,de=e;break}de=t.return}return y=Zm,Zm=!1,y}function yo(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&e)===e){var a=i.destroy;i.destroy=void 0,a!==void 0&&mh(t,n,a)}i=i.next}while(i!==r)}}function iu(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function gh(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function Fx(e){var t=e.alternate;t!==null&&(e.alternate=null,Fx(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[lr],delete t[Po],delete t[nh],delete t[HS],delete t[qS])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Hx(e){return e.tag===5||e.tag===3||e.tag===4}function Xm(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Hx(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function yh(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=wc));else if(r!==4&&(e=e.child,e!==null))for(yh(e,t,n),e=e.sibling;e!==null;)yh(e,t,n),e=e.sibling}function vh(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(vh(e,t,n),e=e.sibling;e!==null;)vh(e,t,n),e=e.sibling}var Dt=null,zn=!1;function Wr(e,t,n){for(n=n.child;n!==null;)qx(e,t,n),n=n.sibling}function qx(e,t,n){if(hr&&typeof hr.onCommitFiberUnmount=="function")try{hr.onCommitFiberUnmount(Qc,n)}catch{}switch(n.tag){case 5:Yt||zi(n,t);case 6:var r=Dt,i=zn;Dt=null,Wr(e,t,n),Dt=r,zn=i,Dt!==null&&(zn?(e=Dt,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):Dt.removeChild(n.stateNode));break;case 18:Dt!==null&&(zn?(e=Dt,n=n.stateNode,e.nodeType===8?Fu(e.parentNode,n):e.nodeType===1&&Fu(e,n),ko(e)):Fu(Dt,n.stateNode));break;case 4:r=Dt,i=zn,Dt=n.stateNode.containerInfo,zn=!0,Wr(e,t,n),Dt=r,zn=i;break;case 0:case 11:case 14:case 15:if(!Yt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var a=i,o=a.destroy;a=a.tag,o!==void 0&&(a&2||a&4)&&mh(n,t,o),i=i.next}while(i!==r)}Wr(e,t,n);break;case 1:if(!Yt&&(zi(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){ft(n,t,l)}Wr(e,t,n);break;case 21:Wr(e,t,n);break;case 22:n.mode&1?(Yt=(r=Yt)||n.memoizedState!==null,Wr(e,t,n),Yt=r):Wr(e,t,n);break;default:Wr(e,t,n)}}function eg(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new aE),t.forEach(function(r){var i=gE.bind(null,e,r);n.has(r)||(n.add(r),r.then(i,i))})}}function $n(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var a=e,o=t,l=o;e:for(;l!==null;){switch(l.tag){case 5:Dt=l.stateNode,zn=!1;break e;case 3:Dt=l.stateNode.containerInfo,zn=!0;break e;case 4:Dt=l.stateNode.containerInfo,zn=!0;break e}l=l.return}if(Dt===null)throw Error(ee(160));qx(a,o,i),Dt=null,zn=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(u){ft(i,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)zx(t,e),t=t.sibling}function zx(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if($n(t,e),sr(e),r&4){try{yo(3,e,e.return),iu(3,e)}catch(j){ft(e,e.return,j)}try{yo(5,e,e.return)}catch(j){ft(e,e.return,j)}}break;case 1:$n(t,e),sr(e),r&512&&n!==null&&zi(n,n.return);break;case 5:if($n(t,e),sr(e),r&512&&n!==null&&zi(n,n.return),e.flags&32){var i=e.stateNode;try{No(i,"")}catch(j){ft(e,e.return,j)}}if(r&4&&(i=e.stateNode,i!=null)){var a=e.memoizedProps,o=n!==null?n.memoizedProps:a,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&a.type==="radio"&&a.name!=null&&fv(i,a),Fd(l,o);var u=Fd(l,a);for(o=0;o<c.length;o+=2){var d=c[o],p=c[o+1];d==="style"?vv(i,p):d==="dangerouslySetInnerHTML"?gv(i,p):d==="children"?No(i,p):vf(i,d,p,u)}switch(l){case"input":Md(i,a);break;case"textarea":pv(i,a);break;case"select":var h=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!a.multiple;var f=a.value;f!=null?Ji(i,!!a.multiple,f,!1):h!==!!a.multiple&&(a.defaultValue!=null?Ji(i,!!a.multiple,a.defaultValue,!0):Ji(i,!!a.multiple,a.multiple?[]:"",!1))}i[Po]=a}catch(j){ft(e,e.return,j)}}break;case 6:if($n(t,e),sr(e),r&4){if(e.stateNode===null)throw Error(ee(162));i=e.stateNode,a=e.memoizedProps;try{i.nodeValue=a}catch(j){ft(e,e.return,j)}}break;case 3:if($n(t,e),sr(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{ko(t.containerInfo)}catch(j){ft(e,e.return,j)}break;case 4:$n(t,e),sr(e);break;case 13:$n(t,e),sr(e),i=e.child,i.flags&8192&&(a=i.memoizedState!==null,i.stateNode.isHidden=a,!a||i.alternate!==null&&i.alternate.memoizedState!==null||(Qf=vt())),r&4&&eg(e);break;case 22:if(d=n!==null&&n.memoizedState!==null,e.mode&1?(Yt=(u=Yt)||d,$n(t,e),Yt=u):$n(t,e),sr(e),r&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!d&&e.mode&1)for(de=e,d=e.child;d!==null;){for(p=de=d;de!==null;){switch(h=de,f=h.child,h.tag){case 0:case 11:case 14:case 15:yo(4,h,h.return);break;case 1:zi(h,h.return);var y=h.stateNode;if(typeof y.componentWillUnmount=="function"){r=h,n=h.return;try{t=r,y.props=t.memoizedProps,y.state=t.memoizedState,y.componentWillUnmount()}catch(j){ft(r,n,j)}}break;case 5:zi(h,h.return);break;case 22:if(h.memoizedState!==null){ng(p);continue}}f!==null?(f.return=h,de=f):ng(p)}d=d.sibling}e:for(d=null,p=e;;){if(p.tag===5){if(d===null){d=p;try{i=p.stateNode,u?(a=i.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(l=p.stateNode,c=p.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=yv("display",o))}catch(j){ft(e,e.return,j)}}}else if(p.tag===6){if(d===null)try{p.stateNode.nodeValue=u?"":p.memoizedProps}catch(j){ft(e,e.return,j)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===e)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===e)break e;for(;p.sibling===null;){if(p.return===null||p.return===e)break e;d===p&&(d=null),p=p.return}d===p&&(d=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:$n(t,e),sr(e),r&4&&eg(e);break;case 21:break;default:$n(t,e),sr(e)}}function sr(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(Hx(n)){var r=n;break e}n=n.return}throw Error(ee(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(No(i,""),r.flags&=-33);var a=Xm(e);vh(e,a,i);break;case 3:case 4:var o=r.stateNode.containerInfo,l=Xm(e);yh(e,l,o);break;default:throw Error(ee(161))}}catch(c){ft(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function lE(e,t,n){de=e,Wx(e)}function Wx(e,t,n){for(var r=(e.mode&1)!==0;de!==null;){var i=de,a=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||_l;if(!o){var l=i.alternate,c=l!==null&&l.memoizedState!==null||Yt;l=_l;var u=Yt;if(_l=o,(Yt=c)&&!u)for(de=i;de!==null;)o=de,c=o.child,o.tag===22&&o.memoizedState!==null?rg(i):c!==null?(c.return=o,de=c):rg(i);for(;a!==null;)de=a,Wx(a),a=a.sibling;de=i,_l=l,Yt=u}tg(e)}else i.subtreeFlags&8772&&a!==null?(a.return=i,de=a):tg(e)}}function tg(e){for(;de!==null;){var t=de;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Yt||iu(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!Yt)if(n===null)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:qn(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;a!==null&&Bm(t,a,r);break;case 3:var o=t.updateQueue;if(o!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}Bm(t,o,n)}break;case 5:var l=t.stateNode;if(n===null&&t.flags&4){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var p=d.dehydrated;p!==null&&ko(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ee(163))}Yt||t.flags&512&&gh(t)}catch(h){ft(t,t.return,h)}}if(t===e){de=null;break}if(n=t.sibling,n!==null){n.return=t.return,de=n;break}de=t.return}}function ng(e){for(;de!==null;){var t=de;if(t===e){de=null;break}var n=t.sibling;if(n!==null){n.return=t.return,de=n;break}de=t.return}}function rg(e){for(;de!==null;){var t=de;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{iu(4,t)}catch(c){ft(t,n,c)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var i=t.return;try{r.componentDidMount()}catch(c){ft(t,i,c)}}var a=t.return;try{gh(t)}catch(c){ft(t,a,c)}break;case 5:var o=t.return;try{gh(t)}catch(c){ft(t,o,c)}}}catch(c){ft(t,t.return,c)}if(t===e){de=null;break}var l=t.sibling;if(l!==null){l.return=t.return,de=l;break}de=t.return}}var cE=Math.ceil,Oc=Fr.ReactCurrentDispatcher,Kf=Fr.ReactCurrentOwner,On=Fr.ReactCurrentBatchConfig,Ve=0,Ot=null,bt=null,$t=0,yn=0,Wi=_s(0),Ct=0,Vo=null,di=0,au=0,Jf=0,vo=null,sn=null,Qf=0,fa=1/0,Cr=null,Pc=!1,xh=null,ps=null,Al=!1,is=null,Lc=0,xo=0,jh=null,Xl=-1,ec=0;function tn(){return Ve&6?vt():Xl!==-1?Xl:Xl=vt()}function ms(e){return e.mode&1?Ve&2&&$t!==0?$t&-$t:WS.transition!==null?(ec===0&&(ec=Iv()),ec):(e=Ge,e!==0||(e=window.event,e=e===void 0?16:Mv(e.type)),e):1}function Qn(e,t,n,r){if(50<xo)throw xo=0,jh=null,Error(ee(185));tl(e,n,r),(!(Ve&2)||e!==Ot)&&(e===Ot&&(!(Ve&2)&&(au|=n),Ct===4&&es(e,$t)),dn(e,r),n===1&&Ve===0&&!(t.mode&1)&&(fa=vt()+500,nu&&As()))}function dn(e,t){var n=e.callbackNode;Ww(e,t);var r=vc(e,e===Ot?$t:0);if(r===0)n!==null&&hm(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&hm(n),t===1)e.tag===0?zS(sg.bind(null,e)):nx(sg.bind(null,e)),$S(function(){!(Ve&6)&&As()}),n=null;else{switch(Rv(r)){case 1:n=Sf;break;case 4:n=Cv;break;case 16:n=yc;break;case 536870912:n=kv;break;default:n=yc}n=ej(n,Gx.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function Gx(e,t){if(Xl=-1,ec=0,Ve&6)throw Error(ee(327));var n=e.callbackNode;if(ta()&&e.callbackNode!==n)return null;var r=vc(e,e===Ot?$t:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=Dc(e,r);else{t=r;var i=Ve;Ve|=2;var a=Kx();(Ot!==e||$t!==t)&&(Cr=null,fa=vt()+500,ri(e,t));do try{hE();break}catch(l){Yx(e,l)}while(!0);Df(),Oc.current=a,Ve=i,bt!==null?t=0:(Ot=null,$t=0,t=Ct)}if(t!==0){if(t===2&&(i=Gd(e),i!==0&&(r=i,t=bh(e,i))),t===1)throw n=Vo,ri(e,0),es(e,r),dn(e,vt()),n;if(t===6)es(e,r);else{if(i=e.current.alternate,!(r&30)&&!uE(i)&&(t=Dc(e,r),t===2&&(a=Gd(e),a!==0&&(r=a,t=bh(e,a))),t===1))throw n=Vo,ri(e,0),es(e,r),dn(e,vt()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(ee(345));case 2:zs(e,sn,Cr);break;case 3:if(es(e,r),(r&130023424)===r&&(t=Qf+500-vt(),10<t)){if(vc(e,0)!==0)break;if(i=e.suspendedLanes,(i&r)!==r){tn(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=th(zs.bind(null,e,sn,Cr),t);break}zs(e,sn,Cr);break;case 4:if(es(e,r),(r&4194240)===r)break;for(t=e.eventTimes,i=-1;0<r;){var o=31-Jn(r);a=1<<o,o=t[o],o>i&&(i=o),r&=~a}if(r=i,r=vt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*cE(r/1960))-r,10<r){e.timeoutHandle=th(zs.bind(null,e,sn,Cr),r);break}zs(e,sn,Cr);break;case 5:zs(e,sn,Cr);break;default:throw Error(ee(329))}}}return dn(e,vt()),e.callbackNode===n?Gx.bind(null,e):null}function bh(e,t){var n=vo;return e.current.memoizedState.isDehydrated&&(ri(e,t).flags|=256),e=Dc(e,t),e!==2&&(t=sn,sn=n,t!==null&&wh(t)),e}function wh(e){sn===null?sn=e:sn.push.apply(sn,e)}function uE(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],a=i.getSnapshot;i=i.value;try{if(!Zn(a(),i))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function es(e,t){for(t&=~Jf,t&=~au,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-Jn(t),r=1<<n;e[n]=-1,t&=~r}}function sg(e){if(Ve&6)throw Error(ee(327));ta();var t=vc(e,0);if(!(t&1))return dn(e,vt()),null;var n=Dc(e,t);if(e.tag!==0&&n===2){var r=Gd(e);r!==0&&(t=r,n=bh(e,r))}if(n===1)throw n=Vo,ri(e,0),es(e,t),dn(e,vt()),n;if(n===6)throw Error(ee(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,zs(e,sn,Cr),dn(e,vt()),null}function Zf(e,t){var n=Ve;Ve|=1;try{return e(t)}finally{Ve=n,Ve===0&&(fa=vt()+500,nu&&As())}}function hi(e){is!==null&&is.tag===0&&!(Ve&6)&&ta();var t=Ve;Ve|=1;var n=On.transition,r=Ge;try{if(On.transition=null,Ge=1,e)return e()}finally{Ge=r,On.transition=n,Ve=t,!(Ve&6)&&As()}}function Xf(){yn=Wi.current,Xe(Wi)}function ri(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,VS(n)),bt!==null)for(n=bt.return;n!==null;){var r=n;switch(Of(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Sc();break;case 3:da(),Xe(cn),Xe(Kt),Ff();break;case 5:$f(r);break;case 4:da();break;case 13:Xe(ot);break;case 19:Xe(ot);break;case 10:Mf(r.type._context);break;case 22:case 23:Xf()}n=n.return}if(Ot=e,bt=e=gs(e.current,null),$t=yn=t,Ct=0,Vo=null,Jf=au=di=0,sn=vo=null,Js!==null){for(t=0;t<Js.length;t++)if(n=Js[t],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,a=n.pending;if(a!==null){var o=a.next;a.next=i,r.next=o}n.pending=r}Js=null}return e}function Yx(e,t){do{var n=bt;try{if(Df(),Jl.current=Tc,Rc){for(var r=ct.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Rc=!1}if(ui=0,Tt=At=ct=null,go=!1,Mo=0,Kf.current=null,n===null||n.return===null){Ct=1,Vo=t,bt=null;break}e:{var a=e,o=n.return,l=n,c=t;if(t=$t,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=l,p=d.tag;if(!(d.mode&1)&&(p===0||p===11||p===15)){var h=d.alternate;h?(d.updateQueue=h.updateQueue,d.memoizedState=h.memoizedState,d.lanes=h.lanes):(d.updateQueue=null,d.memoizedState=null)}var f=zm(o);if(f!==null){f.flags&=-257,Wm(f,o,l,a,t),f.mode&1&&qm(a,u,t),t=f,c=u;var y=t.updateQueue;if(y===null){var j=new Set;j.add(c),t.updateQueue=j}else y.add(c);break e}else{if(!(t&1)){qm(a,u,t),ep();break e}c=Error(ee(426))}}else if(nt&&l.mode&1){var A=zm(o);if(A!==null){!(A.flags&65536)&&(A.flags|=256),Wm(A,o,l,a,t),Pf(ha(c,l));break e}}a=c=ha(c,l),Ct!==4&&(Ct=2),vo===null?vo=[a]:vo.push(a),a=o;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t;var g=Rx(a,c,t);Um(a,g);break e;case 1:l=c;var x=a.type,w=a.stateNode;if(!(a.flags&128)&&(typeof x.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(ps===null||!ps.has(w)))){a.flags|=65536,t&=-t,a.lanes|=t;var E=Tx(a,l,t);Um(a,E);break e}}a=a.return}while(a!==null)}Qx(n)}catch(_){t=_,bt===n&&n!==null&&(bt=n=n.return);continue}break}while(!0)}function Kx(){var e=Oc.current;return Oc.current=Tc,e===null?Tc:e}function ep(){(Ct===0||Ct===3||Ct===2)&&(Ct=4),Ot===null||!(di&268435455)&&!(au&268435455)||es(Ot,$t)}function Dc(e,t){var n=Ve;Ve|=2;var r=Kx();(Ot!==e||$t!==t)&&(Cr=null,ri(e,t));do try{dE();break}catch(i){Yx(e,i)}while(!0);if(Df(),Ve=n,Oc.current=r,bt!==null)throw Error(ee(261));return Ot=null,$t=0,Ct}function dE(){for(;bt!==null;)Jx(bt)}function hE(){for(;bt!==null&&!Mw();)Jx(bt)}function Jx(e){var t=Xx(e.alternate,e,yn);e.memoizedProps=e.pendingProps,t===null?Qx(e):bt=t,Kf.current=null}function Qx(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=iE(n,t),n!==null){n.flags&=32767,bt=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Ct=6,bt=null;return}}else if(n=sE(n,t,yn),n!==null){bt=n;return}if(t=t.sibling,t!==null){bt=t;return}bt=t=e}while(t!==null);Ct===0&&(Ct=5)}function zs(e,t,n){var r=Ge,i=On.transition;try{On.transition=null,Ge=1,fE(e,t,n,r)}finally{On.transition=i,Ge=r}return null}function fE(e,t,n,r){do ta();while(is!==null);if(Ve&6)throw Error(ee(327));n=e.finishedWork;var i=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(ee(177));e.callbackNode=null,e.callbackPriority=0;var a=n.lanes|n.childLanes;if(Gw(e,a),e===Ot&&(bt=Ot=null,$t=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Al||(Al=!0,ej(yc,function(){return ta(),null})),a=(n.flags&15990)!==0,n.subtreeFlags&15990||a){a=On.transition,On.transition=null;var o=Ge;Ge=1;var l=Ve;Ve|=4,Kf.current=null,oE(e,n),zx(n,e),OS(Xd),xc=!!Zd,Xd=Zd=null,e.current=n,lE(n),Uw(),Ve=l,Ge=o,On.transition=a}else e.current=n;if(Al&&(Al=!1,is=e,Lc=i),a=e.pendingLanes,a===0&&(ps=null),$w(n.stateNode),dn(e,vt()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Pc)throw Pc=!1,e=xh,xh=null,e;return Lc&1&&e.tag!==0&&ta(),a=e.pendingLanes,a&1?e===jh?xo++:(xo=0,jh=e):xo=0,As(),null}function ta(){if(is!==null){var e=Rv(Lc),t=On.transition,n=Ge;try{if(On.transition=null,Ge=16>e?16:e,is===null)var r=!1;else{if(e=is,is=null,Lc=0,Ve&6)throw Error(ee(331));var i=Ve;for(Ve|=4,de=e.current;de!==null;){var a=de,o=a.child;if(de.flags&16){var l=a.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(de=u;de!==null;){var d=de;switch(d.tag){case 0:case 11:case 15:yo(8,d,a)}var p=d.child;if(p!==null)p.return=d,de=p;else for(;de!==null;){d=de;var h=d.sibling,f=d.return;if(Fx(d),d===u){de=null;break}if(h!==null){h.return=f,de=h;break}de=f}}}var y=a.alternate;if(y!==null){var j=y.child;if(j!==null){y.child=null;do{var A=j.sibling;j.sibling=null,j=A}while(j!==null)}}de=a}}if(a.subtreeFlags&2064&&o!==null)o.return=a,de=o;else e:for(;de!==null;){if(a=de,a.flags&2048)switch(a.tag){case 0:case 11:case 15:yo(9,a,a.return)}var g=a.sibling;if(g!==null){g.return=a.return,de=g;break e}de=a.return}}var x=e.current;for(de=x;de!==null;){o=de;var w=o.child;if(o.subtreeFlags&2064&&w!==null)w.return=o,de=w;else e:for(o=x;de!==null;){if(l=de,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:iu(9,l)}}catch(_){ft(l,l.return,_)}if(l===o){de=null;break e}var E=l.sibling;if(E!==null){E.return=l.return,de=E;break e}de=l.return}}if(Ve=i,As(),hr&&typeof hr.onPostCommitFiberRoot=="function")try{hr.onPostCommitFiberRoot(Qc,e)}catch{}r=!0}return r}finally{Ge=n,On.transition=t}}return!1}function ig(e,t,n){t=ha(n,t),t=Rx(e,t,1),e=fs(e,t,1),t=tn(),e!==null&&(tl(e,1,t),dn(e,t))}function ft(e,t,n){if(e.tag===3)ig(e,e,n);else for(;t!==null;){if(t.tag===3){ig(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(ps===null||!ps.has(r))){e=ha(n,e),e=Tx(t,e,1),t=fs(t,e,1),e=tn(),t!==null&&(tl(t,1,e),dn(t,e));break}}t=t.return}}function pE(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=tn(),e.pingedLanes|=e.suspendedLanes&n,Ot===e&&($t&n)===n&&(Ct===4||Ct===3&&($t&130023424)===$t&&500>vt()-Qf?ri(e,0):Jf|=n),dn(e,t)}function Zx(e,t){t===0&&(e.mode&1?(t=yl,yl<<=1,!(yl&130023424)&&(yl=4194304)):t=1);var n=tn();e=Vr(e,t),e!==null&&(tl(e,t,n),dn(e,n))}function mE(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Zx(e,n)}function gE(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(ee(314))}r!==null&&r.delete(t),Zx(e,n)}var Xx;Xx=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||cn.current)an=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return an=!1,rE(e,t,n);an=!!(e.flags&131072)}else an=!1,nt&&t.flags&1048576&&rx(t,_c,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Zl(e,t),e=t.pendingProps;var i=la(t,Kt.current);ea(t,n),i=qf(null,t,r,e,i,n);var a=zf();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,un(r)?(a=!0,Ec(t)):a=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Bf(t),i.updater=su,t.stateNode=i,i._reactInternals=t,lh(t,r,e,n),t=dh(null,t,r,!0,a,n)):(t.tag=0,nt&&a&&Tf(t),Xt(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Zl(e,t),e=t.pendingProps,i=r._init,r=i(r._payload),t.type=r,i=t.tag=vE(r),e=qn(r,e),i){case 0:t=uh(null,t,r,e,n);break e;case 1:t=Km(null,t,r,e,n);break e;case 11:t=Gm(null,t,r,e,n);break e;case 14:t=Ym(null,t,r,qn(r.type,e),n);break e}throw Error(ee(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:qn(r,i),uh(e,t,r,i,n);case 1:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:qn(r,i),Km(e,t,r,i,n);case 3:e:{if(Dx(t),e===null)throw Error(ee(387));r=t.pendingProps,a=t.memoizedState,i=a.element,cx(e,t),kc(t,r,null,n);var o=t.memoizedState;if(r=o.element,a.isDehydrated)if(a={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=a,t.memoizedState=a,t.flags&256){i=ha(Error(ee(423)),t),t=Jm(e,t,r,n,i);break e}else if(r!==i){i=ha(Error(ee(424)),t),t=Jm(e,t,r,n,i);break e}else for(vn=hs(t.stateNode.containerInfo.firstChild),jn=t,nt=!0,Gn=null,n=ox(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(ca(),r===i){t=$r(e,t,n);break e}Xt(e,t,r,n)}t=t.child}return t;case 5:return ux(t),e===null&&ih(t),r=t.type,i=t.pendingProps,a=e!==null?e.memoizedProps:null,o=i.children,eh(r,i)?o=null:a!==null&&eh(r,a)&&(t.flags|=32),Lx(e,t),Xt(e,t,o,n),t.child;case 6:return e===null&&ih(t),null;case 13:return Mx(e,t,n);case 4:return Vf(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=ua(t,null,r,n):Xt(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:qn(r,i),Gm(e,t,r,i,n);case 7:return Xt(e,t,t.pendingProps,n),t.child;case 8:return Xt(e,t,t.pendingProps.children,n),t.child;case 12:return Xt(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,a=t.memoizedProps,o=i.value,Je(Ac,r._currentValue),r._currentValue=o,a!==null)if(Zn(a.value,o)){if(a.children===i.children&&!cn.current){t=$r(e,t,n);break e}}else for(a=t.child,a!==null&&(a.return=t);a!==null;){var l=a.dependencies;if(l!==null){o=a.child;for(var c=l.firstContext;c!==null;){if(c.context===r){if(a.tag===1){c=Dr(-1,n&-n),c.tag=2;var u=a.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}a.lanes|=n,c=a.alternate,c!==null&&(c.lanes|=n),ah(a.return,n,t),l.lanes|=n;break}c=c.next}}else if(a.tag===10)o=a.type===t.type?null:a.child;else if(a.tag===18){if(o=a.return,o===null)throw Error(ee(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),ah(o,n,t),o=a.sibling}else o=a.child;if(o!==null)o.return=a;else for(o=a;o!==null;){if(o===t){o=null;break}if(a=o.sibling,a!==null){a.return=o.return,o=a;break}o=o.return}a=o}Xt(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,ea(t,n),i=Pn(i),r=r(i),t.flags|=1,Xt(e,t,r,n),t.child;case 14:return r=t.type,i=qn(r,t.pendingProps),i=qn(r.type,i),Ym(e,t,r,i,n);case 15:return Ox(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:qn(r,i),Zl(e,t),t.tag=1,un(r)?(e=!0,Ec(t)):e=!1,ea(t,n),Ix(t,r,i),lh(t,r,i,n),dh(null,t,r,!0,e,n);case 19:return Ux(e,t,n);case 22:return Px(e,t,n)}throw Error(ee(156,t.tag))};function ej(e,t){return Av(e,t)}function yE(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Tn(e,t,n,r){return new yE(e,t,n,r)}function tp(e){return e=e.prototype,!(!e||!e.isReactComponent)}function vE(e){if(typeof e=="function")return tp(e)?1:0;if(e!=null){if(e=e.$$typeof,e===jf)return 11;if(e===bf)return 14}return 2}function gs(e,t){var n=e.alternate;return n===null?(n=Tn(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function tc(e,t,n,r,i,a){var o=2;if(r=e,typeof e=="function")tp(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case Di:return si(n.children,i,a,t);case xf:o=8,i|=8;break;case Td:return e=Tn(12,n,t,i|2),e.elementType=Td,e.lanes=a,e;case Od:return e=Tn(13,n,t,i),e.elementType=Od,e.lanes=a,e;case Pd:return e=Tn(19,n,t,i),e.elementType=Pd,e.lanes=a,e;case uv:return ou(n,i,a,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case lv:o=10;break e;case cv:o=9;break e;case jf:o=11;break e;case bf:o=14;break e;case Qr:o=16,r=null;break e}throw Error(ee(130,e==null?e:typeof e,""))}return t=Tn(o,n,t,i),t.elementType=e,t.type=r,t.lanes=a,t}function si(e,t,n,r){return e=Tn(7,e,r,t),e.lanes=n,e}function ou(e,t,n,r){return e=Tn(22,e,r,t),e.elementType=uv,e.lanes=n,e.stateNode={isHidden:!1},e}function Ju(e,t,n){return e=Tn(6,e,null,t),e.lanes=n,e}function Qu(e,t,n){return t=Tn(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function xE(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ru(0),this.expirationTimes=Ru(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ru(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function np(e,t,n,r,i,a,o,l,c){return e=new xE(e,t,n,l,c),t===1?(t=1,a===!0&&(t|=8)):t=0,a=Tn(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Bf(a),e}function jE(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Li,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function tj(e){if(!e)return Ss;e=e._reactInternals;e:{if(yi(e)!==e||e.tag!==1)throw Error(ee(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(un(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(ee(171))}if(e.tag===1){var n=e.type;if(un(n))return tx(e,n,t)}return t}function nj(e,t,n,r,i,a,o,l,c){return e=np(n,r,!0,e,i,a,o,l,c),e.context=tj(null),n=e.current,r=tn(),i=ms(n),a=Dr(r,i),a.callback=t??null,fs(n,a,i),e.current.lanes=i,tl(e,i,r),dn(e,r),e}function lu(e,t,n,r){var i=t.current,a=tn(),o=ms(i);return n=tj(n),t.context===null?t.context=n:t.pendingContext=n,t=Dr(a,o),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=fs(i,t,o),e!==null&&(Qn(e,i,o,a),Kl(e,i,o)),o}function Mc(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function ag(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function rp(e,t){ag(e,t),(e=e.alternate)&&ag(e,t)}function bE(){return null}var rj=typeof reportError=="function"?reportError:function(e){console.error(e)};function sp(e){this._internalRoot=e}cu.prototype.render=sp.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(ee(409));lu(e,t,null,null)};cu.prototype.unmount=sp.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;hi(function(){lu(null,e,null,null)}),t[Br]=null}};function cu(e){this._internalRoot=e}cu.prototype.unstable_scheduleHydration=function(e){if(e){var t=Pv();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Xr.length&&t!==0&&t<Xr[n].priority;n++);Xr.splice(n,0,e),n===0&&Dv(e)}};function ip(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function uu(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function og(){}function wE(e,t,n,r,i){if(i){if(typeof r=="function"){var a=r;r=function(){var u=Mc(o);a.call(u)}}var o=nj(t,r,e,0,null,!1,!1,"",og);return e._reactRootContainer=o,e[Br]=o.current,To(e.nodeType===8?e.parentNode:e),hi(),o}for(;i=e.lastChild;)e.removeChild(i);if(typeof r=="function"){var l=r;r=function(){var u=Mc(c);l.call(u)}}var c=np(e,0,!1,null,null,!1,!1,"",og);return e._reactRootContainer=c,e[Br]=c.current,To(e.nodeType===8?e.parentNode:e),hi(function(){lu(t,c,n,r)}),c}function du(e,t,n,r,i){var a=n._reactRootContainer;if(a){var o=a;if(typeof i=="function"){var l=i;i=function(){var c=Mc(o);l.call(c)}}lu(t,o,e,i)}else o=wE(n,t,e,i,r);return Mc(o)}Tv=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=no(t.pendingLanes);n!==0&&(Ef(t,n|1),dn(t,vt()),!(Ve&6)&&(fa=vt()+500,As()))}break;case 13:hi(function(){var r=Vr(e,1);if(r!==null){var i=tn();Qn(r,e,1,i)}}),rp(e,1)}};Nf=function(e){if(e.tag===13){var t=Vr(e,134217728);if(t!==null){var n=tn();Qn(t,e,134217728,n)}rp(e,134217728)}};Ov=function(e){if(e.tag===13){var t=ms(e),n=Vr(e,t);if(n!==null){var r=tn();Qn(n,e,t,r)}rp(e,t)}};Pv=function(){return Ge};Lv=function(e,t){var n=Ge;try{return Ge=e,t()}finally{Ge=n}};qd=function(e,t,n){switch(t){case"input":if(Md(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=tu(r);if(!i)throw Error(ee(90));hv(r),Md(r,i)}}}break;case"textarea":pv(e,n);break;case"select":t=n.value,t!=null&&Ji(e,!!n.multiple,t,!1)}};bv=Zf;wv=hi;var SE={usingClientEntryPoint:!1,Events:[rl,Vi,tu,xv,jv,Zf]},Wa={findFiberByHostInstance:Ks,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},EE={bundleType:Wa.bundleType,version:Wa.version,rendererPackageName:Wa.rendererPackageName,rendererConfig:Wa.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Fr.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Nv(e),e===null?null:e.stateNode},findFiberByHostInstance:Wa.findFiberByHostInstance||bE,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Cl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Cl.isDisabled&&Cl.supportsFiber)try{Qc=Cl.inject(EE),hr=Cl}catch{}}wn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=SE;wn.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ip(t))throw Error(ee(200));return jE(e,t,null,n)};wn.createRoot=function(e,t){if(!ip(e))throw Error(ee(299));var n=!1,r="",i=rj;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=np(e,1,!1,null,null,n,!1,r,i),e[Br]=t.current,To(e.nodeType===8?e.parentNode:e),new sp(t)};wn.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(ee(188)):(e=Object.keys(e).join(","),Error(ee(268,e)));return e=Nv(t),e=e===null?null:e.stateNode,e};wn.flushSync=function(e){return hi(e)};wn.hydrate=function(e,t,n){if(!uu(t))throw Error(ee(200));return du(null,e,t,!0,n)};wn.hydrateRoot=function(e,t,n){if(!ip(e))throw Error(ee(405));var r=n!=null&&n.hydratedSources||null,i=!1,a="",o=rj;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(a=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),t=nj(t,null,e,1,n??null,i,!1,a,o),e[Br]=t.current,To(e),r)for(e=0;e<r.length;e++)n=r[e],i=n._getVersion,i=i(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new cu(t)};wn.render=function(e,t,n){if(!uu(t))throw Error(ee(200));return du(null,e,t,!1,n)};wn.unmountComponentAtNode=function(e){if(!uu(e))throw Error(ee(40));return e._reactRootContainer?(hi(function(){du(null,null,e,!1,function(){e._reactRootContainer=null,e[Br]=null})}),!0):!1};wn.unstable_batchedUpdates=Zf;wn.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!uu(n))throw Error(ee(200));if(e==null||e._reactInternals===void 0)throw Error(ee(38));return du(e,t,n,!1,r)};wn.version="18.3.1-next-f1338f8080-20240426";function sj(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(sj)}catch(e){console.error(e)}}sj(),sv.exports=wn;var NE=sv.exports,lg=NE;Id.createRoot=lg.createRoot,Id.hydrateRoot=lg.hydrateRoot;/**
 * @remix-run/router v1.23.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function $o(){return $o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},$o.apply(this,arguments)}var as;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(as||(as={}));const cg="popstate";function _E(e){e===void 0&&(e={});function t(r,i){let{pathname:a,search:o,hash:l}=r.location;return Sh("",{pathname:a,search:o,hash:l},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(r,i){return typeof i=="string"?i:Uc(i)}return CE(t,n,null,e)}function xt(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function ap(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function AE(){return Math.random().toString(36).substr(2,8)}function ug(e,t){return{usr:e.state,key:e.key,idx:t}}function Sh(e,t,n,r){return n===void 0&&(n=null),$o({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?Ea(t):t,{state:n,key:t&&t.key||r||AE()})}function Uc(e){let{pathname:t="/",search:n="",hash:r=""}=e;return n&&n!=="?"&&(t+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(t+=r.charAt(0)==="#"?r:"#"+r),t}function Ea(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}function CE(e,t,n,r){r===void 0&&(r={});let{window:i=document.defaultView,v5Compat:a=!1}=r,o=i.history,l=as.Pop,c=null,u=d();u==null&&(u=0,o.replaceState($o({},o.state,{idx:u}),""));function d(){return(o.state||{idx:null}).idx}function p(){l=as.Pop;let A=d(),g=A==null?null:A-u;u=A,c&&c({action:l,location:j.location,delta:g})}function h(A,g){l=as.Push;let x=Sh(j.location,A,g);u=d()+1;let w=ug(x,u),E=j.createHref(x);try{o.pushState(w,"",E)}catch(_){if(_ instanceof DOMException&&_.name==="DataCloneError")throw _;i.location.assign(E)}a&&c&&c({action:l,location:j.location,delta:1})}function f(A,g){l=as.Replace;let x=Sh(j.location,A,g);u=d();let w=ug(x,u),E=j.createHref(x);o.replaceState(w,"",E),a&&c&&c({action:l,location:j.location,delta:0})}function y(A){let g=i.location.origin!=="null"?i.location.origin:i.location.href,x=typeof A=="string"?A:Uc(A);return x=x.replace(/ $/,"%20"),xt(g,"No window.location.(origin|href) available to create URL for href: "+x),new URL(x,g)}let j={get action(){return l},get location(){return e(i,o)},listen(A){if(c)throw new Error("A history only accepts one active listener");return i.addEventListener(cg,p),c=A,()=>{i.removeEventListener(cg,p),c=null}},createHref(A){return t(i,A)},createURL:y,encodeLocation(A){let g=y(A);return{pathname:g.pathname,search:g.search,hash:g.hash}},push:h,replace:f,go(A){return o.go(A)}};return j}var dg;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(dg||(dg={}));function kE(e,t,n){return n===void 0&&(n="/"),IE(e,t,n)}function IE(e,t,n,r){let i=typeof t=="string"?Ea(t):t,a=op(i.pathname||"/",n);if(a==null)return null;let o=ij(e);RE(o);let l=null;for(let c=0;l==null&&c<o.length;++c){let u=HE(a);l=VE(o[c],u)}return l}function ij(e,t,n,r){t===void 0&&(t=[]),n===void 0&&(n=[]),r===void 0&&(r="");let i=(a,o,l)=>{let c={relativePath:l===void 0?a.path||"":l,caseSensitive:a.caseSensitive===!0,childrenIndex:o,route:a};c.relativePath.startsWith("/")&&(xt(c.relativePath.startsWith(r),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(r.length));let u=ys([r,c.relativePath]),d=n.concat(c);a.children&&a.children.length>0&&(xt(a.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),ij(a.children,t,d,u)),!(a.path==null&&!a.index)&&t.push({path:u,score:UE(u,a.index),routesMeta:d})};return e.forEach((a,o)=>{var l;if(a.path===""||!((l=a.path)!=null&&l.includes("?")))i(a,o);else for(let c of aj(a.path))i(a,o,c)}),t}function aj(e){let t=e.split("/");if(t.length===0)return[];let[n,...r]=t,i=n.endsWith("?"),a=n.replace(/\?$/,"");if(r.length===0)return i?[a,""]:[a];let o=aj(r.join("/")),l=[];return l.push(...o.map(c=>c===""?a:[a,c].join("/"))),i&&l.push(...o),l.map(c=>e.startsWith("/")&&c===""?"/":c)}function RE(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:BE(t.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const TE=/^:[\w-]+$/,OE=3,PE=2,LE=1,DE=10,ME=-2,hg=e=>e==="*";function UE(e,t){let n=e.split("/"),r=n.length;return n.some(hg)&&(r+=ME),t&&(r+=PE),n.filter(i=>!hg(i)).reduce((i,a)=>i+(TE.test(a)?OE:a===""?LE:DE),r)}function BE(e,t){return e.length===t.length&&e.slice(0,-1).every((r,i)=>r===t[i])?e[e.length-1]-t[t.length-1]:0}function VE(e,t,n){let{routesMeta:r}=e,i={},a="/",o=[];for(let l=0;l<r.length;++l){let c=r[l],u=l===r.length-1,d=a==="/"?t:t.slice(a.length)||"/",p=$E({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},d),h=c.route;if(!p)return null;Object.assign(i,p.params),o.push({params:i,pathname:ys([a,p.pathname]),pathnameBase:YE(ys([a,p.pathnameBase])),route:h}),p.pathnameBase!=="/"&&(a=ys([a,p.pathnameBase]))}return o}function $E(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=FE(e.path,e.caseSensitive,e.end),i=t.match(n);if(!i)return null;let a=i[0],o=a.replace(/(.)\/+$/,"$1"),l=i.slice(1);return{params:r.reduce((u,d,p)=>{let{paramName:h,isOptional:f}=d;if(h==="*"){let j=l[p]||"";o=a.slice(0,a.length-j.length).replace(/(.)\/+$/,"$1")}const y=l[p];return f&&!y?u[h]=void 0:u[h]=(y||"").replace(/%2F/g,"/"),u},{}),pathname:a,pathnameBase:o,pattern:e}}function FE(e,t,n){t===void 0&&(t=!1),n===void 0&&(n=!0),ap(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let r=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,c)=>(r.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(r.push({paramName:"*"}),i+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":e!==""&&e!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,t?void 0:"i"),r]}function HE(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return ap(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function op(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&r!=="/"?null:e.slice(n)||"/"}const qE=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,zE=e=>qE.test(e);function WE(e,t){t===void 0&&(t="/");let{pathname:n,search:r="",hash:i=""}=typeof e=="string"?Ea(e):e,a;if(n)if(zE(n))a=n;else{if(n.includes("//")){let o=n;n=n.replace(/\/\/+/g,"/"),ap(!1,"Pathnames cannot have embedded double slashes - normalizing "+(o+" -> "+n))}n.startsWith("/")?a=fg(n.substring(1),"/"):a=fg(n,t)}else a=t;return{pathname:a,search:KE(r),hash:JE(i)}}function fg(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function Zu(e,t,n,r){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function GE(e){return e.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function lp(e,t){let n=GE(e);return t?n.map((r,i)=>i===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function cp(e,t,n,r){r===void 0&&(r=!1);let i;typeof e=="string"?i=Ea(e):(i=$o({},e),xt(!i.pathname||!i.pathname.includes("?"),Zu("?","pathname","search",i)),xt(!i.pathname||!i.pathname.includes("#"),Zu("#","pathname","hash",i)),xt(!i.search||!i.search.includes("#"),Zu("#","search","hash",i)));let a=e===""||i.pathname==="",o=a?"/":i.pathname,l;if(o==null)l=n;else{let p=t.length-1;if(!r&&o.startsWith("..")){let h=o.split("/");for(;h[0]==="..";)h.shift(),p-=1;i.pathname=h.join("/")}l=p>=0?t[p]:"/"}let c=WE(i,l),u=o&&o!=="/"&&o.endsWith("/"),d=(a||o===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(u||d)&&(c.pathname+="/"),c}const ys=e=>e.join("/").replace(/\/\/+/g,"/"),YE=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),KE=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,JE=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function QE(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const oj=["post","put","patch","delete"];new Set(oj);const ZE=["get",...oj];new Set(ZE);/**
 * React Router v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Fo(){return Fo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Fo.apply(this,arguments)}const up=m.createContext(null),XE=m.createContext(null),Cs=m.createContext(null),hu=m.createContext(null),Hr=m.createContext({outlet:null,matches:[],isDataRoute:!1}),lj=m.createContext(null);function eN(e,t){let{relative:n}=t===void 0?{}:t;Na()||xt(!1);let{basename:r,navigator:i}=m.useContext(Cs),{hash:a,pathname:o,search:l}=uj(e,{relative:n}),c=o;return r!=="/"&&(c=o==="/"?r:ys([r,o])),i.createHref({pathname:c,search:l,hash:a})}function Na(){return m.useContext(hu)!=null}function hn(){return Na()||xt(!1),m.useContext(hu).location}function cj(e){m.useContext(Cs).static||m.useLayoutEffect(e)}function Re(){let{isDataRoute:e}=m.useContext(Hr);return e?mN():tN()}function tN(){Na()||xt(!1);let e=m.useContext(up),{basename:t,future:n,navigator:r}=m.useContext(Cs),{matches:i}=m.useContext(Hr),{pathname:a}=hn(),o=JSON.stringify(lp(i,n.v7_relativeSplatPath)),l=m.useRef(!1);return cj(()=>{l.current=!0}),m.useCallback(function(u,d){if(d===void 0&&(d={}),!l.current)return;if(typeof u=="number"){r.go(u);return}let p=cp(u,JSON.parse(o),a,d.relative==="path");e==null&&t!=="/"&&(p.pathname=p.pathname==="/"?t:ys([t,p.pathname])),(d.replace?r.replace:r.push)(p,d.state,d)},[t,r,o,a,e])}const nN=m.createContext(null);function rN(e){let t=m.useContext(Hr).outlet;return t&&m.createElement(nN.Provider,{value:e},t)}function uj(e,t){let{relative:n}=t===void 0?{}:t,{future:r}=m.useContext(Cs),{matches:i}=m.useContext(Hr),{pathname:a}=hn(),o=JSON.stringify(lp(i,r.v7_relativeSplatPath));return m.useMemo(()=>cp(e,JSON.parse(o),a,n==="path"),[e,o,a,n])}function sN(e,t){return iN(e,t)}function iN(e,t,n,r){Na()||xt(!1);let{navigator:i}=m.useContext(Cs),{matches:a}=m.useContext(Hr),o=a[a.length-1],l=o?o.params:{};o&&o.pathname;let c=o?o.pathnameBase:"/";o&&o.route;let u=hn(),d;if(t){var p;let A=typeof t=="string"?Ea(t):t;c==="/"||(p=A.pathname)!=null&&p.startsWith(c)||xt(!1),d=A}else d=u;let h=d.pathname||"/",f=h;if(c!=="/"){let A=c.replace(/^\//,"").split("/");f="/"+h.replace(/^\//,"").split("/").slice(A.length).join("/")}let y=kE(e,{pathname:f}),j=uN(y&&y.map(A=>Object.assign({},A,{params:Object.assign({},l,A.params),pathname:ys([c,i.encodeLocation?i.encodeLocation(A.pathname).pathname:A.pathname]),pathnameBase:A.pathnameBase==="/"?c:ys([c,i.encodeLocation?i.encodeLocation(A.pathnameBase).pathname:A.pathnameBase])})),a,n,r);return t&&j?m.createElement(hu.Provider,{value:{location:Fo({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:as.Pop}},j):j}function aN(){let e=pN(),t=QE(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return m.createElement(m.Fragment,null,m.createElement("h2",null,"Unexpected Application Error!"),m.createElement("h3",{style:{fontStyle:"italic"}},t),n?m.createElement("pre",{style:i},n):null,null)}const oN=m.createElement(aN,null);class lN extends m.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,n){return n.location!==t.location||n.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:n.error,location:n.location,revalidation:t.revalidation||n.revalidation}}componentDidCatch(t,n){console.error("React Router caught the following error during render",t,n)}render(){return this.state.error!==void 0?m.createElement(Hr.Provider,{value:this.props.routeContext},m.createElement(lj.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function cN(e){let{routeContext:t,match:n,children:r}=e,i=m.useContext(up);return i&&i.static&&i.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=n.route.id),m.createElement(Hr.Provider,{value:t},r)}function uN(e,t,n,r){var i;if(t===void 0&&(t=[]),n===void 0&&(n=null),r===void 0&&(r=null),e==null){var a;if(!n)return null;if(n.errors)e=n.matches;else if((a=r)!=null&&a.v7_partialHydration&&t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let o=e,l=(i=n)==null?void 0:i.errors;if(l!=null){let d=o.findIndex(p=>p.route.id&&(l==null?void 0:l[p.route.id])!==void 0);d>=0||xt(!1),o=o.slice(0,Math.min(o.length,d+1))}let c=!1,u=-1;if(n&&r&&r.v7_partialHydration)for(let d=0;d<o.length;d++){let p=o[d];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(u=d),p.route.id){let{loaderData:h,errors:f}=n,y=p.route.loader&&h[p.route.id]===void 0&&(!f||f[p.route.id]===void 0);if(p.route.lazy||y){c=!0,u>=0?o=o.slice(0,u+1):o=[o[0]];break}}}return o.reduceRight((d,p,h)=>{let f,y=!1,j=null,A=null;n&&(f=l&&p.route.id?l[p.route.id]:void 0,j=p.route.errorElement||oN,c&&(u<0&&h===0?(gN("route-fallback"),y=!0,A=null):u===h&&(y=!0,A=p.route.hydrateFallbackElement||null)));let g=t.concat(o.slice(0,h+1)),x=()=>{let w;return f?w=j:y?w=A:p.route.Component?w=m.createElement(p.route.Component,null):p.route.element?w=p.route.element:w=d,m.createElement(cN,{match:p,routeContext:{outlet:d,matches:g,isDataRoute:n!=null},children:w})};return n&&(p.route.ErrorBoundary||p.route.errorElement||h===0)?m.createElement(lN,{location:n.location,revalidation:n.revalidation,component:j,error:f,children:x(),routeContext:{outlet:null,matches:g,isDataRoute:!0}}):x()},null)}var dj=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(dj||{}),hj=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(hj||{});function dN(e){let t=m.useContext(up);return t||xt(!1),t}function hN(e){let t=m.useContext(XE);return t||xt(!1),t}function fN(e){let t=m.useContext(Hr);return t||xt(!1),t}function fj(e){let t=fN(),n=t.matches[t.matches.length-1];return n.route.id||xt(!1),n.route.id}function pN(){var e;let t=m.useContext(lj),n=hN(),r=fj();return t!==void 0?t:(e=n.errors)==null?void 0:e[r]}function mN(){let{router:e}=dN(dj.UseNavigateStable),t=fj(hj.UseNavigateStable),n=m.useRef(!1);return cj(()=>{n.current=!0}),m.useCallback(function(i,a){a===void 0&&(a={}),n.current&&(typeof i=="number"?e.navigate(i):e.navigate(i,Fo({fromRouteId:t},a)))},[e,t])}const pg={};function gN(e,t,n){pg[e]||(pg[e]=!0)}function yN(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function pa(e){let{to:t,replace:n,state:r,relative:i}=e;Na()||xt(!1);let{future:a,static:o}=m.useContext(Cs),{matches:l}=m.useContext(Hr),{pathname:c}=hn(),u=Re(),d=cp(t,lp(l,a.v7_relativeSplatPath),c,i==="path"),p=JSON.stringify(d);return m.useEffect(()=>u(JSON.parse(p),{replace:n,state:r,relative:i}),[u,p,i,n,r]),null}function pj(e){return rN(e.context)}function J(e){xt(!1)}function vN(e){let{basename:t="/",children:n=null,location:r,navigationType:i=as.Pop,navigator:a,static:o=!1,future:l}=e;Na()&&xt(!1);let c=t.replace(/^\/*/,"/"),u=m.useMemo(()=>({basename:c,navigator:a,static:o,future:Fo({v7_relativeSplatPath:!1},l)}),[c,l,a,o]);typeof r=="string"&&(r=Ea(r));let{pathname:d="/",search:p="",hash:h="",state:f=null,key:y="default"}=r,j=m.useMemo(()=>{let A=op(d,c);return A==null?null:{location:{pathname:A,search:p,hash:h,state:f,key:y},navigationType:i}},[c,d,p,h,f,y,i]);return j==null?null:m.createElement(Cs.Provider,{value:u},m.createElement(hu.Provider,{children:n,value:j}))}function xN(e){let{children:t,location:n}=e;return sN(Eh(t),n)}new Promise(()=>{});function Eh(e,t){t===void 0&&(t=[]);let n=[];return m.Children.forEach(e,(r,i)=>{if(!m.isValidElement(r))return;let a=[...t,i];if(r.type===m.Fragment){n.push.apply(n,Eh(r.props.children,a));return}r.type!==J&&xt(!1),!r.props.index||!r.props.children||xt(!1);let o={id:r.props.id||a.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=Eh(r.props.children,a)),n.push(o)}),n}/**
 * React Router DOM v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Nh(){return Nh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Nh.apply(this,arguments)}function jN(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}function bN(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function wN(e,t){return e.button===0&&(!t||t==="_self")&&!bN(e)}function _h(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,n)=>{let r=e[n];return t.concat(Array.isArray(r)?r.map(i=>[n,i]):[[n,r]])},[]))}function SN(e,t){let n=_h(e);return t&&t.forEach((r,i)=>{n.has(i)||t.getAll(i).forEach(a=>{n.append(i,a)})}),n}const EN=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],NN="6";try{window.__reactRouterVersion=NN}catch{}const _N="startTransition",mg=pw[_N];function AN(e){let{basename:t,children:n,future:r,window:i}=e,a=m.useRef();a.current==null&&(a.current=_E({window:i,v5Compat:!0}));let o=a.current,[l,c]=m.useState({action:o.action,location:o.location}),{v7_startTransition:u}=r||{},d=m.useCallback(p=>{u&&mg?mg(()=>c(p)):c(p)},[c,u]);return m.useLayoutEffect(()=>o.listen(d),[o,d]),m.useEffect(()=>yN(r),[r]),m.createElement(vN,{basename:t,children:n,location:l.location,navigationType:l.action,navigator:o,future:r})}const CN=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",kN=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,fi=m.forwardRef(function(t,n){let{onClick:r,relative:i,reloadDocument:a,replace:o,state:l,target:c,to:u,preventScrollReset:d,viewTransition:p}=t,h=jN(t,EN),{basename:f}=m.useContext(Cs),y,j=!1;if(typeof u=="string"&&kN.test(u)&&(y=u,CN))try{let w=new URL(window.location.href),E=u.startsWith("//")?new URL(w.protocol+u):new URL(u),_=op(E.pathname,f);E.origin===w.origin&&_!=null?u=_+E.search+E.hash:j=!0}catch{}let A=eN(u,{relative:i}),g=IN(u,{replace:o,state:l,target:c,preventScrollReset:d,relative:i,viewTransition:p});function x(w){r&&r(w),w.defaultPrevented||g(w)}return m.createElement("a",Nh({},h,{href:y||A,onClick:j||a?r:x,ref:n,target:c}))});var gg;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(gg||(gg={}));var yg;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(yg||(yg={}));function IN(e,t){let{target:n,replace:r,state:i,preventScrollReset:a,relative:o,viewTransition:l}=t===void 0?{}:t,c=Re(),u=hn(),d=uj(e,{relative:o});return m.useCallback(p=>{if(wN(p,n)){p.preventDefault();let h=r!==void 0?r:Uc(u)===Uc(d);c(e,{replace:h,state:i,preventScrollReset:a,relative:o,viewTransition:l})}},[u,c,d,r,i,n,e,a,o,l])}function mj(e){let t=m.useRef(_h(e)),n=m.useRef(!1),r=hn(),i=m.useMemo(()=>SN(r.search,n.current?null:t.current),[r.search]),a=Re(),o=m.useCallback((l,c)=>{const u=_h(typeof l=="function"?l(i):l);n.current=!0,a("?"+u,c)},[a,i]);return[i,o]}function RN(e={}){const{nonce:t,onScriptLoadSuccess:n,onScriptLoadError:r}=e,[i,a]=m.useState(!1),o=m.useRef(n);o.current=n;const l=m.useRef(r);return l.current=r,m.useEffect(()=>{const c=document.createElement("script");return c.src="https://accounts.google.com/gsi/client",c.async=!0,c.defer=!0,c.nonce=t,c.onload=()=>{var u;a(!0),(u=o.current)===null||u===void 0||u.call(o)},c.onerror=()=>{var u;a(!1),(u=l.current)===null||u===void 0||u.call(l)},document.body.appendChild(c),()=>{document.body.removeChild(c)}},[t]),i}const gj=m.createContext(null);function TN({clientId:e,nonce:t,onScriptLoadSuccess:n,onScriptLoadError:r,children:i}){const a=RN({nonce:t,onScriptLoadSuccess:n,onScriptLoadError:r}),o=m.useMemo(()=>({clientId:e,scriptLoadedSuccessfully:a}),[e,a]);return ba.createElement(gj.Provider,{value:o},i)}function ON(){const e=m.useContext(gj);if(!e)throw new Error("Google OAuth components must be used within GoogleOAuthProvider");return e}function PN(e){var t;return(t=e==null?void 0:e.clientId)!==null&&t!==void 0?t:e==null?void 0:e.client_id}const LN={large:40,medium:32,small:20};function DN({onSuccess:e,onError:t,useOneTap:n,promptMomentNotification:r,type:i="standard",theme:a="outline",size:o="large",text:l,shape:c,logo_alignment:u,width:d,locale:p,click_listener:h,containerProps:f,...y}){const j=m.useRef(null),{clientId:A,scriptLoadedSuccessfully:g}=ON(),x=m.useRef(e);x.current=e;const w=m.useRef(t);w.current=t;const E=m.useRef(r);return E.current=r,m.useEffect(()=>{var _,b,R,C,T,D,U,W,q;if(g)return(R=(b=(_=window==null?void 0:window.google)===null||_===void 0?void 0:_.accounts)===null||b===void 0?void 0:b.id)===null||R===void 0||R.initialize({client_id:A,callback:P=>{var V;if(!(P!=null&&P.credential))return(V=w.current)===null||V===void 0?void 0:V.call(w);const{credential:K,select_by:ce}=P;x.current({credential:K,clientId:PN(P),select_by:ce})},...y}),(D=(T=(C=window==null?void 0:window.google)===null||C===void 0?void 0:C.accounts)===null||T===void 0?void 0:T.id)===null||D===void 0||D.renderButton(j.current,{type:i,theme:a,size:o,text:l,shape:c,logo_alignment:u,width:d,locale:p,click_listener:h}),n&&((q=(W=(U=window==null?void 0:window.google)===null||U===void 0?void 0:U.accounts)===null||W===void 0?void 0:W.id)===null||q===void 0||q.prompt(E.current)),()=>{var P,V,K;n&&((K=(V=(P=window==null?void 0:window.google)===null||P===void 0?void 0:P.accounts)===null||V===void 0?void 0:V.id)===null||K===void 0||K.cancel())}},[A,g,n,i,a,o,l,c,u,d,p]),ba.createElement("div",{...f,ref:j,style:{height:LN[o],...f==null?void 0:f.style}})}const yj="http://localhost:5000";class vj extends Error{constructor(t,n,r){super(t),this.name="ApiError",this.status=n,this.data=r||{},this.code=(r==null?void 0:r.code)||null}}async function xj(e){try{return await e.json()}catch{return{}}}async function le(e,t={},n=!1){const r=localStorage.getItem("token"),i={Accept:"application/json",...t.headers||{}},a=e.includes("/auth/login")||e.includes("/auth/register")||e.includes("/auth/google");if(r&&!a){i.Authorization=`Bearer ${r}`;const c=localStorage.getItem("role_override"),u=localStorage.getItem("strict_impersonation")==="1";c&&(i["X-Afya-View-Role"]=c,u&&(i["X-Afya-Strict-Impersonation"]="1"))}t.body&&typeof t.body=="object"&&(t.body=JSON.stringify(t.body),i["Content-Type"]="application/json");let o;try{o=await fetch(`${yj}${e}`,{...t,credentials:"include",headers:i})}catch{throw new Error("Network error. Please check your connection.")}if(o.status===401&&!n&&!a){if(await MN())return le(e,t,!0);throw jj(),new Error("Session expired. Please sign in again.")}const l=await xj(o);if(!o.ok){const c=new vj(l.msg||l.message||"Request failed",o.status,l);throw(c.code==="STEP_UP_REQUIRED"||c.code==="SESSION_RESTRICTED")&&window.dispatchEvent(new CustomEvent("afyalink:session-security",{detail:{code:c.code,message:c.message,restriction:(l==null?void 0:l.restriction)||null}})),c}return l}async function MN(){try{const e=localStorage.getItem("refreshToken");if(!e)return!1;const t=await fetch(`${yj}/api/auth/refresh`,{method:"POST",credentials:"include",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({refreshToken:e})});if(!t.ok)return!1;const n=await xj(t);return n!=null&&n.accessToken?(localStorage.setItem("token",n.accessToken),n.refreshToken&&localStorage.setItem("refreshToken",n.refreshToken),!0):!1}catch{return!1}}function jj(){localStorage.removeItem("token"),localStorage.removeItem("refreshToken"),window.location.href="/login"}const vg=Object.freeze({SUPERADMIN:"SUPER_ADMIN",SUPER_ADMIN:"SUPER_ADMIN",SYSTEMADMIN:"SYSTEM_ADMIN",SYSTEM_ADMIN:"SYSTEM_ADMIN",DEVELOPER:"DEVELOPER",HOSPITALADMIN:"HOSPITAL_ADMIN",HOSPITAL_ADMIN:"HOSPITAL_ADMIN",DOCTOR:"DOCTOR",NURSE:"NURSE",LABTECH:"LAB_TECH",LAB_TECH:"LAB_TECH",PHARMACIST:"PHARMACIST",SECURITYOFFICER:"SECURITY_OFFICER",SECURITY_OFFICER:"SECURITY_OFFICER",SECURITYADMIN:"SECURITY_ADMIN",SECURITY_ADMIN:"SECURITY_ADMIN",HRMANAGER:"HR_MANAGER",HR_MANAGER:"HR_MANAGER",PAYROLLOFFICER:"PAYROLL_OFFICER",PAYROLL_OFFICER:"PAYROLL_OFFICER",RADIOLOGIST:"RADIOLOGIST",THERAPIST:"THERAPIST",RECEPTIONIST:"RECEPTIONIST",PATIENT:"PATIENT",GUEST:"GUEST"});function We(e){if(typeof e!="string")return"";const t=e.trim().replace(/[\s-]+/g,"_").toUpperCase(),n=t.replaceAll("_","");return vg[t]||vg[n]||t}function Hs(e){try{const n=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),r=decodeURIComponent(atob(n).split("").map(i=>"%"+("00"+i.charCodeAt(0).toString(16)).slice(-2)).join(""));return JSON.parse(r)}catch{return null}}const bj=m.createContext(null),Gr="role_override",Yr="strict_impersonation";function UN({children:e}){const[t,n]=m.useState(null),[r,i]=m.useState(()=>localStorage.getItem(Gr)||""),[a,o]=m.useState(()=>localStorage.getItem(Yr)==="1"),[l,c]=m.useState(!0),u=m.useRef(!1),d=We(t==null?void 0:t.role)==="SUPER_ADMIN"||We(t==null?void 0:t.role)==="DEVELOPER",p=We(d&&r?r:t==null?void 0:t.role),h=t?{...t,actualRole:We(t.role),role:p}:null,f=async()=>{if(u.current)return!1;const E=localStorage.getItem("refreshToken");if(!E)return!1;u.current=!0;try{const _=await fetch("http://localhost:5000/api/auth/refresh",{method:"POST",credentials:"include",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({refreshToken:E})});if(!_.ok)return!1;const b=await _.json();if(!(b!=null&&b.accessToken)||!(b!=null&&b.user))return!1;localStorage.setItem("token",b.accessToken),b.refreshToken&&localStorage.setItem("refreshToken",b.refreshToken),localStorage.setItem("user",JSON.stringify(b.user));const R=Hs(b.accessToken);return n({...b.user,role:We(b.user.role),twoFactorVerified:(R==null?void 0:R.twoFactor)!==!1}),!0}catch{return!1}finally{u.current=!1}},y=()=>{const E=localStorage.getItem("user"),_=localStorage.getItem("token");if(!_||!E){n(null);return}const b=Hs(_),R=We(b==null?void 0:b.role);if(!R){n(null);return}try{const C=JSON.parse(E);n({...C,role:R,twoFactorVerified:(b==null?void 0:b.twoFactor)!==!1})}catch{n(null)}};m.useEffect(()=>{let E=!0;return(async()=>{try{const b=localStorage.getItem("user"),R=localStorage.getItem("token"),C=localStorage.getItem("refreshToken");if(!R||!b){E&&n(null);return}const T=Hs(R),D=We(T==null?void 0:T.role),U=(T==null?void 0:T.exp)&&T.exp*1e3<Date.now();if(!D||U){if(!C)throw new Error("Token expired");const W=await fetch("http://localhost:5000/api/auth/refresh",{method:"POST",credentials:"include",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({refreshToken:C})});if(!W.ok)throw new Error("Refresh failed");const q=await W.json();if(!(q!=null&&q.accessToken)||!(q!=null&&q.user))throw new Error("Refresh failed");localStorage.setItem("token",q.accessToken),q.refreshToken&&localStorage.setItem("refreshToken",q.refreshToken),localStorage.setItem("user",JSON.stringify(q.user)),E&&n({...q.user,role:We(q.user.role),twoFactorVerified:!0});return}E&&n({...JSON.parse(b),role:D,twoFactorVerified:(T==null?void 0:T.twoFactor)!==!1})}catch{localStorage.removeItem("token"),localStorage.removeItem("refreshToken"),localStorage.removeItem("user"),localStorage.removeItem("2fa_pending"),localStorage.removeItem("2fa_user"),localStorage.removeItem(Gr),localStorage.removeItem(Yr),E&&n(null)}})().finally(()=>{E&&c(!1)}),()=>{E=!1}},[]),m.useEffect(()=>{if(!t)return;const E=async()=>{const C=localStorage.getItem("token"),T=localStorage.getItem("refreshToken");if(!C||!T||document.hidden)return;const D=Hs(C);((D==null?void 0:D.exp)||0)*1e3-Date.now()<=6*60*1e3&&await f()},_=()=>{document.hidden||E()},b=()=>E(),R=setInterval(E,60*1e3);return document.addEventListener("visibilitychange",_),window.addEventListener("focus",b),()=>{clearInterval(R),document.removeEventListener("visibilitychange",_),window.removeEventListener("focus",b)}},[t]),m.useEffect(()=>{const E=new Set(["token","refreshToken","user",Gr,Yr]),_=b=>{b.storageArea===localStorage&&(b.key&&!E.has(b.key)||(y(),i(localStorage.getItem(Gr)||""),o(localStorage.getItem(Yr)==="1")))};return window.addEventListener("storage",_),()=>window.removeEventListener("storage",_)},[]);const j=async(E,_)=>{var D;if(typeof _=="object"&&(_==null?void 0:_.directToken)===!0){const U=(_==null?void 0:_.token)||E;if(!U)throw new Error("Missing access token");const W=Hs(U),q=We(W==null?void 0:W.role);if(!q)throw new Error("Invalid Google token");const P={id:W.id,name:W.name,email:W.email,phone:W.phone,role:q};return localStorage.setItem("token",U),_!=null&&_.refreshToken&&localStorage.setItem("refreshToken",_.refreshToken),localStorage.setItem("user",JSON.stringify(P)),n({...P,twoFactorVerified:!0}),{user:P}}const b=await le("/api/auth/login",{method:"POST",body:{identifier:E,password:_}});if(b.requires2FA)return localStorage.setItem("2fa_pending","true"),localStorage.setItem("2fa_user",b.userId),{requires2FA:!0,userId:b.userId};const R=We((D=b.user)==null?void 0:D.role);if(!R)throw new Error("User role missing");const C={id:b.user.id,name:b.user.name,email:b.user.email,phone:b.user.phone,phoneVerified:b.user.phoneVerified,emailVerified:b.user.emailVerified,role:R};localStorage.setItem("token",b.accessToken),b.refreshToken&&localStorage.setItem("refreshToken",b.refreshToken),localStorage.setItem("user",JSON.stringify(C));const T=Hs(b.accessToken);return n({...C,twoFactorVerified:(T==null?void 0:T.twoFactor)!==!1}),{user:C}},A=(E,_)=>{const b=Hs(E);if(!(b!=null&&b.role))return;const R=We(b.role);localStorage.setItem("token",E),_&&localStorage.setItem("refreshToken",_),localStorage.removeItem("2fa_pending"),localStorage.removeItem("2fa_user");const C=JSON.parse(localStorage.getItem("user"));n({...C,role:R,twoFactorVerified:!0})},g=async()=>{try{const E=localStorage.getItem("refreshToken");await le("/api/auth/logout",{method:"POST",body:E?{refreshToken:E}:{}})}catch{}finally{localStorage.removeItem("token"),localStorage.removeItem("refreshToken"),localStorage.removeItem("user"),localStorage.removeItem("2fa_pending"),localStorage.removeItem("2fa_user"),localStorage.removeItem(Gr),localStorage.removeItem(Yr),n(null),jj()}},x=E=>{const _=We(E);return d?_?(localStorage.setItem(Gr,_),i(_),!0):(localStorage.removeItem(Gr),i(""),!0):!1},w=E=>{if(!d)return!1;const _=!!E;return _?localStorage.setItem(Yr,"1"):localStorage.removeItem(Yr),o(_),!0};return m.useEffect(()=>{!d&&r&&(localStorage.removeItem(Gr),i("")),!d&&a&&(localStorage.removeItem(Yr),o(!1))},[d,r,a]),s.jsx(bj.Provider,{value:{user:h,loading:l,isAuthenticated:!!h,role:h==null?void 0:h.role,actualRole:h==null?void 0:h.actualRole,roleOverride:r,strictImpersonation:a,canRoleOverride:d,setRoleOverride:x,setStrictImpersonation:w,login:j,complete2FA:A,logout:g,hasRole:(...E)=>E.includes(h==null?void 0:h.role),isAdmin:["SUPER_ADMIN","HOSPITAL_ADMIN"].includes(h==null?void 0:h.role),is2FAVerified:!!(h!=null&&h.twoFactorVerified)},children:l?s.jsx("div",{}):e})}function Te(){const e=m.useContext(bj);if(!e)throw new Error("useAuth must be used inside AuthProvider");return e}const vr=Object.create(null);vr.open="0";vr.close="1";vr.ping="2";vr.pong="3";vr.message="4";vr.upgrade="5";vr.noop="6";const nc=Object.create(null);Object.keys(vr).forEach(e=>{nc[vr[e]]=e});const Ah={type:"error",data:"parser error"},wj=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",Sj=typeof ArrayBuffer=="function",Ej=e=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer,dp=({type:e,data:t},n,r)=>wj&&t instanceof Blob?n?r(t):xg(t,r):Sj&&(t instanceof ArrayBuffer||Ej(t))?n?r(t):xg(new Blob([t]),r):r(vr[e]+(t||"")),xg=(e,t)=>{const n=new FileReader;return n.onload=function(){const r=n.result.split(",")[1];t("b"+(r||""))},n.readAsDataURL(e)};function jg(e){return e instanceof Uint8Array?e:e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}let Xu;function BN(e,t){if(wj&&e.data instanceof Blob)return e.data.arrayBuffer().then(jg).then(t);if(Sj&&(e.data instanceof ArrayBuffer||Ej(e.data)))return t(jg(e.data));dp(e,!1,n=>{Xu||(Xu=new TextEncoder),t(Xu.encode(n))})}const bg="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",so=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let e=0;e<bg.length;e++)so[bg.charCodeAt(e)]=e;const VN=e=>{let t=e.length*.75,n=e.length,r,i=0,a,o,l,c;e[e.length-1]==="="&&(t--,e[e.length-2]==="="&&t--);const u=new ArrayBuffer(t),d=new Uint8Array(u);for(r=0;r<n;r+=4)a=so[e.charCodeAt(r)],o=so[e.charCodeAt(r+1)],l=so[e.charCodeAt(r+2)],c=so[e.charCodeAt(r+3)],d[i++]=a<<2|o>>4,d[i++]=(o&15)<<4|l>>2,d[i++]=(l&3)<<6|c&63;return u},$N=typeof ArrayBuffer=="function",hp=(e,t)=>{if(typeof e!="string")return{type:"message",data:Nj(e,t)};const n=e.charAt(0);return n==="b"?{type:"message",data:FN(e.substring(1),t)}:nc[n]?e.length>1?{type:nc[n],data:e.substring(1)}:{type:nc[n]}:Ah},FN=(e,t)=>{if($N){const n=VN(e);return Nj(n,t)}else return{base64:!0,data:e}},Nj=(e,t)=>{switch(t){case"blob":return e instanceof Blob?e:new Blob([e]);case"arraybuffer":default:return e instanceof ArrayBuffer?e:e.buffer}},_j="",HN=(e,t)=>{const n=e.length,r=new Array(n);let i=0;e.forEach((a,o)=>{dp(a,!1,l=>{r[o]=l,++i===n&&t(r.join(_j))})})},qN=(e,t)=>{const n=e.split(_j),r=[];for(let i=0;i<n.length;i++){const a=hp(n[i],t);if(r.push(a),a.type==="error")break}return r};function zN(){return new TransformStream({transform(e,t){BN(e,n=>{const r=n.length;let i;if(r<126)i=new Uint8Array(1),new DataView(i.buffer).setUint8(0,r);else if(r<65536){i=new Uint8Array(3);const a=new DataView(i.buffer);a.setUint8(0,126),a.setUint16(1,r)}else{i=new Uint8Array(9);const a=new DataView(i.buffer);a.setUint8(0,127),a.setBigUint64(1,BigInt(r))}e.data&&typeof e.data!="string"&&(i[0]|=128),t.enqueue(i),t.enqueue(n)})}})}let ed;function kl(e){return e.reduce((t,n)=>t+n.length,0)}function Il(e,t){if(e[0].length===t)return e.shift();const n=new Uint8Array(t);let r=0;for(let i=0;i<t;i++)n[i]=e[0][r++],r===e[0].length&&(e.shift(),r=0);return e.length&&r<e[0].length&&(e[0]=e[0].slice(r)),n}function WN(e,t){ed||(ed=new TextDecoder);const n=[];let r=0,i=-1,a=!1;return new TransformStream({transform(o,l){for(n.push(o);;){if(r===0){if(kl(n)<1)break;const c=Il(n,1);a=(c[0]&128)===128,i=c[0]&127,i<126?r=3:i===126?r=1:r=2}else if(r===1){if(kl(n)<2)break;const c=Il(n,2);i=new DataView(c.buffer,c.byteOffset,c.length).getUint16(0),r=3}else if(r===2){if(kl(n)<8)break;const c=Il(n,8),u=new DataView(c.buffer,c.byteOffset,c.length),d=u.getUint32(0);if(d>Math.pow(2,21)-1){l.enqueue(Ah);break}i=d*Math.pow(2,32)+u.getUint32(4),r=3}else{if(kl(n)<i)break;const c=Il(n,i);l.enqueue(hp(a?c:ed.decode(c),t)),r=0}if(i===0||i>e){l.enqueue(Ah);break}}}})}const Aj=4;function wt(e){if(e)return GN(e)}function GN(e){for(var t in wt.prototype)e[t]=wt.prototype[t];return e}wt.prototype.on=wt.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this};wt.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this};wt.prototype.off=wt.prototype.removeListener=wt.prototype.removeAllListeners=wt.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var n=this._callbacks["$"+e];if(!n)return this;if(arguments.length==1)return delete this._callbacks["$"+e],this;for(var r,i=0;i<n.length;i++)if(r=n[i],r===t||r.fn===t){n.splice(i,1);break}return n.length===0&&delete this._callbacks["$"+e],this};wt.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks["$"+e],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(n){n=n.slice(0);for(var r=0,i=n.length;r<i;++r)n[r].apply(this,t)}return this};wt.prototype.emitReserved=wt.prototype.emit;wt.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]};wt.prototype.hasListeners=function(e){return!!this.listeners(e).length};const fu=typeof Promise=="function"&&typeof Promise.resolve=="function"?t=>Promise.resolve().then(t):(t,n)=>n(t,0),In=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),YN="arraybuffer";function Cj(e,...t){return t.reduce((n,r)=>(e.hasOwnProperty(r)&&(n[r]=e[r]),n),{})}const KN=In.setTimeout,JN=In.clearTimeout;function pu(e,t){t.useNativeTimers?(e.setTimeoutFn=KN.bind(In),e.clearTimeoutFn=JN.bind(In)):(e.setTimeoutFn=In.setTimeout.bind(In),e.clearTimeoutFn=In.clearTimeout.bind(In))}const QN=1.33;function ZN(e){return typeof e=="string"?XN(e):Math.ceil((e.byteLength||e.size)*QN)}function XN(e){let t=0,n=0;for(let r=0,i=e.length;r<i;r++)t=e.charCodeAt(r),t<128?n+=1:t<2048?n+=2:t<55296||t>=57344?n+=3:(r++,n+=4);return n}function kj(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function e_(e){let t="";for(let n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t}function t_(e){let t={},n=e.split("&");for(let r=0,i=n.length;r<i;r++){let a=n[r].split("=");t[decodeURIComponent(a[0])]=decodeURIComponent(a[1])}return t}class n_ extends Error{constructor(t,n,r){super(t),this.description=n,this.context=r,this.type="TransportError"}}class fp extends wt{constructor(t){super(),this.writable=!1,pu(this,t),this.opts=t,this.query=t.query,this.socket=t.socket,this.supportsBinary=!t.forceBase64}onError(t,n,r){return super.emitReserved("error",new n_(t,n,r)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(t){this.readyState==="open"&&this.write(t)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(t){const n=hp(t,this.socket.binaryType);this.onPacket(n)}onPacket(t){super.emitReserved("packet",t)}onClose(t){this.readyState="closed",super.emitReserved("close",t)}pause(t){}createUri(t,n={}){return t+"://"+this._hostname()+this._port()+this.opts.path+this._query(n)}_hostname(){const t=this.opts.hostname;return t.indexOf(":")===-1?t:"["+t+"]"}_port(){return this.opts.port&&(this.opts.secure&&Number(this.opts.port)!==443||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(t){const n=e_(t);return n.length?"?"+n:""}}class r_ extends fp{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(t){this.readyState="pausing";const n=()=>{this.readyState="paused",t()};if(this._polling||!this.writable){let r=0;this._polling&&(r++,this.once("pollComplete",function(){--r||n()})),this.writable||(r++,this.once("drain",function(){--r||n()}))}else n()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(t){const n=r=>{if(this.readyState==="opening"&&r.type==="open"&&this.onOpen(),r.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(r)};qN(t,this.socket.binaryType).forEach(n),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const t=()=>{this.write([{type:"close"}])};this.readyState==="open"?t():this.once("open",t)}write(t){this.writable=!1,HN(t,n=>{this.doWrite(n,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const t=this.opts.secure?"https":"http",n=this.query||{};return this.opts.timestampRequests!==!1&&(n[this.opts.timestampParam]=kj()),!this.supportsBinary&&!n.sid&&(n.b64=1),this.createUri(t,n)}}let Ij=!1;try{Ij=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const s_=Ij;function i_(){}class a_ extends r_{constructor(t){if(super(t),typeof location<"u"){const n=location.protocol==="https:";let r=location.port;r||(r=n?"443":"80"),this.xd=typeof location<"u"&&t.hostname!==location.hostname||r!==t.port}}doWrite(t,n){const r=this.request({method:"POST",data:t});r.on("success",n),r.on("error",(i,a)=>{this.onError("xhr post error",i,a)})}doPoll(){const t=this.request();t.on("data",this.onData.bind(this)),t.on("error",(n,r)=>{this.onError("xhr poll error",n,r)}),this.pollXhr=t}}class pr extends wt{constructor(t,n,r){super(),this.createRequest=t,pu(this,r),this._opts=r,this._method=r.method||"GET",this._uri=n,this._data=r.data!==void 0?r.data:null,this._create()}_create(){var t;const n=Cj(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");n.xdomain=!!this._opts.xd;const r=this._xhr=this.createRequest(n);try{r.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){r.setDisableHeaderCheck&&r.setDisableHeaderCheck(!0);for(let i in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(i)&&r.setRequestHeader(i,this._opts.extraHeaders[i])}}catch{}if(this._method==="POST")try{r.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{r.setRequestHeader("Accept","*/*")}catch{}(t=this._opts.cookieJar)===null||t===void 0||t.addCookies(r),"withCredentials"in r&&(r.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(r.timeout=this._opts.requestTimeout),r.onreadystatechange=()=>{var i;r.readyState===3&&((i=this._opts.cookieJar)===null||i===void 0||i.parseCookies(r.getResponseHeader("set-cookie"))),r.readyState===4&&(r.status===200||r.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof r.status=="number"?r.status:0)},0))},r.send(this._data)}catch(i){this.setTimeoutFn(()=>{this._onError(i)},0);return}typeof document<"u"&&(this._index=pr.requestsCount++,pr.requests[this._index]=this)}_onError(t){this.emitReserved("error",t,this._xhr),this._cleanup(!0)}_cleanup(t){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=i_,t)try{this._xhr.abort()}catch{}typeof document<"u"&&delete pr.requests[this._index],this._xhr=null}}_onLoad(){const t=this._xhr.responseText;t!==null&&(this.emitReserved("data",t),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}pr.requestsCount=0;pr.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",wg);else if(typeof addEventListener=="function"){const e="onpagehide"in In?"pagehide":"unload";addEventListener(e,wg,!1)}}function wg(){for(let e in pr.requests)pr.requests.hasOwnProperty(e)&&pr.requests[e].abort()}const o_=function(){const e=Rj({xdomain:!1});return e&&e.responseType!==null}();class l_ extends a_{constructor(t){super(t);const n=t&&t.forceBase64;this.supportsBinary=o_&&!n}request(t={}){return Object.assign(t,{xd:this.xd},this.opts),new pr(Rj,this.uri(),t)}}function Rj(e){const t=e.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!t||s_))return new XMLHttpRequest}catch{}if(!t)try{return new In[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const Tj=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class c_ extends fp{get name(){return"websocket"}doOpen(){const t=this.uri(),n=this.opts.protocols,r=Tj?{}:Cj(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(r.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(t,n,r)}catch(i){return this.emitReserved("error",i)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=t=>this.onClose({description:"websocket connection closed",context:t}),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=!1;for(let n=0;n<t.length;n++){const r=t[n],i=n===t.length-1;dp(r,this.supportsBinary,a=>{try{this.doWrite(r,a)}catch{}i&&fu(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const t=this.opts.secure?"wss":"ws",n=this.query||{};return this.opts.timestampRequests&&(n[this.opts.timestampParam]=kj()),this.supportsBinary||(n.b64=1),this.createUri(t,n)}}const td=In.WebSocket||In.MozWebSocket;class u_ extends c_{createSocket(t,n,r){return Tj?new td(t,n,r):n?new td(t,n):new td(t)}doWrite(t,n){this.ws.send(n)}}class d_ extends fp{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(t){return this.emitReserved("error",t)}this._transport.closed.then(()=>{this.onClose()}).catch(t=>{this.onError("webtransport error",t)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(t=>{const n=WN(Number.MAX_SAFE_INTEGER,this.socket.binaryType),r=t.readable.pipeThrough(n).getReader(),i=zN();i.readable.pipeTo(t.writable),this._writer=i.writable.getWriter();const a=()=>{r.read().then(({done:l,value:c})=>{l||(this.onPacket(c),a())}).catch(l=>{})};a();const o={type:"open"};this.query.sid&&(o.data=`{"sid":"${this.query.sid}"}`),this._writer.write(o).then(()=>this.onOpen())})})}write(t){this.writable=!1;for(let n=0;n<t.length;n++){const r=t[n],i=n===t.length-1;this._writer.write(r).then(()=>{i&&fu(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var t;(t=this._transport)===null||t===void 0||t.close()}}const h_={websocket:u_,webtransport:d_,polling:l_},f_=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,p_=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function Ch(e){if(e.length>8e3)throw"URI too long";const t=e,n=e.indexOf("["),r=e.indexOf("]");n!=-1&&r!=-1&&(e=e.substring(0,n)+e.substring(n,r).replace(/:/g,";")+e.substring(r,e.length));let i=f_.exec(e||""),a={},o=14;for(;o--;)a[p_[o]]=i[o]||"";return n!=-1&&r!=-1&&(a.source=t,a.host=a.host.substring(1,a.host.length-1).replace(/;/g,":"),a.authority=a.authority.replace("[","").replace("]","").replace(/;/g,":"),a.ipv6uri=!0),a.pathNames=m_(a,a.path),a.queryKey=g_(a,a.query),a}function m_(e,t){const n=/\/{2,9}/g,r=t.replace(n,"/").split("/");return(t.slice(0,1)=="/"||t.length===0)&&r.splice(0,1),t.slice(-1)=="/"&&r.splice(r.length-1,1),r}function g_(e,t){const n={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(r,i,a){i&&(n[i]=a)}),n}const kh=typeof addEventListener=="function"&&typeof removeEventListener=="function",rc=[];kh&&addEventListener("offline",()=>{rc.forEach(e=>e())},!1);class vs extends wt{constructor(t,n){if(super(),this.binaryType=YN,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,t&&typeof t=="object"&&(n=t,t=null),t){const r=Ch(t);n.hostname=r.host,n.secure=r.protocol==="https"||r.protocol==="wss",n.port=r.port,r.query&&(n.query=r.query)}else n.host&&(n.hostname=Ch(n.host).host);pu(this,n),this.secure=n.secure!=null?n.secure:typeof location<"u"&&location.protocol==="https:",n.hostname&&!n.port&&(n.port=this.secure?"443":"80"),this.hostname=n.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=n.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},n.transports.forEach(r=>{const i=r.prototype.name;this.transports.push(i),this._transportsByName[i]=r}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},n),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=t_(this.opts.query)),kh&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},rc.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(t){const n=Object.assign({},this.opts.query);n.EIO=Aj,n.transport=t,this.id&&(n.sid=this.id);const r=Object.assign({},this.opts,{query:n,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[t]);return new this._transportsByName[t](r)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const t=this.opts.rememberUpgrade&&vs.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const n=this.createTransport(t);n.open(),this.setTransport(n)}setTransport(t){this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",n=>this._onClose("transport close",n))}onOpen(){this.readyState="open",vs.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",t),this.emitReserved("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const n=new Error("server error");n.code=t.data,this._onError(n);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data);break}}onHandshake(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this._pingInterval=t.pingInterval,this._pingTimeout=t.pingTimeout,this._maxPayload=t.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const t=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+t,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},t),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const t=this._getWritablePackets();this.transport.send(t),this._prevBufferLen=t.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let n=1;for(let r=0;r<this.writeBuffer.length;r++){const i=this.writeBuffer[r].data;if(i&&(n+=ZN(i)),r>0&&n>this._maxPayload)return this.writeBuffer.slice(0,r);n+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const t=Date.now()>this._pingTimeoutTime;return t&&(this._pingTimeoutTime=0,fu(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),t}write(t,n,r){return this._sendPacket("message",t,n,r),this}send(t,n,r){return this._sendPacket("message",t,n,r),this}_sendPacket(t,n,r,i){if(typeof n=="function"&&(i=n,n=void 0),typeof r=="function"&&(i=r,r=null),this.readyState==="closing"||this.readyState==="closed")return;r=r||{},r.compress=r.compress!==!1;const a={type:t,data:n,options:r};this.emitReserved("packetCreate",a),this.writeBuffer.push(a),i&&this.once("flush",i),this.flush()}close(){const t=()=>{this._onClose("forced close"),this.transport.close()},n=()=>{this.off("upgrade",n),this.off("upgradeError",n),t()},r=()=>{this.once("upgrade",n),this.once("upgradeError",n)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?r():t()}):this.upgrading?r():t()),this}_onError(t){if(vs.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",t),this._onClose("transport error",t)}_onClose(t,n){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),kh&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const r=rc.indexOf(this._offlineEventListener);r!==-1&&rc.splice(r,1)}this.readyState="closed",this.id=null,this.emitReserved("close",t,n),this.writeBuffer=[],this._prevBufferLen=0}}}vs.protocol=Aj;class y_ extends vs{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let t=0;t<this._upgrades.length;t++)this._probe(this._upgrades[t])}_probe(t){let n=this.createTransport(t),r=!1;vs.priorWebsocketSuccess=!1;const i=()=>{r||(n.send([{type:"ping",data:"probe"}]),n.once("packet",p=>{if(!r)if(p.type==="pong"&&p.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",n),!n)return;vs.priorWebsocketSuccess=n.name==="websocket",this.transport.pause(()=>{r||this.readyState!=="closed"&&(d(),this.setTransport(n),n.send([{type:"upgrade"}]),this.emitReserved("upgrade",n),n=null,this.upgrading=!1,this.flush())})}else{const h=new Error("probe error");h.transport=n.name,this.emitReserved("upgradeError",h)}}))};function a(){r||(r=!0,d(),n.close(),n=null)}const o=p=>{const h=new Error("probe error: "+p);h.transport=n.name,a(),this.emitReserved("upgradeError",h)};function l(){o("transport closed")}function c(){o("socket closed")}function u(p){n&&p.name!==n.name&&a()}const d=()=>{n.removeListener("open",i),n.removeListener("error",o),n.removeListener("close",l),this.off("close",c),this.off("upgrading",u)};n.once("open",i),n.once("error",o),n.once("close",l),this.once("close",c),this.once("upgrading",u),this._upgrades.indexOf("webtransport")!==-1&&t!=="webtransport"?this.setTimeoutFn(()=>{r||n.open()},200):n.open()}onHandshake(t){this._upgrades=this._filterUpgrades(t.upgrades),super.onHandshake(t)}_filterUpgrades(t){const n=[];for(let r=0;r<t.length;r++)~this.transports.indexOf(t[r])&&n.push(t[r]);return n}}let v_=class extends y_{constructor(t,n={}){const r=typeof t=="object"?t:n;(!r.transports||r.transports&&typeof r.transports[0]=="string")&&(r.transports=(r.transports||["polling","websocket","webtransport"]).map(i=>h_[i]).filter(i=>!!i)),super(t,r)}};function x_(e,t="",n){let r=e;n=n||typeof location<"u"&&location,e==null&&(e=n.protocol+"//"+n.host),typeof e=="string"&&(e.charAt(0)==="/"&&(e.charAt(1)==="/"?e=n.protocol+e:e=n.host+e),/^(https?|wss?):\/\//.test(e)||(typeof n<"u"?e=n.protocol+"//"+e:e="https://"+e),r=Ch(e)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";const a=r.host.indexOf(":")!==-1?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+a+":"+r.port+t,r.href=r.protocol+"://"+a+(n&&n.port===r.port?"":":"+r.port),r}const j_=typeof ArrayBuffer=="function",b_=e=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer,Oj=Object.prototype.toString,w_=typeof Blob=="function"||typeof Blob<"u"&&Oj.call(Blob)==="[object BlobConstructor]",S_=typeof File=="function"||typeof File<"u"&&Oj.call(File)==="[object FileConstructor]";function pp(e){return j_&&(e instanceof ArrayBuffer||b_(e))||w_&&e instanceof Blob||S_&&e instanceof File}function sc(e,t){if(!e||typeof e!="object")return!1;if(Array.isArray(e)){for(let n=0,r=e.length;n<r;n++)if(sc(e[n]))return!0;return!1}if(pp(e))return!0;if(e.toJSON&&typeof e.toJSON=="function"&&arguments.length===1)return sc(e.toJSON(),!0);for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&sc(e[n]))return!0;return!1}function E_(e){const t=[],n=e.data,r=e;return r.data=Ih(n,t),r.attachments=t.length,{packet:r,buffers:t}}function Ih(e,t){if(!e)return e;if(pp(e)){const n={_placeholder:!0,num:t.length};return t.push(e),n}else if(Array.isArray(e)){const n=new Array(e.length);for(let r=0;r<e.length;r++)n[r]=Ih(e[r],t);return n}else if(typeof e=="object"&&!(e instanceof Date)){const n={};for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=Ih(e[r],t));return n}return e}function N_(e,t){return e.data=Rh(e.data,t),delete e.attachments,e}function Rh(e,t){if(!e)return e;if(e&&e._placeholder===!0){if(typeof e.num=="number"&&e.num>=0&&e.num<t.length)return t[e.num];throw new Error("illegal attachments")}else if(Array.isArray(e))for(let n=0;n<e.length;n++)e[n]=Rh(e[n],t);else if(typeof e=="object")for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(e[n]=Rh(e[n],t));return e}const __=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"];var Pe;(function(e){e[e.CONNECT=0]="CONNECT",e[e.DISCONNECT=1]="DISCONNECT",e[e.EVENT=2]="EVENT",e[e.ACK=3]="ACK",e[e.CONNECT_ERROR=4]="CONNECT_ERROR",e[e.BINARY_EVENT=5]="BINARY_EVENT",e[e.BINARY_ACK=6]="BINARY_ACK"})(Pe||(Pe={}));let A_=class{constructor(t){this.replacer=t}encode(t){return(t.type===Pe.EVENT||t.type===Pe.ACK)&&sc(t)?this.encodeAsBinary({type:t.type===Pe.EVENT?Pe.BINARY_EVENT:Pe.BINARY_ACK,nsp:t.nsp,data:t.data,id:t.id}):[this.encodeAsString(t)]}encodeAsString(t){let n=""+t.type;return(t.type===Pe.BINARY_EVENT||t.type===Pe.BINARY_ACK)&&(n+=t.attachments+"-"),t.nsp&&t.nsp!=="/"&&(n+=t.nsp+","),t.id!=null&&(n+=t.id),t.data!=null&&(n+=JSON.stringify(t.data,this.replacer)),n}encodeAsBinary(t){const n=E_(t),r=this.encodeAsString(n.packet),i=n.buffers;return i.unshift(r),i}},C_=class Pj extends wt{constructor(t){super(),this.reviver=t}add(t){let n;if(typeof t=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");n=this.decodeString(t);const r=n.type===Pe.BINARY_EVENT;r||n.type===Pe.BINARY_ACK?(n.type=r?Pe.EVENT:Pe.ACK,this.reconstructor=new k_(n),n.attachments===0&&super.emitReserved("decoded",n)):super.emitReserved("decoded",n)}else if(pp(t)||t.base64)if(this.reconstructor)n=this.reconstructor.takeBinaryData(t),n&&(this.reconstructor=null,super.emitReserved("decoded",n));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+t)}decodeString(t){let n=0;const r={type:Number(t.charAt(0))};if(Pe[r.type]===void 0)throw new Error("unknown packet type "+r.type);if(r.type===Pe.BINARY_EVENT||r.type===Pe.BINARY_ACK){const a=n+1;for(;t.charAt(++n)!=="-"&&n!=t.length;);const o=t.substring(a,n);if(o!=Number(o)||t.charAt(n)!=="-")throw new Error("Illegal attachments");r.attachments=Number(o)}if(t.charAt(n+1)==="/"){const a=n+1;for(;++n&&!(t.charAt(n)===","||n===t.length););r.nsp=t.substring(a,n)}else r.nsp="/";const i=t.charAt(n+1);if(i!==""&&Number(i)==i){const a=n+1;for(;++n;){const o=t.charAt(n);if(o==null||Number(o)!=o){--n;break}if(n===t.length)break}r.id=Number(t.substring(a,n+1))}if(t.charAt(++n)){const a=this.tryParse(t.substr(n));if(Pj.isPayloadValid(r.type,a))r.data=a;else throw new Error("invalid payload")}return r}tryParse(t){try{return JSON.parse(t,this.reviver)}catch{return!1}}static isPayloadValid(t,n){switch(t){case Pe.CONNECT:return Sg(n);case Pe.DISCONNECT:return n===void 0;case Pe.CONNECT_ERROR:return typeof n=="string"||Sg(n);case Pe.EVENT:case Pe.BINARY_EVENT:return Array.isArray(n)&&(typeof n[0]=="number"||typeof n[0]=="string"&&__.indexOf(n[0])===-1);case Pe.ACK:case Pe.BINARY_ACK:return Array.isArray(n)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}};class k_{constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){const n=N_(this.reconPack,this.buffers);return this.finishedReconstruction(),n}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}function Sg(e){return Object.prototype.toString.call(e)==="[object Object]"}const I_=Object.freeze(Object.defineProperty({__proto__:null,Decoder:C_,Encoder:A_,get PacketType(){return Pe}},Symbol.toStringTag,{value:"Module"}));function Wn(e,t,n){return e.on(t,n),function(){e.off(t,n)}}const R_=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class Lj extends wt{constructor(t,n,r){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=n,r&&r.auth&&(this.auth=r.auth),this._opts=Object.assign({},r),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const t=this.io;this.subs=[Wn(t,"open",this.onopen.bind(this)),Wn(t,"packet",this.onpacket.bind(this)),Wn(t,"error",this.onerror.bind(this)),Wn(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...n){var r,i,a;if(R_.hasOwnProperty(t))throw new Error('"'+t.toString()+'" is a reserved event name');if(n.unshift(t),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(n),this;const o={type:Pe.EVENT,data:n};if(o.options={},o.options.compress=this.flags.compress!==!1,typeof n[n.length-1]=="function"){const d=this.ids++,p=n.pop();this._registerAckCallback(d,p),o.id=d}const l=(i=(r=this.io.engine)===null||r===void 0?void 0:r.transport)===null||i===void 0?void 0:i.writable,c=this.connected&&!(!((a=this.io.engine)===null||a===void 0)&&a._hasPingExpired());return this.flags.volatile&&!l||(c?(this.notifyOutgoingListeners(o),this.packet(o)):this.sendBuffer.push(o)),this.flags={},this}_registerAckCallback(t,n){var r;const i=(r=this.flags.timeout)!==null&&r!==void 0?r:this._opts.ackTimeout;if(i===void 0){this.acks[t]=n;return}const a=this.io.setTimeoutFn(()=>{delete this.acks[t];for(let l=0;l<this.sendBuffer.length;l++)this.sendBuffer[l].id===t&&this.sendBuffer.splice(l,1);n.call(this,new Error("operation has timed out"))},i),o=(...l)=>{this.io.clearTimeoutFn(a),n.apply(this,l)};o.withError=!0,this.acks[t]=o}emitWithAck(t,...n){return new Promise((r,i)=>{const a=(o,l)=>o?i(o):r(l);a.withError=!0,n.push(a),this.emit(t,...n)})}_addToQueue(t){let n;typeof t[t.length-1]=="function"&&(n=t.pop());const r={id:this._queueSeq++,tryCount:0,pending:!1,args:t,flags:Object.assign({fromQueue:!0},this.flags)};t.push((i,...a)=>(this._queue[0],i!==null?r.tryCount>this._opts.retries&&(this._queue.shift(),n&&n(i)):(this._queue.shift(),n&&n(null,...a)),r.pending=!1,this._drainQueue())),this._queue.push(r),this._drainQueue()}_drainQueue(t=!1){if(!this.connected||this._queue.length===0)return;const n=this._queue[0];n.pending&&!t||(n.pending=!0,n.tryCount++,this.flags=n.flags,this.emit.apply(this,n.args))}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){typeof this.auth=="function"?this.auth(t=>{this._sendConnectPacket(t)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(t){this.packet({type:Pe.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},t):t})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t,n){this.connected=!1,delete this.id,this.emitReserved("disconnect",t,n),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(t=>{if(!this.sendBuffer.some(r=>String(r.id)===t)){const r=this.acks[t];delete this.acks[t],r.withError&&r.call(this,new Error("socket has been disconnected"))}})}onpacket(t){if(t.nsp===this.nsp)switch(t.type){case Pe.CONNECT:t.data&&t.data.sid?this.onconnect(t.data.sid,t.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case Pe.EVENT:case Pe.BINARY_EVENT:this.onevent(t);break;case Pe.ACK:case Pe.BINARY_ACK:this.onack(t);break;case Pe.DISCONNECT:this.ondisconnect();break;case Pe.CONNECT_ERROR:this.destroy();const r=new Error(t.data.message);r.data=t.data.data,this.emitReserved("connect_error",r);break}}onevent(t){const n=t.data||[];t.id!=null&&n.push(this.ack(t.id)),this.connected?this.emitEvent(n):this.receiveBuffer.push(Object.freeze(n))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){const n=this._anyListeners.slice();for(const r of n)r.apply(this,t)}super.emit.apply(this,t),this._pid&&t.length&&typeof t[t.length-1]=="string"&&(this._lastOffset=t[t.length-1])}ack(t){const n=this;let r=!1;return function(...i){r||(r=!0,n.packet({type:Pe.ACK,id:t,data:i}))}}onack(t){const n=this.acks[t.id];typeof n=="function"&&(delete this.acks[t.id],n.withError&&t.data.unshift(null),n.apply(this,t.data))}onconnect(t,n){this.id=t,this.recovered=n&&this._pid===n,this._pid=n,this.connected=!0,this.emitBuffered(),this._drainQueue(!0),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach(t=>this.emitEvent(t)),this.receiveBuffer=[],this.sendBuffer.forEach(t=>{this.notifyOutgoingListeners(t),this.packet(t)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(t=>t()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:Pe.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}timeout(t){return this.flags.timeout=t,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){const n=this._anyListeners;for(let r=0;r<n.length;r++)if(t===n[r])return n.splice(r,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(t),this}prependAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(t),this}offAnyOutgoing(t){if(!this._anyOutgoingListeners)return this;if(t){const n=this._anyOutgoingListeners;for(let r=0;r<n.length;r++)if(t===n[r])return n.splice(r,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(t){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const n=this._anyOutgoingListeners.slice();for(const r of n)r.apply(this,t.data)}}}function _a(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}_a.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=Math.floor(t*10)&1?e+n:e-n}return Math.min(e,this.max)|0};_a.prototype.reset=function(){this.attempts=0};_a.prototype.setMin=function(e){this.ms=e};_a.prototype.setMax=function(e){this.max=e};_a.prototype.setJitter=function(e){this.jitter=e};class Th extends wt{constructor(t,n){var r;super(),this.nsps={},this.subs=[],t&&typeof t=="object"&&(n=t,t=void 0),n=n||{},n.path=n.path||"/socket.io",this.opts=n,pu(this,n),this.reconnection(n.reconnection!==!1),this.reconnectionAttempts(n.reconnectionAttempts||1/0),this.reconnectionDelay(n.reconnectionDelay||1e3),this.reconnectionDelayMax(n.reconnectionDelayMax||5e3),this.randomizationFactor((r=n.randomizationFactor)!==null&&r!==void 0?r:.5),this.backoff=new _a({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(n.timeout==null?2e4:n.timeout),this._readyState="closed",this.uri=t;const i=n.parser||I_;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this._autoConnect=n.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(t){return arguments.length?(this._reconnection=!!t,t||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(t){return t===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var n;return t===void 0?this._reconnectionDelay:(this._reconnectionDelay=t,(n=this.backoff)===null||n===void 0||n.setMin(t),this)}randomizationFactor(t){var n;return t===void 0?this._randomizationFactor:(this._randomizationFactor=t,(n=this.backoff)===null||n===void 0||n.setJitter(t),this)}reconnectionDelayMax(t){var n;return t===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,(n=this.backoff)===null||n===void 0||n.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(t){if(~this._readyState.indexOf("open"))return this;this.engine=new v_(this.uri,this.opts);const n=this.engine,r=this;this._readyState="opening",this.skipReconnect=!1;const i=Wn(n,"open",function(){r.onopen(),t&&t()}),a=l=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",l),t?t(l):this.maybeReconnectOnOpen()},o=Wn(n,"error",a);if(this._timeout!==!1){const l=this._timeout,c=this.setTimeoutFn(()=>{i(),a(new Error("timeout")),n.close()},l);this.opts.autoUnref&&c.unref(),this.subs.push(()=>{this.clearTimeoutFn(c)})}return this.subs.push(i),this.subs.push(o),this}connect(t){return this.open(t)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const t=this.engine;this.subs.push(Wn(t,"ping",this.onping.bind(this)),Wn(t,"data",this.ondata.bind(this)),Wn(t,"error",this.onerror.bind(this)),Wn(t,"close",this.onclose.bind(this)),Wn(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){try{this.decoder.add(t)}catch(n){this.onclose("parse error",n)}}ondecoded(t){fu(()=>{this.emitReserved("packet",t)},this.setTimeoutFn)}onerror(t){this.emitReserved("error",t)}socket(t,n){let r=this.nsps[t];return r?this._autoConnect&&!r.active&&r.connect():(r=new Lj(this,t,n),this.nsps[t]=r),r}_destroy(t){const n=Object.keys(this.nsps);for(const r of n)if(this.nsps[r].active)return;this._close()}_packet(t){const n=this.encoder.encode(t);for(let r=0;r<n.length;r++)this.engine.write(n[r],t.options)}cleanup(){this.subs.forEach(t=>t()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(t,n){var r;this.cleanup(),(r=this.engine)===null||r===void 0||r.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t,n),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const n=this.backoff.duration();this._reconnecting=!0;const r=this.setTimeoutFn(()=>{t.skipReconnect||(this.emitReserved("reconnect_attempt",t.backoff.attempts),!t.skipReconnect&&t.open(i=>{i?(t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",i)):t.onreconnect()}))},n);this.opts.autoUnref&&r.unref(),this.subs.push(()=>{this.clearTimeoutFn(r)})}}onreconnect(){const t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}}const Ga={};function ic(e,t){typeof e=="object"&&(t=e,e=void 0),t=t||{};const n=x_(e,t.path||"/socket.io"),r=n.source,i=n.id,a=n.path,o=Ga[i]&&a in Ga[i].nsps,l=t.forceNew||t["force new connection"]||t.multiplex===!1||o;let c;return l?c=new Th(r,t):(Ga[i]||(Ga[i]=new Th(r,t)),c=Ga[i]),n.query&&!t.query&&(t.query=n.queryKey),c.socket(n.path,t)}Object.assign(ic,{Manager:Th,Socket:Lj,io:ic,connect:ic});const Dj=m.createContext(void 0);function T_({children:e}){const[t,n]=m.useState(null);return m.useEffect(()=>{const r=localStorage.getItem("token");if(!r)return;const a=ic("http://localhost:5000",{transports:["websocket"],auth:{token:r}});return n(a),a.on("connect",()=>{console.log(" Socket connected:",a.id)}),a.on("disconnect",()=>{console.log(" Socket disconnected")}),()=>{a.disconnect(),n(null)}},[]),s.jsx(Dj.Provider,{value:t,children:e})}const O_=()=>{const e=m.useContext(Dj);return e===void 0&&console.warn("useSocket used outside SocketProvider"),e},P_=Object.freeze({SUPER_ADMIN:"/super-admin",SYSTEM_ADMIN:"/system-admin",HOSPITAL_ADMIN:"/hospital-admin",SECURITY_ADMIN:"/security-admin",SECURITY_OFFICER:"/security-officer",HR_MANAGER:"/hr-manager",PAYROLL_OFFICER:"/payroll-officer",DEVELOPER:"/developer",DOCTOR:"/doctor",NURSE:"/nurse",LAB_TECH:"/lab-tech",PHARMACIST:"/pharmacy",PATIENT:"/patient",GUEST:"/guest",RADIOLOGIST:"/staff",THERAPIST:"/staff",RECEPTIONIST:"/staff"}),Es=e=>{if(!(e!=null&&e.role))return"/login";const t=We(e.role);return P_[t]||"/unauthorized"},L_=[{label:"Dashboard Overview",path:"/"},{label:"Profile",path:"/profile"},{label:"Analytics",path:"/analytics"},{label:"Reports",path:"/reports"},{label:"Inventory",path:"/inventory"},{label:"Payments",path:"/payments"},{label:"Payment Operations",path:"/payments/full"},{label:"Payment Settings",path:"/admin/payment-settings"},{label:"AI Assistant",path:"/ai/medical"},{label:"AI Triage",path:"/ai/triage"},{label:"AI Voice Dictation",path:"/ai/voice"},{label:"AI Document Extract",path:"/ai/extract"},{label:"AI Chatbot",path:"/ai/chatbot"}],D_={SUPER_ADMIN:[{label:"Super Admin Dashboard",path:"/super-admin"},{label:"Manage Hospitals",path:"/super-admin/hospitals"},{label:"System Settings",path:"/super-admin/settings"},{label:"Admin Controls",path:"/admin"},{label:"Audit Logs",path:"/admin/audit-logs"},{label:"Integrations",path:"/admin/realtime"},{label:"System Admin Dashboard",path:"/system-admin"},{label:"Developer Console",path:"/developer"}],SYSTEM_ADMIN:[{label:"System Admin Dashboard",path:"/system-admin"},{label:"ABAC Policies",path:"/system-admin/abac"},{label:"Mapping Studio",path:"/system-admin/mapping-studio"},{label:"NLP Analytics",path:"/system-admin/nlp-analytics"},{label:"Regulatory Reports",path:"/system-admin/regulatory-reports"},{label:"Clinical Intelligence",path:"/system-admin/clinical-intelligence"},{label:"Manage Hospitals",path:"/super-admin/hospitals"},{label:"Admin Controls",path:"/admin"},{label:"Audit Logs",path:"/admin/audit-logs"},{label:"Integrations",path:"/admin/realtime"}],HOSPITAL_ADMIN:[{label:"Hospital Admin",path:"/hospital-admin"},{label:"Register Staff",path:"/hospital-admin/register-staff"},{label:"Approvals",path:"/hospital-admin/approvals"},{label:"Staff Management",path:"/hospital-admin/staff"},{label:"My Requests",path:"/workforce/requests"},{label:"Notifications",path:"/admin/notifications"},{label:"Offline Sync",path:"/admin/crdt-patients"},{label:"Clinical Intelligence",path:"/system-admin/clinical-intelligence"}],DOCTOR:[{label:"Doctor Dashboard",path:"/doctor"},{label:"My Schedule",path:"/doctor/schedule"},{label:"My Patients",path:"/doctor/patients"},{label:"OPD Clinic",path:"/doctor/opd"},{label:"Inpatient Ward",path:"/doctor/ward"},{label:"Surgery / Procedures",path:"/doctor/surgery"},{label:"Lab Results",path:"/doctor/lab-results"},{label:"Prescriptions",path:"/doctor/prescriptions"},{label:"Medical Records",path:"/doctor/medical-records"},{label:"Referrals",path:"/doctor/referrals"},{label:"Performance",path:"/doctor/performance"},{label:"CME & Certifications",path:"/doctor/cme"},{label:"Leave Requests",path:"/doctor/leave"},{label:"Reports & Notes",path:"/doctor/reports-notes"},{label:"Doctor Settings",path:"/doctor/settings"},{label:"Appointments",path:"/doctor/appointments"},{label:"My Requests",path:"/workforce/requests"},{label:"Clinical Intelligence",path:"/system-admin/clinical-intelligence"}],NURSE:[{label:"Nurse Dashboard",path:"/nurse"},{label:"My Shift",path:"/nurse/shift"},{label:"Assigned Patients",path:"/nurse/patients"},{label:"Medication Administration",path:"/nurse/medication"},{label:"Incident Reports",path:"/nurse/incidents"},{label:"Vitals Entry",path:"/nurse/vitals"},{label:"Leave Requests",path:"/nurse/leave"},{label:"Performance",path:"/nurse/performance"},{label:"My Requests",path:"/workforce/requests"},{label:"Clinical Intelligence",path:"/system-admin/clinical-intelligence"}],LAB_TECH:[{label:"Lab Dashboard",path:"/lab-tech"},{label:"Test Queue",path:"/lab-tech/test-queue"},{label:"Equipment Logs",path:"/lab-tech/equipment"},{label:"Sample Tracking",path:"/lab-tech/samples"},{label:"Quality Control",path:"/lab-tech/qc"},{label:"Safety Checklist",path:"/lab-tech/safety"},{label:"Reports Archive",path:"/lab-tech/archive"},{label:"Lab Tests",path:"/labtech/labs"},{label:"My Requests",path:"/workforce/requests"}],PHARMACIST:[{label:"Pharmacy",path:"/pharmacy"},{label:"Prescription Queue",path:"/pharmacy/queue"},{label:"Inventory",path:"/pharmacy/inventory"},{label:"Controlled Drugs",path:"/pharmacy/controlled"},{label:"Expiry Alerts",path:"/pharmacy/expiry"},{label:"Supplier Orders",path:"/pharmacy/suppliers"},{label:"Pharmacy Reports",path:"/pharmacy/reports"},{label:"My Requests",path:"/workforce/requests"}],HR_MANAGER:[{label:"HR Manager",path:"/hr-manager"},{label:"My Requests",path:"/workforce/requests"},{label:"Clinical Intelligence",path:"/system-admin/clinical-intelligence"}],PAYROLL_OFFICER:[{label:"Payroll Officer",path:"/payroll-officer"},{label:"My Requests",path:"/workforce/requests"}],DEVELOPER:[{label:"Developer Console",path:"/developer"},{label:"Queue Replay",path:"/developer/queue-replay"},{label:"Webhook Retry",path:"/developer/webhook-retry"},{label:"Decision Cockpit",path:"/developer/decision-cockpit"},{label:"Provenance Verify",path:"/developer/provenance-verify"},{label:"AI Extraction History",path:"/developer/ai-extraction-history"},{label:"ABAC Policies",path:"/system-admin/abac"},{label:"Mapping Studio",path:"/system-admin/mapping-studio"},{label:"NLP Analytics",path:"/system-admin/nlp-analytics"},{label:"Regulatory Reports",path:"/system-admin/regulatory-reports"},{label:"Clinical Intelligence",path:"/system-admin/clinical-intelligence"},{label:"System Admin Dashboard",path:"/system-admin"},{label:"Super Admin Dashboard",path:"/super-admin"}],SECURITY_ADMIN:[{label:"Security Admin",path:"/security-admin"},{label:"My Requests",path:"/workforce/requests"}],SECURITY_OFFICER:[{label:"Security Officer",path:"/security-officer"},{label:"My Requests",path:"/workforce/requests"}],RADIOLOGIST:[{label:"My Requests",path:"/workforce/requests"}],THERAPIST:[{label:"My Requests",path:"/workforce/requests"}],RECEPTIONIST:[{label:"My Requests",path:"/workforce/requests"}],PATIENT:[{label:"Patient Dashboard",path:"/patient"},{label:"My Appointments",path:"/patient/appointments"},{label:"Medical Records",path:"/patient/medical-records"},{label:"Prescriptions",path:"/patient/prescriptions"},{label:"Lab Results",path:"/patient/lab-results"},{label:"Billing",path:"/patient/billing"},{label:"Insurance",path:"/patient/insurance"},{label:"Feedback",path:"/patient/feedback"}],GUEST:[{label:"Guest Home",path:"/guest"}]};function M_(e){const t=We((e==null?void 0:e.role)||""),r=[...D_[t]||[],...L_],i=new Set;return r.filter(a=>i.has(a.path)?!1:(i.add(a.path),!0))}const Mj=m.createContext(null),nd=["system","light","dark"];function U_(){return typeof window>"u"?"light":window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function Eg(e){const t=e==="system"?U_():e;document.documentElement.setAttribute("data-theme",t),document.documentElement.setAttribute("data-theme-mode",e)}function B_({children:e}){const[t,n]=m.useState(()=>localStorage.getItem("theme")||"system");m.useEffect(()=>{if(Eg(t),localStorage.setItem("theme",t),t!=="system")return;const i=window.matchMedia("(prefers-color-scheme: dark)"),a=()=>Eg("system");return i.addEventListener?(i.addEventListener("change",a),()=>i.removeEventListener("change",a)):(i.addListener(a),()=>i.removeListener(a))},[t]);const r=m.useMemo(()=>({theme:t,setTheme:n,cycleTheme:()=>{const i=nd.indexOf(t),a=nd[(i+1)%nd.length];n(a)}}),[t]);return s.jsx(Mj.Provider,{value:r,children:e})}function Uj(){const e=m.useContext(Mj);if(!e)throw new Error("useTheme must be used inside ThemeProvider");return e}const rd="http://localhost:5000";async function Tr(e,t={}){const r={...{credentials:"include",headers:{"Content-Type":"application/json"}},...t},i=localStorage.getItem("token"),a=localStorage.getItem("refreshToken"),o=e.includes("/api/auth/login")||e.includes("/api/auth/register")||e.includes("/api/auth/google");if(r.body&&typeof r.body=="object"&&!(r.body instanceof FormData)&&(r.body=JSON.stringify(r.body)),i&&!o){const c=localStorage.getItem("role_override"),u=localStorage.getItem("strict_impersonation")==="1";r.headers={...r.headers,Authorization:`Bearer ${i}`,...c?{"X-Afya-View-Role":c}:{},...c&&u?{"X-Afya-Strict-Impersonation":"1"}:{}}}let l=await fetch(rd+e,r);if(l.status===401&&a){const c=await fetch(rd+"/api/auth/refresh",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:a})});if(c.ok){const u=await c.json();u!=null&&u.accessToken&&(localStorage.setItem("token",u.accessToken),r.headers={...r.headers,Authorization:`Bearer ${u.accessToken}`}),u!=null&&u.refreshToken&&localStorage.setItem("refreshToken",u.refreshToken),l=await fetch(rd+e,r)}}return l}const ue={get:async e=>({data:await(await Tr(e)).json()}),post:async(e,t)=>({data:await(await Tr(e,{method:"POST",body:t})).json()}),put:async(e,t)=>({data:await(await Tr(e,{method:"PUT",body:t})).json()}),delete:async e=>({data:await(await Tr(e,{method:"DELETE"})).json()})},Ws=async(e,t={})=>(await ue.post("/api/actions/trigger",{action:e,meta:t})).data,Bj=m.createContext(null);function V_(e){if(!e)return;let t=document.querySelector("link[rel='icon']");t||(t=document.createElement("link"),t.rel="icon",document.head.appendChild(t)),t.href=e}function $_({children:e}){const[t,n]=m.useState(null),r="http://localhost:5000";m.useEffect(()=>{fetch(`${r}/api/system-settings`).then(a=>a.json()).then(a=>{n(a)}).catch(()=>n({}))},[]),m.useEffect(()=>{if(!t)return;const a=t.branding||{};a.favicon&&V_(a.favicon);const o=document.documentElement;a.logo&&o.style.setProperty("--brand-logo",`url(${a.logo})`),a.appIcon&&o.style.setProperty("--brand-icon",`url(${a.appIcon})`),a.loginBackground&&o.style.setProperty("--login-bg",`url(${a.loginBackground})`),a.homeBackground&&o.style.setProperty("--home-bg",`url(${a.homeBackground})`)},[t]);const i=m.useMemo(()=>({settings:t,setSettings:n}),[t]);return s.jsx(Bj.Provider,{value:i,children:e})}function vi(){const e=m.useContext(Bj);if(!e)throw new Error("useSystemSettings must be used inside SystemSettingsProvider");return e}const Ho=async()=>(await ue.get("/api/developer/overview")).data,Oh=async()=>(await ue.get("/api/developer/trust-status")).data,mp=async()=>(await ue.post("/api/developer/workflow-sla/run")).data,F_=async()=>(await ue.get("/api/developer/decision-cockpit")).data,H_=async({query:e}={})=>(await ue.get(`/api/notifications/list${e?`?${e}`:""}`)).data,Vj=async e=>(await ue.put(`/api/notifications/${e}/read`)).data,$j=async e=>(await ue.put(`/api/notifications/${e}/unread`)).data,Fj=async()=>(await ue.put("/api/notifications/read-all")).data,q_=async({category:e,read:t}={})=>{const n=new URLSearchParams;e&&e!=="ALL"&&n.set("category",e),(t==="true"||t==="false")&&n.set("read",t);const r=n.toString();return(await ue.get(`/api/notifications/list${r?`?${r}`:""}`)).data};function Er({name:e}){const t={menu:"",home:s.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",children:s.jsx("path",{d:"M4 11.5 12 5l8 6.5v7a1 1 0 0 1-1 1h-5v-5H10v5H5a1 1 0 0 1-1-1z",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinejoin:"round"})}),bell:s.jsxs("svg",{viewBox:"0 0 24 24","aria-hidden":"true",children:[s.jsx("path",{d:"M18 16H6l1.5-2V10a4.5 4.5 0 0 1 9 0v4z",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinejoin:"round"}),s.jsx("path",{d:"M10 18a2 2 0 0 0 4 0",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round"})]}),chat:s.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",children:s.jsx("path",{d:"M6 6h12a2 2 0 0 1 2 2v6a2 2 0 0 1-2 2H9l-4 3v-3H6a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2z",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinejoin:"round"})}),help:s.jsxs("svg",{viewBox:"0 0 24 24","aria-hidden":"true",children:[s.jsx("path",{d:"M9 9a3 3 0 1 1 3 3v2",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round"}),s.jsx("circle",{cx:"12",cy:"17",r:"1",fill:"currentColor"}),s.jsx("circle",{cx:"12",cy:"12",r:"9",fill:"none",stroke:"currentColor",strokeWidth:"1.8"})]}),settings:s.jsxs("svg",{viewBox:"0 0 24 24","aria-hidden":"true",children:[s.jsx("path",{d:"M12 8.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 0 1 0-7z",fill:"none",stroke:"currentColor",strokeWidth:"1.8"}),s.jsx("path",{d:"M19 12a7 7 0 0 0-.1-1.2l2-1.5-2-3.5-2.4.8a7.4 7.4 0 0 0-2-1.2l-.4-2.5H10l-.4 2.5a7.4 7.4 0 0 0-2 1.2l-2.4-.8-2 3.5 2 1.5A7 7 0 0 0 5 12c0 .4 0 .8.1 1.2l-2 1.5 2 3.5 2.4-.8a7.4 7.4 0 0 0 2 1.2l.4 2.5h4l.4-2.5a7.4 7.4 0 0 0 2-1.2l2.4.8 2-3.5-2-1.5c.1-.4.1-.8.1-1.2z",fill:"none",stroke:"currentColor",strokeWidth:"1.3",strokeLinejoin:"round"})]}),sun:s.jsxs("svg",{viewBox:"0 0 24 24","aria-hidden":"true",children:[s.jsx("circle",{cx:"12",cy:"12",r:"4",fill:"none",stroke:"currentColor",strokeWidth:"1.8"}),s.jsx("path",{d:"M12 2v3M12 19v3M4.2 4.2l2.1 2.1M17.7 17.7l2.1 2.1M2 12h3M19 12h3M4.2 19.8l2.1-2.1M17.7 6.3l2.1-2.1",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round",fill:"none"})]}),calendar:s.jsxs("svg",{viewBox:"0 0 24 24","aria-hidden":"true",children:[s.jsx("rect",{x:"4",y:"5",width:"16",height:"15",rx:"2",fill:"none",stroke:"currentColor",strokeWidth:"1.8"}),s.jsx("path",{d:"M8 3v4M16 3v4M4 9h16",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round"})]}),emergency:s.jsxs("svg",{viewBox:"0 0 24 24","aria-hidden":"true",children:[s.jsx("path",{d:"M12 4 3 20h18L12 4z",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinejoin:"round"}),s.jsx("path",{d:"M12 10v4M12 17h.01",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round"})]})};return s.jsx("span",{className:"icon",children:t[e]||null})}function z_({onToggleSidebar:e}){var F,Z;const{user:t,logout:n,roleOverride:r,strictImpersonation:i}=Te(),a=Re(),o=hn(),{theme:l,cycleTheme:c}=Uj(),{settings:u}=vi(),[d,p]=m.useState(!1),[h,f]=m.useState(!1),[y,j]=m.useState([]),[A,g]=m.useState("ALL"),[x,w]=m.useState("ALL"),[E,_]=m.useState(""),[b,R]=m.useState(()=>{try{const Y=localStorage.getItem("workflow_sla_last_scan");return Y?JSON.parse(Y):null}catch{return null}}),[C,T]=m.useState(!1),D=15e3,U=(F=u==null?void 0:u.branding)==null?void 0:F.logo,W=m.useRef(null),q=(t==null?void 0:t.role)==="GUEST",P=(t==null?void 0:t.role)==="DOCTOR",V=t?Es(t):"/",K=m.useMemo(()=>M_(t),[t]),ce=m.useMemo(()=>{const Y=E.trim().toLowerCase();return Y?K.filter(ye=>ye.label.toLowerCase().includes(Y)).slice(0,8):[]},[E,K]),M=m.useMemo(()=>y.filter(Y=>!Y.read).length,[y]),X=!!r&&!!(t!=null&&t.actualRole)&&t.actualRole!==t.role,ae=["SUPER_ADMIN","SYSTEM_ADMIN","DEVELOPER"].includes(t==null?void 0:t.role),pe=m.useCallback(async()=>{var Y,ye,ge,Ke;if(ae)try{const Ae=await Ho(),Fe={pending:((ye=(Y=Ae==null?void 0:Ae.queues)==null?void 0:Y.workforce)==null?void 0:ye.totalPending)??0,breached:((Ke=(ge=Ae==null?void 0:Ae.queues)==null?void 0:ge.workforce)==null?void 0:Ke.breached)??0,updatedAt:new Date().toISOString(),lastScanAt:(b==null?void 0:b.lastScanAt)||null,escalationsL1:(b==null?void 0:b.escalationsL1)||0,escalationsL2:(b==null?void 0:b.escalationsL2)||0};R(Fe),localStorage.setItem("workflow_sla_last_scan",JSON.stringify(Fe))}catch{}},[ae,b==null?void 0:b.escalationsL1,b==null?void 0:b.escalationsL2,b==null?void 0:b.lastScanAt]),fe=m.useCallback(()=>{const Y=new URLSearchParams;A!=="ALL"&&Y.set("category",A),x==="READ"&&Y.set("read","true"),x==="UNREAD"&&Y.set("read","false");const ye=Y.toString();H_({query:ye}).then(ge=>{Array.isArray(ge)?j(ge):Array.isArray(ge==null?void 0:ge.items)?j(ge.items):j([])}).catch(()=>j([]))},[A,x]);m.useEffect(()=>{h&&fe()},[h,fe]),m.useEffect(()=>{fe();const Y=setInterval(fe,D);return()=>clearInterval(Y)},[fe]),m.useEffect(()=>{if(pe(),!ae)return;const Y=setInterval(pe,3e4);return()=>clearInterval(Y)},[ae,pe]);const De=m.useCallback(async()=>{var Y,ye,ge,Ke;T(!0);try{const Ae=await mp(),Fe={pending:(b==null?void 0:b.pending)??0,breached:(b==null?void 0:b.breached)??0,updatedAt:new Date().toISOString(),lastScanAt:(Ae==null?void 0:Ae.ranAt)||new Date().toISOString(),escalationsL1:((ye=(Y=Ae==null?void 0:Ae.result)==null?void 0:Y.workforce)==null?void 0:ye.escalationsL1)??0,escalationsL2:((Ke=(ge=Ae==null?void 0:Ae.result)==null?void 0:ge.workforce)==null?void 0:Ke.escalationsL2)??0};R(Fe),localStorage.setItem("workflow_sla_last_scan",JSON.stringify(Fe)),await pe()}finally{T(!1)}},[pe,b==null?void 0:b.breached,b==null?void 0:b.pending]);return m.useEffect(()=>{p(!1),f(!1),_("")},[o.pathname]),m.useEffect(()=>{const Y=ye=>{d&&W.current&&!W.current.contains(ye.target)&&p(!1)};return document.addEventListener("mousedown",Y),()=>document.removeEventListener("mousedown",Y)},[d]),s.jsxs("header",{className:"navbar",children:[s.jsxs("div",{className:"navbar-left",children:[s.jsx("button",{className:"icon-btn",onClick:e,"aria-label":"Open navigator",title:"Navigator",children:s.jsx(Er,{name:"menu"})}),s.jsx("button",{className:"brand-btn",onClick:()=>a(q?"/guest":V),children:U?s.jsx("span",{className:"brand-logo",style:{backgroundImage:`url(${U})`}}):"AfyaLink HCM"}),s.jsxs("button",{className:"icon-btn ghost",onClick:()=>a(V),"aria-label":"Home",title:"Home",children:[s.jsx(Er,{name:"home"}),"Home"]})]}),s.jsx("div",{className:"navbar-center",children:s.jsxs("div",{className:"search-wrap",children:[s.jsx("input",{className:"search-input",placeholder:"Search people, tasks, reports, help",value:E,onChange:Y=>_(Y.target.value)}),s.jsx("button",{className:"search-btn",onClick:()=>_(""),"aria-label":"Clear search",title:"Clear",children:"Clear"}),ce.length>0&&s.jsx("div",{className:"search-results",children:ce.map(Y=>s.jsxs("button",{className:"search-result",onClick:()=>{a(Y.path),_("")},children:[s.jsx("span",{className:"result-title",children:Y.label}),s.jsx("span",{className:"result-path",children:Y.path})]},Y.path))})]})}),s.jsxs("div",{className:"navbar-right",children:[X&&s.jsxs("div",{className:"override-mode-wrap",children:[s.jsxs("span",{className:"override-mode-badge",title:`Actual role: ${t.actualRole}`,children:["Override Mode: ",i?"Strict":"Full Access","  Viewing as: ",t.role]}),s.jsx("button",{className:"override-help",type:"button","aria-label":"Override mode help",title:"Override mode help","data-tip":i?"Strict impersonation active: actions are limited to the selected role permissions.":"Override active: all actions execute with founder/developer full permissions.",children:"?"})]}),ae&&s.jsxs("div",{className:"sla-status-wrap",children:[s.jsxs("span",{className:`sla-status-chip ${((b==null?void 0:b.breached)||0)>0?"risk":"ok"}`,title:`Pending: ${(b==null?void 0:b.pending)??0}, Breached: ${(b==null?void 0:b.breached)??0}`,children:["SLA ",b!=null&&b.breached?`Breached ${b.breached}`:"Healthy"]}),s.jsx("button",{className:"icon-btn ghost",disabled:C,onClick:De,title:b!=null&&b.lastScanAt?`Last scan: ${new Date(b.lastScanAt).toLocaleString()}`:"Run Workflow SLA Scan",children:C?"Scanning...":"Scan SLA"})]}),s.jsxs("div",{className:"profile-wrap",children:[s.jsxs("button",{className:"icon-btn ghost",title:"Notifications",onClick:async()=>{await Ws("OPEN_NOTIFICATIONS"),f(Y=>!Y)},children:[s.jsx(Er,{name:"bell"}),"Alerts",M>0&&s.jsx("span",{className:"notif-badge",children:M>99?"99+":M})]}),h&&s.jsxs("div",{className:"notif-menu",children:[s.jsxs("div",{className:"notif-head",children:[s.jsx("span",{children:"Notifications"}),s.jsx("button",{className:"notif-close",onClick:()=>f(!1),"aria-label":"Close notifications",children:""})]}),ae&&s.jsxs("div",{className:"sla-mini",children:[s.jsxs("div",{className:"sla-mini-row",children:[s.jsx("strong",{children:"SLA Control"}),s.jsx("span",{className:b!=null&&b.breached?"text-danger":"",children:b!=null&&b.breached?`${b.breached} breached`:"No breaches"})]}),s.jsxs("div",{className:"sla-mini-meta",children:["Last scan:"," ",b!=null&&b.lastScanAt?new Date(b.lastScanAt).toLocaleString():"Never"]}),s.jsxs("div",{className:"sla-mini-actions",children:[s.jsx("button",{className:"btn-secondary",onClick:()=>{f(!1),a("/hospital-admin/approvals?view=breached#pending")},children:"Open Breaches"}),s.jsx("button",{className:"btn-secondary",onClick:()=>{f(!1),a("/hospital-admin/approvals#sla")},children:"SLA Policies"}),s.jsx("button",{className:"btn-secondary",disabled:C,onClick:De,children:C?"Scanning...":"Scan Now"})]})]}),s.jsxs("div",{className:"notif-filters",children:[s.jsxs("select",{value:A,onChange:Y=>g(Y.target.value),children:[s.jsx("option",{value:"ALL",children:"All Categories"}),s.jsx("option",{value:"WORKFORCE",children:"Workforce"}),s.jsx("option",{value:"SECURITY",children:"Security"}),s.jsx("option",{value:"BILLING",children:"Billing"}),s.jsx("option",{value:"SYSTEM",children:"System"}),s.jsx("option",{value:"INTEGRATION",children:"Integration"}),s.jsx("option",{value:"AI",children:"AI"})]}),s.jsxs("select",{value:x,onChange:Y=>w(Y.target.value),children:[s.jsx("option",{value:"ALL",children:"All Status"}),s.jsx("option",{value:"UNREAD",children:"Unread"}),s.jsx("option",{value:"READ",children:"Read"})]}),s.jsx("button",{className:"btn-secondary",onClick:async()=>{await Fj(),j(Y=>Y.map(ye=>({...ye,read:!0})))},children:"Mark all read"})]}),s.jsxs("div",{className:"notif-list",children:[y.slice(0,6).map(Y=>s.jsxs("div",{className:"notif-item",children:[s.jsxs("div",{className:"notif-title",children:[Y.title||"Notification",!Y.read&&s.jsx("span",{className:"badge-dot",children:"!"})]}),s.jsx("div",{className:"notif-body",children:Y.body||"-"}),s.jsx("div",{className:"notif-actions",children:s.jsx("button",{className:"btn-secondary",onClick:async()=>{Y.read?(await $j(Y._id),j(ye=>ye.map(ge=>ge._id===Y._id?{...ge,read:!1}:ge))):(await Vj(Y._id),j(ye=>ye.map(ge=>ge._id===Y._id?{...ge,read:!0}:ge)))},children:Y.read?"Mark unread":"Mark read"})})]},Y._id)),y.length===0&&s.jsx("div",{className:"muted",children:"No notifications"})]}),s.jsx("button",{className:"notif-link",onClick:()=>{f(!1),a("/admin/notifications")},children:"View All Notifications"})]})]}),P&&s.jsxs("button",{className:"icon-btn ghost",title:"Quick Calendar",onClick:()=>a("/doctor/schedule"),children:[s.jsx(Er,{name:"calendar"}),"Calendar"]}),P&&s.jsxs("button",{className:"icon-btn danger-soft",title:"Emergency Alert",onClick:async()=>{await Ws("EMERGENCY_ALERT"),a("/doctor/ward")},children:[s.jsx(Er,{name:"emergency"}),"Emergency"]}),s.jsxs("button",{className:"icon-btn ghost",title:"Messages",onClick:async()=>{await Ws("OPEN_MESSAGES"),a("/ai/chatbot")},children:[s.jsx(Er,{name:"chat"}),"Messages"]}),s.jsxs("button",{className:"icon-btn ghost",title:"Help",onClick:async()=>{await Ws("OPEN_HELP"),a("/reports")},children:[s.jsx(Er,{name:"help"}),"Help"]}),s.jsxs("button",{className:"icon-btn ghost",title:"Theme",onClick:async()=>{await Ws("TOGGLE_THEME"),c()},children:[s.jsx(Er,{name:"sun"}),l==="system"?"System":l==="dark"?"Dark":"Light"]}),s.jsxs("button",{className:"icon-btn ghost",title:"Settings",onClick:async()=>{await Ws("OPEN_SETTINGS"),a("/profile")},children:[s.jsx(Er,{name:"settings"}),"Settings"]}),s.jsxs("div",{className:"profile-wrap",ref:W,children:[s.jsxs("button",{className:"profile-btn",onClick:()=>p(Y=>!Y),children:[s.jsx("span",{className:"avatar",children:((Z=t==null?void 0:t.name)==null?void 0:Z[0])||"U"}),s.jsxs("span",{className:"profile-meta",children:[s.jsx("span",{className:"profile-name",children:(t==null?void 0:t.name)||"User"}),s.jsx("span",{className:"profile-role",children:(t==null?void 0:t.role)||"User"})]})]}),d&&s.jsxs("div",{className:"profile-menu",children:[s.jsxs("div",{className:"profile-menu-head",children:[s.jsx("span",{children:"Profile"}),s.jsx("button",{className:"notif-close",onClick:()=>p(!1),"aria-label":"Close profile menu",children:""})]}),s.jsx("button",{onClick:()=>a("/profile"),children:"My Profile"}),s.jsx("button",{onClick:()=>a("/profile"),children:"Preferences"}),s.jsx("button",{onClick:()=>a("/reports"),children:"About AfyaLink"}),q?s.jsx("button",{onClick:()=>a("/register"),children:"Upgrade"}):s.jsx("button",{className:"danger",onClick:n,children:"Sign Out"})]})]})]})]})}const sd={appointments:{read:["SUPER_ADMIN","DEVELOPER","HOSPITAL_ADMIN","DOCTOR","NURSE"],create:["DOCTOR","HOSPITAL_ADMIN"],update:["DOCTOR","HOSPITAL_ADMIN"],delete:["HOSPITAL_ADMIN"]},pharmacy:{read:["PHARMACIST","HOSPITAL_ADMIN"],dispense:["PHARMACIST"],manage:["HOSPITAL_ADMIN"]},inventory:{read:["PHARMACIST","HOSPITAL_ADMIN","SUPER_ADMIN","DEVELOPER","SYSTEM_ADMIN"],update:["PHARMACIST","HOSPITAL_ADMIN"]},billing:{read:["HOSPITAL_ADMIN","ACCOUNTANT"],create:["ACCOUNTANT"]},reports:{read:["SUPER_ADMIN","DEVELOPER","HOSPITAL_ADMIN"]},audit:{read:["SUPER_ADMIN","DEVELOPER","HOSPITAL_ADMIN"]}},W_=()=>{const{user:e}=Te();return{can:(n,r)=>{var c,u;if(!e)return!1;const i=We(e.role),a=We(e.actualRole);return!(typeof window<"u"&&((c=window.localStorage)==null?void 0:c.getItem("strict_impersonation"))==="1")&&["SUPER_ADMIN","DEVELOPER"].includes(a)?!0:(((u=sd==null?void 0:sd[n])==null?void 0:u[r])||[]).includes(i)}}},G_=async()=>(await ue.get("/api/menu")).data;function An({name:e}){var i,a;const{settings:t}=vi(),n={home:"",admin:"",hr:"",payroll:"",doctor:"",nurse:"",lab:"",pharmacy:"",staff:"",security:"",settings:"",analytics:"",reports:"",notifications:"",requests:"",inventory:"",ai:"",appointments:""},r=(a=(i=t==null?void 0:t.branding)==null?void 0:i.sidebarIcons)==null?void 0:a[e];return s.jsx("span",{className:"nav-icon","aria-hidden":"true",children:r?s.jsx("img",{className:"nav-icon-img",src:r,alt:""}):n[e]||""})}function Y_({open:e=!0,onClose:t}){var j,A;const{user:n,logout:r}=Te(),{can:i}=W_(),{theme:a,setTheme:o}=Uj(),{settings:l}=vi(),c=Re(),[u,d]=m.useState([]),[p,h]=m.useState(!1);if(m.useEffect(()=>{!n||!localStorage.getItem("token")||G_().then(x=>{d(x.menu||[]),h(!0)}).catch(()=>{d([]),h(!0)})},[n]),!n)return null;Es(n);const f=We(n.role),y=!["SUPER_ADMIN","SYSTEM_ADMIN","GUEST","PATIENT"].includes(f);return n.role==="GUEST"?s.jsxs("aside",{className:`sidebar ${e?"":"collapsed"}`,onWheel:g=>g.stopPropagation(),children:[s.jsxs("div",{className:"sidebar-header sticky",children:[s.jsx("div",{className:"brand-mark",children:(j=l==null?void 0:l.branding)!=null&&j.logo?s.jsx("span",{className:"brand-logo",style:{backgroundImage:`url(${l.branding.logo})`}}):"AfyaLink"}),s.jsx("div",{className:"brand-sub",children:"Demo Workspace"})]}),s.jsx("div",{className:"sidebar-scroll",children:s.jsx("nav",{children:s.jsxs("ul",{children:[s.jsx("li",{children:s.jsxs("button",{className:"nav-btn",onClick:()=>{c("/guest"),t==null||t()},children:[s.jsx(An,{name:"home"}),"Demo Home"]})}),s.jsxs(Lt,{title:"Demo",children:[i("ai","chat")&&s.jsx(Q,{to:"/ai/chatbot",icon:"ai",onSelect:t,children:"AI Chatbot"}),i("ai","medical")&&s.jsx(Q,{to:"/ai/medical",icon:"ai",onSelect:t,children:"AI Assistant"})]})]})})}),s.jsxs("div",{className:"sidebar-footer sticky-footer",children:[s.jsxs("div",{className:"footer-actions",children:[s.jsxs("button",{className:"nav-btn",onClick:()=>{c("/reports"),t==null||t()},children:[s.jsx(An,{name:"reports"}),"Help"]}),s.jsxs("button",{className:"nav-btn",onClick:()=>{c("/profile"),t==null||t()},children:[s.jsx(An,{name:"settings"}),"Settings"]}),s.jsxs("button",{className:"nav-btn",onClick:()=>{r(),t==null||t()},children:[s.jsx(An,{name:"security"}),"Sign Out"]})]}),s.jsx("div",{children:"AfyaLink  Demo Mode"})]})]}):s.jsxs("aside",{className:`sidebar ${e?"":"collapsed"}`,onWheel:g=>g.stopPropagation(),children:[s.jsxs("div",{className:"sidebar-header sticky",children:[s.jsx("div",{className:"brand-mark",children:(A=l==null?void 0:l.branding)!=null&&A.logo?s.jsx("span",{className:"brand-logo",style:{backgroundImage:`url(${l.branding.logo})`}}):"AfyaLink"}),s.jsxs("div",{className:"brand-sub",children:[n.role," Workspace"]})]}),s.jsx("div",{className:"sidebar-scroll",children:s.jsx("nav",{children:s.jsxs("ul",{children:[p&&u.length>0&&u.map(g=>s.jsx(Lt,{title:g.section,children:g.items.map((x,w)=>x.path?s.jsx(Q,{to:x.path,icon:x.icon||"admin",onSelect:t,children:x.label},x.path||`${g.section}-${w}`):s.jsx("li",{className:"nav-static",children:s.jsxs("span",{className:"nav-btn",children:[s.jsx(An,{name:x.icon||"admin"}),x.label]})},`${g.section}-${w}`))},g.section)),p&&u.length===0&&s.jsxs(s.Fragment,{children:[["SUPER_ADMIN","DEVELOPER"].includes(f)&&s.jsxs(Lt,{title:"All Dashboards",children:[s.jsx(Q,{to:"/super-admin",icon:"admin",onSelect:t,children:"Super Admin"}),s.jsx(Q,{to:"/system-admin",icon:"admin",onSelect:t,children:"System Admin"}),s.jsx(Q,{to:"/hospital-admin",icon:"admin",onSelect:t,children:"Hospital Admin"}),s.jsx(Q,{to:"/hr-manager",icon:"hr",onSelect:t,children:"HR Manager"}),s.jsx(Q,{to:"/payroll-officer",icon:"payroll",onSelect:t,children:"Payroll Officer"}),s.jsx(Q,{to:"/doctor",icon:"doctor",onSelect:t,children:"Doctor"}),s.jsx(Q,{to:"/nurse",icon:"nurse",onSelect:t,children:"Nurse"}),s.jsx(Q,{to:"/lab-tech",icon:"lab",onSelect:t,children:"Lab Tech"}),s.jsx(Q,{to:"/pharmacy",icon:"pharmacy",onSelect:t,children:"Pharmacist"}),s.jsx(Q,{to:"/staff",icon:"staff",onSelect:t,children:"Staff (Radiology/Therapy/Reception)"}),s.jsx(Q,{to:"/security-admin",icon:"security",onSelect:t,children:"Security Admin"}),s.jsx(Q,{to:"/security-officer",icon:"security",onSelect:t,children:"Security Officer"}),s.jsx(Q,{to:"/developer",icon:"settings",onSelect:t,children:"Developer Console"}),s.jsx(Q,{to:"/developer/queue-replay",icon:"settings",onSelect:t,children:"Queue Replay"}),s.jsx(Q,{to:"/developer/webhook-retry",icon:"settings",onSelect:t,children:"Webhook Retry"}),s.jsx(Q,{to:"/developer/decision-cockpit",icon:"analytics",onSelect:t,children:"Decision Cockpit"}),s.jsx(Q,{to:"/developer/provenance-verify",icon:"security",onSelect:t,children:"Provenance Verify"}),s.jsx(Q,{to:"/developer/ai-extraction-history",icon:"ai",onSelect:t,children:"AI Extraction History"})]}),s.jsxs(Lt,{title:"Home",children:[s.jsx(Q,{to:"/analytics",icon:"analytics",onSelect:t,children:"Insights"}),s.jsx(Q,{to:"/reports",icon:"reports",onSelect:t,children:"Reports"}),f==="SYSTEM_ADMIN"&&s.jsx(Q,{to:"/system-admin",icon:"admin",onSelect:t,children:"System Admin"}),["SYSTEM_ADMIN","SUPER_ADMIN","DEVELOPER"].includes(We(n.role))&&s.jsx(Q,{to:"/system-admin/abac",icon:"security",onSelect:t,children:"ABAC Policies"}),["SYSTEM_ADMIN","SUPER_ADMIN","DEVELOPER"].includes(We(n.role))&&s.jsx(Q,{to:"/system-admin/mapping-studio",icon:"settings",onSelect:t,children:"Mapping Studio"}),["SYSTEM_ADMIN","SUPER_ADMIN","DEVELOPER","HOSPITAL_ADMIN","HR_MANAGER","PAYROLL_OFFICER"].includes(We(n.role))&&s.jsx(Q,{to:"/system-admin/nlp-analytics",icon:"analytics",onSelect:t,children:"NLP Analytics"}),["SYSTEM_ADMIN","SUPER_ADMIN","DEVELOPER","HOSPITAL_ADMIN","HR_MANAGER","DOCTOR","NURSE"].includes(We(n.role))&&s.jsx(Q,{to:"/system-admin/clinical-intelligence",icon:"ai",onSelect:t,children:"Clinical Intelligence"}),["SYSTEM_ADMIN","SUPER_ADMIN","DEVELOPER","HOSPITAL_ADMIN"].includes(We(n.role))&&s.jsx(Q,{to:"/system-admin/regulatory-reports",icon:"reports",onSelect:t,children:"Regulatory Reports"}),f==="DEVELOPER"&&s.jsx(Q,{to:"/developer",icon:"settings",onSelect:t,children:"Developer Console"}),["SUPER_ADMIN","SYSTEM_ADMIN"].includes(We(n.role))&&s.jsx(Q,{to:"/super-admin/hospitals",icon:"admin",onSelect:t,children:"Manage Hospitals"})]}),s.jsxs(Lt,{title:"Human Resources",children:[s.jsx(Q,{to:"/hospital-admin",icon:"admin",onSelect:t,children:"Hospital Admin"}),s.jsx(Q,{to:"/hospital-admin/register-staff",icon:"staff",onSelect:t,children:"Register Staff"}),s.jsx(Q,{to:"/hospital-admin/approvals",icon:"notifications",onSelect:t,children:"Approvals"}),s.jsx(Q,{to:"/hospital-admin/staff",icon:"staff",onSelect:t,children:"Staff Management"}),y&&s.jsx(Q,{to:"/workforce/requests",icon:"requests",onSelect:t,children:"My Requests"}),s.jsx(Q,{to:"/staff",icon:"staff",onSelect:t,children:"Staff Workspace"}),s.jsx(Q,{to:"/hr-manager",icon:"hr",onSelect:t,children:"HR Manager"}),i("inventory","read")&&s.jsx(Q,{to:"/inventory",icon:"inventory",onSelect:t,children:"Inventory"}),i("pharmacy","read")&&s.jsx(Q,{to:"/pharmacy",icon:"pharmacy",onSelect:t,children:"Pharmacy"})]}),s.jsxs(Lt,{title:"Talent",children:[s.jsx(Q,{to:"/admin/create-admin",icon:"admin",onSelect:t,children:"Admin Access"}),s.jsx(Q,{to:"/admin/audit-logs",icon:"admin",onSelect:t,children:"Audit Logs"}),s.jsx(Q,{to:"/admin/notifications",icon:"notifications",onSelect:t,children:"Notifications"})]}),s.jsxs(Lt,{title:"Workforce",children:[s.jsx(Q,{to:"/doctor",icon:"doctor",onSelect:t,children:"Clinician Dashboard"}),s.jsx(Q,{to:"/nurse",icon:"nurse",onSelect:t,children:"Nursing Dashboard"}),s.jsx(Q,{to:"/lab-tech",icon:"lab",onSelect:t,children:"Lab Dashboard"}),s.jsx(Q,{to:"/labtech/labs",icon:"lab",onSelect:t,children:"Lab Tests"}),s.jsx(Q,{to:"/doctor/appointments",icon:"appointments",onSelect:t,children:"Appointments"})]}),f==="DOCTOR"&&s.jsxs(Lt,{title:"Doctor Workspace",children:[s.jsx(Q,{to:"/doctor/schedule",icon:"appointments",onSelect:t,children:"My Schedule"}),s.jsx(Q,{to:"/doctor/patients",icon:"doctor",onSelect:t,children:"My Patients"}),s.jsx(Q,{to:"/doctor/opd",icon:"doctor",onSelect:t,children:"OPD Clinic"}),s.jsx(Q,{to:"/doctor/ward",icon:"staff",onSelect:t,children:"Inpatient Ward"}),s.jsx(Q,{to:"/doctor/surgery",icon:"reports",onSelect:t,children:"Surgery / Procedures"}),s.jsx(Q,{to:"/doctor/lab-results",icon:"lab",onSelect:t,children:"Lab Results"}),s.jsx(Q,{to:"/doctor/prescriptions",icon:"pharmacy",onSelect:t,children:"Prescriptions"}),s.jsx(Q,{to:"/doctor/medical-records",icon:"reports",onSelect:t,children:"Medical Records"}),s.jsx(Q,{to:"/doctor/referrals",icon:"reports",onSelect:t,children:"Referrals"}),s.jsx(Q,{to:"/doctor/performance",icon:"analytics",onSelect:t,children:"Performance"}),s.jsx(Q,{to:"/doctor/cme",icon:"doctor",onSelect:t,children:"CME & Certifications"}),s.jsx(Q,{to:"/doctor/leave",icon:"requests",onSelect:t,children:"Leave Requests"}),s.jsx(Q,{to:"/doctor/reports-notes",icon:"reports",onSelect:t,children:"Reports & Notes"}),s.jsx(Q,{to:"/doctor/settings",icon:"settings",onSelect:t,children:"Settings"})]}),f==="NURSE"&&s.jsxs(Lt,{title:"Nurse Workspace",children:[s.jsx(Q,{to:"/nurse/shift",icon:"nurse",onSelect:t,children:"My Shift"}),s.jsx(Q,{to:"/nurse/patients",icon:"staff",onSelect:t,children:"Assigned Patients"}),s.jsx(Q,{to:"/nurse/medication",icon:"nurse",onSelect:t,children:"Medication Administration"}),s.jsx(Q,{to:"/nurse/incidents",icon:"notifications",onSelect:t,children:"Incident Reports"}),s.jsx(Q,{to:"/nurse/vitals",icon:"reports",onSelect:t,children:"Vitals Entry"}),s.jsx(Q,{to:"/nurse/leave",icon:"requests",onSelect:t,children:"Leave Requests"}),s.jsx(Q,{to:"/nurse/performance",icon:"analytics",onSelect:t,children:"Performance"})]}),f==="LAB_TECH"&&s.jsxs(Lt,{title:"Lab Workspace",children:[s.jsx(Q,{to:"/lab-tech/test-queue",icon:"lab",onSelect:t,children:"Test Queue"}),s.jsx(Q,{to:"/lab-tech/equipment",icon:"lab",onSelect:t,children:"Equipment Logs"}),s.jsx(Q,{to:"/lab-tech/samples",icon:"lab",onSelect:t,children:"Sample Tracking"}),s.jsx(Q,{to:"/lab-tech/qc",icon:"analytics",onSelect:t,children:"Quality Control"}),s.jsx(Q,{to:"/lab-tech/safety",icon:"security",onSelect:t,children:"Safety Checklist"}),s.jsx(Q,{to:"/lab-tech/archive",icon:"reports",onSelect:t,children:"Reports Archive"})]}),f==="PHARMACIST"&&s.jsxs(Lt,{title:"Pharmacy Workspace",children:[s.jsx(Q,{to:"/pharmacy/queue",icon:"pharmacy",onSelect:t,children:"Prescription Queue"}),s.jsx(Q,{to:"/pharmacy/inventory",icon:"inventory",onSelect:t,children:"Inventory"}),s.jsx(Q,{to:"/pharmacy/controlled",icon:"security",onSelect:t,children:"Controlled Drugs"}),s.jsx(Q,{to:"/pharmacy/expiry",icon:"notifications",onSelect:t,children:"Expiry Alerts"}),s.jsx(Q,{to:"/pharmacy/suppliers",icon:"reports",onSelect:t,children:"Supplier Orders"}),s.jsx(Q,{to:"/pharmacy/reports",icon:"reports",onSelect:t,children:"Reports"})]}),f==="PATIENT"&&s.jsxs(Lt,{title:"Patient Workspace",children:[s.jsx(Q,{to:"/patient/appointments",icon:"appointments",onSelect:t,children:"My Appointments"}),s.jsx(Q,{to:"/patient/medical-records",icon:"reports",onSelect:t,children:"Medical Records"}),s.jsx(Q,{to:"/patient/prescriptions",icon:"pharmacy",onSelect:t,children:"Prescriptions"}),s.jsx(Q,{to:"/patient/lab-results",icon:"lab",onSelect:t,children:"Lab Results"}),s.jsx(Q,{to:"/patient/billing",icon:"payroll",onSelect:t,children:"Billing"}),s.jsx(Q,{to:"/patient/insurance",icon:"reports",onSelect:t,children:"Insurance"}),s.jsx(Q,{to:"/patient/feedback",icon:"notifications",onSelect:t,children:"Feedback"})]}),s.jsxs(Lt,{title:"Payroll & Finance",children:[s.jsx(Q,{to:"/payments",icon:"payroll",onSelect:t,children:"Payroll & Payments"}),s.jsx(Q,{to:"/payments/full",icon:"payroll",onSelect:t,children:"Payment Operations"}),We(n.role)==="SUPER_ADMIN"&&s.jsx(Q,{to:"/admin/payment-settings",icon:"payroll",onSelect:t,children:"Payment Settings"}),s.jsx(Q,{to:"/payroll-officer",icon:"payroll",onSelect:t,children:"Payroll Officer"})]}),s.jsxs(Lt,{title:"AI & Automation",children:[s.jsx(Q,{to:"/ai/medical",icon:"ai",onSelect:t,children:"Clinical Assistant"}),s.jsx(Q,{to:"/ai/triage",icon:"ai",onSelect:t,children:"Triage"}),s.jsx(Q,{to:"/ai/voice",icon:"ai",onSelect:t,children:"Voice Dictation"}),s.jsx(Q,{to:"/ai/extract",icon:"ai",onSelect:t,children:"NeuroEdge Extract"}),s.jsx(Q,{to:"/ai/chatbot",icon:"ai",onSelect:t,children:"Support Chat"}),s.jsx(Q,{to:"/ai/ws",icon:"ai",onSelect:t,children:"Live AI Chat"})]}),s.jsxs(Lt,{title:"Security & Setup",children:[s.jsx(Q,{to:"/security-admin",icon:"security",onSelect:t,children:"Security Admin"}),s.jsx(Q,{to:"/security-officer",icon:"security",onSelect:t,children:"Security Officer"}),s.jsx(Q,{to:"/admin/realtime",icon:"settings",onSelect:t,children:"Integrations"}),s.jsx(Q,{to:"/admin/crdt-patients",icon:"settings",onSelect:t,children:"Offline Sync"})]}),s.jsx(Lt,{title:"Quick Actions",children:K_(We(n.role)).map(g=>s.jsx(Q,{to:g.path,icon:"home",onSelect:t,children:g.label},g.path))}),s.jsxs(Lt,{title:"Settings",children:[["SUPER_ADMIN","DEVELOPER"].includes(We(n.role))&&s.jsx(Q,{to:"/super-admin/settings",icon:"settings",onSelect:t,children:"System Settings"}),s.jsx(Q,{to:"/profile",icon:"settings",onSelect:t,children:"Account Settings"}),s.jsx(Q,{to:"/reports",icon:"reports",onSelect:t,children:"Help & Policies"}),s.jsx(Q,{to:"/admin/audit-logs",icon:"admin",onSelect:t,children:"Activity Log"}),s.jsxs("li",{className:"theme-row",children:[s.jsxs("button",{className:`nav-btn ${a==="light"?"active":""}`,onClick:()=>o("light"),children:[s.jsx(An,{name:"settings"}),"Light"]}),s.jsxs("button",{className:`nav-btn ${a==="dark"?"active":""}`,onClick:()=>o("dark"),children:[s.jsx(An,{name:"settings"}),"Dark"]}),s.jsxs("button",{className:`nav-btn ${a==="system"?"active":""}`,onClick:()=>o("system"),children:[s.jsx(An,{name:"settings"}),"System"]})]})]})]})]})})}),s.jsxs("div",{className:"sidebar-footer sticky-footer",children:[s.jsxs("div",{className:"footer-actions",children:[s.jsxs("button",{className:"nav-btn",onClick:()=>{c("/reports"),t==null||t()},children:[s.jsx(An,{name:"reports"}),"Help"]}),s.jsxs("button",{className:"nav-btn",onClick:()=>{c("/profile"),t==null||t()},children:[s.jsx(An,{name:"settings"}),"Settings"]}),s.jsxs("button",{className:"nav-btn",onClick:()=>{r(),t==null||t()},children:[s.jsx(An,{name:"security"}),"Sign Out"]})]}),s.jsx("div",{children:"AfyaLink  Secure"})]})]})}function Lt({title:e,children:t}){return s.jsxs(s.Fragment,{children:[s.jsx("li",{className:"section-title",children:e}),t]})}function Q({to:e,children:t,icon:n,onSelect:r}){const i=Re();return s.jsx("li",{children:s.jsxs("button",{className:"nav-btn",onClick:()=>{i(e),r==null||r()},children:[s.jsx(An,{name:n}),t]})})}function K_(e){const t=[{label:"Request Leave",path:"/workforce/requests#leave"},{label:"Request Overtime",path:"/workforce/requests#overtime"},{label:"Request Shift",path:"/workforce/requests#shift"}],n=[{label:"View Notifications",path:"/admin/notifications"},{label:"Open Reports",path:"/reports"}],r={SUPER_ADMIN:[{label:"Manage Hospitals",path:"/super-admin/hospitals"},{label:"Create Admin",path:"/admin/create-admin"},{label:"Audit Logs",path:"/admin/audit-logs"},{label:"SLA Policies",path:"/hospital-admin/approvals#sla"},{label:"Queue Insights",path:"/hospital-admin/approvals"}],SYSTEM_ADMIN:[{label:"Manage Hospitals",path:"/super-admin/hospitals"},{label:"Audit Logs",path:"/admin/audit-logs"},{label:"SLA Policies",path:"/hospital-admin/approvals#sla"},{label:"Queue Insights",path:"/hospital-admin/approvals"}],HOSPITAL_ADMIN:[{label:"Open Approvals",path:"/hospital-admin"},{label:"Inventory Review",path:"/inventory"},{label:"SLA Policies",path:"/hospital-admin/approvals#sla"}],HR_MANAGER:[{label:"Recruitment Pipeline",path:"/hr-manager"},{label:"Performance Reviews",path:"/hr-manager"}],PAYROLL_OFFICER:[{label:"Run Payroll",path:"/payroll-officer"},{label:"Payment Operations",path:"/payments/full"}],DOCTOR:[{label:"Start Consult",path:"/doctor"},{label:"Appointments",path:"/doctor/appointments"}],NURSE:[{label:"Start Round",path:"/nurse"},{label:"Patient Tasks",path:"/nurse"}],LAB_TECH:[{label:"Lab Queue",path:"/lab-tech"},{label:"Lab Tests",path:"/labtech/labs"}],PHARMACIST:[{label:"Dispense Queue",path:"/pharmacy"},{label:"Inventory",path:"/inventory"}],RADIOLOGIST:[],THERAPIST:[],RECEPTIONIST:[],DEVELOPER:[{label:"Integration Console",path:"/developer"},{label:"SLA Policies",path:"/hospital-admin/approvals#sla"},{label:"Queue Insights",path:"/hospital-admin/approvals"}],PATIENT:[{label:"Book Appointment",path:"/patient"},{label:"Payments",path:"/payments"}]},i=["HOSPITAL_ADMIN","HR_MANAGER","PAYROLL_OFFICER","DOCTOR","NURSE","LAB_TECH","PHARMACIST","RADIOLOGIST","THERAPIST","RECEPTIONIST","SECURITY_ADMIN","SECURITY_OFFICER"].includes(e);return[...r[e]||[],...i?t:[],...n]}function J_(){const{settings:e}=vi(),t=e==null?void 0:e.ai;return!(t!=null&&t.enabled)||!(t!=null&&t.url)?null:s.jsxs("button",{className:"ai-float",onClick:()=>window.open(t.url,"_blank"),title:t.name||"NeuroEdge",children:[s.jsx("span",{className:"ai-float-badge",children:t.name||"NeuroEdge"}),s.jsx("span",{className:"ai-float-sub",children:t.greeting||"Ask AI"})]})}function Q_(){const{user:e}=Te(),[t,n]=m.useState(!1);m.useEffect(()=>{if(!(e!=null&&e.id))return;const i=`tour_seen_${e.id}`;localStorage.getItem(i)==="true"||n(!0)},[e==null?void 0:e.id]);const r=()=>{e!=null&&e.id&&localStorage.setItem(`tour_seen_${e.id}`,"true"),n(!1)};return t?s.jsx("div",{className:"tour-backdrop",role:"dialog","aria-modal":"true",children:s.jsxs("div",{className:"tour-modal",children:[s.jsx("button",{className:"tour-close",onClick:r,"aria-label":"Close",children:""}),s.jsx("h3",{children:"Welcome to AfyaLink HRMS"}),s.jsx("p",{className:"muted",children:"Heres a quick guide to get you started. You can revisit this anytime from Help."}),s.jsxs("ul",{className:"tour-list",children:[s.jsx("li",{children:"Use the navigator to switch dashboards and modules."}),s.jsx("li",{children:"Search across people, tasks, and reports from the top bar."}),s.jsx("li",{children:"Complete your verification in Profile for full access."}),s.jsx("li",{children:"Check alerts for approvals, requests, and system notices."})]}),s.jsxs("div",{className:"tour-actions",children:[s.jsx("button",{className:"btn-secondary",onClick:r,children:"Skip"}),s.jsx("button",{className:"btn-primary",onClick:r,children:"Start"})]})]})}):null}function Z_(e,...t){var o;if(!e)return{allowed:!1,reason:"UNAUTHENTICATED"};if(!t.length)return{allowed:!0};const n=We(e.role),r=We(e.actualRole),i=typeof window<"u"&&((o=window.localStorage)==null?void 0:o.getItem("strict_impersonation"))==="1",a=t.map(l=>We(l));return!i&&["SUPER_ADMIN","DEVELOPER"].includes(r)?{allowed:!0}:["SUPER_ADMIN","DEVELOPER"].includes(n)?{allowed:!0}:a.includes(n)?{allowed:!0}:{allowed:!1,reason:"FORBIDDEN"}}function oe({roles:e=[],children:t}){const{user:n,loading:r}=Te(),i=hn();return r?null:n?Z_(n,...e).allowed?t:s.jsx(pa,{to:"/unauthorized",replace:!0}):s.jsx(pa,{to:"/login",state:{from:i},replace:!0})}function X_({children:e}){const{user:t,loading:n}=Te(),r=hn(),i=Re();return m.useEffect(()=>{if(n||!t)return;const a=Es(t);r.pathname==="/"&&i(a,{replace:!0})},[t,n,r.pathname,i]),e}function Bc({label:e="Password",value:t,onChange:n,placeholder:r="",showStrength:i=!1}){const[a,o]=m.useState(!1),l=t.length>=12?"strong":t.length>=8?"medium":t.length>0?"weak":"";return s.jsxs("div",{children:[s.jsx("label",{children:e}),s.jsxs("div",{style:{position:"relative"},children:[s.jsx("input",{type:a?"text":"password",value:t,placeholder:r,onChange:n,required:!0}),s.jsx("span",{onClick:()=>o(!a),style:{position:"absolute",right:14,top:12,cursor:"pointer",userSelect:"none"},children:a?"":""})]}),i&&t&&s.jsxs("div",{className:`pw-strength ${l}`,children:["Password strength: ",s.jsx("b",{children:l})]})]})}function Hj(){const{login:e}=Te(),t=Re(),[n,r]=m.useState(null),i=async a=>{try{if(r(null),!(a!=null&&a.credential))throw new Error("Missing Google credential");const o=await le("/api/auth/google",{method:"POST",body:{credential:a.credential}}),l=o.accessToken||o.token;await e(null,{directToken:!0,token:l,refreshToken:o.refreshToken,user:o.user}),t(Es(o.user),{replace:!0})}catch(o){r(o.message||"Google authentication failed")}};return{GoogleButton:()=>s.jsx(DN,{onSuccess:i,onError:()=>r("Google authentication failed")}),error:n,clearError:()=>r(null)}}function eA(){var E;const{login:e}=Te(),{settings:t}=vi(),n=Re(),r=hn(),{GoogleButton:i,error:a,clearError:o}=Hj(),[l,c]=m.useState(""),[u,d]=m.useState(""),[p,h]=m.useState(!1),[f,y]=m.useState(""),[j,A]=m.useState(""),[g,x]=m.useState(!1);m.useEffect(()=>{new URLSearchParams(r.search).get("verify")&&A("Account created. Verify your email from Profile inside the app.")},[r.search]),m.useEffect(()=>{const _=localStorage.getItem("remember_email");_&&(c(_),h(!0))},[]);const w=async _=>{_.preventDefault(),y(""),A(""),x(!0),o==null||o();try{p?localStorage.setItem("remember_email",l):localStorage.removeItem("remember_email");const b=await e(l.trim(),u);if(b!=null&&b.requires2FA){n("/2fa",{state:{userId:b.userId,email:l}});return}if(!(b!=null&&b.user))throw new Error("Invalid credentials");if(!b.user.emailVerified&&!b.user.phoneVerified){A("Account not verified. Complete verification in Profile."),n("/profile",{replace:!0});return}n(Es(b.user),{replace:!0})}catch(b){y(b.message||"Invalid credentials")}finally{x(!1)}};return s.jsx("div",{className:"auth-bg",children:s.jsxs("form",{className:"auth-card",onSubmit:w,children:[((E=t==null?void 0:t.branding)==null?void 0:E.logo)&&s.jsx("div",{className:"brand-logo",style:{backgroundImage:`url(${t.branding.logo})`,margin:"0 auto 10px"}}),s.jsx("h1",{children:"Welcome back"}),s.jsx("p",{className:"subtitle",children:"Sign in to AfyaLink HRMS"}),f&&s.jsx("div",{className:"auth-error",children:f}),j&&s.jsx("div",{className:"auth-info",children:j}),a&&s.jsx("div",{className:"auth-error",children:a}),s.jsx("label",{children:"Email or phone"}),s.jsx("input",{type:"text",value:l,onChange:_=>c(_.target.value),required:!0}),s.jsx(Bc,{label:"Password",value:u,onChange:_=>d(_.target.value),required:!0}),s.jsxs("div",{className:"auth-row",children:[s.jsxs("label",{className:"remember",children:[s.jsx("input",{type:"checkbox",checked:p,onChange:_=>h(_.target.checked)}),"Remember me"]}),s.jsx(fi,{to:"/forgot-password",className:"forgot-link",children:"Forgot password?"})]}),s.jsx("button",{disabled:g,children:g?"Signing in...":"Sign in"}),s.jsx("div",{className:"divider",children:"or"}),s.jsx("div",{onClick:()=>o==null?void 0:o(),children:s.jsx(i,{})}),s.jsxs("div",{className:"auth-footer",children:[s.jsx("span",{children:"Dont have an account?"}),s.jsx(fi,{to:"/register",children:"Create account"})]})]})})}function tA(){const e=Re(),{login:t}=Te(),{GoogleButton:n,error:r}=Hj(),[i,a]=m.useState({name:"",email:"",phone:"",nationalIdNumber:"",nationalIdCountry:"",password:"",confirmPassword:""}),[o,l]=m.useState(!1),[c,u]=m.useState(""),[d,p]=m.useState(""),h=y=>{a({...i,[y.target.name]:y.target.value}),u(""),p("")},f=async y=>{if(y.preventDefault(),i.password!==i.confirmPassword){u("Passwords do not match");return}try{l(!0),u(""),p("");const j=await le("/api/auth/register",{method:"POST",body:{name:i.name.trim(),email:i.email?i.email.toLowerCase().trim():void 0,phone:i.phone?i.phone.trim():void 0,nationalIdNumber:i.nationalIdNumber||void 0,nationalIdCountry:i.nationalIdCountry||void 0,password:i.password}});j.accessToken&&j.user?(await t(null,{directToken:!0,token:j.accessToken,user:j.user}),p("Account created! Verify your email from Profile inside the app."),e(Es(j.user),{replace:!0})):(p(j.phoneOtpSent?"Registration successful. An OTP was sent to your phone. Verify to activate your account.":j.msg||"Registration successful. Verify your email from Profile inside the app."),e("/login"))}catch(j){const A=j.message||"Registration failed";u(A)}finally{l(!1)}};return s.jsx("div",{className:"auth-bg",children:s.jsxs("form",{className:"auth-card",onSubmit:f,children:[s.jsx("h1",{children:"Create your account"}),s.jsx("p",{className:"subtitle",children:"Join AfyaLink HRMS"}),c&&s.jsx("div",{className:"auth-error",children:c}),d&&s.jsx("div",{className:"auth-info",children:d}),r&&s.jsx("div",{className:"auth-error",children:r}),s.jsx("label",{children:"Full Name"}),s.jsx("input",{name:"name",value:i.name,onChange:h,required:!0}),s.jsx("label",{children:"Email address (optional)"}),s.jsx("input",{type:"email",name:"email",value:i.email,onChange:h}),s.jsx("label",{children:"Phone number (optional)"}),s.jsx("input",{name:"phone",value:i.phone,onChange:h}),s.jsx("label",{children:"National ID Number"}),s.jsx("input",{name:"nationalIdNumber",value:i.nationalIdNumber,onChange:h}),s.jsx("label",{children:"National ID Country"}),s.jsx("input",{name:"nationalIdCountry",value:i.nationalIdCountry,onChange:h,placeholder:"e.g. KE, US, NG"}),s.jsx(Bc,{label:"Password",value:i.password,onChange:y=>a({...i,password:y.target.value}),showStrength:!0,required:!0}),s.jsx(Bc,{label:"Confirm password",value:i.confirmPassword,onChange:y=>a({...i,confirmPassword:y.target.value}),required:!0}),s.jsx("div",{className:"muted",style:{marginBottom:10},children:"Unverified accounts may be deleted after the verification deadline."}),s.jsx("button",{disabled:o,children:o?"Creating account...":"Create account"}),s.jsx("div",{className:"divider",children:"or"}),s.jsx(n,{}),s.jsxs("div",{className:"auth-footer",children:[s.jsx("span",{children:"Already have an account?"}),s.jsx(fi,{to:"/login",children:"Login"})]})]})})}function nA(){const[e]=mj(),[t,n]=m.useState("verifying"),[r,i]=m.useState(0),[a,o]=m.useState(!1),[l,c]=m.useState(""),u=e.get("token");m.useEffect(()=>{if(!u){n("invalid");return}le(`/api/auth/verify-email?token=${u}`).then(()=>n("success")).catch(()=>n("error"))},[u]),m.useEffect(()=>{if(r<=0)return;const p=setInterval(()=>i(h=>h-1),1e3);return()=>clearInterval(p)},[r]);const d=async()=>{try{o(!0);const p=await le("/api/auth/resend-verification",{method:"POST",body:{email:l}});i(p.retryAfter||60)}catch{alert("Failed to resend verification email")}finally{o(!1)}};return s.jsxs("div",{className:"verify-page",children:[t==="verifying"&&s.jsxs("div",{className:"card pulse",children:[s.jsx("h1",{children:"Verifying"}),s.jsx("p",{children:"Please wait"})]}),t==="success"&&s.jsxs("div",{className:"card success pop",children:[s.jsx("h1",{children:" Email Verified"}),s.jsx("p",{children:"Your account is now active."}),s.jsx(fi,{to:"/login",className:"btn",children:"Go to Login"})]}),t==="invalid"&&s.jsxs("div",{className:"card error shake",children:[s.jsx("h1",{children:" Invalid Link"}),s.jsx("p",{children:"This verification link is invalid."})]}),t==="error"&&s.jsxs("div",{className:"card error shake",children:[s.jsx("h1",{children:" Verification Failed"}),s.jsx("p",{children:"Link expired or already used."}),s.jsx("input",{type:"email",placeholder:"Enter your email",value:l,onChange:p=>c(p.target.value),style:{marginTop:12}}),s.jsx("button",{onClick:d,disabled:a||r>0||!l,className:"btn secondary",children:r>0?`Resend in ${r}s`:a?"Sending":"Resend verification email"})]})]})}function rA(){return s.jsx("div",{className:"auth-bg",children:s.jsxs("div",{className:"auth-card",children:[s.jsx("h1",{children:" Email Verified"}),s.jsx("p",{className:"subtitle",children:"Your email has been successfully verified. You can now log in to your account."}),s.jsx(fi,{to:"/login",children:s.jsx("button",{children:"Go to login"})})]})})}function Ng(){return s.jsxs("div",{style:{padding:40},children:[s.jsx("h1",{children:"403  Unauthorized"}),s.jsx("p",{children:"You do not have permission to access this page."})]})}function sA(){const[e,t]=m.useState(""),[n,r]=m.useState(""),[i,a]=m.useState(""),[o,l]=m.useState(!1),c=async u=>{u.preventDefault(),l(!0),r(""),a("");try{await le("/api/auth/forgot-password",{method:"POST",body:{email:e}}),r("If the email exists, a reset link has been sent.")}catch(d){a(d.message||"Something went wrong")}finally{l(!1)}};return s.jsx("div",{className:"auth-bg",children:s.jsxs("form",{className:"auth-card",onSubmit:c,children:[s.jsx("h1",{children:"Forgot password"}),s.jsx("p",{className:"subtitle",children:"Enter your email and well send you a reset link"}),i&&s.jsx("div",{className:"auth-error",children:i}),n&&s.jsx("div",{className:"auth-info",children:n}),s.jsx("label",{children:"Email address"}),s.jsx("input",{type:"email",required:!0,value:e,onChange:u=>t(u.target.value),placeholder:"you@example.com"}),s.jsx("button",{disabled:o,children:o?"Sending...":"Send reset link"})]})})}function iA(){const[e]=mj(),t=Re(),n=e.get("token"),[r,i]=m.useState(""),[a,o]=m.useState(""),[l,c]=m.useState(""),[u,d]=m.useState(!1);m.useEffect(()=>{n||o("Invalid or expired reset link")},[n]);const p=async h=>{if(h.preventDefault(),o(""),c(""),d(!0),!n){o("Invalid or expired reset link"),d(!1);return}try{await le("/api/auth/reset-password",{method:"POST",body:{token:n,password:r}}),c("Password reset successful. Redirecting to login..."),setTimeout(()=>t("/login"),2e3)}catch(f){o(f.message||"Reset link expired or invalid")}finally{d(!1)}};return s.jsx("div",{className:"auth-bg",children:s.jsxs("form",{className:"auth-card",onSubmit:p,children:[s.jsx("h1",{children:"Reset password"}),a&&s.jsx("div",{className:"auth-error",children:a}),l&&s.jsx("div",{className:"auth-info",children:l}),s.jsx(Bc,{label:"New password",value:r,onChange:h=>i(h.target.value),showStrength:!0,required:!0}),s.jsx("button",{disabled:u||!!a,children:u?"Resetting...":"Reset password"})]})})}function aA(){var p;const e=Re(),t=hn(),{complete2FA:n}=Te(),r=((p=t.state)==null?void 0:p.userId)||localStorage.getItem("2fa_user"),[i,a]=m.useState(""),[o,l]=m.useState(""),[c,u]=m.useState(!1);if(m.useEffect(()=>{r||e("/login",{replace:!0})},[r,e]),!r)return null;const d=async h=>{if(h.preventDefault(),i.length===6){l(""),u(!0);try{const f=await le("/api/auth/2fa/verify",{method:"POST",body:{userId:r,otp:i}});n(f.accessToken,f.refreshToken),e("/",{replace:!0})}catch(f){l(f.message||"Verification failed")}finally{u(!1)}}};return s.jsxs("div",{className:"auth-card",children:[s.jsx("h2",{children:" Two-Factor Authentication"}),s.jsx("p",{children:"Enter the 6-digit code sent to your email"}),o&&s.jsx("p",{className:"error",children:o}),s.jsxs("form",{onSubmit:d,children:[s.jsx("input",{type:"text",inputMode:"numeric",maxLength:"6",placeholder:"123456",value:i,onChange:h=>a(h.target.value.replace(/\D/g,"")),required:!0}),s.jsx("button",{disabled:c||i.length!==6,children:c?"Verifying...":"Verify"})]}),s.jsx("style",{children:`
        .auth-card {
          max-width: 420px;
          margin: 80px auto;
          padding: 32px;
          border-radius: 16px;
          background: white;
          text-align: center;
          box-shadow: 0 10px 25px rgba(0,0,0,0.08);
        }
        input {
          width: 100%;
          padding: 14px;
          margin: 20px 0;
          font-size: 20px;
          text-align: center;
          letter-spacing: 8px;
          border-radius: 10px;
          border: 1px solid #ddd;
        }
        button {
          width: 100%;
          padding: 14px;
          background: #2563eb;
          color: white;
          border: none;
          border-radius: 10px;
          font-weight: 600;
          cursor: pointer;
        }
        button:disabled {
          opacity: 0.6;
          cursor: not-allowed;
        }
        .error {
          color: #dc2626;
          margin-top: 12px;
        }
      `})]})}function oA(){const e=Re(),[t,n]=m.useState(null),[r,i]=m.useState(""),[a,o]=m.useState(!1),[l,c]=m.useState(!1),[u,d]=m.useState(""),[p,h]=m.useState(""),f=async()=>{try{const x=await le("/api/auth/session-risk");n(x||null)}catch(x){n(null),h((x==null?void 0:x.message)||"Failed to load session risk")}};m.useEffect(()=>{f()},[]);const y=async()=>{c(!0),h(""),d("");try{await le("/api/auth/step-up/request",{method:"POST"}),d("Step-up code sent. Check your email or phone.")}catch(x){h((x==null?void 0:x.message)||"Failed to request step-up code")}finally{c(!1)}},j=async x=>{x.preventDefault(),o(!0),h(""),d("");try{const w=await le("/api/auth/step-up/verify",{method:"POST",body:{otp:r.trim()}});w!=null&&w.accessToken&&localStorage.setItem("token",w.accessToken),d("Session unlocked successfully."),setTimeout(()=>e(-1),600)}catch(w){w instanceof vj?h(w.message):h("Failed to verify step-up code")}finally{o(!1)}},A=(t==null?void 0:t.risk)||{},g=(t==null?void 0:t.restriction)||null;return s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"Session Security Check"}),s.jsx("p",{className:"muted",children:"Complete a step-up verification to continue sensitive actions."})]}),s.jsxs("div",{className:"welcome-actions",children:[s.jsx("button",{className:"btn-secondary",onClick:f,children:"Refresh Risk"}),s.jsx("button",{className:"btn-primary",onClick:y,disabled:l,children:l?"Sending...":"Send Step-up Code"})]})]}),s.jsx("section",{className:"section",children:s.jsxs("div",{className:"grid info-grid",children:[s.jsxs("div",{className:"card",children:[s.jsx("strong",{children:"Risk Level:"})," ",A.level||""]}),s.jsxs("div",{className:"card",children:[s.jsx("strong",{children:"Risk Score:"})," ",A.score??""]}),s.jsxs("div",{className:"card",children:[s.jsx("strong",{children:"Step-up Required:"})," ",t!=null&&t.requiresStepUp?"Yes":"No"]}),s.jsxs("div",{className:"card",children:[s.jsx("strong",{children:"Step-up Verified At:"})," ",(t==null?void 0:t.stepUpVerifiedAt)||"Not yet"]})]})}),g&&s.jsx("section",{className:"section",children:s.jsxs("div",{className:"card",children:[s.jsx("strong",{children:"Restriction Active"}),s.jsxs("div",{className:"muted",children:["Reason: ",g.reason||"RISK_RESTRICTION_ACTIVE"]}),s.jsxs("div",{className:"muted",children:["Until: ",g.until||"Auto-expiry pending"]})]})}),s.jsx("section",{className:"section",children:s.jsxs("form",{className:"card",onSubmit:j,children:[s.jsx("h3",{children:"Verify Step-up Code"}),s.jsx("input",{type:"text",value:r,onChange:x=>i(x.target.value),placeholder:"Enter 6-digit code",maxLength:8,required:!0}),s.jsx("div",{className:"welcome-actions",style:{marginTop:12},children:s.jsx("button",{className:"btn-primary",type:"submit",disabled:a,children:a?"Verifying...":"Verify & Unlock"})}),u&&s.jsx("p",{className:"auth-info",children:u}),p&&s.jsx("p",{className:"auth-error",children:p})]})})]})}function lA(){const e=Re();return s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"AfyaLink Guest Portal"}),s.jsx("p",{className:"muted",children:"Public access for appointments, doctor directory, services and pre-registration."})]}),s.jsxs("div",{className:"welcome-actions",children:[s.jsx("button",{className:"btn-primary",onClick:()=>e("/register"),children:"Book Appointment"}),s.jsx("button",{className:"btn-secondary",onClick:()=>e("/login"),children:"Sign In"})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Guest Services"}),s.jsxs("div",{className:"panel-grid",children:[s.jsx("div",{className:"panel",children:"Search Doctor"}),s.jsx("div",{className:"panel",children:"Appointment Booking Form"}),s.jsx("div",{className:"panel",children:"Hospital Services"}),s.jsx("div",{className:"panel",children:"Contact & Support"}),s.jsx("div",{className:"panel",children:"Pre-Registration"})]})]})]})}const Rl="verifyCooldownUntil";function cA(){const{user:e,canRoleOverride:t,roleOverride:n,strictImpersonation:r,setRoleOverride:i,setStrictImpersonation:a}=Te(),o=Re(),[l,c]=m.useState(""),u=["SUPER_ADMIN","SYSTEM_ADMIN","HOSPITAL_ADMIN","DEVELOPER","DOCTOR","NURSE","LAB_TECH","PHARMACIST","RADIOLOGIST","THERAPIST","RECEPTIONIST","SECURITY_OFFICER","SECURITY_ADMIN","HR_MANAGER","PAYROLL_OFFICER","PATIENT","GUEST"],[d,p]=m.useState(!0),[h,f]=m.useState(""),[y,j]=m.useState(!1),[A,g]=m.useState(!0),[x,w]=m.useState(null),[E,_]=m.useState(!1),[b,R]=m.useState(""),[C,T]=m.useState(0),[D,U]=m.useState(""),[W,q]=m.useState(!1),[P,V]=m.useState(""),[K,ce]=m.useState(""),[M,X]=m.useState(!1),[ae,pe]=m.useState(""),[fe,De]=m.useState(""),[F,Z]=m.useState(!1),[Y,ye]=m.useState(""),[ge,Ke]=m.useState(""),[Ae,Fe]=m.useState(""),[ne,me]=m.useState(!1),[se,be]=m.useState(""),[Me,mt]=m.useState(!1),[Pt,we]=m.useState(""),[Ie,st]=m.useState({gender:"",dateOfBirth:"",nationality:"",address:"",emergencyName:"",emergencyRelationship:"",emergencyPhone:""}),[ve,Ue]=m.useState({employeeId:"",department:"",reportingManager:"",employmentType:"",hireDate:"",contractStart:"",contractEnd:"",workLocation:"",branch:""}),[Se,it]=m.useState({specialization:"",subSpecialization:"",cmeCredits:"",researchPublications:"",testAuthorizationLevel:"",certifications:"",educationHistory:""}),[xe,St]=m.useState({bankName:"",bankAccountName:"",bankAccountNumber:"",bankBranch:"",taxId:"",pensionInfo:"",salaryStructure:"",allowances:"",deductions:""}),[Jt,fn]=m.useState({status:"ACTIVE",accessExpiresAt:""}),[Ht,Un]=m.useState(""),[Qt,En]=m.useState(""),[je,Ee]=m.useState(""),[dt,gt]=m.useState(!1),[kt,Et]=m.useState(""),[Oe,Nt]=m.useState("");m.useEffect(()=>{tr(),pn()},[]),m.useEffect(()=>{c(n||(e==null?void 0:e.actualRole)||(e==null?void 0:e.role)||"")},[n,e==null?void 0:e.actualRole,e==null?void 0:e.role]);const tr=()=>{const z=Number(localStorage.getItem(Rl));if(!z)return;const Rt=Math.ceil((z-Date.now())/1e3);Rt>0?T(Rt):localStorage.removeItem(Rl)};m.useEffect(()=>{if(C<=0)return;const z=setInterval(()=>{T(Rt=>Rt<=1?(localStorage.removeItem(Rl),0):Rt-1)},1e3);return()=>clearInterval(z)},[C]);const pn=async()=>{var z,Rt,bi,wi,Si,Ei,Ni,_i,Ai,Ci,ki,Ls,Ds,Ms,Us,Bs,qr,Vn,zr,Nn,Vs,nr,wr,$s,Fs,Sr,I,B,v,k;try{const N=await le("/api/2fa/status");j(!!(N!=null&&N.enabled));const S=await le("/api/profile");g(!!(S!=null&&S.emailVerified)),q(!!(S!=null&&S.phoneVerified)),U((S==null?void 0:S.phone)||""),pe((S==null?void 0:S.nationalIdNumber)||""),De((S==null?void 0:S.nationalIdCountry)||""),Ke((S==null?void 0:S.licenseNumber)||""),Fe(S!=null&&S.licenseExpiry?S.licenseExpiry.slice(0,10):""),w((S==null?void 0:S.verificationWarning)||null),st({gender:(S==null?void 0:S.gender)||"",dateOfBirth:S!=null&&S.dateOfBirth?S.dateOfBirth.slice(0,10):"",nationality:(S==null?void 0:S.nationality)||"",address:(S==null?void 0:S.address)||"",emergencyName:((z=S==null?void 0:S.emergencyContact)==null?void 0:z.name)||"",emergencyRelationship:((Rt=S==null?void 0:S.emergencyContact)==null?void 0:Rt.relationship)||"",emergencyPhone:((bi=S==null?void 0:S.emergencyContact)==null?void 0:bi.phone)||""}),Ue({employeeId:((wi=S==null?void 0:S.employment)==null?void 0:wi.employeeId)||"",department:((Si=S==null?void 0:S.employment)==null?void 0:Si.department)||"",reportingManager:((Ei=S==null?void 0:S.employment)==null?void 0:Ei.reportingManager)||"",employmentType:((Ni=S==null?void 0:S.employment)==null?void 0:Ni.employmentType)||"",hireDate:(_i=S==null?void 0:S.employment)!=null&&_i.hireDate?S.employment.hireDate.slice(0,10):"",contractStart:(Ai=S==null?void 0:S.employment)!=null&&Ai.contractStart?S.employment.contractStart.slice(0,10):"",contractEnd:(Ci=S==null?void 0:S.employment)!=null&&Ci.contractEnd?S.employment.contractEnd.slice(0,10):"",workLocation:((ki=S==null?void 0:S.employment)==null?void 0:ki.workLocation)||"",branch:((Ls=S==null?void 0:S.employment)==null?void 0:Ls.branch)||""}),it({specialization:((Ds=S==null?void 0:S.credentials)==null?void 0:Ds.specialization)||"",subSpecialization:((Ms=S==null?void 0:S.credentials)==null?void 0:Ms.subSpecialization)||"",cmeCredits:((Us=S==null?void 0:S.credentials)==null?void 0:Us.cmeCredits)??"",researchPublications:((Bs=S==null?void 0:S.credentials)==null?void 0:Bs.researchPublications)??"",testAuthorizationLevel:((qr=S==null?void 0:S.credentials)==null?void 0:qr.testAuthorizationLevel)||"",certifications:(((Vn=S==null?void 0:S.credentials)==null?void 0:Vn.certifications)||[]).join(", "),educationHistory:(((zr=S==null?void 0:S.credentials)==null?void 0:zr.educationHistory)||[]).join(", ")}),St({bankName:((Nn=S==null?void 0:S.financial)==null?void 0:Nn.bankName)||"",bankAccountName:((Vs=S==null?void 0:S.financial)==null?void 0:Vs.bankAccountName)||"",bankAccountNumber:((nr=S==null?void 0:S.financial)==null?void 0:nr.bankAccountNumber)||"",bankBranch:((wr=S==null?void 0:S.financial)==null?void 0:wr.bankBranch)||"",taxId:(($s=S==null?void 0:S.financial)==null?void 0:$s.taxId)||"",pensionInfo:((Fs=S==null?void 0:S.financial)==null?void 0:Fs.pensionInfo)||"",salaryStructure:((Sr=S==null?void 0:S.financial)==null?void 0:Sr.salaryStructure)||"",allowances:((I=S==null?void 0:S.financial)==null?void 0:I.allowances)??"",deductions:((B=S==null?void 0:S.financial)==null?void 0:B.deductions)??""}),fn({status:((v=S==null?void 0:S.systemProfile)==null?void 0:v.status)||"ACTIVE",accessExpiresAt:(k=S==null?void 0:S.systemProfile)!=null&&k.accessExpiresAt?S.systemProfile.accessExpiresAt.slice(0,10):""})}catch{f("Unable to load security settings")}finally{p(!1)}},Is=async()=>{mt(!0),we("");try{await le("/api/profile",{method:"PUT",body:{gender:Ie.gender||void 0,dateOfBirth:Ie.dateOfBirth||void 0,nationality:Ie.nationality||void 0,address:Ie.address||void 0,emergencyContact:{name:Ie.emergencyName||void 0,relationship:Ie.emergencyRelationship||void 0,phone:Ie.emergencyPhone||void 0},employment:{employeeId:ve.employeeId||void 0,department:ve.department||void 0,reportingManager:ve.reportingManager||void 0,employmentType:ve.employmentType||void 0,hireDate:ve.hireDate||void 0,contractStart:ve.contractStart||void 0,contractEnd:ve.contractEnd||void 0,workLocation:ve.workLocation||void 0,branch:ve.branch||void 0},credentials:{specialization:Se.specialization||void 0,subSpecialization:Se.subSpecialization||void 0,cmeCredits:Se.cmeCredits===""?void 0:Number(Se.cmeCredits),researchPublications:Se.researchPublications===""?void 0:Number(Se.researchPublications),testAuthorizationLevel:Se.testAuthorizationLevel||void 0,certifications:Se.certifications?Se.certifications.split(",").map(z=>z.trim()).filter(Boolean):[],educationHistory:Se.educationHistory?Se.educationHistory.split(",").map(z=>z.trim()).filter(Boolean):[]},financial:{bankName:xe.bankName||void 0,bankAccountName:xe.bankAccountName||void 0,bankAccountNumber:xe.bankAccountNumber||void 0,bankBranch:xe.bankBranch||void 0,taxId:xe.taxId||void 0,pensionInfo:xe.pensionInfo||void 0,salaryStructure:xe.salaryStructure||void 0,allowances:xe.allowances===""?void 0:Number(xe.allowances),deductions:xe.deductions===""?void 0:Number(xe.deductions)},systemProfile:{status:Jt.status||void 0,accessExpiresAt:Jt.accessExpiresAt||void 0}}}),we("Profile details updated.")}catch(z){we(z.message||"Failed to update profile details")}finally{mt(!1)}},yt=async()=>{try{const z=!y;await le("/api/2fa/toggle",{method:"POST",body:{enabled:z}}),j(z)}catch{f("Failed to update 2FA setting")}},Bn=async()=>{try{_(!0),R("");const z=await le("/api/auth/resend-verification",{method:"POST",body:{email:e==null?void 0:e.email}}),Rt=(z==null?void 0:z.retryAfter)||60;localStorage.setItem(Rl,Date.now()+Rt*1e3),T(Rt),R(" Verification email sent. Check your inbox.")}catch{R(" Failed to send verification email")}finally{_(!1)}},It=()=>{if(A||W||!x)return null;const z={"14d":"Your profile will be deleted in 14 days.","3d":"Your profile will be deleted in 3 days.","2h":"Your profile will be deleted in 2 hours.",EXPIRED:"Your account has expired and will be deleted."};return s.jsxs("div",{className:"card warning-card",children:[s.jsx("h3",{children:" Verification Required"}),s.jsx("p",{children:z[x.type]}),x.type!=="EXPIRED"&&(e==null?void 0:e.email)&&s.jsx("button",{className:"primary",disabled:E||C>0,onClick:Bn,children:E?"Sending...":C>0?`Resend in ${C}s`:"Verify Account"}),b&&s.jsx("p",{style:{marginTop:8},children:b})]})},Rs=async()=>{Z(!0),ye("");try{await le("/api/profile",{method:"PUT",body:{nationalIdNumber:ae||void 0,nationalIdCountry:fe||void 0}}),ye("National ID updated")}catch(z){ye(z.message||"Failed to update National ID")}finally{Z(!1)}},Ts=async()=>{me(!0),be("");try{await le("/api/profile",{method:"PUT",body:{licenseNumber:ge||void 0,licenseExpiry:Ae||void 0}}),be("License updated")}catch(z){be(z.message||"Failed to update license")}finally{me(!1)}},Ma=async()=>{X(!0),ce("");try{await le("/api/auth/phone/request-otp",{method:"POST",body:{phone:D.trim()}}),q(!1),ce("OTP sent to your phone.")}catch(z){ce(z.message||"Failed to send OTP")}finally{X(!1)}},Os=async()=>{X(!0),ce("");try{await le("/api/auth/phone/verify",{method:"POST",body:{otp:P.trim()}}),q(!0),V(""),ce("Phone verified successfully.")}catch(z){ce(z.message||"Invalid OTP")}finally{X(!1)}},Ua=async z=>{if(z.preventDefault(),Et(""),Nt(""),Qt!==je){Nt("Passwords do not match");return}gt(!0);try{const Rt=await le("/api/auth/change-password",{method:"POST",body:{currentPassword:Ht,newPassword:Qt}});Et("Password changed successfully"),Un(""),En(""),Ee("")}catch(Rt){Nt(Rt.message||"Password change failed")}finally{gt(!1)}},Ps={SUPER_ADMIN:["System configuration and permission matrix ownership","API key management and integration governance","Global audit and backup oversight"],SYSTEM_ADMIN:["Server operations and error diagnostics","Database and feature-toggle control","Integration reliability monitoring"],HOSPITAL_ADMIN:["Department and staffing operations","Shift, leave and approval oversight","Budget and branch execution control"],SECURITY_ADMIN:["Incident escalation and clearance governance","Visitor and surveillance compliance management","Emergency response coordination"],SECURITY_OFFICER:["Shift assignment and gate operations","Visitor verification and QR scanning","Incident reporting execution"],HR_MANAGER:["Recruitment and onboarding workflows","Performance and disciplinary tracking","Training and succession planning"],PAYROLL_OFFICER:["Payroll processing and payslip generation","Tax, pension, deductions and audit trail","Overtime and shift differential reconciliation"],DEVELOPER:["API logs, webhook diagnostics and feature flags","Performance tracing and release validation","Integration and automation reliability"],DOCTOR:["Medical license and specialization details","Clinical schedule and patient workload context","CME credits and publications tracking"],NURSE:["Ward/department assignment and shift readiness","Clinical workload and overtime visibility","Incident and quality reporting continuity"],LAB_TECH:["Test authorization level and assignment scope","Lab workflow accountability and compliance","Safety and equipment audit readiness"],PHARMACIST:["License and controlled-drug accountability","Inventory and dispensing governance","Expiry and interaction safety controls"],PATIENT:["Verified identity and emergency contact","Clinical and billing communication readiness","Secure self-service profile completeness"],GUEST:["Pre-registration and contact readiness","Limited-access appointment flow data","Upgrade eligibility details"],RADIOLOGIST:["Imaging authorization and reporting scope","Diagnostic workflow credential completeness","PACS and compliance readiness"],THERAPIST:["Treatment plan and session documentation profile","Progress tracking role context","Department and scheduling completeness"],RECEPTIONIST:["Patient intake and scheduling role context","Queue and billing initiation responsibility","Front-desk operational readiness"]};return d?s.jsx("p",{children:"Loading..."}):s.jsxs("div",{className:"profile-container",children:[t&&s.jsxs("div",{className:"card",children:[s.jsx("h3",{children:"Role View Switcher"}),s.jsxs("p",{children:["Use this to switch and test account types. Your actual account stays ",s.jsx("strong",{children:(e==null?void 0:e.actualRole)||(e==null?void 0:e.role)}),"."]}),s.jsxs("label",{className:"profile-inline-check",style:{marginBottom:12},children:[s.jsx("input",{type:"checkbox",checked:!!r,onChange:z=>a(z.target.checked)}),s.jsx("span",{children:"Lock to exact role permissions (strict impersonation)"})]}),s.jsx("p",{className:"muted",style:{marginTop:0},children:r?"Strict mode: access is limited to the switched role.":"Full access mode: founder/developer elevated permissions remain active while viewing another role."}),s.jsxs("div",{className:"profile-row",children:[s.jsx("select",{value:l,onChange:z=>c(z.target.value),children:u.map(z=>s.jsx("option",{value:z,children:z},z))}),s.jsx("button",{className:"primary",onClick:()=>{i(l),o(Es({role:l}))},children:"Switch Role View"}),s.jsx("button",{className:"secondary",onClick:()=>{const z=(e==null?void 0:e.actualRole)||(e==null?void 0:e.role);i(""),c(z),o(Es({role:z}))},children:"Reset to My Role"})]})]}),It(),s.jsxs("div",{className:"card",children:[s.jsx("h3",{children:"Verification Status"}),s.jsxs("div",{className:"grid",children:[s.jsxs("div",{children:[s.jsx("strong",{children:"Email:"})," ",A?"Verified":"Not verified"]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Phone:"})," ",W?"Verified":"Not verified"]})]})]}),s.jsxs("div",{className:"card",children:[s.jsx("h3",{children:"Phone & National ID"}),s.jsx("p",{children:W?"Your phone number is verified.":"Verify your phone number to keep your account active."}),s.jsx("label",{children:"Phone number"}),s.jsx("input",{value:D,onChange:z=>U(z.target.value),placeholder:"+1 555 123 4567"}),s.jsxs("div",{className:"profile-row",children:[s.jsx("button",{className:"primary",onClick:Ma,disabled:M||!D.trim(),children:M?"Sending...":"Send OTP"}),s.jsx("input",{value:P,onChange:z=>V(z.target.value),placeholder:"Enter OTP",style:{maxWidth:180}}),s.jsx("button",{className:"success",onClick:Os,disabled:M||!P.trim(),children:M?"Verifying...":"Verify"})]}),K&&s.jsx("p",{style:{marginTop:8},children:K}),s.jsx("hr",{style:{margin:"18px 0"}}),s.jsx("label",{children:"National ID Number"}),s.jsx("input",{value:ae,onChange:z=>pe(z.target.value)}),s.jsx("label",{children:"National ID Country"}),s.jsx("input",{value:fe,onChange:z=>De(z.target.value),placeholder:"e.g. KE, US, NG"}),s.jsx("button",{className:"primary",onClick:Rs,disabled:F,style:{marginTop:8},children:F?"Saving...":"Save National ID"}),Y&&s.jsx("p",{style:{marginTop:8},children:Y}),s.jsx("hr",{style:{margin:"18px 0"}}),s.jsx("label",{children:"Professional License Number"}),s.jsx("input",{value:ge,onChange:z=>Ke(z.target.value),placeholder:"e.g. KMPDC-123456"}),s.jsx("label",{children:"License Expiry Date"}),s.jsx("input",{type:"date",value:Ae,onChange:z=>Fe(z.target.value)}),s.jsx("button",{className:"primary",onClick:Ts,disabled:ne,style:{marginTop:8},children:ne?"Saving...":"Save License"}),se&&s.jsx("p",{style:{marginTop:8},children:se})]}),s.jsxs("div",{className:"card",children:[s.jsx("h3",{children:"Basic Information"}),s.jsx("label",{children:"Gender"}),s.jsxs("select",{value:Ie.gender,onChange:z=>st({...Ie,gender:z.target.value}),children:[s.jsx("option",{value:"",children:"Select"}),s.jsx("option",{value:"MALE",children:"Male"}),s.jsx("option",{value:"FEMALE",children:"Female"}),s.jsx("option",{value:"OTHER",children:"Other"}),s.jsx("option",{value:"PREFER_NOT_TO_SAY",children:"Prefer not to say"})]}),s.jsx("label",{children:"Date of Birth"}),s.jsx("input",{type:"date",value:Ie.dateOfBirth,onChange:z=>st({...Ie,dateOfBirth:z.target.value})}),s.jsx("label",{children:"Nationality"}),s.jsx("input",{value:Ie.nationality,onChange:z=>st({...Ie,nationality:z.target.value})}),s.jsx("label",{children:"Address"}),s.jsx("input",{value:Ie.address,onChange:z=>st({...Ie,address:z.target.value})}),s.jsx("label",{children:"Emergency Contact Name"}),s.jsx("input",{value:Ie.emergencyName,onChange:z=>st({...Ie,emergencyName:z.target.value})}),s.jsx("label",{children:"Emergency Contact Relationship"}),s.jsx("input",{value:Ie.emergencyRelationship,onChange:z=>st({...Ie,emergencyRelationship:z.target.value})}),s.jsx("label",{children:"Emergency Contact Phone"}),s.jsx("input",{value:Ie.emergencyPhone,onChange:z=>st({...Ie,emergencyPhone:z.target.value})})]}),s.jsxs("div",{className:"card",children:[s.jsx("h3",{children:"Employment Information"}),s.jsx("label",{children:"Employee ID"}),s.jsx("input",{value:ve.employeeId,onChange:z=>Ue({...ve,employeeId:z.target.value})}),s.jsx("label",{children:"Department"}),s.jsx("input",{value:ve.department,onChange:z=>Ue({...ve,department:z.target.value})}),s.jsx("label",{children:"Reporting Manager"}),s.jsx("input",{value:ve.reportingManager,onChange:z=>Ue({...ve,reportingManager:z.target.value})}),s.jsx("label",{children:"Employment Type"}),s.jsxs("select",{value:ve.employmentType,onChange:z=>Ue({...ve,employmentType:z.target.value}),children:[s.jsx("option",{value:"",children:"Select"}),s.jsx("option",{value:"FULL_TIME",children:"Full-time"}),s.jsx("option",{value:"LOCUM",children:"Locum"}),s.jsx("option",{value:"CONTRACT",children:"Contract"}),s.jsx("option",{value:"PART_TIME",children:"Part-time"}),s.jsx("option",{value:"INTERN",children:"Intern"})]}),s.jsx("label",{children:"Hire Date"}),s.jsx("input",{type:"date",value:ve.hireDate,onChange:z=>Ue({...ve,hireDate:z.target.value})}),s.jsx("label",{children:"Contract Start"}),s.jsx("input",{type:"date",value:ve.contractStart,onChange:z=>Ue({...ve,contractStart:z.target.value})}),s.jsx("label",{children:"Contract End"}),s.jsx("input",{type:"date",value:ve.contractEnd,onChange:z=>Ue({...ve,contractEnd:z.target.value})}),s.jsx("label",{children:"Work Location"}),s.jsx("input",{value:ve.workLocation,onChange:z=>Ue({...ve,workLocation:z.target.value})}),s.jsx("label",{children:"Branch"}),s.jsx("input",{value:ve.branch,onChange:z=>Ue({...ve,branch:z.target.value})})]}),s.jsxs("div",{className:"card",children:[s.jsx("h3",{children:"Credentials & Professional Data"}),s.jsx("label",{children:"Specialization"}),s.jsx("input",{value:Se.specialization,onChange:z=>it({...Se,specialization:z.target.value})}),s.jsx("label",{children:"Sub-specialization"}),s.jsx("input",{value:Se.subSpecialization,onChange:z=>it({...Se,subSpecialization:z.target.value})}),s.jsx("label",{children:"Certifications (comma-separated)"}),s.jsx("input",{value:Se.certifications,onChange:z=>it({...Se,certifications:z.target.value})}),s.jsx("label",{children:"Education History (comma-separated)"}),s.jsx("input",{value:Se.educationHistory,onChange:z=>it({...Se,educationHistory:z.target.value})}),s.jsx("label",{children:"CME Credits"}),s.jsx("input",{type:"number",value:Se.cmeCredits,onChange:z=>it({...Se,cmeCredits:z.target.value})}),s.jsx("label",{children:"Research Publications"}),s.jsx("input",{type:"number",value:Se.researchPublications,onChange:z=>it({...Se,researchPublications:z.target.value})}),s.jsx("label",{children:"Test Authorization Level"}),s.jsx("input",{value:Se.testAuthorizationLevel,onChange:z=>it({...Se,testAuthorizationLevel:z.target.value})})]}),s.jsxs("div",{className:"card",children:[s.jsx("h3",{children:"Financial Information"}),s.jsx("label",{children:"Bank Name"}),s.jsx("input",{value:xe.bankName,onChange:z=>St({...xe,bankName:z.target.value})}),s.jsx("label",{children:"Bank Account Name"}),s.jsx("input",{value:xe.bankAccountName,onChange:z=>St({...xe,bankAccountName:z.target.value})}),s.jsx("label",{children:"Bank Account Number"}),s.jsx("input",{value:xe.bankAccountNumber,onChange:z=>St({...xe,bankAccountNumber:z.target.value})}),s.jsx("label",{children:"Bank Branch"}),s.jsx("input",{value:xe.bankBranch,onChange:z=>St({...xe,bankBranch:z.target.value})}),s.jsx("label",{children:"Tax ID"}),s.jsx("input",{value:xe.taxId,onChange:z=>St({...xe,taxId:z.target.value})}),s.jsx("label",{children:"Pension Info"}),s.jsx("input",{value:xe.pensionInfo,onChange:z=>St({...xe,pensionInfo:z.target.value})}),s.jsx("label",{children:"Salary Structure"}),s.jsx("input",{value:xe.salaryStructure,onChange:z=>St({...xe,salaryStructure:z.target.value})}),s.jsx("label",{children:"Allowances"}),s.jsx("input",{type:"number",value:xe.allowances,onChange:z=>St({...xe,allowances:z.target.value})}),s.jsx("label",{children:"Deductions"}),s.jsx("input",{type:"number",value:xe.deductions,onChange:z=>St({...xe,deductions:z.target.value})})]}),s.jsxs("div",{className:"card",children:[s.jsx("h3",{children:"System Data"}),s.jsx("label",{children:"Status"}),s.jsxs("select",{value:Jt.status,onChange:z=>fn({...Jt,status:z.target.value}),children:[s.jsx("option",{value:"ACTIVE",children:"Active"}),s.jsx("option",{value:"SUSPENDED",children:"Suspended"}),s.jsx("option",{value:"ON_LEAVE",children:"On Leave"})]}),s.jsx("label",{children:"Access Expiration"}),s.jsx("input",{type:"date",value:Jt.accessExpiresAt,onChange:z=>fn({...Jt,accessExpiresAt:z.target.value})}),s.jsx("button",{className:"primary",onClick:Is,disabled:Me,style:{marginTop:8},children:Me?"Saving...":"Save Full Profile"}),Pt&&s.jsx("p",{style:{marginTop:8},children:Pt})]}),s.jsxs("div",{className:"card",children:[s.jsxs("h3",{children:["Role-Specific Profile Checklist (",e==null?void 0:e.role,")"]}),s.jsx("ul",{children:(Ps[e==null?void 0:e.role]||Ps.GUEST).map(z=>s.jsx("li",{children:z},z))})]}),s.jsxs("div",{className:"card",children:[s.jsx("h3",{children:"Two-Factor Authentication (2FA)"}),s.jsx("p",{children:y?"2FA is enabled. Youll be asked for a code at login.":"2FA is disabled. Your account uses password only."}),s.jsx("button",{className:y?"danger":"success",onClick:yt,children:y?"Disable 2FA":"Enable 2FA"})]}),s.jsxs("div",{className:"card",style:{marginTop:24},children:[s.jsx("h3",{children:"Change Password"}),Oe&&s.jsx("div",{className:"auth-error",children:Oe}),kt&&s.jsx("div",{className:"auth-success",children:kt}),s.jsxs("form",{onSubmit:Ua,children:[s.jsx("label",{children:"Current password"}),s.jsx("input",{type:"password",value:Ht,onChange:z=>Un(z.target.value),required:!0}),s.jsx("label",{children:"New password"}),s.jsx("input",{type:"password",value:Qt,onChange:z=>En(z.target.value),required:!0}),s.jsx("label",{children:"Confirm new password"}),s.jsx("input",{type:"password",value:je,onChange:z=>Ee(z.target.value),required:!0}),s.jsx("button",{disabled:dt,style:{marginTop:8},children:dt?"Updating...":"Change password"})]})]}),h&&s.jsx("p",{style:{color:"red",marginTop:16},children:h})]})}const uA=()=>le("/api/analytics/revenue/daily"),dA=()=>le("/api/analytics/doctors/utilization"),hA=()=>le("/api/analytics/pharmacy/profit");function fA(){const[e,t]=m.useState([]),[n,r]=m.useState([]),[i,a]=m.useState([]),[o,l]=m.useState("");m.useEffect(()=>{Promise.all([uA(),dA(),hA()]).then(([h,f,y])=>{t(Array.isArray(h)?h:[]),r(Array.isArray(f)?f:[]),a(Array.isArray(y)?y:[])}).catch(()=>l("Failed to load analytics"))},[]);const c=m.useMemo(()=>e.reduce((h,f)=>h+(f.total||0),0),[e]),u=m.useMemo(()=>Math.max(1,...e.map(h=>h.total||0)),[e]),d=m.useMemo(()=>Math.max(1,...n.map(h=>h.count||0)),[n]),p=m.useMemo(()=>Math.max(1,...i.map(h=>h.profit||0)),[i]);return s.jsxs("div",{className:"dashboard",children:[s.jsx("div",{className:"welcome-panel",children:s.jsxs("div",{children:[s.jsx("h2",{children:"Analytics"}),s.jsx("p",{className:"muted",children:"Live metrics and operational insights."})]})}),o&&s.jsx("div",{className:"card",children:o}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Revenue (Last 30 Days)"}),s.jsxs("div",{className:"grid info-grid",children:[s.jsxs("div",{className:"card",children:[s.jsx("div",{className:"card-title",children:"Total Revenue"}),s.jsxs("div",{className:"card-value",children:["KES ",c.toLocaleString()]})]}),s.jsxs("div",{className:"card",children:[s.jsx("div",{className:"card-title",children:"Days Tracked"}),s.jsx("div",{className:"card-value",children:e.length})]})]}),s.jsx("div",{className:"card chart-card",children:e.length===0?s.jsx("div",{className:"muted",children:"No revenue data yet."}):s.jsx("div",{className:"simple-chart",children:e.slice(-14).map(h=>{var f;return s.jsxs("div",{className:"bar-row",children:[s.jsx("span",{className:"bar-label",children:h._id}),s.jsx("div",{className:"bar-track",children:s.jsx("div",{className:"bar-fill",style:{width:`${h.total/u*100}%`}})}),s.jsxs("span",{className:"bar-value",children:["KES ",(f=h.total)==null?void 0:f.toLocaleString()]})]},h._id)})})})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Doctor Utilization (Top 10)"}),s.jsx("div",{className:"card chart-card",children:n.length===0?s.jsx("div",{className:"muted",children:"No utilization data yet."}):s.jsx("div",{className:"simple-chart",children:n.slice(0,10).map((h,f)=>{var y;return s.jsxs("div",{className:"bar-row",children:[s.jsx("span",{className:"bar-label",children:(((y=h.doctor)==null?void 0:y.name)||"Doctor").split(" ")[0]}),s.jsx("div",{className:"bar-track",children:s.jsx("div",{className:"bar-fill blue",style:{width:`${h.count/d*100}%`}})}),s.jsx("span",{className:"bar-value",children:h.count})]},h._id||f)})})})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Pharmacy Profit (Top Items)"}),s.jsx("div",{className:"card chart-card",children:i.length===0?s.jsx("div",{className:"muted",children:"No pharmacy profit data yet."}):s.jsx("div",{className:"simple-chart",children:i.slice(0,10).map((h,f)=>{var y;return s.jsxs("div",{className:"bar-row",children:[s.jsx("span",{className:"bar-label",children:h._id||"Item"}),s.jsx("div",{className:"bar-track",children:s.jsx("div",{className:"bar-fill green",style:{width:`${h.profit/p*100}%`}})}),s.jsxs("span",{className:"bar-value",children:["KES ",(y=h.profit)==null?void 0:y.toLocaleString()]})]},h._id||f)})})})]})]})}const qj=(e={})=>{const t=new URLSearchParams;e.limit&&t.set("limit",String(e.limit)),e.cursor!==void 0&&e.cursor!==null&&t.set("cursor",e.cursor),e.cursorMode&&t.set("cursorMode","1");const n=t.toString();return n?`?${n}`:""},_g=(e={})=>le(`/api/reports${qj(e)}`),Ag=(e={})=>le(`/api/reports/mine${qj(e)}`),pA=e=>le("/api/reports",{method:"POST",body:e}),mA=e=>le(`/api/reports/${e}`,{method:"DELETE"});function gA(){const{user:e}=Te(),t=(e==null?void 0:e.role)||"",n=["SUPER_ADMIN","SYSTEM_ADMIN","HOSPITAL_ADMIN"].includes(t),r=["DOCTOR"].includes(t),i=["DOCTOR","PATIENT"].includes(t),[a,o]=m.useState([]),[l,c]=m.useState([]),[u,d]=m.useState(null),[p,h]=m.useState(null),[f,y]=m.useState(!1),[j,A]=m.useState(!1),[g,x]=m.useState(!1),[w,E]=m.useState(n?"all":"mine"),[_,b]=m.useState(""),[R,C]=m.useState({title:"",content:"",patient:""});m.useEffect(()=>{n&&_g({cursorMode:!0,limit:25}).then(P=>{const V=Array.isArray(P)?P:Array.isArray(P==null?void 0:P.items)?P.items:[];o(V),d((P==null?void 0:P.nextCursor)||null),y(!!(P!=null&&P.hasMore))}).catch(()=>{o([]),d(null),y(!1)}),i&&Ag({cursorMode:!0,limit:25}).then(P=>{const V=Array.isArray(P)?P:Array.isArray(P==null?void 0:P.items)?P.items:[];c(V),h((P==null?void 0:P.nextCursor)||null),A(!!(P!=null&&P.hasMore))}).catch(()=>{c([]),h(null),A(!1)})},[n,i]);const T=m.useMemo(()=>w==="all"?a:l,[w,a,l]),D=w==="all"?f:j,U=async()=>{if(b(""),!R.title||!R.content){b("Title and content are required.");return}try{const P={title:R.title,content:R.content,...R.patient?{patient:R.patient}:{}},V=await pA(P);C({title:"",content:"",patient:""}),c(K=>[V,...K])}catch(P){b(P.message||"Failed to create report")}},W=async P=>{try{await mA(P),o(V=>V.filter(K=>K._id!==P)),c(V=>V.filter(K=>K._id!==P))}catch(V){b(V.message||"Failed to delete report")}},q=async()=>{x(!0),b("");try{if(w==="all"){const P=await _g({cursorMode:!0,limit:25,cursor:u}),V=Array.isArray(P==null?void 0:P.items)?P.items:[];o(K=>[...K,...V]),d((P==null?void 0:P.nextCursor)||null),y(!!(P!=null&&P.hasMore))}else{const P=await Ag({cursorMode:!0,limit:25,cursor:p}),V=Array.isArray(P==null?void 0:P.items)?P.items:[];c(K=>[...K,...V]),h((P==null?void 0:P.nextCursor)||null),A(!!(P!=null&&P.hasMore))}}catch(P){b(P.message||"Failed to load more reports")}finally{x(!1)}};return s.jsxs("div",{className:"dashboard",children:[s.jsx("div",{className:"welcome-panel",children:s.jsxs("div",{children:[s.jsx("h2",{children:"Reports"}),s.jsx("p",{className:"muted",children:"Clinical and operational reporting."})]})}),_&&s.jsx("div",{className:"card",children:_}),s.jsx("section",{className:"section",children:s.jsxs("div",{className:"action-list",children:[n&&s.jsx("button",{className:`action-pill ${w==="all"?"active":""}`,onClick:()=>E("all"),children:"All Reports"}),i&&s.jsx("button",{className:`action-pill ${w==="mine"?"active":""}`,onClick:()=>E("mine"),children:"My Reports"})]})}),r&&s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Create Report"}),s.jsxs("div",{className:"card form",children:[s.jsx("label",{children:"Title"}),s.jsx("input",{value:R.title,onChange:P=>C(V=>({...V,title:P.target.value}))}),s.jsx("label",{children:"Patient ID (optional)"}),s.jsx("input",{value:R.patient,onChange:P=>C(V=>({...V,patient:P.target.value}))}),s.jsx("label",{children:"Content"}),s.jsx("textarea",{rows:5,value:R.content,onChange:P=>C(V=>({...V,content:P.target.value}))}),s.jsx("button",{className:"btn-primary",onClick:U,children:"Create Report"})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:w==="all"?"All Reports":"My Reports"}),s.jsxs("div",{className:"card",children:[T.length===0?s.jsx("div",{className:"muted",children:"No reports found."}):s.jsx("div",{className:"report-list",children:T.map(P=>s.jsxs("div",{className:"report-item",children:[s.jsxs("div",{children:[s.jsx("div",{className:"report-title",children:P.title||"Untitled"}),s.jsx("div",{className:"muted",children:P.createdAt?new Date(P.createdAt).toLocaleString():""}),P.content&&s.jsx("div",{className:"report-content",children:String(P.content).slice(0,200)})]}),n&&s.jsx("button",{className:"btn-secondary",onClick:()=>W(P._id),children:"Delete"})]},P._id))}),D&&s.jsx("div",{style:{marginTop:12},children:s.jsx("button",{className:"btn-secondary",disabled:g,onClick:q,children:g?"Loading...":"Load more"})})]})]})]})}async function yA({q:e,page:t=1,limit:n=25}={}){const r=new URLSearchParams({q:e,page:t,limit:n}).toString();return le(`/api/inventory/list?${r}`)}function vA(){const[e,t]=m.useState([]),[n,r]=m.useState(""),[i,a]=m.useState(1),[o,l]=m.useState(0),[c,u]=m.useState(!1),[d,p]=m.useState("");m.useEffect(()=>{let f=!0;return u(!0),p(""),yA({q:n,page:i,limit:25}).then(y=>{f&&(t(y.items||[]),l(y.total||0))}).catch(()=>{f&&p("Failed to load inventory.")}).finally(()=>{f&&u(!1)}),()=>{f=!1}},[n,i]);const h=Math.max(1,Math.ceil(o/25));return s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"Inventory"}),s.jsx("p",{className:"muted",children:"Track stock levels across pharmacy items. Use search to filter."})]}),s.jsx("div",{className:"welcome-actions",children:s.jsx("input",{className:"input",placeholder:"Search inventory",value:n,onChange:f=>{a(1),r(f.target.value)}})})]}),d&&s.jsx("div",{className:"card",children:d}),s.jsx("div",{className:"card",children:c?s.jsx("div",{className:"muted",children:"Loading inventory..."}):s.jsxs("table",{className:"table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Item"}),s.jsx("th",{children:"SKU"}),s.jsx("th",{children:"Unit"}),s.jsx("th",{children:"Total Qty"}),s.jsx("th",{children:"Min Stock"})]})}),s.jsxs("tbody",{children:[e.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:"5",className:"muted",children:"No inventory items yet."})}),e.map(f=>s.jsxs("tr",{children:[s.jsx("td",{children:f.name}),s.jsx("td",{children:f.sku||""}),s.jsx("td",{children:f.unit||""}),s.jsx("td",{children:f.totalQuantity??0}),s.jsx("td",{children:f.minStock??0})]},f._id))]})]})}),s.jsxs("div",{className:"table-footer",children:[s.jsx("button",{className:"btn-secondary",disabled:i<=1,onClick:()=>a(f=>Math.max(1,f-1)),children:"Prev"}),s.jsxs("span",{className:"muted",children:["Page ",i," of ",h]}),s.jsx("button",{className:"btn-secondary",disabled:i>=h,onClick:()=>a(f=>Math.min(h,f+1)),children:"Next"})]})]})}const xA={CREATED:"#64748b",INSURANCE_PENDING:"#f59e0b",INSURANCE_APPROVED:"#16a34a",INSURANCE_REJECTED:"#dc2626",TRIAGE_PENDING:"#0ea5e9",CONSULTATION:"#0ea5e9",LAB_PENDING:"#8b5cf6",LAB_COMPLETED:"#22c55e",PRESCRIPTION_READY:"#3b82f6",PHARMACY_PENDING:"#3b82f6",DISPENSED:"#16a34a",PAYMENT_PENDING:"#f97316",PAID:"#22c55e",COMPLETED:"#15803d",CANCELLED:"#6b7280"};function ac({state:e}){if(!e)return null;const t=xA[e]||"#334155";return s.jsx("span",{style:{background:t,color:"white",padding:"4px 10px",borderRadius:999,fontSize:12,fontWeight:600,textTransform:"uppercase",letterSpacing:.4},children:e.replace(/_/g," ")})}function jA({sla:e}){if(!e)return null;const t=Math.floor(e.elapsedMs/6e4),n=e.breached;return s.jsxs("div",{style:{padding:"6px 10px",borderRadius:8,background:n?"#fee2e2":"#ecfeff",color:n?"#b91c1c":"#0369a1",fontSize:13,fontWeight:600,marginBottom:6},children:[" ",e.name,": ",t," min",n&&"  SLA BREACHED"]})}function bA({encounterId:e}){var d;const[t,n]=m.useState(null),[r,i]=m.useState(!0),[a,o]=m.useState("");m.useEffect(()=>{e&&l()},[e]);async function l(){i(!0),o("");try{const p=await le(`/api/workflows/${e}/timeline`);n(p)}catch(p){o(p.message||"Failed to load workflow timeline")}finally{i(!1)}}if(!e)return null;if(r)return s.jsx("div",{className:"card",children:"Loading workflow"});if(a)return s.jsx("div",{className:"card",style:{color:"red"},children:a});const{workflow:c,audit:u}=t;return s.jsxs("div",{className:"card premium-card",children:[s.jsx("h3",{style:{marginBottom:12},children:"Workflow Timeline"}),s.jsxs("div",{style:{marginBottom:16},children:[s.jsx("strong",{children:"Current State:"})," ",s.jsx(ac,{state:c.state})]}),s.jsxs("div",{style:{marginBottom:20},children:[s.jsx("strong",{children:"Allowed Actions:"}),s.jsx("div",{style:{marginTop:8},children:c.allowedTransitions.length===0?s.jsx("em",{style:{opacity:.7},children:"No actions allowed"}):c.allowedTransitions.map(p=>s.jsx(ac,{state:p},p))})]}),((d=t.sla)==null?void 0:d.length)>0&&s.jsxs(s.Fragment,{children:[s.jsx("h4",{children:"SLA Timers"}),t.sla.map(p=>s.jsx(jA,{sla:p},p.name))]}),s.jsx("h4",{children:"Workflow History"}),c.history.length===0?s.jsx("em",{children:"No workflow transitions recorded."}):s.jsx("ul",{className:"timeline",children:c.history.map((p,h)=>s.jsxs("li",{className:"timeline-item",style:{marginBottom:12},children:[s.jsx(ac,{state:p.state}),s.jsx("div",{style:{fontSize:13,opacity:.8},children:new Date(p.at).toLocaleString()}),s.jsxs("div",{style:{fontSize:13},children:["By: ",p.by||"system"]})]},h))}),(u==null?void 0:u.length)>0&&s.jsxs(s.Fragment,{children:[s.jsx("h4",{style:{marginTop:24},children:"Audit Trail"}),s.jsx("ul",{className:"timeline audit",children:u.map(p=>s.jsxs("li",{className:"timeline-item",style:{marginBottom:12},children:[s.jsx("strong",{children:p.action}),s.jsx("div",{style:{fontSize:13,opacity:.8},children:new Date(p.at).toLocaleString()}),s.jsxs("div",{style:{fontSize:13},children:["Role: ",p.actorRole]})]},p.id))})]})]})}function wA(){const{user:e}=Te(),[t,n]=m.useState([]),[r,i]=m.useState(!1),[a,o]=m.useState("");m.useEffect(()=>{e&&l()},[e]);async function l(){try{const d=await le("/api/billing/list");n(d||[])}catch{o("Failed to load transactions")}}async function c(d){var h,f,y;if(!((f=(h=d.workflow)==null?void 0:h.allowedTransitions)==null?void 0:f.includes("PAID"))){o("Payment not allowed at this stage");return}i(!0),o("");try{const j=await le("/api/payments/stripe/create-intent",{method:"POST",body:{amount:d.amount,transactionId:d._id}});o(`Stripe Payment Intent created.
Client Secret:
`+(((y=j==null?void 0:j.data)==null?void 0:y.clientSecret)||(j==null?void 0:j.clientSecret)||""))}catch(j){o(j.message)}finally{i(!1)}}async function u(d){var h,f;if(!((f=(h=d.workflow)==null?void 0:h.allowedTransitions)==null?void 0:f.includes("PAID"))){o("Payment not allowed at this stage");return}if(!d.phone){o("Missing phone number on transaction");return}i(!0),o("");try{const y=await le("/api/payments/mpesa/stk",{method:"POST",body:{amount:d.amount,phone:d.phone,transactionId:d._id}});o("M-Pesa STK Push sent. Await confirmation.")}catch(y){o(y.message)}finally{i(!1)}}return e?s.jsxs("div",{className:"card premium-card",children:[s.jsx("h2",{children:"Payments"}),a&&s.jsx("pre",{style:{background:"#f3f4f6",padding:12,whiteSpace:"pre-wrap"},children:a}),s.jsxs("table",{className:"table premium-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Patient"}),s.jsx("th",{children:"Amount"}),s.jsx("th",{children:"Status"}),s.jsx("th",{children:"Actions"}),s.jsx("th",{children:"Workflow"})]})}),s.jsx("tbody",{children:t.length?t.map(d=>{var h,f,y,j;const p=(f=(h=d.workflow)==null?void 0:h.allowedTransitions)==null?void 0:f.includes("PAID");return s.jsxs("tr",{children:[s.jsx("td",{children:((y=d.patient)==null?void 0:y.name)||""}),s.jsxs("td",{children:[d.amount," ",d.currency]}),s.jsx("td",{children:s.jsx(ac,{state:(j=d.workflow)==null?void 0:j.state})}),s.jsxs("td",{children:[s.jsx("button",{disabled:r||!p,onClick:()=>c(d),children:"Stripe"}),s.jsx("button",{disabled:r||!p,onClick:()=>u(d),style:{marginLeft:8},children:"M-Pesa"})]}),s.jsx("td",{style:{minWidth:280},children:s.jsx(bA,{encounterId:d.encounter})})]},d._id)}):s.jsx("tr",{children:s.jsx("td",{colSpan:"5",style:{textAlign:"center"},children:"No pending payments"})})})]})]}):s.jsx("div",{children:"Please log in"})}const Vc="http://localhost:5000";function SA(){const[e,t]=m.useState(100);async function n(){const a=await(await fetch(`${Vc}/payments/stripe/create-intent`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount:Number(e)})})).json();if(a.error){alert(a.error);return}alert("Client secret: "+a.clientSecret+`
(Use Stripe.js on frontend to complete payment)`)}async function r(){const a=await(await fetch(`${Vc}/payments/mpesa/stk`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount:Number(e),phone:"2547XXXXXXXX"})})).json();alert(JSON.stringify(a,null,2))}return s.jsxs("div",{children:[s.jsx("h2",{children:"Payments"}),s.jsxs("div",{children:[s.jsx("label",{children:"Amount: "}),s.jsx("input",{type:"number",value:e,onChange:i=>t(i.target.value)})]}),s.jsx("button",{onClick:n,children:"Pay with Stripe (create intent)"}),s.jsx("button",{onClick:r,children:"Pay with M-Pesa (STK push)"})]})}function zj(){const e=O_(),{user:t}=Te(),[n,r]=m.useState([]),[i,a]=m.useState("");m.useEffect(()=>{if(!(!e||!t))return e.emit("ai:join"),e.on("ai:status",l=>{r(c=>[...c,{from:"sys",text:l}])}),e.on("ai:chunk",l=>{r(c=>[...c,{from:"ai",text:l}])}),e.on("ai:done",l=>{r(c=>[...c,{from:"ai",text:JSON.stringify(l)}])}),e.on("disconnect",()=>{r(l=>[...l,{from:"sys",text:"Disconnected"}])}),()=>{e.off("ai:status"),e.off("ai:chunk"),e.off("ai:done")}},[e,t]);const o=()=>{!i.trim()||!e||(e.emit("ai:message",{type:"diagnose",symptoms:i}),r(l=>[...l,{from:"user",text:i}]),a(""))};return s.jsxs("div",{children:[s.jsx("div",{style:{maxHeight:320,overflowY:"auto",border:"1px solid #eee",padding:8},children:n.map((l,c)=>s.jsxs("div",{style:{margin:6,background:l.from==="ai"?"#eef":l.from==="user"?"#dfd":"#eee",padding:8,borderRadius:6},children:[s.jsxs("b",{children:[l.from,":"]})," ",l.text]},c))}),s.jsxs("div",{style:{marginTop:8,display:"flex",gap:8},children:[s.jsx("input",{value:i,onChange:l=>a(l.target.value),style:{flex:1},placeholder:"Describe symptoms..."}),s.jsx("button",{onClick:o,children:"Ask AI"})]})]})}function EA(){const{user:e}=Te(),t=localStorage.getItem("token");return s.jsxs("div",{className:"dashboard",children:[s.jsx("div",{className:"welcome-panel",children:s.jsxs("div",{children:[s.jsx("h2",{children:"Medical Assistant"}),s.jsxs("p",{className:"muted",children:["Real-time clinical assistant chat for ",(e==null?void 0:e.name)||"current user","."]})]})}),s.jsx("section",{className:"section",children:s.jsx("div",{className:"card",children:s.jsx(zj,{token:t})})})]})}async function NA(e){return le("/api/triage/classify",{method:"POST",body:{symptoms:e}})}async function _A(e){return le("/api/triage/classify",{method:"POST",body:{symptoms:e}})}async function AA(e){return le("/api/triage/transcribe",{method:"POST",body:{audioBase64:e}})}function CA(){const[e,t]=m.useState(""),[n,r]=m.useState(null),[i,a]=m.useState(!1),[o,l]=m.useState("");async function c(){if(e.trim()){a(!0),l("");try{const u=await _A(e.trim());r(u)}catch(u){l(u.message||"Failed to classify triage")}finally{a(!1)}}}return s.jsxs("div",{className:"dashboard",children:[s.jsx("div",{className:"welcome-panel",children:s.jsxs("div",{children:[s.jsx("h2",{children:"AI Triage"}),s.jsx("p",{className:"muted",children:"Submit symptom details to get a triage priority and guidance."})]})}),s.jsx("section",{className:"section",children:s.jsxs("div",{className:"card",children:[s.jsx("label",{children:"Symptoms / Case Summary"}),s.jsx("textarea",{rows:6,value:e,onChange:u=>t(u.target.value),placeholder:"e.g. chest pain for 2 hours, shortness of breath..."}),s.jsx("div",{className:"welcome-actions",children:s.jsx("button",{className:"btn-primary",onClick:c,disabled:i,children:i?"Analyzing...":"Run Triage"})}),o&&s.jsx("p",{className:"error-text",children:o})]})}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Triage Output"}),s.jsxs("div",{className:"card",children:[!n&&s.jsx("p",{className:"muted",children:"No triage result yet."}),n&&s.jsxs(s.Fragment,{children:[s.jsxs("p",{children:["Priority: ",s.jsx("strong",{children:n.priority||"unknown"})]}),s.jsx("pre",{style:{whiteSpace:"pre-wrap",margin:0},children:JSON.stringify(n.out||n,null,2)})]})]})]})]})}function kA(){const[e,t]=m.useState(""),[n,r]=m.useState(""),[i,a]=m.useState(!1),[o,l]=m.useState("");async function c(){if(e.trim()){a(!0),l("");try{const u=await AA(e.trim());r((u==null?void 0:u.text)||JSON.stringify(u,null,2))}catch(u){l(u.message||"Failed to transcribe audio")}finally{a(!1)}}}return s.jsxs("div",{className:"dashboard",children:[s.jsx("div",{className:"welcome-panel",children:s.jsxs("div",{children:[s.jsx("h2",{children:"Voice Dictation"}),s.jsx("p",{className:"muted",children:"Paste base64 audio payload to transcribe through your AI provider."})]})}),s.jsx("section",{className:"section",children:s.jsxs("div",{className:"card",children:[s.jsx("label",{children:"Audio (base64)"}),s.jsx("textarea",{rows:6,value:e,onChange:u=>t(u.target.value),placeholder:"Base64 audio payload"}),s.jsx("div",{className:"welcome-actions",children:s.jsx("button",{className:"btn-primary",onClick:c,disabled:i,children:i?"Transcribing...":"Transcribe"})}),o&&s.jsx("p",{className:"error-text",children:o})]})}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Transcript"}),s.jsx("div",{className:"card",children:n?s.jsx("pre",{style:{whiteSpace:"pre-wrap",margin:0},children:n}):s.jsx("p",{className:"muted",children:"No transcript yet."})})]})]})}function IA(){var h,f;const{settings:e}=vi(),[t,n]=m.useState(""),[r,i]=m.useState(""),[a,o]=m.useState(!1),[l,c]=m.useState(""),u=((h=e==null?void 0:e.ai)==null?void 0:h.name)||"NeuroEdge",d=((f=e==null?void 0:e.ai)==null?void 0:f.url)||"";async function p(){var y;if(t.trim()){o(!0),c("");try{const j=await NA(t.trim());i(((y=j==null?void 0:j.out)==null?void 0:y.text)||JSON.stringify((j==null?void 0:j.out)||j,null,2))}catch(j){c(j.message||"Failed to get AI response")}finally{o(!1)}}}return s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsxs("h2",{children:[u," Assistant"]}),s.jsx("p",{className:"muted",children:"Ask clinical support questions. Responses are logged through the backend."})]}),s.jsx("div",{className:"welcome-actions",children:d&&s.jsx("a",{className:"btn-secondary",href:d,target:"_blank",rel:"noreferrer",children:"Open Full AI Workspace"})})]}),s.jsx("section",{className:"section",children:s.jsxs("div",{className:"card",children:[s.jsx("label",{children:"Message"}),s.jsx("textarea",{rows:5,value:t,onChange:y=>n(y.target.value),placeholder:"Describe symptoms, context, or question"}),s.jsx("div",{className:"welcome-actions",children:s.jsx("button",{className:"btn-primary",onClick:p,disabled:a,children:a?"Thinking...":"Send"})}),l&&s.jsx("p",{className:"error-text",children:l})]})}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Response"}),s.jsx("div",{className:"card",children:r?s.jsx("pre",{style:{whiteSpace:"pre-wrap",margin:0},children:r}):s.jsx("p",{className:"muted",children:"No response yet."})})]})]})}const RA=async e=>{const t=new FormData;return t.append("file",e),(await ue.post("/api/ai/extract",t)).data};function TA(){const[e,t]=m.useState(null),[n,r]=m.useState(!1),[i,a]=m.useState(""),[o,l]=m.useState(null),c=async()=>{if(e){r(!0),a("");try{const u=await RA(e);l(u||null)}catch(u){a((u==null?void 0:u.message)||"Failed to extract document"),l(null)}finally{r(!1)}}};return s.jsxs("div",{className:"dashboard",children:[s.jsx("div",{className:"welcome-panel",children:s.jsxs("div",{children:[s.jsx("h2",{children:"NeuroEdge Extract"}),s.jsx("p",{className:"muted",children:"Upload PDF/text/image files to extract raw content and structured fields."})]})}),s.jsx("section",{className:"section",children:s.jsxs("div",{className:"card",children:[s.jsx("label",{children:"Upload file"}),s.jsx("input",{type:"file",accept:".pdf,.txt,.csv,.png,.jpg,.jpeg,.webp,.tiff,.bmp",onChange:u=>{var d;return t(((d=u.target.files)==null?void 0:d[0])||null)}}),s.jsx("div",{className:"welcome-actions",children:s.jsx("button",{className:"btn-primary",onClick:c,disabled:!e||n,children:n?"Extracting...":"Extract"})}),i&&s.jsx("p",{className:"error-text",children:i})]})}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Extraction Output"}),s.jsx("div",{className:"card",children:o?s.jsx("pre",{style:{whiteSpace:"pre-wrap",margin:0},children:JSON.stringify(o,null,2)}):s.jsx("p",{className:"muted",children:"No extraction result yet."})})]})]})}const OA=e=>e.startsWith("/api/")?e:`/api${e.startsWith("/")?"":"/"}${e}`,qe=async(e,t,n)=>({data:await le(OA(t),{method:e,body:n})}),PA=e=>qe("POST","/auth/login",e),LA=e=>qe("POST","/auth/register",e),DA=async()=>(localStorage.removeItem("token"),localStorage.removeItem("refreshToken"),localStorage.removeItem("user"),{ok:!0}),MA=()=>qe("GET","/auth/me"),UA=()=>qe("GET","/users"),BA=e=>qe("GET",`/users/${e}`),VA=(e,t)=>qe("PUT",`/users/${e}`,t),$A=e=>qe("DELETE",`/users/${e}`),FA=()=>qe("GET","/hospitals"),HA=e=>qe("GET",`/hospitals/${e}`),qA=e=>qe("POST","/hospitals",e),zA=(e,t)=>qe("PUT",`/hospitals/${e}`,t),WA=()=>qe("GET","/patients"),GA=e=>qe("GET",`/patients/${e}`),YA=e=>qe("POST","/patients",e),KA=(e,t)=>qe("PUT",`/patients/${e}`,t),JA=()=>qe("GET","/appointments"),QA=e=>qe("POST","/appointments",e),ZA=(e,t)=>qe("PUT",`/appointments/${e}`,t),XA=e=>qe("DELETE",`/appointments/${e}`),e1=()=>qe("GET","/labs"),t1=e=>qe("POST","/labs",e),n1=(e,t)=>qe("PUT",`/labs/${e}`,t),r1=()=>qe("GET","/financials"),s1=e=>qe("POST","/financials",e),i1=(e,t)=>qe("PUT",`/financials/${e}`,t),a1=()=>qe("GET","/transfers"),o1=e=>qe("POST","/transfers",e),l1=()=>qe("GET","/notifications"),c1=e=>qe("POST","/ai",e),u1=e=>qe("POST","/ml",e),d1=(e,t)=>qe("PATCH",e,t),os={login:PA,register:LA,logout:DA,getProfile:MA,getUsers:UA,getUserById:BA,updateUser:VA,deleteUser:$A,getHospitals:FA,getHospitalById:HA,createHospital:qA,updateHospital:zA,getPatients:WA,getPatientById:GA,createPatient:YA,updatePatient:KA,getAppointments:JA,createAppointment:QA,updateAppointment:ZA,deleteAppointment:XA,getLabTests:e1,createLabTest:t1,updateLabTest:n1,getFinancials:r1,createFinancial:s1,updateFinancial:i1,getTransfers:a1,createTransfer:o1,getNotifications:l1,runAI:c1,runML:u1,patch:d1};function h1(){const[e,t]=m.useState([]),[n,r]=m.useState({patient:"",doctor:"",scheduledAt:"",durationMins:30});m.useEffect(()=>i(),[]);const i=()=>os.get("/appointments").then(c=>{const u=c.data;t(Array.isArray(u)?u:Array.isArray(u==null?void 0:u.items)?u.items:[])}).catch(()=>{}),a=async()=>{if(!n.patient||!n.scheduledAt){alert("patient and date required");return}await os.post("/appointments",n),r({patient:"",doctor:"",scheduledAt:"",durationMins:30}),i()},o=async c=>{await os.delete("/appointments/"+c),i()},l=async c=>{await os.patch("/appointments/"+c,{status:"Completed"}),i()};return s.jsxs("div",{children:[s.jsx("h3",{children:"Appointments"}),s.jsxs("div",{style:{display:"flex",gap:12},children:[s.jsxs("div",{style:{flex:1},children:[s.jsx("input",{placeholder:"Patient ID",value:n.patient,onChange:c=>r({...n,patient:c.target.value})}),s.jsx("input",{placeholder:"Doctor ID",value:n.doctor,onChange:c=>r({...n,doctor:c.target.value})}),s.jsx("input",{type:"datetime-local",value:n.scheduledAt,onChange:c=>r({...n,scheduledAt:c.target.value})}),s.jsx("input",{type:"number",value:n.durationMins,onChange:c=>r({...n,durationMins:parseInt(c.target.value||30)})}),s.jsx("button",{onClick:a,children:"Create"})]}),s.jsx("div",{style:{flex:2},children:s.jsxs("table",{children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Patient"}),s.jsx("th",{children:"Doctor"}),s.jsx("th",{children:"When"}),s.jsx("th",{children:"Actions"})]})}),s.jsx("tbody",{children:e.map(c=>{var u,d;return s.jsxs("tr",{children:[s.jsx("td",{children:((u=c.patient)==null?void 0:u.firstName)||c.patient}),s.jsx("td",{children:((d=c.doctor)==null?void 0:d.name)||c.doctor}),s.jsx("td",{children:new Date(c.scheduledAt).toLocaleString()}),s.jsxs("td",{children:[s.jsx("button",{onClick:()=>l(c._id),children:"Complete"}),s.jsx("button",{onClick:()=>o(c._id),children:"Delete"})]})]},c._id)})})]})})]})]})}function Mn({title:e,subtitle:t,kpis:n=[],panels:r=[],actions:i=[]}){const a=Re();return s.jsxs("div",{className:"dashboard doctor-workspace",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:e}),s.jsx("p",{className:"muted",children:t})]}),s.jsx("div",{className:"welcome-actions",children:i.map(o=>s.jsx("button",{className:o.variant==="primary"?"btn-primary":"btn-secondary",onClick:()=>o.onClick?o.onClick(a):o.path?a(o.path):null,children:o.label},o.label))})]}),n.length>0&&s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Key Metrics"}),s.jsx("div",{className:"grid info-grid",children:n.map(o=>s.jsxs("div",{className:"card stat",children:[s.jsx("div",{className:"card-title",children:o.title}),s.jsx("div",{className:"card-value",children:o.value}),o.subtitle&&s.jsx("div",{className:"card-sub",children:o.subtitle})]},o.title))})]}),r.length>0&&s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Workspace"}),s.jsx("div",{className:"panel-grid",children:r.map(o=>s.jsxs("div",{className:"panel doctor-panel",children:[s.jsx("h4",{children:o.title}),s.jsx("p",{className:"muted",children:o.body})]},o.title))})]})]})}function f1(){return s.jsx(Mn,{title:"My Schedule",subtitle:"Daily, weekly and monthly clinical planning with shift overlays and surgery blocks.",actions:[{label:"Day View",variant:"primary"},{label:"Week View"},{label:"Month View"}],kpis:[{title:"Today Blocks",value:"Live"},{title:"Recurring Clinics",value:"Enabled"},{title:"Telemedicine",value:"Enabled"},{title:"Multi-Branch",value:"Ready"}],panels:[{title:"Calendar Grid",body:"Color-coded OPD, surgery, ward rounds and leave overlays."},{title:"Shift Overlay",body:"On-call and regular shift windows overlaid on appointments."},{title:"Reschedule",body:"Drag and reschedule with automatic conflict checks."},{title:"Surgery Blocks",body:"Reserve and manage procedure slots."}]})}function p1(){const e=Re(),[t,n]=m.useState(""),[r,i]=m.useState("ALL"),[a,o]=m.useState("ALL"),[l,c]=m.useState([]);m.useEffect(()=>{const d=t.trim(),p=d?`/api/patients?q=${encodeURIComponent(d)}&limit=100`:"/api/patients?limit=100";le(p).then(h=>{const f=Array.isArray(h==null?void 0:h.items)?h.items:Array.isArray(h)?h:[];c(f)}).catch(()=>c([]))},[t]);const u=m.useMemo(()=>l.filter(d=>{const p=String(d.status||"ACTIVE").toUpperCase(),h=String(d.riskLevel||"MEDIUM").toUpperCase();return(a==="ALL"||p===a)&&(r==="ALL"||h===r)}),[l,r,a]);return s.jsxs("div",{className:"dashboard doctor-workspace",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"My Patients"}),s.jsx("p",{className:"muted",children:"Search and manage inpatient, outpatient and follow-up cases."})]}),s.jsxs("div",{className:"welcome-actions",children:[s.jsx("input",{className:"search-input",placeholder:"Search patient name or ID",value:t,onChange:d=>n(d.target.value)}),s.jsxs("select",{value:a,onChange:d=>o(d.target.value),children:[s.jsx("option",{value:"ALL",children:"All Status"}),s.jsx("option",{value:"ACTIVE",children:"Active"}),s.jsx("option",{value:"CRITICAL",children:"Critical"}),s.jsx("option",{value:"FOLLOW_UP",children:"Follow-up"})]}),s.jsxs("select",{value:r,onChange:d=>i(d.target.value),children:[s.jsx("option",{value:"ALL",children:"All Risk"}),s.jsx("option",{value:"HIGH",children:"High"}),s.jsx("option",{value:"MEDIUM",children:"Medium"}),s.jsx("option",{value:"LOW",children:"Low"})]})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Patient Table"}),s.jsx("div",{className:"table-wrap",children:s.jsxs("table",{className:"doctor-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Patient ID"}),s.jsx("th",{children:"Name"}),s.jsx("th",{children:"Age"}),s.jsx("th",{children:"Diagnosis"}),s.jsx("th",{children:"Admission Type"}),s.jsx("th",{children:"Status"}),s.jsx("th",{children:"Risk Level"}),s.jsx("th",{children:"Last Visit"}),s.jsx("th",{children:"Actions"})]})}),s.jsxs("tbody",{children:[u.map(d=>{var p;return s.jsxs("tr",{children:[s.jsx("td",{children:d.nationalId||((p=d._id)==null?void 0:p.slice(-8))||"-"}),s.jsx("td",{children:[d.firstName,d.lastName].filter(Boolean).join(" ")||"-"}),s.jsx("td",{children:d.age??"-"}),s.jsx("td",{children:d.primaryDiagnosis||"-"}),s.jsx("td",{children:d.admissionType||"Outpatient"}),s.jsx("td",{children:d.status||"ACTIVE"}),s.jsx("td",{children:d.riskLevel||"MEDIUM"}),s.jsx("td",{children:d.updatedAt?new Date(d.updatedAt).toLocaleDateString():"-"}),s.jsx("td",{children:s.jsxs("div",{className:"doctor-actions-row",children:[s.jsx("button",{className:"btn-secondary",onClick:()=>e(`/doctor/medical-records?patientId=${d._id}`),children:"Open Record"}),s.jsx("button",{className:"btn-secondary",onClick:()=>e(`/doctor/reports-notes?patientId=${d._id}`),children:"Add Note"}),s.jsx("button",{className:"btn-secondary",onClick:()=>e(`/doctor/prescriptions?patientId=${d._id}`),children:"Prescribe"}),s.jsx("button",{className:"btn-secondary",onClick:()=>e(`/doctor/referrals?patientId=${d._id}`),children:"Refer"})]})})]},d._id)}),u.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:"9",className:"muted",children:"No patients found."})})]})]})})]})]})}function m1(){return s.jsx(Mn,{title:"OPD Clinic Workspace",subtitle:"Consultation screen for diagnosis, notes, coding, treatment and follow-up.",actions:[{label:"Open Consultation",variant:"primary"},{label:"Print Summary"},{label:"Send to Pharmacy"}],panels:[{title:"Patient Summary",body:"Vitals, allergies and insurance context."},{title:"Clinical Notes",body:"Auto-save notes editor with diagnosis and ICD coding."},{title:"Orders & Referrals",body:"Lab orders, prescriptions, specialist referrals and follow-up."},{title:"Consultation Actions",body:"Save & close, print summary and route to pharmacy."}]})}function g1(){return s.jsx(Mn,{title:"Inpatient Ward",subtitle:"Bed assignments, daily progress, medication chart visibility and discharge workflow.",actions:[{label:"Open Ward List",variant:"primary"},{label:"Generate Discharge"}],panels:[{title:"Assigned Beds",body:"Current inpatient allocation by ward and risk level."},{title:"Progress Notes",body:"Daily care progression and treatment milestones."},{title:"Nursing Notes",body:"Cross-functional clinical visibility with nurse inputs."},{title:"Mortality Review",body:"Outcome and review logs for governance."}]})}function y1(){return s.jsx(Mn,{title:"Surgery & Procedures",subtitle:"Pre-op to post-op documentation, checklists, outcomes and complications.",actions:[{label:"Open Surgery Calendar",variant:"primary"},{label:"Log Procedure"}],panels:[{title:"Surgery Calendar",body:"Procedure schedule by theater and team."},{title:"Pre-op Checklist",body:"Consent, readiness and anesthetic checks."},{title:"Procedure Notes",body:"Structured operative documentation."},{title:"Outcome Tracking",body:"Post-op outcomes and complication reports."}]})}function v1(){const[e,t]=m.useState([]);return m.useEffect(()=>{le("/api/lab",{method:"GET"}).then(n=>t(Array.isArray(n==null?void 0:n.items)?n.items:Array.isArray(n)?n:[])).catch(()=>t([]))},[]),s.jsxs("div",{className:"dashboard doctor-workspace",children:[s.jsx("div",{className:"welcome-panel",children:s.jsxs("div",{children:[s.jsx("h2",{children:"Lab Results"}),s.jsx("p",{className:"muted",children:"Pending, completed and abnormal results with signature workflow."})]})}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Result Queue"}),s.jsx("div",{className:"table-wrap",children:s.jsxs("table",{className:"doctor-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Encounter"}),s.jsx("th",{children:"Status"}),s.jsx("th",{children:"Updated"}),s.jsx("th",{children:"Action"})]})}),s.jsxs("tbody",{children:[e.map(n=>s.jsxs("tr",{children:[s.jsx("td",{children:n.encounter||"-"}),s.jsx("td",{children:n.status||"-"}),s.jsx("td",{children:n.updatedAt?new Date(n.updatedAt).toLocaleString():"-"}),s.jsx("td",{children:s.jsx("button",{className:"btn-secondary",children:"Open"})})]},n._id)),e.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:"4",className:"muted",children:"No lab results found."})})]})]})})]})]})}function x1(){return s.jsx(Mn,{title:"Prescriptions",subtitle:"Drug search, interaction warnings, dosage guidance and secure e-prescription export.",actions:[{label:"Create Prescription",variant:"primary"},{label:"Interaction Check"}],panels:[{title:"Medication Builder",body:"Search, dose, route, duration and refill controls."},{title:"Interaction Warnings",body:"Safety checks and allergy conflict alerts."},{title:"Controlled Drugs",body:"Controlled medication tracking and review logs."},{title:"Export",body:"Signed e-prescription output for pharmacy workflow."}]})}function j1(){return s.jsx(Mn,{title:"Medical Records",subtitle:"Longitudinal patient history across visits, surgeries, labs, radiology and attachments.",actions:[{label:"Open Patient Timeline",variant:"primary"},{label:"Upload Attachment"}],panels:[{title:"Visit History",body:"Past consultations and clinical notes timeline."},{title:"Clinical History",body:"Surgeries, immunizations and chronic history."},{title:"Diagnostics",body:"Lab and radiology history with trend support."},{title:"Attachments",body:"Secure PDFs and imaging artifacts."}]})}function b1(){return s.jsx(Mn,{title:"Referrals",subtitle:"Internal and external referrals with specialist transfer status tracking.",actions:[{label:"New Internal Referral",variant:"primary"},{label:"New External Referral"}],panels:[{title:"Internal Referrals",body:"Intra-hospital specialist handoffs."},{title:"External Referrals",body:"Cross-facility referral generation and tracking."},{title:"Transfer Status",body:"Pending, accepted, completed and declined states."}]})}function w1(){return s.jsx(Mn,{title:"Performance",subtitle:"Operational and quality indicators aligned with HR performance evaluation.",actions:[{label:"View Monthly KPIs",variant:"primary"},{label:"Export Metrics"}],kpis:[{title:"Patient Load",value:"Live"},{title:"Surgery Count",value:"Live"},{title:"Complication Rate",value:"Live"},{title:"Attendance",value:"Live"},{title:"Overtime",value:"Live"},{title:"Leave Balance",value:"Live"}],panels:[{title:"Clinical Outcomes",body:"Outcome and complication trend snapshots."},{title:"Experience",body:"Patient satisfaction and service metrics."}]})}function S1(){return s.jsx(Mn,{title:"CME & Certifications",subtitle:"License expiry, CME tracking, certificate vault and compliance reminders.",actions:[{label:"Upload Certificate",variant:"primary"},{label:"View Training Calendar"}],panels:[{title:"License Status",body:"License number and expiry countdown."},{title:"CME Credits",body:"Credits earned and upcoming requirement targets."},{title:"Compliance Alerts",body:"Expiring credentials and mandatory training reminders."}]})}function E1(){const e=Re();return s.jsx(Mn,{title:"Leave Requests",subtitle:"Manage leave balance, request submissions, approvals and shift impact.",actions:[{label:"Open My Requests",variant:"primary",onClick:()=>e("/workforce/requests#leave")},{label:"Request Overtime",onClick:()=>e("/workforce/requests#overtime")},{label:"Request Shift",onClick:()=>e("/workforce/requests#shift")}],panels:[{title:"Leave Balance",body:"Current available leave and planned allocations."},{title:"Approval Status",body:"Pending, approved and rejected history."},{title:"Shift Impact",body:"Coverage and continuity preview before submission."}]})}function N1(){return s.jsx(Mn,{title:"Reports & Notes",subtitle:"Case archive, research notes, exports and publication tracking.",actions:[{label:"Open Reports",variant:"primary",path:"/reports"},{label:"New Note"}],panels:[{title:"Case Notes",body:"Structured archive of clinical notes."},{title:"Research Notes",body:"Research and academic note workspace."},{title:"Exports",body:"Downloadable report and performance data exports."}]})}function _1(){return s.jsx(Mn,{title:"Doctor Settings",subtitle:"Profile, availability, notifications, signature and account security controls.",actions:[{label:"Open Profile",variant:"primary",path:"/profile"},{label:"Notification Preferences"}],panels:[{title:"Availability",body:"Clinic windows and scheduling preferences."},{title:"Digital Signature",body:"Upload and manage document signature identity."},{title:"Security",body:"2FA, session and account protection options."},{title:"Theme",body:"Light, dark and system display mode preferences."}]})}function Wj(){const[e,t]=m.useState([]),[n,r]=m.useState({patient:"",testType:""});m.useEffect(()=>i(),[]);const i=()=>os.get("/labs").then(c=>t(c.data)).catch(()=>{}),a=async()=>{if(!n.patient||!n.testType)return alert("patient and test required");await os.post("/labs",n),r({patient:"",testType:""}),i()},o=async c=>{const u={values:{Hb:10+Math.round(Math.random()*5),WBC:5+Math.round(Math.random()*8)}};await os.post("/labs/"+c+"/result",{result:u,status:"Completed"}),i()},l=async c=>{await os.delete("/labs/"+c),i()};return s.jsxs("div",{children:[s.jsx("h3",{children:"Lab Tests"}),s.jsxs("div",{style:{display:"flex",gap:12},children:[s.jsxs("div",{style:{flex:1},children:[s.jsx("input",{placeholder:"Patient ID",value:n.patient,onChange:c=>r({...n,patient:c.target.value})}),s.jsx("input",{placeholder:"Test type",value:n.testType,onChange:c=>r({...n,testType:c.target.value})}),s.jsx("button",{onClick:a,children:"Order"})]}),s.jsx("div",{style:{flex:2},children:s.jsxs("table",{children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Patient"}),s.jsx("th",{children:"Test"}),s.jsx("th",{children:"Status"}),s.jsx("th",{children:"Actions"})]})}),s.jsx("tbody",{children:e.map(c=>{var u;return s.jsxs("tr",{children:[s.jsx("td",{children:((u=c.patient)==null?void 0:u.firstName)||c.patient}),s.jsx("td",{children:c.testType}),s.jsx("td",{children:c.status}),s.jsxs("td",{children:[s.jsx("button",{onClick:()=>o(c._id),children:"Upload Result"}),s.jsx("button",{onClick:()=>l(c._id),children:"Delete"})]})]},c._id)})})]})})]})]})}function rt({title:e,subtitle:t,actions:n=[],kpis:r=[],panels:i=[],children:a}){const o=Re();return s.jsxs("div",{className:"dashboard doctor-workspace",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:e}),s.jsx("p",{className:"muted",children:t})]}),s.jsx("div",{className:"welcome-actions",children:n.map(l=>s.jsx("button",{className:l.variant==="primary"?"btn-primary":"btn-secondary",onClick:()=>l.onClick?l.onClick(o):l.path?o(l.path):null,children:l.label},l.label))})]}),r.length>0&&s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Summary"}),s.jsx("div",{className:"grid info-grid",children:r.map(l=>s.jsxs("div",{className:"card stat",children:[s.jsx("div",{className:"card-title",children:l.title}),s.jsx("div",{className:"card-value",children:l.value}),l.subtitle&&s.jsx("div",{className:"card-sub",children:l.subtitle})]},l.title))})]}),i.length>0&&s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Workspace"}),s.jsx("div",{className:"panel-grid",children:i.map(l=>s.jsxs("div",{className:"panel doctor-panel",children:[s.jsx("h4",{children:l.title}),s.jsx("p",{className:"muted",children:l.body})]},l.title))})]}),a]})}function A1(){return s.jsx(rt,{title:"My Shift",subtitle:"Current shift details, handover notes and real-time ward responsibilities.",actions:[{label:"Start Round",variant:"primary"},{label:"Handover Notes"}],panels:[{title:"Shift Window",body:"Current shift block and assigned zone."},{title:"Handover",body:"Incoming and outgoing shift notes."},{title:"Coverage",body:"Staff coverage snapshot for your unit."}]})}function C1(){const[e,t]=m.useState([]);return m.useEffect(()=>{le("/api/patients?limit=50").then(n=>t(Array.isArray(n==null?void 0:n.items)?n.items:[])).catch(()=>t([]))},[]),s.jsxs("div",{className:"dashboard doctor-workspace",children:[s.jsx("div",{className:"welcome-panel",children:s.jsxs("div",{children:[s.jsx("h2",{children:"Assigned Patients"}),s.jsx("p",{className:"muted",children:"Patient list with quick actions for bedside workflow."})]})}),s.jsx("section",{className:"section",children:s.jsx("div",{className:"table-wrap",children:s.jsxs("table",{className:"doctor-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Name"}),s.jsx("th",{children:"Ward"}),s.jsx("th",{children:"Status"}),s.jsx("th",{children:"Risk"}),s.jsx("th",{children:"Action"})]})}),s.jsxs("tbody",{children:[e.map(n=>s.jsxs("tr",{children:[s.jsx("td",{children:[n.firstName,n.lastName].filter(Boolean).join(" ")||"-"}),s.jsx("td",{children:n.ward||"-"}),s.jsx("td",{children:n.status||"ACTIVE"}),s.jsx("td",{children:n.riskLevel||"MEDIUM"}),s.jsx("td",{children:s.jsx("button",{className:"btn-secondary",children:"Open"})})]},n._id)),e.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:"5",className:"muted",children:"No assigned patients found."})})]})]})})})]})}function k1(){return s.jsx(rt,{title:"Medication Administration",subtitle:"Due medications, verification checks and administration logs.",actions:[{label:"Open MAR",variant:"primary"},{label:"Drug Interaction Check"}],panels:[{title:"Due Medications",body:"Upcoming medication tasks by time."},{title:"Verification",body:"Patient, dose and route verification controls."},{title:"Administration Log",body:"Time-stamped medication administration records."}]})}function I1(){return s.jsx(rt,{title:"Incident Reports",subtitle:"Create, track and escalate safety incidents from nursing operations.",actions:[{label:"New Incident",variant:"primary"},{label:"Open Incident Queue"}],panels:[{title:"Quick Form",body:"Capture severity, event details and affected patient."},{title:"Escalations",body:"High-risk cases routed to security/admin."},{title:"History",body:"Review previously filed incidents and status."}]})}function R1(){return s.jsx(rt,{title:"Vitals Entry",subtitle:"Record patient vitals and flag abnormal trends for review.",actions:[{label:"New Vitals Record",variant:"primary"},{label:"Trend View"}],panels:[{title:"Vitals Form",body:"BP, pulse, temperature, SpO2 and pain scale inputs."},{title:"Trend Graphs",body:"Historical progression for quick deterioration detection."},{title:"Alerts",body:"Abnormal values push real-time alerts to care team."}]})}function T1(){return s.jsx(rt,{title:"Leave Requests",subtitle:"Leave balance, submission workflow and shift coverage impact preview.",actions:[{label:"Request Leave",variant:"primary",path:"/workforce/requests#leave"},{label:"Request Overtime",path:"/workforce/requests#overtime"}],panels:[{title:"Balance",body:"Current leave and carry-over totals."},{title:"Request History",body:"Approved, rejected and pending requests."},{title:"Coverage",body:"Shift impact preview before submit."}]})}function O1(){return s.jsx(rt,{title:"Performance",subtitle:"Attendance, task completion and supervisor feedback metrics.",kpis:[{title:"Attendance",value:"Live"},{title:"Task Completion",value:"Live"},{title:"Supervisor Feedback",value:"Live"}],panels:[{title:"Shift Score",body:"Shift punctuality and completion summary."},{title:"Care Quality",body:"Clinical task quality and incident ratio."}]})}function P1(){return s.jsx(Wj,{})}function L1(){return s.jsx(rt,{title:"Equipment Logs",subtitle:"Track machine uptime, calibration and maintenance events.",actions:[{label:"New Log",variant:"primary"},{label:"Maintenance Calendar"}],panels:[{title:"Uptime",body:"Device uptime and downtime events."},{title:"Calibration",body:"Calibration due dates and completion records."},{title:"Maintenance",body:"Scheduled and emergency maintenance logs."}]})}function D1(){return s.jsx(rt,{title:"Sample Tracking",subtitle:"Monitor sample lifecycle from collection to result release.",actions:[{label:"Track Sample",variant:"primary"},{label:"Flag Delay"}],panels:[{title:"Collection",body:"Collected sample inventory and timestamps."},{title:"Processing",body:"In-lab progress state and queue slot."},{title:"Release",body:"Result-ready and signed-off status."}]})}function M1(){return s.jsx(rt,{title:"Quality Control",subtitle:"QC runs, deviations and corrective action tracking.",actions:[{label:"Run QC",variant:"primary"},{label:"Deviation Log"}],panels:[{title:"QC Runs",body:"Daily and batch QC checkpoints."},{title:"Deviations",body:"Abnormal QC outcomes and escalation."},{title:"Corrective Actions",body:"Action ownership and closure tracking."}]})}function U1(){return s.jsx(rt,{title:"Safety Checklist",subtitle:"Lab biosafety compliance checks and hazard readiness.",actions:[{label:"Start Checklist",variant:"primary"},{label:"Report Hazard"}],panels:[{title:"PPE",body:"Protective gear compliance checks."},{title:"Biohazard",body:"Containment and disposal controls."},{title:"Safety Audits",body:"Audit history and corrective tasks."}]})}function B1(){return s.jsx(rt,{title:"Reports Archive",subtitle:"Historical lab reports and export-ready records.",actions:[{label:"Open Reports",variant:"primary",path:"/reports"},{label:"Export Archive"}],panels:[{title:"Completed Reports",body:"Finalized reports by date and type."},{title:"Urgent Flags",body:"Priority report history and turnaround."}]})}function V1(){return s.jsx(rt,{title:"Prescription Queue",subtitle:"Pending and active prescriptions awaiting dispensing workflow.",actions:[{label:"Open Queue",variant:"primary"},{label:"Verify Interactions"}],panels:[{title:"Pending",body:"Newly created prescriptions awaiting validation."},{title:"In Progress",body:"Prescriptions currently being dispensed."},{title:"Completed",body:"Dispensed and closed prescriptions."}]})}function $1(){const e=Re();return s.jsx(rt,{title:"Inventory",subtitle:"Stock visibility, reorder thresholds and replenishment management.",actions:[{label:"Open Inventory",variant:"primary",onClick:()=>e("/inventory")},{label:"Reorder Planner"}],panels:[{title:"Stock Levels",body:"Current quantity by item and category."},{title:"Low Stock",body:"Items below configured safety threshold."},{title:"Reorder",body:"Supplier reorder planning and execution."}]})}function F1(){return s.jsx(rt,{title:"Controlled Drugs",subtitle:"Controlled medication ledger, issue/return logs and compliance checks.",actions:[{label:"Open Controlled Log",variant:"primary"},{label:"Audit Export"}],panels:[{title:"Dispense Log",body:"Controlled drug issue records."},{title:"Stock Checks",body:"Count reconciliation and discrepancy flags."},{title:"Compliance",body:"Regulatory controls and audit artifacts."}]})}function H1(){return s.jsx(rt,{title:"Expiry Alerts",subtitle:"Medication expiry surveillance and near-expiry action workflow.",actions:[{label:"Review Alerts",variant:"primary"},{label:"Quarantine Batch"}],panels:[{title:"Near Expiry",body:"Batches approaching expiry."},{title:"Expired",body:"Expired items requiring disposal records."},{title:"Actions",body:"Return, quarantine and replacement actions."}]})}function q1(){return s.jsx(rt,{title:"Supplier Orders",subtitle:"Purchase order workflow, supplier lead times and delivery tracking.",actions:[{label:"Create PO",variant:"primary"},{label:"Track Deliveries"}],panels:[{title:"Open Orders",body:"Purchase orders awaiting fulfillment."},{title:"Deliveries",body:"Incoming shipment and receiving logs."},{title:"Supplier Performance",body:"Lead-time and reliability metrics."}]})}function z1(){return s.jsx(rt,{title:"Pharmacy Reports",subtitle:"Dispense volumes, controlled logs and inventory audit reports.",actions:[{label:"Open Reports",variant:"primary",path:"/reports"},{label:"Export CSV"}],panels:[{title:"Dispense Trends",body:"Daily and monthly dispensing analysis."},{title:"Controlled Audit",body:"Controlled drug variance and audit trail."},{title:"Inventory Reports",body:"Consumption and procurement reports."}]})}function W1(){return s.jsx(rt,{title:"My Appointments",subtitle:"Upcoming, completed and rescheduled appointment history.",actions:[{label:"Book Appointment",variant:"primary"},{label:"Reschedule"}],panels:[{title:"Upcoming",body:"Upcoming appointments and reminders."},{title:"History",body:"Completed visit history timeline."},{title:"Follow-up",body:"Required follow-up and action items."}]})}function G1(){return s.jsx(rt,{title:"Medical Records",subtitle:"Personal longitudinal records across visits, procedures, labs and files.",actions:[{label:"Open Timeline",variant:"primary"},{label:"Download Record"}],panels:[{title:"Visits",body:"Consultation and admission history."},{title:"Procedures",body:"Procedure and treatment history."},{title:"Attachments",body:"Uploaded reports and supporting documents."}]})}function Y1(){return s.jsx(rt,{title:"Prescriptions",subtitle:"Active and historical prescriptions with refill and dosage guidance.",actions:[{label:"Active Prescriptions",variant:"primary"},{label:"Refill Request"}],panels:[{title:"Current Meds",body:"Currently active medications and dosage."},{title:"History",body:"Historical prescription records."},{title:"Refills",body:"Refill workflow and status tracking."}]})}function K1(){return s.jsx(rt,{title:"Lab Results",subtitle:"View completed labs, flagged values and trend history.",actions:[{label:"View Results",variant:"primary"},{label:"Download PDF"}],panels:[{title:"Completed",body:"Completed test result archive."},{title:"Flagged",body:"Abnormal values requiring review."},{title:"Trends",body:"Historic result trends over time."}]})}function J1(){return s.jsx(rt,{title:"Billing",subtitle:"Invoices, outstanding balances, receipts and payment history.",actions:[{label:"Open Payments",variant:"primary",path:"/payments"},{label:"Download Receipt"}],panels:[{title:"Outstanding",body:"Pending invoices and due dates."},{title:"Paid",body:"Paid invoices and transaction history."},{title:"Receipts",body:"Receipt archive and exports."}]})}function Q1(){return s.jsx(rt,{title:"Insurance",subtitle:"Coverage details, authorization status and claim references.",actions:[{label:"View Coverage",variant:"primary"},{label:"Claims History"}],panels:[{title:"Coverage",body:"Policy and coverage summary."},{title:"Authorizations",body:"Encounter authorization status."},{title:"Claims",body:"Claim outcomes and references."}]})}function Z1(){return s.jsx(rt,{title:"Feedback",subtitle:"Submit service feedback and track responses.",actions:[{label:"Submit Feedback",variant:"primary"},{label:"View Responses"}],panels:[{title:"New Feedback",body:"Capture care and service feedback."},{title:"History",body:"Past submissions and status."},{title:"Messages",body:"Response thread from support teams."}]})}function X1(){const[e,t]=m.useState("hospital-a"),[n,r]=m.useState(""),[i,a]=m.useState(""),[o,l]=m.useState(null);async function c(){const p=await(await fetch(`${Vc}/webhooks/${e}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({hl7:n})})).json();l(p)}async function u(){let d={};try{d=JSON.parse(i)}catch{alert("Invalid JSON");return}const h=await(await fetch(`${Vc}/webhooks/${e}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({resource:d})})).json();l(h)}return s.jsxs("div",{children:[s.jsx("h2",{children:"Real-Time Integrations (Webhooks)"}),s.jsxs("div",{style:{display:"flex",gap:12},children:[s.jsxs("div",{style:{flex:1},children:[s.jsx("h4",{children:"Send HL7 Message"}),s.jsx("input",{value:e,onChange:d=>t(d.target.value)}),s.jsx("textarea",{value:n,onChange:d=>r(d.target.value),rows:8,style:{width:"100%"},placeholder:"Paste raw HL7 message here (\\r delimited)"}),s.jsx("button",{onClick:c,children:"Send HL7"})]}),s.jsxs("div",{style:{flex:1},children:[s.jsx("h4",{children:"Send FHIR Patient Resource"}),s.jsx("textarea",{value:i,onChange:d=>a(d.target.value),rows:8,style:{width:"100%"},placeholder:"Paste FHIR Patient JSON here"}),s.jsx("button",{onClick:u,children:"Send FHIR"})]})]}),s.jsxs("div",{style:{marginTop:12},children:[s.jsx("h4",{children:"Response"}),s.jsx("pre",{children:JSON.stringify(o,null,2)})]})]})}var Gj={exports:{}},Ph={exports:{}},Cg=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof window.msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto);if(Cg){var kg=new Uint8Array(16);Ph.exports=function(){return Cg(kg),kg}}else{var Ig=new Array(16);Ph.exports=function(){for(var t=0,n;t<16;t++)t&3||(n=Math.random()*4294967296),Ig[t]=n>>>((t&3)<<3)&255;return Ig}}var Yj=Ph.exports,Kj=[];for(var Tl=0;Tl<256;++Tl)Kj[Tl]=(Tl+256).toString(16).substr(1);function eC(e,t){var n=t||0,r=Kj;return[r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]]].join("")}var Jj=eC,tC=Yj,nC=Jj,Rg,id,ad=0,od=0;function rC(e,t,n){var r=t&&n||0,i=t||[];e=e||{};var a=e.node||Rg,o=e.clockseq!==void 0?e.clockseq:id;if(a==null||o==null){var l=tC();a==null&&(a=Rg=[l[0]|1,l[1],l[2],l[3],l[4],l[5]]),o==null&&(o=id=(l[6]<<8|l[7])&16383)}var c=e.msecs!==void 0?e.msecs:new Date().getTime(),u=e.nsecs!==void 0?e.nsecs:od+1,d=c-ad+(u-od)/1e4;if(d<0&&e.clockseq===void 0&&(o=o+1&16383),(d<0||c>ad)&&e.nsecs===void 0&&(u=0),u>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");ad=c,od=u,id=o,c+=122192928e5;var p=((c&268435455)*1e4+u)%4294967296;i[r++]=p>>>24&255,i[r++]=p>>>16&255,i[r++]=p>>>8&255,i[r++]=p&255;var h=c/4294967296*1e4&268435455;i[r++]=h>>>8&255,i[r++]=h&255,i[r++]=h>>>24&15|16,i[r++]=h>>>16&255,i[r++]=o>>>8|128,i[r++]=o&255;for(var f=0;f<6;++f)i[r+f]=a[f];return t||nC(i)}var sC=rC,iC=Yj,aC=Jj;function oC(e,t,n){var r=t&&n||0;typeof e=="string"&&(t=e==="binary"?new Array(16):null,e=null),e=e||{};var i=e.random||(e.rng||iC)();if(i[6]=i[6]&15|64,i[8]=i[8]&63|128,t)for(var a=0;a<16;++a)t[r+a]=i[a];return t||aC(i)}var lC=oC,cC=sC,Qj=lC,gp=Qj;gp.v1=cC;gp.v4=Qj;var uC=gp;const{v4:dC}=uC;function Zj(){return dC().replace(/-/g,"")}let yp=Zj;function vp(){return yp()}vp.setFactory=e=>{yp=e};vp.reset=()=>{yp=Zj};var xp=vp;const hC=Symbol("_options"),fC=Symbol("_cache"),pC=Symbol("_state"),mC=Symbol("_objectId"),gC=Symbol("_conflicts"),yC=Symbol("_change"),vC=Symbol("_elemIds");var ks={OPTIONS:hC,CACHE:fC,STATE:pC,OBJECT_ID:mC,CONFLICTS:gC,CHANGE:yC,ELEM_IDS:vC};function Xj(e){return typeof e=="object"&&e!==null}function xC(e){if(!Xj(e))return{};let t={};for(let n of Object.keys(e))t[n]=e[n];return t}function jC(e){const t=/^(\d+)@(.*)$/.exec(e||"");if(!t)throw new RangeError(`Not a valid opId: ${e}`);return{counter:parseInt(t[1],10),actorId:t[2]}}function bC(e,t){if(!(e instanceof Uint8Array)||!(t instanceof Uint8Array))throw new TypeError("equalBytes can only compare Uint8Arrays");if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.byteLength;n++)if(e[n]!==t[n])return!1;return!0}function wC(e){const t=new Array(e);for(let n=0;n<e;n++)t[n]=null;return t}var xr={isObject:Xj,copyObject:xC,parseOpId:jC,equalBytes:bC,createArrayOfNulls:wC};const{OBJECT_ID:Gs}=ks,{isObject:SC}=xr;let jp=class{constructor(t){if(typeof t=="string"){const n=[...t].map(r=>({value:r}));return io(void 0,n)}else if(Array.isArray(t)){const n=t.map(r=>({value:r}));return io(void 0,n)}else{if(t===void 0)return io(void 0,[]);throw new TypeError(`Unsupported initial value for Text: ${t}`)}}get length(){return this.elems.length}get(t){const n=this.elems[t].value;if(this.context&&SC(n)){const r=n[Gs],i=this.path.concat([{key:t,objectId:r}]);return this.context.instantiateObject(i,r)}else return n}getElemId(t){return this.elems[t].elemId}[Symbol.iterator](){let t=this.elems,n=-1;return{next(){return n+=1,n<t.length?{done:!1,value:t[n].value}:{done:!0}}}}toString(){let t="";for(const n of this.elems)typeof n.value=="string"&&(t+=n.value);return t}toSpans(){let t=[],n="";for(const r of this.elems)typeof r.value=="string"?n+=r.value:(n.length>0&&(t.push(n),n=""),t.push(r.value));return n.length>0&&t.push(n),t}toJSON(){return this.toString()}getWriteable(t,n){if(!this[Gs])throw new RangeError("getWriteable() requires the objectId to be set");const r=io(this[Gs],this.elems);return r.context=t,r.path=n,r}set(t,n){if(this.context)this.context.setListIndex(this.path,t,n);else if(!this[Gs])this.elems[t].value=n;else throw new TypeError("Automerge.Text object cannot be modified outside of a change block");return this}insertAt(t,...n){if(this.context)this.context.splice(this.path,t,0,n);else if(!this[Gs])this.elems.splice(t,0,...n.map(r=>({value:r})));else throw new TypeError("Automerge.Text object cannot be modified outside of a change block");return this}deleteAt(t,n=1){if(this.context)this.context.splice(this.path,t,n,[]);else if(!this[Gs])this.elems.splice(t,n);else throw new TypeError("Automerge.Text object cannot be modified outside of a change block");return this}};for(let e of["concat","every","filter","find","findIndex","forEach","includes","indexOf","join","lastIndexOf","map","reduce","reduceRight","slice","some","toLocaleString"])jp.prototype[e]=function(...t){return[...this][e](...t)};function io(e,t){const n=Object.create(jp.prototype);return n[Gs]=e,n.elems=t,n}var mu={Text:jp,instantiateText:io};const{OBJECT_ID:Ys,CONFLICTS:EC}=ks,{isObject:$c,copyObject:Tg}=xr;function ld(e,t,n){for(let r of e)if(t[r]!==n[r]){if(typeof t[r]=="number"&&typeof n[r]=="number")return t[r]-n[r];{const i=""+t[r],a=""+n[r];if(i===a)continue;return i<a?-1:1}}return 0}let bp=class{constructor(){this.entries=Object.freeze({}),this.opIds=Object.freeze({}),Object.freeze(this)}byId(t){return this.entries[t]}get ids(){return Object.keys(this.entries).filter(t=>{const n=this.entries[t];return $c(n)&&n.id===t})}get count(){return this.ids.length}get rows(){return this.ids.map(t=>this.byId(t))}filter(t,n){return this.rows.filter(t,n)}find(t,n){return this.rows.find(t,n)}map(t,n){return this.rows.map(t,n)}sort(t){if(typeof t=="function")return this.rows.sort(t);if(typeof t=="string")return this.rows.sort((n,r)=>ld([t],n,r));if(Array.isArray(t))return this.rows.sort((n,r)=>ld(t,n,r));if(t===void 0)return this.rows.sort((n,r)=>ld(["id"],n,r));throw new TypeError(`Unsupported sorting argument: ${t}`)}[Symbol.iterator](){let t=this.rows,n=-1;return{next(){return n+=1,n<t.length?{done:!1,value:t[n]}:{done:!0}}}}_clone(){if(!this[Ys])throw new RangeError("clone() requires the objectId to be set");return eb(this[Ys],Tg(this.entries),Tg(this.opIds))}_set(t,n,r){if(Object.isFrozen(this.entries))throw new Error("A table can only be modified in a change function");$c(n)&&!Array.isArray(n)&&Object.defineProperty(n,"id",{value:t,enumerable:!0}),this.entries[t]=n,this.opIds[t]=r}remove(t){if(Object.isFrozen(this.entries))throw new Error("A table can only be modified in a change function");delete this.entries[t],delete this.opIds[t]}_freeze(){Object.freeze(this.entries),Object.freeze(this.opIds),Object.freeze(this)}getWriteable(t,n){if(!this[Ys])throw new RangeError("getWriteable() requires the objectId to be set");const r=Object.create(NC.prototype);return r[Ys]=this[Ys],r.context=t,r.entries=this.entries,r.opIds=this.opIds,r.path=n,r}toJSON(){const t={};for(let n of this.ids)t[n]=this.byId(n);return t}};class NC extends bp{byId(t){if($c(this.entries[t])&&this.entries[t].id===t){const n=this.entries[t][Ys],r=this.path.concat([{key:t,objectId:n}]);return this.context.instantiateObject(r,n,["id"])}}add(t){return this.context.addTableRow(this.path,t)}remove(t){if($c(this.entries[t])&&this.entries[t].id===t)this.context.deleteTableRow(this.path,t,this.opIds[t]);else throw new RangeError(`There is no row with ID ${t} in this table`)}}function eb(e,t,n){const r=Object.create(bp.prototype);if(!e)throw new RangeError("instantiateTable requires an objectId to be given");return r[Ys]=e,r[EC]=Object.freeze({}),r.entries=t||{},r.opIds=n||{},r}var gu={Table:bp,instantiateTable:eb};let tb=class{constructor(t){this.value=t||0,Object.freeze(this)}valueOf(){return this.value}toString(){return this.valueOf().toString()}toJSON(){return this.value}};class _C extends tb{increment(t){return t=typeof t=="number"?t:1,this.context.increment(this.path,this.key,t),this.value+=t,this.value}decrement(t){return this.increment(typeof t=="number"?-t:-1)}}function AC(e,t,n,r,i){const a=Object.create(_C.prototype);return a.value=e,a.context=t,a.path=n,a.objectId=r,a.key=i,a}var wp={Counter:tb,getWriteableCounter:AC};const{isObject:CC,copyObject:Og,parseOpId:Fc}=xr,{OBJECT_ID:qo,CONFLICTS:ii,ELEM_IDS:oc}=ks,{instantiateText:kC}=mu,{instantiateTable:IC}=gu,{Counter:RC}=wp;function Mr(e,t,n){return e.objectId?(t&&t[qo]!==e.objectId&&(t=void 0),rb(e,t,n)):e.datatype==="timestamp"?new Date(e.value):e.datatype==="counter"?new RC(e.value):e.value}function TC(e,t){const n=/^(\d+)@(.*)$/,r=n.test(e)?Fc(e):{counter:0,actorId:e},i=n.test(t)?Fc(t):{counter:0,actorId:t};return r.counter<i.counter?-1:r.counter>i.counter?1:r.actorId<i.actorId?-1:r.actorId>i.actorId?1:0}function OC(e,t,n,r){if(e)for(let i of Object.keys(e)){const a={},o=Object.keys(e[i]).sort(TC).reverse();for(let l of o){const c=e[i][l];n[i]&&n[i][l]?a[l]=Mr(c,n[i][l],r):a[l]=Mr(c,void 0,r)}o.length===0?(delete t[i],delete n[i]):(t[i]=a[o[0]],n[i]=a)}}function nb(e,t){const n=Og(e),r=Og(e?e[ii]:void 0);return Object.defineProperty(n,qo,{value:t}),Object.defineProperty(n,ii,{value:r}),n}function PC(e,t,n){const r=e.objectId;n[r]||(n[r]=nb(t,r));const i=n[r];return OC(e.props,i,i[ii],n),i}function LC(e,t,n){const r=e.objectId;n[r]||(n[r]=t?t._clone():IC(r));const i=n[r];for(let a of Object.keys(e.props||{})){const o=Object.keys(e.props[a]);if(o.length===0)i.remove(a);else if(o.length===1){const l=e.props[a][o[0]];i._set(a,Mr(l,i.byId(a),n),o[0])}else throw new RangeError("Conflicts are not supported on properties of a table")}return i}function DC(e,t){const n=e?e.slice():[],r=e&&e[ii]?e[ii].slice():[],i=e&&e[oc]?e[oc].slice():[];return Object.defineProperty(n,qo,{value:t}),Object.defineProperty(n,ii,{value:r}),Object.defineProperty(n,oc,{value:i}),n}function MC(e,t,n){const r=e.objectId;n[r]||(n[r]=DC(t,r));const i=n[r],a=i[ii],o=i[oc];for(let l=0;l<e.edits.length;l++){const c=e.edits[l];if(c.action==="insert"||c.action==="update"){const u=a[c.index]&&a[c.index][c.opId];let d=Mr(c.value,u,n),p={[c.opId]:d};for(;l<e.edits.length-1&&e.edits[l+1].index===c.index&&e.edits[l+1].action==="update";){l++;const h=e.edits[l],f=a[h.index]&&a[h.index][h.opId];d=Mr(h.value,f,n),p[h.opId]=d}c.action==="insert"?(i.splice(c.index,0,d),a.splice(c.index,0,p),o.splice(c.index,0,c.elemId)):(i[c.index]=d,a[c.index]=p)}else if(c.action==="multi-insert"){const u=Fc(c.elemId),d=[],p=[],h=[],f=c.datatype;c.values.forEach((y,j)=>{const A=`${u.counter+j}@${u.actorId}`;y=Mr({value:y,datatype:f},void 0,n),p.push(y),h.push({[A]:{value:y,datatype:f,type:"value"}}),d.push(A)}),i.splice(c.index,0,...p),a.splice(c.index,0,...h),o.splice(c.index,0,...d)}else c.action==="remove"&&(i.splice(c.index,c.count),a.splice(c.index,c.count),o.splice(c.index,c.count))}return i}function UC(e,t,n){const r=e.objectId;let i;n[r]?i=n[r].elems:t?i=t.elems.slice():i=[];for(const a of e.edits)if(a.action==="insert"){const o=Mr(a.value,void 0,n),l={elemId:a.elemId,pred:[a.opId],value:o};i.splice(a.index,0,l)}else if(a.action==="multi-insert"){const o=Fc(a.elemId),l=a.datatype,c=a.values.map((u,d)=>{u=Mr({datatype:l,value:u},void 0,n);const p=`${o.counter+d}@${o.actorId}`;return{elemId:p,pred:[p],value:u}});i.splice(a.index,0,...c)}else if(a.action==="update"){const o=i[a.index].elemId,l=Mr(a.value,i[a.index].value,n);i[a.index]={elemId:o,pred:[a.opId],value:l}}else a.action==="remove"&&i.splice(a.index,a.count);return n[r]=kC(r,i),n[r]}function rb(e,t,n){if(CC(t)&&(!e.props||Object.keys(e.props).length===0)&&(!e.edits||e.edits.length===0)&&!n[e.objectId])return t;if(e.type==="map")return PC(e,t,n);if(e.type==="table")return LC(e,t,n);if(e.type==="list")return MC(e,t,n);if(e.type==="text")return UC(e,t,n);throw new TypeError(`Unknown object type: ${e.type}`)}function BC(e){if(e[qo]!=="_root")throw new RangeError(`Not the root object: ${e[qo]}`);return nb(e,"_root")}var sb={interpretPatch:rb,cloneRootObject:BC};const{OBJECT_ID:ai,CHANGE:Hc,STATE:VC}=ks,{createArrayOfNulls:$C}=xr,{Text:FC}=mu,{Table:HC}=gu;function cr(e){if(typeof e=="string"&&/^[0-9]+$/.test(e)&&(e=parseInt(e,10)),typeof e!="number")throw new TypeError("A list index must be a number, but you passed "+JSON.stringify(e));if(e<0||isNaN(e)||e===1/0||e===-1/0)throw new RangeError("A list index must be positive, but you passed "+e);return e}function qC(e,t,n){const r={deleteAt(i,a){return e.splice(n,cr(i),a||1,[]),this},fill(i,a,o){let l=e.getObject(t);for(let c=cr(a||0);c<cr(o||l.length);c++)e.setListIndex(n,c,i);return this},indexOf(i,a=0){const o=i[ai];if(o){const l=e.getObject(t);for(let c=a;c<l.length;c++)if(l[c][ai]===o)return c;return-1}else return e.getObject(t).indexOf(i,a)},insertAt(i,...a){return e.splice(n,cr(i),0,a),this},pop(){let i=e.getObject(t);if(i.length==0)return;const a=e.getObjectField(n,t,i.length-1);return e.splice(n,i.length-1,1,[]),a},push(...i){let a=e.getObject(t);return e.splice(n,a.length,0,i),e.getObject(t).length},shift(){if(e.getObject(t).length==0)return;const a=e.getObjectField(n,t,0);return e.splice(n,0,1,[]),a},splice(i,a,...o){let l=e.getObject(t);i=cr(i),(a===void 0||a>l.length-i)&&(a=l.length-i);const c=[];for(let u=0;u<a;u++)c.push(e.getObjectField(n,t,i+u));return e.splice(n,i,a,o),c},unshift(...i){return e.splice(n,0,0,i),e.getObject(t).length}};for(let i of["entries","keys","values"]){let a=e.getObject(t);r[i]=()=>a[i]()}for(let i of["concat","every","filter","find","findIndex","forEach","includes","join","lastIndexOf","map","reduce","reduceRight","slice","some","toLocaleString","toString"])r[i]=(...a)=>e.getObject(t).map((l,c)=>e.getObjectField(n,t,c))[i](...a);return r}const zC={get(e,t){const{context:n,objectId:r,path:i}=e;return t===ai?r:t===Hc?n:t===VC?{actorId:n.actorId}:n.getObjectField(i,r,t)},set(e,t,n){const{context:r,path:i,readonly:a}=e;if(Array.isArray(a)&&a.indexOf(t)>=0)throw new RangeError(`Object property "${t}" cannot be modified`);return r.setMapKey(i,t,n),!0},deleteProperty(e,t){const{context:n,path:r,readonly:i}=e;if(Array.isArray(i)&&i.indexOf(t)>=0)throw new RangeError(`Object property "${t}" cannot be modified`);return n.deleteMapKey(r,t),!0},has(e,t){const{context:n,objectId:r}=e;return[ai,Hc].includes(t)||t in n.getObject(r)},getOwnPropertyDescriptor(e,t){const{context:n,objectId:r}=e,i=n.getObject(r);if(t in i)return{configurable:!0,enumerable:!0,value:n.getObjectField(r,t)}},ownKeys(e){const{context:t,objectId:n}=e;return Object.keys(t.getObject(n))}},WC={get(e,t){const[n,r,i]=e;return t===Symbol.iterator?n.getObject(r)[Symbol.iterator]:t===ai?r:t===Hc?n:t==="length"?n.getObject(r).length:typeof t=="string"&&/^[0-9]+$/.test(t)?n.getObjectField(i,r,cr(t)):qC(n,r,i)[t]},set(e,t,n){const[r,i,a]=e;if(t==="length"){if(typeof n!="number")throw new RangeError("Invalid array length");const o=r.getObject(i).length;o>n?r.splice(a,n,o-n,[]):r.splice(a,o,0,$C(n-o))}else r.setListIndex(a,cr(t),n);return!0},deleteProperty(e,t){const[n,,r]=e;return n.splice(r,cr(t),1,[]),!0},has(e,t){const[n,r]=e;return typeof t=="string"&&/^[0-9]+$/.test(t)?cr(t)<n.getObject(r).length:["length",ai,Hc].includes(t)},getOwnPropertyDescriptor(e,t){const[n,r]=e,i=n.getObject(r);if(t==="length")return{writable:!0,value:i.length};if(t===ai)return{configurable:!1,enumerable:!1,value:r};if(typeof t=="string"&&/^[0-9]+$/.test(t)){const a=cr(t);if(a<i.length)return{configurable:!0,enumerable:!0,value:n.getObjectField(r,a)}}},ownKeys(e){const[t,n]=e,r=t.getObject(n);let i=["length"];for(let a of Object.keys(r))i.push(a);return i}};function ib(e,t,n,r){return new Proxy({context:e,objectId:t,path:n,readonly:r},zC)}function GC(e,t,n){return new Proxy([e,t,n],WC)}function YC(e,t,n){const r=this.getObject(t);return Array.isArray(r)?GC(this,t,e):r instanceof FC||r instanceof HC?r.getWriteable(this,e):ib(this,t,e,n)}function KC(e){return e.instantiateObject=YC,ib(e,"_root",[])}var JC={rootObjectProxy:KC};let QC=class{constructor(t){if(!(Number.isInteger(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER))throw new RangeError(`Value ${t} cannot be a uint`);this.value=t,Object.freeze(this)}},ZC=class{constructor(t){if(!(Number.isInteger(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=0))throw new RangeError(`Value ${t} cannot be a uint`);this.value=t,Object.freeze(this)}},XC=class{constructor(t){if(typeof t!="number")throw new RangeError(`Value ${t} cannot be a float64`);this.value=t||0,Object.freeze(this)}};var ab={Int:QC,Uint:ZC,Float64:XC};const{CACHE:ek,OBJECT_ID:Ol,CONFLICTS:Zs,ELEM_IDS:Pg,STATE:tk}=ks,{interpretPatch:nk}=sb,{Text:ao}=mu,{Table:oo}=gu,{Counter:Kr,getWriteableCounter:rk}=wp,{Int:cd,Uint:ud,Float64:dd}=ab,{isObject:Ya,parseOpId:Lg,createArrayOfNulls:sk}=xr,ik=xp;let ak=class{constructor(t,n,r){this.actorId=n,this.nextOpNum=t[tk].maxOp+1,this.cache=t[ek],this.updated={},this.ops=[],this.applyPatch=r||nk}addOp(t){this.ops.push(t),t.action==="set"&&t.values?this.nextOpNum+=t.values.length:t.action==="del"&&t.multiOp?this.nextOpNum+=t.multiOp:this.nextOpNum+=1}nextOpId(){return`${this.nextOpNum}@${this.actorId}`}getValueDescription(t){if(!["object","boolean","number","string"].includes(typeof t))throw new TypeError(`Unsupported type of value: ${typeof t}`);if(Ya(t)){if(t instanceof Date)return{type:"value",value:t.getTime(),datatype:"timestamp"};if(t instanceof cd)return{type:"value",value:t.value,datatype:"int"};if(t instanceof ud)return{type:"value",value:t.value,datatype:"uint"};if(t instanceof dd)return{type:"value",value:t.value,datatype:"float64"};if(t instanceof Kr)return{type:"value",value:t.value,datatype:"counter"};{const n=t[Ol],r=this.getObjectType(n);if(!n)throw new RangeError(`Object ${JSON.stringify(t)} has no objectId`);return r==="list"||r==="text"?{objectId:n,type:r,edits:[]}:{objectId:n,type:r,props:{}}}}else return typeof t=="number"?Number.isInteger(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER?{type:"value",value:t,datatype:"int"}:{type:"value",value:t,datatype:"float64"}:{type:"value",value:t}}getValuesDescriptions(t,n,r){if(n instanceof oo){const i=n.byId(r),a=n.opIds[r];return i?{[a]:this.getValueDescription(i)}:{}}else if(n instanceof ao){const i=n.get(r),a=n.getElemId(r);return i?{[a]:this.getValueDescription(i)}:{}}else{const i=n[Zs][r],a={};if(!i)throw new RangeError(`No children at key ${r} of path ${JSON.stringify(t)}`);for(let o of Object.keys(i))a[o]=this.getValueDescription(i[o]);return a}}getPropertyValue(t,n,r){return t instanceof oo?t.byId(n):t instanceof ao?t.get(n):t[Zs][n][r]}getSubpatch(t,n){if(n.length==0)return t;let r=t,i=this.getObject("_root");for(let a of n){let o=this.getValuesDescriptions(n,i,a.key);if(r.props)r.props[a.key]||(r.props[a.key]=o);else if(r.edits)for(const c of Object.keys(o))r.edits.push({action:"update",index:a.key,opId:c,value:o[c]});let l=null;for(let c of Object.keys(o))o[c].objectId===a.objectId&&(l=c);if(!l)throw new RangeError(`Cannot find path object with objectId ${a.objectId}`);r=o[l],i=this.getPropertyValue(i,a.key,l)}return r}getObject(t){const n=this.updated[t]||this.cache[t];if(!n)throw new RangeError(`Target object does not exist: ${t}`);return n}getObjectType(t){if(t==="_root")return"map";const n=this.getObject(t);return n instanceof ao?"text":n instanceof oo?"table":Array.isArray(n)?"list":"map"}getObjectField(t,n,r){if(!["string","number"].includes(typeof r))return;const i=this.getObject(n);if(i[r]instanceof Kr)return rk(i[r].value,this,t,n,r);if(Ya(i[r])){const a=i[r][Ol],o=t.concat([{key:r,objectId:a}]);return this.instantiateObject(o,a)}else return i[r]}createNestedObjects(t,n,r,i,a,o){if(r[Ol])throw new RangeError("Cannot create a reference to an existing document object");const l=this.nextOpId();if(r instanceof ao){this.addOp(o?{action:"makeText",obj:t,elemId:o,insert:i,pred:a}:{action:"makeText",obj:t,key:n,insert:i,pred:a});const c={objectId:l,type:"text",edits:[]};return this.insertListItems(c,0,[...r],!0),c}else if(r instanceof oo){if(r.count>0)throw new RangeError("Assigning a non-empty Table object is not supported");return this.addOp(o?{action:"makeTable",obj:t,elemId:o,insert:i,pred:a}:{action:"makeTable",obj:t,key:n,insert:i,pred:a}),{objectId:l,type:"table",props:{}}}else if(Array.isArray(r)){this.addOp(o?{action:"makeList",obj:t,elemId:o,insert:i,pred:a}:{action:"makeList",obj:t,key:n,insert:i,pred:a});const c={objectId:l,type:"list",edits:[]};return this.insertListItems(c,0,r,!0),c}else{this.addOp(o?{action:"makeMap",obj:t,elemId:o,insert:i,pred:a}:{action:"makeMap",obj:t,key:n,insert:i,pred:a});let c={};for(let u of Object.keys(r).sort()){const d=this.nextOpId(),p=this.setValue(l,u,r[u],!1,[]);c[u]={[d]:p}}return{objectId:l,type:"map",props:c}}}setValue(t,n,r,i,a,o){if(!t)throw new RangeError("setValue needs an objectId");if(n==="")throw new RangeError("The key of a map entry must not be an empty string");if(Ya(r)&&!(r instanceof Date)&&!(r instanceof Kr)&&!(r instanceof cd)&&!(r instanceof ud)&&!(r instanceof dd))return this.createNestedObjects(t,n,r,i,a,o);{const l=this.getValueDescription(r),c={action:"set",obj:t,insert:i,value:l.value,pred:a};return o?c.elemId=o:c.key=n,l.datatype&&(c.datatype=l.datatype),this.addOp(c),l}}applyAtPath(t,n){let r={objectId:"_root",type:"map",props:{}};n(this.getSubpatch(r,t)),this.applyPatch(r,this.cache._root,this.updated)}setMapKey(t,n,r){if(typeof n!="string")throw new RangeError(`The key of a map entry must be a string, not ${typeof n}`);const i=t.length===0?"_root":t[t.length-1].objectId,a=this.getObject(i);if(a[n]instanceof Kr)throw new RangeError("Cannot overwrite a Counter object; use .increment() or .decrement() to change its value.");(a[n]!==r||Object.keys(a[Zs][n]||{}).length>1||r===void 0)&&this.applyAtPath(t,o=>{const l=Ka(a,n),c=this.nextOpId(),u=this.setValue(i,n,r,!1,l);o.props[n]={[c]:u}})}deleteMapKey(t,n){const r=t.length===0?"_root":t[t.length-1].objectId,i=this.getObject(r);if(i[n]!==void 0){const a=Ka(i,n);this.addOp({action:"del",obj:r,key:n,insert:!1,pred:a}),this.applyAtPath(t,o=>{o.props[n]={}})}}insertListItems(t,n,r,i){const a=i?[]:this.getObject(t.objectId);if(n<0||n>a.length)throw new RangeError(`List index ${n} is out of bounds for list of length ${a.length}`);if(r.length===0)return;let o=Pl(a,n,!0);const l=r.every(d=>typeof d=="string"||typeof d=="number"||typeof d=="boolean"||d===null||Ya(d)&&(d instanceof Date||d instanceof Kr||d instanceof cd||d instanceof ud||d instanceof dd)),c=l?r.map(d=>this.getValueDescription(d)):[],u=c.every(d=>d.datatype===c[0].datatype);if(l&&u&&r.length>1){const d=this.nextOpId(),p=c[0].datatype,h=c.map(j=>j.value),f={action:"set",obj:t.objectId,elemId:o,insert:!0,values:h,pred:[]},y={action:"multi-insert",elemId:d,index:n,values:h};p&&(f.datatype=p,y.datatype=p),this.addOp(f),t.edits.push(y)}else for(let d=0;d<r.length;d++){let p=this.nextOpId();const h=this.setValue(t.objectId,n+d,r[d],!0,[],o);o=p,t.edits.push({action:"insert",index:n+d,elemId:o,opId:o,value:h})}}setListIndex(t,n,r){const i=t.length===0?"_root":t[t.length-1].objectId,a=this.getObject(i);if(n>=a.length){const o=sk(n-a.length);return o.push(r),this.splice(t,a.length,0,o)}if(a[n]instanceof Kr)throw new RangeError("Cannot overwrite a Counter object; use .increment() or .decrement() to change its value.");(a[n]!==r||Object.keys(a[Zs][n]||{}).length>1||r===void 0)&&this.applyAtPath(t,o=>{const l=Ka(a,n),c=this.nextOpId(),u=this.setValue(i,n,r,!1,l,Pl(a,n));o.edits.push({action:"update",index:n,opId:c,value:u})})}splice(t,n,r,i){const a=t.length===0?"_root":t[t.length-1].objectId;let o=this.getObject(a);if(n<0||r<0||n>o.length-r)throw new RangeError(`${r} deletions starting at index ${n} are out of bounds for list of length ${o.length}`);if(r===0&&i.length===0)return;let l={diffs:{objectId:"_root",type:"map",props:{}}},c=this.getSubpatch(l.diffs,t);if(r>0){let u,d,p;for(let h=0;h<r;h++){if(this.getObjectField(t,a,n+h)instanceof Kr)throw new TypeError("Unsupported operation: deleting a counter from a list");const f=Pl(o,n+h),y=Lg(f),j=Ka(o,n+h),A=j.length===1?Lg(j[0]):void 0;u&&d&&p&&A&&d.actorId===y.actorId&&d.counter+1===y.counter&&p.actorId===A.actorId&&p.counter+1===A.counter?u.multiOp=(u.multiOp||1)+1:(u&&this.addOp(u),u={action:"del",obj:a,elemId:f,insert:!1,pred:j}),d=y,p=A}this.addOp(u),c.edits.push({action:"remove",index:n,count:r})}i.length>0&&this.insertListItems(c,n,i,!1),this.applyPatch(l.diffs,this.cache._root,this.updated)}addTableRow(t,n){if(!Ya(n)||Array.isArray(n))throw new TypeError("A table row must be an object");if(n[Ol])throw new TypeError("Cannot reuse an existing object as table row");if(n.id)throw new TypeError('A table row must not have an "id" property; it is generated automatically');const r=ik(),i=this.setValue(t[t.length-1].objectId,r,n,!1,[]);return this.applyAtPath(t,a=>{a.props[r]={[i.objectId]:i}}),r}deleteTableRow(t,n,r){const i=t[t.length-1].objectId;this.getObject(i).byId(n)&&(this.addOp({action:"del",obj:i,key:n,insert:!1,pred:[r]}),this.applyAtPath(t,o=>{o.props[n]={}}))}increment(t,n,r){const i=t.length===0?"_root":t[t.length-1].objectId,a=this.getObject(i);if(!(a[n]instanceof Kr))throw new TypeError("Only counter values can be incremented");const o=this.getObjectType(i),l=a[n].value+r,c=this.nextOpId(),u=Ka(a,n);if(o==="list"||o==="text"){const d=Pl(a,n,!1);this.addOp({action:"inc",obj:i,elemId:d,value:r,insert:!1,pred:u})}else this.addOp({action:"inc",obj:i,key:n,value:r,insert:!1,pred:u});this.applyAtPath(t,d=>{o==="list"||o==="text"?d.edits.push({action:"update",index:n,opId:c,value:{value:l,datatype:"counter"}}):d.props[n]={[c]:{value:l,datatype:"counter"}}})}};function Ka(e,t){return e instanceof oo?[e.opIds[t]]:e instanceof ao?e.elems[t].pred:e[Zs]?e[Zs][t]?Object.keys(e[Zs][t]):[]:[]}function Pl(e,t,n=!1){if(n){if(t===0)return"_head";t-=1}if(e[Pg])return e[Pg][t];if(e.getElemId)return e.getElemId(t);throw new RangeError(`Cannot find elemId at list index ${t}`)}var ok={Context:ak};const{OBJECT_ID:lk,CONFLICTS:Zt}=ks;let ck=class{constructor(){this.observers={}}patchCallback(t,n,r,i,a){this._objectUpdate(t.diffs,n,r,i,a)}_objectUpdate(t,n,r,i,a){if(t.objectId){if(this.observers[t.objectId])for(let o of this.observers[t.objectId])o(t,n,r,i,a);if(t.type==="map"&&t.props)for(const o of Object.keys(t.props))for(const l of Object.keys(t.props[o]))this._objectUpdate(t.props[o][l],n&&n[Zt]&&n[Zt][o]&&n[Zt][o][l],r&&r[Zt]&&r[Zt][o]&&r[Zt][o][l],i,a);else if(t.type==="table"&&t.props)for(const o of Object.keys(t.props))for(const l of Object.keys(t.props[o]))this._objectUpdate(t.props[o][l],n&&n.byId(o),r&&r.byId(o),i,a);else if(t.type==="list"&&t.edits){let o=0;for(const l of t.edits)l.action==="insert"?(o-=1,this._objectUpdate(l.value,void 0,r&&r[Zt]&&r[Zt][l.index]&&r[Zt][l.index][l.elemId],i,a)):l.action==="multi-insert"?o-=l.values.length:l.action==="update"?this._objectUpdate(l.value,n&&n[Zt]&&n[Zt][l.index+o]&&n[Zt][l.index+o][l.opId],r&&r[Zt]&&r[Zt][l.index]&&r[Zt][l.index][l.opId],i,a):l.action==="remove"&&(o+=l.count)}else if(t.type==="text"&&t.edits){let o=0;for(const l of t.edits)l.action==="insert"?(o-=1,this._objectUpdate(l.value,void 0,r&&r.get(l.index),i,a)):l.action==="multi-insert"?o-=l.values.length:l.action==="update"?this._objectUpdate(l.value,n&&n.get(l.index+o),r&&r.get(l.index),i,a):l.action==="remove"&&(o+=l.count)}}}observe(t,n){const r=t[lk];if(!r)throw new TypeError("The observed object must be part of an Automerge document");this.observers[r]||(this.observers[r]=[]),this.observers[r].push(n)}};var uk={Observable:ck};const{OPTIONS:dr,CACHE:Gi,STATE:mr,OBJECT_ID:Aa,CONFLICTS:Yi,CHANGE:ob,ELEM_IDS:dk}=ks,{isObject:Sp,copyObject:Lh}=xr,hk=xp,{interpretPatch:fk,cloneRootObject:pk}=sb,{rootObjectProxy:mk}=JC,{Context:lb}=ok,{Text:Ep}=mu,{Table:cb}=gu,{Counter:gk}=wp,{Float64:yk,Int:vk,Uint:xk}=ab,{Observable:jk}=uk;function ub(e){if(typeof e!="string")throw new TypeError(`Unsupported type of actorId: ${typeof e}`);if(!/^[0-9a-f]+$/.test(e))throw new RangeError("actorId must consist only of lowercase hex digits");if(e.length%2!==0)throw new RangeError("actorId must consist of an even number of digits")}function yu(e,t,n){let r=t._root;if(r||(r=pk(e[Gi]._root),t._root=r),Object.defineProperty(r,dr,{value:e[dr]}),Object.defineProperty(r,Gi,{value:t}),Object.defineProperty(r,mr,{value:n}),e[dr].freeze)for(let i of Object.keys(t))t[i]instanceof cb?t[i]._freeze():t[i]instanceof Ep?(Object.freeze(t[i].elems),Object.freeze(t[i])):(Object.freeze(t[i]),Object.freeze(t[i][Yi]));for(let i of Object.keys(e[Gi]))t[i]||(t[i]=e[Gi][i]);return e[dr].freeze&&Object.freeze(t),r}function db(e,t,n){const r=Ca(e);if(!r)throw new Error("Actor ID must be initialized with setActorId() before making a change");const i=Lh(e[mr]);i.seq+=1;const a={actor:r,seq:i.seq,startOp:i.maxOp+1,deps:i.deps,time:n&&typeof n.time=="number"?n.time:Math.round(new Date().getTime()/1e3),message:n&&typeof n.message=="string"?n.message:"",ops:t.ops};if(e[dr].backend){const[o,l,c]=e[dr].backend.applyLocalChange(i.backendState,a);i.backendState=o,i.lastLocalChange=c;const u=Dh(e,l,i),d=n&&n.patchCallback||e[dr].patchCallback;return d&&d(l,e,u,!0,[c]),[u,a]}else{const o={actor:r,seq:a.seq,before:e};return i.requests=i.requests.concat([o]),i.maxOp=i.maxOp+bk(a.ops),i.deps=[],[yu(e,t?t.updated:{},i),a]}}function bk(e){let t=0;for(const n of e)n.action==="set"&&n.values?t+=n.values.length:t+=1;return t}function wk(e){return e[mr]&&e[mr].lastLocalChange?e[mr].lastLocalChange:null}function Dh(e,t,n,r){const i=Ca(e),a={};fk(t.diffs,e,a);{if(!t.clock)throw new RangeError("patch is missing clock field");t.clock[i]&&t.clock[i]>n.seq&&(n.seq=t.clock[i]),n.clock=t.clock,n.deps=t.deps,n.maxOp=Math.max(n.maxOp,t.maxOp)}return yu(e,a,n)}function hb(e){if(typeof e=="string")e={actorId:e};else if(typeof e>"u")e={};else if(!Sp(e))throw new TypeError(`Unsupported value for init() options: ${e}`);if(e.deferActorId||(e.actorId===void 0&&(e.actorId=hk()),ub(e.actorId)),e.observable){const i=e.patchCallback,a=e.observable;e.patchCallback=(o,l,c,u,d)=>{i&&i(o,l,c,u,d),a.patchCallback(o,l,c,u,d)}}const t={},n={_root:t},r={seq:0,maxOp:0,requests:[],clock:{},deps:[]};return e.backend&&(r.backendState=e.backend.init(),r.lastLocalChange=null),Object.defineProperty(t,Aa,{value:"_root"}),Object.defineProperty(t,dr,{value:Object.freeze(e)}),Object.defineProperty(t,Yi,{value:Object.freeze({})}),Object.defineProperty(t,Gi,{value:Object.freeze(n)}),Object.defineProperty(t,mr,{value:Object.freeze(r)}),Object.freeze(t)}function Sk(e,t){return fb(hb(t),"Initialization",n=>Object.assign(n,e))}function fb(e,t,n){if(e[Aa]!=="_root")throw new TypeError("The first argument to Automerge.change must be the document root");if(e[ob])throw new TypeError("Calls to Automerge.change cannot be nested");if(typeof t=="function"&&n===void 0&&([t,n]=[n,t]),typeof t=="string"&&(t={message:t}),t!==void 0&&!Sp(t))throw new TypeError("Unsupported type of options");const r=Ca(e);if(!r)throw new Error("Actor ID must be initialized with setActorId() before making a change");const i=new lb(e,r);return n(mk(i)),Object.keys(i.updated).length===0?[e,null]:db(e,i,t)}function Ek(e,t){if(e[Aa]!=="_root")throw new TypeError("The first argument to Automerge.emptyChange must be the document root");if(typeof t=="string"&&(t={message:t}),t!==void 0&&!Sp(t))throw new TypeError("Unsupported type of options");const n=Ca(e);if(!n)throw new Error("Actor ID must be initialized with setActorId() before making a change");return db(e,new lb(e,n),t)}function Nk(e,t,n=void 0){if(e[Aa]!=="_root")throw new TypeError("The first argument to Frontend.applyPatch must be the document root");const r=Lh(e[mr]);if(e[dr].backend){if(!n)throw new RangeError("applyPatch must be called with the updated backend state");return r.backendState=n,Dh(e,t,r)}let i;if(r.requests.length>0)if(i=r.requests[0].before,t.actor===Ca(e)){if(r.requests[0].seq!==t.seq)throw new RangeError(`Mismatched sequence number: patch ${t.seq} does not match next request ${r.requests[0].seq}`);r.requests=r.requests.slice(1)}else r.requests=r.requests.slice();else i=e,r.requests=[];let a=Dh(i,t,r);return r.requests.length===0?a:(r.requests[0]=Lh(r.requests[0]),r.requests[0].before=a,yu(e,{},r))}function _k(e){return e[Aa]}function Ak(e,t){if(e[ob])throw new TypeError("Cannot use getObjectById in a change callback");return e[Gi][t]}function Ca(e){return e[mr].actorId||e[dr].actorId}function Ck(e,t){ub(t);const n=Object.assign({},e[mr],{actorId:t});return yu(e,{},n)}function kk(e,t){if(e[Yi]&&e[Yi][t]&&Object.keys(e[Yi][t]).length>1)return e[Yi][t]}function Ik(e,t=null,n="first"){if(e[Aa]!=="_root"){const r=Array.isArray(e)?". Note: Automerge.applyChanges now returns an array.":"";throw t?new TypeError(`The ${n} argument to Automerge.${t} must be the document root${r}`):new TypeError(`Argument is not an Automerge document root${r}`)}return e[mr].backendState}function Rk(e){return e instanceof Ep?e.elems.map(t=>t.elemId):e[dk]}var Tk={init:hb,from:Sk,change:fb,emptyChange:Ek,applyPatch:Nk,getObjectId:_k,getObjectById:Ak,getActorId:Ca,setActorId:Ck,getConflicts:kk,getLastLocalChange:wk,getBackendState:Ik,getElementIds:Rk,Text:Ep,Table:cb,Counter:gk,Observable:jk,Float64:yk,Int:vk,Uint:xk},jr={},ka={},br={},Ia={};const Ok=4,Dg=0,Mg=1,Pk=2;function Ra(e){let t=e.length;for(;--t>=0;)e[t]=0}const Lk=0,pb=1,Dk=2,Mk=3,Uk=258,Np=29,il=256,zo=il+1+Np,na=30,_p=19,mb=2*zo+1,Xs=15,hd=16,Bk=7,Ap=256,gb=16,yb=17,vb=18,Mh=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),lc=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),Vk=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),xb=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),$k=512,Ir=new Array((zo+2)*2);Ra(Ir);const jo=new Array(na*2);Ra(jo);const Wo=new Array($k);Ra(Wo);const Go=new Array(Uk-Mk+1);Ra(Go);const Cp=new Array(Np);Ra(Cp);const qc=new Array(na);Ra(qc);function fd(e,t,n,r,i){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=r,this.max_length=i,this.has_stree=e&&e.length}let jb,bb,wb;function pd(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}const Sb=e=>e<256?Wo[e]:Wo[256+(e>>>7)],Yo=(e,t)=>{e.pending_buf[e.pending++]=t&255,e.pending_buf[e.pending++]=t>>>8&255},on=(e,t,n)=>{e.bi_valid>hd-n?(e.bi_buf|=t<<e.bi_valid&65535,Yo(e,e.bi_buf),e.bi_buf=t>>hd-e.bi_valid,e.bi_valid+=n-hd):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)},ur=(e,t,n)=>{on(e,n[t*2],n[t*2+1])},Eb=(e,t)=>{let n=0;do n|=e&1,e>>>=1,n<<=1;while(--t>0);return n>>>1},Fk=e=>{e.bi_valid===16?(Yo(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=e.bi_buf&255,e.bi_buf>>=8,e.bi_valid-=8)},Hk=(e,t)=>{const n=t.dyn_tree,r=t.max_code,i=t.stat_desc.static_tree,a=t.stat_desc.has_stree,o=t.stat_desc.extra_bits,l=t.stat_desc.extra_base,c=t.stat_desc.max_length;let u,d,p,h,f,y,j=0;for(h=0;h<=Xs;h++)e.bl_count[h]=0;for(n[e.heap[e.heap_max]*2+1]=0,u=e.heap_max+1;u<mb;u++)d=e.heap[u],h=n[n[d*2+1]*2+1]+1,h>c&&(h=c,j++),n[d*2+1]=h,!(d>r)&&(e.bl_count[h]++,f=0,d>=l&&(f=o[d-l]),y=n[d*2],e.opt_len+=y*(h+f),a&&(e.static_len+=y*(i[d*2+1]+f)));if(j!==0){do{for(h=c-1;e.bl_count[h]===0;)h--;e.bl_count[h]--,e.bl_count[h+1]+=2,e.bl_count[c]--,j-=2}while(j>0);for(h=c;h!==0;h--)for(d=e.bl_count[h];d!==0;)p=e.heap[--u],!(p>r)&&(n[p*2+1]!==h&&(e.opt_len+=(h-n[p*2+1])*n[p*2],n[p*2+1]=h),d--)}},Nb=(e,t,n)=>{const r=new Array(Xs+1);let i=0,a,o;for(a=1;a<=Xs;a++)i=i+n[a-1]<<1,r[a]=i;for(o=0;o<=t;o++){let l=e[o*2+1];l!==0&&(e[o*2]=Eb(r[l]++,l))}},qk=()=>{let e,t,n,r,i;const a=new Array(Xs+1);for(n=0,r=0;r<Np-1;r++)for(Cp[r]=n,e=0;e<1<<Mh[r];e++)Go[n++]=r;for(Go[n-1]=r,i=0,r=0;r<16;r++)for(qc[r]=i,e=0;e<1<<lc[r];e++)Wo[i++]=r;for(i>>=7;r<na;r++)for(qc[r]=i<<7,e=0;e<1<<lc[r]-7;e++)Wo[256+i++]=r;for(t=0;t<=Xs;t++)a[t]=0;for(e=0;e<=143;)Ir[e*2+1]=8,e++,a[8]++;for(;e<=255;)Ir[e*2+1]=9,e++,a[9]++;for(;e<=279;)Ir[e*2+1]=7,e++,a[7]++;for(;e<=287;)Ir[e*2+1]=8,e++,a[8]++;for(Nb(Ir,zo+1,a),e=0;e<na;e++)jo[e*2+1]=5,jo[e*2]=Eb(e,5);jb=new fd(Ir,Mh,il+1,zo,Xs),bb=new fd(jo,lc,0,na,Xs),wb=new fd(new Array(0),Vk,0,_p,Bk)},_b=e=>{let t;for(t=0;t<zo;t++)e.dyn_ltree[t*2]=0;for(t=0;t<na;t++)e.dyn_dtree[t*2]=0;for(t=0;t<_p;t++)e.bl_tree[t*2]=0;e.dyn_ltree[Ap*2]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},Ab=e=>{e.bi_valid>8?Yo(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},Ug=(e,t,n,r)=>{const i=t*2,a=n*2;return e[i]<e[a]||e[i]===e[a]&&r[t]<=r[n]},md=(e,t,n)=>{const r=e.heap[n];let i=n<<1;for(;i<=e.heap_len&&(i<e.heap_len&&Ug(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!Ug(t,r,e.heap[i],e.depth));)e.heap[n]=e.heap[i],n=i,i<<=1;e.heap[n]=r},Bg=(e,t,n)=>{let r,i,a=0,o,l;if(e.sym_next!==0)do r=e.pending_buf[e.sym_buf+a++]&255,r+=(e.pending_buf[e.sym_buf+a++]&255)<<8,i=e.pending_buf[e.sym_buf+a++],r===0?ur(e,i,t):(o=Go[i],ur(e,o+il+1,t),l=Mh[o],l!==0&&(i-=Cp[o],on(e,i,l)),r--,o=Sb(r),ur(e,o,n),l=lc[o],l!==0&&(r-=qc[o],on(e,r,l)));while(a<e.sym_next);ur(e,Ap,t)},Uh=(e,t)=>{const n=t.dyn_tree,r=t.stat_desc.static_tree,i=t.stat_desc.has_stree,a=t.stat_desc.elems;let o,l,c=-1,u;for(e.heap_len=0,e.heap_max=mb,o=0;o<a;o++)n[o*2]!==0?(e.heap[++e.heap_len]=c=o,e.depth[o]=0):n[o*2+1]=0;for(;e.heap_len<2;)u=e.heap[++e.heap_len]=c<2?++c:0,n[u*2]=1,e.depth[u]=0,e.opt_len--,i&&(e.static_len-=r[u*2+1]);for(t.max_code=c,o=e.heap_len>>1;o>=1;o--)md(e,n,o);u=a;do o=e.heap[1],e.heap[1]=e.heap[e.heap_len--],md(e,n,1),l=e.heap[1],e.heap[--e.heap_max]=o,e.heap[--e.heap_max]=l,n[u*2]=n[o*2]+n[l*2],e.depth[u]=(e.depth[o]>=e.depth[l]?e.depth[o]:e.depth[l])+1,n[o*2+1]=n[l*2+1]=u,e.heap[1]=u++,md(e,n,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],Hk(e,t),Nb(n,c,e.bl_count)},Vg=(e,t,n)=>{let r,i=-1,a,o=t[0*2+1],l=0,c=7,u=4;for(o===0&&(c=138,u=3),t[(n+1)*2+1]=65535,r=0;r<=n;r++)a=o,o=t[(r+1)*2+1],!(++l<c&&a===o)&&(l<u?e.bl_tree[a*2]+=l:a!==0?(a!==i&&e.bl_tree[a*2]++,e.bl_tree[gb*2]++):l<=10?e.bl_tree[yb*2]++:e.bl_tree[vb*2]++,l=0,i=a,o===0?(c=138,u=3):a===o?(c=6,u=3):(c=7,u=4))},$g=(e,t,n)=>{let r,i=-1,a,o=t[0*2+1],l=0,c=7,u=4;for(o===0&&(c=138,u=3),r=0;r<=n;r++)if(a=o,o=t[(r+1)*2+1],!(++l<c&&a===o)){if(l<u)do ur(e,a,e.bl_tree);while(--l!==0);else a!==0?(a!==i&&(ur(e,a,e.bl_tree),l--),ur(e,gb,e.bl_tree),on(e,l-3,2)):l<=10?(ur(e,yb,e.bl_tree),on(e,l-3,3)):(ur(e,vb,e.bl_tree),on(e,l-11,7));l=0,i=a,o===0?(c=138,u=3):a===o?(c=6,u=3):(c=7,u=4)}},zk=e=>{let t;for(Vg(e,e.dyn_ltree,e.l_desc.max_code),Vg(e,e.dyn_dtree,e.d_desc.max_code),Uh(e,e.bl_desc),t=_p-1;t>=3&&e.bl_tree[xb[t]*2+1]===0;t--);return e.opt_len+=3*(t+1)+5+5+4,t},Wk=(e,t,n,r)=>{let i;for(on(e,t-257,5),on(e,n-1,5),on(e,r-4,4),i=0;i<r;i++)on(e,e.bl_tree[xb[i]*2+1],3);$g(e,e.dyn_ltree,t-1),$g(e,e.dyn_dtree,n-1)},Gk=e=>{let t=4093624447,n;for(n=0;n<=31;n++,t>>>=1)if(t&1&&e.dyn_ltree[n*2]!==0)return Dg;if(e.dyn_ltree[9*2]!==0||e.dyn_ltree[10*2]!==0||e.dyn_ltree[13*2]!==0)return Mg;for(n=32;n<il;n++)if(e.dyn_ltree[n*2]!==0)return Mg;return Dg};let Fg=!1;const Yk=e=>{Fg||(qk(),Fg=!0),e.l_desc=new pd(e.dyn_ltree,jb),e.d_desc=new pd(e.dyn_dtree,bb),e.bl_desc=new pd(e.bl_tree,wb),e.bi_buf=0,e.bi_valid=0,_b(e)},Cb=(e,t,n,r)=>{on(e,(Lk<<1)+(r?1:0),3),Ab(e),Yo(e,n),Yo(e,~n),n&&e.pending_buf.set(e.window.subarray(t,t+n),e.pending),e.pending+=n},Kk=e=>{on(e,pb<<1,3),ur(e,Ap,Ir),Fk(e)},Jk=(e,t,n,r)=>{let i,a,o=0;e.level>0?(e.strm.data_type===Pk&&(e.strm.data_type=Gk(e)),Uh(e,e.l_desc),Uh(e,e.d_desc),o=zk(e),i=e.opt_len+3+7>>>3,a=e.static_len+3+7>>>3,a<=i&&(i=a)):i=a=n+5,n+4<=i&&t!==-1?Cb(e,t,n,r):e.strategy===Ok||a===i?(on(e,(pb<<1)+(r?1:0),3),Bg(e,Ir,jo)):(on(e,(Dk<<1)+(r?1:0),3),Wk(e,e.l_desc.max_code+1,e.d_desc.max_code+1,o+1),Bg(e,e.dyn_ltree,e.dyn_dtree)),_b(e),r&&Ab(e)},Qk=(e,t,n)=>(e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=n,t===0?e.dyn_ltree[n*2]++:(e.matches++,t--,e.dyn_ltree[(Go[n]+il+1)*2]++,e.dyn_dtree[Sb(t)*2]++),e.sym_next===e.sym_end);Ia._tr_init=Yk;Ia._tr_stored_block=Cb;Ia._tr_flush_block=Jk;Ia._tr_tally=Qk;Ia._tr_align=Kk;const Zk=(e,t,n,r)=>{let i=e&65535|0,a=e>>>16&65535|0,o=0;for(;n!==0;){o=n>2e3?2e3:n,n-=o;do i=i+t[r++]|0,a=a+i|0;while(--o);i%=65521,a%=65521}return i|a<<16|0};var kb=Zk;const Xk=()=>{let e,t=[];for(var n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=e&1?3988292384^e>>>1:e>>>1;t[n]=e}return t},eI=new Uint32Array(Xk()),tI=(e,t,n,r)=>{const i=eI,a=r+n;e^=-1;for(let o=r;o<a;o++)e=e>>>8^i[(e^t[o])&255];return e^-1};var Ib=tI,kp={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},xi={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:nI,_tr_stored_block:Bh,_tr_flush_block:rI,_tr_tally:xs,_tr_align:sI}=Ia,Rb=kb,Jr=Ib,iI=kp,{Z_NO_FLUSH:js,Z_PARTIAL_FLUSH:aI,Z_FULL_FLUSH:oI,Z_FINISH:Rn,Z_BLOCK:Hg,Z_OK:Mt,Z_STREAM_END:qg,Z_STREAM_ERROR:gr,Z_DATA_ERROR:lI,Z_BUF_ERROR:gd,Z_DEFAULT_COMPRESSION:cI,Z_FILTERED:uI,Z_HUFFMAN_ONLY:Ll,Z_RLE:dI,Z_FIXED:hI,Z_DEFAULT_STRATEGY:fI,Z_UNKNOWN:pI,Z_DEFLATED:vu}=xi,mI=9,gI=15,yI=8,vI=29,xI=256,Vh=xI+1+vI,jI=30,bI=19,wI=2*Vh+1,SI=15,Le=3,ls=258,yr=ls+Le+1,EI=32,ma=42,Ip=57,$h=69,Fh=73,Hh=91,qh=103,ei=113,lo=666,en=1,Ta=2,pi=3,Oa=4,NI=3,ti=(e,t)=>(e.msg=iI[t],t),zg=e=>e*2-(e>4?9:0),ts=e=>{let t=e.length;for(;--t>=0;)e[t]=0},_I=e=>{let t,n,r,i=e.w_size;t=e.hash_size,r=t;do n=e.head[--r],e.head[r]=n>=i?n-i:0;while(--t);t=i,r=t;do n=e.prev[--r],e.prev[r]=n>=i?n-i:0;while(--t)};let AI=(e,t,n)=>(t<<e.hash_shift^n)&e.hash_mask,bs=AI;const gn=e=>{const t=e.state;let n=t.pending;n>e.avail_out&&(n=e.avail_out),n!==0&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+n),e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,t.pending===0&&(t.pending_out=0))},xn=(e,t)=>{rI(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,gn(e.strm)},He=(e,t)=>{e.pending_buf[e.pending++]=t},Ja=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=t&255},zh=(e,t,n,r)=>{let i=e.avail_in;return i>r&&(i=r),i===0?0:(e.avail_in-=i,t.set(e.input.subarray(e.next_in,e.next_in+i),n),e.state.wrap===1?e.adler=Rb(e.adler,t,i,n):e.state.wrap===2&&(e.adler=Jr(e.adler,t,i,n)),e.next_in+=i,e.total_in+=i,i)},Tb=(e,t)=>{let n=e.max_chain_length,r=e.strstart,i,a,o=e.prev_length,l=e.nice_match;const c=e.strstart>e.w_size-yr?e.strstart-(e.w_size-yr):0,u=e.window,d=e.w_mask,p=e.prev,h=e.strstart+ls;let f=u[r+o-1],y=u[r+o];e.prev_length>=e.good_match&&(n>>=2),l>e.lookahead&&(l=e.lookahead);do if(i=t,!(u[i+o]!==y||u[i+o-1]!==f||u[i]!==u[r]||u[++i]!==u[r+1])){r+=2,i++;do;while(u[++r]===u[++i]&&u[++r]===u[++i]&&u[++r]===u[++i]&&u[++r]===u[++i]&&u[++r]===u[++i]&&u[++r]===u[++i]&&u[++r]===u[++i]&&u[++r]===u[++i]&&r<h);if(a=ls-(h-r),r=h-ls,a>o){if(e.match_start=t,o=a,a>=l)break;f=u[r+o-1],y=u[r+o]}}while((t=p[t&d])>c&&--n!==0);return o<=e.lookahead?o:e.lookahead},ga=e=>{const t=e.w_size;let n,r,i;do{if(r=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-yr)&&(e.window.set(e.window.subarray(t,t+t-r),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,e.insert>e.strstart&&(e.insert=e.strstart),_I(e),r+=t),e.strm.avail_in===0)break;if(n=zh(e.strm,e.window,e.strstart+e.lookahead,r),e.lookahead+=n,e.lookahead+e.insert>=Le)for(i=e.strstart-e.insert,e.ins_h=e.window[i],e.ins_h=bs(e,e.ins_h,e.window[i+1]);e.insert&&(e.ins_h=bs(e,e.ins_h,e.window[i+Le-1]),e.prev[i&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=i,i++,e.insert--,!(e.lookahead+e.insert<Le)););}while(e.lookahead<yr&&e.strm.avail_in!==0)},Ob=(e,t)=>{let n=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,r,i,a,o=0,l=e.strm.avail_in;do{if(r=65535,a=e.bi_valid+42>>3,e.strm.avail_out<a||(a=e.strm.avail_out-a,i=e.strstart-e.block_start,r>i+e.strm.avail_in&&(r=i+e.strm.avail_in),r>a&&(r=a),r<n&&(r===0&&t!==Rn||t===js||r!==i+e.strm.avail_in)))break;o=t===Rn&&r===i+e.strm.avail_in?1:0,Bh(e,0,0,o),e.pending_buf[e.pending-4]=r,e.pending_buf[e.pending-3]=r>>8,e.pending_buf[e.pending-2]=~r,e.pending_buf[e.pending-1]=~r>>8,gn(e.strm),i&&(i>r&&(i=r),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+i),e.strm.next_out),e.strm.next_out+=i,e.strm.avail_out-=i,e.strm.total_out+=i,e.block_start+=i,r-=i),r&&(zh(e.strm,e.strm.output,e.strm.next_out,r),e.strm.next_out+=r,e.strm.avail_out-=r,e.strm.total_out+=r)}while(o===0);return l-=e.strm.avail_in,l&&(l>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=l&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-l,e.strm.next_in),e.strstart),e.strstart+=l,e.insert+=l>e.w_size-e.insert?e.w_size-e.insert:l),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),o?Oa:t!==js&&t!==Rn&&e.strm.avail_in===0&&e.strstart===e.block_start?Ta:(a=e.window_size-e.strstart,e.strm.avail_in>a&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,a+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),a>e.strm.avail_in&&(a=e.strm.avail_in),a&&(zh(e.strm,e.window,e.strstart,a),e.strstart+=a,e.insert+=a>e.w_size-e.insert?e.w_size-e.insert:a),e.high_water<e.strstart&&(e.high_water=e.strstart),a=e.bi_valid+42>>3,a=e.pending_buf_size-a>65535?65535:e.pending_buf_size-a,n=a>e.w_size?e.w_size:a,i=e.strstart-e.block_start,(i>=n||(i||t===Rn)&&t!==js&&e.strm.avail_in===0&&i<=a)&&(r=i>a?a:i,o=t===Rn&&e.strm.avail_in===0&&r===i?1:0,Bh(e,e.block_start,r,o),e.block_start+=r,gn(e.strm)),o?pi:en)},yd=(e,t)=>{let n,r;for(;;){if(e.lookahead<yr){if(ga(e),e.lookahead<yr&&t===js)return en;if(e.lookahead===0)break}if(n=0,e.lookahead>=Le&&(e.ins_h=bs(e,e.ins_h,e.window[e.strstart+Le-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),n!==0&&e.strstart-n<=e.w_size-yr&&(e.match_length=Tb(e,n)),e.match_length>=Le)if(r=xs(e,e.strstart-e.match_start,e.match_length-Le),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=Le){e.match_length--;do e.strstart++,e.ins_h=bs(e,e.ins_h,e.window[e.strstart+Le-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(--e.match_length!==0);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=bs(e,e.ins_h,e.window[e.strstart+1]);else r=xs(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(r&&(xn(e,!1),e.strm.avail_out===0))return en}return e.insert=e.strstart<Le-1?e.strstart:Le-1,t===Rn?(xn(e,!0),e.strm.avail_out===0?pi:Oa):e.sym_next&&(xn(e,!1),e.strm.avail_out===0)?en:Ta},Ti=(e,t)=>{let n,r,i;for(;;){if(e.lookahead<yr){if(ga(e),e.lookahead<yr&&t===js)return en;if(e.lookahead===0)break}if(n=0,e.lookahead>=Le&&(e.ins_h=bs(e,e.ins_h,e.window[e.strstart+Le-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=Le-1,n!==0&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-yr&&(e.match_length=Tb(e,n),e.match_length<=5&&(e.strategy===uI||e.match_length===Le&&e.strstart-e.match_start>4096)&&(e.match_length=Le-1)),e.prev_length>=Le&&e.match_length<=e.prev_length){i=e.strstart+e.lookahead-Le,r=xs(e,e.strstart-1-e.prev_match,e.prev_length-Le),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=i&&(e.ins_h=bs(e,e.ins_h,e.window[e.strstart+Le-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(--e.prev_length!==0);if(e.match_available=0,e.match_length=Le-1,e.strstart++,r&&(xn(e,!1),e.strm.avail_out===0))return en}else if(e.match_available){if(r=xs(e,0,e.window[e.strstart-1]),r&&xn(e,!1),e.strstart++,e.lookahead--,e.strm.avail_out===0)return en}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(r=xs(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<Le-1?e.strstart:Le-1,t===Rn?(xn(e,!0),e.strm.avail_out===0?pi:Oa):e.sym_next&&(xn(e,!1),e.strm.avail_out===0)?en:Ta},CI=(e,t)=>{let n,r,i,a;const o=e.window;for(;;){if(e.lookahead<=ls){if(ga(e),e.lookahead<=ls&&t===js)return en;if(e.lookahead===0)break}if(e.match_length=0,e.lookahead>=Le&&e.strstart>0&&(i=e.strstart-1,r=o[i],r===o[++i]&&r===o[++i]&&r===o[++i])){a=e.strstart+ls;do;while(r===o[++i]&&r===o[++i]&&r===o[++i]&&r===o[++i]&&r===o[++i]&&r===o[++i]&&r===o[++i]&&r===o[++i]&&i<a);e.match_length=ls-(a-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=Le?(n=xs(e,1,e.match_length-Le),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=xs(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(xn(e,!1),e.strm.avail_out===0))return en}return e.insert=0,t===Rn?(xn(e,!0),e.strm.avail_out===0?pi:Oa):e.sym_next&&(xn(e,!1),e.strm.avail_out===0)?en:Ta},kI=(e,t)=>{let n;for(;;){if(e.lookahead===0&&(ga(e),e.lookahead===0)){if(t===js)return en;break}if(e.match_length=0,n=xs(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(xn(e,!1),e.strm.avail_out===0))return en}return e.insert=0,t===Rn?(xn(e,!0),e.strm.avail_out===0?pi:Oa):e.sym_next&&(xn(e,!1),e.strm.avail_out===0)?en:Ta};function ir(e,t,n,r,i){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=r,this.func=i}const co=[new ir(0,0,0,0,Ob),new ir(4,4,8,4,yd),new ir(4,5,16,8,yd),new ir(4,6,32,32,yd),new ir(4,4,16,16,Ti),new ir(8,16,32,32,Ti),new ir(8,16,128,128,Ti),new ir(8,32,128,256,Ti),new ir(32,128,258,1024,Ti),new ir(32,258,258,4096,Ti)],II=e=>{e.window_size=2*e.w_size,ts(e.head),e.max_lazy_match=co[e.level].max_lazy,e.good_match=co[e.level].good_length,e.nice_match=co[e.level].nice_length,e.max_chain_length=co[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=Le-1,e.match_available=0,e.ins_h=0};function RI(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=vu,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(wI*2),this.dyn_dtree=new Uint16Array((2*jI+1)*2),this.bl_tree=new Uint16Array((2*bI+1)*2),ts(this.dyn_ltree),ts(this.dyn_dtree),ts(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(SI+1),this.heap=new Uint16Array(2*Vh+1),ts(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*Vh+1),ts(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const al=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.status!==ma&&t.status!==Ip&&t.status!==$h&&t.status!==Fh&&t.status!==Hh&&t.status!==qh&&t.status!==ei&&t.status!==lo?1:0},Pb=e=>{if(al(e))return ti(e,gr);e.total_in=e.total_out=0,e.data_type=pI;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap===2?Ip:t.wrap?ma:ei,e.adler=t.wrap===2?0:1,t.last_flush=-2,nI(t),Mt},Lb=e=>{const t=Pb(e);return t===Mt&&II(e.state),t},TI=(e,t)=>al(e)||e.state.wrap!==2?gr:(e.state.gzhead=t,Mt),Db=(e,t,n,r,i,a)=>{if(!e)return gr;let o=1;if(t===cI&&(t=6),r<0?(o=0,r=-r):r>15&&(o=2,r-=16),i<1||i>mI||n!==vu||r<8||r>15||t<0||t>9||a<0||a>hI||r===8&&o!==1)return ti(e,gr);r===8&&(r=9);const l=new RI;return e.state=l,l.strm=e,l.status=ma,l.wrap=o,l.gzhead=null,l.w_bits=r,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=i+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+Le-1)/Le),l.window=new Uint8Array(l.w_size*2),l.head=new Uint16Array(l.hash_size),l.prev=new Uint16Array(l.w_size),l.lit_bufsize=1<<i+6,l.pending_buf_size=l.lit_bufsize*4,l.pending_buf=new Uint8Array(l.pending_buf_size),l.sym_buf=l.lit_bufsize,l.sym_end=(l.lit_bufsize-1)*3,l.level=t,l.strategy=a,l.method=n,Lb(e)},OI=(e,t)=>Db(e,t,vu,gI,yI,fI),PI=(e,t)=>{if(al(e)||t>Hg||t<0)return e?ti(e,gr):gr;const n=e.state;if(!e.output||e.avail_in!==0&&!e.input||n.status===lo&&t!==Rn)return ti(e,e.avail_out===0?gd:gr);const r=n.last_flush;if(n.last_flush=t,n.pending!==0){if(gn(e),e.avail_out===0)return n.last_flush=-1,Mt}else if(e.avail_in===0&&zg(t)<=zg(r)&&t!==Rn)return ti(e,gd);if(n.status===lo&&e.avail_in!==0)return ti(e,gd);if(n.status===ma&&n.wrap===0&&(n.status=ei),n.status===ma){let i=vu+(n.w_bits-8<<4)<<8,a=-1;if(n.strategy>=Ll||n.level<2?a=0:n.level<6?a=1:n.level===6?a=2:a=3,i|=a<<6,n.strstart!==0&&(i|=EI),i+=31-i%31,Ja(n,i),n.strstart!==0&&(Ja(n,e.adler>>>16),Ja(n,e.adler&65535)),e.adler=1,n.status=ei,gn(e),n.pending!==0)return n.last_flush=-1,Mt}if(n.status===Ip){if(e.adler=0,He(n,31),He(n,139),He(n,8),n.gzhead)He(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),He(n,n.gzhead.time&255),He(n,n.gzhead.time>>8&255),He(n,n.gzhead.time>>16&255),He(n,n.gzhead.time>>24&255),He(n,n.level===9?2:n.strategy>=Ll||n.level<2?4:0),He(n,n.gzhead.os&255),n.gzhead.extra&&n.gzhead.extra.length&&(He(n,n.gzhead.extra.length&255),He(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(e.adler=Jr(e.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=$h;else if(He(n,0),He(n,0),He(n,0),He(n,0),He(n,0),He(n,n.level===9?2:n.strategy>=Ll||n.level<2?4:0),He(n,NI),n.status=ei,gn(e),n.pending!==0)return n.last_flush=-1,Mt}if(n.status===$h){if(n.gzhead.extra){let i=n.pending,a=(n.gzhead.extra.length&65535)-n.gzindex;for(;n.pending+a>n.pending_buf_size;){let l=n.pending_buf_size-n.pending;if(n.pending_buf.set(n.gzhead.extra.subarray(n.gzindex,n.gzindex+l),n.pending),n.pending=n.pending_buf_size,n.gzhead.hcrc&&n.pending>i&&(e.adler=Jr(e.adler,n.pending_buf,n.pending-i,i)),n.gzindex+=l,gn(e),n.pending!==0)return n.last_flush=-1,Mt;i=0,a-=l}let o=new Uint8Array(n.gzhead.extra);n.pending_buf.set(o.subarray(n.gzindex,n.gzindex+a),n.pending),n.pending+=a,n.gzhead.hcrc&&n.pending>i&&(e.adler=Jr(e.adler,n.pending_buf,n.pending-i,i)),n.gzindex=0}n.status=Fh}if(n.status===Fh){if(n.gzhead.name){let i=n.pending,a;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>i&&(e.adler=Jr(e.adler,n.pending_buf,n.pending-i,i)),gn(e),n.pending!==0)return n.last_flush=-1,Mt;i=0}n.gzindex<n.gzhead.name.length?a=n.gzhead.name.charCodeAt(n.gzindex++)&255:a=0,He(n,a)}while(a!==0);n.gzhead.hcrc&&n.pending>i&&(e.adler=Jr(e.adler,n.pending_buf,n.pending-i,i)),n.gzindex=0}n.status=Hh}if(n.status===Hh){if(n.gzhead.comment){let i=n.pending,a;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>i&&(e.adler=Jr(e.adler,n.pending_buf,n.pending-i,i)),gn(e),n.pending!==0)return n.last_flush=-1,Mt;i=0}n.gzindex<n.gzhead.comment.length?a=n.gzhead.comment.charCodeAt(n.gzindex++)&255:a=0,He(n,a)}while(a!==0);n.gzhead.hcrc&&n.pending>i&&(e.adler=Jr(e.adler,n.pending_buf,n.pending-i,i))}n.status=qh}if(n.status===qh){if(n.gzhead.hcrc){if(n.pending+2>n.pending_buf_size&&(gn(e),n.pending!==0))return n.last_flush=-1,Mt;He(n,e.adler&255),He(n,e.adler>>8&255),e.adler=0}if(n.status=ei,gn(e),n.pending!==0)return n.last_flush=-1,Mt}if(e.avail_in!==0||n.lookahead!==0||t!==js&&n.status!==lo){let i=n.level===0?Ob(n,t):n.strategy===Ll?kI(n,t):n.strategy===dI?CI(n,t):co[n.level].func(n,t);if((i===pi||i===Oa)&&(n.status=lo),i===en||i===pi)return e.avail_out===0&&(n.last_flush=-1),Mt;if(i===Ta&&(t===aI?sI(n):t!==Hg&&(Bh(n,0,0,!1),t===oI&&(ts(n.head),n.lookahead===0&&(n.strstart=0,n.block_start=0,n.insert=0))),gn(e),e.avail_out===0))return n.last_flush=-1,Mt}return t!==Rn?Mt:n.wrap<=0?qg:(n.wrap===2?(He(n,e.adler&255),He(n,e.adler>>8&255),He(n,e.adler>>16&255),He(n,e.adler>>24&255),He(n,e.total_in&255),He(n,e.total_in>>8&255),He(n,e.total_in>>16&255),He(n,e.total_in>>24&255)):(Ja(n,e.adler>>>16),Ja(n,e.adler&65535)),gn(e),n.wrap>0&&(n.wrap=-n.wrap),n.pending!==0?Mt:qg)},LI=e=>{if(al(e))return gr;const t=e.state.status;return e.state=null,t===ei?ti(e,lI):Mt},DI=(e,t)=>{let n=t.length;if(al(e))return gr;const r=e.state,i=r.wrap;if(i===2||i===1&&r.status!==ma||r.lookahead)return gr;if(i===1&&(e.adler=Rb(e.adler,t,n,0)),r.wrap=0,n>=r.w_size){i===0&&(ts(r.head),r.strstart=0,r.block_start=0,r.insert=0);let c=new Uint8Array(r.w_size);c.set(t.subarray(n-r.w_size,n),0),t=c,n=r.w_size}const a=e.avail_in,o=e.next_in,l=e.input;for(e.avail_in=n,e.next_in=0,e.input=t,ga(r);r.lookahead>=Le;){let c=r.strstart,u=r.lookahead-(Le-1);do r.ins_h=bs(r,r.ins_h,r.window[c+Le-1]),r.prev[c&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=c,c++;while(--u);r.strstart=c,r.lookahead=Le-1,ga(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=Le-1,r.match_available=0,e.next_in=o,e.input=l,e.avail_in=a,r.wrap=i,Mt};br.deflateInit=OI;br.deflateInit2=Db;br.deflateReset=Lb;br.deflateResetKeep=Pb;br.deflateSetHeader=TI;br.deflate=PI;br.deflateEnd=LI;br.deflateSetDictionary=DI;br.deflateInfo="pako deflate (from Nodeca project)";var xu={};const MI=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);xu.assign=function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const n=t.shift();if(n){if(typeof n!="object")throw new TypeError(n+"must be non-object");for(const r in n)MI(n,r)&&(e[r]=n[r])}}return e};xu.flattenChunks=e=>{let t=0;for(let r=0,i=e.length;r<i;r++)t+=e[r].length;const n=new Uint8Array(t);for(let r=0,i=0,a=e.length;r<a;r++){let o=e[r];n.set(o,i),i+=o.length}return n};var ol={};let Mb=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{Mb=!1}const Ko=new Uint8Array(256);for(let e=0;e<256;e++)Ko[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;Ko[254]=Ko[254]=1;ol.string2buf=e=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(e);let t,n,r,i,a,o=e.length,l=0;for(i=0;i<o;i++)n=e.charCodeAt(i),(n&64512)===55296&&i+1<o&&(r=e.charCodeAt(i+1),(r&64512)===56320&&(n=65536+(n-55296<<10)+(r-56320),i++)),l+=n<128?1:n<2048?2:n<65536?3:4;for(t=new Uint8Array(l),a=0,i=0;a<l;i++)n=e.charCodeAt(i),(n&64512)===55296&&i+1<o&&(r=e.charCodeAt(i+1),(r&64512)===56320&&(n=65536+(n-55296<<10)+(r-56320),i++)),n<128?t[a++]=n:n<2048?(t[a++]=192|n>>>6,t[a++]=128|n&63):n<65536?(t[a++]=224|n>>>12,t[a++]=128|n>>>6&63,t[a++]=128|n&63):(t[a++]=240|n>>>18,t[a++]=128|n>>>12&63,t[a++]=128|n>>>6&63,t[a++]=128|n&63);return t};const UI=(e,t)=>{if(t<65534&&e.subarray&&Mb)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let n="";for(let r=0;r<t;r++)n+=String.fromCharCode(e[r]);return n};ol.buf2string=(e,t)=>{const n=t||e.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(e.subarray(0,t));let r,i;const a=new Array(n*2);for(i=0,r=0;r<n;){let o=e[r++];if(o<128){a[i++]=o;continue}let l=Ko[o];if(l>4){a[i++]=65533,r+=l-1;continue}for(o&=l===2?31:l===3?15:7;l>1&&r<n;)o=o<<6|e[r++]&63,l--;if(l>1){a[i++]=65533;continue}o<65536?a[i++]=o:(o-=65536,a[i++]=55296|o>>10&1023,a[i++]=56320|o&1023)}return UI(a,i)};ol.utf8border=(e,t)=>{t=t||e.length,t>e.length&&(t=e.length);let n=t-1;for(;n>=0&&(e[n]&192)===128;)n--;return n<0||n===0?t:n+Ko[e[n]]>t?n:t};function BI(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var Ub=BI;const bo=br,Bb=xu,Vb=ol,Wh=kp,VI=Ub,$b=Object.prototype.toString,{Z_NO_FLUSH:$I,Z_SYNC_FLUSH:FI,Z_FULL_FLUSH:HI,Z_FINISH:qI,Z_OK:zc,Z_STREAM_END:zI,Z_DEFAULT_COMPRESSION:WI,Z_DEFAULT_STRATEGY:GI,Z_DEFLATED:YI}=xi;function ll(e){this.options=Bb.assign({level:WI,method:YI,chunkSize:16384,windowBits:15,memLevel:8,strategy:GI},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new VI,this.strm.avail_out=0;let n=bo.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(n!==zc)throw new Error(Wh[n]);if(t.header&&bo.deflateSetHeader(this.strm,t.header),t.dictionary){let r;if(typeof t.dictionary=="string"?r=Vb.string2buf(t.dictionary):$b.call(t.dictionary)==="[object ArrayBuffer]"?r=new Uint8Array(t.dictionary):r=t.dictionary,n=bo.deflateSetDictionary(this.strm,r),n!==zc)throw new Error(Wh[n]);this._dict_set=!0}}ll.prototype.push=function(e,t){const n=this.strm,r=this.options.chunkSize;let i,a;if(this.ended)return!1;for(t===~~t?a=t:a=t===!0?qI:$I,typeof e=="string"?n.input=Vb.string2buf(e):$b.call(e)==="[object ArrayBuffer]"?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;){if(n.avail_out===0&&(n.output=new Uint8Array(r),n.next_out=0,n.avail_out=r),(a===FI||a===HI)&&n.avail_out<=6){this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;continue}if(i=bo.deflate(n,a),i===zI)return n.next_out>0&&this.onData(n.output.subarray(0,n.next_out)),i=bo.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===zc;if(n.avail_out===0){this.onData(n.output);continue}if(a>0&&n.next_out>0){this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;continue}if(n.avail_in===0)break}return!0};ll.prototype.onData=function(e){this.chunks.push(e)};ll.prototype.onEnd=function(e){e===zc&&(this.result=Bb.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function Rp(e,t){const n=new ll(t);if(n.push(e,!0),n.err)throw n.msg||Wh[n.err];return n.result}function KI(e,t){return t=t||{},t.raw=!0,Rp(e,t)}function JI(e,t){return t=t||{},t.gzip=!0,Rp(e,t)}ka.Deflate=ll;ka.deflate=Rp;ka.deflateRaw=KI;ka.gzip=JI;ka.constants=xi;var Pa={},er={};const Dl=16209,QI=16191;var ZI=function(t,n){let r,i,a,o,l,c,u,d,p,h,f,y,j,A,g,x,w,E,_,b,R,C,T,D;const U=t.state;r=t.next_in,T=t.input,i=r+(t.avail_in-5),a=t.next_out,D=t.output,o=a-(n-t.avail_out),l=a+(t.avail_out-257),c=U.dmax,u=U.wsize,d=U.whave,p=U.wnext,h=U.window,f=U.hold,y=U.bits,j=U.lencode,A=U.distcode,g=(1<<U.lenbits)-1,x=(1<<U.distbits)-1;e:do{y<15&&(f+=T[r++]<<y,y+=8,f+=T[r++]<<y,y+=8),w=j[f&g];t:for(;;){if(E=w>>>24,f>>>=E,y-=E,E=w>>>16&255,E===0)D[a++]=w&65535;else if(E&16){_=w&65535,E&=15,E&&(y<E&&(f+=T[r++]<<y,y+=8),_+=f&(1<<E)-1,f>>>=E,y-=E),y<15&&(f+=T[r++]<<y,y+=8,f+=T[r++]<<y,y+=8),w=A[f&x];n:for(;;){if(E=w>>>24,f>>>=E,y-=E,E=w>>>16&255,E&16){if(b=w&65535,E&=15,y<E&&(f+=T[r++]<<y,y+=8,y<E&&(f+=T[r++]<<y,y+=8)),b+=f&(1<<E)-1,b>c){t.msg="invalid distance too far back",U.mode=Dl;break e}if(f>>>=E,y-=E,E=a-o,b>E){if(E=b-E,E>d&&U.sane){t.msg="invalid distance too far back",U.mode=Dl;break e}if(R=0,C=h,p===0){if(R+=u-E,E<_){_-=E;do D[a++]=h[R++];while(--E);R=a-b,C=D}}else if(p<E){if(R+=u+p-E,E-=p,E<_){_-=E;do D[a++]=h[R++];while(--E);if(R=0,p<_){E=p,_-=E;do D[a++]=h[R++];while(--E);R=a-b,C=D}}}else if(R+=p-E,E<_){_-=E;do D[a++]=h[R++];while(--E);R=a-b,C=D}for(;_>2;)D[a++]=C[R++],D[a++]=C[R++],D[a++]=C[R++],_-=3;_&&(D[a++]=C[R++],_>1&&(D[a++]=C[R++]))}else{R=a-b;do D[a++]=D[R++],D[a++]=D[R++],D[a++]=D[R++],_-=3;while(_>2);_&&(D[a++]=D[R++],_>1&&(D[a++]=D[R++]))}}else if(E&64){t.msg="invalid distance code",U.mode=Dl;break e}else{w=A[(w&65535)+(f&(1<<E)-1)];continue n}break}}else if(E&64)if(E&32){U.mode=QI;break e}else{t.msg="invalid literal/length code",U.mode=Dl;break e}else{w=j[(w&65535)+(f&(1<<E)-1)];continue t}break}}while(r<i&&a<l);_=y>>3,r-=_,y-=_<<3,f&=(1<<y)-1,t.next_in=r,t.next_out=a,t.avail_in=r<i?5+(i-r):5-(r-i),t.avail_out=a<l?257+(l-a):257-(a-l),U.hold=f,U.bits=y};const Oi=15,Wg=852,Gg=592,Yg=0,vd=1,Kg=2,XI=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),eR=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),tR=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),nR=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),rR=(e,t,n,r,i,a,o,l)=>{const c=l.bits;let u=0,d=0,p=0,h=0,f=0,y=0,j=0,A=0,g=0,x=0,w,E,_,b,R,C=null,T;const D=new Uint16Array(Oi+1),U=new Uint16Array(Oi+1);let W=null,q,P,V;for(u=0;u<=Oi;u++)D[u]=0;for(d=0;d<r;d++)D[t[n+d]]++;for(f=c,h=Oi;h>=1&&D[h]===0;h--);if(f>h&&(f=h),h===0)return i[a++]=1<<24|64<<16|0,i[a++]=1<<24|64<<16|0,l.bits=1,0;for(p=1;p<h&&D[p]===0;p++);for(f<p&&(f=p),A=1,u=1;u<=Oi;u++)if(A<<=1,A-=D[u],A<0)return-1;if(A>0&&(e===Yg||h!==1))return-1;for(U[1]=0,u=1;u<Oi;u++)U[u+1]=U[u]+D[u];for(d=0;d<r;d++)t[n+d]!==0&&(o[U[t[n+d]]++]=d);if(e===Yg?(C=W=o,T=20):e===vd?(C=XI,W=eR,T=257):(C=tR,W=nR,T=0),x=0,d=0,u=p,R=a,y=f,j=0,_=-1,g=1<<f,b=g-1,e===vd&&g>Wg||e===Kg&&g>Gg)return 1;for(;;){q=u-j,o[d]+1<T?(P=0,V=o[d]):o[d]>=T?(P=W[o[d]-T],V=C[o[d]-T]):(P=96,V=0),w=1<<u-j,E=1<<y,p=E;do E-=w,i[R+(x>>j)+E]=q<<24|P<<16|V|0;while(E!==0);for(w=1<<u-1;x&w;)w>>=1;if(w!==0?(x&=w-1,x+=w):x=0,d++,--D[u]===0){if(u===h)break;u=t[n+o[d]]}if(u>f&&(x&b)!==_){for(j===0&&(j=f),R+=p,y=u-j,A=1<<y;y+j<h&&(A-=D[y+j],!(A<=0));)y++,A<<=1;if(g+=1<<y,e===vd&&g>Wg||e===Kg&&g>Gg)return 1;_=x&b,i[_]=f<<24|y<<16|R-a|0}}return x!==0&&(i[R+x]=u-j<<24|64<<16|0),l.bits=f,0};var sR=rR;const Gh=kb,ar=Ib,iR=ZI,wo=sR,aR=0,Fb=1,Hb=2,{Z_FINISH:Jg,Z_BLOCK:oR,Z_TREES:Ml,Z_OK:mi,Z_STREAM_END:lR,Z_NEED_DICT:cR,Z_STREAM_ERROR:Dn,Z_DATA_ERROR:qb,Z_MEM_ERROR:zb,Z_BUF_ERROR:uR,Z_DEFLATED:Qg}=xi,ju=16180,Zg=16181,Xg=16182,ey=16183,ty=16184,ny=16185,ry=16186,sy=16187,iy=16188,ay=16189,Wc=16190,Nr=16191,xd=16192,oy=16193,jd=16194,ly=16195,cy=16196,uy=16197,dy=16198,Ul=16199,Bl=16200,hy=16201,fy=16202,py=16203,my=16204,gy=16205,bd=16206,yy=16207,vy=16208,tt=16209,Wb=16210,Gb=16211,dR=852,hR=592,fR=15,pR=fR,xy=e=>(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24);function mR(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const ji=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<ju||t.mode>Gb?1:0},Yb=e=>{if(ji(e))return Dn;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=t.wrap&1),t.mode=ju,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(dR),t.distcode=t.distdyn=new Int32Array(hR),t.sane=1,t.back=-1,mi},Kb=e=>{if(ji(e))return Dn;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,Yb(e)},Jb=(e,t)=>{let n;if(ji(e))return Dn;const r=e.state;return t<0?(n=0,t=-t):(n=(t>>4)+5,t<48&&(t&=15)),t&&(t<8||t>15)?Dn:(r.window!==null&&r.wbits!==t&&(r.window=null),r.wrap=n,r.wbits=t,Kb(e))},Qb=(e,t)=>{if(!e)return Dn;const n=new mR;e.state=n,n.strm=e,n.window=null,n.mode=ju;const r=Jb(e,t);return r!==mi&&(e.state=null),r},gR=e=>Qb(e,pR);let jy=!0,wd,Sd;const yR=e=>{if(jy){wd=new Int32Array(512),Sd=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(wo(Fb,e.lens,0,288,wd,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;wo(Hb,e.lens,0,32,Sd,0,e.work,{bits:5}),jy=!1}e.lencode=wd,e.lenbits=9,e.distcode=Sd,e.distbits=5},Zb=(e,t,n,r)=>{let i;const a=e.state;return a.window===null&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new Uint8Array(a.wsize)),r>=a.wsize?(a.window.set(t.subarray(n-a.wsize,n),0),a.wnext=0,a.whave=a.wsize):(i=a.wsize-a.wnext,i>r&&(i=r),a.window.set(t.subarray(n-r,n-r+i),a.wnext),r-=i,r?(a.window.set(t.subarray(n-r,n),0),a.wnext=r,a.whave=a.wsize):(a.wnext+=i,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=i))),0},vR=(e,t)=>{let n,r,i,a,o,l,c,u,d,p,h,f,y,j,A=0,g,x,w,E,_,b,R,C;const T=new Uint8Array(4);let D,U;const W=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(ji(e)||!e.output||!e.input&&e.avail_in!==0)return Dn;n=e.state,n.mode===Nr&&(n.mode=xd),o=e.next_out,i=e.output,c=e.avail_out,a=e.next_in,r=e.input,l=e.avail_in,u=n.hold,d=n.bits,p=l,h=c,C=mi;e:for(;;)switch(n.mode){case ju:if(n.wrap===0){n.mode=xd;break}for(;d<16;){if(l===0)break e;l--,u+=r[a++]<<d,d+=8}if(n.wrap&2&&u===35615){n.wbits===0&&(n.wbits=15),n.check=0,T[0]=u&255,T[1]=u>>>8&255,n.check=ar(n.check,T,2,0),u=0,d=0,n.mode=Zg;break}if(n.head&&(n.head.done=!1),!(n.wrap&1)||(((u&255)<<8)+(u>>8))%31){e.msg="incorrect header check",n.mode=tt;break}if((u&15)!==Qg){e.msg="unknown compression method",n.mode=tt;break}if(u>>>=4,d-=4,R=(u&15)+8,n.wbits===0&&(n.wbits=R),R>15||R>n.wbits){e.msg="invalid window size",n.mode=tt;break}n.dmax=1<<n.wbits,n.flags=0,e.adler=n.check=1,n.mode=u&512?ay:Nr,u=0,d=0;break;case Zg:for(;d<16;){if(l===0)break e;l--,u+=r[a++]<<d,d+=8}if(n.flags=u,(n.flags&255)!==Qg){e.msg="unknown compression method",n.mode=tt;break}if(n.flags&57344){e.msg="unknown header flags set",n.mode=tt;break}n.head&&(n.head.text=u>>8&1),n.flags&512&&n.wrap&4&&(T[0]=u&255,T[1]=u>>>8&255,n.check=ar(n.check,T,2,0)),u=0,d=0,n.mode=Xg;case Xg:for(;d<32;){if(l===0)break e;l--,u+=r[a++]<<d,d+=8}n.head&&(n.head.time=u),n.flags&512&&n.wrap&4&&(T[0]=u&255,T[1]=u>>>8&255,T[2]=u>>>16&255,T[3]=u>>>24&255,n.check=ar(n.check,T,4,0)),u=0,d=0,n.mode=ey;case ey:for(;d<16;){if(l===0)break e;l--,u+=r[a++]<<d,d+=8}n.head&&(n.head.xflags=u&255,n.head.os=u>>8),n.flags&512&&n.wrap&4&&(T[0]=u&255,T[1]=u>>>8&255,n.check=ar(n.check,T,2,0)),u=0,d=0,n.mode=ty;case ty:if(n.flags&1024){for(;d<16;){if(l===0)break e;l--,u+=r[a++]<<d,d+=8}n.length=u,n.head&&(n.head.extra_len=u),n.flags&512&&n.wrap&4&&(T[0]=u&255,T[1]=u>>>8&255,n.check=ar(n.check,T,2,0)),u=0,d=0}else n.head&&(n.head.extra=null);n.mode=ny;case ny:if(n.flags&1024&&(f=n.length,f>l&&(f=l),f&&(n.head&&(R=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(r.subarray(a,a+f),R)),n.flags&512&&n.wrap&4&&(n.check=ar(n.check,r,f,a)),l-=f,a+=f,n.length-=f),n.length))break e;n.length=0,n.mode=ry;case ry:if(n.flags&2048){if(l===0)break e;f=0;do R=r[a+f++],n.head&&R&&n.length<65536&&(n.head.name+=String.fromCharCode(R));while(R&&f<l);if(n.flags&512&&n.wrap&4&&(n.check=ar(n.check,r,f,a)),l-=f,a+=f,R)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=sy;case sy:if(n.flags&4096){if(l===0)break e;f=0;do R=r[a+f++],n.head&&R&&n.length<65536&&(n.head.comment+=String.fromCharCode(R));while(R&&f<l);if(n.flags&512&&n.wrap&4&&(n.check=ar(n.check,r,f,a)),l-=f,a+=f,R)break e}else n.head&&(n.head.comment=null);n.mode=iy;case iy:if(n.flags&512){for(;d<16;){if(l===0)break e;l--,u+=r[a++]<<d,d+=8}if(n.wrap&4&&u!==(n.check&65535)){e.msg="header crc mismatch",n.mode=tt;break}u=0,d=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=Nr;break;case ay:for(;d<32;){if(l===0)break e;l--,u+=r[a++]<<d,d+=8}e.adler=n.check=xy(u),u=0,d=0,n.mode=Wc;case Wc:if(n.havedict===0)return e.next_out=o,e.avail_out=c,e.next_in=a,e.avail_in=l,n.hold=u,n.bits=d,cR;e.adler=n.check=1,n.mode=Nr;case Nr:if(t===oR||t===Ml)break e;case xd:if(n.last){u>>>=d&7,d-=d&7,n.mode=bd;break}for(;d<3;){if(l===0)break e;l--,u+=r[a++]<<d,d+=8}switch(n.last=u&1,u>>>=1,d-=1,u&3){case 0:n.mode=oy;break;case 1:if(yR(n),n.mode=Ul,t===Ml){u>>>=2,d-=2;break e}break;case 2:n.mode=cy;break;case 3:e.msg="invalid block type",n.mode=tt}u>>>=2,d-=2;break;case oy:for(u>>>=d&7,d-=d&7;d<32;){if(l===0)break e;l--,u+=r[a++]<<d,d+=8}if((u&65535)!==(u>>>16^65535)){e.msg="invalid stored block lengths",n.mode=tt;break}if(n.length=u&65535,u=0,d=0,n.mode=jd,t===Ml)break e;case jd:n.mode=ly;case ly:if(f=n.length,f){if(f>l&&(f=l),f>c&&(f=c),f===0)break e;i.set(r.subarray(a,a+f),o),l-=f,a+=f,c-=f,o+=f,n.length-=f;break}n.mode=Nr;break;case cy:for(;d<14;){if(l===0)break e;l--,u+=r[a++]<<d,d+=8}if(n.nlen=(u&31)+257,u>>>=5,d-=5,n.ndist=(u&31)+1,u>>>=5,d-=5,n.ncode=(u&15)+4,u>>>=4,d-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=tt;break}n.have=0,n.mode=uy;case uy:for(;n.have<n.ncode;){for(;d<3;){if(l===0)break e;l--,u+=r[a++]<<d,d+=8}n.lens[W[n.have++]]=u&7,u>>>=3,d-=3}for(;n.have<19;)n.lens[W[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,D={bits:n.lenbits},C=wo(aR,n.lens,0,19,n.lencode,0,n.work,D),n.lenbits=D.bits,C){e.msg="invalid code lengths set",n.mode=tt;break}n.have=0,n.mode=dy;case dy:for(;n.have<n.nlen+n.ndist;){for(;A=n.lencode[u&(1<<n.lenbits)-1],g=A>>>24,x=A>>>16&255,w=A&65535,!(g<=d);){if(l===0)break e;l--,u+=r[a++]<<d,d+=8}if(w<16)u>>>=g,d-=g,n.lens[n.have++]=w;else{if(w===16){for(U=g+2;d<U;){if(l===0)break e;l--,u+=r[a++]<<d,d+=8}if(u>>>=g,d-=g,n.have===0){e.msg="invalid bit length repeat",n.mode=tt;break}R=n.lens[n.have-1],f=3+(u&3),u>>>=2,d-=2}else if(w===17){for(U=g+3;d<U;){if(l===0)break e;l--,u+=r[a++]<<d,d+=8}u>>>=g,d-=g,R=0,f=3+(u&7),u>>>=3,d-=3}else{for(U=g+7;d<U;){if(l===0)break e;l--,u+=r[a++]<<d,d+=8}u>>>=g,d-=g,R=0,f=11+(u&127),u>>>=7,d-=7}if(n.have+f>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=tt;break}for(;f--;)n.lens[n.have++]=R}}if(n.mode===tt)break;if(n.lens[256]===0){e.msg="invalid code -- missing end-of-block",n.mode=tt;break}if(n.lenbits=9,D={bits:n.lenbits},C=wo(Fb,n.lens,0,n.nlen,n.lencode,0,n.work,D),n.lenbits=D.bits,C){e.msg="invalid literal/lengths set",n.mode=tt;break}if(n.distbits=6,n.distcode=n.distdyn,D={bits:n.distbits},C=wo(Hb,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,D),n.distbits=D.bits,C){e.msg="invalid distances set",n.mode=tt;break}if(n.mode=Ul,t===Ml)break e;case Ul:n.mode=Bl;case Bl:if(l>=6&&c>=258){e.next_out=o,e.avail_out=c,e.next_in=a,e.avail_in=l,n.hold=u,n.bits=d,iR(e,h),o=e.next_out,i=e.output,c=e.avail_out,a=e.next_in,r=e.input,l=e.avail_in,u=n.hold,d=n.bits,n.mode===Nr&&(n.back=-1);break}for(n.back=0;A=n.lencode[u&(1<<n.lenbits)-1],g=A>>>24,x=A>>>16&255,w=A&65535,!(g<=d);){if(l===0)break e;l--,u+=r[a++]<<d,d+=8}if(x&&!(x&240)){for(E=g,_=x,b=w;A=n.lencode[b+((u&(1<<E+_)-1)>>E)],g=A>>>24,x=A>>>16&255,w=A&65535,!(E+g<=d);){if(l===0)break e;l--,u+=r[a++]<<d,d+=8}u>>>=E,d-=E,n.back+=E}if(u>>>=g,d-=g,n.back+=g,n.length=w,x===0){n.mode=gy;break}if(x&32){n.back=-1,n.mode=Nr;break}if(x&64){e.msg="invalid literal/length code",n.mode=tt;break}n.extra=x&15,n.mode=hy;case hy:if(n.extra){for(U=n.extra;d<U;){if(l===0)break e;l--,u+=r[a++]<<d,d+=8}n.length+=u&(1<<n.extra)-1,u>>>=n.extra,d-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=fy;case fy:for(;A=n.distcode[u&(1<<n.distbits)-1],g=A>>>24,x=A>>>16&255,w=A&65535,!(g<=d);){if(l===0)break e;l--,u+=r[a++]<<d,d+=8}if(!(x&240)){for(E=g,_=x,b=w;A=n.distcode[b+((u&(1<<E+_)-1)>>E)],g=A>>>24,x=A>>>16&255,w=A&65535,!(E+g<=d);){if(l===0)break e;l--,u+=r[a++]<<d,d+=8}u>>>=E,d-=E,n.back+=E}if(u>>>=g,d-=g,n.back+=g,x&64){e.msg="invalid distance code",n.mode=tt;break}n.offset=w,n.extra=x&15,n.mode=py;case py:if(n.extra){for(U=n.extra;d<U;){if(l===0)break e;l--,u+=r[a++]<<d,d+=8}n.offset+=u&(1<<n.extra)-1,u>>>=n.extra,d-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=tt;break}n.mode=my;case my:if(c===0)break e;if(f=h-c,n.offset>f){if(f=n.offset-f,f>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=tt;break}f>n.wnext?(f-=n.wnext,y=n.wsize-f):y=n.wnext-f,f>n.length&&(f=n.length),j=n.window}else j=i,y=o-n.offset,f=n.length;f>c&&(f=c),c-=f,n.length-=f;do i[o++]=j[y++];while(--f);n.length===0&&(n.mode=Bl);break;case gy:if(c===0)break e;i[o++]=n.length,c--,n.mode=Bl;break;case bd:if(n.wrap){for(;d<32;){if(l===0)break e;l--,u|=r[a++]<<d,d+=8}if(h-=c,e.total_out+=h,n.total+=h,n.wrap&4&&h&&(e.adler=n.check=n.flags?ar(n.check,i,h,o-h):Gh(n.check,i,h,o-h)),h=c,n.wrap&4&&(n.flags?u:xy(u))!==n.check){e.msg="incorrect data check",n.mode=tt;break}u=0,d=0}n.mode=yy;case yy:if(n.wrap&&n.flags){for(;d<32;){if(l===0)break e;l--,u+=r[a++]<<d,d+=8}if(n.wrap&4&&u!==(n.total&4294967295)){e.msg="incorrect length check",n.mode=tt;break}u=0,d=0}n.mode=vy;case vy:C=lR;break e;case tt:C=qb;break e;case Wb:return zb;case Gb:default:return Dn}return e.next_out=o,e.avail_out=c,e.next_in=a,e.avail_in=l,n.hold=u,n.bits=d,(n.wsize||h!==e.avail_out&&n.mode<tt&&(n.mode<bd||t!==Jg))&&Zb(e,e.output,e.next_out,h-e.avail_out),p-=e.avail_in,h-=e.avail_out,e.total_in+=p,e.total_out+=h,n.total+=h,n.wrap&4&&h&&(e.adler=n.check=n.flags?ar(n.check,i,h,e.next_out-h):Gh(n.check,i,h,e.next_out-h)),e.data_type=n.bits+(n.last?64:0)+(n.mode===Nr?128:0)+(n.mode===Ul||n.mode===jd?256:0),(p===0&&h===0||t===Jg)&&C===mi&&(C=uR),C},xR=e=>{if(ji(e))return Dn;let t=e.state;return t.window&&(t.window=null),e.state=null,mi},jR=(e,t)=>{if(ji(e))return Dn;const n=e.state;return n.wrap&2?(n.head=t,t.done=!1,mi):Dn},bR=(e,t)=>{const n=t.length;let r,i,a;return ji(e)||(r=e.state,r.wrap!==0&&r.mode!==Wc)?Dn:r.mode===Wc&&(i=1,i=Gh(i,t,n,0),i!==r.check)?qb:(a=Zb(e,t,n,n),a?(r.mode=Wb,zb):(r.havedict=1,mi))};er.inflateReset=Kb;er.inflateReset2=Jb;er.inflateResetKeep=Yb;er.inflateInit=gR;er.inflateInit2=Qb;er.inflate=vR;er.inflateEnd=xR;er.inflateGetHeader=jR;er.inflateSetDictionary=bR;er.inflateInfo="pako inflate (from Nodeca project)";function wR(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var SR=wR;const Rr=er,Xb=xu,Yh=ol,Kh=kp,ER=Ub,NR=SR,e0=Object.prototype.toString,{Z_NO_FLUSH:_R,Z_FINISH:AR,Z_OK:Jo,Z_STREAM_END:Ed,Z_NEED_DICT:Nd,Z_STREAM_ERROR:CR,Z_DATA_ERROR:by,Z_MEM_ERROR:kR}=xi;function cl(e){this.options=Xb.assign({chunkSize:1024*64,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(e&&e.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15||(t.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new ER,this.strm.avail_out=0;let n=Rr.inflateInit2(this.strm,t.windowBits);if(n!==Jo)throw new Error(Kh[n]);if(this.header=new NR,Rr.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=Yh.string2buf(t.dictionary):e0.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(n=Rr.inflateSetDictionary(this.strm,t.dictionary),n!==Jo)))throw new Error(Kh[n])}cl.prototype.push=function(e,t){const n=this.strm,r=this.options.chunkSize,i=this.options.dictionary;let a,o,l;if(this.ended)return!1;for(t===~~t?o=t:o=t===!0?AR:_R,e0.call(e)==="[object ArrayBuffer]"?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;){for(n.avail_out===0&&(n.output=new Uint8Array(r),n.next_out=0,n.avail_out=r),a=Rr.inflate(n,o),a===Nd&&i&&(a=Rr.inflateSetDictionary(n,i),a===Jo?a=Rr.inflate(n,o):a===by&&(a=Nd));n.avail_in>0&&a===Ed&&n.state.wrap>0&&e[n.next_in]!==0;)Rr.inflateReset(n),a=Rr.inflate(n,o);switch(a){case CR:case by:case Nd:case kR:return this.onEnd(a),this.ended=!0,!1}if(l=n.avail_out,n.next_out&&(n.avail_out===0||a===Ed))if(this.options.to==="string"){let c=Yh.utf8border(n.output,n.next_out),u=n.next_out-c,d=Yh.buf2string(n.output,c);n.next_out=u,n.avail_out=r-u,u&&n.output.set(n.output.subarray(c,c+u),0),this.onData(d)}else this.onData(n.output.length===n.next_out?n.output:n.output.subarray(0,n.next_out));if(!(a===Jo&&l===0)){if(a===Ed)return a=Rr.inflateEnd(this.strm),this.onEnd(a),this.ended=!0,!0;if(n.avail_in===0)break}}return!0};cl.prototype.onData=function(e){this.chunks.push(e)};cl.prototype.onEnd=function(e){e===Jo&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=Xb.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function Tp(e,t){const n=new cl(t);if(n.push(e),n.err)throw n.msg||Kh[n.err];return n.result}function IR(e,t){return t=t||{},t.raw=!0,Tp(e,t)}Pa.Inflate=cl;Pa.inflate=Tp;Pa.inflateRaw=IR;Pa.ungzip=Tp;Pa.constants=xi;const{Deflate:RR,deflate:TR,deflateRaw:OR,gzip:PR}=ka,{Inflate:LR,inflate:DR,inflateRaw:MR,ungzip:UR}=Pa,BR=xi;jr.Deflate=RR;jr.deflate=TR;jr.deflateRaw=OR;jr.gzip=PR;jr.Inflate=LR;jr.inflate=DR;jr.inflateRaw=MR;jr.ungzip=UR;jr.constants=BR;const VR=new TextEncoder,$R=new TextDecoder("utf-8");function wy(e){return VR.encode(e)}function Jh(e){return $R.decode(e)}function t0(e){if(typeof e!="string")throw new TypeError("value is not a string");if(!/^([0-9a-f][0-9a-f])*$/.test(e))throw new RangeError("value is not hexadecimal");return e===""?new Uint8Array(0):new Uint8Array(e.match(/../g).map(t=>parseInt(t,16)))}const Sy=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],n0=new Array(256);for(let e=0;e<256;e++)n0[e]=`${Sy[e>>>4&15]}${Sy[e&15]}`;function r0(e){let t="",n=e.byteLength;for(let r=0;r<n;r++)t+=n0[e[r]];return t}let Op=class{constructor(){this.buf=new Uint8Array(16),this.offset=0}get buffer(){return this.finish(),this.buf.subarray(0,this.offset)}grow(t=0){let n=this.buf.byteLength*4;for(;n<t;)n*=2;const r=new Uint8Array(n);return r.set(this.buf,0),this.buf=r,this}appendByte(t){this.offset>=this.buf.byteLength&&this.grow(),this.buf[this.offset]=t,this.offset+=1}appendUint32(t){if(!Number.isInteger(t))throw new RangeError("value is not an integer");if(t<0||t>4294967295)throw new RangeError("number out of range");const n=Math.max(1,Math.ceil((32-Math.clz32(t))/7));this.offset+n>this.buf.byteLength&&this.grow();for(let r=0;r<n;r++)this.buf[this.offset+r]=t&127|(r===n-1?0:128),t>>>=7;return this.offset+=n,n}appendInt32(t){if(!Number.isInteger(t))throw new RangeError("value is not an integer");if(t<-2147483648||t>2147483647)throw new RangeError("number out of range");const n=Math.ceil((33-Math.clz32(t>=0?t:-t-1))/7);this.offset+n>this.buf.byteLength&&this.grow();for(let r=0;r<n;r++)this.buf[this.offset+r]=t&127|(r===n-1?0:128),t>>=7;return this.offset+=n,n}appendUint53(t){if(!Number.isInteger(t))throw new RangeError("value is not an integer");if(t<0||t>Number.MAX_SAFE_INTEGER)throw new RangeError("number out of range");const n=Math.floor(t/4294967296),r=(t&4294967295)>>>0;return this.appendUint64(n,r)}appendInt53(t){if(!Number.isInteger(t))throw new RangeError("value is not an integer");if(t<Number.MIN_SAFE_INTEGER||t>Number.MAX_SAFE_INTEGER)throw new RangeError("number out of range");const n=Math.floor(t/4294967296),r=(t&4294967295)>>>0;return this.appendInt64(n,r)}appendUint64(t,n){if(!Number.isInteger(t)||!Number.isInteger(n))throw new RangeError("value is not an integer");if(t<0||t>4294967295||n<0||n>4294967295)throw new RangeError("number out of range");if(t===0)return this.appendUint32(n);const r=Math.ceil((64-Math.clz32(t))/7);this.offset+r>this.buf.byteLength&&this.grow();for(let i=0;i<4;i++)this.buf[this.offset+i]=n&127|128,n>>>=7;this.buf[this.offset+4]=n&15|(t&7)<<4|(r===5?0:128),t>>>=3;for(let i=5;i<r;i++)this.buf[this.offset+i]=t&127|(i===r-1?0:128),t>>>=7;return this.offset+=r,r}appendInt64(t,n){if(!Number.isInteger(t)||!Number.isInteger(n))throw new RangeError("value is not an integer");if(t<-2147483648||t>2147483647||n<-2147483648||n>4294967295)throw new RangeError("number out of range");if(n>>>=0,t===0&&n<=2147483647)return this.appendInt32(n);if(t===-1&&n>=2147483648)return this.appendInt32(n-4294967296);const r=Math.ceil((65-Math.clz32(t>=0?t:-t-1))/7);this.offset+r>this.buf.byteLength&&this.grow();for(let i=0;i<4;i++)this.buf[this.offset+i]=n&127|128,n>>>=7;this.buf[this.offset+4]=n&15|(t&7)<<4|(r===5?0:128),t>>=3;for(let i=5;i<r;i++)this.buf[this.offset+i]=t&127|(i===r-1?0:128),t>>=7;return this.offset+=r,r}appendRawBytes(t){return this.offset+t.byteLength>this.buf.byteLength&&this.grow(this.offset+t.byteLength),this.buf.set(t,this.offset),this.offset+=t.byteLength,t.byteLength}appendRawString(t){if(typeof t!="string")throw new TypeError("value is not a string");return this.appendRawBytes(wy(t))}appendPrefixedBytes(t){return this.appendUint53(t.byteLength),this.appendRawBytes(t),this}appendPrefixedString(t){if(typeof t!="string")throw new TypeError("value is not a string");return this.appendPrefixedBytes(wy(t)),this}appendHexString(t){return this.appendPrefixedBytes(t0(t)),this}finish(){}},Pp=class{constructor(t){if(!(t instanceof Uint8Array))throw new TypeError(`Not a byte array: ${t}`);this.buf=t,this.offset=0}get done(){return this.offset===this.buf.byteLength}reset(){this.offset=0}skip(t){if(this.offset+t>this.buf.byteLength)throw new RangeError("cannot skip beyond end of buffer");this.offset+=t}readByte(){return this.offset+=1,this.buf[this.offset-1]}readUint32(){let t=0,n=0;for(;this.offset<this.buf.byteLength;){const r=this.buf[this.offset];if(n===28&&r&240)throw new RangeError("number out of range");if(t=(t|(r&127)<<n)>>>0,n+=7,this.offset++,!(r&128))return t}throw new RangeError("buffer ended with incomplete number")}readInt32(){let t=0,n=0;for(;this.offset<this.buf.byteLength;){const r=this.buf[this.offset];if(n===28&&r&128||n===28&&!(r&64)&&r&56||n===28&&r&64&&(r&56)!==56)throw new RangeError("number out of range");if(t|=(r&127)<<n,n+=7,this.offset++,!(r&128))return!(r&64)||n>28?t:t|-1<<n}throw new RangeError("buffer ended with incomplete number")}readUint53(){const{low32:t,high32:n}=this.readUint64();if(n<0||n>2097151)throw new RangeError("number out of range");return n*4294967296+t}readInt53(){const{low32:t,high32:n}=this.readInt64();if(n<-2097152||n===-2097152&&t===0||n>2097151)throw new RangeError("number out of range");return n*4294967296+t}readUint64(){let t=0,n=0,r=0;for(;this.offset<this.buf.byteLength&&r<=28;){const i=this.buf[this.offset];if(t=(t|(i&127)<<r)>>>0,r===28&&(n=(i&112)>>>4),r+=7,this.offset++,!(i&128))return{high32:n,low32:t}}for(r=3;this.offset<this.buf.byteLength;){const i=this.buf[this.offset];if(r===31&&i&254)throw new RangeError("number out of range");if(n=(n|(i&127)<<r)>>>0,r+=7,this.offset++,!(i&128))return{high32:n,low32:t}}throw new RangeError("buffer ended with incomplete number")}readInt64(){let t=0,n=0,r=0;for(;this.offset<this.buf.byteLength&&r<=28;){const i=this.buf[this.offset];if(t=(t|(i&127)<<r)>>>0,r===28&&(n=(i&112)>>>4),r+=7,this.offset++,!(i&128))return i&64&&(r<32&&(t=(t|-1<<r)>>>0),n|=-1<<Math.max(r-32,0)),{high32:n,low32:t}}for(r=3;this.offset<this.buf.byteLength;){const i=this.buf[this.offset];if(r===31&&i!==0&&i!==127)throw new RangeError("number out of range");if(n|=(i&127)<<r,r+=7,this.offset++,!(i&128))return i&64&&r<32&&(n|=-1<<r),{high32:n,low32:t}}throw new RangeError("buffer ended with incomplete number")}readRawBytes(t){const n=this.offset;if(n+t>this.buf.byteLength)throw new RangeError("subarray exceeds buffer size");return this.offset+=t,this.buf.subarray(n,this.offset)}readRawString(t){return Jh(this.readRawBytes(t))}readPrefixedBytes(){return this.readRawBytes(this.readUint53())}readPrefixedString(){return Jh(this.readPrefixedBytes())}readHexString(){return r0(this.readPrefixedBytes())}},s0=class extends Op{constructor(t){super(),this.type=t,this.state="empty",this.lastValue=void 0,this.count=0,this.literal=[]}appendValue(t,n=1){this._appendValue(t,n)}_appendValue(t,n=1){n<=0||(this.state==="empty"?(this.state=t===null?"nulls":n===1?"loneValue":"repetition",this.lastValue=t,this.count=n):this.state==="loneValue"?t===null?(this.flush(),this.state="nulls",this.count=n):t===this.lastValue?(this.state="repetition",this.count=1+n):n>1?(this.flush(),this.state="repetition",this.count=n,this.lastValue=t):(this.state="literal",this.literal=[this.lastValue],this.lastValue=t):this.state==="repetition"?t===null?(this.flush(),this.state="nulls",this.count=n):t===this.lastValue?this.count+=n:n>1?(this.flush(),this.state="repetition",this.count=n,this.lastValue=t):(this.flush(),this.state="loneValue",this.lastValue=t):this.state==="literal"?t===null?(this.literal.push(this.lastValue),this.flush(),this.state="nulls",this.count=n):t===this.lastValue?(this.flush(),this.state="repetition",this.count=1+n):n>1?(this.literal.push(this.lastValue),this.flush(),this.state="repetition",this.count=n,this.lastValue=t):(this.literal.push(this.lastValue),this.lastValue=t):this.state==="nulls"&&(t===null?this.count+=n:n>1?(this.flush(),this.state="repetition",this.count=n,this.lastValue=t):(this.flush(),this.state="loneValue",this.lastValue=t)))}copyFrom(t,n={}){const{count:r,sumValues:i,sumShift:a}=n;if(!(t instanceof Lp)||t.type!==this.type)throw new TypeError("incompatible type of decoder");let o=typeof r=="number"?r:Number.MAX_SAFE_INTEGER,l=0,c=0;if(r&&o>0&&t.done)throw new RangeError(`cannot copy ${r} values`);if(o===0||t.done)return i?{nonNullValues:l,sum:c}:{nonNullValues:l};let u=t.readValue();if(u===null){const p=Math.min(t.count+1,o);if(o-=p,t.count-=p-1,this.appendValue(null,p),r&&o>0&&t.done)throw new RangeError(`cannot copy ${r} values`);if(o===0||t.done)return i?{nonNullValues:l,sum:c}:{nonNullValues:l};if(u=t.readValue(),u===null)throw new RangeError("null run must be followed by non-null value")}if(this.appendValue(u),o--,l++,i&&(c+=a?u>>>a:u),r&&o>0&&t.done)throw new RangeError(`cannot copy ${r} values`);if(o===0||t.done)return i?{nonNullValues:l,sum:c}:{nonNullValues:l};let d=t.count>0;for(;o>0&&!t.done;){d||t.readRecord();const p=Math.min(t.count,o);if(t.count-=p,t.state==="literal"){l+=p;for(let h=0;h<p;h++){if(t.done)throw new RangeError("incomplete literal");const f=t.readRawValue();if(f===t.lastValue)throw new RangeError("Repetition of values is not allowed in literal");t.lastValue=f,this._appendValue(f),i&&(c+=a?f>>>a:f)}}else if(t.state==="repetition"){l+=p,i&&(c+=p*(a?t.lastValue>>>a:t.lastValue));const h=t.lastValue;if(this._appendValue(h),p>1){if(this._appendValue(h),this.state!=="repetition")throw new RangeError(`Unexpected state ${this.state}`);this.count+=p-2}}else if(t.state==="nulls"){if(this._appendValue(null),this.state!=="nulls")throw new RangeError(`Unexpected state ${this.state}`);this.count+=p-1}d=!1,o-=p}if(r&&o>0&&t.done)throw new RangeError(`cannot copy ${r} values`);return i?{nonNullValues:l,sum:c}:{nonNullValues:l}}flush(){if(this.state==="loneValue")this.appendInt32(-1),this.appendRawValue(this.lastValue);else if(this.state==="repetition")this.appendInt53(this.count),this.appendRawValue(this.lastValue);else if(this.state==="literal"){this.appendInt53(-this.literal.length);for(let t of this.literal)this.appendRawValue(t)}else this.state==="nulls"&&(this.appendInt32(0),this.appendUint53(this.count));this.state="empty"}appendRawValue(t){if(this.type==="int")this.appendInt53(t);else if(this.type==="uint")this.appendUint53(t);else if(this.type==="utf8")this.appendPrefixedString(t);else throw new RangeError(`Unknown RLEEncoder datatype: ${this.type}`)}finish(){this.state==="literal"&&this.literal.push(this.lastValue),(this.state!=="nulls"||this.offset>0)&&this.flush()}},Lp=class extends Pp{constructor(t,n){super(n),this.type=t,this.lastValue=void 0,this.count=0,this.state=void 0}get done(){return this.count===0&&this.offset===this.buf.byteLength}reset(){this.offset=0,this.lastValue=void 0,this.count=0,this.state=void 0}readValue(){if(this.done)return null;if(this.count===0&&this.readRecord(),this.count-=1,this.state==="literal"){const t=this.readRawValue();if(t===this.lastValue)throw new RangeError("Repetition of values is not allowed in literal");return this.lastValue=t,t}else return this.lastValue}skipValues(t){for(;t>0&&!this.done;){this.count===0&&(this.count=this.readInt53(),this.count>0?(this.lastValue=this.count<=t?this.skipRawValues(1):this.readRawValue(),this.state="repetition"):this.count<0?(this.count=-this.count,this.state="literal"):(this.count=this.readUint53(),this.lastValue=null,this.state="nulls"));const n=Math.min(t,this.count);this.state==="literal"&&this.skipRawValues(n),t-=n,this.count-=n}}readRecord(){if(this.count=this.readInt53(),this.count>1){const t=this.readRawValue();if((this.state==="repetition"||this.state==="literal")&&this.lastValue===t)throw new RangeError("Successive repetitions with the same value are not allowed");this.state="repetition",this.lastValue=t}else{if(this.count===1)throw new RangeError("Repetition count of 1 is not allowed, use a literal instead");if(this.count<0){if(this.count=-this.count,this.state==="literal")throw new RangeError("Successive literals are not allowed");this.state="literal"}else{if(this.state==="nulls")throw new RangeError("Successive null runs are not allowed");if(this.count=this.readUint53(),this.count===0)throw new RangeError("Zero-length null runs are not allowed");this.lastValue=null,this.state="nulls"}}}readRawValue(){if(this.type==="int")return this.readInt53();if(this.type==="uint")return this.readUint53();if(this.type==="utf8")return this.readPrefixedString();throw new RangeError(`Unknown RLEDecoder datatype: ${this.type}`)}skipRawValues(t){if(this.type==="utf8")for(let n=0;n<t;n++)this.skip(this.readUint53());else{for(;t>0&&this.offset<this.buf.byteLength;)this.buf[this.offset]&128||t--,this.offset++;if(t>0)throw new RangeError("cannot skip beyond end of buffer")}}},FR=class extends s0{constructor(){super("int"),this.absoluteValue=0}appendValue(t,n=1){n<=0||(typeof t=="number"?(super.appendValue(t-this.absoluteValue,1),this.absoluteValue=t,n>1&&super.appendValue(0,n-1)):super.appendValue(t,n))}copyFrom(t,n={}){if(n.sumValues)throw new RangeError("unsupported options for DeltaEncoder.copyFrom()");if(!(t instanceof i0))throw new TypeError("incompatible type of decoder");let r=n.count;if(r>0&&t.done)throw new RangeError(`cannot copy ${r} values`);if(r===0||t.done)return;let i=t.readValue(),a=0;if(this.appendValue(i),i===null){if(a=t.count+1,r!==void 0&&r<a&&(a=r),t.count-=a-1,this.count+=a-1,r>a&&t.done)throw new RangeError(`cannot copy ${r} values`);if(r===a||t.done)return;t.count===0&&this.appendValue(t.readValue())}r!==void 0&&(r-=a+1);const{nonNullValues:o,sum:l}=super.copyFrom(t,{count:r,sumValues:!0});o>0&&(this.absoluteValue=l,t.absoluteValue=l)}},i0=class extends Lp{constructor(t){super("int",t),this.absoluteValue=0}reset(){this.offset=0,this.lastValue=void 0,this.count=0,this.state=void 0,this.absoluteValue=0}readValue(){const t=super.readValue();return t===null?null:(this.absoluteValue+=t,this.absoluteValue)}skipValues(t){for(;t>0&&!this.done;){this.count===0&&this.readRecord();const n=Math.min(t,this.count);if(this.state==="literal")for(let r=0;r<n;r++)this.lastValue=this.readRawValue(),this.absoluteValue+=this.lastValue;else this.state==="repetition"&&(this.absoluteValue+=n*this.lastValue);t-=n,this.count-=n}}},HR=class extends Op{constructor(){super(),this.lastValue=!1,this.count=0}appendValue(t,n=1){if(t!==!1&&t!==!0)throw new RangeError(`Unsupported value for BooleanEncoder: ${t}`);n<=0||(this.lastValue===t?this.count+=n:(this.appendUint53(this.count),this.lastValue=t,this.count=n))}copyFrom(t,n={}){if(!(t instanceof a0))throw new TypeError("incompatible type of decoder");const{count:r}=n;let i=typeof r=="number"?r:Number.MAX_SAFE_INTEGER;if(r&&i>0&&t.done)throw new RangeError(`cannot copy ${r} values`);if(i===0||t.done)return;this.appendValue(t.readValue()),i--;const a=Math.min(t.count,i);for(this.count+=a,t.count-=a,i-=a;i>0&&!t.done;){if(t.count=t.readUint53(),t.count===0)throw new RangeError("Zero-length runs are not allowed");t.lastValue=!t.lastValue,this.appendUint53(this.count);const o=Math.min(t.count,i);this.count=o,this.lastValue=t.lastValue,t.count-=o,i-=o}if(r&&i>0&&t.done)throw new RangeError(`cannot copy ${r} values`)}finish(){this.count>0&&(this.appendUint53(this.count),this.count=0)}},a0=class extends Pp{constructor(t){super(t),this.lastValue=!0,this.firstRun=!0,this.count=0}get done(){return this.count===0&&this.offset===this.buf.byteLength}reset(){this.offset=0,this.lastValue=!0,this.firstRun=!0,this.count=0}readValue(){if(this.done)return!1;for(;this.count===0;){if(this.count=this.readUint53(),this.lastValue=!this.lastValue,this.count===0&&!this.firstRun)throw new RangeError("Zero-length runs are not allowed");this.firstRun=!1}return this.count-=1,this.lastValue}skipValues(t){for(;t>0&&!this.done;){if(this.count===0){if(this.count=this.readUint53(),this.lastValue=!this.lastValue,this.count===0&&!this.firstRun)throw new RangeError("Zero-length runs are not allowed");this.firstRun=!1}this.count<t?(t-=this.count,this.count=0):(this.count-=t,t=0)}}};var o0={utf8ToString:Jh,hexStringToBytes:t0,bytesToHexString:r0,Encoder:Op,Decoder:Pp,RLEEncoder:s0,RLEDecoder:Lp,DeltaEncoder:FR,DeltaDecoder:i0,BooleanEncoder:HR,BooleanDecoder:a0},l0={exports:{}};(function(e){(function(t,n){var r={};n(r);var i=r.default;for(var a in r)i[a]=r[a];e.exports=i})(Xa,function(t){t.__esModule=!0,t.digestLength=32,t.blockSize=64;var n=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function r(h,f,y,j,A){for(var g,x,w,E,_,b,R,C,T,D,U,W,q;A>=64;){for(g=f[0],x=f[1],w=f[2],E=f[3],_=f[4],b=f[5],R=f[6],C=f[7],D=0;D<16;D++)U=j+D*4,h[D]=(y[U]&255)<<24|(y[U+1]&255)<<16|(y[U+2]&255)<<8|y[U+3]&255;for(D=16;D<64;D++)T=h[D-2],W=(T>>>17|T<<15)^(T>>>19|T<<13)^T>>>10,T=h[D-15],q=(T>>>7|T<<25)^(T>>>18|T<<14)^T>>>3,h[D]=(W+h[D-7]|0)+(q+h[D-16]|0);for(D=0;D<64;D++)W=(((_>>>6|_<<26)^(_>>>11|_<<21)^(_>>>25|_<<7))+(_&b^~_&R)|0)+(C+(n[D]+h[D]|0)|0)|0,q=((g>>>2|g<<30)^(g>>>13|g<<19)^(g>>>22|g<<10))+(g&x^g&w^x&w)|0,C=R,R=b,b=_,_=E+W|0,E=w,w=x,x=g,g=W+q|0;f[0]+=g,f[1]+=x,f[2]+=w,f[3]+=E,f[4]+=_,f[5]+=b,f[6]+=R,f[7]+=C,j+=64,A-=64}return j}var i=function(){function h(){this.digestLength=t.digestLength,this.blockSize=t.blockSize,this.state=new Int32Array(8),this.temp=new Int32Array(64),this.buffer=new Uint8Array(128),this.bufferLength=0,this.bytesHashed=0,this.finished=!1,this.reset()}return h.prototype.reset=function(){return this.state[0]=1779033703,this.state[1]=3144134277,this.state[2]=1013904242,this.state[3]=2773480762,this.state[4]=1359893119,this.state[5]=2600822924,this.state[6]=528734635,this.state[7]=1541459225,this.bufferLength=0,this.bytesHashed=0,this.finished=!1,this},h.prototype.clean=function(){for(var f=0;f<this.buffer.length;f++)this.buffer[f]=0;for(var f=0;f<this.temp.length;f++)this.temp[f]=0;this.reset()},h.prototype.update=function(f,y){if(y===void 0&&(y=f.length),this.finished)throw new Error("SHA256: can't update because hash was finished.");var j=0;if(this.bytesHashed+=y,this.bufferLength>0){for(;this.bufferLength<64&&y>0;)this.buffer[this.bufferLength++]=f[j++],y--;this.bufferLength===64&&(r(this.temp,this.state,this.buffer,0,64),this.bufferLength=0)}for(y>=64&&(j=r(this.temp,this.state,f,j,y),y%=64);y>0;)this.buffer[this.bufferLength++]=f[j++],y--;return this},h.prototype.finish=function(f){if(!this.finished){var y=this.bytesHashed,j=this.bufferLength,A=y/536870912|0,g=y<<3,x=y%64<56?64:128;this.buffer[j]=128;for(var w=j+1;w<x-8;w++)this.buffer[w]=0;this.buffer[x-8]=A>>>24&255,this.buffer[x-7]=A>>>16&255,this.buffer[x-6]=A>>>8&255,this.buffer[x-5]=A>>>0&255,this.buffer[x-4]=g>>>24&255,this.buffer[x-3]=g>>>16&255,this.buffer[x-2]=g>>>8&255,this.buffer[x-1]=g>>>0&255,r(this.temp,this.state,this.buffer,0,x),this.finished=!0}for(var w=0;w<8;w++)f[w*4+0]=this.state[w]>>>24&255,f[w*4+1]=this.state[w]>>>16&255,f[w*4+2]=this.state[w]>>>8&255,f[w*4+3]=this.state[w]>>>0&255;return this},h.prototype.digest=function(){var f=new Uint8Array(this.digestLength);return this.finish(f),f},h.prototype._saveState=function(f){for(var y=0;y<this.state.length;y++)f[y]=this.state[y]},h.prototype._restoreState=function(f,y){for(var j=0;j<this.state.length;j++)this.state[j]=f[j];this.bytesHashed=y,this.finished=!1,this.bufferLength=0},h}();t.Hash=i;var a=function(){function h(f){this.inner=new i,this.outer=new i,this.blockSize=this.inner.blockSize,this.digestLength=this.inner.digestLength;var y=new Uint8Array(this.blockSize);if(f.length>this.blockSize)new i().update(f).finish(y).clean();else for(var j=0;j<f.length;j++)y[j]=f[j];for(var j=0;j<y.length;j++)y[j]^=54;this.inner.update(y);for(var j=0;j<y.length;j++)y[j]^=106;this.outer.update(y),this.istate=new Uint32Array(8),this.ostate=new Uint32Array(8),this.inner._saveState(this.istate),this.outer._saveState(this.ostate);for(var j=0;j<y.length;j++)y[j]=0}return h.prototype.reset=function(){return this.inner._restoreState(this.istate,this.inner.blockSize),this.outer._restoreState(this.ostate,this.outer.blockSize),this},h.prototype.clean=function(){for(var f=0;f<this.istate.length;f++)this.ostate[f]=this.istate[f]=0;this.inner.clean(),this.outer.clean()},h.prototype.update=function(f){return this.inner.update(f),this},h.prototype.finish=function(f){return this.outer.finished?this.outer.finish(f):(this.inner.finish(f),this.outer.update(f,this.digestLength).finish(f)),this},h.prototype.digest=function(){var f=new Uint8Array(this.digestLength);return this.finish(f),f},h}();t.HMAC=a;function o(h){var f=new i().update(h),y=f.digest();return f.clean(),y}t.hash=o,t.default=o;function l(h,f){var y=new a(h).update(f),j=y.digest();return y.clean(),j}t.hmac=l;function c(h,f,y,j){var A=j[0];if(A===0)throw new Error("hkdf: cannot expand more");f.reset(),A>1&&f.update(h),y&&f.update(y),f.update(j),f.finish(h),j[0]++}var u=new Uint8Array(t.digestLength);function d(h,f,y,j){f===void 0&&(f=u),j===void 0&&(j=32);for(var A=new Uint8Array([1]),g=l(f,h),x=new a(g),w=new Uint8Array(x.digestLength),E=w.length,_=new Uint8Array(j),b=0;b<j;b++)E===w.length&&(c(w,x,y,A),E=0),_[b]=w[E++];return x.clean(),w.fill(0),A.fill(0),_}t.hkdf=d;function p(h,f,y,j){for(var A=new a(h),g=A.digestLength,x=new Uint8Array(4),w=new Uint8Array(g),E=new Uint8Array(g),_=new Uint8Array(j),b=0;b*g<j;b++){var R=b+1;x[0]=R>>>24&255,x[1]=R>>>16&255,x[2]=R>>>8&255,x[3]=R>>>0&255,A.reset(),A.update(f),A.update(x),A.finish(E);for(var C=0;C<g;C++)w[C]=E[C];for(var C=2;C<=y;C++){A.reset(),A.update(E).finish(E);for(var T=0;T<g;T++)w[T]^=E[T]}for(var C=0;C<g&&b*g+C<j;C++)_[b*g+C]=w[C]}for(var b=0;b<g;b++)w[b]=E[b]=0;for(var b=0;b<4;b++)x[b]=0;return A.clean(),_}t.pbkdf2=p})})(l0);var qR=l0.exports;const bu=jr,{copyObject:Ey,parseOpId:Lr,equalBytes:Ny}=xr,{utf8ToString:zR,hexStringToBytes:c0,bytesToHexString:wu,Encoder:ya,Decoder:ln,RLEEncoder:Fn,RLEDecoder:_y,DeltaEncoder:cc,DeltaDecoder:WR,BooleanEncoder:u0,BooleanDecoder:GR}=o0,{Hash:d0}=qR,Ki=new Uint8Array([133,111,74,131]),Dp=0,La=1,ul=2,h0=256,_e={GROUP_CARD:0,ACTOR_ID:1,INT_RLE:2,INT_DELTA:3,BOOLEAN:4,STRING_RLE:5,VALUE_LEN:6,VALUE_RAW:7},Qo=8,Ye={NULL:0,FALSE:1,TRUE:2,LEB128_UINT:3,LEB128_INT:4,IEEE754:5,UTF8:6,BYTES:7,COUNTER:8,TIMESTAMP:9,MIN_UNKNOWN:10,MAX_UNKNOWN:15},So=["makeMap","set","makeList","del","makeText","inc","makeTable","link"],YR={makeMap:"map",makeList:"list",makeText:"text",makeTable:"table"},f0=[{columnName:"objActor",columnId:0|_e.ACTOR_ID},{columnName:"objCtr",columnId:0|_e.INT_RLE},{columnName:"keyActor",columnId:16|_e.ACTOR_ID},{columnName:"keyCtr",columnId:16|_e.INT_DELTA},{columnName:"keyStr",columnId:16|_e.STRING_RLE},{columnName:"idActor",columnId:32|_e.ACTOR_ID},{columnName:"idCtr",columnId:32|_e.INT_DELTA},{columnName:"insert",columnId:48|_e.BOOLEAN},{columnName:"action",columnId:64|_e.INT_RLE},{columnName:"valLen",columnId:80|_e.VALUE_LEN},{columnName:"valRaw",columnId:80|_e.VALUE_RAW},{columnName:"chldActor",columnId:96|_e.ACTOR_ID},{columnName:"chldCtr",columnId:96|_e.INT_DELTA}],Mp=f0.concat([{columnName:"predNum",columnId:112|_e.GROUP_CARD},{columnName:"predActor",columnId:112|_e.ACTOR_ID},{columnName:"predCtr",columnId:112|_e.INT_DELTA}]),p0=f0.concat([{columnName:"succNum",columnId:128|_e.GROUP_CARD},{columnName:"succActor",columnId:128|_e.ACTOR_ID},{columnName:"succCtr",columnId:128|_e.INT_DELTA}]),m0=[{columnName:"actor",columnId:0|_e.ACTOR_ID},{columnName:"seq",columnId:0|_e.INT_DELTA},{columnName:"maxOp",columnId:16|_e.INT_DELTA},{columnName:"time",columnId:32|_e.INT_DELTA},{columnName:"message",columnId:48|_e.STRING_RLE},{columnName:"depsNum",columnId:64|_e.GROUP_CARD},{columnName:"depsIndex",columnId:64|_e.INT_DELTA},{columnName:"extraLen",columnId:80|_e.VALUE_LEN},{columnName:"extraRaw",columnId:80|_e.VALUE_RAW}];function Vl(e,t){if(!e||!e.actorId)return e;const n=e.counter,r=t.indexOf(e.actorId);if(r<0)throw new RangeError("missing actorId");return{counter:n,actorNum:r,actorId:e.actorId}}function g0(e,t){return e.counter<t.counter?-1:e.counter>t.counter?1:e.actorId<t.actorId?-1:e.actorId>t.actorId?1:0}function KR(e,t){const n={},r=[];for(let a of e)a=Ey(a),n[a.actor]=!0,a.ops=rT(a.ops,a.startOp,a.actor),a.ops=a.ops.map(o=>{o=Ey(o),o.obj!=="_root"&&(o.obj=Lr(o.obj)),o.elemId&&o.elemId!=="_head"&&(o.elemId=Lr(o.elemId)),o.child&&(o.child=Lr(o.child)),o.pred&&(o.pred=o.pred.map(Lr)),o.obj.actorId&&(n[o.obj.actorId]=!0),o.elemId&&o.elemId.actorId&&(n[o.elemId.actorId]=!0),o.child&&o.child.actorId&&(n[o.child.actorId]=!0);for(let l of o.pred)n[l.actorId]=!0;return o}),r.push(a);let i=Object.keys(n).sort();i=[e[0].actor].concat(i.filter(a=>a!==e[0].actor));for(let a of r){a.actorNum=i.indexOf(a.actor);for(let o=0;o<a.ops.length;o++){let l=a.ops[o];l.id={counter:a.startOp+o,actorNum:a.actorNum,actorId:a.actor},l.obj=Vl(l.obj,i),l.elemId=Vl(l.elemId,i),l.child=Vl(l.child,i),l.pred=l.pred.map(c=>Vl(c,i))}}return{changes:r,actorIds:i}}function JR(e,t){if(e.obj==="_root")t.objActor.appendValue(null),t.objCtr.appendValue(null);else if(e.obj.actorNum>=0&&e.obj.counter>0)t.objActor.appendValue(e.obj.actorNum),t.objCtr.appendValue(e.obj.counter);else throw new RangeError(`Unexpected objectId reference: ${JSON.stringify(e.obj)}`)}function QR(e,t){if(e.key)t.keyActor.appendValue(null),t.keyCtr.appendValue(null),t.keyStr.appendValue(e.key);else if(e.elemId==="_head"&&e.insert)t.keyActor.appendValue(null),t.keyCtr.appendValue(0),t.keyStr.appendValue(null);else if(e.elemId&&e.elemId.actorNum>=0&&e.elemId.counter>0)t.keyActor.appendValue(e.elemId.actorNum),t.keyCtr.appendValue(e.elemId.counter),t.keyStr.appendValue(null);else throw new RangeError(`Unexpected operation key: ${JSON.stringify(e)}`)}function ZR(e,t){const n=So.indexOf(e.action);if(n>=0)t.action.appendValue(n);else if(typeof e.action=="number")t.action.appendValue(e.action);else throw new RangeError(`Unexpected operation action: ${e.action}`)}function XR(e){switch(e.datatype){case"counter":return[Ye.COUNTER,e.value];case"timestamp":return[Ye.TIMESTAMP,e.value];case"uint":return[Ye.LEB128_UINT,e.value];case"int":return[Ye.LEB128_INT,e.value];case"float64":{const t=new ArrayBuffer(8);return new DataView(t).setFloat64(0,e.value,!0),[Ye.IEEE754,new Uint8Array(t)]}default:if(Number.isInteger(e.value)&&e.value<=Number.MAX_SAFE_INTEGER&&e.value>=Number.MIN_SAFE_INTEGER)return[Ye.LEB128_INT,e.value];{const t=new ArrayBuffer(8);return new DataView(t).setFloat64(0,e.value,!0),[Ye.IEEE754,new Uint8Array(t)]}}}function eT(e,t){if(e.action!=="set"&&e.action!=="inc"||e.value===null)t.valLen.appendValue(Ye.NULL);else if(e.value===!1)t.valLen.appendValue(Ye.FALSE);else if(e.value===!0)t.valLen.appendValue(Ye.TRUE);else if(typeof e.value=="string"){const n=t.valRaw.appendRawString(e.value);t.valLen.appendValue(n<<4|Ye.UTF8)}else if(ArrayBuffer.isView(e.value)){const n=t.valRaw.appendRawBytes(new Uint8Array(e.value.buffer));t.valLen.appendValue(n<<4|Ye.BYTES)}else if(typeof e.value=="number"){let[n,r]=XR(e),i;n===Ye.LEB128_UINT?i=t.valRaw.appendUint53(r):n===Ye.IEEE754?i=t.valRaw.appendRawBytes(r):i=t.valRaw.appendInt53(r),t.valLen.appendValue(i<<4|n)}else if(typeof e.datatype=="number"&&e.datatype>=Ye.MIN_UNKNOWN&&e.datatype<=Ye.MAX_UNKNOWN&&e.value instanceof Uint8Array){const n=t.valRaw.appendRawBytes(e.value);t.valLen.appendValue(n<<4|e.datatype)}else throw e.datatype?new RangeError(`Unknown datatype ${e.datatype} for value ${e.value}`):new RangeError(`Unsupported value in operation: ${e.value}`)}function y0(e,t){if(e===Ye.NULL)return{value:null};if(e===Ye.FALSE)return{value:!1};if(e===Ye.TRUE)return{value:!0};if(e%16===Ye.UTF8)return{value:zR(t)};if(e%16===Ye.LEB128_UINT)return{value:new ln(t).readUint53(),datatype:"uint"};if(e%16===Ye.LEB128_INT)return{value:new ln(t).readInt53(),datatype:"int"};if(e%16===Ye.IEEE754){const n=new DataView(t.buffer,t.byteOffset,t.byteLength);if(t.byteLength===8)return{value:n.getFloat64(0,!0),datatype:"float64"};throw new RangeError(`Invalid length for floating point number: ${t.byteLength}`)}else return e%16===Ye.COUNTER?{value:new ln(t).readInt53(),datatype:"counter"}:e%16===Ye.TIMESTAMP?{value:new ln(t).readInt53(),datatype:"timestamp"}:{value:t,datatype:e%16}}function Ay(e,t,n,r){const{columnId:i,columnName:a,decoder:o}=e[t];if(i%8===_e.VALUE_LEN&&t+1<e.length&&e[t+1].columnId===i+1){const l=o.readValue(),c=e[t+1].decoder.readRawBytes(l>>4),{value:u,datatype:d}=y0(l,c);return r[a]=u,d&&(r[a+"_datatype"]=d),2}else if(i%8===_e.ACTOR_ID){const l=o.readValue();if(l===null)r[a]=null;else{if(!n[l])throw new RangeError(`No actor index ${l}`);r[a]=n[l]}}else r[a]=o.readValue();return 1}function tT(e,t){const n={objActor:new Fn("uint"),objCtr:new Fn("uint"),keyActor:new Fn("uint"),keyCtr:new cc,keyStr:new Fn("utf8"),insert:new u0,action:new Fn("uint"),valLen:new Fn("uint"),valRaw:new ya,chldActor:new Fn("uint"),chldCtr:new cc};n.predNum=new Fn("uint"),n.predCtr=new cc,n.predActor=new Fn("uint");for(let i of e){JR(i,n),QR(i,n),n.insert.appendValue(!!i.insert),ZR(i,n),eT(i,n),i.child&&i.child.counter?(n.chldActor.appendValue(i.child.actorNum),n.chldCtr.appendValue(i.child.counter)):(n.chldActor.appendValue(null),n.chldCtr.appendValue(null));{n.predNum.appendValue(i.pred.length),i.pred.sort(g0);for(let a=0;a<i.pred.length;a++)n.predActor.appendValue(i.pred[a].actorNum),n.predCtr.appendValue(i.pred[a].counter)}}let r=[];for(let{columnName:i,columnId:a}of Mp)n[i]&&r.push({columnId:a,columnName:i,encoder:n[i]});return r.sort((i,a)=>i.columnId-a.columnId)}function nT(e,t){return t===void 0?typeof e=="string"||typeof e=="boolean"||e===null:typeof e=="number"}function rT(e,t,n){let r=t,i=[];for(const a of e)if(a.action==="set"&&a.values&&a.insert){if(a.pred.length!==0)throw new RangeError("multi-insert pred must be empty");let o=a.elemId;const l=a.datatype;for(const c of a.values){if(!nT(c,l))throw new RangeError(`Decode failed: bad value/datatype association (${c},${l})`);i.push({action:"set",obj:a.obj,elemId:o,datatype:l,value:c,pred:[],insert:!0}),o=`${r}@${n}`,r+=1}}else if(a.action==="del"&&a.multiOp>1){if(a.pred.length!==1)throw new RangeError("multiOp deletion must have exactly one pred");const o=Lr(a.elemId),l=Lr(a.pred[0]);for(let c=0;c<a.multiOp;c++){const u=`${o.counter+c}@${o.actorId}`,d=[`${l.counter+c}@${l.actorId}`];i.push({action:"del",obj:a.obj,elemId:u,pred:d}),r+=1}}else i.push(a),r+=1;return i}function v0(e,t){const n=[];for(let r of e){const i=r.objCtr===null?"_root":`${r.objCtr}@${r.objActor}`,a=r.keyStr?void 0:r.keyCtr===0?"_head":`${r.keyCtr}@${r.keyActor}`,o=So[r.action]||r.action,l=a?{obj:i,elemId:a,action:o}:{obj:i,key:r.keyStr,action:o};if(l.insert=!!r.insert,(So[r.action]==="set"||So[r.action]==="inc")&&(l.value=r.valLen,r.valLen_datatype&&(l.datatype=r.valLen_datatype)),!!r.chldCtr!=!!r.chldActor)throw new RangeError(`Mismatched child columns: ${r.chldCtr} and ${r.chldActor}`);r.chldCtr!==null&&(l.child=`${r.chldCtr}@${r.chldActor}`),t?(l.id=`${r.idCtr}@${r.idActor}`,l.succ=r.succNum.map(c=>`${c.succCtr}@${c.succActor}`),Cy(r.succNum.map(c=>({counter:c.succCtr,actorId:c.succActor})))):(l.pred=r.predNum.map(c=>`${c.predCtr}@${c.predActor}`),Cy(r.predNum.map(c=>({counter:c.predCtr,actorId:c.predActor})))),n.push(l)}return n}function Cy(e){let t=null;for(let n of e){if(t&&g0(t,n)!==-1)throw new RangeError("operation IDs are not in ascending order");t=n}}function sT(e){return(e&7)===_e.INT_DELTA?new cc:(e&7)===_e.BOOLEAN?new u0:(e&7)===_e.STRING_RLE?new Fn("utf8"):(e&7)===_e.VALUE_RAW?new ya:new Fn("uint")}function uc(e,t){return(e&7)===_e.INT_DELTA?new WR(t):(e&7)===_e.BOOLEAN?new GR(t):(e&7)===_e.STRING_RLE?new _y("utf8",t):(e&7)===_e.VALUE_RAW?new ln(t):new _y("uint",t)}function x0(e,t){const n=new Uint8Array(0);let r=[],i=0,a=0;for(;i<e.length||a<t.length;)if(i===e.length||a<t.length&&t[a].columnId<e[i].columnId){const{columnId:o,columnName:l}=t[a];r.push({columnId:o,columnName:l,decoder:uc(o,n)}),a++}else if(a===t.length||e[i].columnId<t[a].columnId){const{columnId:o,buffer:l}=e[i];r.push({columnId:o,decoder:uc(o,l)}),i++}else{const{columnId:o,buffer:l}=e[i],{columnName:c}=t[a];r.push({columnId:o,columnName:c,decoder:uc(o,l)}),i++,a++}return r}function Qh(e,t,n){e=x0(e,n);let r=[];for(;e.some(i=>!i.decoder.done);){let i={},a=0;for(;a<e.length;){const o=e[a].columnId;let l=o>>4,c=1;for(;a+c<e.length&&e[a+c].columnId>>4===l;)c++;if(o%8===_e.GROUP_CARD){const u=[],d=e[a].decoder.readValue();for(let p=0;p<d;p++){let h={};for(let f=1;f<c;f++)Ay(e,a+f,t,h);u.push(h)}i[e[a].columnName]=u,a+=c}else a+=Ay(e,a,t,i)}r.push(i)}return r}function Zh(e){const t=(-1^Qo)>>>0;let n=-1,r=[],i=e.readUint53();for(let a=0;a<i;a++){const o=e.readUint53(),l=e.readUint53();if((o&t)<=(n&t))throw new RangeError("Columns must be in ascending order");n=o,r.push({columnId:o,bufferLen:l})}return r}function Xh(e,t){const n=t.filter(r=>r.encoder.buffer.byteLength>0);e.appendUint53(n.length);for(let r of n)e.appendUint53(r.columnId),e.appendUint53(r.encoder.buffer.byteLength)}function j0(e){const t=e.readUint53(),n=[];for(let o=0;o<t;o++)n.push(wu(e.readRawBytes(32)));let r={actor:e.readHexString(),seq:e.readUint53(),startOp:e.readUint53(),time:e.readInt53(),message:e.readPrefixedString(),deps:n};const i=[r.actor],a=e.readUint53();for(let o=0;o<a;o++)i.push(e.readHexString());return r.actorIds=i,r}function b0(e,t){const r=Ki.byteLength+4+1+5,i=new ya;i.appendRawBytes(new Uint8Array(r)),t(i);const a=i.buffer,o=new ya;o.appendByte(e),o.appendUint53(a.byteLength-r);const l=o.buffer,c=new d0;c.update(l),c.update(a.subarray(r));const u=c.digest(),d=u.subarray(0,4);return a.set(Ki,r-l.byteLength-4-Ki.byteLength),a.set(d,r-l.byteLength-4),a.set(l,r-l.byteLength),{hash:u,bytes:a.subarray(r-l.byteLength-4-Ki.byteLength)}}function Da(e,t){if(!Ny(e.readRawBytes(Ki.byteLength),Ki))throw new RangeError("Data does not begin with magic bytes 85 6f 4a 83");const n=e.readRawBytes(4),r=e.offset,i=e.readByte(),a=e.readUint53(),o={chunkType:i,chunkLength:a,chunkData:e.readRawBytes(a)};if(t){const l=new d0;l.update(e.buf.subarray(r,e.offset));const c=l.digest();if(!Ny(c.subarray(0,4),n))throw new RangeError("checksum does not match data");o.hash=wu(c)}return o}function w0(e){const{changes:t,actorIds:n}=KR([e]),r=t[0],{hash:i,bytes:a}=b0(La,l=>{if(!Array.isArray(r.deps))throw new TypeError("deps is not an array");l.appendUint53(r.deps.length);for(let u of r.deps.slice().sort())l.appendRawBytes(c0(u));l.appendHexString(r.actor),l.appendUint53(r.seq),l.appendUint53(r.startOp),l.appendInt53(r.time),l.appendPrefixedString(r.message||""),l.appendUint53(n.length-1);for(let u of n.slice(1))l.appendHexString(u);const c=tT(r.ops);Xh(l,c);for(let u of c)l.appendRawBytes(u.encoder.buffer);r.extraBytes&&l.appendRawBytes(r.extraBytes)}),o=wu(i);if(e.hash&&e.hash!==o)throw new RangeError(`Change hash does not match encoding: ${e.hash} != ${o}`);return a.byteLength>=h0?aT(a):a}function S0(e){e[8]===ul&&(e=E0(e));const t=new ln(e),n=Da(t,!0),r=new ln(n.chunkData);if(!t.done)throw new RangeError("Encoded change has trailing data");if(n.chunkType!==La)throw new RangeError(`Unexpected chunk type: ${n.chunkType}`);const i=j0(r),a=Zh(r);for(let o=0;o<a.length;o++){if(a[o].columnId&Qo)throw new RangeError("change must not contain deflated columns");a[o].buffer=r.readRawBytes(a[o].bufferLen)}if(!r.done){const o=r.buf.byteLength-r.offset;i.extraBytes=r.readRawBytes(o)}return i.columns=a,i.hash=n.hash,i}function Up(e){const t=S0(e);return t.ops=v0(Qh(t.columns,t.actorIds,Mp),!1),delete t.actorIds,delete t.columns,t}function iT(e,t){e[8]===ul&&(e=E0(e));const n=Da(new ln(e),t);if(n.chunkType!==La)throw new RangeError("Buffer chunk type is not a change");const r=j0(new ln(n.chunkData));return r.change=e,t&&(r.hash=n.hash),r}function aT(e){const t=Da(new ln(e),!1);if(t.chunkType!==La)throw new RangeError(`Unexpected chunk type: ${t.chunkType}`);const n=bu.deflateRaw(t.chunkData),r=new ya;return r.appendRawBytes(e.subarray(0,8)),r.appendByte(ul),r.appendUint53(n.byteLength),r.appendRawBytes(n),r.buffer}function E0(e){const t=Da(new ln(e),!1);if(t.chunkType!==ul)throw new RangeError(`Unexpected chunk type: ${t.chunkType}`);const n=bu.inflateRaw(t.chunkData),r=new ya;return r.appendRawBytes(e.subarray(0,8)),r.appendByte(La),r.appendUint53(n.byteLength),r.appendRawBytes(n),r.buffer}function oT(e){let t=new ln(e),n=[],r=0;for(;!t.done;)Da(t,!1),n.push(e.subarray(r,t.offset)),r=t.offset;return n}function lT(e){let t=[];for(let n of e)for(let r of oT(n))r[8]===Dp?t=t.concat(fT(r)):(r[8]===La||r[8]===ul)&&t.push(Up(r));return t}function cT(e,t){if(e===t)return 0;if(e==="_root")return-1;if(t==="_root")return 1;const n=Lr(e),r=Lr(t);return n.counter<r.counter?-1:n.counter>r.counter?1:n.actorId<r.actorId?-1:n.actorId>r.actorId?1:0}function uT(e,t){let n={};for(let i of e){if(i.ops=[],n[i.actor]||(n[i.actor]=[]),i.seq!==n[i.actor].length+1)throw new RangeError(`Expected seq = ${n[i.actor].length+1}, got ${i.seq}`);if(i.seq>1&&n[i.actor][i.seq-2].maxOp>i.maxOp)throw new RangeError("maxOp must increase monotonically per actor");n[i.actor].push(i)}let r={};for(let i of t){if(i.action==="del")throw new RangeError("document should not contain del operations");i.pred=r[i.id]?r[i.id].pred:[],r[i.id]=i;for(let a of i.succ){if(!r[a])if(i.elemId){const o=i.insert?i.id:i.elemId;r[a]={id:a,action:"del",obj:i.obj,elemId:o,pred:[]}}else r[a]={id:a,action:"del",obj:i.obj,key:i.key,pred:[]};r[a].pred.push(i.id)}delete i.succ}for(let i of Object.values(r))i.action==="del"&&t.push(i);for(let i of t){const{counter:a,actorId:o}=Lr(i.id),l=n[o];let c=0,u=l.length;for(;c<u;){const d=Math.floor((c+u)/2);l[d].maxOp<a?c=d+1:u=d}if(c>=l.length)throw new RangeError(`Operation ID ${i.id} outside of allowed range`);l[c].ops.push(i)}for(let i of e){i.ops.sort((a,o)=>cT(a.id,o.id)),i.startOp=i.maxOp-i.ops.length+1,delete i.maxOp;for(let a=0;a<i.ops.length;a++){const o=i.ops[a],l=`${i.startOp+a}@${i.actor}`;if(o.id!==l)throw new RangeError(`Expected opId ${l}, got ${o.id}`);delete o.id}}}function dT(e,t){let n={};for(let o=0;o<e.length;o++){let l=e[o];l.deps=[];for(let c of l.depsNum.map(u=>u.depsIndex)){if(!e[c]||!e[c].hash)throw new RangeError(`No hash for index ${c} while processing index ${o}`);const u=e[c].hash;l.deps.push(u),n[u]&&delete n[u]}if(l.deps.sort(),delete l.depsNum,l.extraLen_datatype!==Ye.BYTES)throw new RangeError(`Bad datatype for extra bytes: ${Ye.BYTES}`);l.extraBytes=l.extraLen,delete l.extraLen_datatype,e[o]=Up(w0(l)),n[e[o].hash]=!0}const r=Object.keys(n).sort();let i=r.length===t.length,a=0;for(;i&&a<r.length;)i=r[a]===t[a],a++;if(!i)throw new RangeError(`Mismatched heads hashes: expected ${t.join(", ")}, got ${r.join(", ")}`)}function hT(e){const{changesColumns:t,opsColumns:n,actorIds:r,heads:i,headsIndexes:a,extraBytes:o}=e;for(let l of t)ky(l);for(let l of n)ky(l);return b0(Dp,l=>{l.appendUint53(r.length);for(let c of r)l.appendHexString(c);l.appendUint53(i.length);for(let c of i.sort())l.appendRawBytes(c0(c));Xh(l,t),Xh(l,n);for(let c of t)l.appendRawBytes(c.encoder.buffer);for(let c of n)l.appendRawBytes(c.encoder.buffer);for(let c of a)l.appendUint53(c);o&&l.appendRawBytes(o)}).bytes}function N0(e){const t=new ln(e),n=Da(t,!0),r=new ln(n.chunkData);if(!t.done)throw new RangeError("Encoded document has trailing data");if(n.chunkType!==Dp)throw new RangeError(`Unexpected chunk type: ${n.chunkType}`);const i=[],a=r.readUint53();for(let h=0;h<a;h++)i.push(r.readHexString());const o=[],l=[],c=r.readUint53();for(let h=0;h<c;h++)o.push(wu(r.readRawBytes(32)));const u=Zh(r),d=Zh(r);for(let h=0;h<u.length;h++)u[h].buffer=r.readRawBytes(u[h].bufferLen),Iy(u[h]);for(let h=0;h<d.length;h++)d[h].buffer=r.readRawBytes(d[h].bufferLen),Iy(d[h]);if(!r.done)for(let h=0;h<c;h++)l.push(r.readUint53());const p=r.readRawBytes(r.buf.byteLength-r.offset);return{changesColumns:u,opsColumns:d,actorIds:i,heads:o,headsIndexes:l,extraBytes:p}}function fT(e){const{changesColumns:t,opsColumns:n,actorIds:r,heads:i}=N0(e),a=Qh(t,r,m0),o=v0(Qh(n,r,p0),!0);return uT(a,o),dT(a,i),a}function ky(e){e.encoder.buffer.byteLength>=h0&&(e.encoder={buffer:bu.deflateRaw(e.encoder.buffer)},e.columnId|=Qo)}function Iy(e){e.columnId&Qo&&(e.buffer=bu.inflateRaw(e.buffer),e.columnId^=Qo)}var Su={COLUMN_TYPE:_e,VALUE_TYPE:Ye,ACTIONS:So,OBJECT_TYPE:YR,DOC_OPS_COLUMNS:p0,CHANGE_COLUMNS:Mp,DOCUMENT_COLUMNS:m0,encoderByColumnId:sT,decoderByColumnId:uc,makeDecoders:x0,decodeValue:y0,encodeChange:w0,decodeChangeColumns:S0,decodeChange:Up,decodeChangeMeta:iT,decodeChanges:lT,encodeDocumentHeader:hT,decodeDocumentHeader:N0};const{parseOpId:Gc,copyObject:Yc}=xr,{COLUMN_TYPE:Vt,VALUE_TYPE:ef,ACTIONS:Ar,OBJECT_TYPE:Ry,DOC_OPS_COLUMNS:Ty,CHANGE_COLUMNS:ze,DOCUMENT_COLUMNS:Hn,encoderByColumnId:va,decoderByColumnId:Bp,makeDecoders:Zo,decodeValue:$l,encodeChange:pT,decodeChangeColumns:mT,decodeChangeMeta:gT,decodeChanges:yT,decodeDocumentHeader:vT,encodeDocumentHeader:xT}=Su,Eu=600,jT=10,_0=7,A0=Math.floor(jT*Eu/8),pt=0,lt=1,Ut=2,Bt=3,Ce=4,Wt=5,Ze=6,Gt=7,jt=8,ns=9,ni=10,rs=13,ra=14,sa=15,Yn=13,tf=14,ia=15,Oy=ze.filter(e=>["predNum","predActor","predCtr"].includes(e.columnName)).map(e=>e.columnId);function nf(e,t,n){if(t.length===1)e[t[0]]=n;else{let r=Object.assign({},e[t[0]]);nf(r,t.slice(1),n),e[t[0]]=r}}function Py(e,t,n,r){for(let P of t)P.decoder.reset();const{objActor:i,objCtr:a,keyActor:o,keyCtr:l,keyStr:c,idActor:u,idCtr:d,insert:p}=e,[h,f,,,y,j,A,g,x,,,,,w]=t.map(P=>P.decoder);let E=0,_=0,b=!1,R=null,C=null,T=null,D=null,U=null,W=null,q=0;if(a!==null&&!r)for(;(!f.done||!h.done||!x.done)&&(C=f.readValue(),R=n[h.readValue()],x.skipValues(1),C===null||!R||C<a||C===a&&R<i);)E+=1;if((C!==a||R!==i)&&!r)return{found:!0,skipCount:E,visibleCount:_};if(c!==null){for(y.skipValues(E);!y.done;){const P=h.readValue();if(R=P===null?null:n[P],C=f.readValue(),U=y.readValue(),U!==null&&U<c&&C===a&&R===i)E+=1;else break}return{found:!0,skipCount:E,visibleCount:_}}if(A.skipValues(E),j.skipValues(E),g.skipValues(E),w.skipValues(E),D=A.readValue(),T=n[j.readValue()],W=g.readValue(),q=w.readValue(),p){if(!r&&l!==null&&l>0&&o!==null){for(E+=1;!A.done&&!j.done&&(D!==l||T!==o)&&(W&&(b=!1),q===0&&!b&&(_+=1,b=!0),D=A.readValue(),T=n[j.readValue()],C=f.readValue(),R=n[h.readValue()],W=g.readValue(),q=w.readValue(),C===a&&R===i);)E+=1;if(C!==a||R!==i||D!==l||T!==o||!W)return{found:!1,skipCount:E,visibleCount:_};if(W&&(b=!1),q===0&&!b&&(_+=1,b=!0),A.done||j.done)return{found:!0,skipCount:E,visibleCount:_};D=A.readValue(),T=n[j.readValue()],C=f.readValue(),R=n[h.readValue()],W=g.readValue(),q=w.readValue()}for(;(!W||D>d||D===d&&T>u)&&C===a&&R===i&&(E+=1,W&&(b=!1),q===0&&!b&&(_+=1,b=!0),!A.done&&!j.done);)D=A.readValue(),T=n[j.readValue()],C=f.readValue(),R=n[h.readValue()],W=g.readValue(),q=w.readValue()}else if(l!==null&&l>0&&o!==null){for(;(!W||D!==l||T!==o)&&C===a&&R===i&&(E+=1,W&&(b=!1),q===0&&!b&&(_+=1,b=!0),!A.done&&!j.done);)D=A.readValue(),T=n[j.readValue()],C=f.readValue(),R=n[h.readValue()],W=g.readValue(),q=w.readValue();if(C!==a||R!==i||D!==l||T!==o||!W)return{found:!1,skipCount:E,visibleCount:_}}return{found:!0,skipCount:E,visibleCount:_}}function Ly(e,t,n,r){const i=e.blocks[t],a=e.blocks[t+1];return i.lastObjectActor!==n||i.lastObjectCtr!==r||i.numVisible===void 0?0:i.lastVisibleActor===a.firstVisibleActor&&i.lastVisibleActor!==void 0&&i.lastVisibleCtr===a.firstVisibleCtr&&i.lastVisibleCtr!==void 0?i.numVisible-1:i.numVisible}function C0(e,t){const{objActor:n,objActorNum:r,objCtr:i,keyActor:a,keyCtr:o,keyStr:l}=t;let c=0,u=0;if(i!==null)for(;c<e.blocks.length-1;){const d=e.blocks[c].lastObjectActor===void 0?void 0:e.actorIds[e.blocks[c].lastObjectActor],p=e.blocks[c].lastObjectCtr;if(p===null||p<i||p===i&&d<n)c++;else break}if(l!==null){for(;c<e.blocks.length-1;){const{lastObjectActor:p,lastObjectCtr:h,lastKey:f}=e.blocks[c];if(i===h&&r===p&&f!==void 0&&f<l)c++;else break}const{skipCount:d}=Py(t,e.blocks[c].columns,e.actorIds,!1);return{blockIndex:c,skipCount:d,visibleCount:0}}else{const d=o===null||o===0||a===null,p=a===null?null:e.actorIds.indexOf(a);let h=!1;for(;;){if(!d&&!h)for(;c<e.blocks.length-1&&e.blocks[c].lastObjectActor===r&&e.blocks[c].lastObjectCtr===i&&!bT(e.blocks[c].bloom,p,o);){if(e.blocks[c].lastObjectCtr>i)throw new RangeError(`Reference element not found: ${o}@${a}`);u+=Ly(e,c,r,i),c++}const{found:f,skipCount:y,visibleCount:j}=Py(t,e.blocks[c].columns,e.actorIds,h);if(c===e.blocks.length-1||e.blocks[c].lastObjectActor!==r||e.blocks[c].lastObjectCtr!==i){if(f)return{blockIndex:c,skipCount:y,visibleCount:u+j};throw new RangeError(`Reference element not found: ${o}@${a}`)}else if(f&&y<e.blocks[c].numOps)return{blockIndex:c,skipCount:y,visibleCount:u+j};h=f&&t.insert,u+=Ly(e,c,r,i),c++}}}function k0(e,t,n){let r=8*e.byteLength,i=n%r,a=t%r,o=((n^t)*16777619>>>0)%r;for(let l=0;l<_0;l++)e[i>>>3]|=1<<(i&7),i=(i+a)%r,a=(a+o)%r}function bT(e,t,n){let r=8*e.byteLength,i=n%r,a=t%r,o=((n^t)*16777619>>>0)%r;for(let l=0;l<_0;l++){if(!(e[i>>>3]&1<<(i&7)))return!1;i=(i+a)%r,a=(a+o)%r}return!0}function I0(e){e.bloom=new Uint8Array(A0),e.numOps=0,e.lastKey=void 0,e.numVisible=void 0,e.lastObjectActor=void 0,e.lastObjectCtr=void 0,e.firstVisibleActor=void 0,e.firstVisibleCtr=void 0,e.lastVisibleActor=void 0,e.lastVisibleCtr=void 0;for(let d of e.columns)d.decoder.reset();const[t,n,r,i,a,o,l,c,,,,,,u]=e.columns.map(d=>d.decoder);for(;!l.done;){e.numOps+=1;const d=t.readValue(),p=n.readValue(),h=r.readValue(),f=i.readValue(),y=a.readValue(),j=o.readValue(),A=l.readValue(),g=c.readValue(),x=u.readValue();if((e.lastObjectActor!==d||e.lastObjectCtr!==p)&&(e.numVisible=0,e.lastObjectActor=d,e.lastObjectCtr=p),y!==null)e.lastKey=y;else if(g||f!==null){e.lastKey=void 0;const w=g?j:h,E=g?A:f;k0(e.bloom,w,E),x===0&&(e.firstVisibleActor===void 0&&(e.firstVisibleActor=w),e.firstVisibleCtr===void 0&&(e.firstVisibleCtr=E),(e.lastVisibleActor!==w||e.lastVisibleCtr!==E)&&(e.numVisible+=1,e.lastVisibleActor=w,e.lastVisibleCtr=E))}}}function _d(e,t,n,r){if(t[Ce]!==null)e.lastObjectCtr===t[lt]&&e.lastObjectActor===t[pt]&&(e.lastKey===void 0||e.lastKey<t[Ce])&&(e.lastKey=t[Ce]);else{const i=t[Gt]?t[Wt]:t[Ut],a=t[Gt]?t[Ze]:t[Bt];k0(e.bloom,i,a),(t[Yn]===0||r)&&(e.firstVisibleActor===void 0&&(e.firstVisibleActor=i),e.firstVisibleCtr===void 0&&(e.firstVisibleCtr=a),e.lastVisibleActor=i,e.lastVisibleCtr=a)}(e.lastObjectCtr===void 0||t[pt]!==null&&t[lt]!==null&&(e.lastObjectCtr===null||e.lastObjectCtr<t[lt]||e.lastObjectCtr===t[lt]&&n[e.lastObjectActor]<n[t[pt]]))&&(e.lastObjectActor=t[pt],e.lastObjectCtr=t[lt],e.lastKey=t[Ce]!==null?t[Ce]:void 0,e.numVisible=0)}function R0(e){for(let i of e.columns)i.decoder.reset();const t=Math.ceil(e.numOps/(.8*Eu));let n=[],r=0;for(let i=1;i<=t;i++){const a=Math.ceil(i*e.numOps/t)-r,o=e.columns.map(u=>({columnId:u.columnId,encoder:va(u.columnId)}));xa(o,e.columns,a);const c={columns:o.map(u=>{const d=Bp(u.columnId,u.encoder.buffer);return{columnId:u.columnId,decoder:d}})};I0(c),n.push(c),r+=a}return n}function wT(e){const t=e[0].columns.map(n=>({columnId:n.columnId,encoder:va(n.columnId)}));for(let n of e){for(let r of n.columns)r.decoder.reset();xa(t,n.columns,n.numOps)}return t}function xa(e,t,n){if(n===0)return;let r=0,i=-1,a=0,o=-1,l=0;for(let c of e){for(;r<t.length&&t[r].columnId<c.columnId;)r++;let u=null;r<t.length&&t[r].columnId===c.columnId&&t[r].decoder.buf.byteLength>0&&(u=t[r].decoder);const d=c.columnId>>4===i?a:n;if(c.columnId%8===Vt.GROUP_CARD)i=c.columnId>>4,u?a=c.encoder.copyFrom(u,{count:n,sumValues:!0}).sum:(c.encoder.appendValue(0,n),a=0);else if(c.columnId%8===Vt.VALUE_LEN)if(u){if(r+1===t.length||t[r+1].columnId!==c.columnId+1)throw new RangeError("VALUE_LEN column without accompanying VALUE_RAW column");o=c.columnId+1,l=c.encoder.copyFrom(u,{count:d,sumValues:!0,sumShift:4}).sum}else c.encoder.appendValue(null,d),o=c.columnId+1,l=0;else if(c.columnId%8===Vt.VALUE_RAW){if(c.columnId!==o)throw new RangeError("VALUE_RAW column without accompanying VALUE_LEN column");l>0&&c.encoder.appendRawBytes(u.readRawBytes(l))}else if(u)c.encoder.copyFrom(u,{count:d});else{const p=c.columnId%8===Vt.BOOLEAN?!1:null;c.encoder.appendValue(p,d)}}}function rf(e,t){let n=[],r,i=-1,a=0,o=-1,l=0;for(let c of e){if(c.columnId%8===Vt.VALUE_RAW){if(c.columnId!==o)throw new RangeError("unexpected VALUE_RAW column");r=c.decoder.readRawBytes(l)}else if(c.columnId%8===Vt.GROUP_CARD)i=c.columnId>>4,a=c.decoder.readValue()||0,r=a;else if(c.columnId>>4===i){r=[],c.columnId%8===Vt.VALUE_LEN&&(o=c.columnId+1,l=0);for(let u=0;u<a;u++){let d=c.decoder.readValue();c.columnId%8===Vt.ACTOR_ID&&t&&typeof d=="number"&&(d=t[d]),c.columnId%8===Vt.VALUE_LEN&&(l+=r>>>4),r.push(d)}}else r=c.decoder.readValue(),c.columnId%8===Vt.ACTOR_ID&&t&&typeof r=="number"&&(r=t[r]),c.columnId%8===Vt.VALUE_LEN&&(o=c.columnId+1,l=r>>>4);n.push(r)}return n}function dc(e,t,n){let r=0,i=-1,a=0;for(let o of e){for(;r<t.length&&t[r].columnId<o.columnId;)r++;if(r<t.length&&t[r].columnId===o.columnId){const l=n[r];if(o.columnId%8===Vt.GROUP_CARD)i=o.columnId>>4,a=l,o.encoder.appendValue(l);else if(o.columnId>>4===i){if(!Array.isArray(l)||l.length!==a)throw new RangeError("bad group value");for(let c of l)o.encoder.appendValue(c)}else o.columnId%8===Vt.VALUE_RAW?l&&o.encoder.appendRawBytes(l):o.encoder.appendValue(l)}else if(o.columnId%8===Vt.GROUP_CARD)i=o.columnId>>4,a=0,o.encoder.appendValue(0);else if(o.columnId%8!==Vt.VALUE_RAW){const l=o.columnId>>4===i?a:1;let c=null;o.columnId%8===Vt.BOOLEAN&&(c=!1),o.columnId%8===Vt.VALUE_LEN&&(c=0),o.encoder.appendValue(c,l)}}}function sf(e,t){let n=e.blocks[t];if(n.columns[jt].decoder.done){if(t===e.blocks.length-1)return{docOp:null,blockIndex:t};t+=1,n=e.blocks[t];for(let r of n.columns)r.decoder.reset();return{docOp:rf(n.columns),blockIndex:t}}else return{docOp:rf(n.columns),blockIndex:t}}function T0(e,t){for(;t.changeIndex<t.changes.length-1&&(!t.columns||t.columns[jt].decoder.done);){t.changeIndex+=1;const r=t.changes[t.changeIndex];t.columns=Zo(r.columns,ze),t.opCtr=r.startOp,t.columns[jt].decoder.done&&(r.maxOp=r.startOp-1),_T(e,t.columns);const{actorIds:i,actorTable:a}=AT(e.actorIds,r);e.actorIds=i,t.actorTable=a,t.actorIndex=e.actorIds.indexOf(r.actorIds[0])}if(t.columns[jt].decoder.done){t.done=!0,t.nextOp=null;return}t.nextOp=rf(t.columns,t.actorTable),t.nextOp[Wt]=t.actorIndex,t.nextOp[Ze]=t.opCtr,t.changes[t.changeIndex].maxOp=t.opCtr,t.opCtr>e.maxOp&&(e.maxOp=t.opCtr),t.opCtr+=1;const n=t.nextOp;if(n[lt]===null&&n[pt]!==null||n[lt]!==null&&n[pt]===null)throw new RangeError(`Mismatched object reference: (${n[lt]}, ${n[pt]})`);if(n[Bt]===null&&n[Ut]!==null||n[Bt]===0&&n[Ut]!==null||n[Bt]>0&&n[Ut]===null)throw new RangeError(`Mismatched operation key: (${n[Bt]}, ${n[Ut]})`)}function aa(e,t){return t==="list"||t==="text"?{objectId:e,type:t,edits:[]}:{objectId:e,type:t,props:{}}}function Dy(e,t,n=1){const r=Gc(e),i=Gc(t);return r.actorId===i.actorId&&r.counter+n===i.counter}function Xo(e,t){if(e.length===0){e.push(t);return}let n=e[e.length-1];n.action==="insert"&&t.action==="insert"&&n.index===t.index-1&&n.value.type==="value"&&t.value.type==="value"&&n.elemId===n.opId&&t.elemId===t.opId&&Dy(n.elemId,t.elemId,1)&&n.value.datatype===t.value.datatype&&typeof n.value.value==typeof t.value.value?(n.action="multi-insert",t.value.datatype&&(n.datatype=t.value.datatype),n.values=[n.value.value,t.value.value],delete n.value,delete n.opId):n.action==="multi-insert"&&t.action==="insert"&&n.index+n.values.length===t.index&&t.value.type==="value"&&t.elemId===t.opId&&Dy(n.elemId,t.elemId,n.values.length)&&n.datatype===t.value.datatype&&typeof n.values[0]==typeof t.value.value?n.values.push(t.value.value):n.action==="remove"&&t.action==="remove"&&n.index===t.index?n.count+=t.count:e.push(t)}function af(e,t,n,r,i,a){let o=!1;if(a)for(;!o&&e.length>0;){const l=e[e.length-1];if((l.action==="insert"||l.action==="update")&&l.index===t)e.pop(),o=l.action==="insert";else if(l.action==="multi-insert"&&l.index+l.values.length-1===t)l.values.pop(),o=!0;else break}o?Xo(e,{action:"insert",index:t,elemId:n,opId:r,value:i}):Xo(e,{action:"update",index:t,opId:r,value:i})}function ST(e,t,n){let r=[];for(;e.length>0;){let a=e[e.length-1];if(a.action==="insert"){if(a.index!==t)throw new RangeError("last edit has unexpected index");r.unshift(e.pop());break}else if(a.action==="update"){if(a.index!==t)throw new RangeError("last edit has unexpected index");r.unshift(e.pop())}else throw new RangeError("last edit has unexpected action")}let i=!0;for(let a of r)af(e,t,n,a.opId,a.value,i),i=!1}function of(e,t,n,r,i,a,o,l){const c=!t,u=r[jt]<Ar.length?Ry[Ar[r[jt]]]:null,d=`${r[Ze]}@${i.actorIds[r[Wt]]}`,p=r[Gt]?r[Wt]:r[Ut],h=r[Gt]?r[Ze]:r[Bt],f=r[Ce]?r[Ce]:`${h}@${i.actorIds[p]}`;r[jt]%2===0&&!i.objectMeta[d]&&(i.objectMeta[d]={parentObj:n,parentKey:f,opId:d,type:u,children:{}},nf(i.objectMeta,[n,"children",f,d],{objectId:d,type:u,props:{}}));const y=!a[f];a[f]||(a[f]={visibleOps:[],hasChild:!1});const j=l!==void 0&&r[Yn]>0;j||(a[f].visibleOps.push(r),a[f].hasChild=a[f].hasChild||r[jt]%2===0);const A=i.objectMeta[n].children[f];if(a[f].hasChild||A&&Object.keys(A).length>0){let E={};for(let _ of a[f].visibleOps){const b=`${_[Ze]}@${i.actorIds[_[Wt]]}`;if(Ar[_[jt]]==="set")E[b]=Object.assign({type:"value"},$l(_[ns],_[ni]));else if(_[jt]%2===0){const R=_[jt]<Ar.length?Ry[Ar[_[jt]]]:null;E[b]=aa(b,R)}}nf(i.objectMeta,[n,"children",f],E)}let g,x;if(j&&Ar[r[jt]]==="set"&&(r[ns]&15)===ef.COUNTER){a[f]||(a[f]={visibleOps:[],hasChild:!1}),a[f].counterStates||(a[f].counterStates={});let E=a[f].counterStates,_={opId:d,value:$l(r[ns],r[ni]).value,succs:{}};for(let b=0;b<r[Yn];b++){const R=`${r[ia][b]}@${i.actorIds[r[tf][b]]}`;E[R]=_,_.succs[R]=!0}}else if(Ar[r[jt]]==="inc"){if(!a[f]||!a[f].counterStates||!a[f].counterStates[d])throw new RangeError(`increment operation ${d} for unknown counter`);let E=a[f].counterStates[d];E.value+=$l(r[ns],r[ni]).value,delete E.succs[d],Object.keys(E.succs).length===0&&(g=E.opId,x={type:"value",datatype:"counter",value:E.value})}else j||(Ar[r[jt]]==="set"?(g=d,x=Object.assign({type:"value"},$l(r[ns],r[ni]))):r[jt]%2===0&&(e[d]||(e[d]=aa(d,u)),g=d,x=e[d]));e[n]||(e[n]=aa(n,i.objectMeta[n].type));const w=e[n];if(r[Ce]===null)if(l===0&&!c&&a[f].action==="insert"&&(a[f].action="update",ST(w.edits,o,f),t&&t.lastObjectActor===r[pt]&&t.lastObjectCtr===r[lt]&&(t.numVisible-=1)),x)if(!a[f].action&&(l===void 0||c))a[f].action="insert",Xo(w.edits,{action:"insert",index:o,elemId:f,opId:g,value:x}),t&&t.lastObjectActor===r[pt]&&t.lastObjectCtr===r[lt]&&(t.numVisible+=1);else if(a[f].action==="remove"){let E=w.edits[w.edits.length-1];if(E.action!=="remove")throw new RangeError("last edit has unexpected type");E.count>1?E.count-=1:w.edits.pop(),a[f].action="update",af(w.edits,o,f,g,x,!0),t&&t.lastObjectActor===r[pt]&&t.lastObjectCtr===r[lt]&&(t.numVisible+=1)}else af(w.edits,o,f,g,x,!a[f].action),a[f].action||(a[f].action="update");else l===0&&!a[f].action&&(a[f].action="remove",Xo(w.edits,{action:"remove",index:o,count:1}),t&&t.lastObjectActor===r[pt]&&t.lastObjectCtr===r[lt]&&(t.numVisible-=1));else(x||!c)&&((y||!w.props[r[Ce]])&&(w.props[r[Ce]]={}),x&&(w.props[r[Ce]][g]=x))}function ET(e,t,n,r,i,a,o){const l=r.nextOp,c=l[Gt],u=l[pt],d=l[lt],p=u===null?"_root":`${d}@${i.actorIds[u]}`,h=r.actorIndex,f=i.actorIds[h];let y=!1,j=!1,A={},g;({docOp:g,blockIndex:o}=sf(i,o));let x=g===null?0:1,w=g===null?0:g[Yn],E=null,_=[],b=[],R=[],C=null;for(r.objectIds.add(p);;){if(_.length===0){y=!1;let P=r.nextOp;for(;!r.done&&P[Wt]===h&&P[Gt]===c&&P[pt]===l[pt]&&P[lt]===l[lt];){const V=_.length>0?_[_.length-1]:null;let K=!1;for(let ce=0;ce<P[rs];ce++)for(let M of _)P[ra][ce]===M[Wt]&&P[sa][ce]===M[Ze]&&(K=!0);if(P!==l){if(!(c&&V!==null&&P[Ce]===null&&P[Ut]===V[Wt]&&P[Bt]===V[Ze])){if(!(!c&&V!==null&&P[Ce]!==null&&P[Ce]===V[Ce]&&!K)){if(!(!c&&V!==null&&P[Ce]===null&&V[Ce]===null&&P[Ut]===V[Ut]&&P[Bt]===V[Bt]&&!K)){if(!(!c&&V===null&&P[Ce]===null&&g&&g[Gt]&&g[Ce]===null&&g[Wt]===P[Ut]&&g[Ze]===P[Bt])){if(!(!c&&V===null&&P[Ce]!==null&&C!==null&&C<P[Ce]))break}}}}}C=P!==null?P[Ce]:null,_.push(r.nextOp),b.push(r.columns),R.push(new Array(r.nextOp[rs])),T0(i,r),P=r.nextOp}}_.length>0&&(E=_[0]);const T=g&&g[pt]===E[pt]&&g[lt]===E[lt],D=g&&g[Ce]!==null&&g[Ce]===E[Ce],U=g&&g[Ce]===null&&E[Ce]===null&&(!g[Gt]&&g[Ut]===E[Ut]&&g[Bt]===E[Bt]||g[Gt]&&g[Wt]===E[Ut]&&g[Ze]===E[Bt]);if(_.length===0&&!(T&&(D||U)))break;let W=!1,q=0;if(c||!T||g[Ce]===null&&E[Ce]!==null||g[Ce]!==null&&E[Ce]!==null&&E[Ce]<g[Ce]){if(q=_.length,!T&&!y&&E[Ce]===null&&!E[Gt])throw new RangeError(`could not find list element with ID: ${E[Bt]}@${i.actorIds[E[Ut]]}`)}else if(D||U||y){for(let P=0;P<_.length;P++){const V=_[P];for(let K=0;K<V[rs];K++)if(V[ra][K]===g[Wt]&&V[sa][K]===g[Ze]){let ce=0;for(;ce<g[Yn]&&(g[ia][ce]<V[Ze]||g[ia][ce]===V[Ze]&&i.actorIds[g[tf][ce]]<f);)ce++;g[ia].splice(ce,0,V[Ze]),g[tf].splice(ce,0,h),g[Yn]++,R[P][K]=!0;break}}if(U&&(y=!0),y&&!U)q=_.length;else if(_.length===0||g[Ze]<E[Ze]||g[Ze]===E[Ze]&&i.actorIds[g[Wt]]<f){W=!0,of(e,t,p,g,i,A,a,w);for(let P=_.length-1;P>=0;P--){let V=!0;for(let K=0;K<_[P][rs];K++)R[P][K]||(V=!1);Ar[_[P][jt]]==="del"&&V&&(_.splice(P,1),b.splice(P,1),R.splice(P,1))}}else{if(g[Ze]===E[Ze]&&i.actorIds[g[Wt]]===f)throw new RangeError(`duplicate operation ID: ${E[Ze]}@${f}`);q=1}}else W=!0;if(W&&(dc(n,i.blocks[o].columns,g),_d(t,g,i.actorIds,!1),g[Gt]&&j&&(j=!1,a++),g[Yn]===0&&(j=!0),t.numOps++,{docOp:g,blockIndex:o}=sf(i,o),g!==null&&(x++,w=g[Yn])),q>0){for(let P=0;P<q;P++){let V=_[P];for(let K=0;K<V[rs];K++)if(!R[P][K])throw new RangeError(`no matching operation for pred: ${V[sa][K]}@${i.actorIds[V[ra][K]]}`);dc(n,b[P],V),_d(t,V,i.actorIds,!0),of(e,t,p,V,i,A,a),V[Gt]?(j=!1,a++):j=!0}q===_.length?(_.length=0,b.length=0,R.length=0):(_.splice(0,q),b.splice(0,q),R.splice(0,q)),t.numOps+=q}}return g&&(dc(n,i.blocks[o].columns,g),t.numOps++,_d(t,g,i.actorIds,!1)),{docOpsConsumed:x,blockIndex:o}}function NT(e,t,n){const[r,i,a,o,l,c,u,d]=t.nextOp,p=r===null?null:n.actorIds[r],h=a===null?null:n.actorIds[a],f={objActor:p,objActorNum:r,objCtr:i,keyActor:h,keyCtr:o,keyStr:l,idActor:n.actorIds[c],idCtr:u,insert:d},{blockIndex:y,skipCount:j,visibleCount:A}=C0(n,f),g=n.blocks[y];for(let T of g.columns)T.decoder.reset();const x=j===0||g.firstVisibleActor===void 0||!d&&g.firstVisibleActor===a&&g.firstVisibleCtr===o,w={columns:void 0,bloom:new Uint8Array(g.bloom),numOps:j,lastKey:g.lastKey,numVisible:g.numVisible,lastObjectActor:g.lastObjectActor,lastObjectCtr:g.lastObjectCtr,firstVisibleActor:x?void 0:g.firstVisibleActor,firstVisibleCtr:x?void 0:g.firstVisibleCtr,lastVisibleActor:void 0,lastVisibleCtr:void 0},E=g.columns.map(T=>({columnId:T.columnId,encoder:va(T.columnId)}));xa(E,g.columns,j);const{blockIndex:_,docOpsConsumed:b}=ET(e,w,E,t,n,A,y),R=n.blocks[_];let C=-j-b;for(let T=y;T<=_;T++)C+=n.blocks[T].numOps;xa(E,R.columns,C),w.numOps+=C;for(let T of R.columns)if(!T.decoder.done)throw new RangeError(`excess ops in column ${T.columnId}`);if(w.columns=E.map(T=>{const D=Bp(T.columnId,T.encoder.buffer);return{columnId:T.columnId,decoder:D}}),y===_&&w.numOps<=Eu)C>0&&g.lastVisibleActor!==void 0&&g.lastVisibleCtr!==void 0&&(w.lastVisibleActor=g.lastVisibleActor,w.lastVisibleCtr=g.lastVisibleCtr),n.blocks[y]=w;else{const T=R0(w);n.blocks.splice(y,_-y+1,...T)}}function _T(e,t){if(t[pt].columnId!==ze[pt].columnId||ze[pt].columnName!=="objActor"||t[lt].columnId!==ze[lt].columnId||ze[lt].columnName!=="objCtr"||t[Ut].columnId!==ze[Ut].columnId||ze[Ut].columnName!=="keyActor"||t[Bt].columnId!==ze[Bt].columnId||ze[Bt].columnName!=="keyCtr"||t[Ce].columnId!==ze[Ce].columnId||ze[Ce].columnName!=="keyStr"||t[Wt].columnId!==ze[Wt].columnId||ze[Wt].columnName!=="idActor"||t[Ze].columnId!==ze[Ze].columnId||ze[Ze].columnName!=="idCtr"||t[Gt].columnId!==ze[Gt].columnId||ze[Gt].columnName!=="insert"||t[jt].columnId!==ze[jt].columnId||ze[jt].columnName!=="action"||t[ns].columnId!==ze[ns].columnId||ze[ns].columnName!=="valLen"||t[ni].columnId!==ze[ni].columnId||ze[ni].columnName!=="valRaw"||t[rs].columnId!==ze[rs].columnId||ze[rs].columnName!=="predNum"||t[ra].columnId!==ze[ra].columnId||ze[ra].columnName!=="predActor"||t[sa].columnId!==ze[sa].columnId||ze[sa].columnName!=="predCtr")throw new RangeError("unexpected columnId");const n=e.blocks[0].columns;if(!t.every(r=>Oy.includes(r.columnId)||n.find(i=>i.columnId===r.columnId))){let r=n.map(i=>({columnId:i.columnId}));for(let i of t){const{columnId:a}=i;!Oy.includes(a)&&!n.find(o=>o.columnId===a)&&r.push({columnId:a})}r.sort((i,a)=>i.columnId-a.columnId);for(let i=0;i<e.blocks.length;i++){let a=Yc(e.blocks[i]);a.columns=Zo(a.columns.map(o=>({columnId:o.columnId,buffer:o.decoder.buf})),r),e.blocks[i]=a}}}function AT(e,t){if(e.indexOf(t.actorIds[0])<0){if(t.seq!==1)throw new RangeError(`Seq ${t.seq} is the first change for actor ${t.actorIds[0]}`);e=e.concat([t.actorIds[0]])}const n=[];for(let r of t.actorIds){const i=e.indexOf(r);if(i<0)throw new RangeError(`actorId ${r} is not known to document`);n.push(i)}return{actorIds:e,actorTable:n}}function CT(e,t,n){for(let r of t){let i=n.objectMeta[r],a=null,o=!1;for(;;){const l=a&&Object.keys(i.children[a.parentKey]).length>0;if(e[r]||(e[r]=aa(r,i.type)),a&&l)if(i.type==="list"||i.type==="text"){for(let c of e[r].edits)c.opId&&i.children[a.parentKey][c.opId]&&(o=!0);if(!o){const c=Gc(r),u=Gc(a.parentKey),d={objActor:c.actorId,objCtr:c.counter,keyActor:u.actorId,keyCtr:u.counter,objActorNum:n.actorIds.indexOf(c.actorId),keyActorNum:n.actorIds.indexOf(u.actorId),keyStr:null,insert:!1},{visibleCount:p}=C0(n,d);for(let[h,f]of Object.entries(i.children[a.parentKey])){let y=f;f.objectId&&(e[f.objectId]||(e[f.objectId]=aa(f.objectId,f.type)),y=e[f.objectId]);const j={action:"update",index:p,opId:h,value:y};Xo(e[r].edits,j)}}}else{e[r].props[a.parentKey]||(e[r].props[a.parentKey]={});let c=e[r].props[a.parentKey];for(let[u,d]of Object.entries(i.children[a.parentKey]))c[u]?o=!0:d.objectId?(e[d.objectId]||(e[d.objectId]=aa(d.objectId,d.type)),c[u]=e[d.objectId]):c[u]=d}if(o||!i.parentObj||a&&!l)break;a=i,r=i.parentObj,i=n.objectMeta[r]}}return e}function kT(e,t,n,r,i){let a=new Set(n.heads),o=new Set,l=Yc(n.clock),c=[],u=[];for(let d of t){if(n.changeIndexByHash[d.hash]!==void 0||o.has(d.hash))continue;const p=(l[d.actor]||0)+1;let h=!0;for(let f of d.deps){const y=n.changeIndexByHash[f];(y===void 0||y===-1)&&!o.has(f)&&(h=!1)}if(!h)u.push(d);else if(d.seq<p){if(i)throw new RangeError(`Reuse of sequence number ${d.seq} for actor ${d.actor}`);return[[],t]}else{if(d.seq>p)throw new RangeError(`Skipped sequence number ${p} for actor ${d.actor}`);l[d.actor]=d.seq,o.add(d.hash);for(let f of d.deps)a.delete(f);a.add(d.hash),c.push(d)}}if(c.length>0){let d={changes:c,changeIndex:-1,objectIds:r};for(T0(n,d);!d.done;)NT(e,d,n);n.heads=[...a].sort(),n.clock=l}return[c,u]}function My(e){for(let d of e.blocks[0].columns)d.decoder.reset();let t={},n=null,r=0,i={_root:{objectId:"_root",type:"map",props:{}}},a=null,o=null,l="_root",c=!1,u=0;for(;{docOp:n,blockIndex:r}=sf(e,r),n!==null;){(n[pt]!==a||n[lt]!==o)&&(l=`${n[lt]}@${e.actorIds[n[pt]]}`,a=n[pt],o=n[lt],t={},u=0,c=!1),n[Gt]&&c&&(c=!1,u++),n[Yn]===0&&(c=!0),n[Ze]>e.maxOp&&(e.maxOp=n[Ze]);for(let d=0;d<n[Yn];d++)n[ia][d]>e.maxOp&&(e.maxOp=n[ia][d]);of(i,null,l,n,e,t,u,n[Yn])}return i._root}function IT(e){const t=Zo(e.changesColumns,Hn),n=t[0].decoder,r=t[1].decoder,i=t[5].decoder,a=t[6].decoder;if(t[0].columnId!==Hn[0].columnId||Hn[0].columnName!=="actor"||t[1].columnId!==Hn[1].columnId||Hn[1].columnName!=="seq"||t[5].columnId!==Hn[5].columnId||Hn[5].columnName!=="depsNum"||t[6].columnId!==Hn[6].columnId||Hn[6].columnName!=="depsIndex")throw new RangeError("unexpected columnId");let o=0,l={},c=[],u=new Set;for(;!n.done;){const h=n.readValue(),f=r.readValue(),y=i.readValue(),j=e.actorIds[h];if(f!==1&&f!==l[j]+1)throw new RangeError(`Expected seq ${l[j]+1}, got ${f} for actor ${j}`);c.push(h),l[j]=f,u.add(o);for(let A=0;A<y;A++)u.delete(a.readValue());o++}const d=[...u].map(h=>e.actorIds[c[h]]).sort();for(let h of t)h.decoder.reset();const p=t.map(h=>({columnId:h.columnId,encoder:va(h.columnId)}));return xa(p,t,o),{clock:l,headActors:d,encoders:p,numChanges:o}}function RT(e,t,n,r){dc(e,Hn,[n.indexOf(t.actor),t.seq,t.maxOp,t.time,t.message,t.deps.length,t.deps.map(i=>r[i]),t.extraBytes?t.extraBytes.byteLength<<4|ef.BYTES:ef.BYTES,t.extraBytes])}let TT=class O0{constructor(t){if(this.maxOp=0,this.haveHashGraph=!1,this.changes=[],this.changeIndexByHash={},this.dependenciesByHash={},this.dependentsByHash={},this.hashesByActor={},this.actorIds=[],this.heads=[],this.clock={},this.queue=[],this.objectMeta={_root:{parentObj:null,parentKey:null,opId:null,type:"map",children:{}}},t){const n=vT(t),{clock:r,headActors:i,encoders:a,numChanges:o}=IT(n);if(this.binaryDoc=t,this.changes=new Array(o),this.actorIds=n.actorIds,this.heads=n.heads,this.clock=r,this.changesEncoders=a,this.extraBytes=n.extraBytes,n.heads.length===1&&i.length===1&&(this.hashesByActor[i[0]]=[],this.hashesByActor[i[0]][r[i[0]]-1]=n.heads[0]),n.heads.length===n.headsIndexes.length)for(let c=0;c<n.heads.length;c++)this.changeIndexByHash[n.heads[c]]=n.headsIndexes[c];else if(n.heads.length===1)this.changeIndexByHash[n.heads[0]]=o-1;else for(let c of n.heads)this.changeIndexByHash[c]=-1;this.blocks=[{columns:Zo(n.opsColumns,Ty)}],I0(this.blocks[0]),this.blocks[0].numOps>Eu&&(this.blocks=R0(this.blocks[0]));let l={blocks:this.blocks,actorIds:this.actorIds,objectMeta:this.objectMeta,maxOp:0};this.initPatch=My(l),this.maxOp=l.maxOp}else this.haveHashGraph=!0,this.changesEncoders=Hn.map(n=>({columnId:n.columnId,encoder:va(n.columnId)})),this.blocks=[{columns:Zo([],Ty),bloom:new Uint8Array(A0),numOps:0,lastKey:void 0,numVisible:void 0,lastObjectActor:void 0,lastObjectCtr:void 0,firstVisibleActor:void 0,firstVisibleCtr:void 0,lastVisibleActor:void 0,lastVisibleCtr:void 0}]}clone(){let t=new O0;return t.maxOp=this.maxOp,t.haveHashGraph=this.haveHashGraph,t.changes=this.changes.slice(),t.changeIndexByHash=Yc(this.changeIndexByHash),t.dependenciesByHash=Yc(this.dependenciesByHash),t.dependentsByHash=Object.entries(this.dependentsByHash).reduce((n,[r,i])=>(n[r]=i.slice(),n),{}),t.hashesByActor=Object.entries(this.hashesByActor).reduce((n,[r,i])=>(n[r]=i.slice(),n),{}),t.actorIds=this.actorIds,t.heads=this.heads,t.clock=this.clock,t.blocks=this.blocks,t.objectMeta=this.objectMeta,t.queue=this.queue,t}applyChanges(t,n=!1){let r=t.map(d=>{const p=mT(d);return p.buffer=d,p}),i={_root:{objectId:"_root",type:"map",props:{}}},a={maxOp:this.maxOp,changeIndexByHash:this.changeIndexByHash,actorIds:this.actorIds,heads:this.heads,clock:this.clock,blocks:this.blocks.slice(),objectMeta:Object.assign({},this.objectMeta)},o=this.queue.length===0?r:r.concat(this.queue),l=[],c=new Set;for(;;){const[d,p]=kT(i,o,a,c,this.haveHashGraph);o=p;for(let h=0;h<d.length;h++)a.changeIndexByHash[d[h].hash]=this.changes.length+l.length+h;if(d.length>0&&(l=l.concat(d)),o.length===0)break;if(d.length===0){if(this.haveHashGraph)break;this.computeHashGraph(),a.changeIndexByHash=this.changeIndexByHash}}CT(i,c,a);for(let d of l){this.changes.push(d.buffer),this.hashesByActor[d.actor]||(this.hashesByActor[d.actor]=[]),this.hashesByActor[d.actor][d.seq-1]=d.hash,this.changeIndexByHash[d.hash]=this.changes.length-1,this.dependenciesByHash[d.hash]=d.deps,this.dependentsByHash[d.hash]=[];for(let p of d.deps)this.dependentsByHash[p]||(this.dependentsByHash[p]=[]),this.dependentsByHash[p].push(d.hash);RT(this.changesEncoders,d,a.actorIds,this.changeIndexByHash)}this.maxOp=a.maxOp,this.actorIds=a.actorIds,this.heads=a.heads,this.clock=a.clock,this.blocks=a.blocks,this.objectMeta=a.objectMeta,this.queue=o,this.binaryDoc=null,this.initPatch=null;let u={maxOp:this.maxOp,clock:this.clock,deps:this.heads,pendingChanges:this.queue.length,diffs:i._root};return n&&r.length===1&&(u.actor=r[0].actor,u.seq=r[0].seq),u}computeHashGraph(){const t=this.save();this.haveHashGraph=!0,this.changes=[],this.changeIndexByHash={},this.dependenciesByHash={},this.dependentsByHash={},this.hashesByActor={},this.clock={};for(let n of yT([t])){const r=pT(n);this.changes.push(r),this.changeIndexByHash[n.hash]=this.changes.length-1,this.dependenciesByHash[n.hash]=n.deps,this.dependentsByHash[n.hash]=[];for(let a of n.deps)this.dependentsByHash[a].push(n.hash);n.seq===1&&(this.hashesByActor[n.actor]=[]),this.hashesByActor[n.actor].push(n.hash);const i=(this.clock[n.actor]||0)+1;if(n.seq!==i)throw new RangeError(`Expected seq ${i}, got seq ${n.seq} from actor ${n.actor}`);this.clock[n.actor]=n.seq}}getChanges(t){if(this.haveHashGraph||this.computeHashGraph(),t.length===0)return this.changes.slice();let n=[],r={},i=[];for(let a of t){r[a]=!0;const o=this.dependentsByHash[a];if(!o)throw new RangeError(`hash not found: ${a}`);n.push(...o)}for(;n.length>0;){const a=n.pop();if(r[a]=!0,i.push(a),!this.dependenciesByHash[a].every(o=>r[o]))break;n.push(...this.dependentsByHash[a])}if(n.length===0&&this.heads.every(a=>r[a]))return i.map(a=>this.changes[this.changeIndexByHash[a]]);for(n=t.slice(),r={};n.length>0;){const a=n.pop();if(!r[a]){const o=this.dependenciesByHash[a];if(!o)throw new RangeError(`hash not found: ${a}`);n.push(...o),r[a]=!0}}return this.changes.filter(a=>!r[gT(a,!0).hash])}getChangesAdded(t){this.haveHashGraph||this.computeHashGraph();let n=this.heads.slice(),r={},i=[];for(;n.length>0;){const a=n.pop();!r[a]&&t.changeIndexByHash[a]===void 0&&(r[a]=!0,i.push(a),n.push(...this.dependenciesByHash[a]))}return i.reverse().map(a=>this.changes[this.changeIndexByHash[a]])}getChangeByHash(t){return this.haveHashGraph||this.computeHashGraph(),this.changes[this.changeIndexByHash[t]]}getMissingDeps(t=[]){this.haveHashGraph||this.computeHashGraph();let n=new Set(t),r=new Set;for(let a of this.queue){r.add(a.hash);for(let o of a.deps)n.add(o)}let i=[];for(let a of n)this.changeIndexByHash[a]===void 0&&!r.has(a)&&i.push(a);return i.sort()}save(){if(this.binaryDoc)return this.binaryDoc;const t=this.changesEncoders.map(r=>({columnId:r.columnId,encoder:va(r.columnId)})),n=this.changesEncoders.map(r=>{const i=Bp(r.columnId,r.encoder.buffer);return{columnId:r.columnId,decoder:i}});return xa(t,n,this.changes.length),this.binaryDoc=xT({changesColumns:this.changesEncoders,opsColumns:wT(this.blocks),actorIds:this.actorIds,heads:this.heads,headsIndexes:this.heads.map(r=>this.changeIndexByHash[r]),extraBytes:this.extraBytes}),this.changesEncoders=t,this.binaryDoc}getPatch(){const t={_root:{parentObj:null,parentKey:null,opId:null,type:"map",children:{}}},n={blocks:this.blocks,actorIds:this.actorIds,objectMeta:t,maxOp:0},r=this.initPatch?this.initPatch:My(n);return{maxOp:this.maxOp,clock:this.clock,deps:this.heads,pendingChanges:this.queue.length,diffs:r}}};var OT={BackendDoc:TT};function PT(e){if(e.frozen)throw new Error("Attempting to use an outdated Automerge document that has already been updated. Please use the latest document state, or call Automerge.clone() if you really need to use this old document state.");return e.state}var LT={backendState:PT};const{encodeChange:DT}=Su,{BackendDoc:P0}=OT,{backendState:Xn}=LT;function MT(){return{state:new P0,heads:[]}}function UT(e){return{state:Xn(e).clone(),heads:e.heads}}function BT(e){e.state=null,e.frozen=!0}function VT(e,t){const n=Xn(e),r=n.applyChanges(t);return e.frozen=!0,[{state:n,heads:n.heads},r]}function Uy(e,t,n){if(e.hashesByActor[t]&&e.hashesByActor[t][n]||!e.haveHashGraph&&(e.computeHashGraph(),e.hashesByActor[t]&&e.hashesByActor[t][n]))return e.hashesByActor[t][n];throw new RangeError(`Unknown change: actorId = ${t}, seq = ${n+1}`)}function $T(e,t){const n=Xn(e);if(t.seq<=n.clock[t.actor])throw new RangeError("Change request has already been applied");if(t.seq>1){const o=Uy(n,t.actor,t.seq-2);if(!o)throw new RangeError(`Cannot find hash of localChange before seq=${t.seq}`);let l={[o]:!0};for(let c of t.deps)l[c]=!0;t.deps=Object.keys(l).sort()}const r=DT(t),i=n.applyChanges([r],!0);e.frozen=!0;const a=Uy(n,t.actor,t.seq-1);return i.deps=i.deps.filter(o=>o!==a),[{state:n,heads:n.heads},i,r]}function FT(e){return Xn(e).save()}function HT(e){const t=new P0(e);return{state:t,heads:t.heads}}function qT(e,t){const n=Xn(e);return n.applyChanges(t),e.frozen=!0,{state:n,heads:n.heads}}function zT(e){return Xn(e).getPatch()}function WT(e){return e.heads}function GT(e){return L0(e,[])}function L0(e,t){if(!Array.isArray(t))throw new TypeError("Pass an array of hashes to Backend.getChanges()");return Xn(e).getChanges(t)}function YT(e,t){return Xn(t).getChangesAdded(Xn(e))}function KT(e,t){return Xn(e).getChangeByHash(t)}function JT(e,t=[]){return Xn(e).getMissingDeps(t)}var D0={init:MT,clone:UT,free:BT,applyChanges:VT,applyLocalChange:$T,save:FT,load:HT,loadChanges:qT,getPatch:zT,getHeads:WT,getAllChanges:GT,getChanges:L0,getChangesAdded:YT,getChangeByHash:KT,getMissingDeps:JT};const Kn=D0,{hexStringToBytes:M0,bytesToHexString:QT,Encoder:Vp,Decoder:$p}=o0,{decodeChangeMeta:Kc}=Su,{copyObject:ZT}=xr,U0=32,B0=66,V0=67,XT=10,eO=7;class $0{constructor(t){if(Array.isArray(t)){this.numEntries=t.length,this.numBitsPerEntry=XT,this.numProbes=eO,this.bits=new Uint8Array(Math.ceil(this.numEntries*this.numBitsPerEntry/8));for(let n of t)this.addHash(n)}else if(t instanceof Uint8Array)if(t.byteLength===0)this.numEntries=0,this.numBitsPerEntry=0,this.numProbes=0,this.bits=t;else{const n=new $p(t);this.numEntries=n.readUint32(),this.numBitsPerEntry=n.readUint32(),this.numProbes=n.readUint32(),this.bits=n.readRawBytes(Math.ceil(this.numEntries*this.numBitsPerEntry/8))}else throw new TypeError("invalid argument")}get bytes(){if(this.numEntries===0)return new Uint8Array(0);const t=new Vp;return t.appendUint32(this.numEntries),t.appendUint32(this.numBitsPerEntry),t.appendUint32(this.numProbes),t.appendRawBytes(this.bits),t.buffer}getProbes(t){const n=M0(t),r=8*this.bits.byteLength;if(n.byteLength!==32)throw new RangeError(`Not a 256-bit hash: ${t}`);let i=((n[0]|n[1]<<8|n[2]<<16|n[3]<<24)>>>0)%r,a=((n[4]|n[5]<<8|n[6]<<16|n[7]<<24)>>>0)%r,o=((n[8]|n[9]<<8|n[10]<<16|n[11]<<24)>>>0)%r;const l=[i];for(let c=1;c<this.numProbes;c++)i=(i+a)%r,a=(a+o)%r,l.push(i);return l}addHash(t){for(let n of this.getProbes(t))this.bits[n>>>3]|=1<<(n&7)}containsHash(t){if(this.numEntries===0)return!1;for(let n of this.getProbes(t))if(!(this.bits[n>>>3]&1<<(n&7)))return!1;return!0}}function hc(e,t){if(!Array.isArray(t))throw new TypeError("hashes must be an array");e.appendUint32(t.length);for(let n=0;n<t.length;n++){if(n>0&&t[n-1]>=t[n])throw new RangeError("hashes must be sorted");const r=M0(t[n]);if(r.byteLength!==U0)throw new TypeError("heads hashes must be 256 bits");e.appendRawBytes(r)}}function fc(e){let t=e.readUint32(),n=[];for(let r=0;r<t;r++)n.push(QT(e.readRawBytes(U0)));return n}function lf(e){const t=new Vp;t.appendByte(B0),hc(t,e.heads),hc(t,e.need),t.appendUint32(e.have.length);for(let n of e.have)hc(t,n.lastSync),t.appendPrefixedBytes(n.bloom);t.appendUint32(e.changes.length);for(let n of e.changes)t.appendPrefixedBytes(n);return t.buffer}function F0(e){const t=new $p(e),n=t.readByte();if(n!==B0)throw new RangeError(`Unexpected message type: ${n}`);const r=fc(t),i=fc(t),a=t.readUint32();let o={heads:r,need:i,have:[],changes:[]};for(let c=0;c<a;c++){const u=fc(t),d=t.readPrefixedBytes(t);o.have.push({lastSync:u,bloom:d})}const l=t.readUint32();for(let c=0;c<l;c++){const u=t.readPrefixedBytes();o.changes.push(u)}return o}function tO(e){const t=new Vp;return t.appendByte(V0),hc(t,e.sharedHeads),t.buffer}function nO(e){const t=new $p(e),n=t.readByte();if(n!==V0)throw new RangeError(`Unexpected record type: ${n}`);const r=fc(t);return Object.assign(H0(),{sharedHeads:r})}function rO(e,t){const r=Kn.getChanges(e,t).map(i=>Kc(i,!0).hash);return{lastSync:t,bloom:new $0(r).bytes}}function sO(e,t,n){if(t.length===0)return n.map(p=>Kn.getChangeByHash(e,p)).filter(p=>p!==void 0);let r={},i=[];for(let p of t){for(let h of p.lastSync)r[h]=!0;i.push(new $0(p.bloom))}const a=Kn.getChanges(e,Object.keys(r)).map(p=>Kc(p,!0));let o={},l={},c={};for(let p of a){o[p.hash]=!0;for(let h of p.deps)l[h]||(l[h]=[]),l[h].push(p.hash);i.every(h=>!h.containsHash(p.hash))&&(c[p.hash]=!0)}let u=Object.keys(c);for(;u.length>0;){const p=u.pop();if(l[p])for(let h of l[p])c[h]||(c[h]=!0,u.push(h))}let d=[];for(let p of n)if(c[p]=!0,!o[p]){const h=Kn.getChangeByHash(e,p);h&&d.push(h)}for(let p of a)c[p.hash]&&d.push(p.change);return d}function H0(){return{sharedHeads:[],lastSentHeads:[],theirHeads:null,theirNeed:null,theirHave:null,sentHashes:{}}}function cf(e,t){return e.length===t.length&&e.every((n,r)=>n===t[r])}function iO(e,t){if(!e)throw new Error("generateSyncMessage called with no Automerge document");if(!t)throw new Error("generateSyncMessage requires a syncState, which can be created with initSyncState()");let{sharedHeads:n,lastSentHeads:r,theirHeads:i,theirNeed:a,theirHave:o,sentHashes:l}=t;const c=Kn.getHeads(e),u=Kn.getMissingDeps(e,i||[]);let d=[];if((!i||u.every(j=>i.includes(j)))&&(d=[rO(e,n)]),o&&o.length>0&&!o[0].lastSync.every(A=>Kn.getChangeByHash(e,A))){const A={heads:c,need:[],have:[{lastSync:[],bloom:new Uint8Array(0)}],changes:[]};return[t,lf(A)]}let p=Array.isArray(o)&&Array.isArray(a)?sO(e,o,a):[];const h=Array.isArray(r)&&cf(c,r),f=Array.isArray(i)&&cf(c,i);if(h&&f&&p.length===0)return[t,null];p=p.filter(j=>!l[Kc(j,!0).hash]);const y={heads:c,have:d,need:u,changes:p};if(p.length>0){l=ZT(l);for(const j of p)l[Kc(j,!0).hash]=!0}return t=Object.assign({},t,{lastSentHeads:c,sentHashes:l}),[t,lf(y)]}function aO(e,t,n){const r=t.filter(o=>!e.includes(o)),i=n.filter(o=>t.includes(o));return[...new Set([...r,...i])].sort()}function oO(e,t,n){if(!e)throw new Error("generateSyncMessage called with no Automerge document");if(!t)throw new Error("generateSyncMessage requires a syncState, which can be created with initSyncState()");let{sharedHeads:r,lastSentHeads:i,sentHashes:a}=t,o=null;const l=F0(n),c=Kn.getHeads(e);l.changes.length>0&&([e,o]=Kn.applyChanges(e,l.changes),r=aO(c,Kn.getHeads(e),r)),l.changes.length===0&&cf(l.heads,c)&&(i=l.heads);const u=l.heads.filter(p=>Kn.getChangeByHash(e,p));u.length===l.heads.length?(r=l.heads,l.heads.length===0&&(i=[],a=[])):r=[...new Set(u.concat(r))].sort();const d={sharedHeads:r,lastSentHeads:i,theirHave:l.have,theirHeads:l.heads,theirNeed:l.need,sentHashes:a};return[e,d,o]}var lO={receiveSyncMessage:oO,generateSyncMessage:iO,encodeSyncMessage:lf,decodeSyncMessage:F0,initSyncState:H0,encodeSyncState:tO,decodeSyncState:nO};const{init:cO,clone:uO,free:dO,applyChanges:hO,applyLocalChange:fO,save:pO,load:mO,loadChanges:gO,getPatch:yO,getHeads:vO,getAllChanges:xO,getChanges:jO,getChangesAdded:bO,getChangeByHash:wO,getMissingDeps:SO}=D0,{receiveSyncMessage:EO,generateSyncMessage:NO,encodeSyncMessage:_O,decodeSyncMessage:AO,encodeSyncState:CO,decodeSyncState:kO,initSyncState:IO}=lO;var RO={init:cO,clone:uO,free:dO,applyChanges:hO,applyLocalChange:fO,save:pO,load:mO,loadChanges:gO,getPatch:yO,getHeads:vO,getAllChanges:xO,getChanges:jO,getChangesAdded:bO,getChangeByHash:wO,getMissingDeps:SO,receiveSyncMessage:EO,generateSyncMessage:NO,encodeSyncMessage:_O,decodeSyncMessage:AO,encodeSyncState:CO,decodeSyncState:kO,initSyncState:IO};(function(e){const t=xp,n=Tk,{OPTIONS:r}=ks,{encodeChange:i,decodeChange:a}=Su,{isObject:o}=xr;let l=RO;function c(U){if(typeof U=="string")U={actorId:U};else if(typeof U>"u")U={};else if(!o(U))throw new TypeError(`Unsupported options for init(): ${U}`);return n.init(Object.assign({backend:l},U))}function u(U,W){const q={message:"Initialization"};return d(c(W),q,P=>Object.assign(P,U))}function d(U,W,q){const[P]=n.change(U,W,q);return P}function p(U,W){const[q]=n.emptyChange(U,W);return q}function h(U,W={}){const q=l.clone(n.getBackendState(U,"clone"));return w(c(W),l.getPatch(q),q,[],W)}function f(U){l.free(n.getBackendState(U,"free"))}function y(U,W={}){const q=l.load(U);return w(c(W),l.getPatch(q),q,[U],W)}function j(U){return l.save(n.getBackendState(U,"save"))}function A(U,W){const q=n.getBackendState(U,"merge"),P=n.getBackendState(W,"merge","second"),V=l.getChangesAdded(q,P),[K]=E(U,V);return K}function g(U,W){const q=n.getBackendState(U,"getChanges"),P=n.getBackendState(W,"getChanges","second");return l.getChanges(P,l.getHeads(q))}function x(U){return l.getAllChanges(n.getBackendState(U,"getAllChanges"))}function w(U,W,q,P,V){const K=n.applyPatch(U,W,q),ce=V.patchCallback||U[r].patchCallback;return ce&&ce(W,U,K,!1,P),K}function E(U,W,q={}){const P=n.getBackendState(U,"applyChanges"),[V,K]=l.applyChanges(P,W);return[w(U,K,V,W,q),K]}function _(U,W){if(!o(U)||!o(W))return U===W;const q=Object.keys(U).sort(),P=Object.keys(W).sort();if(q.length!==P.length)return!1;for(let V=0;V<q.length;V++)if(q[V]!==P[V]||!_(U[q[V]],W[P[V]]))return!1;return!0}function b(U){const W=n.getActorId(U),q=x(U);return q.map((P,V)=>({get change(){return a(P)},get snapshot(){const K=l.loadChanges(l.init(),q.slice(0,V+1));return n.applyPatch(c(W),l.getPatch(K),K)}}))}function R(U,W){const q=n.getBackendState(U,"generateSyncMessage");return l.generateSyncMessage(q,W)}function C(U,W,q){const P=n.getBackendState(U,"receiveSyncMessage"),[V,K,ce]=l.receiveSyncMessage(P,W,q);if(!ce)return[U,K,ce];let M=null;return U[r].patchCallback&&(M=l.decodeSyncMessage(q).changes),[w(U,ce,V,M,{}),K,ce]}function T(){return l.initSyncState()}function D(U){l=U}e.exports={init:c,from:u,change:d,emptyChange:p,clone:h,free:f,load:y,save:j,merge:A,getChanges:g,getAllChanges:x,applyChanges:E,encodeChange:i,decodeChange:a,equals:_,getHistory:b,uuid:t,Frontend:n,setDefaultBackend:D,generateSyncMessage:R,receiveSyncMessage:C,initSyncState:T,get Backend(){return l}};for(let U of["getObjectId","getObjectById","getActorId","setActorId","getConflicts","getLastLocalChange","Text","Table","Counter","Observable","Int","Uint","Float64"])e.exports[U]=n[U]})(Gj);var TO=Gj.exports;const oi=df(TO);function Fl(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var q0={exports:{}};/*!
    localForage -- Offline Storage, Improved
    Version 1.10.0
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/(function(e,t){(function(n){e.exports=n()})(function(){return function n(r,i,a){function o(u,d){if(!i[u]){if(!r[u]){var p=typeof Fl=="function"&&Fl;if(!d&&p)return p(u,!0);if(l)return l(u,!0);var h=new Error("Cannot find module '"+u+"'");throw h.code="MODULE_NOT_FOUND",h}var f=i[u]={exports:{}};r[u][0].call(f.exports,function(y){var j=r[u][1][y];return o(j||y)},f,f.exports,n,r,i,a)}return i[u].exports}for(var l=typeof Fl=="function"&&Fl,c=0;c<a.length;c++)o(a[c]);return o}({1:[function(n,r,i){(function(a){var o=a.MutationObserver||a.WebKitMutationObserver,l;if(o){var c=0,u=new o(y),d=a.document.createTextNode("");u.observe(d,{characterData:!0}),l=function(){d.data=c=++c%2}}else if(!a.setImmediate&&typeof a.MessageChannel<"u"){var p=new a.MessageChannel;p.port1.onmessage=y,l=function(){p.port2.postMessage(0)}}else"document"in a&&"onreadystatechange"in a.document.createElement("script")?l=function(){var A=a.document.createElement("script");A.onreadystatechange=function(){y(),A.onreadystatechange=null,A.parentNode.removeChild(A),A=null},a.document.documentElement.appendChild(A)}:l=function(){setTimeout(y,0)};var h,f=[];function y(){h=!0;for(var A,g,x=f.length;x;){for(g=f,f=[],A=-1;++A<x;)g[A]();x=f.length}h=!1}r.exports=j;function j(A){f.push(A)===1&&!h&&l()}}).call(this,typeof Xa<"u"?Xa:typeof self<"u"?self:typeof window<"u"?window:{})},{}],2:[function(n,r,i){var a=n(1);function o(){}var l={},c=["REJECTED"],u=["FULFILLED"],d=["PENDING"];r.exports=p;function p(_){if(typeof _!="function")throw new TypeError("resolver must be a function");this.state=d,this.queue=[],this.outcome=void 0,_!==o&&j(this,_)}p.prototype.catch=function(_){return this.then(null,_)},p.prototype.then=function(_,b){if(typeof _!="function"&&this.state===u||typeof b!="function"&&this.state===c)return this;var R=new this.constructor(o);if(this.state!==d){var C=this.state===u?_:b;f(R,C,this.outcome)}else this.queue.push(new h(R,_,b));return R};function h(_,b,R){this.promise=_,typeof b=="function"&&(this.onFulfilled=b,this.callFulfilled=this.otherCallFulfilled),typeof R=="function"&&(this.onRejected=R,this.callRejected=this.otherCallRejected)}h.prototype.callFulfilled=function(_){l.resolve(this.promise,_)},h.prototype.otherCallFulfilled=function(_){f(this.promise,this.onFulfilled,_)},h.prototype.callRejected=function(_){l.reject(this.promise,_)},h.prototype.otherCallRejected=function(_){f(this.promise,this.onRejected,_)};function f(_,b,R){a(function(){var C;try{C=b(R)}catch(T){return l.reject(_,T)}C===_?l.reject(_,new TypeError("Cannot resolve promise with itself")):l.resolve(_,C)})}l.resolve=function(_,b){var R=A(y,b);if(R.status==="error")return l.reject(_,R.value);var C=R.value;if(C)j(_,C);else{_.state=u,_.outcome=b;for(var T=-1,D=_.queue.length;++T<D;)_.queue[T].callFulfilled(b)}return _},l.reject=function(_,b){_.state=c,_.outcome=b;for(var R=-1,C=_.queue.length;++R<C;)_.queue[R].callRejected(b);return _};function y(_){var b=_&&_.then;if(_&&(typeof _=="object"||typeof _=="function")&&typeof b=="function")return function(){b.apply(_,arguments)}}function j(_,b){var R=!1;function C(W){R||(R=!0,l.reject(_,W))}function T(W){R||(R=!0,l.resolve(_,W))}function D(){b(T,C)}var U=A(D);U.status==="error"&&C(U.value)}function A(_,b){var R={};try{R.value=_(b),R.status="success"}catch(C){R.status="error",R.value=C}return R}p.resolve=g;function g(_){return _ instanceof this?_:l.resolve(new this(o),_)}p.reject=x;function x(_){var b=new this(o);return l.reject(b,_)}p.all=w;function w(_){var b=this;if(Object.prototype.toString.call(_)!=="[object Array]")return this.reject(new TypeError("must be an array"));var R=_.length,C=!1;if(!R)return this.resolve([]);for(var T=new Array(R),D=0,U=-1,W=new this(o);++U<R;)q(_[U],U);return W;function q(P,V){b.resolve(P).then(K,function(ce){C||(C=!0,l.reject(W,ce))});function K(ce){T[V]=ce,++D===R&&!C&&(C=!0,l.resolve(W,T))}}}p.race=E;function E(_){var b=this;if(Object.prototype.toString.call(_)!=="[object Array]")return this.reject(new TypeError("must be an array"));var R=_.length,C=!1;if(!R)return this.resolve([]);for(var T=-1,D=new this(o);++T<R;)U(_[T]);return D;function U(W){b.resolve(W).then(function(q){C||(C=!0,l.resolve(D,q))},function(q){C||(C=!0,l.reject(D,q))})}}},{1:1}],3:[function(n,r,i){(function(a){typeof a.Promise!="function"&&(a.Promise=n(2))}).call(this,typeof Xa<"u"?Xa:typeof self<"u"?self:typeof window<"u"?window:{})},{2:2}],4:[function(n,r,i){var a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(v){return typeof v}:function(v){return v&&typeof Symbol=="function"&&v.constructor===Symbol&&v!==Symbol.prototype?"symbol":typeof v};function o(v,k){if(!(v instanceof k))throw new TypeError("Cannot call a class as a function")}function l(){try{if(typeof indexedDB<"u")return indexedDB;if(typeof webkitIndexedDB<"u")return webkitIndexedDB;if(typeof mozIndexedDB<"u")return mozIndexedDB;if(typeof OIndexedDB<"u")return OIndexedDB;if(typeof msIndexedDB<"u")return msIndexedDB}catch{return}}var c=l();function u(){try{if(!c||!c.open)return!1;var v=typeof openDatabase<"u"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),k=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!v||k)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch{return!1}}function d(v,k){v=v||[],k=k||{};try{return new Blob(v,k)}catch(O){if(O.name!=="TypeError")throw O;for(var N=typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder,S=new N,L=0;L<v.length;L+=1)S.append(v[L]);return S.getBlob(k.type)}}typeof Promise>"u"&&n(3);var p=Promise;function h(v,k){k&&v.then(function(N){k(null,N)},function(N){k(N)})}function f(v,k,N){typeof k=="function"&&v.then(k),typeof N=="function"&&v.catch(N)}function y(v){return typeof v!="string"&&(console.warn(v+" used as a key, but it is not a string."),v=String(v)),v}function j(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var A="local-forage-detect-blob-support",g=void 0,x={},w=Object.prototype.toString,E="readonly",_="readwrite";function b(v){for(var k=v.length,N=new ArrayBuffer(k),S=new Uint8Array(N),L=0;L<k;L++)S[L]=v.charCodeAt(L);return N}function R(v){return new p(function(k){var N=v.transaction(A,_),S=d([""]);N.objectStore(A).put(S,"key"),N.onabort=function(L){L.preventDefault(),L.stopPropagation(),k(!1)},N.oncomplete=function(){var L=navigator.userAgent.match(/Chrome\/(\d+)/),O=navigator.userAgent.match(/Edge\//);k(O||!L||parseInt(L[1],10)>=43)}}).catch(function(){return!1})}function C(v){return typeof g=="boolean"?p.resolve(g):R(v).then(function(k){return g=k,g})}function T(v){var k=x[v.name],N={};N.promise=new p(function(S,L){N.resolve=S,N.reject=L}),k.deferredOperations.push(N),k.dbReady?k.dbReady=k.dbReady.then(function(){return N.promise}):k.dbReady=N.promise}function D(v){var k=x[v.name],N=k.deferredOperations.pop();if(N)return N.resolve(),N.promise}function U(v,k){var N=x[v.name],S=N.deferredOperations.pop();if(S)return S.reject(k),S.promise}function W(v,k){return new p(function(N,S){if(x[v.name]=x[v.name]||fe(),v.db)if(k)T(v),v.db.close();else return N(v.db);var L=[v.name];k&&L.push(v.version);var O=c.open.apply(c,L);k&&(O.onupgradeneeded=function($){var H=O.result;try{H.createObjectStore(v.storeName),$.oldVersion<=1&&H.createObjectStore(A)}catch(G){if(G.name==="ConstraintError")console.warn('The database "'+v.name+'" has been upgraded from version '+$.oldVersion+" to version "+$.newVersion+', but the storage "'+v.storeName+'" already exists.');else throw G}}),O.onerror=function($){$.preventDefault(),S(O.error)},O.onsuccess=function(){var $=O.result;$.onversionchange=function(H){H.target.close()},N($),D(v)}})}function q(v){return W(v,!1)}function P(v){return W(v,!0)}function V(v,k){if(!v.db)return!0;var N=!v.db.objectStoreNames.contains(v.storeName),S=v.version<v.db.version,L=v.version>v.db.version;if(S&&(v.version!==k&&console.warn('The database "'+v.name+`" can't be downgraded from version `+v.db.version+" to version "+v.version+"."),v.version=v.db.version),L||N){if(N){var O=v.db.version+1;O>v.version&&(v.version=O)}return!0}return!1}function K(v){return new p(function(k,N){var S=new FileReader;S.onerror=N,S.onloadend=function(L){var O=btoa(L.target.result||"");k({__local_forage_encoded_blob:!0,data:O,type:v.type})},S.readAsBinaryString(v)})}function ce(v){var k=b(atob(v.data));return d([k],{type:v.type})}function M(v){return v&&v.__local_forage_encoded_blob}function X(v){var k=this,N=k._initReady().then(function(){var S=x[k._dbInfo.name];if(S&&S.dbReady)return S.dbReady});return f(N,v,v),N}function ae(v){T(v);for(var k=x[v.name],N=k.forages,S=0;S<N.length;S++){var L=N[S];L._dbInfo.db&&(L._dbInfo.db.close(),L._dbInfo.db=null)}return v.db=null,q(v).then(function(O){return v.db=O,V(v)?P(v):O}).then(function(O){v.db=k.db=O;for(var $=0;$<N.length;$++)N[$]._dbInfo.db=O}).catch(function(O){throw U(v,O),O})}function pe(v,k,N,S){S===void 0&&(S=1);try{var L=v.db.transaction(v.storeName,k);N(null,L)}catch(O){if(S>0&&(!v.db||O.name==="InvalidStateError"||O.name==="NotFoundError"))return p.resolve().then(function(){if(!v.db||O.name==="NotFoundError"&&!v.db.objectStoreNames.contains(v.storeName)&&v.version<=v.db.version)return v.db&&(v.version=v.db.version+1),P(v)}).then(function(){return ae(v).then(function(){pe(v,k,N,S-1)})}).catch(N);N(O)}}function fe(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function De(v){var k=this,N={db:null};if(v)for(var S in v)N[S]=v[S];var L=x[N.name];L||(L=fe(),x[N.name]=L),L.forages.push(k),k._initReady||(k._initReady=k.ready,k.ready=X);var O=[];function $(){return p.resolve()}for(var H=0;H<L.forages.length;H++){var G=L.forages[H];G!==k&&O.push(G._initReady().catch($))}var re=L.forages.slice(0);return p.all(O).then(function(){return N.db=L.db,q(N)}).then(function(ie){return N.db=ie,V(N,k._defaultConfig.version)?P(N):ie}).then(function(ie){N.db=L.db=ie,k._dbInfo=N;for(var he=0;he<re.length;he++){var Ne=re[he];Ne!==k&&(Ne._dbInfo.db=N.db,Ne._dbInfo.version=N.version)}})}function F(v,k){var N=this;v=y(v);var S=new p(function(L,O){N.ready().then(function(){pe(N._dbInfo,E,function($,H){if($)return O($);try{var G=H.objectStore(N._dbInfo.storeName),re=G.get(v);re.onsuccess=function(){var ie=re.result;ie===void 0&&(ie=null),M(ie)&&(ie=ce(ie)),L(ie)},re.onerror=function(){O(re.error)}}catch(ie){O(ie)}})}).catch(O)});return h(S,k),S}function Z(v,k){var N=this,S=new p(function(L,O){N.ready().then(function(){pe(N._dbInfo,E,function($,H){if($)return O($);try{var G=H.objectStore(N._dbInfo.storeName),re=G.openCursor(),ie=1;re.onsuccess=function(){var he=re.result;if(he){var Ne=he.value;M(Ne)&&(Ne=ce(Ne));var Be=v(Ne,he.key,ie++);Be!==void 0?L(Be):he.continue()}else L()},re.onerror=function(){O(re.error)}}catch(he){O(he)}})}).catch(O)});return h(S,k),S}function Y(v,k,N){var S=this;v=y(v);var L=new p(function(O,$){var H;S.ready().then(function(){return H=S._dbInfo,w.call(k)==="[object Blob]"?C(H.db).then(function(G){return G?k:K(k)}):k}).then(function(G){pe(S._dbInfo,_,function(re,ie){if(re)return $(re);try{var he=ie.objectStore(S._dbInfo.storeName);G===null&&(G=void 0);var Ne=he.put(G,v);ie.oncomplete=function(){G===void 0&&(G=null),O(G)},ie.onabort=ie.onerror=function(){var Be=Ne.error?Ne.error:Ne.transaction.error;$(Be)}}catch(Be){$(Be)}})}).catch($)});return h(L,N),L}function ye(v,k){var N=this;v=y(v);var S=new p(function(L,O){N.ready().then(function(){pe(N._dbInfo,_,function($,H){if($)return O($);try{var G=H.objectStore(N._dbInfo.storeName),re=G.delete(v);H.oncomplete=function(){L()},H.onerror=function(){O(re.error)},H.onabort=function(){var ie=re.error?re.error:re.transaction.error;O(ie)}}catch(ie){O(ie)}})}).catch(O)});return h(S,k),S}function ge(v){var k=this,N=new p(function(S,L){k.ready().then(function(){pe(k._dbInfo,_,function(O,$){if(O)return L(O);try{var H=$.objectStore(k._dbInfo.storeName),G=H.clear();$.oncomplete=function(){S()},$.onabort=$.onerror=function(){var re=G.error?G.error:G.transaction.error;L(re)}}catch(re){L(re)}})}).catch(L)});return h(N,v),N}function Ke(v){var k=this,N=new p(function(S,L){k.ready().then(function(){pe(k._dbInfo,E,function(O,$){if(O)return L(O);try{var H=$.objectStore(k._dbInfo.storeName),G=H.count();G.onsuccess=function(){S(G.result)},G.onerror=function(){L(G.error)}}catch(re){L(re)}})}).catch(L)});return h(N,v),N}function Ae(v,k){var N=this,S=new p(function(L,O){if(v<0){L(null);return}N.ready().then(function(){pe(N._dbInfo,E,function($,H){if($)return O($);try{var G=H.objectStore(N._dbInfo.storeName),re=!1,ie=G.openKeyCursor();ie.onsuccess=function(){var he=ie.result;if(!he){L(null);return}v===0||re?L(he.key):(re=!0,he.advance(v))},ie.onerror=function(){O(ie.error)}}catch(he){O(he)}})}).catch(O)});return h(S,k),S}function Fe(v){var k=this,N=new p(function(S,L){k.ready().then(function(){pe(k._dbInfo,E,function(O,$){if(O)return L(O);try{var H=$.objectStore(k._dbInfo.storeName),G=H.openKeyCursor(),re=[];G.onsuccess=function(){var ie=G.result;if(!ie){S(re);return}re.push(ie.key),ie.continue()},G.onerror=function(){L(G.error)}}catch(ie){L(ie)}})}).catch(L)});return h(N,v),N}function ne(v,k){k=j.apply(this,arguments);var N=this.config();v=typeof v!="function"&&v||{},v.name||(v.name=v.name||N.name,v.storeName=v.storeName||N.storeName);var S=this,L;if(!v.name)L=p.reject("Invalid arguments");else{var O=v.name===N.name&&S._dbInfo.db,$=O?p.resolve(S._dbInfo.db):q(v).then(function(H){var G=x[v.name],re=G.forages;G.db=H;for(var ie=0;ie<re.length;ie++)re[ie]._dbInfo.db=H;return H});v.storeName?L=$.then(function(H){if(H.objectStoreNames.contains(v.storeName)){var G=H.version+1;T(v);var re=x[v.name],ie=re.forages;H.close();for(var he=0;he<ie.length;he++){var Ne=ie[he];Ne._dbInfo.db=null,Ne._dbInfo.version=G}var Be=new p(function($e,at){var et=c.open(v.name,G);et.onerror=function(_t){var _n=et.result;_n.close(),at(_t)},et.onupgradeneeded=function(){var _t=et.result;_t.deleteObjectStore(v.storeName)},et.onsuccess=function(){var _t=et.result;_t.close(),$e(_t)}});return Be.then(function($e){re.db=$e;for(var at=0;at<ie.length;at++){var et=ie[at];et._dbInfo.db=$e,D(et._dbInfo)}}).catch(function($e){throw(U(v,$e)||p.resolve()).catch(function(){}),$e})}}):L=$.then(function(H){T(v);var G=x[v.name],re=G.forages;H.close();for(var ie=0;ie<re.length;ie++){var he=re[ie];he._dbInfo.db=null}var Ne=new p(function(Be,$e){var at=c.deleteDatabase(v.name);at.onerror=function(){var et=at.result;et&&et.close(),$e(at.error)},at.onblocked=function(){console.warn('dropInstance blocked for database "'+v.name+'" until all open connections are closed')},at.onsuccess=function(){var et=at.result;et&&et.close(),Be(et)}});return Ne.then(function(Be){G.db=Be;for(var $e=0;$e<re.length;$e++){var at=re[$e];D(at._dbInfo)}}).catch(function(Be){throw(U(v,Be)||p.resolve()).catch(function(){}),Be})})}return h(L,k),L}var me={_driver:"asyncStorage",_initStorage:De,_support:u(),iterate:Z,getItem:F,setItem:Y,removeItem:ye,clear:ge,length:Ke,key:Ae,keys:Fe,dropInstance:ne};function se(){return typeof openDatabase=="function"}var be="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Me="~~local_forage_type~",mt=/^~~local_forage_type~([^~]+)~/,Pt="__lfsc__:",we=Pt.length,Ie="arbf",st="blob",ve="si08",Ue="ui08",Se="uic8",it="si16",xe="si32",St="ur16",Jt="ui32",fn="fl32",Ht="fl64",Un=we+Ie.length,Qt=Object.prototype.toString;function En(v){var k=v.length*.75,N=v.length,S,L=0,O,$,H,G;v[v.length-1]==="="&&(k--,v[v.length-2]==="="&&k--);var re=new ArrayBuffer(k),ie=new Uint8Array(re);for(S=0;S<N;S+=4)O=be.indexOf(v[S]),$=be.indexOf(v[S+1]),H=be.indexOf(v[S+2]),G=be.indexOf(v[S+3]),ie[L++]=O<<2|$>>4,ie[L++]=($&15)<<4|H>>2,ie[L++]=(H&3)<<6|G&63;return re}function je(v){var k=new Uint8Array(v),N="",S;for(S=0;S<k.length;S+=3)N+=be[k[S]>>2],N+=be[(k[S]&3)<<4|k[S+1]>>4],N+=be[(k[S+1]&15)<<2|k[S+2]>>6],N+=be[k[S+2]&63];return k.length%3===2?N=N.substring(0,N.length-1)+"=":k.length%3===1&&(N=N.substring(0,N.length-2)+"=="),N}function Ee(v,k){var N="";if(v&&(N=Qt.call(v)),v&&(N==="[object ArrayBuffer]"||v.buffer&&Qt.call(v.buffer)==="[object ArrayBuffer]")){var S,L=Pt;v instanceof ArrayBuffer?(S=v,L+=Ie):(S=v.buffer,N==="[object Int8Array]"?L+=ve:N==="[object Uint8Array]"?L+=Ue:N==="[object Uint8ClampedArray]"?L+=Se:N==="[object Int16Array]"?L+=it:N==="[object Uint16Array]"?L+=St:N==="[object Int32Array]"?L+=xe:N==="[object Uint32Array]"?L+=Jt:N==="[object Float32Array]"?L+=fn:N==="[object Float64Array]"?L+=Ht:k(new Error("Failed to get type for BinaryArray"))),k(L+je(S))}else if(N==="[object Blob]"){var O=new FileReader;O.onload=function(){var $=Me+v.type+"~"+je(this.result);k(Pt+st+$)},O.readAsArrayBuffer(v)}else try{k(JSON.stringify(v))}catch($){console.error("Couldn't convert value into a JSON string: ",v),k(null,$)}}function dt(v){if(v.substring(0,we)!==Pt)return JSON.parse(v);var k=v.substring(Un),N=v.substring(we,Un),S;if(N===st&&mt.test(k)){var L=k.match(mt);S=L[1],k=k.substring(L[0].length)}var O=En(k);switch(N){case Ie:return O;case st:return d([O],{type:S});case ve:return new Int8Array(O);case Ue:return new Uint8Array(O);case Se:return new Uint8ClampedArray(O);case it:return new Int16Array(O);case St:return new Uint16Array(O);case xe:return new Int32Array(O);case Jt:return new Uint32Array(O);case fn:return new Float32Array(O);case Ht:return new Float64Array(O);default:throw new Error("Unkown type: "+N)}}var gt={serialize:Ee,deserialize:dt,stringToBuffer:En,bufferToString:je};function kt(v,k,N,S){v.executeSql("CREATE TABLE IF NOT EXISTS "+k.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],N,S)}function Et(v){var k=this,N={db:null};if(v)for(var S in v)N[S]=typeof v[S]!="string"?v[S].toString():v[S];var L=new p(function(O,$){try{N.db=openDatabase(N.name,String(N.version),N.description,N.size)}catch(H){return $(H)}N.db.transaction(function(H){kt(H,N,function(){k._dbInfo=N,O()},function(G,re){$(re)})},$)});return N.serializer=gt,L}function Oe(v,k,N,S,L,O){v.executeSql(N,S,L,function($,H){H.code===H.SYNTAX_ERR?$.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[k.storeName],function(G,re){re.rows.length?O(G,H):kt(G,k,function(){G.executeSql(N,S,L,O)},O)},O):O($,H)},O)}function Nt(v,k){var N=this;v=y(v);var S=new p(function(L,O){N.ready().then(function(){var $=N._dbInfo;$.db.transaction(function(H){Oe(H,$,"SELECT * FROM "+$.storeName+" WHERE key = ? LIMIT 1",[v],function(G,re){var ie=re.rows.length?re.rows.item(0).value:null;ie&&(ie=$.serializer.deserialize(ie)),L(ie)},function(G,re){O(re)})})}).catch(O)});return h(S,k),S}function tr(v,k){var N=this,S=new p(function(L,O){N.ready().then(function(){var $=N._dbInfo;$.db.transaction(function(H){Oe(H,$,"SELECT * FROM "+$.storeName,[],function(G,re){for(var ie=re.rows,he=ie.length,Ne=0;Ne<he;Ne++){var Be=ie.item(Ne),$e=Be.value;if($e&&($e=$.serializer.deserialize($e)),$e=v($e,Be.key,Ne+1),$e!==void 0){L($e);return}}L()},function(G,re){O(re)})})}).catch(O)});return h(S,k),S}function pn(v,k,N,S){var L=this;v=y(v);var O=new p(function($,H){L.ready().then(function(){k===void 0&&(k=null);var G=k,re=L._dbInfo;re.serializer.serialize(k,function(ie,he){he?H(he):re.db.transaction(function(Ne){Oe(Ne,re,"INSERT OR REPLACE INTO "+re.storeName+" (key, value) VALUES (?, ?)",[v,ie],function(){$(G)},function(Be,$e){H($e)})},function(Ne){if(Ne.code===Ne.QUOTA_ERR){if(S>0){$(pn.apply(L,[v,G,N,S-1]));return}H(Ne)}})})}).catch(H)});return h(O,N),O}function Is(v,k,N){return pn.apply(this,[v,k,N,1])}function yt(v,k){var N=this;v=y(v);var S=new p(function(L,O){N.ready().then(function(){var $=N._dbInfo;$.db.transaction(function(H){Oe(H,$,"DELETE FROM "+$.storeName+" WHERE key = ?",[v],function(){L()},function(G,re){O(re)})})}).catch(O)});return h(S,k),S}function Bn(v){var k=this,N=new p(function(S,L){k.ready().then(function(){var O=k._dbInfo;O.db.transaction(function($){Oe($,O,"DELETE FROM "+O.storeName,[],function(){S()},function(H,G){L(G)})})}).catch(L)});return h(N,v),N}function It(v){var k=this,N=new p(function(S,L){k.ready().then(function(){var O=k._dbInfo;O.db.transaction(function($){Oe($,O,"SELECT COUNT(key) as c FROM "+O.storeName,[],function(H,G){var re=G.rows.item(0).c;S(re)},function(H,G){L(G)})})}).catch(L)});return h(N,v),N}function Rs(v,k){var N=this,S=new p(function(L,O){N.ready().then(function(){var $=N._dbInfo;$.db.transaction(function(H){Oe(H,$,"SELECT key FROM "+$.storeName+" WHERE id = ? LIMIT 1",[v+1],function(G,re){var ie=re.rows.length?re.rows.item(0).key:null;L(ie)},function(G,re){O(re)})})}).catch(O)});return h(S,k),S}function Ts(v){var k=this,N=new p(function(S,L){k.ready().then(function(){var O=k._dbInfo;O.db.transaction(function($){Oe($,O,"SELECT key FROM "+O.storeName,[],function(H,G){for(var re=[],ie=0;ie<G.rows.length;ie++)re.push(G.rows.item(ie).key);S(re)},function(H,G){L(G)})})}).catch(L)});return h(N,v),N}function Ma(v){return new p(function(k,N){v.transaction(function(S){S.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(L,O){for(var $=[],H=0;H<O.rows.length;H++)$.push(O.rows.item(H).name);k({db:v,storeNames:$})},function(L,O){N(O)})},function(S){N(S)})})}function Os(v,k){k=j.apply(this,arguments);var N=this.config();v=typeof v!="function"&&v||{},v.name||(v.name=v.name||N.name,v.storeName=v.storeName||N.storeName);var S=this,L;return v.name?L=new p(function(O){var $;v.name===N.name?$=S._dbInfo.db:$=openDatabase(v.name,"","",0),v.storeName?O({db:$,storeNames:[v.storeName]}):O(Ma($))}).then(function(O){return new p(function($,H){O.db.transaction(function(G){function re(Be){return new p(function($e,at){G.executeSql("DROP TABLE IF EXISTS "+Be,[],function(){$e()},function(et,_t){at(_t)})})}for(var ie=[],he=0,Ne=O.storeNames.length;he<Ne;he++)ie.push(re(O.storeNames[he]));p.all(ie).then(function(){$()}).catch(function(Be){H(Be)})},function(G){H(G)})})}):L=p.reject("Invalid arguments"),h(L,k),L}var Ua={_driver:"webSQLStorage",_initStorage:Et,_support:se(),iterate:tr,getItem:Nt,setItem:Is,removeItem:yt,clear:Bn,length:It,key:Rs,keys:Ts,dropInstance:Os};function Ps(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}function z(v,k){var N=v.name+"/";return v.storeName!==k.storeName&&(N+=v.storeName+"/"),N}function Rt(){var v="_localforage_support_test";try{return localStorage.setItem(v,!0),localStorage.removeItem(v),!1}catch{return!0}}function bi(){return!Rt()||localStorage.length>0}function wi(v){var k=this,N={};if(v)for(var S in v)N[S]=v[S];return N.keyPrefix=z(v,k._defaultConfig),bi()?(k._dbInfo=N,N.serializer=gt,p.resolve()):p.reject()}function Si(v){var k=this,N=k.ready().then(function(){for(var S=k._dbInfo.keyPrefix,L=localStorage.length-1;L>=0;L--){var O=localStorage.key(L);O.indexOf(S)===0&&localStorage.removeItem(O)}});return h(N,v),N}function Ei(v,k){var N=this;v=y(v);var S=N.ready().then(function(){var L=N._dbInfo,O=localStorage.getItem(L.keyPrefix+v);return O&&(O=L.serializer.deserialize(O)),O});return h(S,k),S}function Ni(v,k){var N=this,S=N.ready().then(function(){for(var L=N._dbInfo,O=L.keyPrefix,$=O.length,H=localStorage.length,G=1,re=0;re<H;re++){var ie=localStorage.key(re);if(ie.indexOf(O)===0){var he=localStorage.getItem(ie);if(he&&(he=L.serializer.deserialize(he)),he=v(he,ie.substring($),G++),he!==void 0)return he}}});return h(S,k),S}function _i(v,k){var N=this,S=N.ready().then(function(){var L=N._dbInfo,O;try{O=localStorage.key(v)}catch{O=null}return O&&(O=O.substring(L.keyPrefix.length)),O});return h(S,k),S}function Ai(v){var k=this,N=k.ready().then(function(){for(var S=k._dbInfo,L=localStorage.length,O=[],$=0;$<L;$++){var H=localStorage.key($);H.indexOf(S.keyPrefix)===0&&O.push(H.substring(S.keyPrefix.length))}return O});return h(N,v),N}function Ci(v){var k=this,N=k.keys().then(function(S){return S.length});return h(N,v),N}function ki(v,k){var N=this;v=y(v);var S=N.ready().then(function(){var L=N._dbInfo;localStorage.removeItem(L.keyPrefix+v)});return h(S,k),S}function Ls(v,k,N){var S=this;v=y(v);var L=S.ready().then(function(){k===void 0&&(k=null);var O=k;return new p(function($,H){var G=S._dbInfo;G.serializer.serialize(k,function(re,ie){if(ie)H(ie);else try{localStorage.setItem(G.keyPrefix+v,re),$(O)}catch(he){(he.name==="QuotaExceededError"||he.name==="NS_ERROR_DOM_QUOTA_REACHED")&&H(he),H(he)}})})});return h(L,N),L}function Ds(v,k){if(k=j.apply(this,arguments),v=typeof v!="function"&&v||{},!v.name){var N=this.config();v.name=v.name||N.name,v.storeName=v.storeName||N.storeName}var S=this,L;return v.name?L=new p(function(O){v.storeName?O(z(v,S._defaultConfig)):O(v.name+"/")}).then(function(O){for(var $=localStorage.length-1;$>=0;$--){var H=localStorage.key($);H.indexOf(O)===0&&localStorage.removeItem(H)}}):L=p.reject("Invalid arguments"),h(L,k),L}var Ms={_driver:"localStorageWrapper",_initStorage:wi,_support:Ps(),iterate:Ni,getItem:Ei,setItem:Ls,removeItem:ki,clear:Si,length:Ci,key:_i,keys:Ai,dropInstance:Ds},Us=function(k,N){return k===N||typeof k=="number"&&typeof N=="number"&&isNaN(k)&&isNaN(N)},Bs=function(k,N){for(var S=k.length,L=0;L<S;){if(Us(k[L],N))return!0;L++}return!1},qr=Array.isArray||function(v){return Object.prototype.toString.call(v)==="[object Array]"},Vn={},zr={},Nn={INDEXEDDB:me,WEBSQL:Ua,LOCALSTORAGE:Ms},Vs=[Nn.INDEXEDDB._driver,Nn.WEBSQL._driver,Nn.LOCALSTORAGE._driver],nr=["dropInstance"],wr=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(nr),$s={description:"",driver:Vs.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function Fs(v,k){v[k]=function(){var N=arguments;return v.ready().then(function(){return v[k].apply(v,N)})}}function Sr(){for(var v=1;v<arguments.length;v++){var k=arguments[v];if(k)for(var N in k)k.hasOwnProperty(N)&&(qr(k[N])?arguments[0][N]=k[N].slice():arguments[0][N]=k[N])}return arguments[0]}var I=function(){function v(k){o(this,v);for(var N in Nn)if(Nn.hasOwnProperty(N)){var S=Nn[N],L=S._driver;this[N]=L,Vn[L]||this.defineDriver(S)}this._defaultConfig=Sr({},$s),this._config=Sr({},this._defaultConfig,k),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return v.prototype.config=function(N){if((typeof N>"u"?"undefined":a(N))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var S in N){if(S==="storeName"&&(N[S]=N[S].replace(/\W/g,"_")),S==="version"&&typeof N[S]!="number")return new Error("Database version must be a number.");this._config[S]=N[S]}return"driver"in N&&N.driver?this.setDriver(this._config.driver):!0}else return typeof N=="string"?this._config[N]:this._config},v.prototype.defineDriver=function(N,S,L){var O=new p(function($,H){try{var G=N._driver,re=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!N._driver){H(re);return}for(var ie=wr.concat("_initStorage"),he=0,Ne=ie.length;he<Ne;he++){var Be=ie[he],$e=!Bs(nr,Be);if(($e||N[Be])&&typeof N[Be]!="function"){H(re);return}}var at=function(){for(var _n=function(Nu){return function(){var mn=new Error("Method "+Nu+" is not implemented by the current driver"),ht=p.reject(mn);return h(ht,arguments[arguments.length-1]),ht}},rr=0,dl=nr.length;rr<dl;rr++){var Ii=nr[rr];N[Ii]||(N[Ii]=_n(Ii))}};at();var et=function(_n){Vn[G]&&console.info("Redefining LocalForage driver: "+G),Vn[G]=N,zr[G]=_n,$()};"_support"in N?N._support&&typeof N._support=="function"?N._support().then(et,H):et(!!N._support):et(!0)}catch(_t){H(_t)}});return f(O,S,L),O},v.prototype.driver=function(){return this._driver||null},v.prototype.getDriver=function(N,S,L){var O=Vn[N]?p.resolve(Vn[N]):p.reject(new Error("Driver not found."));return f(O,S,L),O},v.prototype.getSerializer=function(N){var S=p.resolve(gt);return f(S,N),S},v.prototype.ready=function(N){var S=this,L=S._driverSet.then(function(){return S._ready===null&&(S._ready=S._initDriver()),S._ready});return f(L,N,N),L},v.prototype.setDriver=function(N,S,L){var O=this;qr(N)||(N=[N]);var $=this._getSupportedDrivers(N);function H(){O._config.driver=O.driver()}function G(he){return O._extend(he),H(),O._ready=O._initStorage(O._config),O._ready}function re(he){return function(){var Ne=0;function Be(){for(;Ne<he.length;){var $e=he[Ne];return Ne++,O._dbInfo=null,O._ready=null,O.getDriver($e).then(G).catch(Be)}H();var at=new Error("No available storage method found.");return O._driverSet=p.reject(at),O._driverSet}return Be()}}var ie=this._driverSet!==null?this._driverSet.catch(function(){return p.resolve()}):p.resolve();return this._driverSet=ie.then(function(){var he=$[0];return O._dbInfo=null,O._ready=null,O.getDriver(he).then(function(Ne){O._driver=Ne._driver,H(),O._wrapLibraryMethodsWithReady(),O._initDriver=re($)})}).catch(function(){H();var he=new Error("No available storage method found.");return O._driverSet=p.reject(he),O._driverSet}),f(this._driverSet,S,L),this._driverSet},v.prototype.supports=function(N){return!!zr[N]},v.prototype._extend=function(N){Sr(this,N)},v.prototype._getSupportedDrivers=function(N){for(var S=[],L=0,O=N.length;L<O;L++){var $=N[L];this.supports($)&&S.push($)}return S},v.prototype._wrapLibraryMethodsWithReady=function(){for(var N=0,S=wr.length;N<S;N++)Fs(this,wr[N])},v.prototype.createInstance=function(N){return new v(N)},v}(),B=new I;r.exports=B},{3:3}]},{},[4])(4)})})(q0);var OO=q0.exports;const Fp=df(OO);Fp.config({name:"AfyaLinkCRDT"});async function PO(e){const t=await Fp.getItem("doc:"+e);let n;if(t&&t.bin)try{n=oi.load(Uint8Array.from(atob(t.bin),r=>r.charCodeAt(0)))}catch(r){console.error("load local doc fail",r),n=oi.init()}else n=oi.init();return{doc:n,docId:e}}async function Hp(e,t){const n=oi.save(t),r=btoa(String.fromCharCode(...new Uint8Array(n)));return await Fp.setItem("doc:"+e,{bin:r,ts:Date.now()}),!0}async function LO(e,t){const n=oi.change(e.doc,t);return await Hp(e.docId,n),e.doc=n,e}async function DO(e,t){const r=oi.getAllChanges(e.doc).map(a=>btoa(String.fromCharCode(...new Uint8Array(a))));return!!(await fetch(t+"/api/crdt/"+e.docId+"/changes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({changes:r}),credentials:"include"})).ok}async function MO(e,t){const n=await fetch(t+"/api/crdt/"+e,{credentials:"include"});if(!n.ok)throw new Error("pull failed");const r=await n.json();if(!r.bin)return null;const i=Uint8Array.from(atob(r.bin),o=>o.charCodeAt(0)),a=oi.load(i);return await Hp(e,a),a}const Hl={initDoc:PO,changeDoc:LO,saveLocal:Hp,syncToServer:DO,pullFromServer:MO},By="http://localhost:5000";function UO(){const[e,t]=m.useState(null),[n,r]=m.useState("");m.useEffect(()=>{async function o(){const l=await Hl.initDoc("patients_demo");if(t(l),l.doc&&l.doc.patients){const c=Object.keys(l.doc.patients);c.length&&r(l.doc.patients[c[0]].firstName||"")}}o()},[]);async function i(){const o=await Hl.changeDoc(e,l=>{l.patients||(l.patients={});const c="p_"+Date.now();l.patients[c]={firstName:"New",lastName:"",createdAt:Date.now()}});t(o)}async function a(){await Hl.syncToServer(e,By);const o=await Hl.pullFromServer("patients_demo",By);o&&alert("Pulled server doc with patients: "+(o.patients?Object.keys(o.patients).length:0))}return s.jsxs("div",{children:[s.jsx("h2",{children:"CRDT Patient Editor (demo)"}),s.jsx("button",{onClick:i,children:"Add Patient"}),s.jsx("button",{onClick:a,children:"Sync Now"}),s.jsxs("div",{children:["First name sample: ",n]})]})}function BO(){const[e,t]=m.useState([]),[n,r]=m.useState(!1),[i,a]=m.useState("ALL"),[o,l]=m.useState("ALL");return m.useEffect(()=>{r(!0),q_({category:i,read:o==="ALL"?void 0:o==="READ"?"true":"false"}).then(u=>{Array.isArray(u)?t(u):Array.isArray(u==null?void 0:u.items)?t(u.items):t([])}).catch(()=>t([])).finally(()=>r(!1))},[i,o]),s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"Notifications"}),s.jsx("p",{className:"muted",children:"Recent workflow and system updates."})]}),s.jsxs("div",{className:"welcome-actions",children:[s.jsxs("select",{value:i,onChange:c=>a(c.target.value),children:[s.jsx("option",{value:"ALL",children:"All Categories"}),s.jsx("option",{value:"WORKFORCE",children:"Workforce"}),s.jsx("option",{value:"SECURITY",children:"Security"}),s.jsx("option",{value:"BILLING",children:"Billing"}),s.jsx("option",{value:"SYSTEM",children:"System"}),s.jsx("option",{value:"INTEGRATION",children:"Integration"}),s.jsx("option",{value:"AI",children:"AI"})]}),s.jsxs("select",{value:o,onChange:c=>l(c.target.value),children:[s.jsx("option",{value:"ALL",children:"All Status"}),s.jsx("option",{value:"UNREAD",children:"Unread"}),s.jsx("option",{value:"READ",children:"Read"})]}),s.jsx("button",{className:"btn-secondary",onClick:async()=>{await Fj(),t(c=>c.map(u=>({...u,read:!0})))},children:"Mark all read"})]})]}),s.jsx("section",{className:"section",children:s.jsxs("div",{className:"card",children:[n&&s.jsx("p",{children:"Loading..."}),!n&&s.jsxs("table",{className:"table lite",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Time"}),s.jsx("th",{children:"Title"}),s.jsx("th",{children:"Category"}),s.jsx("th",{children:"Message"}),s.jsx("th",{children:"Actions"})]})}),s.jsxs("tbody",{children:[e.map(c=>s.jsxs("tr",{children:[s.jsx("td",{children:new Date(c.createdAt).toLocaleString()}),s.jsxs("td",{children:[c.title||"Notification",!c.read&&s.jsx("span",{className:"badge-dot",style:{marginLeft:8},children:"!"})]}),s.jsx("td",{children:c.category||"SYSTEM"}),s.jsx("td",{children:c.body||"-"}),s.jsx("td",{children:s.jsx("button",{className:"btn-secondary",onClick:async()=>{c.read?(await $j(c._id),t(u=>u.map(d=>d._id===c._id?{...d,read:!1}:d))):(await Vj(c._id),t(u=>u.map(d=>d._id===c._id?{...d,read:!0}:d)))},children:c.read?"Mark unread":"Mark read"})})]},c._id)),e.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:"5",children:"No notifications yet"})})]})]})]})})]})}function VO(){const[e,t]=m.useState({}),[n,r]=m.useState({stripePublishable:"",stripeSecret:"",mpesaConsumerKey:"",mpesaConsumerSecret:"",mpesaShortcode:"",flutterSecret:"",mode:"test",adminPassword:"",otp:""}),[i,a]=m.useState("edit");m.useEffect(()=>{o()},[]);async function o(){const h=await(await Tr("/api/payment-settings/get")).json();t(h)}async function l(){if(!n.adminPassword||n.adminPassword.length<8){alert("Admin password required and must be >=8 chars");return}const p={stripe:{publishable:n.stripePublishable,secret:n.stripeSecret},mpesa:{consumerKey:n.mpesaConsumerKey,consumerSecret:n.mpesaConsumerSecret,shortcode:n.mpesaShortcode},flutterwave:{secret:n.flutterSecret},mode:n.mode,adminPassword:n.adminPassword},f=await(await Tr("/api/payment-settings/save",{method:"POST",body:p})).json();alert(JSON.stringify(f))}async function c(){const h=await(await Tr("/api/payment-settings/reveal/request",{method:"POST"})).json();h.ok&&a("otp_requested"),alert(h.message||JSON.stringify(h))}async function u(){const h=await(await Tr("/api/payment-settings/reveal/verify",{method:"POST",body:{code:n.otp,adminPassword:n.adminPassword}})).json();h.ok?(alert("Secrets revealed: "+JSON.stringify(h.secrets)),a("edit")):alert(JSON.stringify(h))}async function d(){const p=prompt("Enter OLD admin password"),h=prompt("Enter NEW admin password (store it safely)");if(!p||!h)return;const y=await(await Tr("/api/payment-settings/rotate-password",{method:"POST",body:{oldPassword:p,newPassword:h}})).json();alert(JSON.stringify(y))}return s.jsxs("div",{children:[s.jsx("h2",{children:"Payment Settings"}),s.jsxs("div",{children:[s.jsx("label",{children:"Stripe Publishable"}),s.jsx("input",{value:n.stripePublishable,onChange:p=>r(h=>({...h,stripePublishable:p.target.value}))})]}),s.jsxs("div",{children:[s.jsx("label",{children:"Stripe Secret"}),s.jsx("input",{value:n.stripeSecret,onChange:p=>r(h=>({...h,stripeSecret:p.target.value}))})]}),s.jsxs("div",{children:[s.jsx("label",{children:"MPESA Consumer Key"}),s.jsx("input",{value:n.mpesaConsumerKey,onChange:p=>r(h=>({...h,mpesaConsumerKey:p.target.value}))})]}),s.jsxs("div",{children:[s.jsx("label",{children:"MPESA Consumer Secret"}),s.jsx("input",{value:n.mpesaConsumerSecret,onChange:p=>r(h=>({...h,mpesaConsumerSecret:p.target.value}))})]}),s.jsxs("div",{children:[s.jsx("label",{children:"MPESA Shortcode"}),s.jsx("input",{value:n.mpesaShortcode,onChange:p=>r(h=>({...h,mpesaShortcode:p.target.value}))})]}),s.jsxs("div",{children:[s.jsx("label",{children:"Flutter Secret"}),s.jsx("input",{value:n.flutterSecret,onChange:p=>r(h=>({...h,flutterSecret:p.target.value}))})]}),s.jsxs("div",{children:[s.jsx("label",{children:"Admin Password (required to encrypt)"}),s.jsx("input",{type:"password",value:n.adminPassword,onChange:p=>r(h=>({...h,adminPassword:p.target.value}))})]}),s.jsxs("div",{style:{marginTop:12},children:[s.jsx("button",{onClick:l,children:"Save Settings (Encrypted)"})," ",s.jsx("button",{onClick:c,children:"Request 2FA"})," ",s.jsx("button",{onClick:d,children:"Rotate Admin Password"})]}),i==="otp_requested"&&s.jsxs("div",{style:{marginTop:12},children:[s.jsx("label",{children:"Enter OTP"}),s.jsx("input",{value:n.otp,onChange:p=>r(h=>({...h,otp:p.target.value}))}),s.jsx("button",{onClick:u,children:"Verify & Reveal"})]}),s.jsxs("div",{style:{marginTop:12},children:[s.jsx("h4",{children:"Metadata"}),s.jsx("pre",{children:JSON.stringify(e,null,2)})]})]})}function $O({points:e=[]}){const t=(e||[]).map(u=>Number(u)).filter(u=>Number.isFinite(u));if(t.length<2)return null;const n=120,r=28,i=Math.min(...t),o=Math.max(...t)-i||1,l=n/Math.max(1,t.length-1),c=t.map((u,d)=>{const p=d*l,h=r-(u-i)/o*(r-4)-2;return`${p},${h}`}).join(" ");return s.jsx("svg",{width:n,height:r,viewBox:`0 0 ${n} ${r}`,"aria-hidden":"true",children:s.jsx("polyline",{fill:"none",stroke:"var(--app-accent-2, #2563eb)",strokeWidth:"2",points:c})})}const te=({title:e,value:t,subtitle:n,trend:r,status:i="neutral",why:a="",badge:o="",onBadgeClick:l=null})=>s.jsxs("div",{className:`card stat stat-${i}`,children:[s.jsxs("div",{className:"card-title-row",children:[s.jsx("div",{className:"card-title",children:e}),o?typeof l=="function"?s.jsx("button",{type:"button",className:`stat-badge stat-badge-${i}`,onClick:l,children:o}):s.jsx("span",{className:`stat-badge stat-badge-${i}`,children:o}):null]}),s.jsx("div",{className:"card-value",children:t}),a?s.jsxs("div",{className:"card-why",title:a,children:["Why: ",a]}):null,Array.isArray(r)&&r.length>1&&s.jsx("div",{style:{marginTop:6},children:s.jsx($O,{points:r})}),n&&s.jsx("div",{className:"card-sub",children:n})]}),FO=()=>le("/api/dashboard/doctor"),HO=()=>le("/api/dashboard/nurse"),qO=()=>le("/api/dashboard/hr"),zO=()=>le("/api/dashboard/payroll"),WO=()=>le("/api/dashboard/staff"),GO=()=>le("/api/dashboard/lab-tech"),YO=()=>le("/api/dashboard/security-admin"),KO=()=>le("/api/dashboard/security-officer"),JO=()=>le("/api/dashboard/hospital-admin"),QO=()=>le("/api/dashboard/patient"),ZO=()=>le("/api/dashboard/super-admin"),qp=async e=>le("/api/ml/staffing/forecast",{method:"POST",body:e}),zp=async e=>le("/api/ml/burnout/score",{method:"POST",body:e}),z0=async e=>le("/api/ml/causal/impact",{method:"POST",body:e}),W0=async e=>le("/api/ml/digital-twin/simulate",{method:"POST",body:e});function XO(){const{user:e}=Te(),t=Re(),[n,r]=m.useState(null),[i,a]=m.useState([]),[o,l]=m.useState([]),[c,u]=m.useState(null),[d,p]=m.useState([]),h=A=>{const g=Number(A||0);return g>=75?"risk":g>=45?"warn":"good"},f=A=>A==="risk"?"ALERT":A==="warn"?"WATCH":"OK",y=async()=>{try{const A=await zp({hoursPerWeek:56,nightShifts:7,consecutiveDays:7,overtimeHours:14,leaveBalanceDays:6,incidentsIn30d:1});u(A||null),p(g=>[...g,Number((A==null?void 0:A.score)||0)].slice(-12))}catch{u(null)}};m.useEffect(()=>{FO().then(g=>r(g)).catch(()=>r(null)),le("/api/appointments?limit=8&cursorMode=1").then(g=>a(Array.isArray(g==null?void 0:g.items)?g.items:[])).catch(()=>a([])),le("/api/notifications?limit=8").then(g=>{const x=Array.isArray(g==null?void 0:g.items)?g.items:Array.isArray(g)?g:[];l(x.slice(0,8))}).catch(()=>l([])),y();const A=setInterval(y,45e3);return()=>clearInterval(A)},[]);const j=m.useMemo(()=>[{title:"Todays Appointments",value:(n==null?void 0:n.appointmentsToday)??""},{title:"Inpatients Assigned",value:(n==null?void 0:n.activeEncounters)??""},{title:"Surgeries Scheduled",value:(n==null?void 0:n.upcomingAppointments)??""},{title:"Pending Lab Results",value:(n==null?void 0:n.pendingLabResults)??""},{title:"License Expiry (Days)",value:(n==null?void 0:n.licenseExpiryDays)??""}],[n]);return s.jsxs("div",{className:"dashboard doctor-workspace",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"Doctor Clinical Workspace"}),s.jsxs("p",{className:"muted",children:["Welcome, Dr. ",(e==null?void 0:e.name)||"Clinician",". Zero-click access to todays patients and critical alerts."]})]}),s.jsxs("div",{className:"welcome-actions",children:[s.jsx("button",{className:"btn-primary",onClick:()=>t("/doctor/patients"),children:"Todays Patients"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/doctor/opd"),children:"Start Consultation"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/doctor/schedule"),children:"Open Schedule"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/doctor/leave"),children:"Leave Requests"})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Clinical KPIs"}),s.jsx("div",{className:"grid info-grid",children:j.map(A=>s.jsx(te,{title:A.title,value:A.value},A.title))})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"AI Wellbeing Signal"}),s.jsxs("div",{className:"grid info-grid",children:[s.jsx(te,{title:"Burnout Risk Score",value:(c==null?void 0:c.score)??"",trend:d,subtitle:"Auto-refresh 45s",status:h(c==null?void 0:c.score),badge:f(h(c==null?void 0:c.score)),why:`Score ${(c==null?void 0:c.score)??0}; keep below 45 to remain in low-risk band.`,onBadgeClick:()=>t("/doctor/leave")}),s.jsx(te,{title:"Risk Band",value:(c==null?void 0:c.band)??""}),s.jsx(te,{title:"Recommendations",value:Array.isArray(c==null?void 0:c.recommendations)?c.recommendations.length:""})]}),s.jsx("div",{className:"welcome-actions",children:s.jsx("button",{className:"btn-secondary",onClick:()=>t("/system-admin/clinical-intelligence"),children:"Open Clinical Intelligence"})})]}),s.jsxs("section",{className:"section doctor-main-grid",children:[s.jsxs("div",{className:"card doctor-schedule-card",children:[s.jsx("h3",{children:"Todays Schedule"}),s.jsx("div",{className:"table-wrap",children:s.jsxs("table",{className:"doctor-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Time"}),s.jsx("th",{children:"Type"}),s.jsx("th",{children:"Patient"}),s.jsx("th",{children:"Status"}),s.jsx("th",{children:"Actions"})]})}),s.jsxs("tbody",{children:[i.map(A=>{var g,x;return s.jsxs("tr",{children:[s.jsx("td",{children:A.scheduledAt?new Date(A.scheduledAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"-"}),s.jsx("td",{children:A.type||"OPD"}),s.jsx("td",{children:((g=A.patient)==null?void 0:g.name)||((x=A.patient)==null?void 0:x.firstName)||"-"}),s.jsx("td",{children:A.status||"Scheduled"}),s.jsx("td",{children:s.jsxs("div",{className:"doctor-actions-row",children:[s.jsx("button",{className:"btn-secondary",onClick:()=>t("/doctor/medical-records"),children:"Open Record"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/doctor/opd"),children:"Start Consultation"})]})})]},A._id)}),i.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:"5",className:"muted",children:"No appointments loaded."})})]})]})})]}),s.jsxs("div",{className:"card doctor-alerts-card",children:[s.jsx("h3",{children:"Alerts Panel"}),s.jsxs("div",{className:"alert-stack",children:[o.map(A=>s.jsx("button",{className:"verify-banner",onClick:()=>t("/admin/notifications"),children:s.jsx("span",{children:A.title||"Clinical Alert"})},A._id)),o.length===0&&s.jsx("div",{className:"muted",children:"No active alerts."})]})]})]})]})}function eP(){const{user:e}=Te(),t=Re(),[n,r]=m.useState(null);return m.useEffect(()=>{QO().then(r).catch(()=>r(null))},[]),s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"Patient Self-Service Portal"}),s.jsx("p",{className:"muted",children:"Appointments, records, lab results, billing and insurance in one place."})]}),s.jsxs("div",{className:"welcome-actions",children:[s.jsx("button",{className:"btn-primary",onClick:()=>t("/patient"),children:"My Appointments"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/payments"),children:"Billing"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/profile"),children:"Profile"})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Top Summary"}),s.jsxs("div",{className:"grid info-grid",children:[s.jsx(te,{title:"Upcoming Appointment",value:(n==null?void 0:n.upcomingAppointments)??""}),s.jsx(te,{title:"Outstanding Bill",value:(n==null?void 0:n.unpaidInvoices)??""}),s.jsx(te,{title:"Active Prescription",value:(n==null?void 0:n.prescriptionsActive)??""}),s.jsx(te,{title:"Lab Results",value:(n==null?void 0:n.labResults)??""})]})]}),s.jsxs("section",{className:"section doctor-main-grid",children:[s.jsxs("div",{className:"card doctor-schedule-card",children:[s.jsx("h3",{children:"Health Timeline"}),s.jsxs("div",{className:"panel-grid",children:[s.jsx("button",{className:"action-link",onClick:()=>t("/patient"),children:"Medical Records"}),s.jsx("button",{className:"action-link",onClick:()=>t("/patient"),children:"Prescriptions"}),s.jsx("button",{className:"action-link",onClick:()=>t("/patient"),children:"Lab Results"}),s.jsx("button",{className:"action-link",onClick:()=>t("/patient"),children:"Insurance"})]})]}),s.jsxs("div",{className:"card doctor-alerts-card",children:[s.jsx("h3",{children:"Notifications"}),s.jsxs("div",{className:"alert-stack",children:[s.jsx("button",{className:"btn-secondary",onClick:()=>t("/admin/notifications"),children:"Messages"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/patient"),children:"Feedback"})]})]})]})]})}function tP(){var i,a;const{user:e}=Te(),t=Re(),[n,r]=m.useState(null);return m.useEffect(()=>{HO().then(r).catch(()=>r(null))},[]),s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"Nurse Clinical Operations"}),s.jsx("p",{className:"muted",children:"Shift execution, patient assignment, medication administration and incident logging."})]}),s.jsxs("div",{className:"welcome-actions",children:[s.jsx("button",{className:"btn-primary",onClick:()=>t("/nurse"),children:"My Shift"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/nurse"),children:"Assigned Patients"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/workforce/requests#leave"),children:"Leave Requests"})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Nursing Snapshot"}),s.jsxs("div",{className:"grid info-grid",children:[s.jsx(te,{title:"Shift Info",value:"Active"}),s.jsx(te,{title:"Assigned Patients",value:(n==null?void 0:n.patientsTotal)??""}),s.jsx(te,{title:"Medication Due Alerts",value:(n==null?void 0:n.pendingLabOrders)??""}),s.jsx(te,{title:"Pending Requests",value:((i=n==null?void 0:n.pendingRequests)==null?void 0:i.total)??""})]})]}),s.jsxs("section",{className:"section doctor-main-grid",children:[s.jsxs("div",{className:"card doctor-schedule-card",children:[s.jsx("h3",{children:"Center Workspace"}),s.jsxs("div",{className:"panel-grid",children:[s.jsx("button",{className:"action-link",onClick:()=>t("/nurse"),children:"Patient Task List"}),s.jsx("button",{className:"action-link",onClick:()=>t("/nurse"),children:"Medication Administration"}),s.jsx("button",{className:"action-link",onClick:()=>t("/nurse"),children:"Vitals Entry"}),s.jsx("button",{className:"action-link",onClick:()=>t("/nurse"),children:"Incident Reports"})]})]}),s.jsxs("div",{className:"card doctor-alerts-card",children:[s.jsx("h3",{children:"Right Panel"}),s.jsxs("div",{className:"alert-stack",children:[s.jsxs("div",{className:"action-pill",children:["Critical Alerts: ",(n==null?void 0:n.appointmentsToday)??""]}),s.jsxs("div",{className:"action-pill",children:["Leave Pending: ",((a=n==null?void 0:n.pendingRequests)==null?void 0:a.leave)??""]}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/workforce/requests"),children:"Open My Requests"})]})]})]})]})}function nP(){const{user:e}=Te(),t=Re(),[n,r]=m.useState(null);return m.useEffect(()=>{GO().then(r).catch(()=>r(null))},[]),s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"Lab Technician Diagnostics"}),s.jsx("p",{className:"muted",children:"Test queue, sample tracking, quality control and equipment readiness."})]}),s.jsxs("div",{className:"welcome-actions",children:[s.jsx("button",{className:"btn-primary",onClick:()=>t("/labtech/labs"),children:"Test Queue"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/lab-tech"),children:"Equipment Logs"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/reports"),children:"Reports Archive"})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Lab Metrics"}),s.jsxs("div",{className:"grid info-grid",children:[s.jsx(te,{title:"Pending Tests",value:(n==null?void 0:n.pendingOrders)??""}),s.jsx(te,{title:"Completed Today",value:(n==null?void 0:n.completedToday)??""}),s.jsx(te,{title:"Abnormal Results",value:(n==null?void 0:n.overdueOrders)??""}),s.jsx(te,{title:"Orders Today",value:(n==null?void 0:n.ordersToday)??""})]})]}),s.jsxs("section",{className:"section doctor-main-grid",children:[s.jsxs("div",{className:"card doctor-schedule-card",children:[s.jsx("h3",{children:"Center Workspace"}),s.jsxs("div",{className:"panel-grid",children:[s.jsx("button",{className:"action-link",onClick:()=>t("/labtech/labs"),children:"Test Processing Table"}),s.jsx("button",{className:"action-link",onClick:()=>t("/lab-tech"),children:"Sample Tracking"}),s.jsx("button",{className:"action-link",onClick:()=>t("/lab-tech"),children:"Quality Control"}),s.jsx("button",{className:"action-link",onClick:()=>t("/lab-tech"),children:"Safety Checklist"})]})]}),s.jsxs("div",{className:"card doctor-alerts-card",children:[s.jsx("h3",{children:"Right Insights"}),s.jsxs("div",{className:"alert-stack",children:[s.jsx("div",{className:"action-pill",children:"Equipment Status: Live"}),s.jsxs("div",{className:"action-pill",children:["Urgent Flagged: ",(n==null?void 0:n.overdueOrders)??""]})]})]})]})]})}function rP(){const e=Re(),[t,n]=m.useState([]);m.useEffect(()=>{le("/api/pharmacy?limit=25").then(i=>n(Array.isArray(i==null?void 0:i.items)?i.items:Array.isArray(i)?i:[])).catch(()=>n([]))},[]);const r=t.filter(i=>Number((i==null?void 0:i.qty)||0)<=Number((i==null?void 0:i.minStock)||0)).length;return s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"Pharmacy Control Center"}),s.jsx("p",{className:"muted",children:"Prescription queue, inventory, controlled drugs and expiry monitoring."})]}),s.jsxs("div",{className:"welcome-actions",children:[s.jsx("button",{className:"btn-primary",onClick:()=>e("/pharmacy"),children:"Prescription Queue"}),s.jsx("button",{className:"btn-secondary",onClick:()=>e("/inventory"),children:"Inventory"}),s.jsx("button",{className:"btn-secondary",onClick:()=>e("/reports"),children:"Reports"})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Pharmacy Snapshot"}),s.jsxs("div",{className:"grid info-grid",children:[s.jsx(te,{title:"Pending Prescriptions",value:t.length}),s.jsx(te,{title:"Low Stock Alerts",value:r}),s.jsx(te,{title:"Expiring Drugs",value:"Live"}),s.jsx(te,{title:"Controlled Drugs",value:"Tracked"})]})]}),s.jsxs("section",{className:"section doctor-main-grid",children:[s.jsxs("div",{className:"card doctor-schedule-card",children:[s.jsx("h3",{children:"Dispensing Queue"}),s.jsx("div",{className:"table-wrap",children:s.jsxs("table",{className:"doctor-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Drug"}),s.jsx("th",{children:"Qty"}),s.jsx("th",{children:"Min"}),s.jsx("th",{children:"Status"})]})}),s.jsxs("tbody",{children:[t.slice(0,10).map(i=>s.jsxs("tr",{children:[s.jsx("td",{children:i.name||"-"}),s.jsx("td",{children:i.qty??"-"}),s.jsx("td",{children:i.minStock??"-"}),s.jsx("td",{children:Number(i.qty||0)<=Number(i.minStock||0)?"Low":"OK"})]},i._id)),t.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:"4",className:"muted",children:"No inventory data."})})]})]})})]}),s.jsxs("div",{className:"card doctor-alerts-card",children:[s.jsx("h3",{children:"Interaction Alerts"}),s.jsxs("div",{className:"alert-stack",children:[s.jsx("div",{className:"action-pill",children:"Drug interaction checks active"}),s.jsx("button",{className:"btn-secondary",onClick:()=>e("/reports"),children:"Open Safety Reports"})]})]})]})]})}function sP(){var o,l,c,u;const{user:e}=Te(),t=Re(),[n,r]=m.useState(null),[i,a]=m.useState(null);return m.useEffect(()=>{ZO().then(r).catch(()=>r(null)),Ho().then(a).catch(()=>a(null))},[]),s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"Super Admin Control Center"}),s.jsx("p",{className:"muted",children:"Global governance for hospitals, workforce, payroll, security and platform health."})]}),s.jsxs("div",{className:"welcome-actions",children:[s.jsx("button",{className:"btn-primary",onClick:()=>t("/super-admin/hospitals"),children:"Hospitals"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/admin/create-admin"),children:"Role Management"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/payments/full"),children:"Global Payroll"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/super-admin/settings"),children:"System Settings"})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Global Snapshot"}),s.jsxs("div",{className:"grid info-grid",children:[s.jsx(te,{title:"Total Hospitals",value:(n==null?void 0:n.totalHospitals)??""}),s.jsx(te,{title:"Total Staff",value:(n==null?void 0:n.totalUsers)??""}),s.jsx(te,{title:"Active Patients",value:(n==null?void 0:n.totalPatients)??""}),s.jsx(te,{title:"Payroll This Month",value:(n==null?void 0:n.paymentsThisMonth)??""}),s.jsx(te,{title:"Workforce Pending",value:((l=(o=i==null?void 0:i.queues)==null?void 0:o.workforce)==null?void 0:l.totalPending)??""}),s.jsx(te,{title:"Workforce Breached",value:((u=(c=i==null?void 0:i.queues)==null?void 0:c.workforce)==null?void 0:u.breached)??""})]})]}),s.jsxs("section",{className:"section doctor-main-grid",children:[s.jsxs("div",{className:"card doctor-schedule-card",children:[s.jsx("h3",{children:"Global Admin Workspace"}),s.jsxs("div",{className:"panel-grid",children:[s.jsx("button",{className:"action-link",onClick:async()=>{await Ws("REVENUE_OVERVIEW"),t("/payments/full")},children:"Revenue Graph"}),s.jsx("button",{className:"action-link",onClick:()=>t("/analytics"),children:"Workforce Distribution"}),s.jsx("button",{className:"action-link",onClick:()=>t("/reports"),children:"Compliance Alerts"}),s.jsx("button",{className:"action-link",onClick:()=>t("/admin/audit-logs"),children:"Audit Logs"}),s.jsx("button",{className:"action-link",onClick:()=>t("/security-admin"),children:"Security Incidents"}),s.jsx("button",{className:"action-link",onClick:()=>t("/system-admin"),children:"System Status Monitor"})]})]}),s.jsxs("div",{className:"card doctor-alerts-card",children:[s.jsx("h3",{children:"Right Insights Panel"}),s.jsxs("div",{className:"alert-stack",children:[s.jsxs("div",{className:"action-pill",children:["Active Sessions: ",(n==null?void 0:n.activeHospitals)??""]}),s.jsxs("div",{className:"action-pill",children:["Pending Requests: ",(n==null?void 0:n.pendingRequests)??""]}),s.jsxs("div",{className:"action-pill",children:["Invoices: ",(n==null?void 0:n.invoicesThisMonth)??""]}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/admin/notifications"),children:"Open Alerts"})]})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"System Administration"}),s.jsxs("div",{className:"action-list",children:[s.jsx("button",{className:"action-link",onClick:()=>t("/admin/realtime"),children:"Integration Hub"}),s.jsx("button",{className:"action-link",onClick:()=>t("/admin/crdt-patients"),children:"Offline Sync"}),s.jsx("button",{className:"action-link",onClick:()=>t("/admin/audit-logs"),children:"Audit Trails"}),s.jsx("button",{className:"action-link",onClick:()=>t("/reports"),children:"Regulatory Reports"})]})]})]})}const iP=async e=>(await ue.post("/api/hospitals",e)).data,G0=async()=>(await ue.get("/api/super-admin/hospitals")).data,Y0=async e=>(await ue.post("/api/super-admin/register-hospital-admin",e)).data,K0=async e=>(await ue.post("/api/super-admin/register-system-admin",e)).data,J0=async e=>(await ue.post("/api/super-admin/register-developer",e)).data;function aP(){const{user:e}=Te(),[t,n]=m.useState([]),[r,i]=m.useState(""),[a,o]=m.useState(1),l=10,[c,u]=m.useState(!1),[d,p]=m.useState(null),[h,f]=m.useState({name:"",address:"",contact:"",code:""}),[y,j]=m.useState({name:"",email:"",password:"",hospitalId:""}),[A,g]=m.useState({name:"",email:"",password:""}),[x,w]=m.useState({name:"",email:"",password:""}),E=async()=>{try{const V=await G0(),K=Array.isArray(V)?V:V.hospitals||[];n(K)}catch{n([])}};m.useEffect(()=>{E()},[]);const _=(e==null?void 0:e.role)==="SUPER_ADMIN",b=(e==null?void 0:e.role)==="SYSTEM_ADMIN";if(!_&&!b)return s.jsx("p",{children:" Access denied"});const R=async V=>{var K,ce;V.preventDefault(),u(!0),p(null);try{await iP(h),p(" Hospital created"),f({name:"",address:"",contact:"",code:""}),await E()}catch(M){p(((ce=(K=M.response)==null?void 0:K.data)==null?void 0:ce.msg)||"Failed to create hospital")}finally{u(!1)}},C=async V=>{var K,ce;V.preventDefault(),u(!0),p(null);try{await Y0(y),p(" Hospital admin created"),j({name:"",email:"",password:"",hospitalId:""}),await E()}catch(M){p(((ce=(K=M.response)==null?void 0:K.data)==null?void 0:ce.msg)||"Failed to create hospital admin")}finally{u(!1)}},T=async V=>{var K,ce;V.preventDefault(),u(!0),p(null);try{await K0(A),p(" System admin created"),g({name:"",email:"",password:""})}catch(M){p(((ce=(K=M.response)==null?void 0:K.data)==null?void 0:ce.msg)||"Failed to create system admin")}finally{u(!1)}},D=async V=>{var K,ce;V.preventDefault(),u(!0),p(null);try{await J0(x),p(" Developer created"),w({name:"",email:"",password:""})}catch(M){p(((ce=(K=M.response)==null?void 0:K.data)==null?void 0:ce.msg)||"Failed to create developer")}finally{u(!1)}},U=t.filter(V=>{var ce,M;const K=r.trim().toLowerCase();return K?((ce=V.name)==null?void 0:ce.toLowerCase().includes(K))||((M=V.code)==null?void 0:M.toLowerCase().includes(K)):!0}),W=Math.max(1,Math.ceil(U.length/l)),q=Math.min(a,W),P=U.slice((q-1)*l,q*l);return s.jsxs("div",{className:"dashboard",children:[s.jsx("div",{className:"welcome-panel",children:s.jsxs("div",{children:[s.jsx("h2",{children:"Hospitals & Admins"}),s.jsx("p",{className:"muted",children:"Create hospitals, assign hospital admins, and delegate system admins to scale onboarding."})]})}),d&&s.jsx("div",{className:"card",children:d}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Create Hospital"}),s.jsxs("form",{className:"card form",onSubmit:R,children:[s.jsx("input",{placeholder:"Hospital name",value:h.name,onChange:V=>f({...h,name:V.target.value}),required:!0}),s.jsx("input",{placeholder:"Address",value:h.address,onChange:V=>f({...h,address:V.target.value})}),s.jsx("input",{placeholder:"Contact",value:h.contact,onChange:V=>f({...h,contact:V.target.value})}),s.jsx("input",{placeholder:"Optional code",value:h.code,onChange:V=>f({...h,code:V.target.value})}),s.jsx("button",{disabled:c,children:c?"Creating...":"Create Hospital"})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Register Hospital Admin"}),s.jsxs("form",{className:"card form",onSubmit:C,children:[s.jsx("input",{placeholder:"Full name",value:y.name,onChange:V=>j({...y,name:V.target.value}),required:!0}),s.jsx("input",{placeholder:"Email address",type:"email",value:y.email,onChange:V=>j({...y,email:V.target.value}),required:!0}),s.jsx("input",{placeholder:"Temporary password",type:"password",value:y.password,onChange:V=>j({...y,password:V.target.value}),required:!0}),s.jsxs("select",{value:y.hospitalId,onChange:V=>j({...y,hospitalId:V.target.value}),required:!0,children:[s.jsx("option",{value:"",children:"Select hospital"}),t.map(V=>s.jsx("option",{value:V._id,children:V.name},V._id))]}),s.jsx("button",{disabled:c,children:c?"Creating...":"Create Hospital Admin"})]})]}),_&&s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Register System Admin"}),s.jsxs("form",{className:"card form",onSubmit:T,children:[s.jsx("input",{placeholder:"Full name",value:A.name,onChange:V=>g({...A,name:V.target.value}),required:!0}),s.jsx("input",{placeholder:"Email address",type:"email",value:A.email,onChange:V=>g({...A,email:V.target.value}),required:!0}),s.jsx("input",{placeholder:"Temporary password",type:"password",value:A.password,onChange:V=>g({...A,password:V.target.value}),required:!0}),s.jsx("button",{disabled:c,children:c?"Creating...":"Create System Admin"})]})]}),_&&s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Register Developer"}),s.jsxs("form",{className:"card form",onSubmit:D,children:[s.jsx("input",{placeholder:"Full name",value:x.name,onChange:V=>w({...x,name:V.target.value}),required:!0}),s.jsx("input",{placeholder:"Email address",type:"email",value:x.email,onChange:V=>w({...x,email:V.target.value}),required:!0}),s.jsx("input",{placeholder:"Temporary password",type:"password",value:x.password,onChange:V=>w({...x,password:V.target.value}),required:!0}),s.jsx("button",{disabled:c,children:c?"Creating...":"Create Developer"})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Hospitals"}),s.jsxs("div",{className:"card",children:[s.jsx("div",{className:"search-wrap",style:{marginBottom:12},children:s.jsx("input",{className:"search-input",placeholder:"Search hospitals",value:r,onChange:V=>{i(V.target.value),o(1)}})}),s.jsxs("table",{className:"table lite",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Name"}),s.jsx("th",{children:"Code"}),s.jsx("th",{children:"Admins"}),s.jsx("th",{children:"Status"})]})}),s.jsxs("tbody",{children:[P.map(V=>s.jsxs("tr",{children:[s.jsx("td",{children:V.name}),s.jsx("td",{children:V.code||"-"}),s.jsx("td",{children:(V.admins||[]).map(K=>`${K.name} (${K.email})`).join(", ")||"None"}),s.jsx("td",{children:V.active===!1?"Inactive":"Active"})]},V._id)),P.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:"4",children:"No hospitals yet"})})]})]}),s.jsxs("div",{className:"action-list",style:{marginTop:12},children:[s.jsx("button",{className:"btn-secondary",onClick:()=>o(V=>Math.max(1,V-1)),disabled:q===1,children:"Prev"}),s.jsxs("span",{className:"muted",children:["Page ",q," of ",W]}),s.jsx("button",{className:"btn-secondary",onClick:()=>o(V=>Math.min(W,V+1)),disabled:q===W,children:"Next"})]})]})]})]})}const oP=async()=>(await ue.get("/api/system-settings")).data,lP=async e=>(await ue.put("/api/system-settings",e)).data;function Vy(e){return new Promise((t,n)=>{const r=new FileReader;r.onload=()=>t(r.result),r.onerror=n,r.readAsDataURL(e)})}function cP(){const{user:e}=Te(),{settings:t,setSettings:n}=vi(),[r,i]=m.useState({branding:{appIcon:"",favicon:"",logo:"",loginBackground:"",homeBackground:"",sidebarIcons:{}},ai:{enabled:!1,name:"NeuroEdge",url:"",greeting:"Hi, how can I help?"}}),[a,o]=m.useState(!1),[l,c]=m.useState(null);if(!["SUPER_ADMIN","DEVELOPER"].includes(e==null?void 0:e.role))return s.jsx("p",{children:" Access denied"});m.useEffect(()=>{oP().then(f=>{const y={branding:{...r.branding,...f.branding||{}},ai:{...r.ai,...f.ai||{}}};i(y)}).catch(()=>{})},[]);const u=async()=>{var f,y;o(!0),c(null);try{const j=await lP(r);c(" Settings saved"),j.settings&&n(j.settings)}catch(j){c(((y=(f=j.response)==null?void 0:f.data)==null?void 0:y.message)||"Failed to save settings")}finally{o(!1)}},d=async(f,y)=>{if(!y)return;const j=await Vy(y);i(A=>({...A,branding:{...A.branding,[f]:j}}))},p=async(f,y)=>{if(!y)return;const j=await Vy(y);i(A=>({...A,branding:{...A.branding,sidebarIcons:{...A.branding.sidebarIcons||{},[f]:j}}}))},h=[{key:"home",label:"Home"},{key:"admin",label:"Admin"},{key:"hr",label:"HR"},{key:"payroll",label:"Payroll"},{key:"doctor",label:"Doctor"},{key:"nurse",label:"Nurse"},{key:"lab",label:"Lab"},{key:"pharmacy",label:"Pharmacy"},{key:"staff",label:"Staff"},{key:"security",label:"Security"},{key:"settings",label:"Settings"},{key:"analytics",label:"Analytics"},{key:"reports",label:"Reports"},{key:"notifications",label:"Notifications"},{key:"requests",label:"Requests"},{key:"inventory",label:"Inventory"},{key:"ai",label:"AI"},{key:"appointments",label:"Appointments"}];return s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"System Settings"}),s.jsx("p",{className:"muted",children:"Branding, payments, and AI configuration."})]}),s.jsx("div",{className:"welcome-actions",children:s.jsx("button",{className:"btn-primary",onClick:u,disabled:a,children:a?"Saving...":"Save Settings"})})]}),l&&s.jsx("div",{className:"card",children:l}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Branding Assets"}),s.jsxs("div",{className:"card form",children:[s.jsx("label",{children:"Main App Icon"}),s.jsx("input",{type:"file",accept:"image/*",onChange:f=>{var y;return d("appIcon",(y=f.target.files)==null?void 0:y[0])}}),s.jsx("label",{children:"Favicon (.ico or png)"}),s.jsx("input",{type:"file",accept:"image/*",onChange:f=>{var y;return d("favicon",(y=f.target.files)==null?void 0:y[0])}}),s.jsx("label",{children:"Logo (Navbar/Sidebar)"}),s.jsx("input",{type:"file",accept:"image/*",onChange:f=>{var y;return d("logo",(y=f.target.files)==null?void 0:y[0])}}),s.jsx("label",{children:"Login Background Image"}),s.jsx("input",{type:"file",accept:"image/*",onChange:f=>{var y;return d("loginBackground",(y=f.target.files)==null?void 0:y[0])}}),s.jsx("label",{children:"Home Background Image"}),s.jsx("input",{type:"file",accept:"image/*",onChange:f=>{var y;return d("homeBackground",(y=f.target.files)==null?void 0:y[0])}})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Sidebar Icons"}),s.jsx("div",{className:"card form",children:h.map(f=>{var y;return s.jsxs("div",{className:"icon-upload-row",children:[s.jsxs("label",{children:[f.label," Icon"]}),s.jsx("input",{type:"file",accept:"image/*",onChange:j=>{var A;return p(f.key,(A=j.target.files)==null?void 0:A[0])}}),((y=r.branding.sidebarIcons)==null?void 0:y[f.key])&&s.jsx("img",{src:r.branding.sidebarIcons[f.key],alt:`${f.label} icon`,className:"icon-preview"})]},f.key)})})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Payments"}),s.jsxs("div",{className:"card",children:[s.jsx("p",{className:"muted",children:"Use the Payment Settings page to set Stripe, Mpesa, Flutterwave, and card settings."}),s.jsx("a",{className:"action-link",href:"/admin/payment-settings",children:"Open Payment Settings"})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"NeuroEdge AI"}),s.jsxs("div",{className:"card form",children:[s.jsxs("label",{children:[s.jsx("input",{type:"checkbox",checked:r.ai.enabled,onChange:f=>i(y=>({...y,ai:{...y.ai,enabled:f.target.checked}}))}),"Enable Floating AI"]}),s.jsx("label",{children:"AI Name"}),s.jsx("input",{value:r.ai.name,onChange:f=>i(y=>({...y,ai:{...y.ai,name:f.target.value}}))}),s.jsx("label",{children:"AI URL"}),s.jsx("input",{placeholder:"https://neuroedge.ai/chat",value:r.ai.url,onChange:f=>i(y=>({...y,ai:{...y.ai,url:f.target.value}}))}),s.jsx("label",{children:"Greeting"}),s.jsx("input",{value:r.ai.greeting,onChange:f=>i(y=>({...y,ai:{...y.ai,greeting:f.target.value}}))})]})]})]})}function uP(){var h,f,y,j,A,g,x,w,E,_;const{user:e}=Te(),t=Re(),[n,r]=m.useState(null),[i,a]=m.useState(null),[o,l]=m.useState({requiredDoctors:[],requiredNurses:[],doctorGap:[],nurseGap:[]}),c=(b,R)=>{l(C=>({...C,[b]:[...C[b]||[],Number(R||0)].slice(-12)}))},u=b=>{const R=Number(b||0);return R<=0?"good":R<=3?"warn":"risk"},d=b=>b==="risk"?"ALERT":b==="warn"?"WATCH":"OK",p=async()=>{var b,R,C,T;try{const D=await qp({beds:180,occupancyRate:.76,avgPatientsPerDoctor:12,avgPatientsPerNurse:5,horizonDays:7});a(D||null),c("requiredDoctors",((b=D==null?void 0:D.forecast)==null?void 0:b.requiredDoctors)||0),c("requiredNurses",((R=D==null?void 0:D.forecast)==null?void 0:R.requiredNurses)||0),c("doctorGap",((C=D==null?void 0:D.forecast)==null?void 0:C.doctorGap)||0),c("nurseGap",((T=D==null?void 0:D.forecast)==null?void 0:T.nurseGap)||0)}catch{a(null)}};return m.useEffect(()=>{JO().then(r).catch(()=>r(null)),p();const b=setInterval(p,45e3);return()=>clearInterval(b)},[]),s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"Hospital Admin Operations"}),s.jsx("p",{className:"muted",children:"Branch-level staffing, approvals, bed flow, attendance and alerts."})]}),s.jsxs("div",{className:"welcome-actions",children:[s.jsx("button",{className:"btn-primary",onClick:()=>t("/hospital-admin/staff"),children:"Staff Directory"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/hospital-admin/approvals"),children:"Leave Approvals"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/hospital-admin/register-staff"),children:"Recruitment Requests"})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Top Metrics"}),s.jsxs("div",{className:"grid info-grid",children:[s.jsx(te,{title:"Staff Count",value:(n==null?void 0:n.totalStaff)??""}),s.jsx(te,{title:"Bed Occupancy",value:(n==null?void 0:n.patientsTotal)??""}),s.jsx(te,{title:"Shift Coverage %",value:(n==null?void 0:n.openShifts)??""}),s.jsx(te,{title:"Department Alerts",value:(n==null?void 0:n.pendingRequests)??""})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"AI Staffing Risk"}),s.jsxs("div",{className:"grid info-grid",children:[s.jsx(te,{title:"Required Doctors",value:((h=i==null?void 0:i.forecast)==null?void 0:h.requiredDoctors)??"",trend:o.requiredDoctors,subtitle:"Auto-refresh 45s"}),s.jsx(te,{title:"Required Nurses",value:((f=i==null?void 0:i.forecast)==null?void 0:f.requiredNurses)??"",trend:o.requiredNurses,subtitle:"Auto-refresh 45s"}),s.jsx(te,{title:"Doctor Gap",value:((y=i==null?void 0:i.forecast)==null?void 0:y.doctorGap)??"",trend:o.doctorGap,subtitle:"Auto-refresh 45s",status:u((j=i==null?void 0:i.forecast)==null?void 0:j.doctorGap),badge:d(u((A=i==null?void 0:i.forecast)==null?void 0:A.doctorGap)),why:`Gap ${((g=i==null?void 0:i.forecast)==null?void 0:g.doctorGap)??0}; >3 requires urgent staffing intervention.`,onBadgeClick:()=>t("/hospital-admin/register-staff?role=doctor")}),s.jsx(te,{title:"Nurse Gap",value:((x=i==null?void 0:i.forecast)==null?void 0:x.nurseGap)??"",trend:o.nurseGap,subtitle:"Auto-refresh 45s",status:u((w=i==null?void 0:i.forecast)==null?void 0:w.nurseGap),badge:d(u((E=i==null?void 0:i.forecast)==null?void 0:E.nurseGap)),why:`Gap ${((_=i==null?void 0:i.forecast)==null?void 0:_.nurseGap)??0}; >3 requires urgent staffing intervention.`,onBadgeClick:()=>t("/hospital-admin/register-staff?role=nurse")})]})]}),s.jsxs("section",{className:"section doctor-main-grid",children:[s.jsxs("div",{className:"card doctor-schedule-card",children:[s.jsx("h3",{children:"Center Workspace"}),s.jsxs("div",{className:"panel-grid",children:[s.jsx("button",{className:"action-link",onClick:()=>t("/workforce/requests#shift"),children:"Shift Calendar"}),s.jsx("button",{className:"action-link",onClick:()=>t("/reports"),children:"Attendance Heatmap"}),s.jsx("button",{className:"action-link",onClick:()=>t("/hospital-admin/staff"),children:"Staff Directory"}),s.jsx("button",{className:"action-link",onClick:()=>t("/reports"),children:"Budget Overview"})]})]}),s.jsxs("div",{className:"card doctor-alerts-card",children:[s.jsx("h3",{children:"Right Panel"}),s.jsxs("div",{className:"alert-stack",children:[s.jsxs("div",{className:"action-pill",children:["Pending Approvals: ",(n==null?void 0:n.pendingRequests)??""]}),s.jsxs("div",{className:"action-pill",children:["Critical Alerts: ",(n==null?void 0:n.appointmentsToday)??""]}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/admin/notifications"),children:"Announcements"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/security-admin"),children:"Incident Reports"})]})]})]})]})}function dP(){const{user:e}=Te(),t=hn(),[n,r]=m.useState({name:"",email:"",password:"",role:"doctor"}),[i,a]=m.useState(!1),[o,l]=m.useState(null);if(ba.useEffect(()=>{const u=new URLSearchParams(t.search),d=String(u.get("role")||"").toLowerCase();new Set(["doctor","nurse","lab_tech","pharmacist","radiologist","therapist","receptionist","security_officer","hr_manager","payroll_officer"]).has(d)&&r(h=>({...h,role:d}))},[t.search]),(e==null?void 0:e.role)!=="HOSPITAL_ADMIN")return s.jsx("p",{children:" Access denied"});const c=async u=>{var d,p,h;u.preventDefault(),a(!0),l(null);try{const f=await ue.post("/api/hospital-admin/register-staff",n);l(((d=f.data)==null?void 0:d.msg)||" Staff registered"),r({name:"",email:"",password:"",role:"doctor"})}catch(f){l(((h=(p=f.response)==null?void 0:p.data)==null?void 0:h.msg)||"Failed to register staff")}finally{a(!1)}};return s.jsxs("div",{className:"dashboard",children:[s.jsx("div",{className:"welcome-panel",children:s.jsxs("div",{children:[s.jsx("h2",{children:"Register Hospital Staff"}),s.jsx("p",{className:"muted",children:"Add staff members to your hospital workforce."})]})}),o&&s.jsx("div",{className:"card",children:o}),s.jsxs("form",{className:"card form",onSubmit:c,children:[s.jsx("input",{placeholder:"Full name",value:n.name,required:!0,onChange:u=>r({...n,name:u.target.value})}),s.jsx("input",{placeholder:"Email address",type:"email",value:n.email,required:!0,onChange:u=>r({...n,email:u.target.value})}),s.jsx("input",{placeholder:"Temporary password",type:"password",value:n.password,required:!0,onChange:u=>r({...n,password:u.target.value})}),s.jsxs("select",{value:n.role,onChange:u=>r({...n,role:u.target.value}),children:[s.jsx("option",{value:"doctor",children:"Doctor"}),s.jsx("option",{value:"nurse",children:"Nurse"}),s.jsx("option",{value:"lab_tech",children:"Lab Tech"}),s.jsx("option",{value:"pharmacist",children:"Pharmacist"}),s.jsx("option",{value:"radiologist",children:"Radiologist"}),s.jsx("option",{value:"therapist",children:"Therapist"}),s.jsx("option",{value:"receptionist",children:"Receptionist"}),s.jsx("option",{value:"security_officer",children:"Security Officer"}),s.jsx("option",{value:"hr_manager",children:"HR Manager"}),s.jsx("option",{value:"payroll_officer",children:"Payroll Officer"})]}),s.jsx("button",{disabled:i,children:i?"Creating...":"Register Staff"})]})]})}const Wp=(e,t={})=>{const n=new URLSearchParams;e&&n.set("status",e),t.limit&&n.set("limit",String(t.limit)),t.cursor!==void 0&&t.cursor!==null&&n.set("cursor",t.cursor),t.cursorMode&&n.set("cursorMode","1");const r=n.toString();return r?`?${r}`:""},hP=(e,t)=>ue.get(`/api/workforce/leave/my${Wp(e,t)}`),fP=e=>ue.post("/api/workforce/leave",e),pP=e=>ue.post(`/api/workforce/leave/${e}/approve`),mP=(e,t)=>ue.post(`/api/workforce/leave/${e}/reject`,{reason:t}),gP=(e,t)=>ue.get(`/api/workforce/overtime/my${Wp(e,t)}`),yP=e=>ue.post("/api/workforce/overtime",e),vP=e=>ue.post(`/api/workforce/overtime/${e}/approve`),xP=(e,t)=>ue.post(`/api/workforce/overtime/${e}/reject`,{reason:t}),Pi=(e,t,n={})=>{const r=new URLSearchParams;r.set("kind",String(e||"").toUpperCase()),r.set("status",t),n.limit&&r.set("limit",String(n.limit)),n.cursor!==void 0&&n.cursor!==null&&r.set("cursor",n.cursor),n.cursorMode&&r.set("cursorMode","1");const i=r.toString();return ue.get(`/api/workforce/pending${i?`?${i}`:""}`)},jP=(e,t)=>ue.get(`/api/workforce/shifts/my${Wp(e,t)}`),bP=e=>ue.post("/api/workforce/shifts",e),wP=e=>ue.post(`/api/workforce/shifts/${e}/approve`),SP=(e,t)=>ue.post(`/api/workforce/shifts/${e}/reject`,{reason:t}),EP=()=>ue.get("/api/workforce/sla/policies"),NP=(e,t)=>ue.put(`/api/workforce/sla/policies/${e}`,t),_P=()=>ue.get("/api/workforce/queue-insights"),AP=()=>ue.get("/api/workforce/automation/policies"),CP=(e={})=>{const t=new URLSearchParams;e.includeInactive&&t.set("includeInactive","1");const n=t.toString();return ue.get(`/api/workforce/automation/presets${n?`?${n}`:""}`)},kP=e=>ue.post("/api/workforce/automation/presets/apply-all",{presetKey:e}),IP=e=>ue.post("/api/workforce/automation/presets",e),RP=e=>ue.delete(`/api/workforce/automation/presets/${encodeURIComponent(String(e||"").toUpperCase())}`),TP=e=>ue.post(`/api/workforce/automation/presets/${encodeURIComponent(String(e||"").toUpperCase())}/reactivate`),OP=(e={})=>{const t=new URLSearchParams;e.limit&&t.set("limit",String(e.limit));const n=t.toString();return ue.get(`/api/workforce/automation/presets/history${n?`?${n}`:""}`)},PP=(e,t)=>ue.put(`/api/workforce/automation/policies/${e}`,t),LP=e=>ue.post("/api/workforce/automation/simulate",e),DP=(e={})=>{const t=new URLSearchParams;e.requestType&&t.set("requestType",String(e.requestType).toUpperCase()),e.limit&&t.set("limit",String(e.limit));const n=t.toString();return ue.get(`/api/workforce/automation/preview${n?`?${n}`:""}`)},MP=()=>ue.post("/api/workforce/automation/sweep"),UP=new Set(["HOSPITAL_ADMIN","SUPER_ADMIN","SYSTEM_ADMIN","DEVELOPER","HR_MANAGER","PAYROLL_OFFICER"]),BP=new Set(["SUPER_ADMIN","SYSTEM_ADMIN","DEVELOPER"]),Ad="approvals_triage_prefs",Qa="approvals_query_cache_v1",VP=15*60*1e3;function _r(e){return e!=null&&e.slaDueAt?e.status==="PENDING"&&new Date(e.slaDueAt).getTime()<Date.now():!1}function $P(){var Ls,Ds,Ms,Us,Bs,qr,Vn,zr,Nn,Vs,nr,wr,$s,Fs,Sr;const{user:e}=Te(),t=hn(),[n,r]=m.useState([]),[i,a]=m.useState([]),[o,l]=m.useState([]),[c,u]=m.useState(null),[d,p]=m.useState(null),[h,f]=m.useState(null),[y,j]=m.useState(!1),[A,g]=m.useState(!1),[x,w]=m.useState(!1),[E,_]=m.useState(!1),[b,R]=m.useState(""),[C,T]=m.useState(null),[D,U]=m.useState([]),[W,q]=m.useState({}),[P,V]=m.useState([]),[K,ce]=m.useState([]),[M,X]=m.useState(!1),[ae,pe]=m.useState([]),[fe,De]=m.useState({key:"",name:"",description:"",config:{active:!0,autoApprove:!1,requireSecondApprover:!0,fallbackRole:"AUTO",escalationAfterMinutes:120,conditions:{priorityAgeMultiplier:1,priorityWeightCap:5}}}),[F,Z]=m.useState({}),[Y,ye]=m.useState(!1),[ge,Ke]=m.useState(!1),[Ae,Fe]=m.useState(!1),[ne,me]=m.useState(null),[se,be]=m.useState(null),[Me,mt]=m.useState(!1),[Pt,we]=m.useState(null),[Ie,st]=m.useState("ALL"),[ve,Ue]=m.useState("ALL"),[Se,it]=m.useState(0),[xe,St]=m.useState(!0),[Jt,fn]=m.useState(!1),[Ht,Un]=m.useState(""),[Qt,En]=m.useState(""),je=m.useRef(null),[Ee,dt]=m.useState(!1),[gt,kt]=m.useState("Live  now"),Et=m.useRef(!1),Oe=e==null?void 0:e.role;if(!UP.has(Oe))return s.jsx("p",{children:"Access denied"});const Nt=`${Oe||"UNKNOWN"}:${(e==null?void 0:e._id)||(e==null?void 0:e.id)||(e==null?void 0:e.email)||"anon"}`,tr=BP.has(Oe),pn=I=>Array.isArray(I)?{items:I,nextCursor:null,hasMore:!1}:{items:Array.isArray(I==null?void 0:I.items)?I.items:[],nextCursor:(I==null?void 0:I.nextCursor)||null,hasMore:!!(I!=null&&I.hasMore)},Is=(I,B)=>{var k;const v=(k=K.find(N=>String((N==null?void 0:N.key)||"").toUpperCase()===String(B||"").toUpperCase()))==null?void 0:k.config;v&&Z(N=>{var O,$;const S=N[I]||{},L=S.conditions||{};return{...N,[I]:{...S,active:!0,autoApprove:v.autoApprove,requireSecondApprover:v.requireSecondApprover,fallbackRole:v.fallbackRole,escalationAfterMinutes:v.escalationAfterMinutes,conditions:{...L,priorityAgeMultiplier:Number(((O=v.conditions)==null?void 0:O.priorityAgeMultiplier)??1),priorityWeightCap:Number((($=v.conditions)==null?void 0:$.priorityWeightCap)??5)}}}})},yt=async({append:I=!1}={})=>{var B,v,k,N,S,L;I?_(!0):ye(!0),we(null);try{const O=ve==="ALL"?["LEAVE","OVERTIME","SHIFT"]:[ve],$=O.includes("LEAVE")&&(!I||y&&!!c),H=O.includes("OVERTIME")&&(!I||A&&!!d),G=O.includes("SHIFT")&&(!I||x&&!!h),[re,ie,he,Ne,Be,$e,at,et]=await Promise.all([$?Pi("LEAVE","PENDING",{cursorMode:!0,limit:25,cursor:I?c:void 0}):Promise.resolve(null),H?Pi("OVERTIME","PENDING",{cursorMode:!0,limit:25,cursor:I?d:void 0}):Promise.resolve(null),G?Pi("SHIFT","PENDING",{cursorMode:!0,limit:25,cursor:I?h:void 0}):Promise.resolve(null),I?Promise.resolve({data:C}):_P(),I?Promise.resolve({data:{items:D}}):EP(),I?Promise.resolve({data:{items:P}}):AP(),I?Promise.resolve({data:{items:K}}):CP({includeInactive:M}),I?Promise.resolve({data:{items:ae}}):OP({limit:50})]),_t=$?pn(re.data):{items:[],nextCursor:null,hasMore:!1},_n=H?pn(ie.data):{items:[],nextCursor:null,hasMore:!1},rr=G?pn(he.data):{items:[],nextCursor:null,hasMore:!1};I?($?(r(mn=>[...mn,..._t.items]),u(_t.nextCursor),j(_t.hasMore)):j(!1),H?(a(mn=>[...mn,..._n.items]),p(_n.nextCursor),g(_n.hasMore)):g(!1),G?(l(mn=>[...mn,...rr.items]),f(rr.nextCursor),w(rr.hasMore)):w(!1)):(r(_t.items),a(_n.items),l(rr.items),u(_t.nextCursor),p(_n.nextCursor),f(rr.nextCursor),j(_t.hasMore),g(_n.hasMore),w(rr.hasMore)),T(Ne.data||null);const dl=Array.isArray((B=Be.data)==null?void 0:B.items)?Be.data.items:[];I||(kt("Live  now"),U(dl),q(dl.reduce((mn,ht)=>(mn[ht.requestType]={targetMinutes:ht.targetMinutes,escalationMinutes:ht.escalationMinutes,active:ht.active!==!1},mn),{})));const Ii=Array.isArray((v=$e.data)==null?void 0:v.items)?$e.data.items:[],Gp=Array.isArray((k=at.data)==null?void 0:k.items)?at.data.items:[],Nu=Array.isArray((N=et.data)==null?void 0:N.items)?et.data.items:[];I||(V(Ii),ce(Gp),pe(Nu),Z(Ii.reduce((mn,ht)=>{var Yp,Kp,Jp,Qp,Zp,Xp;return mn[ht.requestType]={active:ht.active!==!1,autoApprove:ht.autoApprove===!0,requireSecondApprover:ht.requireSecondApprover===!0,fallbackRole:ht.fallbackRole||"HOSPITAL_ADMIN",escalationAfterMinutes:Number(ht.escalationAfterMinutes||120),conditions:{maxLeaveDays:Number(((Yp=ht.conditions)==null?void 0:Yp.maxLeaveDays)||0),maxOvertimeHours:Number(((Kp=ht.conditions)==null?void 0:Kp.maxOvertimeHours)||0),priorityAgeMultiplier:Number(((Jp=ht.conditions)==null?void 0:Jp.priorityAgeMultiplier)??1),priorityWeightCap:Number(((Qp=ht.conditions)==null?void 0:Qp.priorityWeightCap)??5),allowedShiftTypes:Array.isArray((Zp=ht.conditions)==null?void 0:Zp.allowedShiftTypes)?ht.conditions.allowedShiftTypes.join(","):"",fallbackCandidates:Array.isArray((Xp=ht.conditions)==null?void 0:Xp.fallbackCandidates)?ht.conditions.fallbackCandidates.join(","):""}},mn},{})))}catch(O){we(((L=(S=O==null?void 0:O.response)==null?void 0:S.data)==null?void 0:L.message)||"Failed to load approvals")}finally{I?_(!1):ye(!1)}};m.useEffect(()=>{try{const I=localStorage.getItem(Qa);if(!I){kt("Live  now"),dt(!0);return}const B=JSON.parse(I),v=B==null?void 0:B[Nt];if(!v||typeof v!="object"){kt("Live  now"),dt(!0);return}const k=Date.now()-new Date(v.updatedAt||0).getTime();if(!Number.isFinite(k)||k<0||k>VP){kt("Live  now"),dt(!0);return}const N=Math.max(0,Math.floor(k/6e4));v.queueKindFilter&&Ue(v.queueKindFilter),Array.isArray(v.leave)&&r(v.leave),Array.isArray(v.overtime)&&a(v.overtime),Array.isArray(v.shifts)&&l(v.shifts),(typeof v.leaveCursor=="string"||v.leaveCursor===null)&&u(v.leaveCursor),(typeof v.overtimeCursor=="string"||v.overtimeCursor===null)&&p(v.overtimeCursor),(typeof v.shiftCursor=="string"||v.shiftCursor===null)&&f(v.shiftCursor),typeof v.hasMoreLeave=="boolean"&&j(v.hasMoreLeave),typeof v.hasMoreOvertime=="boolean"&&g(v.hasMoreOvertime),typeof v.hasMoreShift=="boolean"&&w(v.hasMoreShift),v.queue&&typeof v.queue=="object"&&T(v.queue),kt(`Cached  ${N}m ago`),Et.current=!0}catch{}finally{dt(!0)}},[Nt]),m.useEffect(()=>{if(Ee){if(Et.current){Et.current=!1;return}yt({append:!1})}},[Ee,ve,M]),m.useEffect(()=>{const I=new URLSearchParams(t.search),B=String(I.get("view")||"").toLowerCase();I.has("view")&&st(B==="breached"?"BREACHED":"ALL");const k=String(I.get("kind")||"").toUpperCase();["LEAVE","OVERTIME","SHIFT"].includes(k)?Ue(k):I.has("kind")&&Ue("ALL");const N=window.location.hash;if(!N)return;const S=document.getElementById(N.replace("#",""));S&&setTimeout(()=>S.scrollIntoView({behavior:"smooth"}),120)},[t.search]),m.useEffect(()=>{try{const I=localStorage.getItem(Ad);if(!I)return;const B=JSON.parse(I),v=B==null?void 0:B[Nt];if(!v||typeof v!="object")return;(v.viewMode==="ALL"||v.viewMode==="BREACHED")&&st(v.viewMode),typeof v.autoAdvance=="boolean"&&St(v.autoAdvance),typeof v.filter=="string"&&En(v.filter)}catch{}},[Nt]),m.useEffect(()=>{try{const I=localStorage.getItem(Ad),B=I?JSON.parse(I):{};B[Nt]={viewMode:Ie,autoAdvance:xe,filter:Qt,updatedAt:new Date().toISOString()},localStorage.setItem(Ad,JSON.stringify(B))}catch{}},[Nt,Ie,xe,Qt]),m.useEffect(()=>{if(Ee)try{const I=localStorage.getItem(Qa),B=I?JSON.parse(I):{};B[Nt]={queueKindFilter:ve,leave:n,overtime:i,shifts:o,leaveCursor:c,overtimeCursor:d,shiftCursor:h,hasMoreLeave:y,hasMoreOvertime:A,hasMoreShift:x,queue:C,updatedAt:new Date().toISOString()},localStorage.setItem(Qa,JSON.stringify(B))}catch{}},[Ee,Nt,ve,n,i,o,c,d,h,y,A,x,C]);const Bn=m.useMemo(()=>[...n.map(I=>({...I,kind:"LEAVE"})),...i.map(I=>({...I,kind:"OVERTIME"})),...o.map(I=>({...I,kind:"SHIFT"}))].filter(I=>Ie==="BREACHED"?_r(I):!0).filter(I=>ve==="ALL"?!0:I.kind===ve).filter(I=>{var O,$;const B=Qt.trim().toLowerCase();if(!B)return!0;const v=String(((O=I.requester)==null?void 0:O.name)||"").toLowerCase(),k=String((($=I.requester)==null?void 0:$.role)||"").toLowerCase(),N=String(I.kind||"").toLowerCase(),S=String(I.type||I.shiftType||"").toLowerCase(),L=String(I.reason||"").toLowerCase();return v.includes(B)||k.includes(B)||N.includes(B)||S.includes(B)||L.includes(B)}).sort((I,B)=>{const v=_r(I)?1:0,k=_r(B)?1:0;if(v!==k)return k-v;const N=I.slaDueAt?new Date(I.slaDueAt).getTime():Number.MAX_SAFE_INTEGER,S=B.slaDueAt?new Date(B.slaDueAt).getTime():Number.MAX_SAFE_INTEGER;return N!==S?N-S:new Date(B.createdAt).getTime()-new Date(I.createdAt).getTime()}),[n,i,o,Ie,ve,Qt]),It=m.useMemo(()=>Bn.filter(I=>_r(I)),[Bn]),Rs=m.useMemo(()=>{const I={LEAVE:0,OVERTIME:0,SHIFT:0};for(const B of Bn)Object.prototype.hasOwnProperty.call(I,B.kind)&&(I[B.kind]+=1);return I},[Bn]),Ts=async I=>{var B,v;try{if(R(I),I==="LEAVE"){if(!y||!c)return;const k=await Pi("LEAVE","PENDING",{cursorMode:!0,limit:25,cursor:c}),N=pn(k.data);r(S=>[...S,...N.items]),u(N.nextCursor),j(N.hasMore)}if(I==="OVERTIME"){if(!A||!d)return;const k=await Pi("OVERTIME","PENDING",{cursorMode:!0,limit:25,cursor:d}),N=pn(k.data);a(S=>[...S,...N.items]),p(N.nextCursor),g(N.hasMore)}if(I==="SHIFT"){if(!x||!h)return;const k=await Pi("SHIFT","PENDING",{cursorMode:!0,limit:25,cursor:h}),N=pn(k.data);l(S=>[...S,...N.items]),f(N.nextCursor),w(N.hasMore)}}catch(k){we(((v=(B=k==null?void 0:k.response)==null?void 0:B.data)==null?void 0:v.message)||`Failed to load more ${I} requests`)}finally{R("")}},Ma=async()=>{try{const I=localStorage.getItem(Qa),B=I?JSON.parse(I):{};delete B[Nt],localStorage.setItem(Qa,JSON.stringify(B))}catch{}Ue("ALL"),st("ALL"),En(""),r([]),a([]),l([]),u(null),p(null),f(null),j(!1),g(!1),w(!1),await yt({append:!1}),kt("Live  now"),we("View reset and reloaded from server")},Os=()=>{if(!It.length)return;const I=Se%It.length,B=It[I],v=`${B.kind}-${B._id}`;Un(v);const k=`breach-row-${v}`,N=document.getElementById(k);N&&N.scrollIntoView({behavior:"smooth",block:"center"}),it(S=>(S+1)%It.length)};m.useEffect(()=>{Jt&&(fn(!1),setTimeout(()=>{Os()},120))},[Jt,Bn]),m.useEffect(()=>{if(!Ht)return;It.some(B=>`${B.kind}-${B._id}`===Ht)||Un("")},[Ht,It]);const Ua=()=>{if(!It.length)return null;if(Ht){const I=It.find(B=>`${B.kind}-${B._id}`===Ht);if(I)return I}return It[0]},Ps=async(I,B,v=!1)=>{var k,N;try{I==="LEAVE"&&await pP(B),I==="OVERTIME"&&await vP(B),I==="SHIFT"&&await wP(B),await yt({append:!1}),xe&&v&&fn(!0),we(`${I} request approved`)}catch(S){we(((N=(k=S==null?void 0:S.response)==null?void 0:k.data)==null?void 0:N.message)||`Failed to approve ${I} request`)}},z=async(I,B,v=!1)=>{var N,S;const k=prompt("Rejection reason")||"Rejected";try{I==="LEAVE"&&await mP(B,k),I==="OVERTIME"&&await xP(B,k),I==="SHIFT"&&await SP(B,k),await yt({append:!1}),xe&&v&&fn(!0),we(`${I} request rejected`)}catch(L){we(((S=(N=L==null?void 0:L.response)==null?void 0:N.data)==null?void 0:S.message)||`Failed to reject ${I} request`)}},Rt=async I=>{var v,k;const B=W[I];if(B){Ke(!0);try{await NP(I,{targetMinutes:Number(B.targetMinutes),escalationMinutes:Number(B.escalationMinutes),active:!!B.active}),await yt({append:!1}),we(`${I} SLA policy updated`)}catch(N){we(((k=(v=N==null?void 0:N.response)==null?void 0:v.data)==null?void 0:k.message)||`Failed to update ${I} policy`)}finally{Ke(!1)}}},bi=async I=>{var v,k,N,S,L,O,$,H;const B=F[I];if(B){Fe(!0);try{await PP(I,{active:!!B.active,autoApprove:!!B.autoApprove,requireSecondApprover:!!B.requireSecondApprover,fallbackRole:String(B.fallbackRole||"").toUpperCase(),escalationAfterMinutes:Number(B.escalationAfterMinutes||120),conditions:{maxLeaveDays:Number(((v=B.conditions)==null?void 0:v.maxLeaveDays)||0),maxOvertimeHours:Number(((k=B.conditions)==null?void 0:k.maxOvertimeHours)||0),priorityAgeMultiplier:Number(((N=B.conditions)==null?void 0:N.priorityAgeMultiplier)??1),priorityWeightCap:Number(((S=B.conditions)==null?void 0:S.priorityWeightCap)??5),allowedShiftTypes:String(((L=B.conditions)==null?void 0:L.allowedShiftTypes)||"").split(",").map(G=>G.trim().toUpperCase()).filter(Boolean),fallbackCandidates:String(((O=B.conditions)==null?void 0:O.fallbackCandidates)||"").split(",").map(G=>G.trim().toUpperCase()).filter(Boolean)}}),await yt(),we(`${I} automation policy updated`)}catch(G){we(((H=($=G==null?void 0:G.response)==null?void 0:$.data)==null?void 0:H.message)||`Failed to update ${I} automation`)}finally{Fe(!1)}}},wi=async()=>{var I,B,v,k;try{const N=await MP(),S=((B=(I=N==null?void 0:N.data)==null?void 0:I.escalated)==null?void 0:B.total)??0;we(`Automation sweep completed. Escalated: ${S}`),await yt()}catch(N){we(((k=(v=N==null?void 0:N.response)==null?void 0:v.data)==null?void 0:k.message)||"Automation sweep failed")}},Si=async I=>{var B,v;if(I){Fe(!0);try{await kP(I),await yt({append:!1}),we(`Applied ${I} preset to all request types`)}catch(k){we(((v=(B=k==null?void 0:k.response)==null?void 0:B.data)==null?void 0:v.message)||"Failed to apply preset to all")}finally{Fe(!1)}}},Ei=async()=>{var I,B;Fe(!0);try{await IP(fe),await yt({append:!1}),we(`Custom preset ${fe.key||fe.name} saved`)}catch(v){we(((B=(I=v==null?void 0:v.response)==null?void 0:I.data)==null?void 0:B.message)||"Failed to save custom preset")}finally{Fe(!1)}},Ni=I=>{var v,k;if(!I)return;const B=I.config||{};De({key:String(I.key||"").toUpperCase(),name:I.name||"",description:I.description||"",config:{active:B.active!==!1,autoApprove:B.autoApprove===!0,requireSecondApprover:B.requireSecondApprover!==!1,fallbackRole:B.fallbackRole||"AUTO",escalationAfterMinutes:Number(B.escalationAfterMinutes||120),conditions:{priorityAgeMultiplier:Number(((v=B.conditions)==null?void 0:v.priorityAgeMultiplier)??1),priorityWeightCap:Number(((k=B.conditions)==null?void 0:k.priorityWeightCap)??5)}}})},_i=async I=>{var B,v;if(I){Fe(!0);try{await RP(I),await yt({append:!1}),we(`Custom preset ${I} deactivated`)}catch(k){we(((v=(B=k==null?void 0:k.response)==null?void 0:B.data)==null?void 0:v.message)||"Failed to deactivate custom preset")}finally{Fe(!1)}}},Ai=async I=>{var B,v;if(I){Fe(!0);try{await TP(I),await yt({append:!1}),we(`Custom preset ${I} reactivated`)}catch(k){we(((v=(B=k==null?void 0:k.response)==null?void 0:B.data)==null?void 0:v.message)||"Failed to reactivate custom preset")}finally{Fe(!1)}}},Ci=async()=>{var I,B;mt(!0);try{const v=await DP({limit:100});be((v==null?void 0:v.data)||null),we("Escalation preview generated")}catch(v){we(((B=(I=v==null?void 0:v.response)==null?void 0:I.data)==null?void 0:B.message)||"Escalation preview failed")}finally{mt(!1)}},ki=async I=>{var k,N,S,L,O;const B=F[I];if(!B)return;const v=I==="LEAVE"?{startDate:new Date().toISOString(),endDate:new Date().toISOString()}:I==="OVERTIME"?{hours:Number(((k=B.conditions)==null?void 0:k.maxOvertimeHours)||1)}:{shiftType:((S=String(((N=B.conditions)==null?void 0:N.allowedShiftTypes)||"DAY").split(",")[0])==null?void 0:S.trim())||"DAY"};try{const $=await LP({requestType:I,sample:v});me({requestType:I,...$.data}),we(`${I} simulation ran`)}catch($){we(((O=(L=$==null?void 0:$.response)==null?void 0:L.data)==null?void 0:O.message)||"Simulation failed")}};return m.useEffect(()=>{const I=v=>{if(!v)return!1;const k=String(v.tagName||"").toLowerCase();return k==="input"||k==="textarea"||k==="select"||v.isContentEditable},B=async v=>{var S;if(I(v.target))return;const k=String(v.key||"").toLowerCase();if(!["j","a","r","u","f"].includes(k))return;if(v.preventDefault(),k==="f"){(S=je.current)==null||S.focus();return}if(k==="u"){st(L=>L==="BREACHED"?"ALL":"BREACHED");return}if(k==="j"){Os();return}const N=Ua();if(N){if(k==="a"){await Ps(N.kind,N._id,!0);return}k==="r"&&await z(N.kind,N._id,!0)}};return window.addEventListener("keydown",B),()=>window.removeEventListener("keydown",B)},[It,Ht,xe,Se]),s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"Workforce Approvals"}),s.jsx("p",{className:"muted",children:"Leave, overtime and shift approvals with SLA monitoring."})]}),s.jsxs("div",{className:"welcome-actions",children:[s.jsx("span",{className:"triage-shortcuts",children:"Shortcuts: J next  A approve  R reject  U breached only  F filter"}),s.jsx("input",{ref:je,className:"triage-filter-input",placeholder:"Filter staff, role, type, reason...",value:Qt,onChange:I=>En(I.target.value)}),s.jsxs("button",{className:`btn-secondary ${xe?"active":""}`,onClick:()=>St(I=>!I),title:"When enabled, approving/rejecting a breached item moves focus to the next breached item.",children:["Auto-Advance: ",xe?"On":"Off"]}),s.jsxs("button",{className:"btn-secondary",onClick:Os,disabled:!It.length,title:It.length?"Jump to next overdue request":"No breached rows",children:["Jump to Next Breached ",It.length?`(${It.length})`:""]}),s.jsx("button",{className:"btn-secondary",onClick:()=>st(I=>I==="BREACHED"?"ALL":"BREACHED"),children:Ie==="BREACHED"?"Show All":"Show Breached Only"}),s.jsxs("select",{value:ve,onChange:I=>Ue(I.target.value),title:"Filter pending table by request type",children:[s.jsx("option",{value:"ALL",children:"All Queues"}),s.jsx("option",{value:"LEAVE",children:"Leave"}),s.jsx("option",{value:"OVERTIME",children:"Overtime"}),s.jsx("option",{value:"SHIFT",children:"Shift"})]}),s.jsx("button",{className:"btn-secondary",onClick:()=>yt({append:!1}),disabled:Y,children:"Refresh"}),s.jsx("button",{className:"btn-secondary",onClick:Ma,disabled:Y,children:"Reset View"}),s.jsx("span",{className:"muted",children:gt})]})]}),Pt&&s.jsx("div",{className:"card",children:Pt}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Queue Insights"}),s.jsxs("div",{className:"grid info-grid",children:[s.jsxs("div",{className:"card stat",children:[s.jsx("div",{className:"card-title",children:"Pending"}),s.jsx("div",{className:"card-value",children:((Ls=C==null?void 0:C.totals)==null?void 0:Ls.pending)??""})]}),s.jsxs("div",{className:"card stat",children:[s.jsx("div",{className:"card-title",children:"Breached"}),s.jsx("div",{className:"card-value",children:((Ds=C==null?void 0:C.totals)==null?void 0:Ds.breached)??""})]}),s.jsxs("div",{className:"card stat",children:[s.jsx("div",{className:"card-title",children:"L2 Pending"}),s.jsx("div",{className:"card-value",children:((Ms=C==null?void 0:C.totals)==null?void 0:Ms.l2Pending)??""})]}),s.jsxs("div",{className:"card stat",children:[s.jsx("div",{className:"card-title",children:"Approved"}),s.jsx("div",{className:"card-value",children:((Us=C==null?void 0:C.totals)==null?void 0:Us.approved)??""})]}),s.jsxs("div",{className:"card stat",children:[s.jsx("div",{className:"card-title",children:"Rejected"}),s.jsx("div",{className:"card-value",children:((Bs=C==null?void 0:C.totals)==null?void 0:Bs.rejected)??""})]})]})]}),s.jsxs("section",{className:"section",id:"sla",children:[s.jsx("h3",{children:"SLA Policies"}),s.jsx("div",{className:"card",children:s.jsxs("table",{className:"table lite",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Request Type"}),s.jsx("th",{children:"Target (mins)"}),s.jsx("th",{children:"Escalation (mins)"}),s.jsx("th",{children:"Active"}),s.jsx("th",{children:"Action"})]})}),s.jsxs("tbody",{children:[D.map(I=>{const B=W[I.requestType]||{};return s.jsxs("tr",{children:[s.jsx("td",{children:I.requestType}),s.jsx("td",{children:s.jsx("input",{type:"number",min:"1",value:B.targetMinutes??"",onChange:v=>q(k=>({...k,[I.requestType]:{...k[I.requestType],targetMinutes:v.target.value}}))})}),s.jsx("td",{children:s.jsx("input",{type:"number",min:"1",value:B.escalationMinutes??"",onChange:v=>q(k=>({...k,[I.requestType]:{...k[I.requestType],escalationMinutes:v.target.value}}))})}),s.jsx("td",{children:s.jsx("input",{type:"checkbox",checked:!!B.active,onChange:v=>q(k=>({...k,[I.requestType]:{...k[I.requestType],active:v.target.checked}}))})}),s.jsx("td",{children:s.jsx("button",{className:"btn-secondary",disabled:ge,onClick:()=>Rt(I.requestType),children:"Save"})})]},I.requestType)}),D.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:"5",children:"No SLA policies loaded"})})]})]})})]}),s.jsxs("section",{className:"section",id:"automation",children:[s.jsx("h3",{children:"Automation Policies"}),s.jsxs("div",{className:"card",children:[s.jsxs("div",{className:"welcome-actions",style:{marginBottom:10},children:[s.jsx("button",{className:"btn-secondary",onClick:wi,children:"Run Escalation Sweep"}),s.jsx("button",{className:"btn-secondary",onClick:Ci,disabled:Me,children:Me?"Previewing...":"Preview Escalation Plan"}),K.map(I=>s.jsxs("button",{className:"btn-secondary",disabled:Ae,title:`${I.description||""}${I.version?` | v${I.version}`:""}`,onClick:()=>Si(I.key),children:["Apply ",I.name||I.key," to all"]},`preset-all-${I.key}`)),s.jsx("button",{className:"btn-secondary",onClick:()=>X(I=>!I),children:M?"Hide Inactive Presets":"Show Inactive Presets"})]}),s.jsxs("div",{className:"card",style:{marginBottom:10},children:[s.jsx("strong",{children:"Preset Catalog"}),s.jsx("div",{className:"table-wrap",style:{marginTop:10},children:s.jsxs("table",{className:"table lite",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Key"}),s.jsx("th",{children:"Name"}),s.jsx("th",{children:"Source"}),s.jsx("th",{children:"Version"}),s.jsx("th",{children:"Actions"})]})}),s.jsxs("tbody",{children:[K.map(I=>{const B=I.source==="CUSTOM";return s.jsxs("tr",{children:[s.jsx("td",{children:I.key}),s.jsx("td",{children:I.name||"-"}),s.jsx("td",{children:I.source||"SYSTEM"}),s.jsx("td",{children:I.version||1}),s.jsxs("td",{children:[s.jsx("button",{className:"btn-secondary",onClick:()=>Ni(I),children:"Clone to Form"}),B&&I.active!==!1&&tr&&s.jsx("button",{className:"btn-danger",disabled:Ae,onClick:()=>_i(I.key),children:"Deactivate"}),B&&I.active===!1&&tr&&s.jsx("button",{className:"btn-secondary",disabled:Ae,onClick:()=>Ai(I.key),children:"Reactivate"})]})]},`preset-row-${I.key}`)}),K.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:"5",children:"No presets available"})})]})]})})]}),s.jsxs("div",{className:"card",style:{marginBottom:10},children:[s.jsx("strong",{children:"Create/Update Custom Preset"}),s.jsxs("div",{className:"grid info-grid",style:{marginTop:10},children:[s.jsxs("label",{children:["Key",s.jsx("input",{type:"text",placeholder:"e.g. NIGHT_SHIFT_RUSH",value:fe.key,onChange:I=>De(B=>({...B,key:I.target.value.toUpperCase().replace(/[^A-Z0-9_]/g,"")}))})]}),s.jsxs("label",{children:["Name",s.jsx("input",{type:"text",placeholder:"Human readable name",value:fe.name,onChange:I=>De(B=>({...B,name:I.target.value}))})]}),s.jsxs("label",{children:["Description",s.jsx("input",{type:"text",placeholder:"When to use this preset",value:fe.description,onChange:I=>De(B=>({...B,description:I.target.value}))})]}),s.jsxs("label",{children:["Escalate After (min)",s.jsx("input",{type:"number",min:"5",max:"10080",value:fe.config.escalationAfterMinutes,onChange:I=>De(B=>({...B,config:{...B.config,escalationAfterMinutes:I.target.value}}))})]}),s.jsxs("label",{children:["Fallback Role",s.jsxs("select",{value:fe.config.fallbackRole,onChange:I=>De(B=>({...B,config:{...B.config,fallbackRole:I.target.value}})),children:[s.jsx("option",{value:"AUTO",children:"AUTO"}),s.jsx("option",{value:"HOSPITAL_ADMIN",children:"HOSPITAL_ADMIN"}),s.jsx("option",{value:"HR_MANAGER",children:"HR_MANAGER"}),s.jsx("option",{value:"PAYROLL_OFFICER",children:"PAYROLL_OFFICER"}),s.jsx("option",{value:"SYSTEM_ADMIN",children:"SYSTEM_ADMIN"}),s.jsx("option",{value:"SUPER_ADMIN",children:"SUPER_ADMIN"})]})]}),s.jsxs("label",{children:["Priority Age Multiplier",s.jsx("input",{type:"number",min:"0.1",max:"10",step:"0.1",value:fe.config.conditions.priorityAgeMultiplier,onChange:I=>De(B=>({...B,config:{...B.config,conditions:{...B.config.conditions,priorityAgeMultiplier:I.target.value}}}))})]}),s.jsxs("label",{children:["Priority Weight Cap",s.jsx("input",{type:"number",min:"1",max:"20",step:"0.1",value:fe.config.conditions.priorityWeightCap,onChange:I=>De(B=>({...B,config:{...B.config,conditions:{...B.config.conditions,priorityWeightCap:I.target.value}}}))})]}),s.jsxs("label",{children:[s.jsx("input",{type:"checkbox",checked:!!fe.config.autoApprove,onChange:I=>De(B=>({...B,config:{...B.config,autoApprove:I.target.checked}}))}),"Auto-Approve"]}),s.jsxs("label",{children:[s.jsx("input",{type:"checkbox",checked:!!fe.config.requireSecondApprover,onChange:I=>De(B=>({...B,config:{...B.config,requireSecondApprover:I.target.checked}}))}),"Require 2nd Approver"]})]}),s.jsxs("div",{className:"welcome-actions",style:{marginTop:10},children:[s.jsx("button",{className:"btn-secondary",disabled:Ae,onClick:Ei,children:"Save Custom Preset"}),s.jsx("button",{className:"btn-secondary",onClick:()=>De({key:"",name:"",description:"",config:{active:!0,autoApprove:!1,requireSecondApprover:!0,fallbackRole:"AUTO",escalationAfterMinutes:120,conditions:{priorityAgeMultiplier:1,priorityWeightCap:5}}}),children:"Reset Form"})]})]}),s.jsxs("div",{className:"card",style:{marginBottom:10},children:[s.jsx("strong",{children:"Preset Usage History"}),s.jsx("div",{className:"table-wrap",style:{marginTop:10},children:s.jsxs("table",{className:"table lite",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Time"}),s.jsx("th",{children:"Action"}),s.jsx("th",{children:"Preset"}),s.jsx("th",{children:"Actor"}),s.jsx("th",{children:"Role"})]})}),s.jsxs("tbody",{children:[ae.map(I=>{var B,v,k;return s.jsxs("tr",{children:[s.jsx("td",{children:I.createdAt?new Date(I.createdAt).toLocaleString():"-"}),s.jsx("td",{children:I.action}),s.jsx("td",{children:I.presetKey||"-"}),s.jsx("td",{children:((B=I.actor)==null?void 0:B.name)||((v=I.actor)==null?void 0:v.email)||"-"}),s.jsx("td",{children:((k=I.actor)==null?void 0:k.role)||"-"})]},`preset-history-${I.id}`)}),ae.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:"5",children:"No preset usage history yet"})})]})]})})]}),se&&s.jsxs("div",{className:"card",style:{marginBottom:10},children:[s.jsxs("strong",{children:["Escalation Preview  Candidates: ",((qr=se==null?void 0:se.totals)==null?void 0:qr.totalCandidates)??0]}),s.jsxs("div",{className:"muted",style:{marginTop:6},children:["Generated:"," ",se!=null&&se.generatedAt?new Date(se.generatedAt).toLocaleString():"-"]}),s.jsx("div",{className:"grid info-grid",style:{marginTop:10},children:((se==null?void 0:se.previews)||[]).map(I=>s.jsxs("div",{className:"card stat",children:[s.jsx("div",{className:"card-title",children:I.requestType}),s.jsx("div",{className:"card-value",children:I.totalCandidates||0}),s.jsx("div",{className:"muted",children:I.eligible?`Fallback: ${I.fallbackRole||"-"} (${I.fallbackMode||"FIXED"})`:`Ineligible: ${I.reason||"N/A"}`}),I.eligible&&s.jsxs("div",{className:"muted",children:["Weighted demand: ",I.weightedCandidates??0]}),I.eligible&&I.priorityTuning&&s.jsxs("div",{className:"muted",children:["Tuning: age x",I.priorityTuning.priorityAgeMultiplier??1,", cap"," ",I.priorityTuning.priorityWeightCap??5]}),Array.isArray(I.roleForecast)&&I.roleForecast.length>0&&s.jsx("div",{className:"muted",style:{marginTop:8},children:I.roleForecast.map(B=>s.jsxs("div",{children:[B.role,": now ",B.currentPendingAssignments," (+age ",B.currentAvgPendingAgeMinutes,"m)"," "," / +",B.projectedAssignments," (w ",B.projectedWeightedAssignments,") "," ",B.projectedAvgPendingPerUser,"/user, pressure ",B.projectedPriorityPressure]},`${I.requestType}-${B.role}`))})]},`preview-${I.requestType}`))})]}),s.jsxs("table",{className:"table lite",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Request Type"}),s.jsx("th",{children:"Policy Active"}),s.jsx("th",{children:"Auto-Approve"}),s.jsx("th",{children:"2nd Approver"}),s.jsx("th",{children:"Fallback Role"}),s.jsx("th",{children:"Escalate After (min)"}),s.jsx("th",{children:"Max Leave Days"}),s.jsx("th",{children:"Max Overtime Hours"}),s.jsx("th",{children:"Priority Age Multiplier"}),s.jsx("th",{children:"Priority Weight Cap"}),s.jsx("th",{children:"Allowed Shift Types (comma)"}),s.jsx("th",{children:"Fallback Candidates (comma roles)"}),s.jsx("th",{children:"Action"})]})}),s.jsxs("tbody",{children:[P.map(I=>{var v,k,N,S,L,O;const B=F[I.requestType]||{};return s.jsxs("tr",{children:[s.jsx("td",{children:I.requestType}),s.jsx("td",{children:s.jsx("input",{type:"checkbox",checked:!!B.active,onChange:$=>Z(H=>({...H,[I.requestType]:{...H[I.requestType],active:$.target.checked}}))})}),s.jsx("td",{children:s.jsx("input",{type:"checkbox",checked:!!B.autoApprove,onChange:$=>Z(H=>({...H,[I.requestType]:{...H[I.requestType],autoApprove:$.target.checked}}))})}),s.jsx("td",{children:s.jsx("input",{type:"checkbox",checked:!!B.requireSecondApprover,onChange:$=>Z(H=>({...H,[I.requestType]:{...H[I.requestType],requireSecondApprover:$.target.checked}}))})}),s.jsx("td",{children:s.jsxs("select",{value:B.fallbackRole||"HOSPITAL_ADMIN",onChange:$=>Z(H=>({...H,[I.requestType]:{...H[I.requestType],fallbackRole:$.target.value}})),children:[s.jsx("option",{value:"AUTO",children:"AUTO (workload-aware)"}),s.jsx("option",{value:"HOSPITAL_ADMIN",children:"HOSPITAL_ADMIN"}),s.jsx("option",{value:"HR_MANAGER",children:"HR_MANAGER"}),s.jsx("option",{value:"PAYROLL_OFFICER",children:"PAYROLL_OFFICER"}),s.jsx("option",{value:"SYSTEM_ADMIN",children:"SYSTEM_ADMIN"}),s.jsx("option",{value:"SUPER_ADMIN",children:"SUPER_ADMIN"})]})}),s.jsx("td",{children:s.jsx("input",{type:"number",min:"5",max:"10080",value:B.escalationAfterMinutes??120,onChange:$=>Z(H=>({...H,[I.requestType]:{...H[I.requestType],escalationAfterMinutes:$.target.value}}))})}),s.jsx("td",{children:s.jsx("input",{type:"number",min:"0",max:"60",value:((v=B.conditions)==null?void 0:v.maxLeaveDays)??0,onChange:$=>Z(H=>{var G;return{...H,[I.requestType]:{...H[I.requestType],conditions:{...((G=H[I.requestType])==null?void 0:G.conditions)||{},maxLeaveDays:$.target.value}}}})})}),s.jsx("td",{children:s.jsx("input",{type:"number",min:"0",max:"24",value:((k=B.conditions)==null?void 0:k.maxOvertimeHours)??0,onChange:$=>Z(H=>{var G;return{...H,[I.requestType]:{...H[I.requestType],conditions:{...((G=H[I.requestType])==null?void 0:G.conditions)||{},maxOvertimeHours:$.target.value}}}})})}),s.jsx("td",{children:s.jsx("input",{type:"number",min:"0.1",max:"10",step:"0.1",value:((N=B.conditions)==null?void 0:N.priorityAgeMultiplier)??1,onChange:$=>Z(H=>{var G;return{...H,[I.requestType]:{...H[I.requestType],conditions:{...((G=H[I.requestType])==null?void 0:G.conditions)||{},priorityAgeMultiplier:$.target.value}}}})})}),s.jsx("td",{children:s.jsx("input",{type:"number",min:"1",max:"20",step:"0.1",value:((S=B.conditions)==null?void 0:S.priorityWeightCap)??5,onChange:$=>Z(H=>{var G;return{...H,[I.requestType]:{...H[I.requestType],conditions:{...((G=H[I.requestType])==null?void 0:G.conditions)||{},priorityWeightCap:$.target.value}}}})})}),s.jsx("td",{children:s.jsx("input",{type:"text",value:((L=B.conditions)==null?void 0:L.allowedShiftTypes)??"",onChange:$=>Z(H=>{var G;return{...H,[I.requestType]:{...H[I.requestType],conditions:{...((G=H[I.requestType])==null?void 0:G.conditions)||{},allowedShiftTypes:$.target.value}}}})})}),s.jsx("td",{children:s.jsx("input",{type:"text",value:((O=B.conditions)==null?void 0:O.fallbackCandidates)??"",onChange:$=>Z(H=>{var G;return{...H,[I.requestType]:{...H[I.requestType],conditions:{...((G=H[I.requestType])==null?void 0:G.conditions)||{},fallbackCandidates:$.target.value}}}})})}),s.jsxs("td",{children:[s.jsx("div",{className:"action-list",style:{marginBottom:8},children:K.map($=>s.jsx("button",{className:"btn-secondary",title:`${$.description||""}${$.version?` | v${$.version}`:""}`,onClick:()=>Is(I.requestType,$.key),children:$.name||$.key},`preset-row-${I.requestType}-${$.key}`))}),s.jsx("button",{className:"btn-secondary",disabled:Ae,onClick:()=>bi(I.requestType),children:"Save"}),s.jsx("button",{className:"btn-secondary",onClick:()=>ki(I.requestType),children:"Simulate"})]})]},`auto-${I.requestType}`)}),P.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:"13",children:"No automation policies loaded"})})]})]}),ne&&s.jsxs("div",{className:"card",style:{marginTop:10},children:[s.jsxs("strong",{children:["Simulation (",ne.requestType,")"]}),s.jsxs("div",{className:"muted",children:["Auto-Approve: ",(Vn=ne==null?void 0:ne.decision)!=null&&Vn.autoApprove?"Yes":"No"," | Requires 2nd Approver: ",(zr=ne==null?void 0:ne.decision)!=null&&zr.requiresSecondApprover?"Yes":"No"," | Fallback: ",((Nn=ne==null?void 0:ne.decision)==null?void 0:Nn.fallbackRole)||"-"]})]})]})]}),s.jsxs("section",{className:"section",id:"pending",children:[s.jsx("h3",{children:"Pending Requests"}),s.jsxs("div",{className:"card",children:[s.jsxs("div",{className:"action-list",style:{marginBottom:12},children:[s.jsx("button",{className:`action-pill ${ve==="ALL"?"active":""}`,onClick:()=>Ue("ALL"),children:"All"}),s.jsx("button",{className:`action-pill ${ve==="LEAVE"?"active":""}`,onClick:()=>Ue("LEAVE"),children:"Leave"}),s.jsx("button",{className:`action-pill ${ve==="OVERTIME"?"active":""}`,onClick:()=>Ue("OVERTIME"),children:"Overtime"}),s.jsx("button",{className:`action-pill ${ve==="SHIFT"?"active":""}`,onClick:()=>Ue("SHIFT"),children:"Shift"})]}),s.jsxs("div",{className:"action-list",style:{marginBottom:12},children:[s.jsxs("span",{className:"muted",children:["Leave: ",Rs.LEAVE,((nr=(Vs=C==null?void 0:C.queues)==null?void 0:Vs.leave)==null?void 0:nr.pending)!=null?` / total ${C.queues.leave.pending}`:""]}),s.jsx("button",{className:"btn-secondary",disabled:!y||b==="LEAVE",onClick:()=>Ts("LEAVE"),children:b==="LEAVE"?"Loading...":"Load more Leave"}),s.jsxs("span",{className:"muted",children:["Overtime: ",Rs.OVERTIME,(($s=(wr=C==null?void 0:C.queues)==null?void 0:wr.overtime)==null?void 0:$s.pending)!=null?` / total ${C.queues.overtime.pending}`:""]}),s.jsx("button",{className:"btn-secondary",disabled:!A||b==="OVERTIME",onClick:()=>Ts("OVERTIME"),children:b==="OVERTIME"?"Loading...":"Load more Overtime"}),s.jsxs("span",{className:"muted",children:["Shift: ",Rs.SHIFT,((Sr=(Fs=C==null?void 0:C.queues)==null?void 0:Fs.shift)==null?void 0:Sr.pending)!=null?` / total ${C.queues.shift.pending}`:""]}),s.jsx("button",{className:"btn-secondary",disabled:!x||b==="SHIFT",onClick:()=>Ts("SHIFT"),children:b==="SHIFT"?"Loading...":"Load more Shift"}),s.jsx("button",{className:"btn-secondary",disabled:E,onClick:()=>yt({append:!0}),children:E?"Loading...":"Load more All"})]}),s.jsxs("table",{className:"table lite",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Staff"}),s.jsx("th",{children:"Role"}),s.jsx("th",{children:"Type"}),s.jsx("th",{children:"Category"}),s.jsx("th",{children:"Requested"}),s.jsx("th",{children:"SLA Due"}),s.jsx("th",{children:"Stage"}),s.jsx("th",{children:"Reason"}),s.jsx("th",{children:"Actions"})]})}),s.jsxs("tbody",{children:[Bn.map(I=>{var B,v;return s.jsxs("tr",{id:`breach-row-${I.kind}-${I._id}`,className:[_r(I)?"breached-row":"",Ht===`${I.kind}-${I._id}`?"breached-row-active":""].join(" ").trim(),children:[s.jsx("td",{children:((B=I.requester)==null?void 0:B.name)||"-"}),s.jsx("td",{children:((v=I.requester)==null?void 0:v.role)||"-"}),s.jsx("td",{children:I.kind}),s.jsx("td",{children:I.type||I.shiftType||`${I.hours||"-"} hrs`}),s.jsx("td",{children:new Date(I.createdAt).toLocaleDateString()}),s.jsxs("td",{className:_r(I)?"text-danger":"",children:[I.slaDueAt?new Date(I.slaDueAt).toLocaleString():"-",_r(I)&&s.jsx("span",{className:"breach-pill",children:"BREACHED"})]}),s.jsx("td",{children:I.approvalStage||"L1_PENDING"}),s.jsx("td",{children:I.reason||"-"}),s.jsxs("td",{children:[s.jsx("button",{className:"btn-secondary",onClick:()=>Ps(I.kind,I._id,_r(I)),children:"Approve"}),s.jsx("button",{className:"btn-secondary",onClick:()=>z(I.kind,I._id,_r(I)),children:"Reject"})]})]},`${I.kind}-${I._id}`)}),Bn.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:"9",children:"No pending approvals"})})]})]})]})]})]})}function FP(){const{user:e}=Te(),[t,n]=m.useState([]),[r,i]=m.useState(!1),[a,o]=m.useState(null);if((e==null?void 0:e.role)!=="HOSPITAL_ADMIN"&&(e==null?void 0:e.role)!=="SUPER_ADMIN")return s.jsx("p",{children:" Access denied"});const l=async()=>{i(!0),o(null);try{const h=((await ue.get("/api/users")).data||[]).filter(f=>["HOSPITAL_ADMIN","DOCTOR","NURSE","LAB_TECH","PHARMACIST","RADIOLOGIST","THERAPIST","RECEPTIONIST","SECURITY_OFFICER","HR_MANAGER","PAYROLL_OFFICER"].includes(f.role));n(h)}catch{o("Failed to load staff")}finally{i(!1)}};m.useEffect(()=>{l()},[]);const c=async d=>{await ue.patch(`/api/users/${d}`,{active:!1}),l()},u=async(d,p)=>{await ue.patch(`/api/users/${d}`,{role:p}),l()};return s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"Staff Management"}),s.jsx("p",{className:"muted",children:"Approve roles, deactivate accounts."})]}),s.jsx("div",{className:"welcome-actions",children:s.jsx("button",{className:"btn-secondary",onClick:l,disabled:r,children:"Refresh"})})]}),a&&s.jsx("div",{className:"card",children:a}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Staff"}),s.jsx("div",{className:"card",children:s.jsxs("table",{className:"table lite",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Name"}),s.jsx("th",{children:"Email"}),s.jsx("th",{children:"Role"}),s.jsx("th",{children:"Status"}),s.jsx("th",{children:"Actions"})]})}),s.jsxs("tbody",{children:[t.map(d=>s.jsxs("tr",{children:[s.jsx("td",{children:d.name}),s.jsx("td",{children:d.email}),s.jsx("td",{children:s.jsxs("select",{value:d.role,onChange:p=>u(d._id,p.target.value),children:[s.jsx("option",{value:"HOSPITAL_ADMIN",children:"Hospital Admin"}),s.jsx("option",{value:"DOCTOR",children:"Doctor"}),s.jsx("option",{value:"NURSE",children:"Nurse"}),s.jsx("option",{value:"LAB_TECH",children:"Lab Tech"}),s.jsx("option",{value:"PHARMACIST",children:"Pharmacist"}),s.jsx("option",{value:"RADIOLOGIST",children:"Radiologist"}),s.jsx("option",{value:"THERAPIST",children:"Therapist"}),s.jsx("option",{value:"RECEPTIONIST",children:"Receptionist"}),s.jsx("option",{value:"SECURITY_OFFICER",children:"Security Officer"}),s.jsx("option",{value:"HR_MANAGER",children:"HR Manager"}),s.jsx("option",{value:"PAYROLL_OFFICER",children:"Payroll Officer"})]})}),s.jsx("td",{children:d.active===!1?"Inactive":"Active"}),s.jsx("td",{children:s.jsx("button",{className:"btn-secondary",onClick:()=>c(d._id),disabled:d.active===!1,children:"Deactivate"})})]},d._id)),t.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:"5",children:"No staff found"})})]})]})})]})]})}function HP(){const{user:e}=Te(),t=Re(),[n,r]=m.useState(null);return m.useEffect(()=>{KO().then(r).catch(()=>r(null))},[]),s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"Security Officer Field Console"}),s.jsx("p",{className:"muted",children:"Current shift execution, visitor flow, gate scanning and incident response."})]}),s.jsxs("div",{className:"welcome-actions",children:[s.jsx("button",{className:"btn-primary",onClick:()=>t("/security-officer"),children:"My Shift"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/security-officer"),children:"Visitor Check-In"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/security-officer"),children:"Emergency Alert"})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Shift & Zone"}),s.jsxs("div",{className:"grid info-grid",children:[s.jsx(te,{title:"Current Shift",value:"Active"}),s.jsx(te,{title:"Assigned Zone",value:(e==null?void 0:e.hospital)||"Main"}),s.jsx(te,{title:"Open Incidents",value:(n==null?void 0:n.openIncidents)??""}),s.jsx(te,{title:"Incidents Today",value:(n==null?void 0:n.incidentsToday)??""})]})]}),s.jsxs("section",{className:"section doctor-main-grid",children:[s.jsxs("div",{className:"card doctor-schedule-card",children:[s.jsx("h3",{children:"Center Operations"}),s.jsxs("div",{className:"panel-grid",children:[s.jsx("button",{className:"action-link",onClick:()=>t("/security-officer"),children:"QR Scanner Panel"}),s.jsx("button",{className:"action-link",onClick:()=>t("/security-officer"),children:"Visitor Log Table"}),s.jsx("button",{className:"action-link",onClick:()=>t("/security-officer"),children:"Patrol Logs"})]})]}),s.jsxs("div",{className:"card doctor-alerts-card",children:[s.jsx("h3",{children:"Right Actions"}),s.jsxs("div",{className:"alert-stack",children:[s.jsx("button",{className:"btn-secondary",onClick:()=>t("/security-officer"),children:"Incident Quick Form"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/security-officer"),children:"Alert Button"})]})]})]})]})}function qP(){const{user:e}=Te(),t=Re(),[n,r]=m.useState(null);return m.useEffect(()=>{YO().then(r).catch(()=>r(null))},[]),s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"Security Governance Dashboard"}),s.jsx("p",{className:"muted",children:"Access control, visitor management, incident response and device authorization."})]}),s.jsxs("div",{className:"welcome-actions",children:[s.jsx("button",{className:"btn-primary",onClick:()=>t("/security-admin"),children:"Access Logs"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/admin/notifications"),children:"Suspicious Alerts"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/reports"),children:"Compliance Reports"})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Security Snapshot"}),s.jsxs("div",{className:"grid info-grid",children:[s.jsx(te,{title:"Active Access Points",value:(n==null?void 0:n.officersActive)??""}),s.jsx(te,{title:"Open Incidents",value:(n==null?void 0:n.openIncidents)??""}),s.jsx(te,{title:"Escalated Incidents",value:(n==null?void 0:n.escalatedIncidents)??""}),s.jsx(te,{title:"Incidents Today",value:(n==null?void 0:n.incidentsToday)??""})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Security Control Panels"}),s.jsxs("div",{className:"panel-grid",children:[s.jsx("button",{className:"action-link",onClick:()=>t("/security-admin"),children:"Clearance Levels"}),s.jsx("button",{className:"action-link",onClick:()=>t("/security-admin"),children:"Visitor Management"}),s.jsx("button",{className:"action-link",onClick:()=>t("/security-admin"),children:"Device Authorization"}),s.jsx("button",{className:"action-link",onClick:()=>t("/security-admin"),children:"Emergency Protocols"}),s.jsx("button",{className:"action-link",onClick:()=>t("/security-admin"),children:"Blacklist Database"})]})]})]})}function zP(){const{user:e}=Te(),t=Re(),[n,r]=m.useState(null);m.useEffect(()=>{WO().then(r).catch(()=>r(null))},[]);const i=m.useMemo(()=>String((e==null?void 0:e.role)||"").toUpperCase(),[e==null?void 0:e.role]),a=i==="RADIOLOGIST"?"Radiologist Workspace":i==="THERAPIST"?"Therapist Workspace":i==="RECEPTIONIST"?"Receptionist Workspace":"Staff Workspace",o=i==="RADIOLOGIST"?["Imaging Queue","Scan Viewer","Report Editor","Equipment Logs","AI Assistance Overlay"]:i==="THERAPIST"?["Session Schedule","Patient Notes","Treatment Plans","Progress Tracking","Follow-up Planner"]:["Appointment Scheduling","Patient Check-In","Billing Initiation","Queue Management","Visitor Log"];return s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:a}),s.jsx("p",{className:"muted",children:"Role-specific operational dashboard with requests, queues and alerts."})]}),s.jsxs("div",{className:"welcome-actions",children:[s.jsx("button",{className:"btn-primary",onClick:()=>t("/staff"),children:"Open Workspace"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/workforce/requests"),children:"My Requests"})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Daily Summary"}),s.jsxs("div",{className:"grid info-grid",children:[s.jsx(te,{title:"My Pending Requests",value:(n==null?void 0:n.myPendingRequests)??""}),s.jsx(te,{title:"Hospital Pending Requests",value:(n==null?void 0:n.hospitalPendingRequests)??""}),s.jsx(te,{title:"Unread Notifications",value:(n==null?void 0:n.notificationsUnread)??""}),s.jsx(te,{title:"Appointments Today",value:(n==null?void 0:n.appointmentsToday)??""})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Role Workspace"}),s.jsx("div",{className:"panel-grid",children:o.map(l=>s.jsx("div",{className:"panel",children:l},l))})]})]})}function WP(){var j,A;const{user:e}=Te(),t=Re(),[n,r]=m.useState(null),[i,a]=m.useState(null),[o,l]=m.useState(null),[c,u]=m.useState({burnoutScore:[],projectedKpi:[],projectedChange:[]}),d=(g,x)=>{u(w=>({...w,[g]:[...w[g]||[],Number(x||0)].slice(-12)}))},p=g=>{const x=Number(g||0);return x>=75?"risk":x>=45?"warn":"good"},h=g=>{const x=Number(g||0);return x<0?"risk":x<3?"warn":"good"},f=g=>g==="risk"?"ALERT":g==="warn"?"WATCH":"OK",y=async()=>{try{const[g,x]=await Promise.all([zp({hoursPerWeek:50,nightShifts:4,consecutiveDays:6,overtimeHours:10,leaveBalanceDays:9,incidentsIn30d:1}),z0({baseline:100,interventions:[{name:"Shift rebalance",effectPct:6,confidence:.75},{name:"Fast-track hiring",effectPct:8,confidence:.65}]})]);a(g||null),l(x||null),d("burnoutScore",(g==null?void 0:g.score)||0),d("projectedKpi",(x==null?void 0:x.projected)||0),d("projectedChange",(x==null?void 0:x.changePct)||0)}catch{a(null),l(null)}};return m.useEffect(()=>{qO().then(r).catch(()=>r(null)),y();const g=setInterval(y,45e3);return()=>clearInterval(g)},[]),s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"HR Manager Command Center"}),s.jsx("p",{className:"muted",children:"Recruitment, onboarding, contracts, performance and workforce analytics."})]}),s.jsxs("div",{className:"welcome-actions",children:[s.jsx("button",{className:"btn-primary",onClick:()=>t("/hospital-admin/register-staff"),children:"Recruitment Pipeline"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/hospital-admin/staff"),children:"Employee Profiles"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/workforce/requests"),children:"Leave Management"})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Top HR KPIs"}),s.jsxs("div",{className:"grid info-grid",children:[s.jsx(te,{title:"Open Positions",value:(n==null?void 0:n.newHires)??""}),s.jsx(te,{title:"Leave Pending",value:((j=n==null?void 0:n.pendingRequests)==null?void 0:j.leave)??""}),s.jsx(te,{title:"Turnover %",value:(n==null?void 0:n.inactiveStaff)??""}),s.jsx(te,{title:"Compliance Alerts",value:(n==null?void 0:n.missingLicenses)??""})]})]}),s.jsxs("section",{className:"section doctor-main-grid",children:[s.jsxs("div",{className:"card doctor-schedule-card",children:[s.jsx("h3",{children:"Center Workspace"}),s.jsxs("div",{className:"panel-grid",children:[s.jsx("button",{className:"action-link",onClick:()=>t("/hospital-admin/register-staff"),children:"Recruitment Kanban"}),s.jsx("button",{className:"action-link",onClick:()=>t("/hospital-admin/staff"),children:"Contracts"}),s.jsx("button",{className:"action-link",onClick:()=>t("/hr-manager"),children:"Performance Reviews"}),s.jsx("button",{className:"action-link",onClick:()=>t("/hr-manager"),children:"Training & Certifications"}),s.jsx("button",{className:"action-link",onClick:()=>t("/hr-manager"),children:"Succession Planning"})]})]}),s.jsxs("div",{className:"card doctor-alerts-card",children:[s.jsx("h3",{children:"Right Insights"}),s.jsxs("div",{className:"alert-stack",children:[s.jsxs("div",{className:"action-pill",children:["Pending Requests: ",((A=n==null?void 0:n.pendingRequests)==null?void 0:A.total)??""]}),s.jsxs("div",{className:"action-pill",children:["Incomplete Staff: ",(n==null?void 0:n.incompleteStaff)??""]}),s.jsxs("div",{className:"action-pill",children:["Inactive Staff: ",(n==null?void 0:n.inactiveStaff)??""]})]})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"AI Workforce Intelligence"}),s.jsxs("div",{className:"grid info-grid",children:[s.jsx(te,{title:"Burnout Score",value:(i==null?void 0:i.score)??"",trend:c.burnoutScore,subtitle:"Auto-refresh 45s",status:p(i==null?void 0:i.score),badge:f(p(i==null?void 0:i.score)),why:`Burnout score ${(i==null?void 0:i.score)??0}; >=75 high risk, 45-74 medium.`,onBadgeClick:()=>t("/workforce/requests?status=PENDING")}),s.jsx(te,{title:"Burnout Band",value:(i==null?void 0:i.band)??""}),s.jsx(te,{title:"Projected KPI",value:(o==null?void 0:o.projected)??"",trend:c.projectedKpi,subtitle:"Auto-refresh 45s",status:h(o==null?void 0:o.changePct),badge:f(h(o==null?void 0:o.changePct)),why:`Projected KPI is ${(o==null?void 0:o.projected)??0}; negative expected change means risk.`,onBadgeClick:()=>t("/hospital-admin/register-staff")}),s.jsx(te,{title:"Projected Change %",value:(o==null?void 0:o.changePct)??"",trend:c.projectedChange,subtitle:"Auto-refresh 45s",status:h(o==null?void 0:o.changePct),badge:f(h(o==null?void 0:o.changePct)),why:`Change ${(o==null?void 0:o.changePct)??0}%; <0 is risk, 0-3 is watch.`,onBadgeClick:()=>t("/hospital-admin/register-staff")})]})]})]})}function GP(){const{user:e}=Te(),t=Re(),[n,r]=m.useState(null);return m.useEffect(()=>{zO().then(r).catch(()=>r(null))},[]),s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"Payroll Officer Engine"}),s.jsx("p",{className:"muted",children:"Run payroll, manage deductions, taxes, loans and audit-ready payroll history."})]}),s.jsxs("div",{className:"welcome-actions",children:[s.jsx("button",{className:"btn-primary",onClick:()=>t("/payments/full"),children:"Run Payroll"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/reports"),children:"Tax Reports"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/workforce/requests#overtime"),children:"Overtime"})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Payroll Status"}),s.jsxs("div",{className:"grid info-grid",children:[s.jsx(te,{title:"Current Payroll Status",value:(n==null?void 0:n.invoicesThisMonth)??""}),s.jsx(te,{title:"Total Gross",value:(n==null?void 0:n.totalThisMonth)??""}),s.jsx(te,{title:"Total Deductions",value:(n==null?void 0:n.unpaidInvoices)??""}),s.jsx(te,{title:"Net Pay Summary",value:(n==null?void 0:n.paidThisMonth)??""})]})]}),s.jsxs("section",{className:"section doctor-main-grid",children:[s.jsxs("div",{className:"card doctor-schedule-card",children:[s.jsx("h3",{children:"Payroll Table"}),s.jsxs("div",{className:"panel-grid",children:[s.jsx("button",{className:"action-link",onClick:()=>t("/payments/full"),children:"Overtime Management"}),s.jsx("button",{className:"action-link",onClick:()=>t("/payments/full"),children:"Allowances & Deductions"}),s.jsx("button",{className:"action-link",onClick:()=>t("/reports"),children:"Loan Management"}),s.jsx("button",{className:"action-link",onClick:()=>t("/payments/full"),children:"Generate Payslips"})]})]}),s.jsxs("div",{className:"card doctor-alerts-card",children:[s.jsx("h3",{children:"Right Insights"}),s.jsxs("div",{className:"alert-stack",children:[s.jsxs("div",{className:"action-pill",children:["Pending Approvals: ",(n==null?void 0:n.pendingApprovals)??""]}),s.jsxs("div",{className:"action-pill",children:["Overdue Payroll: ",(n==null?void 0:n.overduePayroll)??""]}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("/reports"),children:"Audit Trail"})]})]})]})]})}function YP(){var p,h,f,y,j,A,g,x,w,E,_,b;const e=Re(),[t,n]=m.useState(null),[r,i]=m.useState(null),[a,o]=m.useState(!1),[l,c]=m.useState(null),u=async()=>{try{const[R,C]=await Promise.all([Ho(),Oh()]);n(R||null),i((C==null?void 0:C.trust)||null)}catch{n(null),i(null)}};m.useEffect(()=>{u()},[]);const d=async()=>{var R,C,T,D,U,W;o(!0),c(null);try{const q=await mp(),P=((C=(R=q==null?void 0:q.result)==null?void 0:R.workforce)==null?void 0:C.escalationsL1)??0,V=((D=(T=q==null?void 0:q.result)==null?void 0:T.workforce)==null?void 0:D.escalationsL2)??0;c(`Workflow SLA scan completed (L1: ${P}, L2: ${V})`),localStorage.setItem("workflow_sla_last_scan",JSON.stringify({lastScanAt:(q==null?void 0:q.ranAt)||new Date().toISOString(),escalationsL1:P,escalationsL2:V,updatedAt:new Date().toISOString()})),await u()}catch(q){c(((W=(U=q==null?void 0:q.response)==null?void 0:U.data)==null?void 0:W.message)||"Failed to run workflow SLA scan")}finally{o(!1)}};return s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"Developer Engineering Console"}),s.jsx("p",{className:"muted",children:"API observability, queue health, trust controls and SLA operations."})]}),s.jsxs("div",{className:"welcome-actions",children:[s.jsx("button",{className:"btn-primary",onClick:d,disabled:a,children:a?"Running SLA Scan...":"Run Workflow SLA Scan"}),s.jsx("button",{className:"btn-secondary",onClick:u,children:"Refresh Metrics"}),s.jsx("button",{className:"btn-secondary",onClick:()=>e("/developer/queue-replay"),children:"Queue Replay"}),s.jsx("button",{className:"btn-secondary",onClick:()=>e("/developer/decision-cockpit"),children:"Decision Cockpit"})]})]}),l&&s.jsx("div",{className:"card",children:l}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Queue Metrics"}),s.jsxs("div",{className:"grid info-grid",children:[s.jsx(te,{title:"Integration Waiting",value:((h=(p=t==null?void 0:t.queues)==null?void 0:p.integration)==null?void 0:h.waiting)??""}),s.jsx(te,{title:"DLQ Failed",value:((y=(f=t==null?void 0:t.queues)==null?void 0:f.dlq)==null?void 0:y.failed)??""}),s.jsx(te,{title:"Webhook Waiting",value:((A=(j=t==null?void 0:t.queues)==null?void 0:j.webhook)==null?void 0:A.waiting)??""}),s.jsx(te,{title:"Notification Waiting",value:((x=(g=t==null?void 0:t.queues)==null?void 0:g.notifications)==null?void 0:x.waiting)??""}),s.jsx(te,{title:"Workforce Pending",value:((E=(w=t==null?void 0:t.queues)==null?void 0:w.workforce)==null?void 0:E.totalPending)??""}),s.jsx(te,{title:"Workforce Breached",value:((b=(_=t==null?void 0:t.queues)==null?void 0:_.workforce)==null?void 0:b.breached)??""})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Trust Foundation"}),s.jsxs("div",{className:"grid info-grid",children:[s.jsx(te,{title:"Ledger Writes (24h)",value:(r==null?void 0:r.ledgerWrites24h)??""}),s.jsx(te,{title:"Policy Denials (24h)",value:(r==null?void 0:r.policyDenials24h)??""}),s.jsx(te,{title:"Consent Denials (24h)",value:(r==null?void 0:r.consentDenials24h)??""}),s.jsx(te,{title:"Risk Step-Ups (24h)",value:(r==null?void 0:r.highRiskStepUps24h)??""}),s.jsx(te,{title:"Active Consents",value:(r==null?void 0:r.activeConsents)??""})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Engineering Tools"}),s.jsxs("div",{className:"panel-grid",children:[s.jsx("button",{className:"action-link",onClick:()=>e("/developer/webhook-retry"),children:"Webhook Retry"}),s.jsx("button",{className:"action-link",onClick:()=>e("/developer/queue-replay"),children:"Job Queue Replay"}),s.jsx("button",{className:"action-link",onClick:()=>e("/developer/decision-cockpit"),children:"Decision Cockpit"}),s.jsx("button",{className:"action-link",onClick:()=>e("/system-admin/clinical-intelligence"),children:"Clinical Intelligence"}),s.jsx("button",{className:"action-link",onClick:()=>e("/developer/provenance-verify"),children:"Provenance Verify"}),s.jsx("button",{className:"action-link",onClick:()=>e("/ai/extract"),children:"NeuroEdge Extract"}),s.jsx("button",{className:"action-link",onClick:()=>e("/admin/realtime"),children:"Integration Monitor"}),s.jsx("button",{className:"action-link",onClick:()=>e("/admin/audit-logs"),children:"Audit Logs"}),s.jsx("button",{className:"action-link",onClick:()=>e("/super-admin/settings"),children:"Feature Flags"}),s.jsx("button",{className:"action-link",onClick:()=>e("/hospital-admin/approvals"),children:"Workforce Approvals"})]})]})]})}const $y=async()=>(await ue.get("/api/system-admin/metrics")).data,KP=async()=>{var t;return((t=(await ue.get("/api/system-admin/risk-policy")).data)==null?void 0:t.policy)||null},JP=async e=>{var n;return((n=(await ue.put("/api/system-admin/risk-policy",e)).data)==null?void 0:n.policy)||null},Fy=async(e={})=>{var i;const t=new URLSearchParams;e.domain&&t.set("domain",e.domain),e.resource&&t.set("resource",e.resource),e.action&&t.set("action",e.action),e.activeOnly&&t.set("activeOnly","1");const n=t.toString();return((i=(await ue.get(`/api/system-admin/abac-policies${n?`?${n}`:""}`)).data)==null?void 0:i.items)||[]},Hy=async e=>(await ue.post("/api/system-admin/abac-policies",e)).data,qy=async(e,t)=>(await ue.put(`/api/system-admin/abac-policies/${e}`,t)).data,QP=async e=>(await ue.delete(`/api/system-admin/abac-policies/${e}`)).data,ZP=async e=>(await ue.post("/api/system-admin/abac-simulate",e)).data,XP=async(e={})=>{var i;const t=new URLSearchParams;e.activeOnly&&t.set("activeOnly","1");const n=t.toString();return((i=(await ue.get(`/api/system-admin/abac-test-cases${n?`?${n}`:""}`)).data)==null?void 0:i.items)||[]},eL=async e=>(await ue.post("/api/system-admin/abac-test-cases",e)).data,tL=async e=>(await ue.delete(`/api/system-admin/abac-test-cases/${e}`)).data,nL=async e=>(await ue.post(`/api/system-admin/abac-test-cases/${e}/run`)).data,rL=async()=>(await ue.post("/api/system-admin/abac-test-cases/run-all")).data;function sL(){var D,U,W,q,P,V,K,ce,M,X,ae,pe,fe,De,F,Z,Y,ye,ge,Ke,Ae,Fe,ne,me,se,be,Me,mt,Pt,we,Ie,st,ve,Ue,Se,it,xe,St,Jt,fn,Ht,Un,Qt,En;const e=Re(),[t,n]=m.useState(null),[r,i]=m.useState(null),[a,o]=m.useState(null),[l,c]=m.useState(!1),[u,d]=m.useState(null),[p,h]=m.useState(null),[f,y]=m.useState(!1),[j,A]=m.useState(null),[g,x]=m.useState({doctorGap:[],nurseGap:[],underCapacity:[],pendingShifts:[]}),w=(je,Ee)=>{x(dt=>({...dt,[je]:[...dt[je]||[],Number(Ee||0)].slice(-12)}))},E=je=>{const Ee=Number(je||0);return Ee<=0?"good":Ee<=5?"warn":"risk"},_=(je,Ee=1,dt=3)=>{const gt=Number(je||0);return gt>=dt?"risk":gt>=Ee?"warn":"good"},b=je=>je==="risk"?"ALERT":je==="warn"?"WATCH":"OK",R=async()=>{var je,Ee,dt,gt,kt;try{const[Et,Oe]=await Promise.all([qp({beds:300,occupancyRate:.8,avgPatientsPerDoctor:14,avgPatientsPerNurse:5,horizonDays:14}),W0({departments:[{name:"ICU",staff:22,demand:28,absenteeismRate:.06},{name:"Emergency",staff:36,demand:41,absenteeismRate:.05},{name:"Surgery",staff:18,demand:17,absenteeismRate:.04}]})]);A({forecast:Et,twin:Oe});const Nt=Array.isArray((je=Oe==null?void 0:Oe.twin)==null?void 0:je.departments)?Oe.twin.departments.filter(tr=>tr.status==="UNDER_CAPACITY").length:0;w("doctorGap",((Ee=Et==null?void 0:Et.forecast)==null?void 0:Ee.doctorGap)||0),w("nurseGap",((dt=Et==null?void 0:Et.forecast)==null?void 0:dt.nurseGap)||0),w("underCapacity",Nt),w("pendingShifts",((kt=(gt=Oe==null?void 0:Oe.twin)==null?void 0:gt.pendingRequests)==null?void 0:kt.shifts)||0)}catch{A(null)}};m.useEffect(()=>{Promise.all([$y(),Ho(),Oh()]).then(([Ee,dt,gt])=>{n(Ee||null),i(dt||null),o((gt==null?void 0:gt.trust)||null)}).catch(()=>{n(null),i(null),o(null)}),KP().then(Ee=>h(Ee||null)).catch(()=>h(null)),R();const je=setInterval(R,45e3);return()=>clearInterval(je)},[]);const C=async()=>{var je,Ee,dt,gt,kt,Et;c(!0),d(null);try{const Oe=await mp(),Nt=((Ee=(je=Oe==null?void 0:Oe.result)==null?void 0:je.workforce)==null?void 0:Ee.escalationsL1)??0,tr=((gt=(dt=Oe==null?void 0:Oe.result)==null?void 0:dt.workforce)==null?void 0:gt.escalationsL2)??0;d(`SLA scan completed (L1: ${Nt}, L2: ${tr})`);const[pn,Is,yt]=await Promise.all([$y(),Ho(),Oh()]);n(pn||null),i(Is||null),o((yt==null?void 0:yt.trust)||null)}catch(Oe){d(((Et=(kt=Oe==null?void 0:Oe.response)==null?void 0:kt.data)==null?void 0:Et.message)||"Failed to run SLA scan")}finally{c(!1)}},T=async()=>{if(p){y(!0),d(null);try{const je=await JP(p);h(je||p),d("Adaptive risk policy updated.")}catch(je){d((je==null?void 0:je.message)||"Failed to update risk policy")}finally{y(!1)}}};return s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"System Admin Technical Center"}),s.jsx("p",{className:"muted",children:"Operational reliability, queue health, integration stability and deployment visibility."})]}),s.jsxs("div",{className:"welcome-actions",children:[s.jsx("button",{className:"btn-primary",onClick:C,disabled:l,children:l?"Running SLA Scan...":"Run Workflow SLA Scan"}),s.jsx("button",{className:"btn-primary",onClick:()=>e("/developer"),children:"Server Metrics"}),s.jsx("button",{className:"btn-secondary",onClick:()=>e("/developer/queue-replay"),children:"Job Queue"}),s.jsx("button",{className:"btn-secondary",onClick:()=>e("/admin/realtime"),children:"Integration Monitor"})]})]}),u&&s.jsx("div",{className:"card",children:u}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"System Widgets"}),s.jsxs("div",{className:"grid info-grid",children:[s.jsx(te,{title:"CPU / Memory",value:((U=(D=r==null?void 0:r.queues)==null?void 0:D.integration)==null?void 0:U.active)??""}),s.jsx(te,{title:"Req / Min",value:((q=(W=r==null?void 0:r.queues)==null?void 0:W.integration)==null?void 0:q.completed)??""}),s.jsx(te,{title:"Failed Logins",value:((P=t==null?void 0:t.approvals)==null?void 0:P.total)??""}),s.jsx(te,{title:"Job Status",value:((K=(V=r==null?void 0:r.queues)==null?void 0:V.integration)==null?void 0:K.waiting)??""}),s.jsx(te,{title:"Microservices",value:(t==null?void 0:t.hospitals)??""}),s.jsx(te,{title:"Database Health",value:((M=(ce=r==null?void 0:r.queues)==null?void 0:ce.dlq)==null?void 0:M.failed)??""}),s.jsx(te,{title:"Workforce Breached",value:((ae=(X=r==null?void 0:r.queues)==null?void 0:X.workforce)==null?void 0:ae.breached)??""}),s.jsx(te,{title:"Policy Denials (24h)",value:(a==null?void 0:a.policyDenials24h)??""})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Technical Operations"}),s.jsxs("div",{className:"panel-grid",children:[s.jsx("button",{className:"action-link",onClick:()=>e("/developer"),children:"Error Logs"}),s.jsx("button",{className:"action-link",onClick:()=>e("/developer"),children:"API Logs"}),s.jsx("button",{className:"action-link",onClick:()=>e("/developer/queue-replay"),children:"Queue Monitor"}),s.jsx("button",{className:"action-link",onClick:()=>e("/developer/webhook-retry"),children:"Webhook Retry"}),s.jsx("button",{className:"action-link",onClick:()=>e("/system-admin/abac"),children:"ABAC Policies"}),s.jsx("button",{className:"action-link",onClick:()=>e("/system-admin/mapping-studio"),children:"Mapping Studio"}),s.jsx("button",{className:"action-link",onClick:()=>e("/system-admin/nlp-analytics"),children:"NLP Analytics"}),s.jsx("button",{className:"action-link",onClick:()=>e("/system-admin/clinical-intelligence"),children:"Clinical Intelligence"}),s.jsx("button",{className:"action-link",onClick:()=>e("/system-admin/regulatory-reports"),children:"Regulatory Reports"}),s.jsx("button",{className:"action-link",onClick:()=>e("/developer/ai-extraction-history"),children:"AI Extraction History"}),s.jsx("button",{className:"action-link",onClick:()=>e("/super-admin/settings"),children:"Feature Flags"}),s.jsx("button",{className:"action-link",onClick:()=>e("/admin/realtime"),children:"Integration Hub"})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"AI Intelligence Snapshot"}),s.jsxs("div",{className:"grid info-grid",children:[s.jsx(te,{title:"Doctor Gap",value:((fe=(pe=j==null?void 0:j.forecast)==null?void 0:pe.forecast)==null?void 0:fe.doctorGap)??"",trend:g.doctorGap,subtitle:"Auto-refresh 45s",status:E((F=(De=j==null?void 0:j.forecast)==null?void 0:De.forecast)==null?void 0:F.doctorGap),badge:b(E((Y=(Z=j==null?void 0:j.forecast)==null?void 0:Z.forecast)==null?void 0:Y.doctorGap)),why:`Gap is ${((ge=(ye=j==null?void 0:j.forecast)==null?void 0:ye.forecast)==null?void 0:ge.doctorGap)??0}; >5 means critical staffing risk.`,onBadgeClick:()=>e("/hospital-admin/register-staff?role=doctor")}),s.jsx(te,{title:"Nurse Gap",value:((Ae=(Ke=j==null?void 0:j.forecast)==null?void 0:Ke.forecast)==null?void 0:Ae.nurseGap)??"",trend:g.nurseGap,subtitle:"Auto-refresh 45s",status:E((ne=(Fe=j==null?void 0:j.forecast)==null?void 0:Fe.forecast)==null?void 0:ne.nurseGap),badge:b(E((se=(me=j==null?void 0:j.forecast)==null?void 0:me.forecast)==null?void 0:se.nurseGap)),why:`Gap is ${((Me=(be=j==null?void 0:j.forecast)==null?void 0:be.forecast)==null?void 0:Me.nurseGap)??0}; >5 means critical staffing risk.`,onBadgeClick:()=>e("/hospital-admin/register-staff?role=nurse")}),s.jsx(te,{title:"Under-Capacity Units",value:Array.isArray((Pt=(mt=j==null?void 0:j.twin)==null?void 0:mt.twin)==null?void 0:Pt.departments)?j.twin.twin.departments.filter(je=>je.status==="UNDER_CAPACITY").length:"",trend:g.underCapacity,subtitle:"Auto-refresh 45s",status:_(Array.isArray((Ie=(we=j==null?void 0:j.twin)==null?void 0:we.twin)==null?void 0:Ie.departments)?j.twin.twin.departments.filter(je=>je.status==="UNDER_CAPACITY").length:0,1,2),badge:b(_(Array.isArray((ve=(st=j==null?void 0:j.twin)==null?void 0:st.twin)==null?void 0:ve.departments)?j.twin.twin.departments.filter(je=>je.status==="UNDER_CAPACITY").length:0,1,2)),why:"Units with unmet demand are flagged. 2+ under-capacity units are critical.",onBadgeClick:()=>e("/system-admin/clinical-intelligence#digital-twin")}),s.jsx(te,{title:"Twin Pending Shifts",value:((it=(Se=(Ue=j==null?void 0:j.twin)==null?void 0:Ue.twin)==null?void 0:Se.pendingRequests)==null?void 0:it.shifts)??"",trend:g.pendingShifts,subtitle:"Auto-refresh 45s",status:_((Jt=(St=(xe=j==null?void 0:j.twin)==null?void 0:xe.twin)==null?void 0:St.pendingRequests)==null?void 0:Jt.shifts,5,15),badge:b(_((Un=(Ht=(fn=j==null?void 0:j.twin)==null?void 0:fn.twin)==null?void 0:Ht.pendingRequests)==null?void 0:Un.shifts,5,15)),why:"Pending shift requests above 15 indicate strong scheduling pressure.",onBadgeClick:()=>e("/hospital-admin/approvals?kind=SHIFT&view=all")})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Adaptive Risk Policy"}),s.jsx("div",{className:"card",children:p?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"grid info-grid",children:[s.jsxs("label",{className:"muted",children:["High Threshold",s.jsx("input",{type:"number",value:((Qt=p.thresholds)==null?void 0:Qt.high)??70,onChange:je=>h(Ee=>({...Ee,thresholds:{...(Ee==null?void 0:Ee.thresholds)||{},high:Number(je.target.value||70)}}))})]}),s.jsxs("label",{className:"muted",children:["Critical Threshold",s.jsx("input",{type:"number",value:((En=p.thresholds)==null?void 0:En.critical)??90,onChange:je=>h(Ee=>({...Ee,thresholds:{...(Ee==null?void 0:Ee.thresholds)||{},critical:Number(je.target.value||90)}}))})]}),s.jsxs("label",{className:"muted",children:["Restriction Minutes",s.jsx("input",{type:"number",value:p.restrictionMinutes??30,onChange:je=>h(Ee=>({...Ee,restrictionMinutes:Number(je.target.value||30)}))})]}),s.jsxs("label",{className:"muted",children:["Impossible Travel Window (min)",s.jsx("input",{type:"number",value:p.impossibleTravelWindowMinutes??90,onChange:je=>h(Ee=>({...Ee,impossibleTravelWindowMinutes:Number(je.target.value||90)}))})]})]}),s.jsxs("div",{className:"welcome-actions",style:{marginTop:12},children:[s.jsx("button",{className:"btn-primary",onClick:T,disabled:f,children:f?"Saving...":"Save Risk Policy"}),s.jsx("button",{className:"btn-secondary",onClick:()=>e("/step-up"),children:"Step-up Console"})]})]}):s.jsx("p",{className:"muted",children:"Risk policy unavailable."})})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Admin Controls"}),s.jsxs("div",{className:"action-list",children:[s.jsx("button",{className:"action-link",onClick:()=>e("/super-admin/hospitals"),children:"Hospitals"}),s.jsx("button",{className:"action-link",onClick:()=>e("/admin/create-admin"),children:"Role Overrides"}),s.jsx("button",{className:"action-link",onClick:()=>e("/admin/audit-logs"),children:"Audit Logs"}),s.jsx("button",{className:"action-link",onClick:()=>e("/admin/notifications"),children:"Alerts"})]})]})]})}const Cd={domain:"INTEROP",resource:"transfer_export",action:"read",effect:"ALLOW",roles:"DOCTOR,HOSPITAL_ADMIN,SYSTEM_ADMIN,SUPER_ADMIN,DEVELOPER",priority:100,active:!0,requireActiveConsent:!0,requireSameHospitalOrPrivileged:!0,requiredScopes:""},zy=e=>`${String(e.domain||"").toUpperCase()}::${String(e.resource||"").toLowerCase()}::${String(e.action||"").toLowerCase()}::${String(e.effect||"ALLOW").toUpperCase()}::${Number(e.priority||100)}`;function iL(){var ae,pe,fe,De;const[e,t]=m.useState([]),[n,r]=m.useState(Cd),[i,a]=m.useState(null),[o,l]=m.useState(!1),[c,u]=m.useState(""),[d,p]=m.useState(!1),[h,f]=m.useState({domain:"INTEROP",resource:"transfer_export",action:"read",role:"DOCTOR",sameHospital:!1,hasActiveConsent:!1,sourceHospitalBypass:!1,allowedScopes:""}),[y,j]=m.useState(null),[A,g]=m.useState(!1),[x,w]=m.useState([]),[E,_]=m.useState(!1),[b,R]=m.useState(null),C=async()=>{l(!0);try{const[F,Z]=await Promise.all([Fy(),XP()]);t(Array.isArray(F)?F:[]),w(Array.isArray(Z)?Z:[])}catch(F){u((F==null?void 0:F.message)||"Failed to load ABAC policies"),t([]),w([])}finally{l(!1)}};m.useEffect(()=>{C()},[]);const T=()=>({domain:n.domain,resource:n.resource,action:n.action,effect:n.effect,roles:String(n.roles||"").split(",").map(F=>F.trim().toUpperCase()).filter(Boolean),priority:Number(n.priority||100),active:!!n.active,conditions:{requireActiveConsent:!!n.requireActiveConsent,requireSameHospitalOrPrivileged:!!n.requireSameHospitalOrPrivileged,requiredScopes:String(n.requiredScopes||"").split(",").map(F=>F.trim().toLowerCase()).filter(Boolean)}}),D=async()=>{u("");try{const F=T();i?(await qy(i,F),u("ABAC policy updated")):(await Hy(F),u("ABAC policy created")),r(Cd),a(null),await C()}catch(F){u((F==null?void 0:F.message)||"Failed to save ABAC policy")}},U=F=>{var Z,Y,ye;a(F._id),r({domain:F.domain||"",resource:F.resource||"",action:F.action||"",effect:F.effect||"ALLOW",roles:Array.isArray(F.roles)?F.roles.join(","):"",priority:F.priority??100,active:F.active!==!1,requireActiveConsent:((Z=F.conditions)==null?void 0:Z.requireActiveConsent)===!0,requireSameHospitalOrPrivileged:((Y=F.conditions)==null?void 0:Y.requireSameHospitalOrPrivileged)===!0,requiredScopes:Array.isArray((ye=F.conditions)==null?void 0:ye.requiredScopes)?F.conditions.requiredScopes.join(","):""})},W=async F=>{try{await QP(F),u("ABAC policy deleted"),await C()}catch(Z){u((Z==null?void 0:Z.message)||"Failed to delete ABAC policy")}},q=()=>{const F=e.map(ge=>({domain:ge.domain,resource:ge.resource,action:ge.action,effect:ge.effect,roles:ge.roles||[],priority:ge.priority??100,active:ge.active!==!1,conditions:ge.conditions||{}})),Z=new Blob([JSON.stringify(F,null,2)],{type:"application/json"}),Y=URL.createObjectURL(Z),ye=document.createElement("a");ye.href=Y,ye.download="abac-policies.json",ye.click(),URL.revokeObjectURL(Y)},P=async F=>{var Z,Y,ye;if(F){p(!0),u("");try{const ge=await F.text(),Ke=JSON.parse(ge);if(!Array.isArray(Ke))throw new Error("JSON must be an array of policies");const Ae=await Fy(),Fe=new Map(Ae.map(se=>[zy(se),se]));let ne=0,me=0;for(const se of Ke){const be={domain:String(se.domain||"").toUpperCase(),resource:String(se.resource||"").toLowerCase(),action:String(se.action||"").toLowerCase(),effect:String(se.effect||"ALLOW").toUpperCase(),roles:Array.isArray(se.roles)?se.roles.map(mt=>String(mt||"").toUpperCase()).filter(Boolean):[],priority:Number(se.priority||100),active:se.active!==!1,conditions:{requireActiveConsent:((Z=se==null?void 0:se.conditions)==null?void 0:Z.requireActiveConsent)===!0,requireSameHospitalOrPrivileged:((Y=se==null?void 0:se.conditions)==null?void 0:Y.requireSameHospitalOrPrivileged)===!0,requiredScopes:Array.isArray((ye=se==null?void 0:se.conditions)==null?void 0:ye.requiredScopes)?se.conditions.requiredScopes.map(mt=>String(mt||"").toLowerCase()).filter(Boolean):[]}},Me=Fe.get(zy(be));Me!=null&&Me._id?(await qy(Me._id,be),me+=1):(await Hy(be),ne+=1)}u(`Import complete: ${ne} created, ${me} updated.`),await C()}catch(ge){u((ge==null?void 0:ge.message)||"Failed to import ABAC policies")}finally{p(!1)}}},V=async()=>{g(!0),j(null),u("");try{const F={domain:h.domain,resource:h.resource,action:h.action,role:h.role,sameHospital:h.sameHospital,hasActiveConsent:h.hasActiveConsent,sourceHospitalBypass:h.sourceHospitalBypass,allowedScopes:String(h.allowedScopes||"").split(",").map(Y=>Y.trim().toLowerCase()).filter(Boolean)},Z=await ZP(F);j(Z)}catch(F){u((F==null?void 0:F.message)||"Failed to run ABAC simulation")}finally{g(!1)}},K=async()=>{u("");try{const F={name:`${h.domain}/${h.resource}/${h.action}/${h.role}`,input:{domain:h.domain,resource:h.resource,action:h.action,role:h.role,sameHospital:h.sameHospital,hasActiveConsent:h.hasActiveConsent,sourceHospitalBypass:h.sourceHospitalBypass,allowedScopes:String(h.allowedScopes||"").split(",").map(Z=>Z.trim().toLowerCase()).filter(Boolean)},expected:y!=null&&y.decision?{allowed:y.decision.allowed,reason:y.decision.reason||""}:{allowed:null,reason:""},active:!0};await eL(F),u("Simulation saved as ABAC test case."),await C()}catch(F){u((F==null?void 0:F.message)||"Failed to save test case")}},ce=async F=>{var Z;try{const Y=await nL(F);u(`Test ${(Y==null?void 0:Y.name)||F}: ${Y!=null&&Y.passed?"PASSED":"FAILED"} (${((Z=Y==null?void 0:Y.decision)==null?void 0:Z.reason)||"n/a"})`),await C()}catch(Y){u((Y==null?void 0:Y.message)||"Failed to run test case")}},M=async()=>{var F,Z;_(!0),R(null),u("");try{const Y=await rL();R((Y==null?void 0:Y.totals)||null),u(`ABAC test run complete: ${((F=Y==null?void 0:Y.totals)==null?void 0:F.passed)||0} passed, ${((Z=Y==null?void 0:Y.totals)==null?void 0:Z.failed)||0} failed.`),await C()}catch(Y){u((Y==null?void 0:Y.message)||"Failed to run all test cases")}finally{_(!1)}},X=async F=>{try{await tL(F),u("Test case deleted."),await C()}catch(Z){u((Z==null?void 0:Z.message)||"Failed to delete test case")}};return s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"ABAC Policy Engine"}),s.jsx("p",{className:"muted",children:"Manage zero-trust attribute-based rules across domains."})]}),s.jsxs("div",{className:"welcome-actions",children:[s.jsx("button",{className:"btn-secondary",onClick:C,disabled:o,children:"Refresh"}),s.jsx("button",{className:"btn-secondary",onClick:q,disabled:o||d,children:"Export JSON"}),s.jsxs("label",{className:"btn-secondary",style:{cursor:"pointer"},children:[d?"Importing...":"Import JSON",s.jsx("input",{type:"file",accept:"application/json",style:{display:"none"},onChange:F=>{var Z;return P((Z=F.target.files)==null?void 0:Z[0])},disabled:d})]})]})]}),c&&s.jsx("div",{className:"card",children:c}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:i?"Edit Policy":"Create Policy"}),s.jsxs("div",{className:"card",children:[s.jsxs("div",{className:"grid info-grid",children:[s.jsxs("label",{children:["Domain",s.jsx("input",{value:n.domain,onChange:F=>r(Z=>({...Z,domain:F.target.value.toUpperCase()}))})]}),s.jsxs("label",{children:["Resource",s.jsx("input",{value:n.resource,onChange:F=>r(Z=>({...Z,resource:F.target.value}))})]}),s.jsxs("label",{children:["Action",s.jsx("input",{value:n.action,onChange:F=>r(Z=>({...Z,action:F.target.value}))})]}),s.jsxs("label",{children:["Effect",s.jsxs("select",{value:n.effect,onChange:F=>r(Z=>({...Z,effect:F.target.value})),children:[s.jsx("option",{value:"ALLOW",children:"ALLOW"}),s.jsx("option",{value:"DENY",children:"DENY"})]})]}),s.jsxs("label",{children:["Roles (comma)",s.jsx("input",{value:n.roles,onChange:F=>r(Z=>({...Z,roles:F.target.value}))})]}),s.jsxs("label",{children:["Priority",s.jsx("input",{type:"number",value:n.priority,onChange:F=>r(Z=>({...Z,priority:F.target.value}))})]}),s.jsxs("label",{children:["Required Scopes (comma)",s.jsx("input",{value:n.requiredScopes,onChange:F=>r(Z=>({...Z,requiredScopes:F.target.value}))})]}),s.jsxs("label",{children:[s.jsx("input",{type:"checkbox",checked:n.active,onChange:F=>r(Z=>({...Z,active:F.target.checked}))})," Active"]}),s.jsxs("label",{children:[s.jsx("input",{type:"checkbox",checked:n.requireActiveConsent,onChange:F=>r(Z=>({...Z,requireActiveConsent:F.target.checked}))})," Require Active Consent"]}),s.jsxs("label",{children:[s.jsx("input",{type:"checkbox",checked:n.requireSameHospitalOrPrivileged,onChange:F=>r(Z=>({...Z,requireSameHospitalOrPrivileged:F.target.checked}))})," Require Same Hospital Or Privileged"]})]}),s.jsxs("div",{className:"welcome-actions",style:{marginTop:10},children:[s.jsx("button",{className:"btn-primary",onClick:D,children:i?"Update Policy":"Create Policy"}),s.jsx("button",{className:"btn-secondary",onClick:()=>{r(Cd),a(null)},children:"Reset"})]})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Policy List"}),s.jsx("div",{className:"card",children:s.jsxs("table",{className:"table lite",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Domain"}),s.jsx("th",{children:"Resource"}),s.jsx("th",{children:"Action"}),s.jsx("th",{children:"Effect"}),s.jsx("th",{children:"Priority"}),s.jsx("th",{children:"Active"}),s.jsx("th",{children:"Actions"})]})}),s.jsxs("tbody",{children:[e.map(F=>s.jsxs("tr",{children:[s.jsx("td",{children:F.domain}),s.jsx("td",{children:F.resource}),s.jsx("td",{children:F.action}),s.jsx("td",{children:F.effect}),s.jsx("td",{children:F.priority}),s.jsx("td",{children:F.active?"Yes":"No"}),s.jsxs("td",{children:[s.jsx("button",{className:"btn-secondary",onClick:()=>U(F),children:"Edit"}),s.jsx("button",{className:"btn-danger",onClick:()=>W(F._id),children:"Delete"})]})]},F._id)),e.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:"7",children:"No ABAC policies defined"})})]})]})})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Policy Simulator"}),s.jsxs("div",{className:"card",children:[s.jsxs("div",{className:"grid info-grid",children:[s.jsxs("label",{children:["Domain",s.jsx("input",{value:h.domain,onChange:F=>f(Z=>({...Z,domain:F.target.value.toUpperCase()}))})]}),s.jsxs("label",{children:["Resource",s.jsx("input",{value:h.resource,onChange:F=>f(Z=>({...Z,resource:F.target.value}))})]}),s.jsxs("label",{children:["Action",s.jsx("input",{value:h.action,onChange:F=>f(Z=>({...Z,action:F.target.value}))})]}),s.jsxs("label",{children:["Role",s.jsx("input",{value:h.role,onChange:F=>f(Z=>({...Z,role:F.target.value.toUpperCase()}))})]}),s.jsxs("label",{children:["Allowed scopes (comma)",s.jsx("input",{value:h.allowedScopes,onChange:F=>f(Z=>({...Z,allowedScopes:F.target.value}))})]}),s.jsxs("label",{children:[s.jsx("input",{type:"checkbox",checked:h.sameHospital,onChange:F=>f(Z=>({...Z,sameHospital:F.target.checked}))})," Same hospital"]}),s.jsxs("label",{children:[s.jsx("input",{type:"checkbox",checked:h.hasActiveConsent,onChange:F=>f(Z=>({...Z,hasActiveConsent:F.target.checked}))})," Active consent"]}),s.jsxs("label",{children:[s.jsx("input",{type:"checkbox",checked:h.sourceHospitalBypass,onChange:F=>f(Z=>({...Z,sourceHospitalBypass:F.target.checked}))})," Source hospital bypass"]})]}),s.jsxs("div",{className:"welcome-actions",style:{marginTop:10},children:[s.jsx("button",{className:"btn-primary",onClick:V,disabled:A,children:A?"Simulating...":"Run Simulation"}),s.jsx("button",{className:"btn-secondary",onClick:K,disabled:!h.domain||!h.resource||!h.action||!h.role,children:"Save as Test Case"})]}),y&&s.jsxs("div",{className:"card",style:{marginTop:12},children:[s.jsxs("p",{children:["Decision:"," ",s.jsx("strong",{style:{color:(ae=y==null?void 0:y.decision)!=null&&ae.allowed?"#127a4b":"#b42318"},children:(pe=y==null?void 0:y.decision)!=null&&pe.allowed?"ALLOW":"DENY"})," ","(",((fe=y==null?void 0:y.decision)==null?void 0:fe.reason)||"n/a",")"]}),s.jsxs("p",{className:"muted",children:["Matched Policy: ",((De=y==null?void 0:y.matchedPolicy)==null?void 0:De._id)||"None"]}),s.jsxs("details",{children:[s.jsxs("summary",{children:["Trace (",Array.isArray(y==null?void 0:y.trace)?y.trace.length:0,")"]}),s.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:JSON.stringify(y.trace||[],null,2)})]})]})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"ABAC Regression Test Cases"}),s.jsxs("div",{className:"card",children:[s.jsxs("div",{className:"welcome-actions",style:{marginBottom:10},children:[s.jsx("button",{className:"btn-primary",onClick:M,disabled:E,children:E?"Running All...":"Run All Active Tests"}),b&&s.jsxs("span",{className:"muted",children:["Total: ",b.active||0," | Passed: ",b.passed||0," | Failed:"," ",b.failed||0]})]}),s.jsxs("table",{className:"table lite",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Name"}),s.jsx("th",{children:"Input"}),s.jsx("th",{children:"Expected"}),s.jsx("th",{children:"Last Run"}),s.jsx("th",{children:"Actions"})]})}),s.jsxs("tbody",{children:[x.map(F=>{var Z,Y,ye,ge,Ke,Ae,Fe;return s.jsxs("tr",{children:[s.jsx("td",{children:F.name}),s.jsxs("td",{children:[(Z=F.input)==null?void 0:Z.domain,"/",(Y=F.input)==null?void 0:Y.resource,"/",(ye=F.input)==null?void 0:ye.action,"/",(ge=F.input)==null?void 0:ge.role]}),s.jsx("td",{children:typeof((Ke=F.expected)==null?void 0:Ke.allowed)=="boolean"?`${F.expected.allowed?"ALLOW":"DENY"}${(Ae=F.expected)!=null&&Ae.reason?` (${F.expected.reason})`:""}`:"Any"}),s.jsx("td",{children:F.lastRunAt?`${new Date(F.lastRunAt).toLocaleString()} - ${(Fe=F.lastRun)!=null&&Fe.passed?"PASS":"FAIL"}`:"Not run"}),s.jsxs("td",{children:[s.jsx("button",{className:"btn-secondary",onClick:()=>ce(F._id),children:"Run"}),s.jsx("button",{className:"btn-danger",onClick:()=>X(F._id),children:"Delete"})]})]},F._id)}),x.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:"5",children:"No ABAC test cases yet."})})]})]})]})]})]})}const aL=async()=>le("/api/mapping"),oL=async e=>le("/api/mapping",{method:"POST",body:e}),lL=async(e,t)=>le(`/api/mapping/${e}`,{method:"PUT",body:t}),cL=async e=>le(`/api/mapping/${e}`,{method:"DELETE"}),uL=async()=>le("/api/mapping/catalog/templates"),dL=async e=>le("/api/mapping/preview",{method:"POST",body:e}),hL=async e=>le("/api/mapping/sign",{method:"POST",body:e}),fL=async e=>le("/api/mapping/verify",{method:"POST",body:e}),kd={messageType:"ORM^O01",sourceSystem:"LIS",targetSystem:"EMR",mappingJson:JSON.stringify({"PID-5":"patient.name","PID-7":"patient.dateOfBirth","OBR-4":"order.testCode"},null,2)};function pL(){const[e,t]=m.useState([]),[n,r]=m.useState([]),[i,a]=m.useState(kd),[o,l]=m.useState(null),[c,u]=m.useState("HL7"),[d,p]=m.useState(`MSH|^~\\&|LIS|HOSP|EMR|HOSP|20260220||ORM^O01|123|P|2.3
PID|1||P001||Jane Doe||1988-02-02
OBR|1|||CBC^Panel`),[h,f]=m.useState(""),[y,j]=m.useState(null),[A,g]=m.useState(""),[x,w]=m.useState(""),[E,_]=m.useState(null),[b,R]=m.useState(""),[C,T]=m.useState(!1),D=m.useMemo(()=>{try{return JSON.parse(i.mappingJson||"{}")}catch{return null}},[i.mappingJson]),U=async()=>{T(!0),R("");try{const[M,X]=await Promise.all([aL(),uL()]);t(Array.isArray(M)?M:[]),r(Array.isArray(X==null?void 0:X.templates)?X.templates:[])}catch(M){R((M==null?void 0:M.message)||"Failed to load mapping studio"),t([]),r([])}finally{T(!1)}};m.useEffect(()=>{U()},[]);const W=async()=>{if(R(""),!D){R("Mapping JSON is invalid.");return}try{const M={messageType:i.messageType,sourceSystem:i.sourceSystem,targetSystem:i.targetSystem,mapping:D};o?(await lL(o,M),R("Mapping updated.")):(await oL(M),R("Mapping created.")),a(kd),l(null),await U()}catch(M){R((M==null?void 0:M.message)||"Failed to save mapping")}},q=M=>{l(M._id),a({messageType:M.messageType||"",sourceSystem:M.sourceSystem||"",targetSystem:M.targetSystem||"",mappingJson:JSON.stringify(M.mapping||{},null,2)})},P=async M=>{R("");try{await cL(M),R("Mapping deleted."),await U()}catch(X){R((X==null?void 0:X.message)||"Failed to delete mapping")}},V=async()=>{var M;R(""),j(null);try{const X={format:c,payload:c==="FHIR"?JSON.parse(d||"{}"):d,...h?{mappingId:h}:{mapping:D||{}}},ae=await dL(X);j(ae||null),(M=ae==null?void 0:ae.provenance)!=null&&M.signature&&w(ae.provenance.signature)}catch(X){R((X==null?void 0:X.message)||"Preview failed")}},K=async()=>{var M;R("");try{const X=JSON.parse(A||"{}"),ae=await hL({payload:X,context:{module:"mapping_studio_ui"}});w(((M=ae==null?void 0:ae.signature)==null?void 0:M.signature)||""),R("Payload signed.")}catch(X){R((X==null?void 0:X.message)||"Sign failed")}},ce=async()=>{R(""),_(null);try{const M=JSON.parse(A||"{}"),X=await fL({payload:M,signature:x});_((X==null?void 0:X.verification)||null)}catch(M){R((M==null?void 0:M.message)||"Verify failed")}};return s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"FHIR/HL7 Transformation Studio"}),s.jsx("p",{className:"muted",children:"Create mappings, preview transformations, and verify signed provenance."})]}),s.jsx("div",{className:"welcome-actions",children:s.jsx("button",{className:"btn-secondary",onClick:U,disabled:C,children:"Refresh"})})]}),b&&s.jsx("div",{className:"card",children:b}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:o?"Edit Mapping":"Create Mapping"}),s.jsxs("div",{className:"card",children:[s.jsxs("div",{className:"grid info-grid",children:[s.jsxs("label",{children:["Message Type",s.jsx("input",{value:i.messageType,onChange:M=>a(X=>({...X,messageType:M.target.value}))})]}),s.jsxs("label",{children:["Source System",s.jsx("input",{value:i.sourceSystem,onChange:M=>a(X=>({...X,sourceSystem:M.target.value}))})]}),s.jsxs("label",{children:["Target System",s.jsx("input",{value:i.targetSystem,onChange:M=>a(X=>({...X,targetSystem:M.target.value}))})]})]}),s.jsxs("label",{children:["Mapping JSON",s.jsx("textarea",{rows:10,value:i.mappingJson,onChange:M=>a(X=>({...X,mappingJson:M.target.value}))})]}),s.jsxs("div",{className:"welcome-actions",style:{marginTop:10},children:[s.jsx("button",{className:"btn-primary",onClick:W,children:o?"Update Mapping":"Save Mapping"}),s.jsx("button",{className:"btn-secondary",onClick:()=>{a(kd),l(null)},children:"Reset"})]})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Preview + Provenance"}),s.jsxs("div",{className:"card",children:[s.jsxs("div",{className:"grid info-grid",children:[s.jsxs("label",{children:["Format",s.jsxs("select",{value:c,onChange:M=>u(M.target.value),children:[s.jsx("option",{value:"HL7",children:"HL7"}),s.jsx("option",{value:"FHIR",children:"FHIR"})]})]}),s.jsxs("label",{children:["Use saved mapping",s.jsxs("select",{value:h,onChange:M=>f(M.target.value),children:[s.jsx("option",{value:"",children:"Current editor mapping"}),e.map(M=>s.jsxs("option",{value:M._id,children:[M.messageType," / ",M.sourceSystem,"  ",M.targetSystem]},M._id))]})]})]}),s.jsxs("label",{children:["Source payload (",c,")",s.jsx("textarea",{rows:8,value:d,onChange:M=>p(M.target.value)})]}),s.jsx("div",{className:"welcome-actions",style:{marginTop:10},children:s.jsx("button",{className:"btn-primary",onClick:V,children:"Preview Transform"})}),y&&s.jsxs("details",{style:{marginTop:10},open:!0,children:[s.jsx("summary",{children:"Preview Result"}),s.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:JSON.stringify(y,null,2)})]})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Signature Tools"}),s.jsxs("div",{className:"card",children:[s.jsxs("label",{children:["Payload JSON",s.jsx("textarea",{rows:6,value:A,onChange:M=>g(M.target.value)})]}),s.jsxs("label",{children:["Signature",s.jsx("input",{value:x,onChange:M=>w(M.target.value)})]}),s.jsxs("div",{className:"welcome-actions",style:{marginTop:10},children:[s.jsx("button",{className:"btn-secondary",onClick:K,children:"Sign Payload"}),s.jsx("button",{className:"btn-secondary",onClick:ce,children:"Verify Signature"})]}),E&&s.jsxs("div",{className:"card",style:{marginTop:10},children:["Verification: ",s.jsx("strong",{children:E.valid?"VALID":"INVALID"})," (",E.reason,")"]})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Saved Mappings"}),s.jsx("div",{className:"card",children:s.jsxs("table",{className:"table lite",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Type"}),s.jsx("th",{children:"Source"}),s.jsx("th",{children:"Target"}),s.jsx("th",{children:"Actions"})]})}),s.jsxs("tbody",{children:[e.map(M=>s.jsxs("tr",{children:[s.jsx("td",{children:M.messageType}),s.jsx("td",{children:M.sourceSystem}),s.jsx("td",{children:M.targetSystem}),s.jsxs("td",{children:[s.jsx("button",{className:"btn-secondary",onClick:()=>q(M),children:"Edit"}),s.jsx("button",{className:"btn-danger",onClick:()=>P(M._id),children:"Delete"})]})]},M._id)),e.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:"4",children:"No mappings found."})})]})]})})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Template Catalog"}),s.jsxs("div",{className:"panel-grid",children:[n.map(M=>s.jsxs("div",{className:"card",children:[s.jsx("strong",{children:M.title}),s.jsx("p",{className:"muted",children:M.format}),s.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:JSON.stringify(M.mapping,null,2)})]},M.id)),n.length===0&&s.jsx("div",{className:"card muted",children:"No templates."})]})]})]})}const mL=async e=>le("/api/analytics/nlp/query",{method:"POST",body:{query:e}}),gL=async()=>le("/api/reports/regulatory/auto");function yL(){const[e,t]=m.useState("Show pending approvals this week"),[n,r]=m.useState(null),[i,a]=m.useState(""),[o,l]=m.useState(!1),c=async()=>{l(!0),a(""),r(null);try{const u=await mL(e);r(u||null)}catch(u){a((u==null?void 0:u.message)||"Failed to run NLP analytics query")}finally{l(!1)}};return s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"NLP Analytics"}),s.jsx("p",{className:"muted",children:"Ask analytics questions in natural language and get actionable metrics."})]}),s.jsx("div",{className:"welcome-actions",children:s.jsx("button",{className:"btn-primary",onClick:c,disabled:o,children:o?"Running...":"Run Query"})})]}),i&&s.jsx("div",{className:"card",children:i}),s.jsx("section",{className:"section",children:s.jsxs("div",{className:"card",children:[s.jsxs("label",{children:["Query",s.jsx("input",{value:e,onChange:u=>t(u.target.value),placeholder:"e.g. show revenue for last 30 days"})]}),s.jsxs("div",{className:"welcome-actions",style:{marginTop:10},children:[s.jsx("button",{className:"btn-secondary",onClick:()=>t("Show revenue this month"),children:"Revenue"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("Show active staff"),children:"Staff"}),s.jsx("button",{className:"btn-secondary",onClick:()=>t("Show pending approvals"),children:"Approvals"})]})]})}),n&&s.jsx("section",{className:"section",children:s.jsxs("div",{className:"card",children:[s.jsx("h3",{children:"Interpretation"}),s.jsx("p",{children:n.interpretation}),s.jsx("h3",{children:"Metrics"}),s.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:JSON.stringify(n.metrics,null,2)}),s.jsx("h3",{children:"Suggested Follow-ups"}),s.jsx("ul",{children:(n.suggestedFollowUps||[]).map((u,d)=>s.jsx("li",{children:u},`s-${d}`))})]})})]})}function vL(){var l,c,u,d,p;const[e,t]=m.useState(null),[n,r]=m.useState(""),[i,a]=m.useState(!1),o=async()=>{a(!0),r("");try{const h=await gL();t((h==null?void 0:h.report)||null)}catch(h){r((h==null?void 0:h.message)||"Failed to generate regulatory auto report"),t(null)}finally{a(!1)}};return s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"Regulatory Auto Report"}),s.jsx("p",{className:"muted",children:"Generated compliance snapshot for workforce, approvals, and security events."})]}),s.jsx("div",{className:"welcome-actions",children:s.jsx("button",{className:"btn-primary",onClick:o,disabled:i,children:i?"Generating...":"Generate Report"})})]}),n&&s.jsx("div",{className:"card",children:n}),e&&s.jsxs(s.Fragment,{children:[s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Summary"}),s.jsxs("div",{className:"grid info-grid",children:[s.jsx(te,{title:"Staff Total",value:((l=e==null?void 0:e.workforce)==null?void 0:l.staffTotal)??""}),s.jsx(te,{title:"Inactive Staff",value:((c=e==null?void 0:e.workforce)==null?void 0:c.inactiveStaff)??""}),s.jsx(te,{title:"Pending Approvals",value:((u=e==null?void 0:e.approvals)==null?void 0:u.total)??""}),s.jsx(te,{title:"Export Events (30d)",value:((d=e==null?void 0:e.compliance)==null?void 0:d.exportEvents)??""}),s.jsx(te,{title:"ABAC Denials (30d)",value:((p=e==null?void 0:e.compliance)==null?void 0:p.abacDeniedEvents)??""})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Flags"}),s.jsxs("div",{className:"panel-grid",children:[(e.flags||[]).map(h=>s.jsx("div",{className:"card",children:h},h)),(e.flags||[]).length===0&&s.jsx("div",{className:"card muted",children:"No critical flags."})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Raw Report"}),s.jsx("div",{className:"card",children:s.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:JSON.stringify(e,null,2)})})]})]})]})}function xL(){const[e,t]=m.useState(""),[n,r]=m.useState(""),[i,a]=m.useState({beds:220,occupancyRate:.78,avgPatientsPerDoctor:14,avgPatientsPerNurse:5,horizonDays:14}),[o,l]=m.useState(null),[c,u]=m.useState({hoursPerWeek:52,nightShifts:6,consecutiveDays:7,overtimeHours:12,leaveBalanceDays:8,incidentsIn30d:1}),[d,p]=m.useState(null),[h,f]=m.useState({baseline:100,interventionsJson:JSON.stringify([{name:"Add ICU nurses",effectPct:8,confidence:.7},{name:"Shift rebalancing",effectPct:5,confidence:.8}],null,2)}),[y,j]=m.useState(null),[A,g]=m.useState({departmentsJson:JSON.stringify([{name:"ICU",staff:18,demand:24,absenteeismRate:.08},{name:"Emergency",staff:26,demand:30,absenteeismRate:.05},{name:"Pediatrics",staff:15,demand:12,absenteeismRate:.03}],null,2)}),[x,w]=m.useState(null),E=async()=>{r("forecast"),t("");try{const C=await qp(i);l(C||null)}catch(C){t((C==null?void 0:C.message)||"Failed to run staffing forecast")}finally{r("")}},_=async()=>{r("burnout"),t("");try{const C=await zp(c);p(C||null)}catch(C){t((C==null?void 0:C.message)||"Failed to run burnout scoring")}finally{r("")}},b=async()=>{r("causal"),t("");try{const C=JSON.parse(h.interventionsJson||"[]"),T=await z0({baseline:Number(h.baseline||0),interventions:C});j(T||null)}catch(C){t((C==null?void 0:C.message)||"Failed to run causal impact")}finally{r("")}},R=async()=>{r("twin"),t("");try{const C=JSON.parse(A.departmentsJson||"[]"),T=await W0({departments:C});w(T||null)}catch(C){t((C==null?void 0:C.message)||"Failed to run digital twin simulation")}finally{r("")}};return s.jsxs("div",{className:"dashboard",children:[s.jsx("div",{className:"welcome-panel",children:s.jsxs("div",{children:[s.jsx("h2",{children:"Clinical Intelligence Lab"}),s.jsx("p",{className:"muted",children:"AI staffing planner, burnout risk scoring, causal impact simulation, and hospital digital twin."})]})}),e&&s.jsx("div",{className:"card",children:e}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Staffing Forecast"}),s.jsxs("div",{className:"card",children:[s.jsxs("div",{className:"grid info-grid",children:[s.jsxs("label",{children:["Beds",s.jsx("input",{type:"number",value:i.beds,onChange:C=>a(T=>({...T,beds:Number(C.target.value||0)}))})]}),s.jsxs("label",{children:["Occupancy Rate",s.jsx("input",{type:"number",step:"0.01",value:i.occupancyRate,onChange:C=>a(T=>({...T,occupancyRate:Number(C.target.value||0)}))})]}),s.jsxs("label",{children:["Patients/Doctor",s.jsx("input",{type:"number",value:i.avgPatientsPerDoctor,onChange:C=>a(T=>({...T,avgPatientsPerDoctor:Number(C.target.value||1)}))})]}),s.jsxs("label",{children:["Patients/Nurse",s.jsx("input",{type:"number",value:i.avgPatientsPerNurse,onChange:C=>a(T=>({...T,avgPatientsPerNurse:Number(C.target.value||1)}))})]}),s.jsxs("label",{children:["Horizon Days",s.jsx("input",{type:"number",value:i.horizonDays,onChange:C=>a(T=>({...T,horizonDays:Number(C.target.value||1)}))})]})]}),s.jsx("div",{className:"welcome-actions",style:{marginTop:10},children:s.jsx("button",{className:"btn-primary",onClick:E,disabled:n==="forecast",children:n==="forecast"?"Running...":"Run Staffing Forecast"})}),o&&s.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:JSON.stringify(o,null,2)})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Burnout Risk Scoring"}),s.jsxs("div",{className:"card",children:[s.jsxs("div",{className:"grid info-grid",children:[s.jsxs("label",{children:["Hours/Week",s.jsx("input",{type:"number",value:c.hoursPerWeek,onChange:C=>u(T=>({...T,hoursPerWeek:Number(C.target.value||0)}))})]}),s.jsxs("label",{children:["Night Shifts",s.jsx("input",{type:"number",value:c.nightShifts,onChange:C=>u(T=>({...T,nightShifts:Number(C.target.value||0)}))})]}),s.jsxs("label",{children:["Consecutive Days",s.jsx("input",{type:"number",value:c.consecutiveDays,onChange:C=>u(T=>({...T,consecutiveDays:Number(C.target.value||0)}))})]}),s.jsxs("label",{children:["Overtime Hours",s.jsx("input",{type:"number",value:c.overtimeHours,onChange:C=>u(T=>({...T,overtimeHours:Number(C.target.value||0)}))})]}),s.jsxs("label",{children:["Leave Balance",s.jsx("input",{type:"number",value:c.leaveBalanceDays,onChange:C=>u(T=>({...T,leaveBalanceDays:Number(C.target.value||0)}))})]}),s.jsxs("label",{children:["Incidents 30d",s.jsx("input",{type:"number",value:c.incidentsIn30d,onChange:C=>u(T=>({...T,incidentsIn30d:Number(C.target.value||0)}))})]})]}),s.jsx("div",{className:"welcome-actions",style:{marginTop:10},children:s.jsx("button",{className:"btn-primary",onClick:_,disabled:n==="burnout",children:n==="burnout"?"Running...":"Run Burnout Scoring"})}),d&&s.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:JSON.stringify(d,null,2)})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Causal Impact Simulation"}),s.jsxs("div",{className:"card",children:[s.jsxs("label",{children:["Baseline Metric",s.jsx("input",{type:"number",value:h.baseline,onChange:C=>f(T=>({...T,baseline:Number(C.target.value||0)}))})]}),s.jsxs("label",{children:["Interventions JSON",s.jsx("textarea",{rows:7,value:h.interventionsJson,onChange:C=>f(T=>({...T,interventionsJson:C.target.value}))})]}),s.jsx("div",{className:"welcome-actions",style:{marginTop:10},children:s.jsx("button",{className:"btn-primary",onClick:b,disabled:n==="causal",children:n==="causal"?"Running...":"Run Causal Simulation"})}),y&&s.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:JSON.stringify(y,null,2)})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Digital Twin Simulation"}),s.jsxs("div",{className:"card",children:[s.jsxs("label",{children:["Departments JSON",s.jsx("textarea",{rows:8,value:A.departmentsJson,onChange:C=>g(T=>({...T,departmentsJson:C.target.value}))})]}),s.jsx("div",{className:"welcome-actions",style:{marginTop:10},children:s.jsx("button",{className:"btn-primary",onClick:R,disabled:n==="twin",children:n==="twin"?"Running...":"Run Digital Twin"})}),x&&s.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:JSON.stringify(x,null,2)})]})]})]})}const Za="my_requests_query_cache_v1",jL=15*60*1e3;function bL(){const{user:e}=Te(),t=Re(),n=hn(),[r,i]=m.useState(!1),[a,o]=m.useState(null),[l,c]=m.useState([]),[u,d]=m.useState([]),[p,h]=m.useState([]),[f,y]=m.useState(null),[j,A]=m.useState(null),[g,x]=m.useState(null),[w,E]=m.useState(!1),[_,b]=m.useState(!1),[R,C]=m.useState(!1),[T,D]=m.useState("ALL"),[U,W]=m.useState(!1),[q,P]=m.useState("Live  now"),V=m.useRef(!1),[K,ce]=m.useState({type:"Annual",startDate:"",endDate:"",reason:""}),[M,X]=m.useState({hours:"",date:"",reason:""}),[ae,pe]=m.useState({shiftType:"Day",date:"",reason:""}),fe=`${(e==null?void 0:e.role)||"UNKNOWN"}:${(e==null?void 0:e._id)||(e==null?void 0:e.id)||(e==null?void 0:e.email)||"anon"}`,De=ne=>Array.isArray(ne)?{items:ne,nextCursor:null,hasMore:!1}:{items:Array.isArray(ne==null?void 0:ne.items)?ne.items:[],nextCursor:(ne==null?void 0:ne.nextCursor)||null,hasMore:!!(ne!=null&&ne.hasMore)},F=async(ne="ALL",{append:me=!1}={})=>{var se,be;i(!0),o(null);try{const Me=ne!=="ALL"?ne:void 0,mt=!me||w&&!!f,Pt=!me||_&&!!j,we=!me||R&&!!g,[Ie,st,ve]=await Promise.all([mt?hP(Me,{limit:25,cursorMode:!0,cursor:me?f:void 0}):Promise.resolve(null),Pt?gP(Me,{limit:25,cursorMode:!0,cursor:me?j:void 0}):Promise.resolve(null),we?jP(Me,{limit:25,cursorMode:!0,cursor:me?g:void 0}):Promise.resolve(null)]),Ue=mt?De(Ie.data):{items:[],nextCursor:null,hasMore:!1},Se=Pt?De(st.data):{items:[],nextCursor:null,hasMore:!1},it=we?De(ve.data):{items:[],nextCursor:null,hasMore:!1};me?(mt?(c(xe=>[...xe,...Ue.items]),y(Ue.nextCursor),E(Ue.hasMore)):E(!1),Pt?(d(xe=>[...xe,...Se.items]),A(Se.nextCursor),b(Se.hasMore)):b(!1),we?(h(xe=>[...xe,...it.items]),x(it.nextCursor),C(it.hasMore)):C(!1)):(c(Ue.items),d(Se.items),h(it.items),y(Ue.nextCursor),A(Se.nextCursor),x(it.nextCursor),E(Ue.hasMore),b(Se.hasMore),C(it.hasMore),P("Live  now"))}catch(Me){o(((be=(se=Me.response)==null?void 0:se.data)==null?void 0:be.message)||"Failed to load requests")}finally{i(!1)}};m.useEffect(()=>{try{const ne=localStorage.getItem(Za);if(!ne){P("Live  now"),W(!0);return}const me=JSON.parse(ne),se=me==null?void 0:me[fe];if(!se||typeof se!="object"){P("Live  now"),W(!0);return}const be=Date.now()-new Date(se.updatedAt||0).getTime();if(!Number.isFinite(be)||be<0||be>jL){P("Live  now"),W(!0);return}const Me=Math.max(0,Math.floor(be/6e4));se.statusFilter&&D(se.statusFilter),Array.isArray(se.leave)&&c(se.leave),Array.isArray(se.overtime)&&d(se.overtime),Array.isArray(se.shifts)&&h(se.shifts),(typeof se.leaveCursor=="string"||se.leaveCursor===null)&&y(se.leaveCursor),(typeof se.overtimeCursor=="string"||se.overtimeCursor===null)&&A(se.overtimeCursor),(typeof se.shiftCursor=="string"||se.shiftCursor===null)&&x(se.shiftCursor),typeof se.hasMoreLeave=="boolean"&&E(se.hasMoreLeave),typeof se.hasMoreOvertime=="boolean"&&b(se.hasMoreOvertime),typeof se.hasMoreShift=="boolean"&&C(se.hasMoreShift),P(`Cached  ${Me}m ago`),V.current=!0}catch{}finally{W(!0)}},[fe]),m.useEffect(()=>{if(U){if(V.current){V.current=!1;return}F(T,{append:!1})}},[U,T]),m.useEffect(()=>{const ne=new URLSearchParams(n.search),me=String(ne.get("status")||"").toUpperCase();["PENDING","APPROVED","REJECTED"].includes(me)&&D(me);const se=window.location.hash;if(!se)return;const be=document.getElementById(se.replace("#",""));be&&setTimeout(()=>be.scrollIntoView({behavior:"smooth"}),150)},[n.search]),m.useEffect(()=>{if(U)try{const ne=localStorage.getItem(Za),me=ne?JSON.parse(ne):{};me[fe]={statusFilter:T,leave:l,overtime:u,shifts:p,leaveCursor:f,overtimeCursor:j,shiftCursor:g,hasMoreLeave:w,hasMoreOvertime:_,hasMoreShift:R,updatedAt:new Date().toISOString()},localStorage.setItem(Za,JSON.stringify(me))}catch{}},[U,fe,T,l,u,p,f,j,g,w,_,R]);const Z=m.useMemo(()=>[...l.map(me=>({...me,kind:"Leave"})),...u.map(me=>({...me,kind:"Overtime"})),...p.map(me=>({...me,kind:"Shift"}))].sort((me,se)=>new Date(se.createdAt)-new Date(me.createdAt)),[l,u,p]),Y=async ne=>{var me,se;ne.preventDefault(),i(!0),o(null);try{await fP({type:K.type,startDate:K.startDate,endDate:K.endDate,reason:K.reason}),ce({type:"Annual",startDate:"",endDate:"",reason:""}),await F(T,{append:!1}),o(" Leave request submitted")}catch(be){o(((se=(me=be.response)==null?void 0:me.data)==null?void 0:se.message)||"Failed to submit leave request")}finally{i(!1)}},ye=async ne=>{var me,se;ne.preventDefault(),i(!0),o(null);try{await yP({hours:Number(M.hours),date:M.date,reason:M.reason}),X({hours:"",date:"",reason:""}),await F(T,{append:!1}),o(" Overtime request submitted")}catch(be){o(((se=(me=be.response)==null?void 0:me.data)==null?void 0:se.message)||"Failed to submit overtime request")}finally{i(!1)}},ge=async ne=>{var me,se;ne.preventDefault(),i(!0),o(null);try{await bP({shiftType:ae.shiftType,date:ae.date,reason:ae.reason}),pe({shiftType:"Day",date:"",reason:""}),await F(T,{append:!1}),o(" Shift request submitted")}catch(be){o(((se=(me=be.response)==null?void 0:me.data)==null?void 0:se.message)||"Failed to submit shift request")}finally{i(!1)}},Ke=Z.filter(ne=>T==="ALL"?!0:ne.status===T),Ae=()=>{const me=[["Type","Category","Status","Requested","Details"],...Ke.map(Me=>[Me.kind,Me.type||Me.shiftType||`${Me.hours} hrs`,Me.status,Me.createdAt?new Date(Me.createdAt).toLocaleDateString():"-",Me.reason||""])].map(Me=>Me.map(mt=>`"${String(mt).replace(/"/g,'""')}"`).join(",")).join(`
`),se=new Blob([me],{type:"text/csv"}),be=document.createElement("a");be.href=URL.createObjectURL(se),be.download="my-requests.csv",be.click()},Fe=async()=>{try{const ne=localStorage.getItem(Za),me=ne?JSON.parse(ne):{};delete me[fe],localStorage.setItem(Za,JSON.stringify(me))}catch{}D("ALL"),c([]),d([]),h([]),y(null),A(null),x(null),E(!1),b(!1),C(!1),await F("ALL",{append:!1}),P("Live  now"),o("View reset and reloaded from server")};return s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"My Requests"}),s.jsx("p",{className:"muted",children:"Submit leave, overtime, or shift requests and track approvals."})]}),s.jsxs("div",{className:"welcome-actions",children:[s.jsx("button",{className:"btn-secondary",onClick:()=>F(T,{append:!1}),disabled:r,children:"Refresh"}),s.jsx("button",{className:"btn-secondary",onClick:Fe,disabled:r,children:"Reset View"}),s.jsx("span",{className:"muted",children:q}),((e==null?void 0:e.role)==="HOSPITAL_ADMIN"||(e==null?void 0:e.role)==="SUPER_ADMIN")&&s.jsx("button",{className:"btn-primary",onClick:()=>t("/hospital-admin/approvals"),children:"View Approvals"})]})]}),a&&s.jsx("div",{className:"card",children:a}),s.jsxs("section",{className:"section",id:"leave",children:[s.jsx("h3",{children:"Leave Request"}),s.jsxs("form",{className:"card form",onSubmit:Y,children:[s.jsxs("select",{value:K.type,onChange:ne=>ce({...K,type:ne.target.value}),children:[s.jsx("option",{value:"Annual",children:"Annual"}),s.jsx("option",{value:"Sick",children:"Sick"}),s.jsx("option",{value:"Study",children:"Study"}),s.jsx("option",{value:"Maternity",children:"Maternity"}),s.jsx("option",{value:"Paternity",children:"Paternity"}),s.jsx("option",{value:"Compassionate",children:"Compassionate"})]}),s.jsx("input",{type:"date",value:K.startDate,onChange:ne=>ce({...K,startDate:ne.target.value}),required:!0}),s.jsx("input",{type:"date",value:K.endDate,onChange:ne=>ce({...K,endDate:ne.target.value}),required:!0}),s.jsx("input",{placeholder:"Reason (optional)",value:K.reason,onChange:ne=>ce({...K,reason:ne.target.value})}),s.jsx("button",{disabled:r,children:r?"Submitting...":"Submit Leave"})]})]}),s.jsxs("section",{className:"section",id:"overtime",children:[s.jsx("h3",{children:"Overtime Request"}),s.jsxs("form",{className:"card form",onSubmit:ye,children:[s.jsx("input",{type:"number",min:"1",placeholder:"Hours",value:M.hours,onChange:ne=>X({...M,hours:ne.target.value}),required:!0}),s.jsx("input",{type:"date",value:M.date,onChange:ne=>X({...M,date:ne.target.value}),required:!0}),s.jsx("input",{placeholder:"Reason (optional)",value:M.reason,onChange:ne=>X({...M,reason:ne.target.value})}),s.jsx("button",{disabled:r,children:r?"Submitting...":"Submit Overtime"})]})]}),s.jsxs("section",{className:"section",id:"shift",children:[s.jsx("h3",{children:"Shift Request"}),s.jsxs("form",{className:"card form",onSubmit:ge,children:[s.jsxs("select",{value:ae.shiftType,onChange:ne=>pe({...ae,shiftType:ne.target.value}),children:[s.jsx("option",{value:"Day",children:"Day Shift"}),s.jsx("option",{value:"Night",children:"Night Shift"}),s.jsx("option",{value:"On-Call",children:"On-Call"}),s.jsx("option",{value:"Weekend",children:"Weekend"})]}),s.jsx("input",{type:"date",value:ae.date,onChange:ne=>pe({...ae,date:ne.target.value}),required:!0}),s.jsx("input",{placeholder:"Reason (optional)",value:ae.reason,onChange:ne=>pe({...ae,reason:ne.target.value})}),s.jsx("button",{disabled:r,children:r?"Submitting...":"Submit Shift"})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"My Recent Requests"}),s.jsxs("div",{className:"card",children:[s.jsxs("div",{className:"action-list",style:{marginBottom:12},children:[s.jsxs("select",{value:T,onChange:ne=>D(ne.target.value),children:[s.jsx("option",{value:"ALL",children:"All Statuses"}),s.jsx("option",{value:"PENDING",children:"Pending"}),s.jsx("option",{value:"APPROVED",children:"Approved"}),s.jsx("option",{value:"REJECTED",children:"Rejected"})]}),s.jsx("button",{className:"btn-secondary",onClick:Ae,children:"Export CSV"})]}),s.jsxs("table",{className:"table lite",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Type"}),s.jsx("th",{children:"Category"}),s.jsx("th",{children:"Status"}),s.jsx("th",{children:"Requested"}),s.jsx("th",{children:"Details"})]})}),s.jsxs("tbody",{children:[Ke.map(ne=>s.jsxs("tr",{children:[s.jsx("td",{children:ne.kind}),s.jsx("td",{children:ne.type||ne.shiftType||`${ne.hours} hrs`}),s.jsx("td",{children:ne.status}),s.jsx("td",{children:ne.createdAt?new Date(ne.createdAt).toLocaleDateString():"-"}),s.jsx("td",{children:ne.reason||"-"})]},ne._id)),Ke.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:"5",children:"No requests yet"})})]})]}),(w||_||R)&&s.jsx("div",{style:{marginTop:12},children:s.jsx("button",{className:"btn-secondary",disabled:r,onClick:()=>F(T,{append:!0}),children:r?"Loading...":"Load more"})})]})]})]})}const Q0=async()=>(await ue.get("/api/integrations/dlq-inspect")).data,uf=async e=>(await ue.post(`/api/integrations/dlq/${e}/retry`)).data,wL=async(e,t)=>(await ue.put(`/api/integrations/dlq-inspect/${e}`,{data:t})).data;function SL(){const[e,t]=m.useState([]),[n,r]=m.useState(!1),[i,a]=m.useState(null),[o,l]=m.useState(null),[c,u]=m.useState(""),d=async()=>{r(!0),a(null);try{const f=await Q0();t(Array.isArray(f)?f:[])}catch{t([]),a("Failed to load DLQ items")}finally{r(!1)}};m.useEffect(()=>{d()},[]);const p=f=>{l(f),u(JSON.stringify(f.data||{},null,2))},h=async(f=!1)=>{if(o)try{const y=JSON.parse(c);await wL(o.id,y),f&&await uf(o.id),a(" Payload updated"),l(null),d()}catch{a("Invalid JSON payload")}};return s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"Queue Replay"}),s.jsx("p",{className:"muted",children:"Inspect deadletter queue entries and replay them into the integration queue."})]}),s.jsx("div",{className:"welcome-actions",children:s.jsx("button",{className:"btn-secondary",onClick:d,disabled:n,children:"Refresh"})})]}),i&&s.jsx("div",{className:"card",children:i}),s.jsx("section",{className:"section",children:s.jsx("div",{className:"card",children:s.jsxs("table",{className:"table lite",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"ID"}),s.jsx("th",{children:"Reason"}),s.jsx("th",{children:"Attempts"}),s.jsx("th",{children:"Queued"}),s.jsx("th",{children:"Actions"})]})}),s.jsxs("tbody",{children:[e.map(f=>s.jsxs("tr",{children:[s.jsx("td",{children:f.id}),s.jsx("td",{children:f.failedReason||"-"}),s.jsx("td",{children:f.attemptsMade||0}),s.jsx("td",{children:f.timestamp?new Date(f.timestamp).toLocaleString():"-"}),s.jsxs("td",{children:[s.jsx("button",{className:"btn-secondary",onClick:async()=>{await uf(f.id),d()},children:"Replay"}),s.jsx("button",{className:"btn-secondary",onClick:()=>p(f),children:"Edit"})]})]},f.id)),e.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:"5",children:"No DLQ items"})})]})]})})}),o&&s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Edit Payload"}),s.jsxs("div",{className:"card",children:[s.jsx("textarea",{rows:12,style:{width:"100%"},value:c,onChange:f=>u(f.target.value)}),s.jsxs("div",{className:"action-list",style:{marginTop:12},children:[s.jsx("button",{className:"btn-secondary",onClick:()=>h(!1),children:"Save"}),s.jsx("button",{className:"btn-primary",onClick:()=>h(!0),children:"Save & Replay"}),s.jsx("button",{className:"btn-secondary",onClick:()=>l(null),children:"Cancel"})]})]})]})]})}function EL(){const[e,t]=m.useState([]),[n,r]=m.useState(!1),[i,a]=m.useState(null),o=async()=>{r(!0),a(null);try{const l=await Q0(),c=(Array.isArray(l)?l:[]).filter(u=>{var d,p;return((d=u==null?void 0:u.data)==null?void 0:d.connectorId)||((p=u==null?void 0:u.data)==null?void 0:p.payload)});t(c)}catch{t([]),a("Failed to load webhook retries")}finally{r(!1)}};return m.useEffect(()=>{o()},[]),s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"Webhook Retry"}),s.jsx("p",{className:"muted",children:"Retry failed webhook payloads from the integration DLQ."})]}),s.jsx("div",{className:"welcome-actions",children:s.jsx("button",{className:"btn-secondary",onClick:o,disabled:n,children:"Refresh"})})]}),i&&s.jsx("div",{className:"card",children:i}),s.jsx("section",{className:"section",children:s.jsx("div",{className:"card",children:s.jsxs("table",{className:"table lite",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"ID"}),s.jsx("th",{children:"Connector"}),s.jsx("th",{children:"Reason"}),s.jsx("th",{children:"Attempts"}),s.jsx("th",{children:"Actions"})]})}),s.jsxs("tbody",{children:[e.map(l=>{var c;return s.jsxs("tr",{children:[s.jsx("td",{children:l.id}),s.jsx("td",{children:((c=l==null?void 0:l.data)==null?void 0:c.connectorId)||"-"}),s.jsx("td",{children:l.failedReason||"-"}),s.jsx("td",{children:l.attemptsMade||0}),s.jsx("td",{children:s.jsx("button",{className:"btn-secondary",onClick:async()=>{await uf(l.id),o()},children:"Retry Webhook"})})]},l.id)}),e.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:"5",children:"No webhook retries queued"})})]})]})})})]})}function NL(){var a,o,l,c;const[e,t]=m.useState(null),[n,r]=m.useState(""),i=async()=>{r("");try{const u=await F_();t(u||null)}catch(u){r((u==null?void 0:u.message)||"Failed to load decision cockpit"),t(null)}};return m.useEffect(()=>{i()},[]),s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"Decision Cockpit"}),s.jsx("p",{className:"muted",children:"Operational anomalies, trust signals and next best actions."})]}),s.jsx("div",{className:"welcome-actions",children:s.jsx("button",{className:"btn-secondary",onClick:i,children:"Refresh"})})]}),n&&s.jsx("div",{className:"card",children:n}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Key Totals"}),s.jsxs("div",{className:"grid info-grid",children:[s.jsx(te,{title:"DLQ Failed",value:((a=e==null?void 0:e.totals)==null?void 0:a.dlqFailed)??""}),s.jsx(te,{title:"Workforce Pending",value:((o=e==null?void 0:e.totals)==null?void 0:o.workforcePending)??""}),s.jsx(te,{title:"ABAC Denials (24h)",value:((l=e==null?void 0:e.totals)==null?void 0:l.abacDenials24h)??""})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Anomalies"}),s.jsxs("div",{className:"panel-grid",children:[((e==null?void 0:e.anomalies)||[]).map(u=>s.jsxs("div",{className:"card",children:[s.jsx("strong",{children:u.title}),s.jsxs("p",{className:"muted",children:["Severity: ",u.severity," | Metric: ",u.metric]}),s.jsx("p",{children:u.why}),s.jsxs("p",{children:[s.jsx("strong",{children:"Action:"})," ",u.action]})]},u.id)),!((c=e==null?void 0:e.anomalies)!=null&&c.length)&&s.jsx("div",{className:"card muted",children:"No anomalies detected."})]})]}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Recommendations"}),s.jsx("div",{className:"panel-grid",children:((e==null?void 0:e.recommendations)||[]).map((u,d)=>{var p,h;return s.jsxs("div",{className:"card",children:[s.jsx("strong",{children:((h=(p=u.type)==null?void 0:p.toUpperCase)==null?void 0:h.call(p))||"RECOMMENDATION"}),s.jsx("p",{children:u.text})]},`rec-${d}`)})})]})]})}const _L=async(e={})=>{const t=new URLSearchParams;e.status&&t.set("status",e.status),e.limit&&t.set("limit",String(e.limit)),e.page&&t.set("page",String(e.page)),e.cursor&&t.set("cursor",e.cursor);const n=t.toString();return(await ue.get(`/api/transfers${n?`?${n}`:""}`)).data},AL=async({transferId:e,payload:t,signature:n})=>(await ue.post(`/api/transfers/${e}/provenance/verify`,{payload:t,signature:n})).data;function CL(){const[e,t]=m.useState([]),[n,r]=m.useState(""),[i,a]=m.useState("{}"),[o,l]=m.useState(""),[c,u]=m.useState(!1),[d,p]=m.useState(""),[h,f]=m.useState(null),y=async()=>{var A;try{const g=await _L({limit:50}),x=Array.isArray(g==null?void 0:g.items)?g.items:[];t(x),!n&&((A=x[0])!=null&&A._id)&&r(x[0]._id)}catch{t([])}};m.useEffect(()=>{y()},[]);const j=async()=>{u(!0),p(""),f(null);try{const A=JSON.parse(i||"{}"),g=await AL({transferId:n,payload:A,signature:o});f(g)}catch(A){p((A==null?void 0:A.message)||"Failed to verify provenance")}finally{u(!1)}};return s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"Transfer Provenance Verify"}),s.jsx("p",{className:"muted",children:"Verify signed transfer payload integrity for receiving hospitals."})]}),s.jsx("div",{className:"welcome-actions",children:s.jsx("button",{className:"btn-secondary",onClick:y,children:"Refresh Transfers"})})]}),d&&s.jsx("div",{className:"card",children:d}),s.jsx("section",{className:"section",children:s.jsxs("div",{className:"card",children:[s.jsx("label",{children:"Transfer"}),s.jsx("select",{value:n,onChange:A=>r(A.target.value),children:e.map(A=>s.jsxs("option",{value:A._id,children:[A._id,"  ",A.status]},A._id))}),s.jsx("label",{style:{marginTop:12},children:"Payload (JSON)"}),s.jsx("textarea",{rows:8,value:i,onChange:A=>a(A.target.value)}),s.jsx("label",{style:{marginTop:12},children:"Signature"}),s.jsx("input",{type:"text",value:o,onChange:A=>l(A.target.value),placeholder:"X-AfyaLink-Provenance signature"}),s.jsx("div",{className:"welcome-actions",children:s.jsx("button",{className:"btn-primary",onClick:j,disabled:c||!n||!o,children:c?"Verifying...":"Verify Signature"})})]})}),s.jsxs("section",{className:"section",children:[s.jsx("h3",{children:"Verification Result"}),s.jsx("div",{className:"card",children:h?s.jsx("pre",{style:{whiteSpace:"pre-wrap",margin:0},children:JSON.stringify(h,null,2)}):s.jsx("p",{className:"muted",children:"No verification result yet."})})]})]})}const kL=async(e={})=>{const t=new URLSearchParams;e.action&&t.set("action",e.action),e.limit&&t.set("limit",String(e.limit)),e.hospital&&t.set("hospital",String(e.hospital));const n=t.toString();return(await ue.get(`/api/ai_admin/list${n?`?${n}`:""}`)).data},IL=["AI_DOCUMENT_EXTRACTED","AI_DOCUMENT_EXTRACTION_FAILED","AI_DIGITAL_TWIN_RUN"];function RL(){const[e,t]=m.useState([]),[n,r]=m.useState(!1),[i,a]=m.useState(""),[o,l]=m.useState({action:"AI_DOCUMENT_EXTRACTED",hospital:"",limit:100}),[c,u]=m.useState(""),d=async(h=o)=>{r(!0),a("");try{const f=await kL(h);t(Array.isArray(f==null?void 0:f.items)?f.items:[])}catch(f){a((f==null?void 0:f.message)||"Failed to load extraction history"),t([])}finally{r(!1)}};m.useEffect(()=>{d()},[]);const p=e.filter(h=>{var x,w,E,_,b;const f=String(c||"").trim().toLowerCase();if(!f)return!0;const y=`${((x=h.actor)==null?void 0:x.name)||""} ${((w=h.actor)==null?void 0:w.email)||""}`.toLowerCase(),j=String(((E=h.metadata)==null?void 0:E.filename)||"").toLowerCase(),A=String(((_=h.metadata)==null?void 0:_.mimeType)||"").toLowerCase(),g=String(((b=h.metadata)==null?void 0:b.provider)||"").toLowerCase();return y.includes(f)||j.includes(f)||A.includes(f)||g.includes(f)});return s.jsxs("div",{className:"dashboard",children:[s.jsxs("div",{className:"welcome-panel",children:[s.jsxs("div",{children:[s.jsx("h2",{children:"AI Extraction History"}),s.jsx("p",{className:"muted",children:"Audit trail of NeuroEdge document extraction operations."})]}),s.jsx("div",{className:"welcome-actions",children:s.jsx("button",{className:"btn-secondary",onClick:d,disabled:n,children:"Refresh"})})]}),i&&s.jsx("div",{className:"card",children:i}),s.jsxs("section",{className:"section",children:[s.jsxs("div",{className:"card",style:{marginBottom:12},children:[s.jsxs("div",{className:"grid info-grid",children:[s.jsxs("label",{children:["Action",s.jsx("select",{value:o.action,onChange:h=>l(f=>({...f,action:h.target.value})),children:IL.map(h=>s.jsx("option",{value:h,children:h},h))})]}),s.jsxs("label",{children:["Hospital Id",s.jsx("input",{value:o.hospital,onChange:h=>l(f=>({...f,hospital:h.target.value})),placeholder:"Optional hospital id"})]}),s.jsxs("label",{children:["Limit",s.jsx("select",{value:o.limit,onChange:h=>l(f=>({...f,limit:Number(h.target.value)})),children:[25,50,100,200].map(h=>s.jsx("option",{value:h,children:h},h))})]}),s.jsxs("label",{children:["Search",s.jsx("input",{value:c,onChange:h=>u(h.target.value),placeholder:"actor, file, provider, mime"})]})]}),s.jsxs("div",{className:"welcome-actions",style:{marginTop:10},children:[s.jsx("button",{className:"btn-primary",onClick:()=>d(o),disabled:n,children:"Apply Filters"}),s.jsx("button",{className:"btn-secondary",onClick:()=>{const h={action:"AI_DOCUMENT_EXTRACTED",hospital:"",limit:100};l(h),u(""),d(h)},disabled:n,children:"Reset"})]})]}),s.jsx("div",{className:"card",children:s.jsxs("table",{className:"table lite",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Time"}),s.jsx("th",{children:"Actor"}),s.jsx("th",{children:"Role"}),s.jsx("th",{children:"Filename"}),s.jsx("th",{children:"MimeType"}),s.jsx("th",{children:"Size"}),s.jsx("th",{children:"Provider"}),s.jsx("th",{children:"Status"})]})}),s.jsxs("tbody",{children:[p.map(h=>{var f,y,j,A,g,x,w;return s.jsxs("tr",{children:[s.jsx("td",{children:h.createdAt?new Date(h.createdAt).toLocaleString():"-"}),s.jsx("td",{children:((f=h.actor)==null?void 0:f.name)||((y=h.actor)==null?void 0:y.email)||"-"}),s.jsx("td",{children:((j=h.actor)==null?void 0:j.role)||"-"}),s.jsx("td",{children:((A=h.metadata)==null?void 0:A.filename)||"-"}),s.jsx("td",{children:((g=h.metadata)==null?void 0:g.mimeType)||"-"}),s.jsx("td",{children:((x=h.metadata)==null?void 0:x.size)||"-"}),s.jsx("td",{children:((w=h.metadata)==null?void 0:w.provider)||"-"}),s.jsx("td",{children:h.success?"Success":h.error||"Failed"})]},h.id)}),p.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:"8",children:"No extraction logs found"})})]})]})})]})]})}function TL(){return s.jsxs("div",{style:{padding:24},children:[s.jsx("h1",{style:{fontSize:24,fontWeight:700,marginBottom:20},children:"Admin Tools"}),s.jsxs("div",{className:"grid",style:{marginBottom:24},children:[s.jsx(te,{title:"Audit Logs",value:"Live",subtitle:"Security events"}),s.jsx(te,{title:"Admin Accounts",value:"Manage",subtitle:"Create and review"}),s.jsx(te,{title:"System Access",value:"RBAC",subtitle:"Role governance"})]}),s.jsxs("div",{style:{display:"flex",gap:12},children:[s.jsx(fi,{to:"/admin/audit-logs",children:"Open Audit Logs"}),s.jsx(fi,{to:"/admin/create-admin",children:"Create Admin"})]})]})}async function OL(e={}){const t=new URLSearchParams(e).toString();return await le(`/api/audit?${t}`)}function PL(){const[e,t]=m.useState([]),[n,r]=m.useState({}),[i,a]=m.useState(!0),o=async()=>{a(!0);const c=await OL(n);t(c.data),a(!1)};m.useEffect(()=>{o()},[]);const l=()=>{const u=`time,actor,action,resource,success,ip
`+e.map(h=>{var f;return{time:new Date(h.createdAt).toISOString(),actor:(f=h.actorId)==null?void 0:f.email,action:h.action,resource:h.resource,success:h.success,ip:h.ip}}).map(h=>Object.values(h).join(",")).join(`
`),d=new Blob([u],{type:"text/csv"}),p=document.createElement("a");p.href=URL.createObjectURL(d),p.download="audit-logs.csv",p.click()};return s.jsxs("div",{className:"card",children:[s.jsx("h2",{children:" Audit Logs"}),s.jsxs("div",{className:"row",children:[s.jsx("input",{placeholder:"Action",onChange:c=>r({...n,action:c.target.value})}),s.jsx("input",{placeholder:"Resource",onChange:c=>r({...n,resource:c.target.value})}),s.jsx("button",{onClick:o,children:"Filter"}),s.jsx("button",{onClick:l,children:"Export CSV"})]}),i?s.jsx("p",{children:"Loading..."}):s.jsxs("table",{children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Time"}),s.jsx("th",{children:"Actor"}),s.jsx("th",{children:"Action"}),s.jsx("th",{children:"Resource"}),s.jsx("th",{children:"Success"}),s.jsx("th",{children:"IP"})]})}),s.jsx("tbody",{children:e.map(c=>{var u;return s.jsxs("tr",{children:[s.jsx("td",{children:new Date(c.createdAt).toLocaleString()}),s.jsx("td",{children:(u=c.actorId)==null?void 0:u.email}),s.jsx("td",{children:c.action}),s.jsx("td",{children:c.resource}),s.jsx("td",{children:c.success?"":""}),s.jsx("td",{children:c.ip})]},c._id)})})]})]})}function LL(){const{user:e}=Te(),[t,n]=m.useState([]),[r,i]=m.useState(""),[a,o]=m.useState({name:"",email:"",password:"",role:"HOSPITAL_ADMIN",hospitalId:""}),[l,c]=m.useState(!1),[u,d]=m.useState(null);if((e==null?void 0:e.role)!=="SUPER_ADMIN")return s.jsx("p",{children:" Access denied"});ba.useEffect(()=>{G0().then(f=>{const y=Array.isArray(f)?f:Array.isArray(f==null?void 0:f.hospitals)?f.hospitals:Array.isArray(f==null?void 0:f.items)?f.items:[];n(y)}).catch(()=>n([]))},[]);const p=m.useMemo(()=>{const f=r.trim().toLowerCase();return f?t.filter(y=>String((y==null?void 0:y.name)||"").toLowerCase().includes(f)):t},[t,r]),h=async f=>{var y;f.preventDefault(),c(!0),d(null);try{a.role==="SYSTEM_ADMIN"?(await K0({name:a.name,email:a.email,password:a.password}),d(" System admin created")):a.role==="DEVELOPER"?(await J0({name:a.name,email:a.email,password:a.password}),d(" Developer created")):(await Y0({name:a.name,email:a.email,password:a.password,hospitalId:a.hospitalId}),d(" Hospital admin created")),o({name:"",email:"",password:"",role:"HOSPITAL_ADMIN",hospitalId:""}),i("")}catch(j){d(((y=j==null?void 0:j.data)==null?void 0:y.msg)||(j==null?void 0:j.message)||"Failed to create admin")}finally{c(!1)}};return s.jsxs("div",{className:"card",children:[s.jsx("h2",{children:" Create Admin"}),s.jsxs("form",{onSubmit:h,className:"form",children:[s.jsx("input",{placeholder:"Full name",value:a.name,required:!0,onChange:f=>o({...a,name:f.target.value})}),s.jsx("input",{placeholder:"Email address",type:"email",value:a.email,required:!0,onChange:f=>o({...a,email:f.target.value})}),s.jsx("input",{placeholder:"Temporary password",type:"password",value:a.password,required:!0,onChange:f=>o({...a,password:f.target.value})}),s.jsxs("select",{value:a.role,onChange:f=>o({...a,role:f.target.value}),children:[s.jsx("option",{value:"HOSPITAL_ADMIN",children:"Hospital Admin"}),s.jsx("option",{value:"SYSTEM_ADMIN",children:"System Admin"}),s.jsx("option",{value:"DEVELOPER",children:"Developer"})]}),a.role==="HOSPITAL_ADMIN"&&s.jsxs(s.Fragment,{children:[s.jsx("input",{list:"hospital-options",placeholder:"Type hospital name",value:r,onChange:f=>{const y=f.target.value;i(y);const j=t.find(A=>String((A==null?void 0:A.name)||"").toLowerCase()===y.trim().toLowerCase());o({...a,hospitalId:(j==null?void 0:j._id)||""})},required:!0}),s.jsx("datalist",{id:"hospital-options",children:t.map(f=>s.jsx("option",{value:f.name},f._id))}),s.jsxs("select",{value:a.hospitalId,onChange:f=>{const y=f.target.value,j=t.find(A=>String(A._id)===String(y));o({...a,hospitalId:y}),j!=null&&j.name&&i(j.name)},required:!0,children:[s.jsx("option",{value:"",children:t.length?"Select hospital":"No hospitals available"}),p.map(f=>s.jsx("option",{value:f._id,children:f.name},f._id))]})]}),s.jsx("button",{disabled:l,children:l?"Creating...":"Create Admin"})]}),u&&s.jsx("p",{style:{marginTop:10},children:u})]})}function DL(){const{user:e,loading:t}=Te();return t?s.jsx("div",{}):s.jsx(pa,{to:e?redirectByRole(e):"/login",replace:!0})}function Wy({children:e}){const{user:t,loading:n}=Te();return n?s.jsx("div",{}):t?s.jsx(pa,{to:redirectByRole(t),replace:!0}):e}function ML(){const{user:e}=Te(),t=Re(),[n,r]=m.useState(!1),[i,a]=m.useState([]),[o,l]=m.useState(null),[c,u]=m.useState(()=>{try{return JSON.parse(localStorage.getItem("dismissed_reminders")||"[]")}catch{return[]}}),d=h=>{switch(h){case"DOCTOR":return"/api/dashboard/doctor";case"NURSE":return"/api/dashboard/nurse";case"LAB_TECH":return"/api/dashboard/lab-tech";case"HR_MANAGER":return"/api/dashboard/hr";case"PAYROLL_OFFICER":return"/api/dashboard/payroll";case"HOSPITAL_ADMIN":return"/api/dashboard/hospital-admin";case"SECURITY_ADMIN":return"/api/dashboard/security-admin";case"SECURITY_OFFICER":return"/api/dashboard/security-officer";case"PATIENT":return"/api/dashboard/patient";case"SUPER_ADMIN":return"/api/dashboard/super-admin";case"RADIOLOGIST":case"THERAPIST":case"RECEPTIONIST":return"/api/dashboard/staff";default:return null}};m.useEffect(()=>{const h=f=>{const y=(f==null?void 0:f.detail)||{};l({code:y.code||"SESSION_SECURITY",message:y.message||"Additional verification is required."}),t("/step-up")};return window.addEventListener("afyalink:session-security",h),()=>{window.removeEventListener("afyalink:session-security",h)}},[t]),m.useEffect(()=>{let h=!0;if(!e)return;le("/api/auth/session-risk").then(j=>{var A;!h||!j||(j.restriction||j.requiresStepUp?(l({code:j.restriction?"SESSION_RESTRICTED":"STEP_UP_REQUIRED",message:((A=j.restriction)==null?void 0:A.reason)==="CRITICAL_LOGIN_RISK"?"Your session is temporarily restricted due to critical login risk. Verify step-up to unlock.":"Step-up verification is required for sensitive actions."}),a(g=>{var w;const x=(g||[]).filter(E=>E.id!=="session-stepup");return[{id:"session-stepup",text:((w=j.restriction)==null?void 0:w.reason)==="CRITICAL_LOGIN_RISK"?"Session restricted. Click to complete step-up verification.":"Sensitive actions require step-up verification. Click to verify.",action:()=>t("/step-up")},...x]})):l(null))}).catch(()=>{});const f=d(e==null?void 0:e.role),y=f?le(f):Promise.resolve(null);return Promise.all([le("/api/profile"),le("/api/2fa/status"),y]).then(([j,A,g])=>{var w,E,_;if(!h)return;const x=[];if(j!=null&&j.emailVerified||x.push({id:"email",text:((w=j==null?void 0:j.verificationWarning)==null?void 0:w.message)||"Your email is not verified. Click to verify in Profile.",action:()=>t("/profile")}),j!=null&&j.phoneVerified||x.push({id:"phone",text:"Verify your phone number to secure your account.",action:()=>t("/profile")}),(!(j!=null&&j.nationalIdNumber)||!(j!=null&&j.nationalIdCountry))&&x.push({id:"id",text:"Add your National ID details to complete your profile.",action:()=>t("/profile")}),A!=null&&A.enabled||x.push({id:"2fa",text:"Enable two-factor authentication for stronger security.",action:()=>t("/profile")}),g){const b=e==null?void 0:e.role;((E=g.pendingRequests)==null?void 0:E.total)>0&&x.push({id:"pending-requests",text:`You have ${g.pendingRequests.total} pending requests.`,action:()=>t(b==="HOSPITAL_ADMIN"?"/hospital-admin/approvals":"/workforce/requests")}),b==="HOSPITAL_ADMIN"&&g.pendingRequests>0&&x.push({id:"pending-approvals",text:`You have ${g.pendingRequests} approvals waiting.`,action:()=>t("/hospital-admin/approvals")}),b==="HR_MANAGER"&&((_=g.pendingRequests)==null?void 0:_.total)>0&&x.push({id:"hr-requests",text:`Workforce requests pending: ${g.pendingRequests.total}.`,action:()=>t("/hr-manager")}),b==="PAYROLL_OFFICER"&&g.pendingApprovals>0&&x.push({id:"payroll-approvals",text:`Payroll approvals pending: ${g.pendingApprovals}.`,action:()=>t("/payroll-officer")}),(b==="PAYROLL_OFFICER"||b==="HOSPITAL_ADMIN"||b==="SUPER_ADMIN")&&g.overduePayroll>0&&x.push({id:"overdue-payroll",text:`Overdue payroll items: ${g.overduePayroll}.`,action:()=>t(b==="PAYROLL_OFFICER"?"/payroll-officer":"/payments")}),b==="SUPER_ADMIN"&&g.pendingRequests>0&&x.push({id:"super-pending",text:`Global approvals pending: ${g.pendingRequests}.`,action:()=>t("/admin/notifications")}),(b==="HOSPITAL_ADMIN"||b==="HR_MANAGER"||b==="SUPER_ADMIN")&&g.incompleteStaff>0&&x.push({id:"incomplete-staff",text:`${g.incompleteStaff} staff records are incomplete.`,action:()=>t(b==="SUPER_ADMIN"?"/super-admin":b==="HR_MANAGER"?"/hr-manager":"/hospital-admin/staff")}),(b==="HOSPITAL_ADMIN"||b==="HR_MANAGER"||b==="SUPER_ADMIN")&&g.inactiveStaff>0&&x.push({id:"inactive-staff",text:`${g.inactiveStaff} staff accounts are inactive.`,action:()=>t(b==="SUPER_ADMIN"?"/super-admin":b==="HR_MANAGER"?"/hr-manager":"/hospital-admin/staff")}),(b==="HOSPITAL_ADMIN"||b==="HR_MANAGER"||b==="SUPER_ADMIN")&&g.missingLicenses>0&&x.push({id:"missing-licenses",text:`${g.missingLicenses} staff are missing license details.`,action:()=>t(b==="SUPER_ADMIN"?"/super-admin":b==="HR_MANAGER"?"/hr-manager":"/hospital-admin/staff")}),["RADIOLOGIST","THERAPIST","RECEPTIONIST"].includes(b)&&g.myPendingRequests>0&&x.push({id:"my-requests",text:`You have ${g.myPendingRequests} pending requests.`,action:()=>t("/workforce/requests")}),g.notificationsUnread>0&&x.push({id:"unread-notifs",text:`You have ${g.notificationsUnread} unread notifications.`,action:()=>t(["SUPER_ADMIN","SYSTEM_ADMIN","HOSPITAL_ADMIN"].includes(b)?"/admin/notifications":"/profile")}),b==="LAB_TECH"&&g.pendingOrders>0&&x.push({id:"lab-orders",text:`${g.pendingOrders} lab orders are pending.`,action:()=>t("/lab-tech")}),b==="NURSE"&&g.pendingLabOrders>0&&x.push({id:"lab-pending",text:`${g.pendingLabOrders} lab orders are pending.`,action:()=>t("/nurse")}),b==="DOCTOR"&&g.upcomingAppointments>0&&x.push({id:"doctor-appts",text:`${g.upcomingAppointments} upcoming appointments.`,action:()=>t("/doctor/appointments")}),b==="PATIENT"&&(g.upcomingAppointments>0&&x.push({id:"patient-appts",text:`${g.upcomingAppointments} upcoming appointments.`,action:()=>t("/patient")}),g.unpaidInvoices>0&&x.push({id:"patient-invoices",text:`${g.unpaidInvoices} unpaid invoices.`,action:()=>t("/payments")})),(b==="SECURITY_ADMIN"||b==="SECURITY_OFFICER")&&g.openIncidents>0&&x.push({id:"security-incidents",text:`${g.openIncidents} security incidents are open.`,action:()=>t(b==="SECURITY_ADMIN"?"/security-admin":"/security-officer")})}a(x)}).catch(()=>{}),()=>{h=!1}},[e==null?void 0:e.id]);const p=h=>{const f=Array.from(new Set([...c||[],h]));u(f),localStorage.setItem("dismissed_reminders",JSON.stringify(f))};return s.jsxs(s.Fragment,{children:[e&&s.jsx(z_,{onToggleSidebar:()=>r(h=>!h)}),e&&n&&s.jsx("button",{className:"sidebar-backdrop","aria-label":"Close navigator",onClick:()=>r(!1)}),s.jsxs("div",{className:`app-grid ${n?"":"sidebar-collapsed"}`,children:[e&&s.jsx(Y_,{open:n,onClose:()=>r(!1)}),s.jsxs("main",{className:"main",children:[o&&s.jsxs("button",{className:"verify-banner",onClick:()=>t("/step-up"),children:[o.message,s.jsx("span",{className:"banner-close",role:"button","aria-label":"Dismiss notice",onClick:h=>{h.stopPropagation(),l(null)},children:""})]}),i.filter(h=>!c.includes(h.id)).map(h=>s.jsxs("button",{className:"verify-banner",onClick:h.action,children:[h.text,s.jsx("span",{className:"banner-close",role:"button","aria-label":"Dismiss reminder",onClick:f=>{f.stopPropagation(),p(h.id)},children:""})]},h.id)),s.jsx(pj,{})]})]}),e&&s.jsx(Q_,{}),e&&s.jsx(J_,{})]})}function UL(){return s.jsx(T_,{children:s.jsxs(xN,{children:[s.jsx(J,{path:"/",element:s.jsx(DL,{})}),s.jsx(J,{path:"/login",element:s.jsx(Wy,{children:s.jsx(eA,{})})}),s.jsx(J,{path:"/register",element:s.jsx(Wy,{children:s.jsx(tA,{})})}),s.jsx(J,{path:"/verify-email",element:s.jsx(nA,{})}),s.jsx(J,{path:"/verify-success",element:s.jsx(rA,{})}),s.jsx(J,{path:"/forgot-password",element:s.jsx(sA,{})}),s.jsx(J,{path:"/reset-password",element:s.jsx(iA,{})}),s.jsx(J,{path:"/2fa",element:s.jsx(aA,{})}),s.jsx(J,{path:"/step-up",element:s.jsx(oA,{})}),s.jsx(J,{path:"/unauthorized",element:s.jsx(Ng,{})}),s.jsx(J,{path:"/403",element:s.jsx(Ng,{})}),s.jsxs(J,{element:s.jsx(oe,{children:s.jsx(X_,{children:s.jsx(ML,{})})}),children:[s.jsx(J,{path:"/patient",element:s.jsx(oe,{roles:["PATIENT","SUPER_ADMIN","DEVELOPER"],children:s.jsx(eP,{})})}),s.jsx(J,{path:"/patient/appointments",element:s.jsx(oe,{roles:["PATIENT","SUPER_ADMIN","DEVELOPER"],children:s.jsx(W1,{})})}),s.jsx(J,{path:"/patient/medical-records",element:s.jsx(oe,{roles:["PATIENT","SUPER_ADMIN","DEVELOPER"],children:s.jsx(G1,{})})}),s.jsx(J,{path:"/patient/prescriptions",element:s.jsx(oe,{roles:["PATIENT","SUPER_ADMIN","DEVELOPER"],children:s.jsx(Y1,{})})}),s.jsx(J,{path:"/patient/lab-results",element:s.jsx(oe,{roles:["PATIENT","SUPER_ADMIN","DEVELOPER"],children:s.jsx(K1,{})})}),s.jsx(J,{path:"/patient/billing",element:s.jsx(oe,{roles:["PATIENT","SUPER_ADMIN","DEVELOPER"],children:s.jsx(J1,{})})}),s.jsx(J,{path:"/patient/insurance",element:s.jsx(oe,{roles:["PATIENT","SUPER_ADMIN","DEVELOPER"],children:s.jsx(Q1,{})})}),s.jsx(J,{path:"/patient/feedback",element:s.jsx(oe,{roles:["PATIENT","SUPER_ADMIN","DEVELOPER"],children:s.jsx(Z1,{})})}),s.jsx(J,{path:"/doctor",element:s.jsx(oe,{roles:["DOCTOR","SUPER_ADMIN","DEVELOPER"],children:s.jsx(XO,{})})}),s.jsx(J,{path:"/nurse",element:s.jsx(oe,{roles:["NURSE","SUPER_ADMIN","DEVELOPER"],children:s.jsx(tP,{})})}),s.jsx(J,{path:"/nurse/shift",element:s.jsx(oe,{roles:["NURSE","SUPER_ADMIN","DEVELOPER"],children:s.jsx(A1,{})})}),s.jsx(J,{path:"/nurse/patients",element:s.jsx(oe,{roles:["NURSE","SUPER_ADMIN","DEVELOPER"],children:s.jsx(C1,{})})}),s.jsx(J,{path:"/nurse/medication",element:s.jsx(oe,{roles:["NURSE","SUPER_ADMIN","DEVELOPER"],children:s.jsx(k1,{})})}),s.jsx(J,{path:"/nurse/incidents",element:s.jsx(oe,{roles:["NURSE","SUPER_ADMIN","DEVELOPER"],children:s.jsx(I1,{})})}),s.jsx(J,{path:"/nurse/vitals",element:s.jsx(oe,{roles:["NURSE","SUPER_ADMIN","DEVELOPER"],children:s.jsx(R1,{})})}),s.jsx(J,{path:"/nurse/leave",element:s.jsx(oe,{roles:["NURSE","SUPER_ADMIN","DEVELOPER"],children:s.jsx(T1,{})})}),s.jsx(J,{path:"/nurse/performance",element:s.jsx(oe,{roles:["NURSE","SUPER_ADMIN","DEVELOPER"],children:s.jsx(O1,{})})}),s.jsx(J,{path:"/lab-tech",element:s.jsx(oe,{roles:["LAB_TECH","SUPER_ADMIN","DEVELOPER"],children:s.jsx(nP,{})})}),s.jsx(J,{path:"/lab-tech/test-queue",element:s.jsx(oe,{roles:["LAB_TECH","SUPER_ADMIN","DEVELOPER"],children:s.jsx(P1,{})})}),s.jsx(J,{path:"/lab-tech/equipment",element:s.jsx(oe,{roles:["LAB_TECH","SUPER_ADMIN","DEVELOPER"],children:s.jsx(L1,{})})}),s.jsx(J,{path:"/lab-tech/samples",element:s.jsx(oe,{roles:["LAB_TECH","SUPER_ADMIN","DEVELOPER"],children:s.jsx(D1,{})})}),s.jsx(J,{path:"/lab-tech/qc",element:s.jsx(oe,{roles:["LAB_TECH","SUPER_ADMIN","DEVELOPER"],children:s.jsx(M1,{})})}),s.jsx(J,{path:"/lab-tech/safety",element:s.jsx(oe,{roles:["LAB_TECH","SUPER_ADMIN","DEVELOPER"],children:s.jsx(U1,{})})}),s.jsx(J,{path:"/lab-tech/archive",element:s.jsx(oe,{roles:["LAB_TECH","SUPER_ADMIN","DEVELOPER"],children:s.jsx(B1,{})})}),s.jsx(J,{path:"/pharmacy",element:s.jsx(oe,{roles:["PHARMACIST","SUPER_ADMIN","DEVELOPER"],children:s.jsx(rP,{})})}),s.jsx(J,{path:"/pharmacy/queue",element:s.jsx(oe,{roles:["PHARMACIST","SUPER_ADMIN","DEVELOPER"],children:s.jsx(V1,{})})}),s.jsx(J,{path:"/pharmacy/inventory",element:s.jsx(oe,{roles:["PHARMACIST","SUPER_ADMIN","DEVELOPER"],children:s.jsx($1,{})})}),s.jsx(J,{path:"/pharmacy/controlled",element:s.jsx(oe,{roles:["PHARMACIST","SUPER_ADMIN","DEVELOPER"],children:s.jsx(F1,{})})}),s.jsx(J,{path:"/pharmacy/expiry",element:s.jsx(oe,{roles:["PHARMACIST","SUPER_ADMIN","DEVELOPER"],children:s.jsx(H1,{})})}),s.jsx(J,{path:"/pharmacy/suppliers",element:s.jsx(oe,{roles:["PHARMACIST","SUPER_ADMIN","DEVELOPER"],children:s.jsx(q1,{})})}),s.jsx(J,{path:"/pharmacy/reports",element:s.jsx(oe,{roles:["PHARMACIST","SUPER_ADMIN","DEVELOPER"],children:s.jsx(z1,{})})}),s.jsx(J,{path:"/staff",element:s.jsx(oe,{roles:["RADIOLOGIST","THERAPIST","RECEPTIONIST","SUPER_ADMIN","DEVELOPER"],children:s.jsx(zP,{})})}),s.jsx(J,{path:"/hr-manager",element:s.jsx(oe,{roles:["HR_MANAGER","SUPER_ADMIN","DEVELOPER"],children:s.jsx(WP,{})})}),s.jsx(J,{path:"/payroll-officer",element:s.jsx(oe,{roles:["PAYROLL_OFFICER","SUPER_ADMIN","DEVELOPER"],children:s.jsx(GP,{})})}),s.jsx(J,{path:"/developer",element:s.jsx(oe,{roles:["DEVELOPER"],children:s.jsx(YP,{})})}),s.jsx(J,{path:"/developer/queue-replay",element:s.jsx(oe,{roles:["DEVELOPER","SUPER_ADMIN"],children:s.jsx(SL,{})})}),s.jsx(J,{path:"/developer/webhook-retry",element:s.jsx(oe,{roles:["DEVELOPER","SUPER_ADMIN"],children:s.jsx(EL,{})})}),s.jsx(J,{path:"/developer/decision-cockpit",element:s.jsx(oe,{roles:["DEVELOPER","SUPER_ADMIN","SYSTEM_ADMIN"],children:s.jsx(NL,{})})}),s.jsx(J,{path:"/developer/provenance-verify",element:s.jsx(oe,{roles:["DEVELOPER","SUPER_ADMIN","SYSTEM_ADMIN"],children:s.jsx(CL,{})})}),s.jsx(J,{path:"/developer/ai-extraction-history",element:s.jsx(oe,{roles:["DEVELOPER","SUPER_ADMIN","SYSTEM_ADMIN"],children:s.jsx(RL,{})})}),s.jsx(J,{path:"/super-admin",element:s.jsx(oe,{roles:["SUPER_ADMIN"],children:s.jsx(sP,{})})}),s.jsx(J,{path:"/super-admin/hospitals",element:s.jsx(oe,{roles:["SUPER_ADMIN","SYSTEM_ADMIN"],children:s.jsx(aP,{})})}),s.jsx(J,{path:"/super-admin/settings",element:s.jsx(oe,{roles:["SUPER_ADMIN","DEVELOPER"],children:s.jsx(cP,{})})}),s.jsx(J,{path:"/system-admin",element:s.jsx(oe,{roles:["SYSTEM_ADMIN","SUPER_ADMIN","DEVELOPER"],children:s.jsx(sL,{})})}),s.jsx(J,{path:"/system-admin/abac",element:s.jsx(oe,{roles:["SYSTEM_ADMIN","SUPER_ADMIN","DEVELOPER"],children:s.jsx(iL,{})})}),s.jsx(J,{path:"/system-admin/mapping-studio",element:s.jsx(oe,{roles:["SYSTEM_ADMIN","SUPER_ADMIN","DEVELOPER"],children:s.jsx(pL,{})})}),s.jsx(J,{path:"/system-admin/nlp-analytics",element:s.jsx(oe,{roles:["SYSTEM_ADMIN","SUPER_ADMIN","DEVELOPER","HOSPITAL_ADMIN","HR_MANAGER","PAYROLL_OFFICER"],children:s.jsx(yL,{})})}),s.jsx(J,{path:"/system-admin/regulatory-reports",element:s.jsx(oe,{roles:["SYSTEM_ADMIN","SUPER_ADMIN","DEVELOPER","HOSPITAL_ADMIN"],children:s.jsx(vL,{})})}),s.jsx(J,{path:"/system-admin/clinical-intelligence",element:s.jsx(oe,{roles:["SYSTEM_ADMIN","SUPER_ADMIN","DEVELOPER","HOSPITAL_ADMIN","HR_MANAGER","DOCTOR","NURSE"],children:s.jsx(xL,{})})}),s.jsx(J,{path:"/hospital-admin",element:s.jsx(oe,{roles:["HOSPITAL_ADMIN","SUPER_ADMIN","DEVELOPER"],children:s.jsx(uP,{})})}),s.jsx(J,{path:"/hospital-admin/register-staff",element:s.jsx(oe,{roles:["HOSPITAL_ADMIN"],children:s.jsx(dP,{})})}),s.jsx(J,{path:"/hospital-admin/approvals",element:s.jsx(oe,{roles:["HOSPITAL_ADMIN","SUPER_ADMIN","SYSTEM_ADMIN","DEVELOPER"],children:s.jsx($P,{})})}),s.jsx(J,{path:"/hospital-admin/staff",element:s.jsx(oe,{roles:["HOSPITAL_ADMIN","SUPER_ADMIN"],children:s.jsx(FP,{})})}),s.jsx(J,{path:"/security-officer",element:s.jsx(oe,{roles:["SECURITY_OFFICER","SUPER_ADMIN","DEVELOPER"],children:s.jsx(HP,{})})}),s.jsx(J,{path:"/security-admin",element:s.jsx(oe,{roles:["SECURITY_ADMIN","SUPER_ADMIN","DEVELOPER"],children:s.jsx(qP,{})})}),s.jsx(J,{path:"/guest",element:s.jsx(oe,{roles:["GUEST"],children:s.jsx(lA,{})})}),s.jsxs(J,{path:"/admin",element:s.jsx(oe,{roles:["SUPER_ADMIN","SYSTEM_ADMIN","HOSPITAL_ADMIN"],children:s.jsx(pj,{})}),children:[s.jsx(J,{index:!0,element:s.jsx(TL,{})}),s.jsx(J,{path:"audit-logs",element:s.jsx(PL,{})}),s.jsx(J,{path:"realtime",element:s.jsx(X1,{})}),s.jsx(J,{path:"crdt-patients",element:s.jsx(UO,{})}),s.jsx(J,{path:"notifications",element:s.jsx(BO,{})}),s.jsx(J,{path:"payment-settings",element:s.jsx(oe,{roles:["SUPER_ADMIN"],children:s.jsx(VO,{})})}),s.jsx(J,{path:"create-admin",element:s.jsx(oe,{roles:["SUPER_ADMIN"],children:s.jsx(LL,{})})})]}),s.jsx(J,{path:"/profile",element:s.jsx(cA,{})}),s.jsx(J,{path:"/analytics",element:s.jsx(fA,{})}),s.jsx(J,{path:"/reports",element:s.jsx(gA,{})}),s.jsx(J,{path:"/inventory",element:s.jsx(vA,{})}),s.jsx(J,{path:"/payments",element:s.jsx(wA,{})}),s.jsx(J,{path:"/payments/full",element:s.jsx(SA,{})}),s.jsx(J,{path:"/ai/medical",element:s.jsx(EA,{})}),s.jsx(J,{path:"/ai/triage",element:s.jsx(CA,{})}),s.jsx(J,{path:"/ai/voice",element:s.jsx(kA,{})}),s.jsx(J,{path:"/ai/chatbot",element:s.jsx(IA,{})}),s.jsx(J,{path:"/ai/extract",element:s.jsx(TA,{})}),s.jsx(J,{path:"/ai/ws",element:s.jsx(zj,{})}),s.jsx(J,{path:"/workforce/requests",element:s.jsx(oe,{roles:["HOSPITAL_ADMIN","HR_MANAGER","PAYROLL_OFFICER","DOCTOR","NURSE","LAB_TECH","PHARMACIST","RADIOLOGIST","THERAPIST","RECEPTIONIST","SECURITY_ADMIN","SECURITY_OFFICER"],children:s.jsx(bL,{})})}),s.jsx(J,{path:"/doctor/appointments",element:s.jsx(oe,{roles:["DOCTOR","SUPER_ADMIN","DEVELOPER"],children:s.jsx(h1,{})})}),s.jsx(J,{path:"/doctor/schedule",element:s.jsx(oe,{roles:["DOCTOR","SUPER_ADMIN","DEVELOPER"],children:s.jsx(f1,{})})}),s.jsx(J,{path:"/doctor/patients",element:s.jsx(oe,{roles:["DOCTOR","SUPER_ADMIN","DEVELOPER"],children:s.jsx(p1,{})})}),s.jsx(J,{path:"/doctor/opd",element:s.jsx(oe,{roles:["DOCTOR","SUPER_ADMIN","DEVELOPER"],children:s.jsx(m1,{})})}),s.jsx(J,{path:"/doctor/ward",element:s.jsx(oe,{roles:["DOCTOR","SUPER_ADMIN","DEVELOPER"],children:s.jsx(g1,{})})}),s.jsx(J,{path:"/doctor/surgery",element:s.jsx(oe,{roles:["DOCTOR","SUPER_ADMIN","DEVELOPER"],children:s.jsx(y1,{})})}),s.jsx(J,{path:"/doctor/lab-results",element:s.jsx(oe,{roles:["DOCTOR","SUPER_ADMIN","DEVELOPER"],children:s.jsx(v1,{})})}),s.jsx(J,{path:"/doctor/prescriptions",element:s.jsx(oe,{roles:["DOCTOR","SUPER_ADMIN","DEVELOPER"],children:s.jsx(x1,{})})}),s.jsx(J,{path:"/doctor/medical-records",element:s.jsx(oe,{roles:["DOCTOR","SUPER_ADMIN","DEVELOPER"],children:s.jsx(j1,{})})}),s.jsx(J,{path:"/doctor/referrals",element:s.jsx(oe,{roles:["DOCTOR","SUPER_ADMIN","DEVELOPER"],children:s.jsx(b1,{})})}),s.jsx(J,{path:"/doctor/performance",element:s.jsx(oe,{roles:["DOCTOR","SUPER_ADMIN","DEVELOPER"],children:s.jsx(w1,{})})}),s.jsx(J,{path:"/doctor/cme",element:s.jsx(oe,{roles:["DOCTOR","SUPER_ADMIN","DEVELOPER"],children:s.jsx(S1,{})})}),s.jsx(J,{path:"/doctor/leave",element:s.jsx(oe,{roles:["DOCTOR","SUPER_ADMIN","DEVELOPER"],children:s.jsx(E1,{})})}),s.jsx(J,{path:"/doctor/reports-notes",element:s.jsx(oe,{roles:["DOCTOR","SUPER_ADMIN","DEVELOPER"],children:s.jsx(N1,{})})}),s.jsx(J,{path:"/doctor/settings",element:s.jsx(oe,{roles:["DOCTOR","SUPER_ADMIN","DEVELOPER"],children:s.jsx(_1,{})})}),s.jsx(J,{path:"/labtech/labs",element:s.jsx(oe,{roles:["LAB_TECH"],children:s.jsx(Wj,{})})}),s.jsx(J,{path:"/superadmin",element:s.jsx(pa,{to:"/super-admin",replace:!0})}),s.jsx(J,{path:"/hospitaladmin",element:s.jsx(pa,{to:"/hospital-admin",replace:!0})})]}),s.jsx(J,{path:"*",element:s.jsx("div",{children:"404  Page not found"})})]})})}const BL="269045019074-0238dca5sn2fq84dp96kilqmf24h24j3.apps.googleusercontent.com";Id.createRoot(document.getElementById("root")).render(s.jsx(ba.StrictMode,{children:s.jsx(TN,{clientId:BL,children:s.jsx(AN,{children:s.jsx(B_,{children:s.jsx($_,{children:s.jsx(UN,{children:s.jsx(UL,{})})})})})})}));
